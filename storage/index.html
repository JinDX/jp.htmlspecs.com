<!doctype html>
<html lang=ja-JP>

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <meta content="#3c790a" name="theme-color">
    <meta content="light dark" name="color-scheme">
    <title>ストレージ標準</title>
    <link crossorigin href="https://resources.whatwg.org/standard-shared-with-dev.css" rel="stylesheet">
    <link crossorigin href="https://resources.whatwg.org/standard.css" rel="stylesheet">
    <link crossorigin href="https://resources.whatwg.org/spec.css" rel="stylesheet">
    <link crossorigin href="https://resources.whatwg.org/logo-storage.svg" rel="icon">
    <script crossorigin defer src="https://resources.whatwg.org/commit-snapshot-shortcut-key.js"></script>
    <!-- <meta content="Bikeshed version b25686b9f, updated Fri Mar 14 14:15:20 2025 -0700" name="generator">
    <meta content="b3c0fa95d2e02e242bb03052f2b809c31aeb27b8" name="revision"> -->
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-mdn-anno */
        :root {
            --mdn-bg: #EEE;
            --mdn-shadow: #999;
            --mdn-nosupport-text: #ccc;
            --mdn-pass: green;
            --mdn-fail: red;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --mdn-bg: #222;
                --mdn-shadow: #444;
                --mdn-nosupport-text: #666;
                --mdn-pass: #690;
                --mdn-fail: #d22;
            }
        }

        .mdn-anno {
            background: var(--mdn-bg, #EEE);
            border-radius: .25em;
            box-shadow: 0 0 3px var(--mdn-shadow, #999);
            color: var(--text, black);
            font: 1em sans-serif;
            hyphens: none;
            max-width: min-content;
            overflow: hidden;
            padding: 0.2em;
            position: absolute;
            right: 0.3em;
            top: auto;
            white-space: nowrap;
            word-wrap: normal;
            z-index: 8;
        }

        .mdn-anno.unpositioned {
            display: none;
        }

        .mdn-anno.overlapping-main {
            opacity: .2;
            transition: opacity .1s;
        }

        .mdn-anno[open] {
            opacity: 1;
            z-index: 9;
            min-width: 9em;
        }

        .mdn-anno:hover {
            opacity: 1;
            outline: var(--text, black) 1px solid;
        }

        .mdn-anno>summary {
            font-weight: normal;
            text-align: right;
            cursor: pointer;
            display: block;
        }

        .mdn-anno>summary>.less-than-two-engines-flag {
            color: var(--mdn-fail);
            padding-right: 2px;
        }

        .mdn-anno>summary>.all-engines-flag {
            color: var(--mdn-pass);
            padding-right: 2px;
        }

        .mdn-anno>summary>span {
            color: #fff;
            background-color: #000;
            font-weight: normal;
            font-family: zillaslab, Palatino, "Palatino Linotype", serif;
            padding: 2px 3px 0px 3px;
            line-height: 1.3em;
            vertical-align: top;
        }

        .mdn-anno>.feature {
            margin-top: 20px;
        }

        .mdn-anno>.feature:not(:first-of-type) {
            border-top: 1px solid #999;
            margin-top: 6px;
            padding-top: 2px;
        }

        .mdn-anno>.feature>.less-than-two-engines-text {
            color: var(--mdn-fail);
        }

        .mdn-anno>.feature>.all-engines-text {
            color: var(--mdn-pass);
        }

        .mdn-anno>.feature>p {
            font-size: .75em;
            margin-top: 6px;
            margin-bottom: 0;
        }

        .mdn-anno>.feature>p+p {
            margin-top: 3px;
        }

        .mdn-anno>.feature>.support {
            display: block;
            font-size: 0.6em;
            margin: 0;
            padding: 0;
            margin-top: 2px;
        }

        .mdn-anno>.feature>.support+div {
            padding-top: 0.5em;
        }

        .mdn-anno>.feature>.support>hr {
            display: block;
            border: none;
            border-top: 1px dotted #999;
            padding: 3px 0px 0px 0px;
            margin: 2px 3px 0px 3px;
        }

        .mdn-anno>.feature>.support>hr::before {
            content: "";
        }

        .mdn-anno>.feature>.support>span {
            padding: 0.2em 0;
            display: block;
            display: table;
        }

        .mdn-anno>.feature>.support>span.no {
            color: var(--mdn-nosupport-text);
            filter: grayscale(100%);
        }

        .mdn-anno>.feature>.support>span.no::before {
            opacity: 0.5;
        }

        .mdn-anno>.feature>.support>span:first-of-type {
            padding-top: 0.5em;
        }

        .mdn-anno>.feature>.support>span>span {
            padding: 0 0.5em;
            display: table-cell;
        }

        .mdn-anno>.feature>.support>span>span:first-child {
            width: 100%;
        }

        .mdn-anno>.feature>.support>span>span:last-child {
            width: 100%;
            white-space: pre;
            padding: 0;
        }

        .mdn-anno>.feature>.support>span::before {
            content: ' ';
            display: table-cell;
            min-width: 1.5em;
            height: 1.5em;
            background: no-repeat center center;
            background-size: contain;
            text-align: right;
            font-size: 0.75em;
            font-weight: bold;
        }

        .mdn-anno>.feature>.support>.chrome_android::before {
            background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
        }

        .mdn-anno>.feature>.support>.firefox_android::before {
            background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
        }

        .mdn-anno>.feature>.support>.chrome::before {
            background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
        }

        .mdn-anno>.feature>.support>.edge_blink::before {
            background-image: url(https://resources.whatwg.org/browser-logos/edge.svg);
        }

        .mdn-anno>.feature>.support>.edge::before {
            background-image: url(https://resources.whatwg.org/browser-logos/edge_legacy.svg);
        }

        .mdn-anno>.feature>.support>.firefox::before {
            background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
        }

        .mdn-anno>.feature>.support>.ie::before {
            background-image: url(https://resources.whatwg.org/browser-logos/ie.png);
        }

        .mdn-anno>.feature>.support>.safari_ios::before {
            background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg);
        }

        .mdn-anno>.feature>.support>.nodejs::before {
            background-image: url(https://nodejs.org/favicon.ico);
        }

        .mdn-anno>.feature>.support>.opera_android::before {
            background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
        }

        .mdn-anno>.feature>.support>.opera::before {
            background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
        }

        .mdn-anno>.feature>.support>.safari::before {
            background-image: url(https://resources.whatwg.org/browser-logos/safari.png);
        }

        .mdn-anno>.feature>.support>.samsunginternet_android::before {
            background-image: url(https://resources.whatwg.org/browser-logos/samsung.svg);
        }

        .mdn-anno>.feature>.support>.webview_android::before {
            background-image: url(https://resources.whatwg.org/browser-logos/android-webview.png);
        }

        .name-slug-mismatch {
            color: red;
        }

        .caniuse-status:hover {
            z-index: 9;
        }

        /* dt, li, .issue, .note, and .example are "position: relative", so to put annotation at right margin, must move to right of containing block */
        ;

        .h-entry:not(.status-LS) dt>.mdn-anno,
        .h-entry:not(.status-LS) li>.mdn-anno,
        .h-entry:not(.status-LS) .issue>.mdn-anno,
        .h-entry:not(.status-LS) .note>.mdn-anno,
        .h-entry:not(.status-LS) .example>.mdn-anno {
            right: -6.7em;
        }

        .h-entry p+.mdn-anno {
            margin-top: 0;
        }

        h2+.mdn-anno.after {
            margin: -48px 0 0 0;
        }

        h3+.mdn-anno.after {
            margin: -46px 0 0 0;
        }

        h4+.mdn-anno.after {
            margin: -42px 0 0 0;
        }

        h5+.mdn-anno.after {
            margin: -40px 0 0 0;
        }

        h6+.mdn-anno.after {
            margin: -40px 0 0 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-var-click-highlighting */
        /*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)

For darkmode:
0 = oklab(50%   0%  108%)
1 = oklab(50% -51%   51%)
2 = oklab(50% -64%  -20%)
3 = oklab(50%   6%   19%)
4 = oklab(50% -12%  -64%)
5 = oklab(50%  44%  -19%)  
6 = oklab(50% 102%   38%)
*/

        [data-algorithm] var {
            cursor: pointer;
        }

        var[data-var-color] {
            background-color: var(--var-bg);
            box-shadow: 0 0 0 2px var(--var-bg);
        }

        var[data-var-color] {
            --var-bg: #F4D200;
        }

        var[data-var-color="1"] {
            --var-bg: #FF87A2;
        }

        var[data-var-color="2"] {
            --var-bg: #96E885;
        }

        var[data-var-color="3"] {
            --var-bg: #3EEED2;
        }

        var[data-var-color="4"] {
            --var-bg: #EACFB6;
        }

        var[data-var-color="5"] {
            --var-bg: #82DDFF;
        }

        var[data-var-color="6"] {
            --var-vg: #FFBCF2;
        }

        @media (prefers-color-scheme: dark) {
            var[data-var-color] {
                --var-bg: #bc1a00;
            }

            var[data-var-color="1"] {
                --var-bg: #007f00;
            }

            var[data-var-color="2"] {
                --var-bg: #008698;
            }

            var[data-var-color="3"] {
                --var-bg: #7f5b2b;
            }

            var[data-var-color="4"] {
                --var-bg: #004df3;
            }

            var[data-var-color="5"] {
                --var-bg: #a1248a;
            }

            var[data-var-color="6"] {
                --var-vg: #ff0000;
            }
        }
    </style>

<body class="h-entry status-LS">
    <div class="head">
        <a class="logo" href="https://whatwg.org/"> <img alt="WHATWG" class="darkmode-aware" crossorigin height="100"
                src="https://resources.whatwg.org/logo-storage.svg"> </a>
        <hgroup>
            <h1 class="p-name no-ref" id="title">ストレージ</h1>
            <p id="subtitle">現行標準 — 最終更新日 <time class="dt-updated" datetime="2025-03-26">2025年3月26日</time> </p>
        </hgroup>
        <div data-fill-with="spec-metadata">
            <dl>
                <dt>参加方法:
                <dd><a href="https://github.com/whatwg/storage">GitHub whatwg/storage</a> (<a
                        href="https://github.com/whatwg/storage/issues/new/choose">新規 issue</a>, <a
                        href="https://github.com/whatwg/storage/issues">オープンな issue</a>)
                <dd><a href="https://whatwg.org/chat">Matrix でチャット</a>
                <dt>コミット:
                <dd><a href="https://github.com/whatwg/storage/commits">GitHub whatwg/storage/commits</a>
                <dd><a href="/commit-snapshots/b3c0fa95d2e02e242bb03052f2b809c31aeb27b8/"
                        id="commit-snapshot-link">このコミット時点のスナップショット</a>
                <dd><a href="https://twitter.com/storagestandard">@storagestandard</a>
                <dt>テスト:
                <dd><a href="https://github.com/web-platform-tests/wpt/tree/master/storage">web-platform-tests
                        storage/</a> (<a href="https://github.com/web-platform-tests/wpt/labels/storage">進行中の作業</a>)
                <dt>翻訳 <small>（非標準）</small>:
                <dd><span title="日本語"><a href="https://triple-underscore.github.io/storage-ja.html" hreflang="ja"
                            lang="ja" rel="alternate">日本語</a></span>
                <dd><span title="簡体字中国語"><a href="https://htmlspecs.com/storage/" hreflang="zh-hans" lang="zh-hans"
                            rel="alternate">简体中文</a></span>
            </dl>
        </div>
        <div data-fill-with="warning"></div>
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">概要</span></h2>
        <p>ストレージ標準は、永続ストレージとクォータ推定のためのAPI、およびプラットフォームストレージアーキテクチャを定義します。</p>
    </div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目次</h2>
        <ol class="toc" role="directory">
            <li><a href="#introduction"><span class="secno">1</span> <span class="content">序章</span></a>
            <li><a href="#terminology"><span class="secno">2</span> <span class="content">用語</span></a>
            <li><a href="#infrastructure"><span class="secno">3</span> <span class="content">全体像</span></a>
            <li>
                <a href="#model"><span class="secno">4</span> <span class="content">モデル</span></a>
                <ol class="toc">
                    <li><a href="#storage-endpoints"><span class="secno">4.1</span> <span
                                class="content">ストレージエンドポイント</span></a>
                    <li><a href="#storage-keys"><span class="secno">4.2</span> <span class="content">ストレージキー</span></a>
                    <li><a href="#storage-sheds"><span class="secno">4.3</span> <span
                                class="content">ストレージシェッド</span></a>
                    <li><a href="#storage-shelves"><span class="secno">4.4</span> <span
                                class="content">ストレージ棚</span></a>
                    <li><a href="#buckets"><span class="secno">4.5</span> <span class="content">ストレージバケット</span></a>
                    <li><a href="#storage-bottles"><span class="secno">4.6</span> <span
                                class="content">ストレージボトル</span></a>
                    <li><a href="#storage-proxy-maps"><span class="secno">4.7</span> <span
                                class="content">ストレージプロキシマップ</span></a>
                    <li><a href="#storage-task-source"><span class="secno">4.8</span> <span
                                class="content">ストレージタスクソース</span></a>
                </ol>
            <li><a href="#persistence"><span class="secno">5</span> <span class="content">永続性の許可</span></a>
            <li><a href="#usage-and-quota"><span class="secno">6</span> <span class="content">使用量とクォータ</span></a>
            <li>
                <a href="#management"><span class="secno">7</span> <span class="content">管理</span></a>
                <ol class="toc">
                    <li><a href="#storage-pressure"><span class="secno">7.1</span> <span
                                class="content">ストレージのプレッシャー</span></a>
                    <li><a href="#ui-guidelines"><span class="secno">7.2</span> <span
                                class="content">ユーザーインターフェイスガイドライン</span></a>
                </ol>
            <li><a href="#api"><span class="secno">8</span> <span class="content">API</span></a>
            <li><a href="#acks"><span class="secno"></span> <span class="content">謝辞</span></a>
            <li><a href="#ipr"><span class="secno"></span> <span class="content">知的財産権</span></a>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">この仕様書で定義されている用語</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">他の参照で定義されている用語</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参照</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">規範的参照</span></a>
                </ol>
            <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL 索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span
                class="content">序章</span><a class="self-link" href="#introduction"></a></h2>
        <p>長年にわたり、ウェブにはIndexedDB、<code>localStorage</code>、<code>showNotification()</code>など、ストレージに使用できるさまざまなAPIが成長してきました。ストレージ標準は、以下を定義することでこれらのAPIを統合します:
        </p>
        <ul class="brief">
            <li>これらのAPIがデータを保存する基本単位であるバケット
            <li>そのバケットを永続化する方法
            <li><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin"
                    id="ref-for-concept-origin">オリジン</a>の使用量とクォータの推定値を取得する方法
        </ul>
        <p>従来、ユーザーのデバイスでストレージスペースが不足すると、これらのAPIで保存されたデータはユーザーが介入できないまま失われていました。しかし、永続バケットは、ユーザーの同意なしに削除することはできません。これにより、ネイティブプラットフォームでユーザーが享受していたデータ保証がウェブにもたらされます。
        </p>
        <div class="example" id="example-3a7051a8">
            <a class="self-link" href="#example-3a7051a8"></a>
            <p>ストレージを永続化する簡単な方法は、<code
                    class="idl"><a data-link-type="idl" href="#dom-storagemanager-persist" id="ref-for-dom-storagemanager-persist">persist()</a></code>
                メソッドを呼び出すことです。このメソッドは、エンドユーザーに許可をリクエストし、それが許可されるとストレージを永続化に変更します:</p>
            <pre><code class="lang-javascript highlight">navigator<c- p>.</c->storage<c- p>.</c->persist<c- p>().</c->then<c- p>(</c->persisted <c- p>=></c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c->persisted<c- p>)</c-> <c- p>{</c->
    <c- d>/* … */</c->
  <c- p>}</c->
<c- p>});</c->
</code></pre>
            <p>エンドユーザーに事前通知なしにユーザーエージェント駆動のダイアログを表示しないためには、少し複雑なコードを書くことができます:</p>
            <pre><code class="lang-javascript highlight">Promise<c- p>.</c->all<c- p>([</c->
  navigator<c- p>.</c->storage<c- p>.</c->persisted<c- p>(),</c->
  navigator<c- p>.</c->permissions<c- p>.</c->query<c- p>({</c->name<c- o>:</c-> <c- u>"persistent-storage"</c-><c- p>})</c->
<c- p>]).</c->then<c- p>(([</c->persisted<c- p>,</c-> permission<c- p>])</c-> <c- p>=></c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c-><c- o>!</c->persisted <c- o>&amp;&amp;</c-> permission<c- p>.</c->state <c- o>==</c-> <c- u>"granted"</c-><c- p>)</c-> <c- p>{</c->
    navigator<c- p>.</c->storage<c- p>.</c->persist<c- p>().</c->then<c- p>(</c-> <c- d>/* … */</c-> <c- p>);</c->
  <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c-><c- o>!</c->persisted <c- o>&amp;&amp;</c-> permission<c- p>.</c->state <c- o>==</c-> <c- u>"prompt"</c-><c- p>)</c-> <c- p>{</c->
    showPersistentStorageExplanation<c- p>();</c->
  <c- p>}</c->
<c- p>});</c->
</code></pre>
            <p><code
                    class="idl"><a data-link-type="idl" href="#dom-storagemanager-estimate" id="ref-for-dom-storagemanager-estimate">estimate()</a></code>
                メソッドは、アプリケーションのコンテンツを保存するのに十分なスペースが残っているかどうかを判断するために使用できます:</p>
            <pre><code class="lang-javascript highlight"><c- a>function</c-> retrieveNextChunk<c- p>(</c->nextChunkInfo<c- p>)</c-> <c- p>{</c->
  <c- k>return</c-> navigator<c- p>.</c->storage<c- p>.</c->estimate<c- p>().</c->then<c- p>(</c->info <c- p>=></c-> <c- p>{</c->
    <c- k>if</c-> <c- p>(</c->info<c- p>.</c->quota <c- o>-</c-> info<c- p>.</c->usage <c- o>></c-> nextChunkInfo<c- p>.</c->size<c- p>)</c-> <c- p>{</c->
      <c- k>return</c-> fetch<c- p>(</c->nextChunkInfo<c- p>.</c->url<c- p>);</c->
    <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
      <c- k>throw</c-> <c- ow>new</c-> <c- ne>Error</c-><c- p>(</c-><c- u>"insufficient space to store next chunk"</c-><c- p>);</c->
    <c- p>}</c->
  <c- p>}).</c->then<c- p>(</c-> <c- d>/* … */</c-> <c- p>);</c->
<c- p>}</c->
</code></pre>
        </div>
        <h2 class="heading settled" data-level="2" id="terminology"><span class="secno">2. </span><span
                class="content">用語</span><a class="self-link" href="#terminology"></a></h2>
        <p>この仕様はインフラ標準に依存します。<a data-link-type="biblio" href="#biblio-infra" title="Infra Standard">[INFRA]</a> </p>
        <p>この仕様はHTML、IDL、および許可標準の用語を使用します。<a data-link-type="biblio" href="#biblio-html"
                title="HTML Standard">[HTML]</a> <a data-link-type="biblio" href="#biblio-webidl"
                title="Web IDL Standard">[WEBIDL]</a> <a data-link-type="biblio" href="#biblio-permissions"
                title="Permissions">[PERMISSIONS]</a> </p>
        <h2 class="heading settled" data-level="3" id="infrastructure"><span class="secno">3. </span><span
                class="content">全体像</span><a class="self-link" href="#infrastructure"></a></h2>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent"
                id="ref-for-user-agent">ユーザーエージェント</a>
            には、さまざまな種類の準永続的な状態があります:</p>
        <dl>
            <dt>認証情報
            <dd>
                <p>HTMLフォームを通じて送信されたユーザー名やパスワードなどのエンドユーザー認証情報</p>
            <dt>許可
            <dd>
                <p>位置情報など、さまざまな機能の許可</p>
            <dt>ネットワーク
            <dd>
                <p>HTTPキャッシュ、クッキー、認証エントリ、TLSクライアント証明書</p>
            <dt id="site-storage"><a class="self-link" href="#site-storage"></a>ストレージ
            <dd>Indexed DB、キャッシュAPI、サービスワーカーレジストレーション、<code>localStorage</code>、
                <code>sessionStorage</code>、アプリケーションキャッシュ、通知など
        </dl>
        <p>この標準は主にストレージに関わるものです。</p>
        <h2 class="heading settled" data-level="4" id="model"><span class="secno">4. </span><span
                class="content">モデル</span><a class="self-link" href="#model"></a></h2>
        <p>ローカルまたはセッションストレージAPIを定義する標準は、<a data-link-type="dfn" href="#storage-endpoint"
                id="ref-for-storage-endpoint">ストレージエンドポイント</a>を定義し、それを<a data-link-type="dfn"
                href="#registered-storage-endpoints"
                id="ref-for-registered-storage-endpoints">登録</a>するためにこの標準を変更します。それらは、<a data-link-type="dfn"
                href="#obtain-a-local-storage-bottle-map"
                id="ref-for-obtain-a-local-storage-bottle-map">ローカルストレージボトルマップの取得</a>または<a data-link-type="dfn"
                href="#obtain-a-session-storage-bottle-map"
                id="ref-for-obtain-a-session-storage-bottle-map">セッションストレージボトルマップの取得</a>アルゴリズムを呼び出します。これにより以下のものが得られます:
        </p>
        <ul>
            <li>
                <p>失敗した場合、APIは例外をスローするか、<a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                        id="ref-for-environment-settings-object">環境設定オブジェクト</a>にストレージが利用できないことを示す必要があります。</p>
            <li>
                <p><a data-link-type="dfn" href="#storage-proxy-map"
                        id="ref-for-storage-proxy-map">ストレージプロキシマップ</a>で、これは<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#ordered-map"
                        id="ref-for-ordered-map">マップ</a>に類似して動作し、APIに適した方法でデータを保存するために使用されます。この標準は、他のAPI、<a
                        data-link-type="dfn" href="#storage-key" id="ref-for-storage-key">ストレージキー</a>および<a
                        data-link-type="dfn" href="#storage-type"
                        id="ref-for-storage-type">ストレージタイプ</a>からそのデータを分離することを担当します。</p>
        </ul>
        <p class="note" role="note">そのようなAPIの標準を定義している場合、この標準に対して助言やレビューを求める問題を提出することを検討してください。</p>
        <p><img alt="ストレージモデルの図（次の段落で説明されています）。" crossorigin height="815" src="assets/model-diagram.svg" width="434">
        </p>
        <p>このデータを分離するため、この標準は<a data-link-type="dfn" href="#storage-shed" id="ref-for-storage-shed">ストレージシェッド</a>を定義し、<a
                data-link-type="dfn" href="#storage-shelf" id="ref-for-storage-shelf">ストレージ棚</a>を<a data-link-type="dfn"
                href="#storage-key" id="ref-for-storage-key①">ストレージキー</a>で分割します。<a data-link-type="dfn"
                href="#storage-shelf" id="ref-for-storage-shelf①">ストレージ棚</a>はさらに<a data-link-type="dfn"
                href="#storage-bucket" id="ref-for-storage-bucket">ストレージバケット</a>で構成され、将来的には異なるストレージポリシーを可能にするため、複数の<a
                data-link-type="dfn" href="#storage-bucket"
                id="ref-for-storage-bucket①">ストレージバケット</a>で構成される可能性があります。そして最後に、<a data-link-type="dfn"
                href="#storage-bucket" id="ref-for-storage-bucket②">ストレージバケット</a>は、<a data-link-type="dfn"
                href="#storage-bottle" id="ref-for-storage-bottle">ストレージボトル</a>で構成され、各<a data-link-type="dfn"
                href="#storage-endpoint" id="ref-for-storage-endpoint①">ストレージエンドポイント</a>に対応する1つがあります。</p>
        <h3 class="heading settled" data-level="4.1" id="storage-endpoints"><span class="secno">4.1. </span><span
                class="content">ストレージエンドポイント</span><a class="self-link" href="#storage-endpoints"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="storage-endpoint">ストレージエンドポイント</dfn>とは、この標準で定義されたインフラストラクチャ、特に<a data-link-type="dfn"
                href="#storage-bottle" id="ref-for-storage-bottle①">ストレージボトル</a>を使用して、ストレージニーズを追跡する<a
                data-link-type="dfn" href="#local-storage" id="ref-for-local-storage">ローカル</a>または<a data-link-type="dfn"
                href="#session-storage" id="ref-for-session-storage">セッションストレージ</a>APIです。
        </p>
        <p><a data-link-type="dfn" href="#storage-endpoint" id="ref-for-storage-endpoint②">ストレージエンドポイント</a>には、<dfn
                class="dfn-paneled" data-dfn-for="storage endpoint" data-dfn-type="dfn" data-noexport
                id="storage-endpoint-identifier">識別子</dfn>があり、これは<a data-link-type="dfn" href="#storage-identifier"
                id="ref-for-storage-identifier">ストレージ識別子</a>です。
        </p>
        <p><a data-link-type="dfn" href="#storage-endpoint" id="ref-for-storage-endpoint③">ストレージエンドポイント</a>には、さらに<dfn
                class="dfn-paneled" data-dfn-for="storage endpoint" data-dfn-type="dfn" data-noexport
                id="storage-endpoint-types">タイプ</dfn>があり、これは<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">セット</a>の<a
                data-link-type="dfn" href="#storage-type" id="ref-for-storage-type①">ストレージタイプ</a>です。</p>
        <p><a data-link-type="dfn" href="#storage-endpoint" id="ref-for-storage-endpoint④">ストレージエンドポイント</a>には、さらに<dfn
                class="dfn-paneled" data-dfn-for="storage endpoint" data-dfn-type="dfn" data-noexport
                id="storage-endpoint-quota">クォータ</dfn>があり、これはヌルまたはこの<a data-link-type="dfn" href="#storage-endpoint"
                id="ref-for-storage-endpoint⑤">ストレージエンドポイント</a>に対応する各<a data-link-type="dfn"
                href="#storage-bottle-quota" id="ref-for-storage-bottle-quota">クォータ</a>（バイト単位）を表す推奨値です。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="storage-identifier">ストレージ識別子</dfn>は、<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                id="ref-for-ascii-string">ASCII文字列</a>です。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="storage-type">ストレージタイプ</dfn>は、"<code>local</code>"または"<code>session</code>"です。</p>
        <hr>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="registered-storage-endpoints">登録されたストレージエンドポイント</dfn>は、以下の表で定義された<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①">セット</a>の<a
                data-link-type="dfn" href="#storage-endpoint" id="ref-for-storage-endpoint⑥">ストレージエンドポイント</a>です。</p>
        <table>
            <tbody>
                <tr>
                    <th><a data-link-type="dfn" href="#storage-endpoint-identifier"
                            id="ref-for-storage-endpoint-identifier">識別子</a>
                    <th><a data-link-type="dfn" href="#storage-endpoint-types"
                            id="ref-for-storage-endpoint-types">タイプ</a>
                    <th><a data-link-type="dfn" href="#storage-endpoint-quota"
                            id="ref-for-storage-endpoint-quota">クォータ</a>
                <tr>
                    <td>"<code>caches</code>"
                    <td>« "<code>local</code>" »
                    <td>null
                <tr>
                    <td>"<code>indexedDB</code>"
                    <td>« "<code>local</code>" »
                    <td>null
                <tr>
                    <td>"<code>localStorage</code>"
                    <td>« "<code>local</code>" »
                    <td>5 × 2<sup>20</sup>（つまり、5メビバイト）
                <tr>
                    <td>"<code>serviceWorkerRegistrations</code>"
                    <td>« "<code>local</code>" »
                    <td>null
                <tr>
                    <td>"<code>sessionStorage</code>"
                    <td>« "<code>session</code>" »
                    <td>5 × 2<sup>20</sup>（つまり、5メビバイト）
        </table>
        <p class="note" role="note">前述のように、標準はこれらの<a data-link-type="dfn" href="#storage-identifier"
                id="ref-for-storage-identifier①">ストレージ識別子</a>を使用して、<a data-link-type="dfn"
                href="#obtain-a-local-storage-bottle-map"
                id="ref-for-obtain-a-local-storage-bottle-map①">ローカルストレージボトルマップの取得</a>や<a data-link-type="dfn"
                href="#obtain-a-session-storage-bottle-map"
                id="ref-for-obtain-a-session-storage-bottle-map①">セッションストレージボトルマップの取得</a>を行うことができます。今後、一部のAPIは両方の<a
                data-link-type="dfn" href="#storage-type" id="ref-for-storage-type②">ストレージタイプ</a>に適用されると予想されています。</p>
        <h3 class="heading settled" data-level="4.2" id="storage-keys"><span class="secno">4.2. </span><span
                class="content">ストレージキー</span><a class="self-link" href="#storage-keys"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="storage-key">ストレージキー</dfn>とは、<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#tuple" id="ref-for-tuple">タプル</a>であり、<dfn
                class="dfn-paneled" data-dfn-for="storage key" data-dfn-type="dfn" data-noexport
                id="storage-key-origin">オリジン</dfn>（<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin"
                id="ref-for-concept-origin①">オリジン</a>）で構成されます。<a data-link-type="biblio" href="#biblio-html"
                title="HTML Standard">[HTML]</a> </p>
        <p class="XXX">これは変更される可能性があります。詳しくは<a
                href="https://privacycg.github.io/storage-partitioning/">クライアントサイドストレージの分割</a>を参照してください。</p>
        <div class="algorithm" data-algorithm="obtain a storage key">
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="obtain-a-storage-key">ストレージキーを取得する</dfn>には、<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#environment"
                    id="ref-for-environment">環境</a> <var>environment</var> が与えられた場合、次の手順を実行します:</p>
            <ol>
                <li>
                    <p><var>key</var>を、<var>environment</var>を使用して<a data-link-type="dfn"
                            href="#obtain-a-storage-key-for-non-storage-purposes"
                            id="ref-for-obtain-a-storage-key-for-non-storage-purposes">ストレージ目的以外でストレージキーを取得する</a>を実行した結果とします。
                    </p>
                <li>
                    <p><var>key</var>の<a data-link-type="dfn" href="#storage-key-origin"
                            id="ref-for-storage-key-origin">オリジン</a>が<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque"
                            id="ref-for-concept-origin-opaque">不透明なオリジン</a>である場合、失敗を返します。</p>
                <li>
                    <p>ユーザーがストレージを無効にしている場合、失敗を返します。</p>
                <li>
                    <p><var>key</var>を返します。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="obtain a storage key for non-storage purposes">
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="obtain-a-storage-key-for-non-storage-purposes">ストレージ目的以外でストレージキーを取得する</dfn>には、<a
                    data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment"
                    id="ref-for-environment①">環境</a> <var>environment</var> が与えられた場合、次の手順を実行します:</p>
            <ol>
                <li>
                    <p><var>environment</var>が<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                            id="ref-for-environment-settings-object①">環境設定オブジェクト</a>である場合、<var>environment</var>の<a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                            id="ref-for-concept-settings-object-origin">オリジン</a>を<var>origin</var>とします。それ以外の場合、<var>environment</var>の<a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
                            id="ref-for-concept-environment-creation-url">作成URL</a>の<a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-url-origin"
                            id="ref-for-concept-url-origin">オリジン</a>を<var>origin</var>とします。</p>
                <li>
                    <p><var>origin</var>で構成された<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#tuple"
                            id="ref-for-tuple①">タプル</a>を返します。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="equal" data-algorithm-for="storage key">
            <p><a data-link-type="dfn" href="#storage-key" id="ref-for-storage-key②">ストレージキー</a> <var>A</var> と<a
                    data-link-type="dfn" href="#storage-key" id="ref-for-storage-key③">ストレージキー</a> <var>B</var> が<dfn
                    class="dfn-paneled" data-dfn-for="storage key" data-dfn-type="dfn" data-export data-lt="equal"
                    id="storage-key-equal">等しい</dfn>かどうかを判定するには、次の手順を実行します:</p>
            <ol>
                <li>
                    <p><var>A</var>の<a data-link-type="dfn" href="#storage-key-origin"
                            id="ref-for-storage-key-origin①">オリジン</a>が<var>B</var>の<a data-link-type="dfn"
                            href="#storage-key-origin" id="ref-for-storage-key-origin②">オリジン</a>と<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin"
                            id="ref-for-same-origin">同一オリジン</a>でない場合、falseを返します。</p>
                <li>
                    <p>trueを返します。</p>
            </ol>
        </div>
        <h3 class="heading settled" data-level="4.3" id="storage-sheds"><span class="secno">4.3. </span><span
                class="content">ストレージシェッド</span><a class="self-link" href="#storage-sheds"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="storage-shed">ストレージシェッド</dfn>とは、<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
                id="ref-for-ordered-map①">マップ</a>であり、<a data-link-type="dfn" href="#storage-key"
                id="ref-for-storage-key④">ストレージキー</a>を<a data-link-type="dfn" href="#storage-shelf"
                id="ref-for-storage-shelf②">ストレージ棚</a>にマッピングします。初期状態では空です。</p>
        <hr>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent"
                id="ref-for-user-agent①">ユーザーエージェント</a>は、<dfn class="dfn-paneled" data-dfn-for="user agent"
                data-dfn-type="dfn" data-noexport id="user-agent-storage-shed">ストレージシェッド</dfn>を保持します。これは<a
                data-link-type="dfn" href="#storage-shed" id="ref-for-storage-shed①">ストレージシェッド</a>です。ユーザーエージェントの<a
                data-link-type="dfn" href="#user-agent-storage-shed"
                id="ref-for-user-agent-storage-shed">ストレージシェッド</a>には、すべての<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-noexport id="local-storage">ローカルストレージ</dfn>データが含まれます。</p>
        <p><a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable"
                id="ref-for-traversable-navigable">移動可能ナビゲーブル</a>は、<dfn class="dfn-paneled"
                data-dfn-for="traversable navigable" data-dfn-type="dfn" data-noexport
                id="traversable-navigable-storage-shed"><span class="bs-old-id"
                    id="browsing-session-storage-shed"></span>ストレージシェッド</dfn>を保持します。これは<a data-link-type="dfn"
                href="#storage-shed" id="ref-for-storage-shed②">ストレージシェッド</a>です。<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable"
                id="ref-for-traversable-navigable①">移動可能ナビゲーブル</a>の<a data-link-type="dfn"
                href="#traversable-navigable-storage-shed"
                id="ref-for-traversable-navigable-storage-shed">ストレージシェッド</a>には、すべての<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-noexport id="session-storage">セッションストレージ</dfn>データが含まれます。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="legacy-clone-a-traversable-storage-shed"><span
                    class="bs-old-id"
                    id="legacy-clone-a-browsing-session-storage-shed"></span>移動可能ストレージシェッドのレガシークローン</dfn>を実行するには、<a
                data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable"
                id="ref-for-traversable-navigable②">移動可能ナビゲーブル</a> <var>A</var> と <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable"
                id="ref-for-traversable-navigable③">移動可能ナビゲーブル</a> <var>B</var> が与えられた場合、次の手順を実行します:</p>
        <ol>
            <li>
                <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                        id="ref-for-map-iterate">各</a> <var>key</var> → <var>shelf</var> について、<var>A</var>の<a
                        data-link-type="dfn" href="#traversable-navigable-storage-shed"
                        id="ref-for-traversable-navigable-storage-shed①">ストレージシェッド</a>を反復します:</p>
                <ol>
                    <li>
                        <p>"<code>session</code>"を使用して<a data-link-type="dfn" href="#create-a-storage-shelf"
                                id="ref-for-create-a-storage-shelf">ストレージ棚を作成する</a>を実行した結果を<var>newShelf</var>とします。</p>
                    <li>
                        <p><var>newShelf</var>の<a data-link-type="dfn" href="#bucket-map"
                                id="ref-for-bucket-map">バケットマップ</a>["<code>default</code>"]の<a data-link-type="dfn"
                                href="#bottle-map" id="ref-for-bottle-map">ボトルマップ</a>["<code>sessionStorage</code>"]の<a
                                data-link-type="dfn" href="#storage-bottle-map"
                                id="ref-for-storage-bottle-map">マップ</a>を、<var>shelf</var>の<a data-link-type="dfn"
                                href="#bucket-map" id="ref-for-bucket-map①">バケットマップ</a>["<code>default</code>"]の<a
                                data-link-type="dfn" href="#bottle-map"
                                id="ref-for-bottle-map①">ボトルマップ</a>["<code>sessionStorage</code>"]の<a
                                data-link-type="dfn" href="#storage-bottle-map"
                                id="ref-for-storage-bottle-map①">マップ</a>の<a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#map-clone" id="ref-for-map-clone">クローン</a>に設定します。
                        </p>
                    <li>
                        <p><var>B</var>の<a data-link-type="dfn" href="#traversable-navigable-storage-shed"
                                id="ref-for-traversable-navigable-storage-shed②">ストレージシェッド</a>[<var>key</var>]を<var>newShelf</var>に設定します。
                        </p>
                </ol>
        </ol>
        <p class="note" role="note">
            これはレガシーと見なされ、利点があったとしても実装の複雑さを上回るものではありません。そのため、<cite>HTML</cite>以外では拡張されたり使用されたりすることはありません。<a
                data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a></p>
        <h3 class="heading settled" data-level="4.4" id="storage-shelves"><span class="secno">4.4. </span><span
                class="content">ストレージ棚</span><a class="self-link" href="#storage-shelves"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="storage shelf|storage shelves" data-noexport
                id="storage-shelf"><span class="bs-old-id" id="site-storage-unit"></span>ストレージ棚</dfn>は、<a
                data-link-type="dfn" href="#storage-shed" id="ref-for-storage-shed③">ストレージシェッド</a>内の各<a
                data-link-type="dfn" href="#storage-key" id="ref-for-storage-key⑤">ストレージキー</a>ごとに存在します。これは<a
                data-link-type="dfn" href="#storage-bucket" id="ref-for-storage-bucket③">ストレージバケット</a>へマッピングする<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
                id="ref-for-ordered-map②">マップ</a>である<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="bucket-map">バケットマップ</dfn>を保持します。</p>
        <p class="note" role="note">現在のところ、"<code>default</code>"は<a data-link-type="dfn" href="#bucket-map"
                id="ref-for-bucket-map②">バケットマップ</a>内に存在する唯一の<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#map-key" id="ref-for-map-key">キー</a>です。詳しくは<a
                href="https://github.com/whatwg/storage/issues/2">issue #2</a>を参照してください。これは初めて<a data-link-type="dfn"
                href="#storage-shelf" id="ref-for-storage-shelf③">ストレージ棚</a>が<a data-link-type="dfn"
                href="#obtain-a-storage-shelf" id="ref-for-obtain-a-storage-shelf">取得</a>されたときに<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#map-value" id="ref-for-map-value">値</a>が与えられます。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-storage-shelf">ストレージ棚を取得する</dfn>には、<a
                data-link-type="dfn" href="#storage-shed" id="ref-for-storage-shed④">ストレージシェッド</a> <var>shed</var>、<a
                data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object②">環境設定オブジェクト</a> <var>environment</var>、および<a
                data-link-type="dfn" href="#storage-type" id="ref-for-storage-type③">ストレージタイプ</a>
            <var>type</var>が与えられた場合、次の手順を実行します:
        </p>
        <ol>
            <li>
                <p><var>key</var>を、<var>environment</var>を使用して<a data-link-type="dfn" href="#obtain-a-storage-key"
                        id="ref-for-obtain-a-storage-key">ストレージキーを取得する</a>を実行した結果とします。</p>
            <li>
                <p><var>key</var>が失敗の場合、失敗を返します。</p>
            <li>
                <p><var>shed</var>[<var>key</var>]が<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#map-exists"
                        id="ref-for-map-exists">存在しない</a>場合、<var>shed</var>[<var>key</var>]を<a data-link-type="dfn"
                        href="#create-a-storage-shelf"
                        id="ref-for-create-a-storage-shelf①">ストレージ棚を作成する</a>を<var>type</var>で実行した結果に設定します。</p>
            <li>
                <p><var>shed</var>[<var>key</var>]を返します。</p>
        </ol>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="obtain-a-local-storage-shelf">ローカルストレージ棚を取得する</dfn>には、<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object③">環境設定オブジェクト</a> <var>environment</var>が与えられた場合、次の値を返します:
            ユーザーエージェントの<a data-link-type="dfn" href="#user-agent-storage-shed"
                id="ref-for-user-agent-storage-shed①">ストレージシェッド</a>、<var>environment</var>、および"<code>local</code>"を用いて<a
                data-link-type="dfn" href="#obtain-a-storage-shelf"
                id="ref-for-obtain-a-storage-shelf①">ストレージ棚を取得する</a>を実行した結果。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-storage-shelf">ストレージ棚を作成する</dfn>には、<a
                data-link-type="dfn" href="#storage-type" id="ref-for-storage-type④">ストレージタイプ</a>
            <var>type</var>が与えられた場合、次の手順を実行します:
        </p>
        <ol>
            <li>
                <p><var>shelf</var>を新しい<a data-link-type="dfn" href="#storage-shelf"
                        id="ref-for-storage-shelf④">ストレージ棚</a>に設定します。</p>
            <li>
                <p><var>shelf</var>の<a data-link-type="dfn" href="#bucket-map"
                        id="ref-for-bucket-map③">バケットマップ</a>["<code>default</code>"]を<a data-link-type="dfn"
                        href="#create-a-storage-bucket"
                        id="ref-for-create-a-storage-bucket">ストレージバケットを作成する</a>を<var>type</var>で実行した結果に設定します。</p>
            <li>
                <p><var>shelf</var>を返します。</p>
        </ol>
        <h3 class="heading settled" data-level="4.5" id="buckets"><span class="secno">4.5. </span><span
                class="bs-old-id" id="boxes"></span><span class="content">ストレージバケット</span><a class="self-link"
                href="#buckets"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="storage-bucket">ストレージバケット</dfn>は、<a
                data-link-type="dfn" href="#storage-endpoint"
                id="ref-for-storage-endpoint⑦">ストレージエンドポイント</a>がデータを保存する場所です。</p>
        <p><a data-link-type="dfn" href="#storage-bucket" id="ref-for-storage-bucket④">ストレージバケット</a>には、<a
                data-link-type="dfn" href="#storage-identifier" id="ref-for-storage-identifier②">ストレージ識別子</a>を<a
                data-link-type="dfn" href="#storage-bottle" id="ref-for-storage-bottle③">ストレージボトル</a>にマッピングする<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-noexport id="bottle-map">ボトルマップ</dfn>があります。</p>
        <hr>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="bucket"><span class="bs-old-id"
                    id="box"></span>ローカルストレージバケット</dfn>は、<a data-link-type="dfn" href="#local-storage"
                id="ref-for-local-storage①">ローカルストレージ</a>API用の<a data-link-type="dfn" href="#storage-bucket"
                id="ref-for-storage-bucket⑤">ストレージバケット</a>です。</p>
        <p><a data-link-type="dfn" href="#bucket"
                id="ref-for-bucket">ローカルストレージバケット</a>には、"<code>best-effort</code>"または"<code>persistent</code>"である<dfn
                class="dfn-paneled" data-dfn-for="local storage bucket" data-dfn-type="dfn" data-noexport
                id="bucket-mode"><span class="bs-old-id"
                    id="box-mode"></span>モード</dfn>があります。初期状態では"<code>best-effort</code>"です。</p>
        <hr>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="session-storage-bucket">セッションストレージバケット</dfn>は、<a data-link-type="dfn" href="#session-storage"
                id="ref-for-session-storage①">セッションストレージ</a>API用の<a data-link-type="dfn" href="#storage-bucket"
                id="ref-for-storage-bucket⑥">ストレージバケット</a>です。</p>
        <hr>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="create-a-storage-bucket">ストレージバケットを作成する</dfn>には、<a data-link-type="dfn" href="#storage-type"
                id="ref-for-storage-type⑤">ストレージタイプ</a> <var>type</var>が与えられた場合、次の手順を実行します:</p>
        <ol>
            <li>
                <p><var>bucket</var>をnullに設定します。</p>
            <li>
                <p><var>type</var>が"<code>local</code>"の場合、<var>bucket</var>を新しい<a data-link-type="dfn" href="#bucket"
                        id="ref-for-bucket①">ローカルストレージバケット</a>に設定します。</p>
            <li>
                <p>それ以外の場合:</p>
                <ol>
                    <li>
                        <p>アサート: <var>type</var>が"<code>session</code>"である。</p>
                    <li>
                        <p><var>bucket</var>を新しい<a data-link-type="dfn" href="#session-storage-bucket"
                                id="ref-for-session-storage-bucket">セッションストレージバケット</a>に設定します。</p>
                </ol>
            <li>
                <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                        id="ref-for-list-iterate">各</a><var>endpoint</var>について、<a data-link-type="dfn"
                        href="#registered-storage-endpoints"
                        id="ref-for-registered-storage-endpoints①">登録されたストレージエンドポイント</a>の中で、その<a data-link-type="dfn"
                        href="#storage-endpoint-types" id="ref-for-storage-endpoint-types①">タイプ</a>が<var>type</var>を<a
                        data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain"
                        id="ref-for-list-contain">含む</a>場合、<var>bucket</var>の<a data-link-type="dfn" href="#bottle-map"
                        id="ref-for-bottle-map②">ボトルマップ</a>[<var>endpoint</var>の<a data-link-type="dfn"
                        href="#storage-endpoint-identifier" id="ref-for-storage-endpoint-identifier①">識別子</a>]を、<a
                        data-link-type="dfn" href="#storage-bottle"
                        id="ref-for-storage-bottle④">ストレージボトル</a>の新しいインスタンスに設定し、その<a data-link-type="dfn"
                        href="#storage-bottle-quota" id="ref-for-storage-bottle-quota①">クォータ</a>を<var>endpoint</var>の<a
                        data-link-type="dfn" href="#storage-endpoint-quota"
                        id="ref-for-storage-endpoint-quota①">クォータ</a>に設定します。</p>
            <li>
                <p><var>bucket</var>を返します。</p>
        </ol>
        <h3 class="heading settled" data-level="4.6" id="storage-bottles"><span class="secno">4.6. </span><span
                class="content">ストレージボトル</span><a class="self-link" href="#storage-bottles"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="storage-bottle">ストレージボトル</dfn>とは、単一の<a
                data-link-type="dfn" href="#storage-endpoint" id="ref-for-storage-endpoint⑧">ストレージエンドポイント</a>専用に区切られた<a
                data-link-type="dfn" href="#storage-bucket" id="ref-for-storage-bucket⑦">ストレージバケット</a>の一部です。<a
                data-link-type="dfn" href="#storage-bottle" id="ref-for-storage-bottle⑤">ストレージボトル</a>には、初期状態で空の<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
                id="ref-for-ordered-map③">マップ</a>である<dfn class="dfn-paneled" data-dfn-for="storage bottle"
                data-dfn-type="dfn" data-noexport id="storage-bottle-map">マップ</dfn>があります。また、<a data-link-type="dfn"
                href="#storage-bottle" id="ref-for-storage-bottle⑥">ストレージボトル</a>には、初期状態で空の<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set②">セット</a>である<dfn
                class="dfn-paneled" data-dfn-for="storage bottle" data-dfn-type="dfn" data-noexport
                id="storage-bottle-proxy-map-reference-set">プロキシマップ参照セット</dfn>があります。また、<a data-link-type="dfn"
                href="#storage-bottle" id="ref-for-storage-bottle⑦">ストレージボトル</a>には、保持できるバイト数の保守的な推定値を表す数値またはヌルである<dfn
                class="dfn-paneled" data-dfn-for="storage bottle" data-dfn-type="dfn" data-noexport
                id="storage-bottle-quota">クォータ</dfn>があります。ヌルは制限がないことを示します。<span class="note">それでも、包含する<a
                    data-link-type="dfn" href="#storage-shelf" id="ref-for-storage-shelf⑤">ストレージ棚</a>の<a
                    data-link-type="dfn" href="#storage-quota" id="ref-for-storage-quota">ストレージクォータ</a>に制約されます。</span>
        </p>
        <p><a data-link-type="dfn" href="#storage-bottle" id="ref-for-storage-bottle⑧">ストレージボトル</a>の<a
                data-link-type="dfn" href="#storage-bottle-map"
                id="ref-for-storage-bottle-map②">マップ</a>は、実際に保存されるデータが存在する場所です。ユーザーエージェントは、このデータを保存し、<a
                data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-agents"
                id="ref-for-sec-agents">エージェント</a>や<a data-link-type="dfn"
                href="https://tc39.github.io/ecma262/#sec-agent-clusters"
                id="ref-for-sec-agent-clusters">エージェントクラスター</a>の境界を越えて、この標準およびこの標準を使用する標準が内容にアクセスできるようにするために、<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined"
                id="ref-for-implementation-defined">実装定義</a>の方法で利用可能にすることが期待されています。</p>
        <hr>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="obtain-a-storage-bottle-map">ストレージボトルマップを取得する</dfn>には、<a data-link-type="dfn" href="#storage-type"
                id="ref-for-storage-type⑥">ストレージタイプ</a> <var>type</var>、<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object④">環境設定オブジェクト</a> <var>environment</var>、および<a
                data-link-type="dfn" href="#storage-identifier" id="ref-for-storage-identifier③">ストレージ識別子</a>
            <var>identifier</var>が与えられた場合、次の手順を実行します:
        </p>
        <ol>
            <li>
                <p><var>shed</var>をnullに設定します。</p>
            <li>
                <p><var>type</var>が"<code>local</code>"の場合、<var>shed</var>をユーザーエージェントの<a data-link-type="dfn"
                        href="#user-agent-storage-shed" id="ref-for-user-agent-storage-shed②">ストレージシェッド</a>に設定します。</p>
            <li>
                <p>それ以外の場合:</p>
                <ol>
                    <li>
                        <p>アサート: <var>type</var>が"<code>session</code>"である。</p>
                    <li>
                        <p><var>shed</var>を<var>environment</var>の<a data-link-type="dfn"
                                href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                                id="ref-for-global-object">グローバルオブジェクト</a>の<a data-link-type="dfn"
                                href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window"
                                id="ref-for-concept-document-window">関連付けられた<code>Document</code></a>の<a
                                data-link-type="dfn"
                                href="https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable"
                                id="ref-for-node-navigable">ノードナビゲーブル</a>の<a data-link-type="dfn"
                                href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-traversable"
                                id="ref-for-nav-traversable">移動可能ナビゲーブル</a>の<a data-link-type="dfn"
                                href="#traversable-navigable-storage-shed"
                                id="ref-for-traversable-navigable-storage-shed③">ストレージシェッド</a>に設定します。</p>
                </ol>
            <li>
                <p><var>shelf</var>を<var>shed</var>、<var>environment</var>、および<var>type</var>を使用して<a
                        data-link-type="dfn" href="#obtain-a-storage-shelf"
                        id="ref-for-obtain-a-storage-shelf②">ストレージ棚を取得する</a>を実行した結果に設定します。</p>
            <li>
                <p><var>shelf</var>が失敗の場合、失敗を返します。</p>
            <li>
                <p><var>bucket</var>を<var>shelf</var>の<a data-link-type="dfn" href="#bucket-map"
                        id="ref-for-bucket-map④">バケットマップ</a>["<code>default</code>"]に設定します。</p>
            <li>
                <p><var>bottle</var>を<var>bucket</var>の<a data-link-type="dfn" href="#bottle-map"
                        id="ref-for-bottle-map③">ボトルマップ</a>[<var>identifier</var>]に設定します。</p>
            <li>
                <p><var>proxyMap</var>を新しい<a data-link-type="dfn" href="#storage-proxy-map"
                        id="ref-for-storage-proxy-map①">ストレージプロキシマップ</a>に設定し、その<a data-link-type="dfn"
                        href="#storage-proxy-map-backing-map"
                        id="ref-for-storage-proxy-map-backing-map">バッキングマップ</a>を<var>bottle</var>の<a
                        data-link-type="dfn" href="#storage-bottle-map" id="ref-for-storage-bottle-map③">マップ</a>に設定します。
                </p>
            <li>
                <p><var>bottle</var>の<a data-link-type="dfn" href="#storage-bottle-proxy-map-reference-set"
                        id="ref-for-storage-bottle-proxy-map-reference-set">プロキシマップ参照セット</a>に<var>proxyMap</var>を<a
                        data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append"
                        id="ref-for-set-append">追加</a>します。</p>
            <li>
                <p><var>proxyMap</var>を返します。</p>
        </ol>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="obtain-a-local-storage-bottle-map">ローカルストレージボトルマップを取得する</dfn>には、<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object⑤">環境設定オブジェクト</a> <var>environment</var>および<a
                data-link-type="dfn" href="#storage-identifier" id="ref-for-storage-identifier④">ストレージ識別子</a>
            <var>identifier</var>が与えられた場合、"<code>local</code>"、<var>environment</var>、および<var>identifier</var>を使用して<a
                data-link-type="dfn" href="#obtain-a-storage-bottle-map"
                id="ref-for-obtain-a-storage-bottle-map">ストレージボトルマップを取得する</a>を実行した結果を返します。
        </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="obtain-a-session-storage-bottle-map">セッションストレージボトルマップを取得する</dfn>には、<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object⑥">環境設定オブジェクト</a> <var>environment</var>および<a
                data-link-type="dfn" href="#storage-identifier" id="ref-for-storage-identifier⑤">ストレージ識別子</a>
            <var>identifier</var>が与えられた場合、"<code>session</code>"、<var>environment</var>、および<var>identifier</var>を使用して<a
                data-link-type="dfn" href="#obtain-a-storage-bottle-map"
                id="ref-for-obtain-a-storage-bottle-map①">ストレージボトルマップを取得する</a>を実行した結果を返します。
        </p>
        <h3 class="heading settled" data-level="4.7" id="storage-proxy-maps"><span class="secno">4.7. </span><span
                class="content">ストレージプロキシマップ</span><a class="self-link" href="#storage-proxy-maps"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="storage-proxy-map">ストレージプロキシマップ</dfn>は、<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
                id="ref-for-ordered-map④">マップ</a>と同等ですが、すべての操作がその<dfn class="dfn-paneled"
                data-dfn-for="storage proxy map" data-dfn-type="dfn" data-noexport
                id="storage-proxy-map-backing-map">バッキングマップ</dfn>上で実行されます。</p>
        <p class="XXX">これにより、<a data-link-type="dfn" href="#storage-proxy-map-backing-map"
                id="ref-for-storage-proxy-map-backing-map①">バッキングマップ</a>を置き換えることが可能になります。これは<a
                href="https://github.com/whatwg/storage/issues/4">issue #4</a>および潜在的に<a
                href="https://privacycg.github.io/storage-access/">Storage Access API</a>に必要です。</p>
        <h3 class="heading settled" data-level="4.8" id="storage-task-source"><span class="secno">4.8. </span><span
                class="content">ストレージタスクソース</span><a class="self-link" href="#storage-task-source"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="task-source">ストレージタスクソース</dfn>は、<a
                data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source"
                id="ref-for-task-source">タスクソース</a>であり、<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task"
                id="ref-for-concept-task">タスク</a>に関連するすべての<a data-link-type="dfn" href="#storage-endpoint"
                id="ref-for-storage-endpoint⑨">ストレージエンドポイント</a>、特に<a data-link-type="dfn" href="#storage-endpoint"
                id="ref-for-storage-endpoint①⓪">ストレージエンドポイント</a>の<a data-link-type="dfn" href="#storage-endpoint-quota"
                id="ref-for-storage-endpoint-quota②">クォータ</a>に関連するものに使用されます。</p>
        <div class="algorithm" data-algorithm="queue a storage task">
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="queue-a-storage-task">ストレージタスクをキューに追加する</dfn>には、<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                    id="ref-for-global-object①">グローバルオブジェクト</a> <var>global</var> と一連の手順 <var>steps</var> が与えられた場合、<a
                    data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task"
                    id="ref-for-queue-a-global-task">グローバルタスクをキューに追加する</a>を<a data-link-type="dfn" href="#task-source"
                    id="ref-for-task-source①">ストレージタスクソース</a>で<var>global</var>および<var>steps</var>を指定して実行します。</p>
        </div>
        <h2 class="heading settled" data-level="5" id="persistence"><span class="secno">5. </span><span
                class="content">永続性の許可</span><a class="self-link" href="#persistence"></a></h2>
        <p><a data-link-type="dfn" href="#bucket"
                id="ref-for-bucket②">ローカルストレージバケット</a>は、ユーザー（またはユーザーに代わってユーザーエージェント）が"<code>persistent-storage</code>"の使用を許可する<a
                data-link-type="dfn" href="https://w3c.github.io/permissions/#dfn-powerful-feature"
                id="ref-for-dfn-powerful-feature">強力な機能</a>への許可を与えた場合にのみ、その<a data-link-type="dfn" href="#bucket-mode"
                id="ref-for-bucket-mode">モード</a>を"<code>persistent</code>"に変更できます。</p>
        <p class="note" role="note">ある<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin"
                id="ref-for-concept-origin②">オリジン</a>に許可が与えられると、永続性の許可を使用して、ユーザーエージェントのクリアポリシーからストレージを保護できます。永続性としてマークされたストレージは、<a
                data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin"
                id="ref-for-concept-origin③">オリジン</a>またはユーザーの関与なしにユーザーエージェントによってクリアされることはありません。これにより、オフライン時にユーザーが必要とするリソースや、ユーザーがローカルで作成するリソースに特に有用です。
        </p>
        <p>"<code>persistent-storage</code>"の<a data-link-type="dfn"
                href="https://w3c.github.io/permissions/#dfn-powerful-feature"
                id="ref-for-dfn-powerful-feature①">強力な機能</a>の許可関連アルゴリズムおよびタイプはデフォルトですが、以下を除きます:</p>
        <dl>
            <dt><a data-link-type="dfn" href="https://w3c.github.io/permissions/#dfn-permission-state"
                    id="ref-for-dfn-permission-state">許可状態</a>
            <dd>
                <p>"<code>persistent-storage</code>"の<a data-link-type="dfn"
                        href="https://w3c.github.io/permissions/#dfn-permission-state"
                        id="ref-for-dfn-permission-state①">許可状態</a>は、与えられた<a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                        id="ref-for-environment-settings-object⑦">環境設定オブジェクト</a>のすべてで同じ<a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                        id="ref-for-concept-settings-object-origin①">オリジン</a>を持つ必要があります。</p>
            <dt><a data-link-type="dfn" href="https://w3c.github.io/permissions/#dfn-permission-revocation-algorithm"
                    id="ref-for-dfn-permission-revocation-algorithm">許可の取り消しアルゴリズム</a>
            <dd class="algorithm" data-algorithm="permission-revocation">
                <ol>
                    <li>
                        <p>"<code>persistent-storage</code>"で<a data-link-type="dfn"
                                href="https://w3c.github.io/permissions/#dfn-getting-the-current-permission-state"
                                id="ref-for-dfn-getting-the-current-permission-state">現在の許可状態を取得する</a>の結果が"<code
                                class="idl"><a data-link-type="idl" href="https://w3c.github.io/permissions/#dom-permissionstate-granted" id="ref-for-dom-permissionstate-granted">granted</a></code>"の場合、終了します。
                        </p>
                    <li>
                        <p><var>shelf</var>を、<a data-link-type="dfn" href="#obtain-a-local-storage-shelf"
                                id="ref-for-obtain-a-local-storage-shelf">ローカルストレージ棚を取得する</a>を<a data-link-type="dfn"
                                href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object"
                                id="ref-for-current-settings-object">現在の設定オブジェクト</a>で実行した結果に設定します。</p>
                    <li>
                        <p><var>shelf</var>の<a data-link-type="dfn" href="#bucket-map"
                                id="ref-for-bucket-map⑤">バケットマップ</a>["<code>default</code>"]の<a data-link-type="dfn"
                                href="#bucket-mode" id="ref-for-bucket-mode①">モード</a>を"<code>best-effort</code>"に設定します。
                        </p>
                </ol>
        </dl>
        <h2 class="heading settled" data-level="6" id="usage-and-quota"><span class="secno">6. </span><span
                class="content">使用量とクォータ</span><a class="self-link" href="#usage-and-quota"></a></h2>
        <p><a data-link-type="dfn" href="#storage-shelf" id="ref-for-storage-shelf⑥">ストレージ棚</a>の<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-export id="storage-usage">ストレージ使用量</dfn>は、使用されているバイト数の<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#implementation-defined"
                id="ref-for-implementation-defined①">実装定義</a>によるおおよその推定値です。</p>
        <p class="note" role="note">これは正確な量ではありません。ユーザーエージェントは、重複排除、圧縮、およびその他の技術を使用して、<a data-link-type="dfn"
                href="#storage-shelf" id="ref-for-storage-shelf⑦">ストレージ棚</a>が使用するバイト数を正確に把握できないようにすることが奨励されています。</p>
        <p><a class="tracking-vector" href="https://infra.spec.whatwg.org/#tracking-vector"
                style="color: currentcolor"><img alt="(これは追跡ベクトルです。)" class="darkmode-aware" crossorigin height="64"
                    src="https://resources.whatwg.org/tracking-vector.svg" title="ここに追跡ベクトルがあります。" width="46"></a> <a
                data-link-type="dfn" href="#storage-shelf" id="ref-for-storage-shelf⑧">ストレージ棚</a>の<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-export id="storage-quota">ストレージクォータ</dfn>は、保持できるバイト数の<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined"
                id="ref-for-implementation-defined②">実装定義</a>による保守的な推定値です。この量はデバイス上の総ストレージスペースより少なくなければなりません。また、デバイス上で利用可能なストレージスペースの関数であってはなりません。
        </p>
        <div class="note" role="note">
            <p>ユーザーエージェントは、クォータを決定する際にナビゲーション頻度、訪問の新しさ、ブックマーク、および"<code>persistent-storage</code>"に対する<a
                    href="#persistence">許可</a>を考慮することが強く推奨されます。</p>
            <p>利用可能なストレージスペースを直接的または間接的に明らかにすることは、フィンガープリントや<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin"
                    id="ref-for-concept-origin④">オリジン</a>の範囲外で情報を漏洩する可能性があります。</p>
        </div>
        <h2 class="heading settled" data-level="7" id="management"><span class="secno">7. </span><span
                class="content">管理</span><a class="self-link" href="#management"></a></h2>
        <p>ユーザーエージェントが<a data-link-type="dfn" href="#storage-bucket"
                id="ref-for-storage-bucket⑧">ストレージバケット</a>をクリアする場合、完全にクリアする必要があります。スクリプトがアクセス可能な状態で実行中の場合、ユーザーからの指示がない限り、ユーザーエージェントは<a
                data-link-type="dfn" href="#storage-bucket" id="ref-for-storage-bucket⑨">ストレージバケット</a>をクリアしないようにするべきです。
        </p>
        <p><a data-link-type="dfn" href="#storage-bucket" id="ref-for-storage-bucket①⓪">ストレージバケット</a>を削除した結果、包含する<a
                data-link-type="dfn" href="#storage-shelf" id="ref-for-storage-shelf⑨">ストレージ棚</a>の<a
                data-link-type="dfn" href="#bucket-map" id="ref-for-bucket-map⑥">バケットマップ</a>が<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#map-is-empty" id="ref-for-map-is-empty">空</a>になった場合、その<a
                data-link-type="dfn" href="#storage-shelf" id="ref-for-storage-shelf①⓪">ストレージ棚</a>および対応する<a
                data-link-type="dfn" href="#storage-key" id="ref-for-storage-key⑥">ストレージキー</a>を包含する<a
                data-link-type="dfn" href="#storage-shed" id="ref-for-storage-shed⑤">ストレージシェッド</a>から<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-remove" id="ref-for-map-remove">削除</a>します。
        </p>
        <h3 class="heading settled" data-level="7.1" id="storage-pressure"><span class="secno">7.1. </span><span
                class="content">ストレージプレッシャー</span><a class="self-link" href="#storage-pressure"></a></h3>
        <p>ユーザーエージェントがストレージプレッシャーを受ける場合、ネットワーク状態および<a data-link-type="dfn" href="#bucket"
                id="ref-for-bucket③">ローカルストレージバケット</a>のうち<a data-link-type="dfn" href="#bucket-mode"
                id="ref-for-bucket-mode②">モード</a>が"<code>best-effort</code>"であるものをクリアするべきです。理想的には、ユーザーへの影響が最小限になるような方法で削除を優先します。
        </p>
        <p>ユーザーエージェントが引き続きストレージプレッシャーを受ける場合、ユーザーエージェントはユーザーに通知し、残りの<a data-link-type="dfn" href="#bucket"
                id="ref-for-bucket④">ローカルストレージバケット</a>（すなわち、<a data-link-type="dfn" href="#bucket-mode"
                id="ref-for-bucket-mode③">モード</a>が"<code>persistent</code>"であるもの）をクリアする方法を提供するべきです。</p>
        <p><a data-link-type="dfn" href="#session-storage-bucket"
                id="ref-for-session-storage-bucket①">セッションストレージバケット</a>は、<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable"
                id="ref-for-traversable-navigable④">移動可能ナビゲーブル</a>が閉じられる際にクリアする必要があります。</p>
        <p class="note" role="note">ユーザーエージェントが<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable"
                id="ref-for-traversable-navigable⑤">移動可能ナビゲーブル</a>の復活を許可する場合、たとえば<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable"
                id="ref-for-traversable-navigable⑥">移動可能ナビゲーブル</a>を再オープンするか、ユーザーエージェントを再起動後に引き続き使用する場合、クリアにはより複雑なヒューリスティックが必要になります。
        </p>
        <h3 class="heading settled" data-level="7.2" id="ui-guidelines"><span class="secno">7.2. </span><span
                class="content">ユーザーインターフェースガイドライン</span><a class="self-link" href="#ui-guidelines"></a></h3>
        <p>ユーザーエージェントは、個々のウェブサイトのためにネットワーク状態およびストレージをクリアする機能をユーザーに提供するべきです。ユーザーインターフェースでネットワーク状態とストレージを区別してはなりません。これにより、ネットワーク状態を使用してストレージを復活させることができなくなり、ユーザーが意識する必要のある概念の数を減らすことができます。
        </p>
        <p>資格情報は分離するべきです。たとえば、自動生成されたパスワードなど、ユーザーが復活させることができないデータを含む場合があります。同様に、ユーザーの不便を避けるために許可も分離するのが最善です。</p>
        <h2 class="heading settled" data-level="8" id="api"><span class="secno">8. </span><span
                class="content">API</span><a class="self-link" href="#api"></a></h2>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <c- b>mixin</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="navigatorstorage"><code><c- g>NavigatorStorage</c-></code></dfn> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#storagemanager" id="ref-for-storagemanager"><c- n>StorageManager</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="StorageManager" href="#dom-navigatorstorage-storage" id="ref-for-dom-navigatorstorage-storage"><c- g>storage</c-></a>;
};
<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator" id="ref-for-navigator"><c- n>Navigator</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#navigatorstorage" id="ref-for-navigatorstorage"><c- n>NavigatorStorage</c-></a>;
<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#workernavigator" id="ref-for-workernavigator"><c- n>WorkerNavigator</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#navigatorstorage" id="ref-for-navigatorstorage①"><c- n>NavigatorStorage</c-></a>;
</pre>
        <p>各<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object⑧">環境設定オブジェクト</a>には、関連付けられた<code
                class="idl"><a data-link-type="idl" href="#storagemanager" id="ref-for-storagemanager①">StorageManager</a></code>
            オブジェクトがあります。<a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a> </p>
        <p><dfn class="dfn-paneled idl-code" data-dfn-for="NavigatorStorage" data-dfn-type="attribute" data-export
                id="dom-navigatorstorage-storage"><code>storage</code></dfn>ゲッターの手順は、<a data-link-type="dfn"
                href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a>の<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                id="ref-for-relevant-settings-object">関連する設定オブジェクト</a>の<code
                class="idl"><a data-link-type="idl" href="#storagemanager" id="ref-for-storagemanager②">StorageManager</a></code>
            オブジェクトを返すことです。</p>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext①"><c- g>SecureContext</c-></a>,
 <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="storagemanager"><code><c- g>StorageManager</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-storagemanager-persisted" id="ref-for-dom-storagemanager-persisted"><c- g>persisted</c-></a>();
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>Window</c->] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean①"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-storagemanager-persist" id="ref-for-dom-storagemanager-persist①"><c- g>persist</c-></a>();

  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-storageestimate" id="ref-for-dictdef-storageestimate"><c- n>StorageEstimate</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-storagemanager-estimate" id="ref-for-dom-storagemanager-estimate①"><c- g>estimate</c-></a>();
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-storageestimate"><code><c- g>StorageEstimate</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="StorageEstimate" data-dfn-type="dict-member" data-export data-type="unsigned long long" id="dom-storageestimate-usage"><code><c- g>usage</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long①"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="StorageEstimate" data-dfn-type="dict-member" data-export data-type="unsigned long long" id="dom-storageestimate-quota"><code><c- g>quota</c-></code></dfn>;
};
</pre>
        <div class="algorithm" data-algorithm="persisted()" data-algorithm-for="StorageManager">
            <p><dfn class="dfn-paneled idl-code" data-dfn-for="StorageManager" data-dfn-type="method" data-export
                    id="dom-storagemanager-persisted"><code>persisted()</code></dfn> メソッドの手順は次の通りです:</p>
            <ol>
                <li>
                    <p><var>promise</var> を <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                            id="ref-for-a-new-promise">新しい
                            Promise</a> とします。</p>
                <li>
                    <p><var>global</var> を <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                            id="ref-for-this①">this</a> の <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                            id="ref-for-concept-relevant-global">関連するグローバルオブジェクト</a> とします。</p>
                <li>
                    <p><var>shelf</var> を <a data-link-type="dfn" href="#obtain-a-local-storage-shelf"
                            id="ref-for-obtain-a-local-storage-shelf①">ローカルストレージ棚を取得する</a> を <a data-link-type="dfn"
                            href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②">this</a> の <a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                            id="ref-for-relevant-settings-object①">関連する設定オブジェクト</a> を使用して実行した結果とします。</p>
                <li>
                    <p>もし <var>shelf</var> が失敗であれば、<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject"
                            id="ref-for-reject">reject</a>
                        <var>promise</var> を <code
                            class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror">TypeError</a></code>
                        とします。
                    </p>
                <li>
                    <p>それ以外の場合、次の手順を <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                            id="ref-for-in-parallel">並行して</a> 実行します:</p>
                    <ol>
                        <li>
                            <p><var>persisted</var> を、もし <var>shelf</var> の <a data-link-type="dfn" href="#bucket-map"
                                    id="ref-for-bucket-map⑦">バケットマップ</a>["<code>default</code>"] の
                                <a data-link-type="dfn" href="#bucket-mode" id="ref-for-bucket-mode④">モード</a> が
                                "<code>persistent</code>" であれば true、それ以外の場合は false とします。
                            </p>
                            <p class="note" role="note">内部エラーがある場合、false になります。</p>
                        <li>
                            <p><a data-link-type="dfn" href="#queue-a-storage-task"
                                    id="ref-for-queue-a-storage-task">ストレージタスクをキューに追加</a> し、<var>global</var> を使用して <a
                                    data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve"
                                    id="ref-for-resolve">resolve</a> <var>promise</var> を <var>persisted</var> とします。
                            </p>
                    </ol>
                <li>
                    <p><var>promise</var> を返します。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="persist()" data-algorithm-for="StorageManager">
            <p><dfn class="dfn-paneled idl-code" data-dfn-for="StorageManager" data-dfn-type="method" data-export
                    id="dom-storagemanager-persist"><code>persist()</code></dfn> メソッドの手順は次の通りです:</p>
            <ol>
                <li>
                    <p><var>promise</var> を <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                            id="ref-for-a-new-promise①">新しい
                            Promise</a> とします。</p>
                <li>
                    <p><var>global</var> を <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                            id="ref-for-this③">this</a> の <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                            id="ref-for-concept-relevant-global①">関連するグローバルオブジェクト</a> とします。</p>
                <li>
                    <p><var>shelf</var> を <a data-link-type="dfn" href="#obtain-a-local-storage-shelf"
                            id="ref-for-obtain-a-local-storage-shelf②">ローカルストレージ棚を取得する</a> を <a data-link-type="dfn"
                            href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④">this</a> の <a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                            id="ref-for-relevant-settings-object②">関連する設定オブジェクト</a> を使用して実行した結果とします。</p>
                <li>
                    <p>もし <var>shelf</var> が失敗であれば、<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject"
                            id="ref-for-reject①">reject</a>
                        <var>promise</var> を <code
                            class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①">TypeError</a></code>
                        とします。
                    </p>
                <li>
                    <p>それ以外の場合、次の手順を <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                            id="ref-for-in-parallel①">並行して</a> 実行します:</p>
                    <ol>
                        <li>
                            <p><var>permission</var> を <a data-link-type="dfn"
                                    href="https://w3c.github.io/permissions/#dfn-request-permission-to-use"
                                    id="ref-for-dfn-request-permission-to-use">使用許可をリクエストして</a>
                                "<code>persistent-storage</code>" とします。</p>
                            <p class="note" role="note">ユーザーエージェントは、同じ <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin"
                                    id="ref-for-concept-origin⑤">オリジン</a>
                                に対して同じ時期にこの質問を2回させないようにすることが推奨されます。このアルゴリズムはそのようなシナリオに対応していません。</p>
                        <li>
                            <p><var>bucket</var> を <var>shelf</var> の <a data-link-type="dfn" href="#bucket-map"
                                    id="ref-for-bucket-map⑧">バケットマップ</a>["<code>default</code>"] とします。</p>
                        <li>
                            <p><var>persisted</var> を、<var>bucket</var> の <a data-link-type="dfn" href="#bucket-mode"
                                    id="ref-for-bucket-mode⑤">モード</a> が "<code>persistent</code>" であれば true、それ以外の場合は
                                false とします。</p>
                            <p class="note" role="note">内部エラーがある場合、false になります。</p>
                        <li>
                            <p>もし <var>persisted</var> が false であり、<var>permission</var> が "<code
                                    class="idl"><a data-link-type="idl" href="https://w3c.github.io/permissions/#dom-permissionstate-granted" id="ref-for-dom-permissionstate-granted①">granted</a></code>"
                                であれば:</p>
                            <ol>
                                <li>
                                    <p><var>bucket</var> の <a data-link-type="dfn" href="#bucket-mode"
                                            id="ref-for-bucket-mode⑥">モード</a> を "<code>persistent</code>" に設定します。</p>
                                <li>
                                    <p>内部エラーがなければ、<var>persisted</var> を true に設定します。</p>
                            </ol>
                        <li>
                            <p><a data-link-type="dfn" href="#queue-a-storage-task"
                                    id="ref-for-queue-a-storage-task①">ストレージタスクをキューに追加</a> し、<var>global</var> を使用して <a
                                    data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve"
                                    id="ref-for-resolve①">resolve</a> <var>promise</var> を <var>persisted</var> とします。
                            </p>
                    </ol>
                <li>
                    <p><var>promise</var> を返します。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="estimate()" data-algorithm-for="StorageManager">
            <p><dfn class="dfn-paneled idl-code" data-dfn-for="StorageManager" data-dfn-type="method" data-export
                    id="dom-storagemanager-estimate"><code>estimate()</code></dfn> メソッドの手順は次の通りです:</p>
            <ol>
                <li>
                    <p><var>promise</var> を <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                            id="ref-for-a-new-promise②">新しい
                            Promise</a> とします。</p>
                <li>
                    <p><var>global</var> を <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                            id="ref-for-this⑤">this</a> の <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                            id="ref-for-concept-relevant-global②">関連するグローバルオブジェクト</a> とします。</p>
                <li>
                    <p><var>shelf</var> を <a data-link-type="dfn" href="#obtain-a-local-storage-shelf"
                            id="ref-for-obtain-a-local-storage-shelf③">ローカルストレージ棚を取得する</a> を <a data-link-type="dfn"
                            href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑥">this</a> の <a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                            id="ref-for-relevant-settings-object③">関連する設定オブジェクト</a> を使用して実行した結果とします。</p>
                <li>
                    <p>もし <var>shelf</var> が失敗であれば、<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject"
                            id="ref-for-reject②">reject</a>
                        <var>promise</var> を <code
                            class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②">TypeError</a></code>
                        とします。
                    </p>
                <li>
                    <p>それ以外の場合、次の手順を <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                            id="ref-for-in-parallel②">並行して</a> 実行します:</p>
                    <ol>
                        <li>
                            <p><var>usage</var> を <a data-link-type="dfn" href="#storage-usage"
                                    id="ref-for-storage-usage">ストレージ使用量</a> として <var>shelf</var> について取得します。</p>
                        <li>
                            <p><var>quota</var> を <a data-link-type="dfn" href="#storage-quota"
                                    id="ref-for-storage-quota①">ストレージクォータ</a> として <var>shelf</var> について取得します。</p>
                        <li>
                            <p><var>dictionary</var> を新しい <code
                                    class="idl"><a data-link-type="idl" href="#dictdef-storageestimate" id="ref-for-dictdef-storageestimate①">StorageEstimate</a></code>
                                辞書とし、その<code
                                    class="idl"><a data-link-type="idl" href="#dom-storageestimate-usage" id="ref-for-dom-storageestimate-usage">usage</a></code>
                                メンバーを <var>usage</var> とし、<code
                                    class="idl"><a data-link-type="idl" href="#dom-storageestimate-quota" id="ref-for-dom-storageestimate-quota">quota</a></code>
                                メンバーを <var>quota</var> とします。</p>
                        <li>
                            <p>もし <var>usage</var> および <var>quota</var> を取得する際に内部エラーが発生した場合、<a data-link-type="dfn"
                                    href="#queue-a-storage-task" id="ref-for-queue-a-storage-task②">ストレージタスクをキューに追加</a>
                                し、<var>global</var> を使用して <a data-link-type="dfn"
                                    href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject③">reject</a>
                                <var>promise</var> を <code
                                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror③">TypeError</a></code>
                                とします。
                            </p>
                            <p class="note" role="note">
                                内部エラーは非常に稀であるべきであり、何らかの低レベルのプラットフォームまたはハードウェアの障害を示します。ただし、ウェブの規模および実装やプラットフォームの多様性を考慮すると、予期しない事象が発生する可能性があります。
                            </p>
                        <li>
                            <p>それ以外の場合、<a data-link-type="dfn" href="#queue-a-storage-task"
                                    id="ref-for-queue-a-storage-task③">ストレージタスクをキューに追加</a> し、<var>global</var> を使用して <a
                                    data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve"
                                    id="ref-for-resolve②">resolve</a> <var>promise</var> を <var>dictionary</var> とします。
                            </p>
                    </ol>
                <li>
                    <p><var>promise</var> を返します。</p>
            </ol>
        </div>
        <h2 class="no-num heading settled" id="acks"><span class="content">謝辞</span><a class="self-link"
                href="#acks"></a></h2>
        <p>最後に、以下の皆様に感謝申し上げます：
            Adrian Bateman、
            Aislinn Grigas、
            Alex Russell、
            Ali Alabbas、
            Andrew Sutherland、
            Andrew Williams、
            Austin Sullivan、
            Ben Kelly、
            Ben Turner、
            Dale Harvey、
            David Grogan、
            Domenic Denicola、
            fantasai、
            Jake Archibald、
            Jeffrey Yasskin、
            Jesse Mykolyn、
            Jinho Bang、
            Jonas Sicking、
            Joshua Bell、
            Kenji Baheux、
            Kinuko Yasuda、
            Luke Wagner、
            Michael Nordman、
            Mike Taylor、
            Mounir Lamouri、
            Shachar Zohar、
            黃強 (Shawn Huang)、
            簡冠庭 (Timothy Guan-tin Chien）、そして
            Victor Costan、
            素晴らしい貢献をありがとうございます！</p>
        <p>この現行標準は、<a href="https://annevankesteren.nl/" lang="nl">Anne van Kesteren</a>（<a
                href="https://www.apple.com/">Apple</a>, <a
                href="mailto:annevk@annevk.nl">annevk@annevk.nl</a>）により執筆されています。</p>
        <h2 class="no-num heading settled" id="ipr"><span class="content">知的財産権</span><a class="self-link"
                href="#ipr"></a></h2>
        <p>Copyright © WHATWG (Apple, Google, Mozilla, Microsoft)。この作品は<a
                href="https://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0
                International License</a>の下でライセンスされています。その一部がソースコードに組み込まれている場合、その部分は<a
                href="https://opensource.org/licenses/BSD-3-Clause" rel="license">BSD 3-Clause
                License</a>の下でライセンスされています。</p>
        <p>これは現行標準です。特許レビュー版に関心のある方は、<a href="/review-drafts/2023-02/">現行標準レビュー版</a>をご覧ください。</p>
    </main>
    <script>
        // "use strict";
        // if ("serviceWorker" in navigator) {
        //     navigator.serviceWorker.register("/service-worker.js");
        // }
    </script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">この仕様書で定義されている用語</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#storage-proxy-map-backing-map">backing map</a><span>、§ 4.7にて</span>
        <li><a href="#bottle-map">bottle map</a><span>、§ 4.5にて</span>
        <li><a href="#bucket-map">bucket map</a><span>、§ 4.4にて</span>
        <li><a href="#create-a-storage-bucket">create a storage bucket</a><span>、§ 4.5にて</span>
        <li><a href="#create-a-storage-shelf">create a storage shelf</a><span>、§ 4.4にて</span>
        <li><a href="#storage-key-equal">equal</a><span>、§ 4.2にて</span>
        <li><a href="#dom-storagemanager-estimate">estimate()</a><span>、§ 8にて</span>
        <li><a href="#storage-endpoint-identifier">identifier</a><span>、§ 4.1にて</span>
        <li><a href="#legacy-clone-a-traversable-storage-shed">legacy-clone a traversable storage
                shed</a><span>、§ 4.3にて</span>
        <li><a href="#local-storage">local storage</a><span>、§ 4.3にて</span>
        <li><a href="#bucket">local storage bucket</a><span>、§ 4.5にて</span>
        <li><a href="#storage-bottle-map">map</a><span>、§ 4.6にて</span>
        <li><a href="#bucket-mode">mode</a><span>、§ 4.5にて</span>
        <li><a href="#navigatorstorage">NavigatorStorage</a><span>、§ 8にて</span>
        <li><a href="#obtain-a-local-storage-bottle-map">obtain a local storage bottle map</a><span>、§ 4.6にて</span>
        <li><a href="#obtain-a-local-storage-shelf">obtain a local storage shelf</a><span>、§ 4.4にて</span>
        <li><a href="#obtain-a-session-storage-bottle-map">obtain a session storage bottle map</a><span>、§ 4.6にて</span>
        <li><a href="#obtain-a-storage-bottle-map">obtain a storage bottle map</a><span>、§ 4.6にて</span>
        <li><a href="#obtain-a-storage-key">obtain a storage key</a><span>、§ 4.2にて</span>
        <li><a href="#obtain-a-storage-key-for-non-storage-purposes">obtain a storage key for non-storage
                purposes</a><span>、§ 4.2にて</span>
        <li><a href="#obtain-a-storage-shelf">obtain a storage shelf</a><span>、§ 4.4にて</span>
        <li><a href="#storage-key-origin">origin</a><span>、§ 4.2にて</span>
        <li><a href="#dom-storagemanager-persist">persist()</a><span>、§ 8にて</span>
        <li><a href="#dom-storagemanager-persisted">persisted()</a><span>、§ 8にて</span>
        <li><a href="#storage-bottle-proxy-map-reference-set">proxy map reference set</a><span>、§ 4.6にて</span>
        <li><a href="#queue-a-storage-task">queue a storage task</a><span>、§ 4.8にて</span>
        <li>
            クォータ
            <ul>
                <li><a href="#storage-bottle-quota">dfn for storage bottle</a><span>、§ 4.6にて</span>
                <li><a href="#storage-endpoint-quota">dfn for storage endpoint</a><span>、§ 4.1にて</span>
                <li><a href="#dom-storageestimate-quota">dict-member for StorageEstimate</a><span>、§ 8にて</span>
            </ul>
        <li><a href="#registered-storage-endpoints">registered storage endpoints</a><span>、§ 4.1にて</span>
        <li><a href="#session-storage">session storage</a><span>、§ 4.3にて</span>
        <li><a href="#session-storage-bucket">session storage bucket</a><span>、§ 4.5にて</span>
        <li><a href="#dom-navigatorstorage-storage">storage</a><span>、§ 8にて</span>
        <li><a href="#storage-bottle">storage bottle</a><span>、§ 4.6にて</span>
        <li><a href="#storage-bucket">storage bucket</a><span>、§ 4.5にて</span>
        <li><a href="#storage-endpoint">storage endpoint</a><span>、§ 4.1にて</span>
        <li><a href="#dictdef-storageestimate">StorageEstimate</a><span>、§ 8にて</span>
        <li><a href="#storage-identifier">storage identifier</a><span>、§ 4.1にて</span>
        <li><a href="#storage-key">storage key</a><span>、§ 4.2にて</span>
        <li><a href="#storagemanager">StorageManager</a><span>、§ 8にて</span>
        <li><a href="#storage-proxy-map">storage proxy map</a><span>、§ 4.7にて</span>
        <li><a href="#storage-quota">storage quota</a><span>、§ 6にて</span>
        <li>
            ストレージシェッド
            <ul>
                <li><a href="#storage-shed">definition of</a><span>、§ 4.3にて</span>
                <li><a href="#traversable-navigable-storage-shed">dfn for traversable navigable</a><span>、§ 4.3にて</span>
                <li><a href="#user-agent-storage-shed">dfn for user agent</a><span>、§ 4.3にて</span>
            </ul>
        <li><a href="#storage-shelf">storage shelf</a><span>、§ 4.4にて</span>
        <li><a href="#storage-shelf">storage shelves</a><span>、§ 4.4にて</span>
        <li><a href="#task-source">storage task source</a><span>、§ 4.8にて</span>
        <li><a href="#storage-type">storage type</a><span>、§ 4.1にて</span>
        <li><a href="#storage-usage">storage usage</a><span>、§ 6にて</span>
        <li><a href="#storage-endpoint-types">types</a><span>、§ 4.1にて</span>
        <li><a href="#dom-storageestimate-usage">usage</a><span>、§ 8にて</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">他の参照で定義されている用語</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[ECMASCRIPT]</a>により以下の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="3187558e">agent</span>
                <li><span class="dfn-paneled" id="f6e4cbfd">agent cluster</span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a>により以下の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="be0c27b2">Navigator</span>
                <li><span class="dfn-paneled" id="a4785085">WorkerNavigator</span>
                <li><span class="dfn-paneled" id="3349d69f">関連付けられた Document</span>
                <li><span class="dfn-paneled" id="fa5ee9c5">creation URL</span>
                <li><span class="dfn-paneled" id="12b8dfc0">現在の設定オブジェクト</span>
                <li><span class="dfn-paneled" id="24cf98a1">環境</span>
                <li><span class="dfn-paneled" id="3e12e042">環境設定オブジェクト</span>
                <li><span class="dfn-paneled" id="4b6086d7">グローバルオブジェクト</span>
                <li><span class="dfn-paneled" id="a72449dd">並行して</span>
                <li><span class="dfn-paneled" id="13dd6cae">ノードナビゲーブル</span>
                <li><span class="dfn-paneled" id="b01b1359">不透明なオリジン</span>
                <li><span class="dfn-paneled" id="086e3aff">オリジン</span>
                <li><span class="dfn-paneled" id="43ac8374">オリジン <small>(環境設定オブジェクト向け)</small></span>
                <li><span class="dfn-paneled" id="48438eb3">グローバルタスクをキューに追加</span>
                <li><span class="dfn-paneled" id="e99bd18e">関連するグローバルオブジェクト</span>
                <li><span class="dfn-paneled" id="9c4c1e66">関連する設定オブジェクト</span>
                <li><span class="dfn-paneled" id="7393da89">同一オリジン</span>
                <li><span class="dfn-paneled" id="e270bd2a">タスク</span>
                <li><span class="dfn-paneled" id="c3b2d08c">タスクソース</span>
                <li><span class="dfn-paneled" id="d0c1b934">移動可能ナビゲーブル</span>
                <li><span class="dfn-paneled" id="17582406">移動可能ナビゲーブル <small>(ナビゲーブル向け)</small></span>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a>により以下の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="a3b18719">追加する</span>
                <li><span class="dfn-paneled" id="2d5a2765">ASCII文字列</span>
                <li><span class="dfn-paneled" id="ab3919d2">複製</span>
                <li><span class="dfn-paneled" id="ae8def21">含む</span>
                <li><span class="dfn-paneled" id="1243a891">存在する</span>
                <li><span class="dfn-paneled" id="16d07e10">各要素に対して <small>(リスト向け)</small></span>
                <li><span class="dfn-paneled" id="45209803">各要素に対して <small>(マップ向け)</small></span>
                <li><span class="dfn-paneled" id="860300d4">実装定義</span>
                <li><span class="dfn-paneled" id="dc3369de">空である</span>
                <li><span class="dfn-paneled" id="d14a6f26">キー</span>
                <li><span class="dfn-paneled" id="3fca5a9e">マップ</span>
                <li><span class="dfn-paneled" id="7d4424b2">削除する</span>
                <li><span class="dfn-paneled" id="15e48c39">セット</span>
                <li><span class="dfn-paneled" id="0698d556">文字列</span>
                <li><span class="dfn-paneled" id="0e8de730">タプル</span>
                <li><span class="dfn-paneled" id="6d19ac93">ユーザーエージェント</span>
                <li><span class="dfn-paneled" id="802b0fdd">値</span>
            </ul>
        <li>
            <a data-link-type="biblio">[PERMISSIONS]</a>により以下の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="33438879">現在の許可状態を取得する</span>
                <li><span class="dfn-paneled" id="c6ce3c60">許可された</span>
                <li><span class="dfn-paneled" id="409a61ca">許可の取り消しアルゴリズム</span>
                <li><span class="dfn-paneled" id="d124397f">許可状態</span>
                <li><span class="dfn-paneled" id="6c2d7879">強力な機能</span>
                <li><span class="dfn-paneled" id="d357c753">使用許可をリクエストする</span>
            </ul>
        <li>
            <a data-link-type="biblio">[URL]</a>により以下の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="959ad97b">オリジン</span>
            </ul>
        <li>
            <a data-link-type="biblio">[WEBIDL]</a>により以下の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="889e932f">Exposed</span>
                <li><span class="dfn-paneled" id="bdbd19d1">Promise</span>
                <li><span class="dfn-paneled" id="a5c91173">SameObject</span>
                <li><span class="dfn-paneled" id="b75bb3bd">SecureContext</span>
                <li><span class="dfn-paneled" id="82ca3efc">TypeError</span>
                <li><span class="dfn-paneled" id="dacde8b5">新しい Promise</span>
                <li><span class="dfn-paneled" id="5372cca8">boolean</span>
                <li><span class="dfn-paneled" id="b262501e">拒否する</span>
                <li><span class="dfn-paneled" id="3b90bdcd">解決する</span>
                <li><span class="dfn-paneled" id="4013a022">this</span>
                <li><span class="dfn-paneled" id="f14b47b8">unsigned long long</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参照</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">規範的参照</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-ecmascript">[ECMASCRIPT]
        <dd><a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript 言語仕様</cite></a>. URL: <a
                href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML標準</cite></a>.
            現行標準. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>インフラ標準</cite></a>. 現行標準.
            URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-permissions">[PERMISSIONS]
        <dd>Marcos Caceres; Mike Taylor. <a href="https://w3c.github.io/permissions/"><cite>Permissions</cite></a>. URL:
            <a href="https://w3c.github.io/permissions/">https://w3c.github.io/permissions/</a>
        <dt id="biblio-url">[URL]
        <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL標準</cite></a>. 現行標準.
            URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
        <dt id="biblio-webidl">[WEBIDL]
        <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL標準</cite></a>. 現行標準. URL: <a
                href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL 索引</span><a class="self-link"
            href="#idl-index"></a></h2>
    <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <c- b>mixin</c-> <a href="#navigatorstorage"><code><c- g>NavigatorStorage</c-></code></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#storagemanager"><c- n>StorageManager</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="StorageManager" href="#dom-navigatorstorage-storage"><c- g>storage</c-></a>;
};
<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator"><c- n>Navigator</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#navigatorstorage"><c- n>NavigatorStorage</c-></a>;
<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#workernavigator"><c- n>WorkerNavigator</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#navigatorstorage"><c- n>NavigatorStorage</c-></a>;

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>,
 <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#storagemanager"><code><c- g>StorageManager</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-storagemanager-persisted"><c- g>persisted</c-></a>();
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-storagemanager-persist"><c- g>persist</c-></a>();

  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-storageestimate"><c- n>StorageEstimate</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-storagemanager-estimate"><c- g>estimate</c-></a>();
};

<c- b>dictionary</c-> <a href="#dictdef-storageestimate"><code><c- g>StorageEstimate</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-type="unsigned long long" href="#dom-storageestimate-usage"><code><c- g>usage</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-type="unsigned long long" href="#dom-storageestimate-quota"><code><c- g>quota</c-></code></a>;
};

</pre>
    <details class="mdn-anno unpositioned" data-anno-for="dom-navigatorstorage-storage">
        <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span>
        </summary>
        <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/storage"
                    title="The Navigator.storage read-only property returns the singleton StorageManager object used to access the overall storage capabilities of the browser for the current site or app. The returned object lets you examine and configure persistence of data stores and learn approximately how much more space your browser has available for local storage use.">Navigator/storage</a>
            </p>
            <p class="all-engines-text">In all current engines.</p>
            <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>57+</span></span><span
                    class="safari yes"><span>Safari</span><span>15.2+</span></span><span
                    class="chrome yes"><span>Chrome</span><span>55+</span></span>
                <hr>
                <span class="opera no"><span>Opera</span><span>?</span></span><span
                    class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span
                    class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span
                    class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span
                    class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span
                    class="webview_android no"><span>Android WebView</span><span>?</span></span><span
                    class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span
                    class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
            </div>
        </div>
        <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WorkerNavigator/storage"
                    title="The WorkerNavigator.storage read-only property returns the singleton StorageManager object used to access the overall storage capabilities of the browser for the current site or app. The returned object lets you examine and configure persistence of data stores and learn approximately how much more space your browser has available for local storage use.">WorkerNavigator/storage</a>
            </p>
            <p class="all-engines-text">In all current engines.</p>
            <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>57+</span></span><span
                    class="safari yes"><span>Safari</span><span>15.2+</span></span><span
                    class="chrome yes"><span>Chrome</span><span>55+</span></span>
                <hr>
                <span class="opera no"><span>Opera</span><span>?</span></span><span
                    class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span
                    class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span
                    class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span
                    class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span
                    class="webview_android no"><span>Android WebView</span><span>?</span></span><span
                    class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span
                    class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
            </div>
        </div>
    </details>
    <details class="mdn-anno unpositioned" data-anno-for="ref-for-dom-storagemanager-estimate">
        <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span>
        </summary>
        <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/StorageManager/estimate"
                    title="The estimate() method of the StorageManager interface asks the Storage Manager for how much storage the current origin takes up (usage), and how much space is available (quota).">StorageManager/estimate</a>
            </p>
            <p class="all-engines-text">In all current engines.</p>
            <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>57+</span></span><span
                    class="safari yes"><span>Safari</span><span>17+</span></span><span
                    class="chrome yes"><span>Chrome</span><span>61+</span></span>
                <hr>
                <span class="opera no"><span>Opera</span><span>?</span></span><span
                    class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span
                    class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span
                    class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span
                    class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span
                    class="webview_android no"><span>Android WebView</span><span>?</span></span><span
                    class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span
                    class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
            </div>
        </div>
    </details>
    <details class="mdn-anno unpositioned" data-anno-for="ref-for-dom-storagemanager-persist">
        <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span>
        </summary>
        <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/StorageManager/persist"
                    title="The persist() method of the StorageManager interface requests permission to use persistent storage, and returns a Promise that resolves to true if permission is granted and bucket mode is persistent, and false otherwise.">StorageManager/persist</a>
            </p>
            <p class="all-engines-text">In all current engines.</p>
            <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>57+</span></span><span
                    class="safari yes"><span>Safari</span><span>15.2+</span></span><span
                    class="chrome yes"><span>Chrome</span><span>55+</span></span>
                <hr>
                <span class="opera no"><span>Opera</span><span>?</span></span><span
                    class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span
                    class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span
                    class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span
                    class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span
                    class="webview_android no"><span>Android WebView</span><span>?</span></span><span
                    class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span
                    class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
            </div>
        </div>
    </details>
    <details class="mdn-anno unpositioned" data-anno-for="dom-storagemanager-persisted">
        <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span>
        </summary>
        <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/StorageManager/persisted"
                    title="The persisted() method of the StorageManager interface returns a Promise that resolves to true if your site&apos;s storage bucket is persistent.">StorageManager/persisted</a>
            </p>
            <p class="all-engines-text">In all current engines.</p>
            <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>57+</span></span><span
                    class="safari yes"><span>Safari</span><span>15.2+</span></span><span
                    class="chrome yes"><span>Chrome</span><span>55+</span></span>
                <hr>
                <span class="opera no"><span>Opera</span><span>?</span></span><span
                    class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span
                    class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span
                    class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span
                    class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span
                    class="webview_android no"><span>Android WebView</span><span>?</span></span><span
                    class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span
                    class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
            </div>
        </div>
    </details>
    <details class="mdn-anno unpositioned" data-anno-for="storagemanager">
        <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span>
        </summary>
        <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/StorageManager"
                    title="The StorageManager interface of the Storage API provides an interface for managing persistence permissions and estimating available storage. You can get a reference to this interface using either navigator.storage or WorkerNavigator.storage.">StorageManager</a>
            </p>
            <p class="all-engines-text">In all current engines.</p>
            <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>57+</span></span><span
                    class="safari yes"><span>Safari</span><span>15.2+</span></span><span
                    class="chrome yes"><span>Chrome</span><span>55+</span></span>
                <hr>
                <span class="opera no"><span>Opera</span><span>?</span></span><span
                    class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span
                    class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span
                    class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span
                    class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span
                    class="webview_android no"><span>Android WebView</span><span>?</span></span><span
                    class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span
                    class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
            </div>
        </div>
    </details>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "0698d556": { "dfnID": "0698d556", "dfnText": "string", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-string" }], "title": "4.4. Storage shelves" }], "url": "https://infra.spec.whatwg.org/#string" },
                "086e3aff": { "dfnID": "086e3aff", "dfnText": "origin", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-origin" }], "title": "1. Introduction" }, { "refs": [{ "id": "ref-for-concept-origin\u2460" }], "title": "4.2. Storage keys" }, { "refs": [{ "id": "ref-for-concept-origin\u2461" }, { "id": "ref-for-concept-origin\u2462" }], "title": "5. Persistence permission" }, { "refs": [{ "id": "ref-for-concept-origin\u2463" }], "title": "6. Usage and quota" }, { "refs": [{ "id": "ref-for-concept-origin\u2464" }], "title": "8. API" }], "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" },
                "0e8de730": { "dfnID": "0e8de730", "dfnText": "tuple", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-tuple" }, { "id": "ref-for-tuple\u2460" }], "title": "4.2. Storage keys" }], "url": "https://infra.spec.whatwg.org/#tuple" },
                "1243a891": { "dfnID": "1243a891", "dfnText": "exist", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-exists" }], "title": "4.4. Storage shelves" }], "url": "https://infra.spec.whatwg.org/#map-exists" },
                "12b8dfc0": { "dfnID": "12b8dfc0", "dfnText": "current settings object", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-current-settings-object" }], "title": "5. Persistence permission" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object" },
                "13dd6cae": { "dfnID": "13dd6cae", "dfnText": "node navigable", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-node-navigable" }], "title": "4.6. Storage bottles" }], "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable" },
                "15e48c39": { "dfnID": "15e48c39", "dfnText": "set", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ordered-set" }, { "id": "ref-for-ordered-set\u2460" }], "title": "4.1. Storage endpoints" }, { "refs": [{ "id": "ref-for-ordered-set\u2461" }], "title": "4.6. Storage bottles" }], "url": "https://infra.spec.whatwg.org/#ordered-set" },
                "16d07e10": { "dfnID": "16d07e10", "dfnText": "for each (for list)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-list-iterate" }], "title": "4.5. Storage buckets" }], "url": "https://infra.spec.whatwg.org/#list-iterate" },
                "17582406": { "dfnID": "17582406", "dfnText": "traversable navigable (for navigable)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-nav-traversable" }], "title": "4.6. Storage bottles" }], "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#nav-traversable" },
                "24cf98a1": { "dfnID": "24cf98a1", "dfnText": "environment", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-environment" }, { "id": "ref-for-environment\u2460" }], "title": "4.2. Storage keys" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#environment" },
                "2d5a2765": { "dfnID": "2d5a2765", "dfnText": "ASCII string", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ascii-string" }], "title": "4.1. Storage endpoints" }], "url": "https://infra.spec.whatwg.org/#ascii-string" },
                "3187558e": { "dfnID": "3187558e", "dfnText": "agent", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sec-agents" }], "title": "4.6. Storage bottles" }], "url": "https://tc39.github.io/ecma262/#sec-agents" },
                "33438879": { "dfnID": "33438879", "dfnText": "getting the current permission state", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dfn-getting-the-current-permission-state" }], "title": "5. Persistence permission" }], "url": "https://w3c.github.io/permissions/#dfn-getting-the-current-permission-state" },
                "3349d69f": { "dfnID": "3349d69f", "dfnText": "associated Document", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-document-window" }], "title": "4.6. Storage bottles" }], "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" },
                "3b90bdcd": { "dfnID": "3b90bdcd", "dfnText": "resolve", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-resolve" }, { "id": "ref-for-resolve\u2460" }, { "id": "ref-for-resolve\u2461" }], "title": "8. API" }], "url": "https://webidl.spec.whatwg.org/#resolve" },
                "3e12e042": { "dfnID": "3e12e042", "dfnText": "environment settings object", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-environment-settings-object" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-environment-settings-object\u2460" }], "title": "4.2. Storage keys" }, { "refs": [{ "id": "ref-for-environment-settings-object\u2461" }, { "id": "ref-for-environment-settings-object\u2462" }], "title": "4.4. Storage shelves" }, { "refs": [{ "id": "ref-for-environment-settings-object\u2463" }, { "id": "ref-for-environment-settings-object\u2464" }, { "id": "ref-for-environment-settings-object\u2465" }], "title": "4.6. Storage bottles" }, { "refs": [{ "id": "ref-for-environment-settings-object\u2466" }], "title": "5. Persistence permission" }, { "refs": [{ "id": "ref-for-environment-settings-object\u2467" }], "title": "8. API" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" },
                "3fca5a9e": { "dfnID": "3fca5a9e", "dfnText": "map", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ordered-map" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-ordered-map\u2460" }], "title": "4.3. Storage sheds" }, { "refs": [{ "id": "ref-for-ordered-map\u2461" }], "title": "4.4. Storage shelves" }, { "refs": [{ "id": "ref-for-ordered-map\u2462" }], "title": "4.6. Storage bottles" }, { "refs": [{ "id": "ref-for-ordered-map\u2463" }], "title": "4.7. Storage proxy maps" }], "url": "https://infra.spec.whatwg.org/#ordered-map" },
                "4013a022": { "dfnID": "4013a022", "dfnText": "this", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-this" }, { "id": "ref-for-this\u2460" }, { "id": "ref-for-this\u2461" }, { "id": "ref-for-this\u2462" }, { "id": "ref-for-this\u2463" }, { "id": "ref-for-this\u2464" }, { "id": "ref-for-this\u2465" }], "title": "8. API" }], "url": "https://webidl.spec.whatwg.org/#this" },
                "409a61ca": { "dfnID": "409a61ca", "dfnText": "permission revocation algorithm", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dfn-permission-revocation-algorithm" }], "title": "5. Persistence permission" }], "url": "https://w3c.github.io/permissions/#dfn-permission-revocation-algorithm" },
                "43ac8374": { "dfnID": "43ac8374", "dfnText": "origin (for environment settings object)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-settings-object-origin" }], "title": "4.2. Storage keys" }, { "refs": [{ "id": "ref-for-concept-settings-object-origin\u2460" }], "title": "5. Persistence permission" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" },
                "45209803": { "dfnID": "45209803", "dfnText": "for each (for map)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-iterate" }], "title": "4.3. Storage sheds" }], "url": "https://infra.spec.whatwg.org/#map-iterate" },
                "48438eb3": { "dfnID": "48438eb3", "dfnText": "queue a global task", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-queue-a-global-task" }], "title": "4.8. Storage task source" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" },
                "4b6086d7": { "dfnID": "4b6086d7", "dfnText": "global object", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-global-object" }], "title": "4.6. Storage bottles" }, { "refs": [{ "id": "ref-for-global-object\u2460" }], "title": "4.8. Storage task source" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#global-object" },
                "5372cca8": { "dfnID": "5372cca8", "dfnText": "boolean", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-idl-boolean" }, { "id": "ref-for-idl-boolean\u2460" }], "title": "8. API" }], "url": "https://webidl.spec.whatwg.org/#idl-boolean" },
                "6c2d7879": { "dfnID": "6c2d7879", "dfnText": "powerful feature", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dfn-powerful-feature" }, { "id": "ref-for-dfn-powerful-feature\u2460" }], "title": "5. Persistence permission" }], "url": "https://w3c.github.io/permissions/#dfn-powerful-feature" },
                "6d19ac93": { "dfnID": "6d19ac93", "dfnText": "user agent", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-user-agent" }], "title": "3. Lay of the land" }, { "refs": [{ "id": "ref-for-user-agent\u2460" }], "title": "4.3. Storage sheds" }], "url": "https://infra.spec.whatwg.org/#user-agent" },
                "7393da89": { "dfnID": "7393da89", "dfnText": "same origin", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-same-origin" }], "title": "4.2. Storage keys" }], "url": "https://html.spec.whatwg.org/multipage/browsers.html#same-origin" },
                "7d4424b2": { "dfnID": "7d4424b2", "dfnText": "remove", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-remove" }], "title": "7. Management" }], "url": "https://infra.spec.whatwg.org/#map-remove" },
                "802b0fdd": { "dfnID": "802b0fdd", "dfnText": "value", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-value" }], "title": "4.4. Storage shelves" }], "url": "https://infra.spec.whatwg.org/#map-value" },
                "82ca3efc": { "dfnID": "82ca3efc", "dfnText": "TypeError", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-exceptiondef-typeerror" }, { "id": "ref-for-exceptiondef-typeerror\u2460" }, { "id": "ref-for-exceptiondef-typeerror\u2461" }, { "id": "ref-for-exceptiondef-typeerror\u2462" }], "title": "8. API" }], "url": "https://webidl.spec.whatwg.org/#exceptiondef-typeerror" },
                "860300d4": { "dfnID": "860300d4", "dfnText": "implementation-defined", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-implementation-defined" }], "title": "4.6. Storage bottles" }, { "refs": [{ "id": "ref-for-implementation-defined\u2460" }, { "id": "ref-for-implementation-defined\u2461" }], "title": "6. Usage and quota" }], "url": "https://infra.spec.whatwg.org/#implementation-defined" },
                "889e932f": { "dfnID": "889e932f", "dfnText": "Exposed", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-Exposed" }, { "id": "ref-for-Exposed\u2460" }], "title": "8. API" }], "url": "https://webidl.spec.whatwg.org/#Exposed" },
                "959ad97b": { "dfnID": "959ad97b", "dfnText": "origin", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-url-origin" }], "title": "4.2. Storage keys" }], "url": "https://url.spec.whatwg.org/#concept-url-origin" },
                "9c4c1e66": { "dfnID": "9c4c1e66", "dfnText": "relevant settings object", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-relevant-settings-object" }, { "id": "ref-for-relevant-settings-object\u2460" }, { "id": "ref-for-relevant-settings-object\u2461" }, { "id": "ref-for-relevant-settings-object\u2462" }], "title": "8. API" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" },
                "a3b18719": { "dfnID": "a3b18719", "dfnText": "append", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-set-append" }], "title": "4.6. Storage bottles" }], "url": "https://infra.spec.whatwg.org/#set-append" },
                "a4785085": { "dfnID": "a4785085", "dfnText": "WorkerNavigator", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-workernavigator" }], "title": "8. API" }], "url": "https://html.spec.whatwg.org/multipage/workers.html#workernavigator" },
                "a5c91173": { "dfnID": "a5c91173", "dfnText": "SameObject", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-SameObject" }], "title": "8. API" }], "url": "https://webidl.spec.whatwg.org/#SameObject" },
                "a72449dd": { "dfnID": "a72449dd", "dfnText": "in parallel", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-in-parallel" }, { "id": "ref-for-in-parallel\u2460" }, { "id": "ref-for-in-parallel\u2461" }], "title": "8. API" }], "url": "https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" },
                "ab3919d2": { "dfnID": "ab3919d2", "dfnText": "clone", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-clone" }], "title": "4.3. Storage sheds" }], "url": "https://infra.spec.whatwg.org/#map-clone" },
                "ae8def21": { "dfnID": "ae8def21", "dfnText": "contain", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-list-contain" }], "title": "4.5. Storage buckets" }], "url": "https://infra.spec.whatwg.org/#list-contain" },
                "b01b1359": { "dfnID": "b01b1359", "dfnText": "opaque origin", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-origin-opaque" }], "title": "4.2. Storage keys" }], "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" },
                "b262501e": { "dfnID": "b262501e", "dfnText": "reject", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-reject" }, { "id": "ref-for-reject\u2460" }, { "id": "ref-for-reject\u2461" }, { "id": "ref-for-reject\u2462" }], "title": "8. API" }], "url": "https://webidl.spec.whatwg.org/#reject" },
                "b75bb3bd": { "dfnID": "b75bb3bd", "dfnText": "SecureContext", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-SecureContext" }, { "id": "ref-for-SecureContext\u2460" }], "title": "8. API" }], "url": "https://webidl.spec.whatwg.org/#SecureContext" },
                "bdbd19d1": { "dfnID": "bdbd19d1", "dfnText": "Promise", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-idl-promise" }, { "id": "ref-for-idl-promise\u2460" }, { "id": "ref-for-idl-promise\u2461" }], "title": "8. API" }], "url": "https://webidl.spec.whatwg.org/#idl-promise" },
                "be0c27b2": { "dfnID": "be0c27b2", "dfnText": "Navigator", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-navigator" }], "title": "8. API" }], "url": "https://html.spec.whatwg.org/multipage/system-state.html#navigator" },
                "bottle-map": { "dfnID": "bottle-map", "dfnText": "bottle map", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-bottle-map" }, { "id": "ref-for-bottle-map\u2460" }], "title": "4.3. Storage sheds" }, { "refs": [{ "id": "ref-for-bottle-map\u2461" }], "title": "4.5. Storage buckets" }, { "refs": [{ "id": "ref-for-bottle-map\u2462" }], "title": "4.6. Storage bottles" }], "url": "#bottle-map" },
                "bucket": { "dfnID": "bucket", "dfnText": "local storage bucket", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-bucket" }, { "id": "ref-for-bucket\u2460" }], "title": "4.5. Storage buckets" }, { "refs": [{ "id": "ref-for-bucket\u2461" }], "title": "5. Persistence permission" }, { "refs": [{ "id": "ref-for-bucket\u2462" }, { "id": "ref-for-bucket\u2463" }], "title": "7.1. Storage pressure" }], "url": "#bucket" },
                "bucket-map": { "dfnID": "bucket-map", "dfnText": "bucket map", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-bucket-map" }, { "id": "ref-for-bucket-map\u2460" }], "title": "4.3. Storage sheds" }, { "refs": [{ "id": "ref-for-bucket-map\u2461" }, { "id": "ref-for-bucket-map\u2462" }], "title": "4.4. Storage shelves" }, { "refs": [{ "id": "ref-for-bucket-map\u2463" }], "title": "4.6. Storage bottles" }, { "refs": [{ "id": "ref-for-bucket-map\u2464" }], "title": "5. Persistence permission" }, { "refs": [{ "id": "ref-for-bucket-map\u2465" }], "title": "7. Management" }, { "refs": [{ "id": "ref-for-bucket-map\u2466" }, { "id": "ref-for-bucket-map\u2467" }], "title": "8. API" }], "url": "#bucket-map" },
                "bucket-mode": { "dfnID": "bucket-mode", "dfnText": "mode", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-bucket-mode" }, { "id": "ref-for-bucket-mode\u2460" }], "title": "5. Persistence permission" }, { "refs": [{ "id": "ref-for-bucket-mode\u2461" }, { "id": "ref-for-bucket-mode\u2462" }], "title": "7.1. Storage pressure" }, { "refs": [{ "id": "ref-for-bucket-mode\u2463" }, { "id": "ref-for-bucket-mode\u2464" }, { "id": "ref-for-bucket-mode\u2465" }], "title": "8. API" }], "url": "#bucket-mode" },
                "c3b2d08c": { "dfnID": "c3b2d08c", "dfnText": "task source", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-task-source" }], "title": "4.8. Storage task source" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#task-source" },
                "c6ce3c60": { "dfnID": "c6ce3c60", "dfnText": "granted", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-permissionstate-granted" }], "title": "5. Persistence permission" }, { "refs": [{ "id": "ref-for-dom-permissionstate-granted\u2460" }], "title": "8. API" }], "url": "https://w3c.github.io/permissions/#dom-permissionstate-granted" },
                "create-a-storage-bucket": { "dfnID": "create-a-storage-bucket", "dfnText": "create a storage bucket", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-create-a-storage-bucket" }], "title": "4.4. Storage shelves" }], "url": "#create-a-storage-bucket" },
                "create-a-storage-shelf": { "dfnID": "create-a-storage-shelf", "dfnText": "create a storage shelf", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-create-a-storage-shelf" }], "title": "4.3. Storage sheds" }, { "refs": [{ "id": "ref-for-create-a-storage-shelf\u2460" }], "title": "4.4. Storage shelves" }], "url": "#create-a-storage-shelf" },
                "d0c1b934": { "dfnID": "d0c1b934", "dfnText": "traversable navigable", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-traversable-navigable" }, { "id": "ref-for-traversable-navigable\u2460" }, { "id": "ref-for-traversable-navigable\u2461" }, { "id": "ref-for-traversable-navigable\u2462" }], "title": "4.3. Storage sheds" }, { "refs": [{ "id": "ref-for-traversable-navigable\u2463" }, { "id": "ref-for-traversable-navigable\u2464" }, { "id": "ref-for-traversable-navigable\u2465" }], "title": "7.1. Storage pressure" }], "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable" },
                "d124397f": { "dfnID": "d124397f", "dfnText": "permission state", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dfn-permission-state" }, { "id": "ref-for-dfn-permission-state\u2460" }], "title": "5. Persistence permission" }], "url": "https://w3c.github.io/permissions/#dfn-permission-state" },
                "d14a6f26": { "dfnID": "d14a6f26", "dfnText": "key", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-key" }], "title": "4.4. Storage shelves" }], "url": "https://infra.spec.whatwg.org/#map-key" },
                "d357c753": { "dfnID": "d357c753", "dfnText": "requesting permission to use", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dfn-request-permission-to-use" }], "title": "8. API" }], "url": "https://w3c.github.io/permissions/#dfn-request-permission-to-use" },
                "dacde8b5": { "dfnID": "dacde8b5", "dfnText": "a new promise", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-a-new-promise" }, { "id": "ref-for-a-new-promise\u2460" }, { "id": "ref-for-a-new-promise\u2461" }], "title": "8. API" }], "url": "https://webidl.spec.whatwg.org/#a-new-promise" },
                "dc3369de": { "dfnID": "dc3369de", "dfnText": "is empty", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-is-empty" }], "title": "7. Management" }], "url": "https://infra.spec.whatwg.org/#map-is-empty" },
                "dictdef-storageestimate": { "dfnID": "dictdef-storageestimate", "dfnText": "StorageEstimate", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dictdef-storageestimate" }, { "id": "ref-for-dictdef-storageestimate\u2460" }], "title": "8. API" }], "url": "#dictdef-storageestimate" },
                "dom-navigatorstorage-storage": { "dfnID": "dom-navigatorstorage-storage", "dfnText": "storage", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dom-navigatorstorage-storage" }], "title": "8. API" }], "url": "#dom-navigatorstorage-storage" },
                "dom-storageestimate-quota": { "dfnID": "dom-storageestimate-quota", "dfnText": "quota", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dom-storageestimate-quota" }], "title": "8. API" }], "url": "#dom-storageestimate-quota" },
                "dom-storageestimate-usage": { "dfnID": "dom-storageestimate-usage", "dfnText": "usage", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dom-storageestimate-usage" }], "title": "8. API" }], "url": "#dom-storageestimate-usage" },
                "dom-storagemanager-estimate": { "dfnID": "dom-storagemanager-estimate", "dfnText": "estimate()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dom-storagemanager-estimate" }], "title": "1. Introduction" }, { "refs": [{ "id": "ref-for-dom-storagemanager-estimate\u2460" }], "title": "8. API" }], "url": "#dom-storagemanager-estimate" },
                "dom-storagemanager-persist": { "dfnID": "dom-storagemanager-persist", "dfnText": "persist()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dom-storagemanager-persist" }], "title": "1. Introduction" }, { "refs": [{ "id": "ref-for-dom-storagemanager-persist\u2460" }], "title": "8. API" }], "url": "#dom-storagemanager-persist" },
                "dom-storagemanager-persisted": { "dfnID": "dom-storagemanager-persisted", "dfnText": "persisted()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dom-storagemanager-persisted" }], "title": "8. API" }], "url": "#dom-storagemanager-persisted" },
                "e270bd2a": { "dfnID": "e270bd2a", "dfnText": "task", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-task" }], "title": "4.8. Storage task source" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" },
                "e99bd18e": { "dfnID": "e99bd18e", "dfnText": "relevant global object", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-relevant-global" }, { "id": "ref-for-concept-relevant-global\u2460" }, { "id": "ref-for-concept-relevant-global\u2461" }], "title": "8. API" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" },
                "f14b47b8": { "dfnID": "f14b47b8", "dfnText": "unsigned long long", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-idl-unsigned-long-long" }, { "id": "ref-for-idl-unsigned-long-long\u2460" }], "title": "8. API" }], "url": "https://webidl.spec.whatwg.org/#idl-unsigned-long-long" },
                "f6e4cbfd": { "dfnID": "f6e4cbfd", "dfnText": "agent cluster", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sec-agent-clusters" }], "title": "4.6. Storage bottles" }], "url": "https://tc39.github.io/ecma262/#sec-agent-clusters" },
                "fa5ee9c5": { "dfnID": "fa5ee9c5", "dfnText": "creation URL", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-environment-creation-url" }], "title": "4.2. Storage keys" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url" },
                "legacy-clone-a-traversable-storage-shed": { "dfnID": "legacy-clone-a-traversable-storage-shed", "dfnText": "legacy-clone a traversable storage shed", "external": false, "refSections": [], "url": "#legacy-clone-a-traversable-storage-shed" },
                "local-storage": { "dfnID": "local-storage", "dfnText": "local storage", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-local-storage" }], "title": "4.1. Storage endpoints" }, { "refs": [{ "id": "ref-for-local-storage\u2460" }], "title": "4.5. Storage buckets" }], "url": "#local-storage" },
                "navigatorstorage": { "dfnID": "navigatorstorage", "dfnText": "NavigatorStorage", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-navigatorstorage" }, { "id": "ref-for-navigatorstorage\u2460" }], "title": "8. API" }], "url": "#navigatorstorage" },
                "obtain-a-local-storage-bottle-map": { "dfnID": "obtain-a-local-storage-bottle-map", "dfnText": "obtain a local storage bottle map", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-obtain-a-local-storage-bottle-map" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-obtain-a-local-storage-bottle-map\u2460" }], "title": "4.1. Storage endpoints" }], "url": "#obtain-a-local-storage-bottle-map" },
                "obtain-a-local-storage-shelf": { "dfnID": "obtain-a-local-storage-shelf", "dfnText": "obtain a local storage shelf", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-obtain-a-local-storage-shelf" }], "title": "5. Persistence permission" }, { "refs": [{ "id": "ref-for-obtain-a-local-storage-shelf\u2460" }, { "id": "ref-for-obtain-a-local-storage-shelf\u2461" }, { "id": "ref-for-obtain-a-local-storage-shelf\u2462" }], "title": "8. API" }], "url": "#obtain-a-local-storage-shelf" },
                "obtain-a-session-storage-bottle-map": { "dfnID": "obtain-a-session-storage-bottle-map", "dfnText": "obtain a session storage bottle map", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-obtain-a-session-storage-bottle-map" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-obtain-a-session-storage-bottle-map\u2460" }], "title": "4.1. Storage endpoints" }], "url": "#obtain-a-session-storage-bottle-map" },
                "obtain-a-storage-bottle-map": { "dfnID": "obtain-a-storage-bottle-map", "dfnText": "obtain a storage bottle map", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-obtain-a-storage-bottle-map" }, { "id": "ref-for-obtain-a-storage-bottle-map\u2460" }], "title": "4.6. Storage bottles" }], "url": "#obtain-a-storage-bottle-map" },
                "obtain-a-storage-key": { "dfnID": "obtain-a-storage-key", "dfnText": "obtain a storage key", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-obtain-a-storage-key" }], "title": "4.4. Storage shelves" }], "url": "#obtain-a-storage-key" },
                "obtain-a-storage-key-for-non-storage-purposes": { "dfnID": "obtain-a-storage-key-for-non-storage-purposes", "dfnText": "obtain a storage key for non-storage purposes", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-obtain-a-storage-key-for-non-storage-purposes" }], "title": "4.2. Storage keys" }], "url": "#obtain-a-storage-key-for-non-storage-purposes" },
                "obtain-a-storage-shelf": { "dfnID": "obtain-a-storage-shelf", "dfnText": "obtain a storage shelf", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-obtain-a-storage-shelf" }, { "id": "ref-for-obtain-a-storage-shelf\u2460" }], "title": "4.4. Storage shelves" }, { "refs": [{ "id": "ref-for-obtain-a-storage-shelf\u2461" }], "title": "4.6. Storage bottles" }], "url": "#obtain-a-storage-shelf" },
                "queue-a-storage-task": { "dfnID": "queue-a-storage-task", "dfnText": "queue a storage task", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-queue-a-storage-task" }, { "id": "ref-for-queue-a-storage-task\u2460" }, { "id": "ref-for-queue-a-storage-task\u2461" }, { "id": "ref-for-queue-a-storage-task\u2462" }], "title": "8. API" }], "url": "#queue-a-storage-task" },
                "registered-storage-endpoints": { "dfnID": "registered-storage-endpoints", "dfnText": "registered storage endpoints", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-registered-storage-endpoints" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-registered-storage-endpoints\u2460" }], "title": "4.5. Storage buckets" }], "url": "#registered-storage-endpoints" },
                "session-storage": { "dfnID": "session-storage", "dfnText": "session storage", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-session-storage" }], "title": "4.1. Storage endpoints" }, { "refs": [{ "id": "ref-for-session-storage\u2460" }], "title": "4.5. Storage buckets" }], "url": "#session-storage" },
                "session-storage-bucket": { "dfnID": "session-storage-bucket", "dfnText": "session storage bucket", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-session-storage-bucket" }], "title": "4.5. Storage buckets" }, { "refs": [{ "id": "ref-for-session-storage-bucket\u2460" }], "title": "7.1. Storage pressure" }], "url": "#session-storage-bucket" },
                "storage-bottle": { "dfnID": "storage-bottle", "dfnText": "storage bottle", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-bottle" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-storage-bottle\u2460" }, { "id": "ref-for-storage-bottle\u2461" }], "title": "4.1. Storage endpoints" }, { "refs": [{ "id": "ref-for-storage-bottle\u2462" }, { "id": "ref-for-storage-bottle\u2463" }], "title": "4.5. Storage buckets" }, { "refs": [{ "id": "ref-for-storage-bottle\u2464" }, { "id": "ref-for-storage-bottle\u2465" }, { "id": "ref-for-storage-bottle\u2466" }, { "id": "ref-for-storage-bottle\u2467" }], "title": "4.6. Storage bottles" }], "url": "#storage-bottle" },
                "storage-bottle-map": { "dfnID": "storage-bottle-map", "dfnText": "map", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-bottle-map" }, { "id": "ref-for-storage-bottle-map\u2460" }], "title": "4.3. Storage sheds" }, { "refs": [{ "id": "ref-for-storage-bottle-map\u2461" }, { "id": "ref-for-storage-bottle-map\u2462" }], "title": "4.6. Storage bottles" }], "url": "#storage-bottle-map" },
                "storage-bottle-proxy-map-reference-set": { "dfnID": "storage-bottle-proxy-map-reference-set", "dfnText": "proxy map reference set", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-bottle-proxy-map-reference-set" }], "title": "4.6. Storage bottles" }], "url": "#storage-bottle-proxy-map-reference-set" },
                "storage-bottle-quota": { "dfnID": "storage-bottle-quota", "dfnText": "quota", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-bottle-quota" }], "title": "4.1. Storage endpoints" }, { "refs": [{ "id": "ref-for-storage-bottle-quota\u2460" }], "title": "4.5. Storage buckets" }], "url": "#storage-bottle-quota" },
                "storage-bucket": { "dfnID": "storage-bucket", "dfnText": "storage bucket", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-bucket" }, { "id": "ref-for-storage-bucket\u2460" }, { "id": "ref-for-storage-bucket\u2461" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-storage-bucket\u2462" }], "title": "4.4. Storage shelves" }, { "refs": [{ "id": "ref-for-storage-bucket\u2463" }, { "id": "ref-for-storage-bucket\u2464" }, { "id": "ref-for-storage-bucket\u2465" }], "title": "4.5. Storage buckets" }, { "refs": [{ "id": "ref-for-storage-bucket\u2466" }], "title": "4.6. Storage bottles" }, { "refs": [{ "id": "ref-for-storage-bucket\u2467" }, { "id": "ref-for-storage-bucket\u2468" }, { "id": "ref-for-storage-bucket\u2460\u24ea" }], "title": "7. Management" }], "url": "#storage-bucket" },
                "storage-endpoint": { "dfnID": "storage-endpoint", "dfnText": "storage endpoint", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-endpoint" }, { "id": "ref-for-storage-endpoint\u2460" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-storage-endpoint\u2461" }, { "id": "ref-for-storage-endpoint\u2462" }, { "id": "ref-for-storage-endpoint\u2463" }, { "id": "ref-for-storage-endpoint\u2464" }, { "id": "ref-for-storage-endpoint\u2465" }], "title": "4.1. Storage endpoints" }, { "refs": [{ "id": "ref-for-storage-endpoint\u2466" }], "title": "4.5. Storage buckets" }, { "refs": [{ "id": "ref-for-storage-endpoint\u2467" }], "title": "4.6. Storage bottles" }, { "refs": [{ "id": "ref-for-storage-endpoint\u2468" }, { "id": "ref-for-storage-endpoint\u2460\u24ea" }], "title": "4.8. Storage task source" }], "url": "#storage-endpoint" },
                "storage-endpoint-identifier": { "dfnID": "storage-endpoint-identifier", "dfnText": "identifier", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-endpoint-identifier" }], "title": "4.1. Storage endpoints" }, { "refs": [{ "id": "ref-for-storage-endpoint-identifier\u2460" }], "title": "4.5. Storage buckets" }], "url": "#storage-endpoint-identifier" },
                "storage-endpoint-quota": { "dfnID": "storage-endpoint-quota", "dfnText": "quota", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-endpoint-quota" }], "title": "4.1. Storage endpoints" }, { "refs": [{ "id": "ref-for-storage-endpoint-quota\u2460" }], "title": "4.5. Storage buckets" }, { "refs": [{ "id": "ref-for-storage-endpoint-quota\u2461" }], "title": "4.8. Storage task source" }], "url": "#storage-endpoint-quota" },
                "storage-endpoint-types": { "dfnID": "storage-endpoint-types", "dfnText": "types", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-endpoint-types" }], "title": "4.1. Storage endpoints" }, { "refs": [{ "id": "ref-for-storage-endpoint-types\u2460" }], "title": "4.5. Storage buckets" }], "url": "#storage-endpoint-types" },
                "storage-identifier": { "dfnID": "storage-identifier", "dfnText": "storage identifier", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-identifier" }, { "id": "ref-for-storage-identifier\u2460" }], "title": "4.1. Storage endpoints" }, { "refs": [{ "id": "ref-for-storage-identifier\u2461" }], "title": "4.5. Storage buckets" }, { "refs": [{ "id": "ref-for-storage-identifier\u2462" }, { "id": "ref-for-storage-identifier\u2463" }, { "id": "ref-for-storage-identifier\u2464" }], "title": "4.6. Storage bottles" }], "url": "#storage-identifier" },
                "storage-key": { "dfnID": "storage-key", "dfnText": "storage key", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-key" }, { "id": "ref-for-storage-key\u2460" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-storage-key\u2461" }, { "id": "ref-for-storage-key\u2462" }], "title": "4.2. Storage keys" }, { "refs": [{ "id": "ref-for-storage-key\u2463" }], "title": "4.3. Storage sheds" }, { "refs": [{ "id": "ref-for-storage-key\u2464" }], "title": "4.4. Storage shelves" }, { "refs": [{ "id": "ref-for-storage-key\u2465" }], "title": "7. Management" }], "url": "#storage-key" },
                "storage-key-equal": { "dfnID": "storage-key-equal", "dfnText": "equals", "external": false, "refSections": [], "url": "#storage-key-equal" },
                "storage-key-origin": { "dfnID": "storage-key-origin", "dfnText": "origin", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-key-origin" }, { "id": "ref-for-storage-key-origin\u2460" }, { "id": "ref-for-storage-key-origin\u2461" }], "title": "4.2. Storage keys" }], "url": "#storage-key-origin" },
                "storage-proxy-map": { "dfnID": "storage-proxy-map", "dfnText": "storage proxy map", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-proxy-map" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-storage-proxy-map\u2460" }], "title": "4.6. Storage bottles" }], "url": "#storage-proxy-map" },
                "storage-proxy-map-backing-map": { "dfnID": "storage-proxy-map-backing-map", "dfnText": "backing map", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-proxy-map-backing-map" }], "title": "4.6. Storage bottles" }, { "refs": [{ "id": "ref-for-storage-proxy-map-backing-map\u2460" }], "title": "4.7. Storage proxy maps" }], "url": "#storage-proxy-map-backing-map" },
                "storage-quota": { "dfnID": "storage-quota", "dfnText": "storage quota", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-quota" }], "title": "4.6. Storage bottles" }, { "refs": [{ "id": "ref-for-storage-quota\u2460" }], "title": "8. API" }], "url": "#storage-quota" },
                "storage-shed": { "dfnID": "storage-shed", "dfnText": "storage shed", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-shed" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-storage-shed\u2460" }, { "id": "ref-for-storage-shed\u2461" }], "title": "4.3. Storage sheds" }, { "refs": [{ "id": "ref-for-storage-shed\u2462" }, { "id": "ref-for-storage-shed\u2463" }], "title": "4.4. Storage shelves" }, { "refs": [{ "id": "ref-for-storage-shed\u2464" }], "title": "7. Management" }], "url": "#storage-shed" },
                "storage-shelf": { "dfnID": "storage-shelf", "dfnText": "storage shelf", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-shelf" }, { "id": "ref-for-storage-shelf\u2460" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-storage-shelf\u2461" }], "title": "4.3. Storage sheds" }, { "refs": [{ "id": "ref-for-storage-shelf\u2462" }, { "id": "ref-for-storage-shelf\u2463" }], "title": "4.4. Storage shelves" }, { "refs": [{ "id": "ref-for-storage-shelf\u2464" }], "title": "4.6. Storage bottles" }, { "refs": [{ "id": "ref-for-storage-shelf\u2465" }, { "id": "ref-for-storage-shelf\u2466" }, { "id": "ref-for-storage-shelf\u2467" }], "title": "6. Usage and quota" }, { "refs": [{ "id": "ref-for-storage-shelf\u2468" }, { "id": "ref-for-storage-shelf\u2460\u24ea" }], "title": "7. Management" }], "url": "#storage-shelf" },
                "storage-type": { "dfnID": "storage-type", "dfnText": "storage type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-type" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-storage-type\u2460" }, { "id": "ref-for-storage-type\u2461" }], "title": "4.1. Storage endpoints" }, { "refs": [{ "id": "ref-for-storage-type\u2462" }, { "id": "ref-for-storage-type\u2463" }], "title": "4.4. Storage shelves" }, { "refs": [{ "id": "ref-for-storage-type\u2464" }], "title": "4.5. Storage buckets" }, { "refs": [{ "id": "ref-for-storage-type\u2465" }], "title": "4.6. Storage bottles" }], "url": "#storage-type" },
                "storage-usage": { "dfnID": "storage-usage", "dfnText": "storage usage", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storage-usage" }], "title": "8. API" }], "url": "#storage-usage" },
                "storagemanager": { "dfnID": "storagemanager", "dfnText": "StorageManager", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-storagemanager" }, { "id": "ref-for-storagemanager\u2460" }, { "id": "ref-for-storagemanager\u2461" }], "title": "8. API" }], "url": "#storagemanager" },
                "task-source": { "dfnID": "task-source", "dfnText": "storage task source", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-task-source\u2460" }], "title": "4.8. Storage task source" }], "url": "#task-source" },
                "traversable-navigable-storage-shed": { "dfnID": "traversable-navigable-storage-shed", "dfnText": "storage shed", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-traversable-navigable-storage-shed" }, { "id": "ref-for-traversable-navigable-storage-shed\u2460" }, { "id": "ref-for-traversable-navigable-storage-shed\u2461" }], "title": "4.3. Storage sheds" }, { "refs": [{ "id": "ref-for-traversable-navigable-storage-shed\u2462" }], "title": "4.6. Storage bottles" }], "url": "#traversable-navigable-storage-shed" },
                "user-agent-storage-shed": { "dfnID": "user-agent-storage-shed", "dfnText": "storage shed", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-user-agent-storage-shed" }], "title": "4.3. Storage sheds" }, { "refs": [{ "id": "ref-for-user-agent-storage-shed\u2460" }], "title": "4.4. Storage shelves" }, { "refs": [{ "id": "ref-for-user-agent-storage-shed\u2461" }], "title": "4.6. Storage bottles" }], "url": "#user-agent-storage-shed" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-position-annos */
        "use strict";
        {
            function repositionAnnoPanels() {
                const panels = [...document.querySelectorAll("[data-anno-for]")];
                hydratePanels(panels);
                let vSoFar = 0;
                for (const panel of panels.sort(cmpTops)) {
                    if (panel.top < vSoFar) {
                        panel.top = vSoFar;
                        panel.style.top = vSoFar + "px";
                    }
                    vSoFar = panel.top + panel.height + 15;
                }
            }
            function hydratePanels(panels) {
                const main = document.querySelector("main");
                let mainRect;
                if (main) mainRect = main.getBoundingClientRect();
                // First display them all, if they're not already visible.
                for (const panel of panels) {
                    panel.classList.remove("unpositioned");
                }
                // Measure them all
                for (const panel of panels) {
                    const dfn = document.getElementById(panel.getAttribute("data-anno-for"));
                    if (!dfn) {
                        console.log("Can't find the annotation panel target:", panel);
                        continue;
                    }
                    panel.dfn = dfn;
                    panel.top = window.scrollY + dfn.getBoundingClientRect().top;
                    let panelRect = panel.getBoundingClientRect();
                    panel.height = panelRect.height;
                    if (main) {
                        panel.overlappingMain = panelRect.left < mainRect.right;
                    } else {
                        panel.overlappingMain = false;
                    }
                }
                // And finally position them
                for (const panel of panels) {
                    const dfn = panel.dfn;
                    if (!dfn) continue;
                    panel.style.top = panel.top + "px";
                    panel.classList.toggle("overlapping-main", panel.overlappingMain);
                }
            }

            function cmpTops(a, b) {
                return a.top - b.top;
            }

            window.addEventListener("load", repositionAnnoPanels);
            window.addEventListener("resize", repositionAnnoPanels);
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#bottle-map": { "displayText": "bottle map", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "bottle map", "type": "dfn", "url": "#bottle-map" },
                "#bucket": { "displayText": "local storage bucket", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "local storage bucket", "type": "dfn", "url": "#bucket" },
                "#bucket-map": { "displayText": "bucket map", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "bucket map", "type": "dfn", "url": "#bucket-map" },
                "#bucket-mode": { "displayText": "mode", "export": true, "for_": ["local storage bucket"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "mode", "type": "dfn", "url": "#bucket-mode" },
                "#create-a-storage-bucket": { "displayText": "create a storage bucket", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "create a storage bucket", "type": "dfn", "url": "#create-a-storage-bucket" },
                "#create-a-storage-shelf": { "displayText": "create a storage shelf", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "create a storage shelf", "type": "dfn", "url": "#create-a-storage-shelf" },
                "#dictdef-storageestimate": { "displayText": "StorageEstimate", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "StorageEstimate", "type": "dictionary", "url": "#dictdef-storageestimate" },
                "#dom-navigatorstorage-storage": { "displayText": "storage", "export": true, "for_": ["NavigatorStorage"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage", "type": "attribute", "url": "#dom-navigatorstorage-storage" },
                "#dom-storageestimate-quota": { "displayText": "quota", "export": true, "for_": ["StorageEstimate"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "quota", "type": "dict-member", "url": "#dom-storageestimate-quota" },
                "#dom-storageestimate-usage": { "displayText": "usage", "export": true, "for_": ["StorageEstimate"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "usage", "type": "dict-member", "url": "#dom-storageestimate-usage" },
                "#dom-storagemanager-estimate": { "displayText": "estimate()", "export": true, "for_": ["StorageManager"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "estimate()", "type": "method", "url": "#dom-storagemanager-estimate" },
                "#dom-storagemanager-persist": { "displayText": "persist()", "export": true, "for_": ["StorageManager"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "persist()", "type": "method", "url": "#dom-storagemanager-persist" },
                "#dom-storagemanager-persisted": { "displayText": "persisted()", "export": true, "for_": ["StorageManager"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "persisted()", "type": "method", "url": "#dom-storagemanager-persisted" },
                "#local-storage": { "displayText": "local storage", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "local storage", "type": "dfn", "url": "#local-storage" },
                "#navigatorstorage": { "displayText": "NavigatorStorage", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "NavigatorStorage", "type": "interface", "url": "#navigatorstorage" },
                "#obtain-a-local-storage-bottle-map": { "displayText": "obtain a local storage bottle map", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "obtain a local storage bottle map", "type": "dfn", "url": "#obtain-a-local-storage-bottle-map" },
                "#obtain-a-local-storage-shelf": { "displayText": "obtain a local storage shelf", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "obtain a local storage shelf", "type": "dfn", "url": "#obtain-a-local-storage-shelf" },
                "#obtain-a-session-storage-bottle-map": { "displayText": "obtain a session storage bottle map", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "obtain a session storage bottle map", "type": "dfn", "url": "#obtain-a-session-storage-bottle-map" },
                "#obtain-a-storage-bottle-map": { "displayText": "obtain a storage bottle map", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "obtain a storage bottle map", "type": "dfn", "url": "#obtain-a-storage-bottle-map" },
                "#obtain-a-storage-key": { "displayText": "obtain a storage key", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "obtain a storage key", "type": "dfn", "url": "#obtain-a-storage-key" },
                "#obtain-a-storage-key-for-non-storage-purposes": { "displayText": "obtain a storage key for non-storage purposes", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "obtain a storage key for non-storage purposes", "type": "dfn", "url": "#obtain-a-storage-key-for-non-storage-purposes" },
                "#obtain-a-storage-shelf": { "displayText": "obtain a storage shelf", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "obtain a storage shelf", "type": "dfn", "url": "#obtain-a-storage-shelf" },
                "#queue-a-storage-task": { "displayText": "queue a storage task", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "queue a storage task", "type": "dfn", "url": "#queue-a-storage-task" },
                "#registered-storage-endpoints": { "displayText": "registered storage endpoints", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "registered storage endpoints", "type": "dfn", "url": "#registered-storage-endpoints" },
                "#session-storage": { "displayText": "session storage", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "session storage", "type": "dfn", "url": "#session-storage" },
                "#session-storage-bucket": { "displayText": "session storage bucket", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "session storage bucket", "type": "dfn", "url": "#session-storage-bucket" },
                "#storage-bottle": { "displayText": "storage bottle", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage bottle", "type": "dfn", "url": "#storage-bottle" },
                "#storage-bottle-map": { "displayText": "map", "export": true, "for_": ["storage bottle"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "map", "type": "dfn", "url": "#storage-bottle-map" },
                "#storage-bottle-proxy-map-reference-set": { "displayText": "proxy map reference set", "export": true, "for_": ["storage bottle"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "proxy map reference set", "type": "dfn", "url": "#storage-bottle-proxy-map-reference-set" },
                "#storage-bottle-quota": { "displayText": "quota", "export": true, "for_": ["storage bottle"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "quota", "type": "dfn", "url": "#storage-bottle-quota" },
                "#storage-bucket": { "displayText": "storage bucket", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage bucket", "type": "dfn", "url": "#storage-bucket" },
                "#storage-endpoint": { "displayText": "storage endpoint", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage endpoint", "type": "dfn", "url": "#storage-endpoint" },
                "#storage-endpoint-identifier": { "displayText": "identifier", "export": true, "for_": ["storage endpoint"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "identifier", "type": "dfn", "url": "#storage-endpoint-identifier" },
                "#storage-endpoint-quota": { "displayText": "quota", "export": true, "for_": ["storage endpoint"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "quota", "type": "dfn", "url": "#storage-endpoint-quota" },
                "#storage-endpoint-types": { "displayText": "types", "export": true, "for_": ["storage endpoint"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "types", "type": "dfn", "url": "#storage-endpoint-types" },
                "#storage-identifier": { "displayText": "storage identifier", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage identifier", "type": "dfn", "url": "#storage-identifier" },
                "#storage-key": { "displayText": "storage key", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage key", "type": "dfn", "url": "#storage-key" },
                "#storage-key-origin": { "displayText": "origin", "export": true, "for_": ["storage key"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "origin", "type": "dfn", "url": "#storage-key-origin" },
                "#storage-proxy-map": { "displayText": "storage proxy map", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage proxy map", "type": "dfn", "url": "#storage-proxy-map" },
                "#storage-proxy-map-backing-map": { "displayText": "backing map", "export": true, "for_": ["storage proxy map"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "backing map", "type": "dfn", "url": "#storage-proxy-map-backing-map" },
                "#storage-quota": { "displayText": "storage quota", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage quota", "type": "dfn", "url": "#storage-quota" },
                "#storage-shed": { "displayText": "storage shed", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage shed", "type": "dfn", "url": "#storage-shed" },
                "#storage-shelf": { "displayText": "storage shelves", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage shelves", "type": "dfn", "url": "#storage-shelf" },
                "#storage-type": { "displayText": "storage type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage type", "type": "dfn", "url": "#storage-type" },
                "#storage-usage": { "displayText": "storage usage", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage usage", "type": "dfn", "url": "#storage-usage" },
                "#storagemanager": { "displayText": "StorageManager", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "StorageManager", "type": "interface", "url": "#storagemanager" },
                "#task-source": { "displayText": "storage task source", "export": true, "for_": [], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage task source", "type": "dfn", "url": "#task-source" },
                "#traversable-navigable-storage-shed": { "displayText": "storage shed", "export": true, "for_": ["traversable navigable"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage shed", "type": "dfn", "url": "#traversable-navigable-storage-shed" },
                "#user-agent-storage-shed": { "displayText": "storage shed", "export": true, "for_": ["user agent"], "level": "", "normative": true, "shortname": "storage", "spec": "storage", "status": "local", "text": "storage shed", "type": "dfn", "url": "#user-agent-storage-shed" },
                "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin": { "displayText": "origin", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "origin", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" },
                "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque": { "displayText": "opaque origin", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "opaque origin", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" },
                "https://html.spec.whatwg.org/multipage/browsers.html#same-origin": { "displayText": "same origin", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "same origin", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/browsers.html#same-origin" },
                "https://html.spec.whatwg.org/multipage/document-sequences.html#nav-traversable": { "displayText": "traversable navigable", "export": true, "for_": ["navigable"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "traversable navigable", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#nav-traversable" },
                "https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable": { "displayText": "node navigable", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "node navigable", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable" },
                "https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable": { "displayText": "traversable navigable", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "traversable navigable", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable" },
                "https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel": { "displayText": "in parallel", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "in parallel", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" },
                "https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window": { "displayText": "associated Document", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "associated document", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" },
                "https://html.spec.whatwg.org/multipage/system-state.html#navigator": { "displayText": "Navigator", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "Navigator", "type": "interface", "url": "https://html.spec.whatwg.org/multipage/system-state.html#navigator" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url": { "displayText": "creation URL", "export": true, "for_": ["environment"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "creation url", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global": { "displayText": "relevant global object", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "relevant global object", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin": { "displayText": "origin", "export": true, "for_": ["environment settings object"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "origin", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#concept-task": { "displayText": "task", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "task", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object": { "displayText": "current settings object", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "current settings object", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#environment": { "displayText": "environment", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "environment", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#environment" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object": { "displayText": "environment settings object", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "environment settings object", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#global-object": { "displayText": "global object", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "global object", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#global-object" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task": { "displayText": "queue a global task", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "queue a global task", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object": { "displayText": "relevant settings object", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "relevant settings object", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#task-source": { "displayText": "task source", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "task source", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#task-source" },
                "https://html.spec.whatwg.org/multipage/workers.html#workernavigator": { "displayText": "WorkerNavigator", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "WorkerNavigator", "type": "interface", "url": "https://html.spec.whatwg.org/multipage/workers.html#workernavigator" },
                "https://infra.spec.whatwg.org/#ascii-string": { "displayText": "ASCII string", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ascii string", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ascii-string" },
                "https://infra.spec.whatwg.org/#implementation-defined": { "displayText": "implementation-defined", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "implementation-defined", "type": "dfn", "url": "https://infra.spec.whatwg.org/#implementation-defined" },
                "https://infra.spec.whatwg.org/#list-contain": { "displayText": "contain", "export": true, "for_": ["list", "stack", "queue", "set"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "contain", "type": "dfn", "url": "https://infra.spec.whatwg.org/#list-contain" },
                "https://infra.spec.whatwg.org/#list-iterate": { "displayText": "for each", "export": true, "for_": ["list", "set"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "for each", "type": "dfn", "url": "https://infra.spec.whatwg.org/#list-iterate" },
                "https://infra.spec.whatwg.org/#map-clone": { "displayText": "clone", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "clone", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-clone" },
                "https://infra.spec.whatwg.org/#map-exists": { "displayText": "exist", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "exist", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-exists" },
                "https://infra.spec.whatwg.org/#map-is-empty": { "displayText": "is empty", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "is empty", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-is-empty" },
                "https://infra.spec.whatwg.org/#map-iterate": { "displayText": "for each", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "for each", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-iterate" },
                "https://infra.spec.whatwg.org/#map-key": { "displayText": "key", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "key", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-key" },
                "https://infra.spec.whatwg.org/#map-remove": { "displayText": "remove", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "remove", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-remove" },
                "https://infra.spec.whatwg.org/#map-value": { "displayText": "value", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "value", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-value" },
                "https://infra.spec.whatwg.org/#ordered-map": { "displayText": "map", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "map", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ordered-map" },
                "https://infra.spec.whatwg.org/#ordered-set": { "displayText": "set", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "set", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ordered-set" },
                "https://infra.spec.whatwg.org/#set-append": { "displayText": "append", "export": true, "for_": ["set"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "append", "type": "dfn", "url": "https://infra.spec.whatwg.org/#set-append" },
                "https://infra.spec.whatwg.org/#string": { "displayText": "string", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "string", "type": "dfn", "url": "https://infra.spec.whatwg.org/#string" },
                "https://infra.spec.whatwg.org/#tuple": { "displayText": "tuple", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "tuple", "type": "dfn", "url": "https://infra.spec.whatwg.org/#tuple" },
                "https://infra.spec.whatwg.org/#user-agent": { "displayText": "user agent", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "user agent", "type": "dfn", "url": "https://infra.spec.whatwg.org/#user-agent" },
                "https://tc39.github.io/ecma262/#sec-agent-clusters": { "displayText": "agent cluster", "export": true, "for_": [], "level": "", "normative": true, "shortname": "ecmascript", "spec": "ecmascript", "status": "anchor-block", "text": "agent cluster", "type": "dfn", "url": "https://tc39.github.io/ecma262/#sec-agent-clusters" },
                "https://tc39.github.io/ecma262/#sec-agents": { "displayText": "agent", "export": true, "for_": [], "level": "", "normative": true, "shortname": "ecmascript", "spec": "ecmascript", "status": "anchor-block", "text": "agent", "type": "dfn", "url": "https://tc39.github.io/ecma262/#sec-agents" },
                "https://url.spec.whatwg.org/#concept-url-origin": { "displayText": "origin", "export": true, "for_": ["url"], "level": "1", "normative": true, "shortname": "url", "spec": "url", "status": "current", "text": "origin", "type": "dfn", "url": "https://url.spec.whatwg.org/#concept-url-origin" },
                "https://w3c.github.io/permissions/#dfn-getting-the-current-permission-state": { "displayText": "getting the current permission state", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "permissions", "spec": "permissions", "status": "current", "text": "getting the current permission state", "type": "dfn", "url": "https://w3c.github.io/permissions/#dfn-getting-the-current-permission-state" },
                "https://w3c.github.io/permissions/#dfn-permission-revocation-algorithm": { "displayText": "permission revocation algorithm", "export": true, "for_": ["powerful feature"], "level": "1", "normative": true, "shortname": "permissions", "spec": "permissions", "status": "current", "text": "permission revocation algorithm", "type": "dfn", "url": "https://w3c.github.io/permissions/#dfn-permission-revocation-algorithm" },
                "https://w3c.github.io/permissions/#dfn-permission-state": { "displayText": "permission state", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "permissions", "spec": "permissions", "status": "current", "text": "permission state", "type": "dfn", "url": "https://w3c.github.io/permissions/#dfn-permission-state" },
                "https://w3c.github.io/permissions/#dfn-powerful-feature": { "displayText": "powerful feature", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "permissions", "spec": "permissions", "status": "current", "text": "powerful feature", "type": "dfn", "url": "https://w3c.github.io/permissions/#dfn-powerful-feature" },
                "https://w3c.github.io/permissions/#dfn-request-permission-to-use": { "displayText": "requesting permission to use", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "permissions", "spec": "permissions", "status": "current", "text": "requesting permission to use", "type": "dfn", "url": "https://w3c.github.io/permissions/#dfn-request-permission-to-use" },
                "https://w3c.github.io/permissions/#dom-permissionstate-granted": { "displayText": "granted", "export": true, "for_": ["PermissionState"], "level": "1", "normative": true, "shortname": "permissions", "spec": "permissions", "status": "current", "text": "granted", "type": "enum-value", "url": "https://w3c.github.io/permissions/#dom-permissionstate-granted" },
                "https://webidl.spec.whatwg.org/#Exposed": { "displayText": "Exposed", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "Exposed", "type": "extended-attribute", "url": "https://webidl.spec.whatwg.org/#Exposed" },
                "https://webidl.spec.whatwg.org/#SameObject": { "displayText": "SameObject", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "SameObject", "type": "extended-attribute", "url": "https://webidl.spec.whatwg.org/#SameObject" },
                "https://webidl.spec.whatwg.org/#SecureContext": { "displayText": "SecureContext", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "SecureContext", "type": "extended-attribute", "url": "https://webidl.spec.whatwg.org/#SecureContext" },
                "https://webidl.spec.whatwg.org/#a-new-promise": { "displayText": "a new promise", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "a new promise", "type": "dfn", "url": "https://webidl.spec.whatwg.org/#a-new-promise" },
                "https://webidl.spec.whatwg.org/#exceptiondef-typeerror": { "displayText": "TypeError", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "TypeError", "type": "exception", "url": "https://webidl.spec.whatwg.org/#exceptiondef-typeerror" },
                "https://webidl.spec.whatwg.org/#idl-boolean": { "displayText": "boolean", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "boolean", "type": "interface", "url": "https://webidl.spec.whatwg.org/#idl-boolean" },
                "https://webidl.spec.whatwg.org/#idl-promise": { "displayText": "Promise", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "Promise", "type": "interface", "url": "https://webidl.spec.whatwg.org/#idl-promise" },
                "https://webidl.spec.whatwg.org/#idl-unsigned-long-long": { "displayText": "unsigned long long", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "unsigned long long", "type": "interface", "url": "https://webidl.spec.whatwg.org/#idl-unsigned-long-long" },
                "https://webidl.spec.whatwg.org/#reject": { "displayText": "reject", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "reject", "type": "dfn", "url": "https://webidl.spec.whatwg.org/#reject" },
                "https://webidl.spec.whatwg.org/#resolve": { "displayText": "resolve", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "resolve", "type": "dfn", "url": "https://webidl.spec.whatwg.org/#resolve" },
                "https://webidl.spec.whatwg.org/#this": { "displayText": "this", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "this", "type": "dfn", "url": "https://webidl.spec.whatwg.org/#this" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
                    // Give the original term if it's being displayed in a different way.
                    // But allow casing differences, they're insignificant.
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.displayText)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const refHintKey = link.getAttribute("data-refhint-key");
                let key = url;
                if (refHintKey) {
                    key = refHintKey + "_" + url;
                }
                const ref = refsData[key];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-var-click-highlighting */
        "use strict";
        {
            /*
            Color-choosing design:
            
            * Colors are ordered by goodness.
            * On clicking a var, give it the earliest color
                with the lowest usage in the algorithm.
            * On re-clicking, re-use the var's most recent color
                if that's not currently being used elsewhere.
            */

            const COLOR_COUNT = 7;

            document.addEventListener("click", e => {
                if (e.target.nodeName == "VAR") {
                    highlightSameAlgoVars(e.target);
                }
            });

            function highlightSameAlgoVars(v) {
                // Find the algorithm container.
                let algoContainer = findAlgoContainer(v);

                // Not highlighting document-global vars,
                // too likely to be unrelated.
                if (algoContainer == null) return;

                const varName = nameFromVar(v);
                if (!v.hasAttribute("data-var-color")) {
                    const newColor = chooseHighlightColor(algoContainer, v);
                    for (const el of algoContainer.querySelectorAll("var")) {
                        if (nameFromVar(el) == varName) {
                            el.setAttribute("data-var-color", newColor);
                            el.setAttribute("data-var-last-color", newColor);
                        }
                    }
                } else {
                    for (const el of algoContainer.querySelectorAll("var")) {
                        if (nameFromVar(el) == varName) {
                            el.removeAttribute("data-var-color");
                        }
                    }
                }
            }
            function findAlgoContainer(el) {
                while (el != document.body) {
                    if (el.hasAttribute("data-algorithm")) return el;
                    el = el.parentNode;
                }
                return null;
            }
            function nameFromVar(el) {
                return el.textContent.replace(/(\s|\xa0)+/g, " ").trim();
            }
            function colorCountsFromContainer(container) {
                const namesFromColor = Array.from({ length: COLOR_COUNT }, x => new Set());
                for (let v of container.querySelectorAll("var[data-var-color]")) {
                    let color = +v.getAttribute("data-var-color");
                    namesFromColor[color].add(nameFromVar(v));
                }

                return namesFromColor.map(x => x.size);
            }
            function leastUsedColor(colors) {
                // Find the earliest color with the lowest count.
                let minCount = Infinity;
                let minColor = null;
                for (var i = 0; i < colors.length; i++) {
                    if (colors[i] < minCount) {
                        minColor = i;
                        minCount = colors[i];
                    }
                }
                return minColor;
            }
            function chooseHighlightColor(container, v) {
                const colorCounts = colorCountsFromContainer(container);
                if (v.hasAttribute("data-var-last-color")) {
                    let color = +v.getAttribute("data-var-last-color");
                    if (colorCounts[color] == 0) return color;
                }
                return leastUsedColor(colorCounts);
            }
        }
    </script>