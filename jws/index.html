

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja-JP" lang="ja-JP">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfchandler version 0.2" />
      <meta name="citation_author" content="M. Jones"/>
      <meta name="citation_author" content="J. Bradley"/>
      <meta name="citation_author" content="N. Sakimura"/>
      <meta name="citation_publication_date" content="May, 2015"/>
      <meta name="citation_title" content="JSON Web Signature (JWS)"/>
      <meta name="citation_doi" content="10.17487/RFC7515"/>
      <meta name="citation_issn" content="2070-1721"/>
      <meta name="citation_technical_report_number" content="rfc7515"/>
      <meta name="citation_pdf_url" content="https://www.rfc-editor.org/rfc/pdfrfc/rfc7515.txt.pdf"/>
<title>RFC 7515: JSON Web Signature (JWS)</title>    
        

        <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
           /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->    <script type="text/javascript"><!--
    function addHeaderTags() {
        var spans = document.getElementsByTagName("span");
        for (var i=0; i < spans.length; i++) {
            var elem = spans[i];
            if (elem) {
                var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";               
                }
            }
        }
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script></head>
<body>
<span class="pre noprint docinfo">[<a href="https://www.rfc-editor.org" title="RFC Editor">RFC Home</a>] [<a href="/rfc/rfc7515.txt">TEXT</a>|<a href="/rfc/pdfrfc/rfc7515.txt.pdf">PDF</a>|<a href="/rfc/rfc7515.html">HTML</a>] [<a href='https://datatracker.ietf.org/doc/rfc7515' title='IETF Datatracker information for this document'>Tracker</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=7515&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>] [<a class="boldtext" href="/errata/rfc7515" target="_blank">Errata</a>] [<a href='https://www.rfc-editor.org/info/rfc7515' title='Info page'>Info page</a>]         </span><br/><span class="pre noprint docinfo">                                                                        </span><br /><span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br /><span class="pre noprint docinfo">                                                            <span style='color: #C00;'>Errata Exist</span></span><pre>Internet Engineering Task Force (IETF)                          M. Jones
Request for Comments: 7515                                     Microsoft
Category: Standards Track                                     J. Bradley
ISSN: 2070-1721                                            Ping Identity
                                                             N. Sakimura
                                                                     NRI
                                                                May 2015


                        <span class="h1">JSON Web Signature（JWS）</span>

要約

   JSON Web Signature（JWS）は、JSON ベースのデータ構造を用いて、
   デジタル署名またはメッセージ認証コード（MAC）によって
   保護されたコンテンツを表現する。これらの仕様で使用される
   暗号アルゴリズムおよび識別子は、別途定義されている
   JSON Web Algorithms（JWA）仕様および、その仕様で定義される
   IANA レジストリに記述されている。関連する暗号化機能については、
   別途定義されている JSON Web Encryption（JWE）仕様に記述されている。

本メモの位置付け

   本文書は、インターネット標準トラック文書である。

   本文書は、Internet Engineering Task Force（IETF）の成果物である。
   これは IETF コミュニティの合意を反映したものである。
   本文書は公開レビューを受け、Internet Engineering Steering Group
   （IESG）によって公開が承認されている。インターネット標準に
   関する追加情報は、
   <a href="./rfc5741#section-2">RFC 5741 の Section&nbsp;2</a>
   を参照されたい。

   本文書の現在のステータス、正誤表、およびフィードバックの
   提供方法に関する情報は、次の URL から取得できる。
   <a href="https://www.rfc-editor.org/info/rfc7515">http://www.rfc-editor.org/info/rfc7515</a>.

















<span class="grey">Jones, et al.                Standards Track                    [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

目次

   <a href="#section-1">1</a>. はじめに ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. 表記規約 .................................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. 用語 .........................................................<a href="#page-5">5</a>
   <a href="#section-3">3</a>. JSON Web Signature（JWS）の概要 .............................<a href="#page-7">7</a>
      <a href="#section-3.1">3.1</a>. JWS Compact Serialization の概要 .......................<a href="#page-7">7</a>
      <a href="#section-3.2">3.2</a>. JWS JSON Serialization の概要 ..........................<a href="#page-8">8</a>
      <a href="#section-3.3">3.3</a>. JWS の例 ................................................<a href="#page-8">8</a>
   <a href="#section-4">4</a>. JOSE ヘッダ ...................................................<a href="#page-9">9</a>
      <a href="#section-4.1">4.1</a>. 登録済みヘッダパラメータ名 .............................<a href="#page-10">10</a>
           <a href="#section-4.1.1">4.1.1</a>. "alg"（アルゴリズム）ヘッダパラメータ .............<a href="#page-10">10</a>
           <a href="#section-4.1.2">4.1.2</a>. "jku"（JWK セット URL）ヘッダパラメータ .........<a href="#page-10">10</a>
           <a href="#section-4.1.3">4.1.3</a>. "jwk"（JSON Web Key）ヘッダパラメータ ............<a href="#page-11">11</a>
           <a href="#section-4.1.4">4.1.4</a>. "kid"（キー ID）ヘッダパラメータ ..................<a href="#page-11">11</a>
           <a href="#section-4.1.5">4.1.5</a>. "x5u"（X.509 URL）ヘッダパラメータ ...............<a href="#page-11">11</a>
           <a href="#section-4.1.6">4.1.6</a>. "x5c"（X.509 証明書チェーン）ヘッダパラメータ ...<a href="#page-11">11</a>
           4.1.7. "x5t"（X.509 証明書 SHA-1 サムプリント）
                  ヘッダパラメータ ...................................<a href="#page-12">12</a>
           4.1.8. "x5t#S256"（X.509 証明書 SHA-256
                  サムプリント）ヘッダパラメータ ...................<a href="#page-12">12</a>
           <a href="#section-4.1.9">4.1.9</a>. "typ"（型）ヘッダパラメータ ......................<a href="#page-12">12</a>
           <a href="#section-4.1.10">4.1.10</a>. "cty"（コンテンツ型）ヘッダパラメータ ..........<a href="#page-13">13</a>
           <a href="#section-4.1.11">4.1.11</a>. "crit"（クリティカル）ヘッダパラメータ ..........<a href="#page-14">14</a>
      <a href="#section-4.2">4.2</a>. 公開ヘッダパラメータ名 .................................<a href="#page-14">14</a>
      <a href="#section-4.3">4.3</a>. 私的ヘッダパラメータ名 .................................<a href="#page-14">14</a>
   <a href="#section-5">5</a>. JWS の生成および処理 .......................................<a href="#page-15">15</a>
      <a href="#section-5.1">5.1</a>. メッセージ署名または MAC の計算 ....................<a href="#page-15">15</a>
      <a href="#section-5.2">5.2</a>. メッセージ署名または MAC の検証 ....................<a href="#page-16">16</a>
      <a href="#section-5.3">5.3</a>. 文字列比較規則 .........................................<a href="#page-17">17</a>
   <a href="#section-6">6</a>. 鍵識別 .......................................................<a href="#page-18">18</a>







<span class="grey">Jones, et al.                Standards Track                    [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   <a href="#section-7">7</a>. シリアライゼーション .......................................<a href="#page-19">19</a>
      <a href="#section-7.1">7.1</a>. JWS Compact Serialization .............................<a href="#page-19">19</a>
      <a href="#section-7.2">7.2</a>. JWS JSON Serialization ................................<a href="#page-19">19</a>
           <a href="#section-7.2.1">7.2.1</a>. 一般 JWS JSON Serialization 構文 ..............<a href="#page-20">20</a>
           <a href="#section-7.2.2">7.2.2</a>. フラット化 JWS JSON Serialization 構文 ........<a href="#page-21">21</a>
   <a href="#section-8">8</a>. TLS 要件 .....................................................<a href="#page-22">22</a>
   <a href="#section-9">9</a>. IANA に関する考慮事項 ........................................<a href="#page-22">22</a>
      9.1. JSON Web Signature および暗号化ヘッダ
           パラメータレジストリ ....................................<a href="#page-23">23</a>
           <a href="#section-9.1.1">9.1.1</a>. 登録テンプレート ..............................<a href="#page-23">23</a>
           <a href="#section-9.1.2">9.1.2</a>. 初期レジストリ内容 ............................<a href="#page-24">24</a>
      <a href="#section-9.2">9.2</a>. メディア型登録 .........................................<a href="#page-26">26</a>
           <a href="#section-9.2.1">9.2.1</a>. レジストリ内容 .................................<a href="#page-26">26</a>
   <a href="#section-10">10</a>. セキュリティに関する考慮事項 ...............................<a href="#page-27">27</a>
      <a href="#section-10.1">10.1</a>. 鍵エントロピーおよび乱数値 .........................<a href="#page-27">27</a>
      <a href="#section-10.2">10.2</a>. 鍵の保護 .............................................<a href="#page-28">28</a>
      <a href="#section-10.3">10.3</a>. 鍵の起源認証 .........................................<a href="#page-28">28</a>
      <a href="#section-10.4">10.4</a>. 暗号アルゴリズムのアジリティ .......................<a href="#page-28">28</a>
      <a href="#section-10.5">10.5</a>. デジタル署名と MAC の違い ..........................<a href="#page-28">28</a>
      <a href="#section-10.6">10.6</a>. アルゴリズム検証 .....................................<a href="#page-29">29</a>
      <a href="#section-10.7">10.7</a>. アルゴリズム保護 .....................................<a href="#page-29">29</a>
      <a href="#section-10.8">10.8</a>. 選択平文攻撃 .........................................<a href="#page-30">30</a>
      <a href="#section-10.9">10.9</a>. タイミング攻撃 .......................................<a href="#page-30">30</a>
      <a href="#section-10.10">10.10</a>. リプレイ保護 .........................................<a href="#page-30">30</a>
      <a href="#section-10.11">10.11</a>. SHA-1 証明書サムプリント ...........................<a href="#page-30">30</a>
      <a href="#section-10.12">10.12</a>. JSON セキュリティに関する考慮事項 ..................<a href="#page-31">31</a>
      <a href="#section-10.13">10.13</a>. Unicode 比較に関するセキュリティ考慮事項 ..........<a href="#page-31">31</a>
   <a href="#section-11">11</a>. 参照 .........................................................<a href="#page-32">32</a>
      <a href="#section-11.1">11.1</a>. 規範的参照 ...........................................<a href="#page-32">32</a>
      <a href="#section-11.2">11.2</a>. 参考参照 .............................................<a href="#page-34">34</a>
   <a href="#appendix-A">付録 A</a>.  JWS の例 .............................................<a href="#page-36">36</a>
     <a href="#appendix-A.1">A.1</a>.  HMAC SHA-256 を用いた JWS の例 ......................<a href="#page-36">36</a>
       <a href="#appendix-A.1.1">A.1.1</a>.  エンコード ........................................<a href="#page-36">36</a>
       <a href="#appendix-A.1.2">A.1.2</a>.  検証 ..............................................<a href="#page-38">38</a>
     <a href="#appendix-A.2">A.2</a>.  RSASSA-PKCS1-v1_5 SHA-256 を用いた JWS の例 .........<a href="#page-38">38</a>
       <a href="#appendix-A.2.1">A.2.1</a>.  エンコード ........................................<a href="#page-38">38</a>
       <a href="#appendix-A.2.2">A.2.2</a>.  検証 ..............................................<a href="#page-42">42</a>
     <a href="#appendix-A.3">A.3</a>.  ECDSA P-256 SHA-256 を用いた JWS の例 ...............<a href="#page-42">42</a>
       <a href="#appendix-A.3.1">A.3.1</a>.  エンコード ........................................<a href="#page-42">42</a>
       <a href="#appendix-A.3.2">A.3.2</a>.  検証 ..............................................<a href="#page-44">44</a>
     <a href="#appendix-A.4">A.4</a>.  ECDSA P-521 SHA-512 を用いた JWS の例 ...............<a href="#page-45">45</a>
       <a href="#appendix-A.4.1">A.4.1</a>.  エンコード ........................................<a href="#page-45">45</a>
       <a href="#appendix-A.4.2">A.4.2</a>.  検証 ..............................................<a href="#page-47">47</a>
     <a href="#appendix-A.5">A.5</a>.  署名なし JWS の例 ....................................<a href="#page-47">47</a>
     <a href="#appendix-A.6">A.6</a>.  一般 JWS JSON Serialization を用いた JWS の例 ......<a href="#page-48">48</a>
       <a href="#appendix-A.6.1">A.6.1</a>.  署名ごとの保護ヘッダ .............................<a href="#page-48">48</a>
       <a href="#appendix-A.6.2">A.6.2</a>.  署名ごとの非保護ヘッダ ...........................<a href="#page-49">49</a>
       <a href="#appendix-A.6.3">A.6.3</a>.  完全な JOSE ヘッダ値 ..............................<a href="#page-49">49</a>



<span class="grey">Jones, et al.                Standards Track                    [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


       <a href="#appendix-A.6.4">A.6.4</a>.  完全な JWS JSON Serialization 表現 ..............<a href="#page-50">50</a>
     <a href="#appendix-A.7">A.7</a>.  フラット化 JWS JSON Serialization を用いた JWS の例 ..<a href="#page-51">51</a>
   <a href="#appendix-B">付録 B</a>.  "x5c"（X.509 証明書チェーン）の例 .................<a href="#page-52">52</a>
   <a href="#appendix-C">付録 C</a>.  パディングなし base64url エンコード実装に関する注記 ..<a href="#page-54">54</a>
   <a href="#appendix-D">付録 D</a>.  鍵選択に関する注記 .................................<a href="#page-55">55</a>
   <a href="#appendix-E">付録 E</a>.  "crit" ヘッダパラメータの否定テストケース .........<a href="#page-57">57</a>
   <a href="#appendix-F">付録 F</a>.  分離コンテンツ .....................................<a href="#page-57">57</a>
   謝辞 ..........................................................<a href="#page-58">58</a>
   著者連絡先 ....................................................<a href="#page-58">58</a>

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  はじめに</span>

   JSON Web Signature（JWS）は、JSON ベースの
   [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>] データ構造を用いて、
   デジタル署名またはメッセージ認証コード（MAC）によって
   保護されたコンテンツを表現する。JWS の暗号メカニズムは、
   任意のオクテット列に対する完全性保護を提供する。
   デジタル署名と MAC の違いについては、
   <a href="#section-10.5">Section 10.5</a> を参照されたい。

   JWS には、密接に関連する 2 つのシリアライゼーションが定義されている。
   JWS Compact Serialization は、HTTP Authorization ヘッダや
   URI クエリパラメータなど、空間制約のある環境を想定した、
   コンパクトで URL セーフな表現である。
   JWS JSON Serialization は、JWS を JSON オブジェクトとして表現し、
   同一のコンテンツに対して複数の署名および／または MAC を
   適用できるようにする。両者は同一の暗号学的基盤を共有する。

   本仕様で使用される暗号アルゴリズムおよび識別子は、
   別途定義されている JSON Web Algorithms（JWA）
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>] 仕様および、
   その仕様で定義される IANA レジストリに記述されている。
   関連する暗号化機能については、別途定義されている
   JSON Web Encryption（JWE）
   [<a href="#ref-JWE" title="&quot;JSON Web Encryption (JWE)&quot;">JWE</a>] 仕様に記述されている。

   本仕様で定義される名前は、結果として得られる表現を
   コンパクトにすることが中核的な目標であるため、短く定義されている。

<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  表記規約</span>

   本文書中のキーワード "MUST"、"MUST NOT"、"REQUIRED"、
   "SHALL"、"SHALL NOT"、"SHOULD"、"SHOULD NOT"、
   "RECOMMENDED"、"NOT RECOMMENDED"、"MAY"、および
   "OPTIONAL" は、
   「RFC における要件レベルを示すためのキーワード」
   [<a href="./rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>]
   に記載されているとおりに解釈される。
   これらの解釈は、用語がすべて大文字で記載されている場合にのみ適用される。

   BASE64URL(OCTETS) は、
   <a href="#section-2">Section 2</a> に従った OCTETS の base64url エンコードを表す。



<span class="grey">Jones, et al.                Standards Track                    [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   UTF8(STRING) は、STRING（0 個以上の Unicode
   [<a href="#ref-UNICODE" title="&quot;The Unicode Standard&quot;">UNICODE</a>]
   文字からなる列）の UTF-8
   [<a href="./rfc3629" title="&quot;UTF-8, a transformation format of ISO 10646&quot;">RFC3629</a>]
   表現のオクテット列を表す。

   ASCII(STRING) は、STRING（0 個以上の ASCII 文字からなる列）の
   ASCII
   [<a href="./rfc20" title="&quot;ASCII format for Network Interchange&quot;">RFC20</a>]
   表現のオクテット列を表す。

   2 つの値 A と B の連結は、A || B と表記される。

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  用語</span>

   次の用語は本仕様で定義される。

   JSON Web Signature（JWS）
      デジタル署名または MAC されたメッセージを表すデータ構造。

   JOSE ヘッダ
      使用される暗号操作およびパラメータを記述する
      パラメータを含む JSON オブジェクト。
      JOSE（JSON Object Signing and Encryption）ヘッダは、
      ヘッダパラメータの集合から構成される。

   JWS ペイロード
      保護されるオクテット列、すなわちメッセージ。
      ペイロードは任意のオクテット列を含むことができる。

   JWS 署名
      JWS 保護ヘッダおよび JWS ペイロードに対する
      デジタル署名または MAC。

   ヘッダパラメータ
      JOSE ヘッダのメンバーである名前／値の組。

   JWS 保護ヘッダ
      JWS 署名のデジタル署名または MAC 操作によって
      完全性保護されるヘッダパラメータを含む JSON オブジェクト。
      JWS Compact Serialization では、これは JOSE ヘッダ全体を構成する。
      JWS JSON Serialization では、これは JOSE ヘッダの 1 構成要素である。

   JWS 非保護ヘッダ
      完全性保護されないヘッダパラメータを含む JSON オブジェクト。
      これは JWS JSON Serialization を使用する場合にのみ存在できる。







<span class="grey">Jones, et al.                Standards Track                    [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Base64url エンコード
      <a href="./rfc4648#section-5">RFC 4648 の Section&nbsp;5</a>
      [<a href="./rfc4648" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">RFC4648</a>]
      で定義されている URL およびファイル名セーフな文字セットを使用した
      Base64 エンコードであり、末尾のすべての '=' 文字を
      （<a href="#section-3.2">Section 3.2</a> で許可されているとおり）
      省略し、改行、空白、その他の追加文字を一切含めない。
      空のオクテット列の base64url エンコード結果は空文字列であることに注意されたい。
      （パディングなしの base64url エンコード実装に関する注記については
      <a href="#appendix-C">付録 C</a> を参照。）

   JWS 署名入力
      デジタル署名または MAC 計算への入力。
      その値は
      ASCII(BASE64URL(UTF8(JWS 保護ヘッダ)) || '.' ||
      BASE64URL(JWS ペイロード))
      である。

   JWS Compact Serialization
      JWS をコンパクトで URL セーフな文字列として表現したもの。

   JWS JSON Serialization
      JWS を JSON オブジェクトとして表現したもの。
      JWS Compact Serialization とは異なり、JWS JSON Serialization では
      同一のコンテンツに対して複数のデジタル署名および／または MAC を
      適用できる。
      この表現は、コンパクトさや URL セーフ性に最適化されていない。

   非保護 JWS（Unsecured JWS）
      完全性保護を提供しない JWS。
      非保護 JWS では "alg" の値として "none" を使用する。

   衝突耐性名（Collision-Resistant Name）
      他の名前と衝突する可能性が極めて低くなるような方法で
      名前を割り当てることが可能な名前空間内の名前。
      衝突耐性を持つ名前空間の例には、ドメイン名、
      ITU-T 勧告 X.660 および X.670 シリーズで定義される
      オブジェクト識別子（OID）、
      およびユニバーサル一意識別子（UUID）
      [<a href="./rfc4122" title="&quot;A Universally Unique IDentifier (UUID) URN Namespace&quot;">RFC4122</a>]
      が含まれる。
      管理的に委任された名前空間を使用する場合、名前の定義者は、
      自身がその名前を定義するために使用する名前空間の部分を
      管理していることを確保するため、合理的な予防措置を講じる必要がある。

   StringOrURI
      JSON の文字列値であり、追加要件として、
      任意の文字列値を使用してもよいが、
      ":" 文字を含む値は URI
      [<a href="./rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>]
      でなければならない。
      StringOrURI の値は、大文字・小文字を区別する文字列として比較され、
      いかなる変換や正規化も適用されない。






<span class="grey">Jones, et al.                Standards Track                    [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   「JSON Web Encryption（JWE）」、「JWE Compact Serialization」、
   および「JWE JSON Serialization」という用語は、JWE 仕様
   [<a href="#ref-JWE" title="&quot;JSON Web Encryption (JWE)&quot;">JWE</a>] によって定義されている。

   「デジタル署名（Digital Signature）」および
   「メッセージ認証コード（Message Authentication Code, MAC）」という用語は、
   「Internet Security Glossary, Version 2」
   [<a href="./rfc4949" title="&quot;Internet Security Glossary, Version 2&quot;">RFC4949</a>] によって定義されている。

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  JSON Web Signature（JWS）概要</span>

   JWS は、JSON データ構造および base64url エンコードを用いて、
   デジタル署名または MAC が付与されたコンテンツを表現する。
   これらの JSON データ構造は、
   <a href="./rfc7159#section-2">RFC 7159 の Section&nbsp;2</a>
   [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>]
   に従い、任意の JSON 値または構造文字の前後に、
   空白および／または改行を含んでもよい。
   JWS は、次の論理値（それぞれ <a href="#section-2">Section 2</a> で定義されている）
   を表現する。

   o  JOSE ヘッダ
   o  JWS ペイロード
   o  JWS 署名

   JWS において、JOSE ヘッダのメンバは、
   次の値のメンバの和集合である
   （それぞれ <a href="#section-2">Section 2</a> で定義されている）。

   o  JWS 保護ヘッダ
   o  JWS 非保護ヘッダ

   本文書は、JWS のために 2 種類のシリアライゼーションを定義する。
   1 つは、JWS Compact Serialization と呼ばれる
   コンパクトで URL セーフなシリアライゼーションであり、
   もう 1 つは、JWS JSON Serialization と呼ばれる
   JSON シリアライゼーションである。
   いずれのシリアライゼーションにおいても、
   JWS 保護ヘッダ、JWS ペイロード、および JWS 署名は、
   JSON には任意のオクテット列を直接表現する方法がないため、
   base64url エンコードされる。

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  JWS Compact Serialization の概要</span>

   JWS Compact Serialization では、JWS 非保護ヘッダは使用されない。
   この場合、JOSE ヘッダと JWS 保護ヘッダは同一である。

   JWS Compact Serialization において、JWS は次の連結として表現される。

      BASE64URL(UTF8(JWS 保護ヘッダ)) || '.' ||
      BASE64URL(JWS ペイロード) || '.' ||
      BASE64URL(JWS 署名)

   JWS Compact Serialization に関する詳細は、
   <a href="#section-7.1">Section 7.1</a> を参照されたい。



<span class="grey">Jones, et al.                Standards Track                    [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  JWS JSON Serialization の概要</span>

   JWS JSON Serialization では、JWS 保護ヘッダおよび
   JWS 非保護ヘッダの一方または両方が存在しなければならない。
   この場合、JOSE ヘッダのメンバは、
   存在する JWS 保護ヘッダおよび JWS 非保護ヘッダの
   メンバの和集合となる。

   JWS JSON Serialization において、JWS は、
   次の 4 つのメンバの一部または全部を含む
   JSON オブジェクトとして表現される。

   o  "protected"：値は BASE64URL(UTF8(JWS 保護ヘッダ))
   o  "header"：値は JWS 非保護ヘッダ
   o  "payload"：値は BASE64URL(JWS ペイロード)
   o  "signature"：値は BASE64URL(JWS 署名)

   base64url エンコードされた 3 つの結果文字列と
   JWS 非保護ヘッダの値は、JSON オブジェクト内のメンバとして表現される。
   これらの値の一部の包含は OPTIONAL である。
   JWS JSON Serialization は、1 つだけでなく、
   複数の署名および／または MAC 値を表現することもできる。
   JWS JSON Serialization に関する詳細は、
   <a href="#section-7.2">Section 7.2</a> を参照されたい。

<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>.  JWS の例</span>

   本節では、JWS の例を示す。
   その計算方法は、
   使用される JSON 値を表す正確なオクテット列および
   使用される鍵の値を含め、
   <a href="#appendix-A.1">Appendix A.1</a> でより詳細に説明されている。

   次の例の JWS 保護ヘッダは、
   エンコードされたオブジェクトが
   JSON Web Token
   [<a href="#ref-JWT" title="&quot;JSON Web Token (JWT)&quot;">JWT</a>]
   であること、
   および JWS 保護ヘッダと JWS ペイロードが
   HMAC SHA-256
   [<a href="./rfc2104" title="&quot;HMAC: Keyed-Hashing for Message Authentication&quot;">RFC2104</a>]
   [<a href="#ref-SHS" title="&quot;Secure Hash Standard (SHS)&quot;">SHS</a>]
   アルゴリズムを用いて保護されていることを宣言している。

     {"typ":"JWT",
      "alg":"HS256"}

   この JWS 保護ヘッダを
   BASE64URL(UTF8(JWS 保護ヘッダ))
   としてエンコードすると、次の値が得られる。

     eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9

   次の JSON オブジェクトの UTF-8 表現が
   JWS ペイロードとして使用される。
   （ペイロードは任意のコンテンツでよく、
   JSON オブジェクトの表現である必要はない点に注意されたい。）





<span class="grey">Jones, et al.                Standards Track                    [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


     {"iss":"joe",
      "exp":1300819380,
      "http://example.com/is_root":true}

   この JWS ペイロードを
   BASE64URL(JWS ペイロード)
   としてエンコードすると、次の値が得られる
   （表示目的のためにのみ改行を含めている）。

     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   <a href="#appendix-A.1">Appendix A.1</a> で指定されている鍵を用い、
   HMAC SHA-256 アルゴリズムによって
   JWS 署名入力
   ASCII(BASE64URL(UTF8(JWS 保護ヘッダ)) || '.' || BASE64URL(JWS ペイロード))
   の HMAC を計算し、
   その結果を base64url エンコードすると、
   次の BASE64URL(JWS 署名) の値が得られる。

     dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk

   これらの値を、
   Header.Payload.Signature の順に、
   各部分の間をピリオド（'.'）文字で区切って連結すると、
   次の JWS Compact Serialization による
   完全な JWS 表現が得られる
   （表示目的のためにのみ改行を含めている）。

     eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
     .
     dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk

   Sections A.6 および A.7 における
   JWS JSON Serialization を用いた例を含む、
   追加の例については <a href="#appendix-A">Appendix A</a> を参照されたい。

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  JOSE ヘッダ</span>

   JWS において、JOSE ヘッダを表す JSON オブジェクトのメンバは、
   JWS 保護ヘッダおよび JWS ペイロードに適用される
   デジタル署名または MAC を記述し、
   さらに JWS の追加プロパティを任意で記述する。
   JOSE ヘッダ内のヘッダパラメータ名は一意でなければならない。
   JWS パーサは、
   重複するヘッダパラメータ名を含む JWS を拒否するか、
   ECMAScript 5.1
   [<a href="#ref-ECMAScript" title="&quot;ECMAScript Language Specification, 5.1 Edition&quot;">ECMAScript</a>]
   の <a href="#section-15.12">Section 15.12</a>
   （「JSON オブジェクト」）で規定されているとおり、
   字句的に最後の重複メンバ名のみを返す
   JSON パーサを使用しなければならない。

   実装は、
   本仕様で定義され、「理解されなければならない（MUST be understood）」
   と指定されている特定のヘッダパラメータを理解し、
   本仕様で定義された方法でそれらを処理することが要求される。
   本仕様で定義されているその他すべてのヘッダパラメータは、



<span class="grey">Jones, et al.                Standards Track                    [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   そのように指定されていない場合、
   理解されないときは無視されなければならない。
   <a href="#section-4.1.11">Section 4.1.11</a> に従い、
   クリティカルなヘッダパラメータとして列挙されていない限り、
   本仕様で定義されていないすべてのヘッダパラメータは、
   理解されないときは無視されなければならない。

   ヘッダパラメータ名には、
   登録済みヘッダパラメータ名、
   公開ヘッダパラメータ名、
   および非公開ヘッダパラメータ名の
   3 つのクラスがある。

<span class="h3"><a class="selflink" id="section-4.1" href="#section-4.1">4.1</a>.  登録済みヘッダパラメータ名</span>

   JWS で使用する次のヘッダパラメータ名は、
   <a href="#section-9.1">Section 9.1</a> によって確立された
   IANA「JSON Web Signature and Encryption Header Parameters」
   レジストリに登録されており、
   その意味は以下の各小節で定義されている。

   共通レジストリが示すとおり、
   JWS と JWE は共通のヘッダパラメータ空間を共有する。
   あるパラメータが両方の仕様で使用される場合、
   その使用方法は仕様間で互換性がなければならない。

<span class="h4"><a class="selflink" id="section-4.1.1" href="#section-4.1.1">4.1.1</a>.  "alg"（アルゴリズム）ヘッダパラメータ</span>

   "alg"（algorithm）ヘッダパラメータは、
   JWS を保護するために使用される暗号アルゴリズムを識別する。
   "alg" の値がサポートされていないアルゴリズムを表している場合、
   またはそのアルゴリズムで使用する鍵が、
   コンテンツにデジタル署名または MAC を施した主体に関連付けられていない場合、
   JWS 署名値は有効ではない。
   "alg" の値は、
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   によって確立された
   IANA「JSON Web Signature and Encryption Algorithms」
   レジストリに登録されるか、
   または衝突耐性名を含む値であるべきである。
   "alg" の値は、
   StringOrURI 値を含む、
   大文字・小文字を区別する ASCII 文字列である。
   このヘッダパラメータは MUST で存在しなければならず、
   実装によって理解され、処理されなければならない。

   この用途のために定義されている "alg" の値の一覧は、
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   によって確立された
   IANA「JSON Web Signature and Encryption Algorithms」
   レジストリに記載されている。
   このレジストリの初期内容は、
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   の Section 3.1 で定義されている値である。

<span class="h4"><a class="selflink" id="section-4.1.2" href="#section-4.1.2">4.1.2</a>.  "jku"（JWK Set URL）ヘッダパラメータ</span>

   "jku"（JWK Set URL）ヘッダパラメータは、
   JWS にデジタル署名を行うために使用された鍵に対応する
   JSON エンコードされた公開鍵集合を指すリソースを参照する
   URI
   [<a href="./rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>]
   である。
   鍵は JWK Set
   [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>]
   としてエンコードされなければならない。
   このリソースを取得するために使用されるプロトコルは、
   完全性保護を提供しなければならない。
   JWK Set を取得するための HTTP GET リクエストは、
   トランスポート層セキュリティを使用しなければならない。




<span class="grey">Jones, et al.                Standards Track                   [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   (TLS) [<a href="./rfc2818" title="&quot;HTTP Over TLS&quot;">RFC2818</a>] [<a href="./rfc5246" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>]；また、サーバの同一性は
   <a href="./rfc6125#section-6">RFC 6125 の Section&nbsp;6</a>
   [<a href="./rfc6125" title="&quot;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)&quot;">RFC6125</a>]
   に従って検証されなければならない。
   さらに、TLS 要件については <a href="#section-8">Section 8</a> も参照されたい。
   このヘッダパラメータの使用は OPTIONAL である。

<span class="h4"><a class="selflink" id="section-4.1.3" href="#section-4.1.3">4.1.3</a>.  "jwk"（JSON Web Key）ヘッダパラメータ</span>

   "jwk"（JSON Web Key）ヘッダパラメータは、
   JWS にデジタル署名を行うために使用された鍵に対応する公開鍵である。
   この鍵は JSON Web Key
   [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>]
   として表現される。
   このヘッダパラメータの使用は OPTIONAL である。

<span class="h4"><a class="selflink" id="section-4.1.4" href="#section-4.1.4">4.1.4</a>.  "kid"（Key ID）ヘッダパラメータ</span>

   "kid"（key ID）ヘッダパラメータは、
   JWS を保護するためにどの鍵が使用されたかを示すヒントである。
   このパラメータにより、発信者は受信者に対して
   鍵の変更を明示的に通知することができる。
   "kid" 値の構造は規定されていない。
   その値は大文字・小文字を区別する文字列でなければならない。
   このヘッダパラメータの使用は OPTIONAL である。

   JWK とともに使用される場合、
   "kid" の値は JWK の "kid" パラメータ値と照合するために使用される。

<span class="h4"><a class="selflink" id="section-4.1.5" href="#section-4.1.5">4.1.5</a>.  "x5u"（X.509 URL）ヘッダパラメータ</span>

   "x5u"（X.509 URL）ヘッダパラメータは、
   JWS にデジタル署名を行うために使用された鍵に対応する
   X.509 公開鍵証明書または証明書チェーン
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
   のためのリソースを参照する URI
   [<a href="./rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>]
   である。
   指定されたリソースは、
   <a href="./rfc5280">RFC 5280</a>
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
   に適合する PEM エンコード形式の証明書または証明書チェーンの表現を
   提供しなければならない。
   各証明書は、
   <a href="./rfc4945#section-6.1">RFC 4945 の Section&nbsp;6.1</a>
   [<a href="./rfc4945" title="&quot;The Internet IP Security PKI Profile of IKEv1/ISAKMP, IKEv2, and PKIX&quot;">RFC4945</a>]
   で規定されているとおり区切られなければならない。
   JWS にデジタル署名を行うために使用された鍵に対応する公開鍵を含む証明書は、
   最初の証明書でなければならない。
   その後に追加の証明書が続いてもよく、
   各後続の証明書は直前の証明書を認証するために使用されたものである。
   リソースを取得するために使用されるプロトコルは、
   完全性保護を提供しなければならない。
   証明書を取得するための HTTP GET リクエストは、
   TLS
   [<a href="./rfc2818" title="&quot;HTTP Over TLS&quot;">RFC2818</a>]
   [<a href="./rfc5246" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>]
   を使用しなければならない。
   また、サーバの同一性は
   <a href="./rfc6125#section-6">RFC 6125 の Section&nbsp;6</a>
   [<a href="./rfc6125" title="&quot;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)&quot;">RFC6125</a>]
   に従って検証されなければならない。
   さらに、TLS 要件については <a href="#section-8">Section 8</a> も参照されたい。
   このヘッダパラメータの使用は OPTIONAL である。

<span class="h4"><a class="selflink" id="section-4.1.6" href="#section-4.1.6">4.1.6</a>.  "x5c"（X.509 証明書チェーン）ヘッダパラメータ</span>

   "x5c"（X.509 証明書チェーン）ヘッダパラメータは、
   JWS にデジタル署名を行うために使用された鍵に対応する
   X.509 公開鍵証明書または証明書チェーン
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
   を含む。
   証明書または証明書チェーンは、
   証明書値文字列の JSON 配列として表現される。



<span class="grey">Jones, et al.                Standards Track                   [Page 11]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-12" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   配列内の各文字列は、
   base64 エンコード
   （<a href="./rfc4648#section-4">[RFC4648] の Section&nbsp;4</a> ― base64url エンコードではない）
   された DER
   [<a href="#ref-ITU.X690.2008">ITU.X690.2008</a>]
   PKIX 証明書値である。
   JWS にデジタル署名を行うために使用された鍵に対応する公開鍵を含む証明書は、
   最初の証明書でなければならない。
   その後に追加の証明書が続いてもよく、
   各後続の証明書は直前の証明書を認証するために使用されたものである。
   受信者は、
   <a href="./rfc5280">RFC 5280</a>
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
   に従って証明書チェーンを検証し、
   いずれかの検証失敗が発生した場合には、
   その証明書または証明書チェーンを無効と見なさなければならない。
   このヘッダパラメータの使用は OPTIONAL である。

   "x5c" 値の例については <a href="#appendix-B">Appendix B</a> を参照されたい。

<span class="h4"><a class="selflink" id="section-4.1.7" href="#section-4.1.7">4.1.7</a>.  "x5t"（X.509 証明書 SHA-1 サムプリント）ヘッダパラメータ</span>

   "x5t"（X.509 証明書 SHA-1 サムプリント）ヘッダパラメータは、
   JWS にデジタル署名を行うために使用された鍵に対応する
   X.509 証明書
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
   の DER エンコードに対する
   SHA-1 サムプリント（別名ダイジェスト）を
   base64url エンコードしたものである。
   証明書サムプリントは、
   証明書フィンガープリントと呼ばれることもある。
   このヘッダパラメータの使用は OPTIONAL である。

<span class="h4"><a class="selflink" id="section-4.1.8" href="#section-4.1.8">4.1.8</a>.  "x5t#S256"（X.509 証明書 SHA-256 サムプリント）ヘッダ</span>
<span class="h4">        パラメータ</span>

   "x5t#S256"（X.509 証明書 SHA-256 サムプリント）ヘッダパラメータは、
   JWS にデジタル署名を行うために使用された鍵に対応する
   X.509 証明書
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
   の DER エンコードに対する
   SHA-256 サムプリント（別名ダイジェスト）を
   base64url エンコードしたものである。
   証明書サムプリントは、
   証明書フィンガープリントと呼ばれることもある。
   このヘッダパラメータの使用は OPTIONAL である。

<span class="h4"><a class="selflink" id="section-4.1.9" href="#section-4.1.9">4.1.9</a>.  "typ"（Type）ヘッダパラメータ</span>

   "typ"（type）ヘッダパラメータは、
   この完全な JWS のメディア型
   [<a href="#ref-IANA.MediaTypes">IANA.MediaTypes</a>]
   を宣言するために JWS アプリケーションによって使用される。
   これは、JWS を含むことができるアプリケーションデータ構造内に
   複数種類のオブジェクトが存在し得る場合に、
   それらを区別するためにアプリケーションが使用することを意図している。
   通常、オブジェクトの種類がすでに分かっている場合には、
   アプリケーションによって使用されることはない。
   このパラメータは JWS 実装によっては無視される。
   このパラメータの処理は、
   JWS アプリケーションによって実行される。
   このヘッダパラメータの使用は OPTIONAL である。

   <a href="./rfc2045">RFC 2045</a>
   [<a href="./rfc2045" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies&quot;">RFC2045</a>]
   に従い、すべてのメディア型値、サブタイプ値、および
   パラメータ名は大文字・小文字を区別しない。
   ただし、特定のパラメータについて別途指定されていない限り、
   パラメータ値は大文字・小文字を区別する。



<span class="grey">Jones, et al.                Standards Track                   [Page 12]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-13" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   一般的な状況においてメッセージをコンパクトに保つため、
   メディア型値に他の '/' が含まれていない場合には、
   "typ" ヘッダパラメータにおいて
   メディア型値の "application/" 接頭辞を省略することが
   RECOMMENDED である。
   メディア型値を使用する受信者は、
   '/' を含まない任意の "typ" 値について、
   あたかも "application/" が前置されているかのように
   扱わなければならない。
   たとえば、
   "example" という "typ" 値は
   "application/example" メディア型を表すために使用されるべきである一方、
   メディア型
   "application/example;part=&quot;1/2&quot;"
   は
   "example;part=&quot;1/2&quot;"
   に短縮することはできない。

   "typ" 値 "JOSE" は、
   このオブジェクトが
   JWS Compact Serialization または
   JWE Compact Serialization を使用する
   JWS または JWE であることを示すために、
   アプリケーションによって使用することができる。
   "typ" 値 "JOSE+JSON" は、
   このオブジェクトが
   JWS JSON Serialization または
   JWE JSON Serialization を使用する
   JWS または JWE であることを示すために、
   アプリケーションによって使用することができる。
   その他の型値も、
   アプリケーションによって使用することができる。

<span class="h4"><a class="selflink" id="section-4.1.10" href="#section-4.1.10">4.1.10</a>.  "cty"（Content Type）ヘッダパラメータ</span>

   "cty"（content type）ヘッダパラメータは、
   保護されたコンテンツ（ペイロード）のメディア型
   [<a href="#ref-IANA.MediaTypes">IANA.MediaTypes</a>]
   を宣言するために JWS アプリケーションによって使用される。
   これは、JWS ペイロード内に
   複数種類のオブジェクトが存在し得る場合に、
   それらを区別するためにアプリケーションが使用することを意図している。
   通常、オブジェクトの種類がすでに分かっている場合には、
   アプリケーションによって使用されることはない。
   このパラメータは JWS 実装によっては無視される。
   このパラメータの処理は、
   JWS アプリケーションによって実行される。
   このヘッダパラメータの使用は OPTIONAL である。

   <a href="./rfc2045">RFC 2045</a>
   [<a href="./rfc2045" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies&quot;">RFC2045</a>]
   に従い、すべてのメディア型値、サブタイプ値、および
   パラメータ名は大文字・小文字を区別しない。
   ただし、特定のパラメータについて別途指定されていない限り、
   パラメータ値は大文字・小文字を区別する。

   一般的な状況においてメッセージをコンパクトに保つため、
   メディア型値に他の '/' が含まれていない場合には、
   "cty" ヘッダパラメータにおいて
   メディア型値の "application/" 接頭辞を省略することが
   RECOMMENDED である。
   メディア型値を使用する受信者は、
   '/' を含まない任意の "cty" 値について、
   あたかも "application/" が前置されているかのように
   扱わなければならない。
   たとえば、
   "example" という "cty" 値は
   "application/example" メディア型を表すために使用されるべきである一方、
   メディア型
   "application/example;part=&quot;1/2&quot;"
   は
   "example;part=&quot;1/2&quot;"
   に短縮することはできない。








<span class="grey">Jones, et al.                Standards Track                   [Page 13]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-14" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h4"><a class="selflink" id="section-4.1.11" href="#section-4.1.11">4.1.11</a>.  "crit"（Critical）ヘッダパラメータ</span>

   "crit"（critical）ヘッダパラメータは、
   本仕様および／または
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   に対する拡張が使用されており、
   それらが理解され、処理されなければならないことを示す。
   その値は、
   それらの拡張を使用する
   JOSE ヘッダ内に存在するヘッダパラメータ名を列挙した配列である。
   列挙された拡張ヘッダパラメータのいずれかが
   受信者によって理解またはサポートされていない場合、
   JWS は無効である。
   生成者は、
   本仕様または
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   によって JWS 用に定義されているヘッダパラメータ名、
   重複する名前、
   または JOSE ヘッダ内のヘッダパラメータ名として
   出現しない名前を
   "crit" リストに含めてはならない。
   生成者は、
   "crit" の値として空のリスト "[]" を使用してはならない。
   受信者は、
   クリティカルリストに
   本仕様または
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   によって JWS 用に定義されているヘッダパラメータ名が含まれている場合、
   またはその使用に関するその他の制約に違反している場合には、
   JWS を無効と見なしてもよい。
   使用される場合、このヘッダパラメータは完全性保護されなければならない。
   したがって、JWS 保護ヘッダ内にのみ出現しなければならない。
   このヘッダパラメータの使用は OPTIONAL である。
   このヘッダパラメータは、
   実装によって理解され、処理されなければならない。

   仮想的な "exp"（有効期限）フィールドとともに使用する例は次のとおりである。

     {"alg":"ES256",
      "crit":["exp"],
      "exp":1363284000
     }

<span class="h3"><a class="selflink" id="section-4.2" href="#section-4.2">4.2</a>.  公開ヘッダパラメータ名</span>

   追加のヘッダパラメータ名は、
   JWS を使用する者によって定義することができる。
   ただし、衝突を防ぐため、
   新しいヘッダパラメータ名は、
   <a href="#section-9.1">Section 9.1</a> によって確立された
   IANA「JSON Web Signature and Encryption Header Parameters」
   レジストリに登録されるか、
   公開名（衝突耐性名を含む値）であるべきである。
   いずれの場合においても、
   名前または値を定義する者は、
   ヘッダパラメータ名を定義するために使用する
   名前空間の部分を自らが管理していることを確実にするため、
   合理的な予防措置を講じる必要がある。

   新しいヘッダパラメータは、
   相互運用性のない JWS を生じさせる可能性があるため、
   慎重に導入されるべきである。

<span class="h3"><a class="selflink" id="section-4.3" href="#section-4.3">4.3</a>.  非公開ヘッダパラメータ名</span>

   JWS の生成者と消費者は、
   非公開名
   （登録済みヘッダパラメータ名ではない名前
   （<a href="#section-4.1">Section 4.1</a>））
   または公開ヘッダパラメータ名



<span class="grey">Jones, et al.                Standards Track                   [Page 14]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-15" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   （<a href="#section-4.2">Section 4.2</a>）である
   ヘッダパラメータ名を使用することに合意することができる。
   公開ヘッダパラメータ名とは異なり、
   非公開ヘッダパラメータ名は衝突の可能性があり、
   注意して使用されるべきである。

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  JWS の生成および消費</span>

<span class="h3"><a class="selflink" id="section-5.1" href="#section-5.1">5.1</a>.  メッセージ署名または MAC の計算</span>

   JWS を作成するには、次の手順を実行する。
   手順の順序は、
   手順の入力と出力の間に依存関係が存在しない場合には重要ではない。

   1.  JWS ペイロードとして使用するコンテンツを作成する。

   2.  エンコードされたペイロード値
       BASE64URL(JWS ペイロード)
       を計算する。

   3.  所望のヘッダパラメータ集合を含む
       JSON オブジェクトを作成し、
       それらを合わせて JOSE ヘッダ
       （JWS 保護ヘッダおよび／または JWS 非保護ヘッダ）
       を構成する。

   4.  エンコードされたヘッダ値
       BASE64URL(UTF8(JWS 保護ヘッダ))
       を計算する。
       JWS 保護ヘッダが存在しない場合
       （これは、JWS JSON Serialization を使用し、
       "protected" メンバが存在しない場合にのみ発生し得る）、
       この値は空文字列とする。

   5.  使用されている特定のアルゴリズムに対して定義されている方法で、
       JWS 署名入力
       ASCII(BASE64URL(UTF8(JWS 保護ヘッダ)) || '.' ||
       BASE64URL(JWS ペイロード))
       に対する JWS 署名を計算する。
       "alg"（algorithm）ヘッダパラメータは、
       JOSE ヘッダ内に必ず存在しなければならず、
       そのアルゴリズム値は、
       JWS 署名を構成するために使用されたアルゴリズムを
       正確に表していなければならない。

   6.  エンコードされた署名値
       BASE64URL(JWS 署名)
       を計算する。

   7.  JWS JSON Serialization が使用されている場合、
       実行される各デジタル署名または MAC 操作ごとに、
       この処理（手順 3〜6）を繰り返す。

   8.  所望のシリアライズされた出力を作成する。
       この結果の JWS Compact Serialization は、
       BASE64URL(UTF8(JWS 保護ヘッダ)) || '.' ||
       BASE64URL(JWS ペイロード) || '.' ||
       BASE64URL(JWS 署名)
       である。
       JWS JSON Serialization については、
       <a href="#section-7.2">Section 7.2</a> で説明されている。







<span class="grey">Jones, et al.                Standards Track                   [Page 15]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-16" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h3"><a class="selflink" id="section-5.2" href="#section-5.2">5.2</a>.  Message Signature or MAC Validation</span>

   When validating a JWS, the following steps are performed.  The order
   of the steps is not significant in cases where there are no
   dependencies between the inputs and outputs of the steps.  If any of
   the listed steps fails, then the signature or MAC cannot be
   validated.

   When there are multiple JWS Signature values, it is an application
   decision which of the JWS Signature values must successfully validate
   for the JWS to be accepted.  In some cases, all must successfully
   validate, or the JWS will be considered invalid.  In other cases,
   only a specific JWS Signature value needs to be successfully
   validated.  However, in all cases, at least one JWS Signature value
   MUST successfully validate, or the JWS MUST be considered invalid.

   1.  Parse the JWS representation to extract the serialized values for
       the components of the JWS.  When using the JWS Compact
       Serialization, these components are the base64url-encoded
       representations of the JWS Protected Header, the JWS Payload, and
       the JWS Signature, and when using the JWS JSON Serialization,
       these components also include the unencoded JWS Unprotected
       Header value.  When using the JWS Compact Serialization, the JWS
       Protected Header, the JWS Payload, and the JWS Signature are
       represented as base64url-encoded values in that order, with each
       value being separated from the next by a single period ('.')
       character, resulting in exactly two delimiting period characters
       being used.  The JWS JSON Serialization is described in
       <a href="#section-7.2">Section 7.2</a>.

   2.  Base64url-decode the encoded representation of the JWS Protected
       Header, following the restriction that no line breaks,
       whitespace, or other additional characters have been used.

   3.  Verify that the resulting octet sequence is a UTF-8-encoded
       representation of a completely valid JSON object conforming to
       <a href="./rfc7159">RFC 7159</a> [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>]; let the JWS Protected Header be this JSON
       object.

   4.  If using the JWS Compact Serialization, let the JOSE Header be
       the JWS Protected Header.  Otherwise, when using the JWS JSON
       Serialization, let the JOSE Header be the union of the members of
       the corresponding JWS Protected Header and JWS Unprotected
       Header, all of which must be completely valid JSON objects.
       During this step, verify that the resulting JOSE Header does not
       contain duplicate Header Parameter names.  When using the JWS





<span class="grey">Jones, et al.                Standards Track                   [Page 16]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-17" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


       JSON Serialization, this restriction includes that the same
       Header Parameter name also MUST NOT occur in distinct JSON object
       values that together comprise the JOSE Header.

   5.  Verify that the implementation understands and can process all
       fields that it is required to support, whether required by this
       specification, by the algorithm being used, or by the "crit"
       Header Parameter value, and that the values of those parameters
       are also understood and supported.

   6.  Base64url-decode the encoded representation of the JWS Payload,
       following the restriction that no line breaks, whitespace, or
       other additional characters have been used.

   7.  Base64url-decode the encoded representation of the JWS Signature,
       following the restriction that no line breaks, whitespace, or
       other additional characters have been used.

   8.  Validate the JWS Signature against the JWS Signing Input
       ASCII(BASE64URL(UTF8(JWS Protected Header)) || '.' ||
       BASE64URL(JWS Payload)) in the manner defined for the algorithm
       being used, which MUST be accurately represented by the value of
       the "alg" (algorithm) Header Parameter, which MUST be present.
       See <a href="#section-10.6">Section 10.6</a> for security considerations on algorithm
       validation.  Record whether the validation succeeded or not.

   9.  If the JWS JSON Serialization is being used, repeat this process
       (steps 4-8) for each digital signature or MAC value contained in
       the representation.

   10. If none of the validations in step 9 succeeded, then the JWS MUST
       be considered invalid.  Otherwise, in the JWS JSON Serialization
       case, return a result to the application indicating which of the
       validations succeeded and failed.  In the JWS Compact
       Serialization case, the result can simply indicate whether or not
       the JWS was successfully validated.

   Finally, note that it is an application decision which algorithms may
   be used in a given context.  Even if a JWS can be successfully
   validated, unless the algorithm(s) used in the JWS are acceptable to
   the application, it SHOULD consider the JWS to be invalid.

<span class="h3"><a class="selflink" id="section-5.3" href="#section-5.3">5.3</a>.  String Comparison Rules</span>

   Processing a JWS inevitably requires comparing known strings to
   members and values in JSON objects.  For example, in checking what
   the algorithm is, the Unicode string "alg" will be checked against
   the member names in the JOSE Header to see if there is a matching



<span class="grey">Jones, et al.                Standards Track                   [Page 17]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-18" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Header Parameter name.  The same process is then used to determine if
   the value of the "alg" Header Parameter represents a supported
   algorithm.

   The JSON rules for doing member name comparison are described in
   <a href="./rfc7159#section-8.3">Section&nbsp;8.3 of RFC 7159</a> [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>].  Since the only string comparison
   operations that are performed are equality and inequality, the same
   rules can be used for comparing both member names and member values
   against known strings.

   These comparison rules MUST be used for all JSON string comparisons
   except in cases where the definition of the member explicitly calls
   out that a different comparison rule is to be used for that member
   value.  Only the "typ" and "cty" member values defined in this
   specification do not use these comparison rules.

   Some applications may include case-insensitive information in a case-
   sensitive value, such as including a DNS name as part of a "kid" (key
   ID) value.  In those cases, the application may need to define a
   convention for the canonical case to use for representing the case-
   insensitive portions, such as lowercasing them, if more than one
   party might need to produce the same value so that they can be
   compared.  (However, if all other parties consume whatever value the
   producing party emitted verbatim without attempting to compare it to
   an independently produced value, then the case used by the producer
   will not matter.)

   Also, see the JSON security considerations in <a href="#section-10.12">Section 10.12</a> and the
   Unicode security considerations in <a href="#section-10.13">Section 10.13</a>.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Key Identification</span>

   It is necessary for the recipient of a JWS to be able to determine
   the key that was employed for the digital signature or MAC operation.
   The key employed can be identified using the Header Parameter methods
   described in <a href="#section-4.1">Section 4.1</a> or can be identified using methods that are
   outside the scope of this specification.  Specifically, the Header
   Parameters "jku", "jwk", "kid", "x5u", "x5c", "x5t", and "x5t#S256"
   can be used to identify the key used.  These Header Parameters MUST
   be integrity protected if the information that they convey is to be
   utilized in a trust decision; however, if the only information used
   in the trust decision is a key, these parameters need not be
   integrity protected, since changing them in a way that causes a
   different key to be used will cause the validation to fail.

   The producer SHOULD include sufficient information in the Header
   Parameters to identify the key used, unless the application uses
   another means or convention to determine the key used.  Validation of



<span class="grey">Jones, et al.                Standards Track                   [Page 18]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-19" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   the signature or MAC fails when the algorithm used requires a key
   (which is true of all algorithms except for "none") and the key used
   cannot be determined.

   The means of exchanging any shared symmetric keys used is outside the
   scope of this specification.

   Also, see <a href="#appendix-D">Appendix D</a> for notes on possible key selection algorithms.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  Serializations</span>

   JWSs use one of two serializations: the JWS Compact Serialization or
   the JWS JSON Serialization.  Applications using this specification
   need to specify what serialization and serialization features are
   used for that application.  For instance, applications might specify
   that only the JWS JSON Serialization is used, that only JWS JSON
   Serialization support for a single signature or MAC value is used, or
   that support for multiple signatures and/or MAC values is used.  JWS
   implementations only need to implement the features needed for the
   applications they are designed to support.

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>.  JWS Compact Serialization</span>

   The JWS Compact Serialization represents digitally signed or MACed
   content as a compact, URL-safe string.  This string is:

      BASE64URL(UTF8(JWS Protected Header)) || '.' ||
      BASE64URL(JWS Payload) || '.' ||
      BASE64URL(JWS Signature)

   Only one signature/MAC is supported by the JWS Compact Serialization
   and it provides no syntax to represent a JWS Unprotected Header
   value.

<span class="h3"><a class="selflink" id="section-7.2" href="#section-7.2">7.2</a>.  JWS JSON Serialization</span>

   The JWS JSON Serialization represents digitally signed or MACed
   content as a JSON object.  This representation is neither optimized
   for compactness nor URL-safe.

   Two closely related syntaxes are defined for the JWS JSON
   Serialization: a fully general syntax, with which content can be
   secured with more than one digital signature and/or MAC operation,
   and a flattened syntax, which is optimized for the single digital
   signature or MAC case.






<span class="grey">Jones, et al.                Standards Track                   [Page 19]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-20" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h4"><a class="selflink" id="section-7.2.1" href="#section-7.2.1">7.2.1</a>.  General JWS JSON Serialization Syntax</span>

   The following members are defined for use in top-level JSON objects
   used for the fully general JWS JSON Serialization syntax:

   payload
      The "payload" member MUST be present and contain the value
      BASE64URL(JWS Payload).

   signatures
      The "signatures" member value MUST be an array of JSON objects.
      Each object represents a signature or MAC over the JWS Payload and
      the JWS Protected Header.

   The following members are defined for use in the JSON objects that
   are elements of the "signatures" array:

   protected
      The "protected" member MUST be present and contain the value
      BASE64URL(UTF8(JWS Protected Header)) when the JWS Protected
      Header value is non-empty; otherwise, it MUST be absent.  These
      Header Parameter values are integrity protected.

   header
      The "header" member MUST be present and contain the value JWS
      Unprotected Header when the JWS Unprotected Header value is non-
      empty; otherwise, it MUST be absent.  This value is represented as
      an unencoded JSON object, rather than as a string.  These Header
      Parameter values are not integrity protected.

   signature
      The "signature" member MUST be present and contain the value
      BASE64URL(JWS Signature).

   At least one of the "protected" and "header" members MUST be present
   for each signature/MAC computation so that an "alg" Header Parameter
   value is conveyed.

   Additional members can be present in both the JSON objects defined
   above; if not understood by implementations encountering them, they
   MUST be ignored.

   The Header Parameter values used when creating or validating
   individual signature or MAC values are the union of the two sets of
   Header Parameter values that may be present: (1) the JWS Protected
   Header represented in the "protected" member of the signature/MAC's
   array element, and (2) the JWS Unprotected Header in the "header"




<span class="grey">Jones, et al.                Standards Track                   [Page 20]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-21" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   member of the signature/MAC's array element.  The union of these sets
   of Header Parameters comprises the JOSE Header.  The Header Parameter
   names in the two locations MUST be disjoint.

   Each JWS Signature value is computed using the parameters of the
   corresponding JOSE Header value in the same manner as for the JWS
   Compact Serialization.  This has the desirable property that each JWS
   Signature value represented in the "signatures" array is identical to
   the value that would have been computed for the same parameter in the
   JWS Compact Serialization, provided that the JWS Protected Header
   value for that signature/MAC computation (which represents the
   integrity-protected Header Parameter values) matches that used in the
   JWS Compact Serialization.

   In summary, the syntax of a JWS using the general JWS JSON
   Serialization is as follows:

     {
      "payload":"&lt;payload contents&gt;",
      "signatures":[
       {"protected":"&lt;integrity-protected header 1 contents&gt;",
        "header":&lt;non-integrity-protected header 1 contents&gt;,
        "signature":"&lt;signature 1 contents&gt;"},
       ...
       {"protected":"&lt;integrity-protected header N contents&gt;",
        "header":&lt;non-integrity-protected header N contents&gt;,
        "signature":"&lt;signature N contents&gt;"}]
     }

   See <a href="#appendix-A.6">Appendix A.6</a> for an example JWS using the general JWS JSON
   Serialization syntax.

<span class="h4"><a class="selflink" id="section-7.2.2" href="#section-7.2.2">7.2.2</a>.  Flattened JWS JSON Serialization Syntax</span>

   The flattened JWS JSON Serialization syntax is based upon the general
   syntax but flattens it, optimizing it for the single digital
   signature/MAC case.  It flattens it by removing the "signatures"
   member and instead placing those members defined for use in the
   "signatures" array (the "protected", "header", and "signature"
   members) in the top-level JSON object (at the same level as the
   "payload" member).

   The "signatures" member MUST NOT be present when using this syntax.
   Other than this syntax difference, JWS JSON Serialization objects
   using the flattened syntax are processed identically to those using
   the general syntax.





<span class="grey">Jones, et al.                Standards Track                   [Page 21]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-22" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   In summary, the syntax of a JWS using the flattened JWS JSON
   Serialization is as follows:

     {
      "payload":"&lt;payload contents&gt;",
      "protected":"&lt;integrity-protected header contents&gt;",
      "header":&lt;non-integrity-protected header contents&gt;,
      "signature":"&lt;signature contents&gt;"
     }

   See <a href="#appendix-A.7">Appendix A.7</a> for an example JWS using the flattened JWS JSON
   Serialization syntax.

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>.  TLS Requirements</span>

   Implementations supporting the "jku" and/or "x5u" Header Parameters
   MUST support TLS.  Which TLS version(s) ought to be implemented will
   vary over time and depend on the widespread deployment and known
   security vulnerabilities at the time of implementation.  At the time
   of this writing, TLS version 1.2 [<a href="./rfc5246" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>] is the most recent
   version.

   To protect against information disclosure and tampering,
   confidentiality protection MUST be applied using TLS with a
   ciphersuite that provides confidentiality and integrity protection.
   See current publications by the IETF TLS working group, including <a href="./rfc6176">RFC</a>
   <a href="./rfc6176">6176</a> [<a href="./rfc6176" title="&quot;Prohibiting Secure Sockets Layer (SSL) Version 2.0&quot;">RFC6176</a>], for guidance on the ciphersuites currently considered
   to be appropriate for use.  Also, see "Recommendations for Secure Use
   of Transport Layer Security (TLS) and Datagram Transport Layer
   Security (DTLS)" [<a href="./rfc7525" title="&quot;Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)&quot;">RFC7525</a>] for recommendations on improving the
   security of software and services using TLS.

   Whenever TLS is used, the identity of the service provider encoded in
   the TLS server certificate MUST be verified using the procedures
   described in <a href="./rfc6125#section-6">Section&nbsp;6 of RFC 6125</a> [<a href="./rfc6125" title="&quot;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)&quot;">RFC6125</a>].

<span class="h2"><a class="selflink" id="section-9" href="#section-9">9</a>.  IANA Considerations</span>

   The following registration procedure is used for all the registries
   established by this specification.

   Values are registered on a Specification Required [<a href="./rfc5226" title="">RFC5226</a>] basis
   after a three-week review period on the jose-reg-review@ietf.org
   mailing list, on the advice of one or more Designated Experts.
   However, to allow for the allocation of values prior to publication,
   the Designated Experts may approve registration once they are
   satisfied that such a specification will be published.




<span class="grey">Jones, et al.                Standards Track                   [Page 22]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-23" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Registration requests sent to the mailing list for review should use
   an appropriate subject (e.g., "Request to register header parameter:
   example").

   Within the review period, the Designated Experts will either approve
   or deny the registration request, communicating this decision to the
   review list and IANA.  Denials should include an explanation and, if
   applicable, suggestions as to how to make the request successful.
   Registration requests that are undetermined for a period longer than
   21 days can be brought to the IESG's attention (using the
   iesg@ietf.org mailing list) for resolution.

   Criteria that should be applied by the Designated Experts includes
   determining whether the proposed registration duplicates existing
   functionality, whether it is likely to be of general applicability or
   useful only for a single application, and whether the registration
   description is clear.

   IANA must only accept registry updates from the Designated Experts
   and should direct all requests for registration to the review mailing
   list.

   It is suggested that multiple Designated Experts be appointed who are
   able to represent the perspectives of different applications using
   this specification, in order to enable broadly informed review of
   registration decisions.  In cases where a registration decision could
   be perceived as creating a conflict of interest for a particular
   Expert, that Expert should defer to the judgment of the other
   Experts.

<span class="h3"><a class="selflink" id="section-9.1" href="#section-9.1">9.1</a>.  JSON Web Signature and Encryption Header Parameters Registry</span>

   This specification establishes the IANA "JSON Web Signature and
   Encryption Header Parameters" registry for Header Parameter names.
   The registry records the Header Parameter name and a reference to the
   specification that defines it.  The same Header Parameter name can be
   registered multiple times, provided that the parameter usage is
   compatible between the specifications.  Different registrations of
   the same Header Parameter name will typically use different Header
   Parameter Usage Locations values.

<span class="h4"><a class="selflink" id="section-9.1.1" href="#section-9.1.1">9.1.1</a>.  Registration Template</span>

   Header Parameter Name:
      The name requested (e.g., "kid").  Because a core goal of this
      specification is for the resulting representations to be compact,
      it is RECOMMENDED that the name be short -- not to exceed 8
      characters without a compelling reason to do so.  This name is



<span class="grey">Jones, et al.                Standards Track                   [Page 23]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-24" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


      case sensitive.  Names may not match other registered names in a
      case-insensitive manner unless the Designated Experts state that
      there is a compelling reason to allow an exception.

   Header Parameter Description:
      Brief description of the Header Parameter (e.g., "Key ID").

   Header Parameter Usage Location(s):
      The Header Parameter usage locations, which should be one or more
      of the values "JWS" or "JWE".

   Change Controller:
      For Standards Track RFCs, list the "IESG".  For others, give the
      name of the responsible party.  Other details (e.g., postal
      address, email address, home page URI) may also be included.

   Specification Document(s):
      Reference to the document or documents that specify the parameter,
      preferably including URIs that can be used to retrieve copies of
      the documents.  An indication of the relevant sections may also be
      included but is not required.

<span class="h4"><a class="selflink" id="section-9.1.2" href="#section-9.1.2">9.1.2</a>.  Initial Registry Contents</span>

   This section registers the Header Parameter names defined in
   <a href="#section-4.1">Section 4.1</a> in this registry.

   o  Header Parameter Name: "alg"
   o  Header Parameter Description: Algorithm
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.1">Section&nbsp;4.1.1 of RFC 7515</a>

   o  Header Parameter Name: "jku"
   o  Header Parameter Description: JWK Set URL
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.2">Section&nbsp;4.1.2 of RFC 7515</a>

   o  Header Parameter Name: "jwk"
   o  Header Parameter Description: JSON Web Key
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.3">Section&nbsp;4.1.3 of RFC 7515</a>







<span class="grey">Jones, et al.                Standards Track                   [Page 24]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-25" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   o  Header Parameter Name: "kid"
   o  Header Parameter Description: Key ID
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.4">Section&nbsp;4.1.4 of RFC 7515</a>

   o  Header Parameter Name: "x5u"
   o  Header Parameter Description: X.509 URL
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.5">Section&nbsp;4.1.5 of RFC 7515</a>

   o  Header Parameter Name: "x5c"
   o  Header Parameter Description: X.509 Certificate Chain
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.6">Section&nbsp;4.1.6 of RFC 7515</a>

   o  Header Parameter Name: "x5t"
   o  Header Parameter Description: X.509 Certificate SHA-1 Thumbprint
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.7">Section&nbsp;4.1.7 of RFC 7515</a>

   o  Header Parameter Name: "x5t#S256"
   o  Header Parameter Description: X.509 Certificate SHA-256 Thumbprint
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.8">Section&nbsp;4.1.8 of RFC 7515</a>

   o  Header Parameter Name: "typ"
   o  Header Parameter Description: Type
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.9">Section&nbsp;4.1.9 of RFC 7515</a>

   o  Header Parameter Name: "cty"
   o  Header Parameter Description: Content Type
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.10">Section&nbsp;4.1.10 of RFC 7515</a>

   o  Header Parameter Name: "crit"
   o  Header Parameter Description: Critical
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.11">Section&nbsp;4.1.11 of RFC 7515</a>




<span class="grey">Jones, et al.                Standards Track                   [Page 25]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-26" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h3"><a class="selflink" id="section-9.2" href="#section-9.2">9.2</a>.  Media Type Registration</span>

<span class="h4"><a class="selflink" id="section-9.2.1" href="#section-9.2.1">9.2.1</a>.  Registry Contents</span>

   This section registers the "application/jose" media type [<a href="./rfc2046" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types&quot;">RFC2046</a>] in
   the "Media Types" registry [<a href="#ref-IANA.MediaTypes">IANA.MediaTypes</a>] in the manner described
   in <a href="./rfc6838">RFC 6838</a> [<a href="./rfc6838" title="&quot;Media Type Specifications and Registration Procedures&quot;">RFC6838</a>], which can be used to indicate that the content
   is a JWS or JWE using the JWS Compact Serialization or the JWE
   Compact Serialization.  This section also registers the "application/
   jose+json" media type in the "Media Types" registry, which can be
   used to indicate that the content is a JWS or JWE using the JWS JSON
   Serialization or the JWE JSON Serialization.

   o  Type name: application
   o  Subtype name: jose
   o  Required parameters: n/a
   o  Optional parameters: n/a
   o  Encoding considerations: 8bit; application/jose values are encoded
      as a series of base64url-encoded values (some of which may be the
      empty string), each separated from the next by a single period
      ('.') character.
   o  Security considerations: See the Security Considerations section
      of <a href="./rfc7515">RFC 7515</a>.
   o  Interoperability considerations: n/a
   o  Published specification: <a href="./rfc7515">RFC 7515</a>
   o  Applications that use this media type: OpenID Connect, Mozilla
      Persona, Salesforce, Google, Android, Windows Azure, Xbox One,
      Amazon Web Services, and numerous others that use JWTs
   o  Fragment identifier considerations: n/a
   o  Additional information:

         Magic number(s): n/a
         File extension(s): n/a
         Macintosh file type code(s): n/a

   o  Person &amp; email address to contact for further information:
      Michael B. Jones, mbj@microsoft.com
   o  Intended usage: COMMON
   o  Restrictions on usage: none
   o  Author: Michael B. Jones, mbj@microsoft.com
   o  Change Controller: IESG
   o  Provisional registration?  No









<span class="grey">Jones, et al.                Standards Track                   [Page 26]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-27" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   o  Type name: application
   o  Subtype name: jose+json
   o  Required parameters: n/a
   o  Optional parameters: n/a
   o  Encoding considerations: 8bit; application/jose+json values are
      represented as a JSON Object; UTF-8 encoding SHOULD be employed
      for the JSON object.
   o  Security considerations: See the Security Considerations section
      of <a href="./rfc7515">RFC 7515</a>
   o  Interoperability considerations: n/a
   o  Published specification: <a href="./rfc7515">RFC 7515</a>
   o  Applications that use this media type: Nimbus JOSE + JWT library
   o  Fragment identifier considerations: n/a
   o  Additional information:

         Magic number(s): n/a
         File extension(s): n/a
         Macintosh file type code(s): n/a

   o  Person &amp; email address to contact for further information:
      Michael B. Jones, mbj@microsoft.com
   o  Intended usage: COMMON
   o  Restrictions on usage: none
   o  Author: Michael B. Jones, mbj@microsoft.com
   o  Change Controller: IESG
   o  Provisional registration?  No

<span class="h2"><a class="selflink" id="section-10" href="#section-10">10</a>.  Security Considerations</span>

   All of the security issues that are pertinent to any cryptographic
   application must be addressed by JWS/JWE/JWK agents.  Among these
   issues are protecting the user's asymmetric private and symmetric
   secret keys and employing countermeasures to various attacks.

   All the security considerations in "XML Signature Syntax and
   Processing Version 2.0" [<a href="#ref-W3C.NOTE-xmldsig-core2-20130411">W3C.NOTE-xmldsig-core2-20130411</a>], also apply
   to this specification, other than those that are XML specific.
   Likewise, many of the best practices documented in "XML Signature
   Best Practices" [<a href="#ref-W3C.NOTE-xmldsig-bestpractices-20130411">W3C.NOTE-xmldsig-bestpractices-20130411</a>] also apply
   to this specification, other than those that are XML specific.

<span class="h3"><a class="selflink" id="section-10.1" href="#section-10.1">10.1</a>.  Key Entropy and Random Values</span>

   Keys are only as strong as the amount of entropy used to generate
   them.  A minimum of 128 bits of entropy should be used for all keys,
   and depending upon the application context, more may be required.





<span class="grey">Jones, et al.                Standards Track                   [Page 27]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-28" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Implementations must randomly generate public/private key pairs, MAC
   keys, and padding values.  The use of inadequate pseudorandom number
   generators (PRNGs) to generate cryptographic keys can result in
   little or no security.  An attacker may find it much easier to
   reproduce the PRNG environment that produced the keys, searching the
   resulting small set of possibilities rather than brute-force
   searching the whole key space.  The generation of quality random
   numbers is difficult.  <a href="./rfc4086">RFC 4086</a> [<a href="./rfc4086" title="&quot;Randomness Requirements for Security&quot;">RFC4086</a>] offers important guidance
   in this area.

<span class="h3"><a class="selflink" id="section-10.2" href="#section-10.2">10.2</a>.  Key Protection</span>

   Implementations must protect the signer's private key.  Compromise of
   the signer's private key permits an attacker to masquerade as the
   signer.

   Implementations must protect the MAC key.  Compromise of the MAC key
   may result in undetectable modification of the authenticated content.

<span class="h3"><a class="selflink" id="section-10.3" href="#section-10.3">10.3</a>.  Key Origin Authentication</span>

   The key management technique employed to obtain public keys must
   authenticate the origin of the key; otherwise, it is unknown what
   party signed the message.

   Likewise, the key management technique employed to distribute MAC
   keys must provide data origin authentication; otherwise, the contents
   are delivered with integrity from an unknown source.

<span class="h3"><a class="selflink" id="section-10.4" href="#section-10.4">10.4</a>.  Cryptographic Agility</span>

   See Section 8.1 of [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>] for security considerations on cryptographic
   agility.

<span class="h3"><a class="selflink" id="section-10.5" href="#section-10.5">10.5</a>.  Differences between Digital Signatures and MACs</span>

   While MACs and digital signatures can both be used for integrity
   checking, there are some significant differences between the security
   properties that each of them provides.  These need to be taken into
   consideration when designing protocols and selecting the algorithms
   to be used in protocols.

   Both signatures and MACs provide for integrity checking -- verifying
   that the message has not been modified since the integrity value was
   computed.  However, MACs provide for origination identification only
   under specific circumstances.  It can normally be assumed that a
   private key used for a signature is only in the hands of a single
   entity (although perhaps a distributed entity, in the case of



<span class="grey">Jones, et al.                Standards Track                   [Page 28]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-29" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   replicated servers); however, a MAC key needs to be in the hands of
   all the entities that use it for integrity computation and checking.
   Validation of a MAC only provides corroboration that the message was
   generated by one of the parties that knows the symmetric MAC key.
   This means that origination can only be determined if a MAC key is
   known only to two entities and the recipient knows that it did not
   create the message.  MAC validation cannot be used to prove
   origination to a third party.

<span class="h3"><a class="selflink" id="section-10.6" href="#section-10.6">10.6</a>.  Algorithm Validation</span>

   The digital signature representations for some algorithms include
   information about the algorithm used inside the signature value.  For
   instance, signatures produced with RSASSA-PKCS1-v1_5 [<a href="./rfc3447" title="&quot;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1&quot;">RFC3447</a>] encode
   the hash function used, and many libraries actually use the hash
   algorithm specified inside the signature when validating the
   signature.  When using such libraries, as part of the algorithm
   validation performed, implementations MUST ensure that the algorithm
   information encoded in the signature corresponds to that specified
   with the "alg" Header Parameter.  If this is not done, an attacker
   could claim to have used a strong hash algorithm while actually using
   a weak one represented in the signature value.

<span class="h3"><a class="selflink" id="section-10.7" href="#section-10.7">10.7</a>.  Algorithm Protection</span>

   In some usages of JWS, there is a risk of algorithm substitution
   attacks, in which an attacker can use an existing digital signature
   value with a different signature algorithm to make it appear that a
   signer has signed something that it has not.  These attacks have been
   discussed in detail in the context of Cryptographic Message Syntax
   (CMS) [<a href="./rfc6211" title="&quot;Cryptographic Message Syntax (CMS) Algorithm Identifier Protection Attribute&quot;">RFC6211</a>].  This risk arises when all of the following are
   true:

   o  Verifiers of a signature support multiple algorithms.

   o  Given an existing signature, an attacker can find another payload
      that produces the same signature value with a different algorithm.

   o  The payload crafted by the attacker is valid in the application
      context.

   There are several ways for an application to mitigate algorithm
   substitution attacks:

   o  Use only digital signature algorithms that are not vulnerable to
      substitution attacks.  Substitution attacks are only feasible if
      an attacker can compute pre-images for a hash function accepted by




<span class="grey">Jones, et al.                Standards Track                   [Page 29]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-30" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


      the recipient.  All JWA-defined signature algorithms use SHA-2
      hashes, for which there are no known pre-image attacks, as of the
      time of this writing.

   o  Require that the "alg" Header Parameter be carried in the JWS
      Protected Header.  (This is always the case when using the JWS
      Compact Serialization and is the approach taken by CMS [<a href="./rfc6211" title="&quot;Cryptographic Message Syntax (CMS) Algorithm Identifier Protection Attribute&quot;">RFC6211</a>].)

   o  Include a field containing the algorithm in the application
      payload, and require that it be matched with the "alg" Header
      Parameter during verification.  (This is the approach taken by
      PKIX [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>].)

<span class="h3"><a class="selflink" id="section-10.8" href="#section-10.8">10.8</a>.  Chosen Plaintext Attacks</span>

   Creators of JWSs should not allow third parties to insert arbitrary
   content into the message without adding entropy not controlled by the
   third party.

<span class="h3"><a class="selflink" id="section-10.9" href="#section-10.9">10.9</a>.  Timing Attacks</span>

   When cryptographic algorithms are implemented in such a way that
   successful operations take a different amount of time than
   unsuccessful operations, attackers may be able to use the time
   difference to obtain information about the keys employed.  Therefore,
   such timing differences must be avoided.

<span class="h3"><a class="selflink" id="section-10.10" href="#section-10.10">10.10</a>.  Replay Protection</span>

   While not directly in scope for this specification, note that
   applications using JWS (or JWE) objects can thwart replay attacks by
   including a unique message identifier as integrity-protected content
   in the JWS (or JWE) message and having the recipient verify that the
   message has not been previously received or acted upon.

<span class="h3"><a class="selflink" id="section-10.11" href="#section-10.11">10.11</a>.  SHA-1 Certificate Thumbprints</span>

   A SHA-1 hash is used when computing "x5t" (X.509 certificate SHA-1
   thumbprint) values, for compatibility reasons.  Should an effective
   means of producing SHA-1 hash collisions be developed and should an
   attacker wish to interfere with the use of a known certificate on a
   given system, this could be accomplished by creating another
   certificate whose SHA-1 hash value is the same and adding it to the
   certificate store used by the intended victim.  A prerequisite to
   this attack succeeding is the attacker having write access to the
   intended victim's certificate store.





<span class="grey">Jones, et al.                Standards Track                   [Page 30]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-31" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Alternatively, the "x5t#S256" (X.509 certificate SHA-256 thumbprint)
   Header Parameter could be used instead of "x5t".  However, at the
   time of this writing, no development platform is known to support
   SHA-256 certificate thumbprints.

<span class="h3"><a class="selflink" id="section-10.12" href="#section-10.12">10.12</a>.  JSON Security Considerations</span>

   Strict JSON [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>] validation is a security requirement.  If
   malformed JSON is received, then the intent of the producer is
   impossible to reliably discern.  Ambiguous and potentially
   exploitable situations could arise if the JSON parser used does not
   reject malformed JSON syntax.  In particular, any JSON inputs not
   conforming to the JSON-text syntax defined in <a href="./rfc7159">RFC 7159</a> MUST be
   rejected in their entirety by JSON parsers.

   <a href="#section-4">Section 4</a> of "The JavaScript Object Notation (JSON) Data Interchange
   Format" [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>] states, "The names within an object SHOULD be
   unique", whereas this specification states that

      The Header Parameter names within the JOSE Header MUST be unique;
      JWS parsers MUST either reject JWSs with duplicate Header
      Parameter names or use a JSON parser that returns only the
      lexically last duplicate member name, as specified in
      <a href="#section-15.12">Section 15.12</a> ("The JSON Object") of ECMAScript 5.1 [<a href="#ref-ECMAScript" title="&quot;ECMAScript Language Specification, 5.1 Edition&quot;">ECMAScript</a>].

   Thus, this specification requires that the "SHOULD" in <a href="./rfc7159#section-4">Section&nbsp;4 of
   [RFC7159]</a> be treated as a "MUST" by producers and that it be either
   treated as a "MUST" or treated in the manner specified in ECMAScript
   5.1 by consumers.  Ambiguous and potentially exploitable situations
   could arise if the JSON parser used does not enforce the uniqueness
   of member names or returns an unpredictable value for duplicate
   member names.

   Some JSON parsers might not reject input that contains extra
   significant characters after a valid input.  For instance, the input
   "{"tag":"value"}ABCD" contains a valid JSON-text object followed by
   the extra characters "ABCD".  Implementations MUST consider JWSs
   containing such input to be invalid.

<span class="h3"><a class="selflink" id="section-10.13" href="#section-10.13">10.13</a>.  Unicode Comparison Security Considerations</span>

   Header Parameter names and algorithm names are Unicode strings.  For
   security reasons, the representations of these names must be compared
   verbatim after performing any escape processing (as per <a href="./rfc7159#section-8.3">Section&nbsp;8.3
   of RFC 7159</a> [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>]).  This means, for instance, that these JSON
   strings must compare as being equal ("sig", "\u0073ig"), whereas
   these must all compare as being not equal to the first set or to each
   other ("SIG", "Sig", "si\u0047").



<span class="grey">Jones, et al.                Standards Track                   [Page 31]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-32" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   JSON strings can contain characters outside the Unicode Basic
   Multilingual Plane.  For instance, the G clef character (U+1D11E) may
   be represented in a JSON string as "\uD834\uDD1E".  Ideally, JWS
   implementations SHOULD ensure that characters outside the Basic
   Multilingual Plane are preserved and compared correctly;
   alternatively, if this is not possible due to these characters
   exercising limitations present in the underlying JSON implementation,
   then input containing them MUST be rejected.

<span class="h2"><a class="selflink" id="section-11" href="#section-11">11</a>.  References</span>

<span class="h3"><a class="selflink" id="section-11.1" href="#section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-ECMAScript">ECMAScript</a>] Ecma International, "ECMAScript Language Specification,
                5.1 Edition", ECMA 262, June 2011,
                &lt;<a href="http://www.ecma-international.org/ecma-262/5.1/ECMA-262.pdf">http://www.ecma-international.org/ecma-262/5.1/</a>
                <a href="http://www.ecma-international.org/ecma-262/5.1/ECMA-262.pdf">ECMA-262.pdf</a>&gt;.

   [<a id="ref-IANA.MediaTypes">IANA.MediaTypes</a>]
                IANA, "Media Types",
                &lt;<a href="http://www.iana.org/assignments/media-types">http://www.iana.org/assignments/media-types</a>&gt;.

   [<a id="ref-ITU.X690.2008">ITU.X690.2008</a>]
                International Telecommunications Union, "Information
                Technology - ASN.1 encoding rules: Specification of
                Basic Encoding Rules (BER), Canonical Encoding Rules
                (CER) and Distinguished Encoding Rules (DER)", ITU-T
                Recommendation X.690, 2008.

   [<a id="ref-JWA">JWA</a>]        Jones, M., "JSON Web Algorithms (JWA)", <a href="./rfc7518">RFC 7518</a>,
                DOI 10.17487/RFC7518, May 2015,
                &lt;<a href="https://www.rfc-editor.org/info/rfc7518">http://www.rfc-editor.org/info/rfc7518</a>&gt;.

   [<a id="ref-JWK">JWK</a>]        Jones, M., "JSON Web Key (JWK)", <a href="./rfc7517">RFC 7517</a>,
                DOI 10.17487/RFC7517, May 2015,
                &lt;<a href="https://www.rfc-editor.org/info/rfc7517">http://www.rfc-editor.org/info/rfc7517</a>&gt;.

   [<a id="ref-RFC20">RFC20</a>]      Cerf, V., "ASCII format for Network Interchange",
                STD 80, <a href="./rfc20">RFC 20</a>, DOI 10.17487/RFC0020, October 1969,
                &lt;<a href="https://www.rfc-editor.org/info/rfc20">http://www.rfc-editor.org/info/rfc20</a>&gt;.

   [<a id="ref-RFC2045">RFC2045</a>]    Freed, N. and N. Borenstein, "Multipurpose Internet Mail
                Extensions (MIME) Part One: Format of Internet Message
                Bodies", <a href="./rfc2045">RFC 2045</a>, DOI 10.17487/RFC2045, November 1996,
                &lt;<a href="https://www.rfc-editor.org/info/rfc2045">http://www.rfc-editor.org/info/rfc2045</a>&gt;.






<span class="grey">Jones, et al.                Standards Track                   [Page 32]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-33" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   [<a id="ref-RFC2046">RFC2046</a>]    Freed, N. and N. Borenstein, "Multipurpose Internet Mail
                Extensions (MIME) Part Two: Media Types", <a href="./rfc2046">RFC 2046</a>,
                DOI 10.17487/RFC2046, November 1996,
                &lt;<a href="https://www.rfc-editor.org/info/rfc2046">http://www.rfc-editor.org/info/rfc2046</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]    Bradner, S., "Key words for use in RFCs to Indicate
                Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>,
                DOI 10.17487/RFC2119, March 1997,
                &lt;<a href="https://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2818">RFC2818</a>]    Rescorla, E., "HTTP Over TLS", <a href="./rfc2818">RFC 2818</a>,
                DOI 10.17487/RFC2818, May 2000,
                &lt;<a href="https://www.rfc-editor.org/info/rfc2818">http://www.rfc-editor.org/info/rfc2818</a>&gt;.

   [<a id="ref-RFC3629">RFC3629</a>]    Yergeau, F., "UTF-8, a transformation format of ISO
                10646", STD 63, <a href="./rfc3629">RFC 3629</a>, DOI 10.17487/RFC3629, November
                2003, &lt;<a href="https://www.rfc-editor.org/info/rfc3629">http://www.rfc-editor.org/info/rfc3629</a>&gt;.

   [<a id="ref-RFC3986">RFC3986</a>]    Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
                Resource Identifier (URI): Generic Syntax", STD 66,
                <a href="./rfc3986">RFC 3986</a>, DOI 10.17487/RFC3986, January 2005,
                &lt;<a href="https://www.rfc-editor.org/info/rfc3986">http://www.rfc-editor.org/info/rfc3986</a>&gt;.

   [<a id="ref-RFC4648">RFC4648</a>]    Josefsson, S., "The Base16, Base32, and Base64 Data
                Encodings", <a href="./rfc4648">RFC 4648</a>, DOI 10.17487/RFC4648, October
                2006, &lt;<a href="https://www.rfc-editor.org/info/rfc4648">http://www.rfc-editor.org/info/rfc4648</a>&gt;.

   [<a id="ref-RFC4945">RFC4945</a>]    Korver, B., "The Internet IP Security PKI Profile of
                IKEv1/ISAKMP, IKEv2, and PKIX", <a href="./rfc4945">RFC 4945</a>,
                DOI 10.17487/RFC4945, August 2007,
                &lt;<a href="https://www.rfc-editor.org/info/rfc4945">http://www.rfc-editor.org/info/rfc4945</a>&gt;.

   [<a id="ref-RFC4949">RFC4949</a>]    Shirey, R., "Internet Security Glossary, Version 2",
                FYI 36, <a href="./rfc4949">RFC 4949</a>, DOI 10.17487/RFC4949, August 2007,
                &lt;<a href="https://www.rfc-editor.org/info/rfc4949">http://www.rfc-editor.org/info/rfc4949</a>&gt;.

   [<a id="ref-RFC5246">RFC5246</a>]    Dierks, T. and E. Rescorla, "The Transport Layer
                Security (TLS) Protocol Version 1.2", <a href="./rfc5246">RFC 5246</a>,
                DOI 10.17487/RFC5246, August 2008,
                &lt;<a href="https://www.rfc-editor.org/info/rfc5246">http://www.rfc-editor.org/info/rfc5246</a>&gt;.

   [<a id="ref-RFC5280">RFC5280</a>]    Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
                Housley, R., and W. Polk, "Internet X.509 Public Key
                Infrastructure Certificate and Certificate Revocation
                List (CRL) Profile", <a href="./rfc5280">RFC 5280</a>, DOI 10.17487/RFC5280, May
                2008, &lt;<a href="https://www.rfc-editor.org/info/rfc5280">http://www.rfc-editor.org/info/rfc5280</a>&gt;.





<span class="grey">Jones, et al.                Standards Track                   [Page 33]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-34" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   [<a id="ref-RFC6125">RFC6125</a>]    Saint-Andre, P. and J. Hodges, "Representation and
                Verification of Domain-Based Application Service
                Identity within Internet Public Key Infrastructure Using
                X.509 (PKIX) Certificates in the Context of Transport
                Layer Security (TLS)", <a href="./rfc6125">RFC 6125</a>, DOI 10.17487/RFC6125,
                March 2011, &lt;<a href="https://www.rfc-editor.org/info/rfc6125">http://www.rfc-editor.org/info/rfc6125</a>&gt;.

   [<a id="ref-RFC6176">RFC6176</a>]    Turner, S. and T. Polk, "Prohibiting Secure Sockets
                Layer (SSL) Version 2.0", <a href="./rfc6176">RFC 6176</a>,
                DOI 10.17487/RFC6176, March 2011,
                &lt;<a href="https://www.rfc-editor.org/info/rfc6176">http://www.rfc-editor.org/info/rfc6176</a>&gt;.

   [<a id="ref-RFC7159">RFC7159</a>]    Bray, T., Ed., "The JavaScript Object Notation (JSON)
                Data Interchange Format", <a href="./rfc7159">RFC 7159</a>,
                DOI 10.17487/RFC7159, March 2014,
                &lt;<a href="https://www.rfc-editor.org/info/rfc7159">http://www.rfc-editor.org/info/rfc7159</a>&gt;.

   [<a id="ref-UNICODE">UNICODE</a>]    The Unicode Consortium, "The Unicode Standard",
                &lt;<a href="http://www.unicode.org/versions/latest/">http://www.unicode.org/versions/latest/</a>&gt;.

<span class="h3"><a class="selflink" id="section-11.2" href="#section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-CanvasApp">CanvasApp</a>]  Facebook, "Canvas Applications",
                &lt;<a href="https://developers.facebook.com/docs/authentication/canvas">http://developers.facebook.com/docs/authentication/</a>
                <a href="https://developers.facebook.com/docs/authentication/canvas">canvas</a>&gt;.

   [<a id="ref-JSS">JSS</a>]        Bradley, J. and N. Sakimura, Ed., "JSON Simple Sign",
                September 2010, &lt;<a href="http://jsonenc.info/jss/1.0/">http://jsonenc.info/jss/1.0/</a>&gt;.

   [<a id="ref-JWE">JWE</a>]        Jones, M. and J. Hildebrand, "JSON Web Encryption
                (JWE)", <a href="./rfc7516">RFC 7516</a>, DOI 10.17487/RFC7516, May 2015,
                &lt;<a href="https://www.rfc-editor.org/info/rfc7516">http://www.rfc-editor.org/info/rfc7516</a>&gt;.

   [<a id="ref-JWT">JWT</a>]        Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
                (JWT)", <a href="./rfc7519">RFC 7519</a>, DOI 10.17487/RFC7519, May 2015,
                &lt;<a href="https://www.rfc-editor.org/info/rfc7519">http://www.rfc-editor.org/info/rfc7519</a>&gt;.

   [<a id="ref-MagicSignatures">MagicSignatures</a>]
                Panzer, J., Ed., Laurie, B., and D. Balfanz, "Magic
                Signatures", January 2011,
                &lt;<a href="https://salmon-protocol.googlecode.com/svn/trunk/draft-panzer-magicsig-01.html">http://salmon-protocol.googlecode.com/svn/trunk/</a>
                <a href="https://salmon-protocol.googlecode.com/svn/trunk/draft-panzer-magicsig-01.html">draft-panzer-magicsig-01.html</a>&gt;.

   [<a id="ref-RFC2104">RFC2104</a>]    Krawczyk, H., Bellare, M., and R. Canetti, "HMAC:
                Keyed-Hashing for Message Authentication", <a href="./rfc2104">RFC 2104</a>,
                DOI 10.17487/RFC2104, February 1997,
                &lt;<a href="https://www.rfc-editor.org/info/rfc2104">http://www.rfc-editor.org/info/rfc2104</a>&gt;.




<span class="grey">Jones, et al.                Standards Track                   [Page 34]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-35" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   [<a id="ref-RFC3447">RFC3447</a>]    Jonsson, J. and B. Kaliski, "Public-Key Cryptography
                Standards (PKCS) #1: RSA Cryptography Specifications
                Version 2.1", <a href="./rfc3447">RFC 3447</a>, DOI 10.17487/RFC3447, February
                2003, &lt;<a href="https://www.rfc-editor.org/info/rfc3447">http://www.rfc-editor.org/info/rfc3447</a>&gt;.

   [<a id="ref-RFC4086">RFC4086</a>]    Eastlake 3rd, D., Schiller, J., and S. Crocker,
                "Randomness Requirements for Security", <a href="https://www.rfc-editor.org/bcp/bcp106">BCP 106</a>,
                <a href="./rfc4086">RFC 4086</a>, DOI 10.17487/RFC4086, June 2005,
                &lt;<a href="https://www.rfc-editor.org/info/rfc4086">http://www.rfc-editor.org/info/rfc4086</a>&gt;.

   [<a id="ref-RFC4122">RFC4122</a>]    Leach, P., Mealling, M., and R. Salz, "A Universally
                Unique IDentifier (UUID) URN Namespace", <a href="./rfc4122">RFC 4122</a>,
                DOI 10.17487/RFC4122, July 2005,
                &lt;<a href="https://www.rfc-editor.org/info/rfc4122">http://www.rfc-editor.org/info/rfc4122</a>&gt;.

   [<a id="ref-RFC5226">RFC5226</a>]    Narten, T. and H. Alvestrand, "Guidelines for Writing an
                IANA Considerations Section in RFCs", <a href="https://www.rfc-editor.org/bcp/bcp26">BCP 26</a>, <a href="./rfc5226">RFC 5226</a>,
                DOI 10.17487/RFC5226, May 2008,
                &lt;<a href="https://www.rfc-editor.org/info/rfc5226">http://www.rfc-editor.org/info/rfc5226</a>&gt;.

   [<a id="ref-RFC6211">RFC6211</a>]    Schaad, J., "Cryptographic Message Syntax (CMS)
                Algorithm Identifier Protection Attribute", <a href="./rfc6211">RFC 6211</a>,
                DOI 10.17487/RFC6211, April 2011,
                &lt;<a href="https://www.rfc-editor.org/info/rfc6211">http://www.rfc-editor.org/info/rfc6211</a>&gt;.

   [<a id="ref-RFC6838">RFC6838</a>]    Freed, N., Klensin, J., and T. Hansen, "Media Type
                Specifications and Registration Procedures", <a href="https://www.rfc-editor.org/bcp/bcp13">BCP 13</a>,
                <a href="./rfc6838">RFC 6838</a>, DOI 10.17487/RFC6838, January 2013,
                &lt;<a href="https://www.rfc-editor.org/info/rfc6838">http://www.rfc-editor.org/info/rfc6838</a>&gt;.

   [<a id="ref-RFC7525">RFC7525</a>]    Sheffer, Y., Holz, R., and P. Saint-Andre,
                "Recommendations for Secure Use of Transport Layer
                Security (TLS) and Datagram Transport Layer Security
                (DTLS)", <a href="https://www.rfc-editor.org/bcp/bcp195">BCP 195</a>, <a href="./rfc7525">RFC 7525</a>, DOI 10.17487/RFC7525, May
                2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7525">http://www.rfc-editor.org/info/rfc7525</a>&gt;.

   [<a id="ref-SHS">SHS</a>]        National Institute of Standards and Technology, "Secure
                Hash Standard (SHS)", FIPS PUB 180-4, March 2012,
                &lt;<a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf">http://csrc.nist.gov/publications/fips/fips180-4/</a>
                <a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf">fips-180-4.pdf</a>&gt;.

   [<a id="ref-W3C.NOTE-xmldsig-bestpractices-20130411">W3C.NOTE-xmldsig-bestpractices-20130411</a>]
                Hirsch, F. and P. Datta, "XML Signature Best Practices",
                World Wide Web Consortium Note
                NOTE-xmldsig-bestpractices-20130411, April 2013,
                &lt;<a href="http://www.w3.org/TR/2013/NOTE-xmldsig-bestpractices-20130411/">http://www.w3.org/TR/2013/</a>
                <a href="http://www.w3.org/TR/2013/NOTE-xmldsig-bestpractices-20130411/">NOTE-xmldsig-bestpractices-20130411/</a>&gt;.




<span class="grey">Jones, et al.                Standards Track                   [Page 35]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-36" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   [<a id="ref-W3C.NOTE-xmldsig-core2-20130411">W3C.NOTE-xmldsig-core2-20130411</a>]
                Eastlake, D., Reagle, J., Solo, D., Hirsch, F.,
                Roessler, T., Yiu, K., Datta, P., and S. Cantor, "XML
                Signature Syntax and Processing Version 2.0", World Wide
                Web Consortium Note NOTE-xmldsig-core2-20130411, April
                2013,
                &lt;<a href="http://www.w3.org/TR/2013/NOTE-xmldsig-core2-20130411/">http://www.w3.org/TR/2013/NOTE-xmldsig-core2-20130411/</a>&gt;.












































<span class="grey">Jones, et al.                Standards Track                   [Page 36]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-37" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h2"><a class="selflink" id="appendix-A" href="#appendix-A">Appendix A</a>.  JWS Examples</span>

   This section provides several examples of JWSs.  While the first
   three examples all represent JSON Web Tokens (JWTs) [<a href="#ref-JWT" title="&quot;JSON Web Token (JWT)&quot;">JWT</a>], the
   payload can be any octet sequence, as shown in <a href="#appendix-A.4">Appendix A.4</a>.

<span class="h3"><a class="selflink" id="appendix-A.1" href="#appendix-A.1">A.1</a>.  Example JWS Using HMAC SHA-256</span>

<span class="h4"><a class="selflink" id="appendix-A.1.1" href="#appendix-A.1.1">A.1.1</a>.  Encoding</span>

   The following example JWS Protected Header declares that the data
   structure is a JWT [<a href="#ref-JWT" title="&quot;JSON Web Token (JWT)&quot;">JWT</a>] and the JWS Signing Input is secured using
   the HMAC SHA-256 algorithm.

     {"typ":"JWT",
      "alg":"HS256"}

   To remove potential ambiguities in the representation of the JSON
   object above, the actual octet sequence representing UTF8(JWS
   Protected Header) used in this example is also included below.  (Note
   that ambiguities can arise due to differing platform representations
   of line breaks (CRLF versus LF), differing spacing at the beginning
   and ends of lines, whether the last line has a terminating line break
   or not, and other causes.  In the representation used in this
   example, the first line has no leading or trailing spaces, a CRLF
   line break (13, 10) occurs between the first and second lines, the
   second line has one leading space (32) and no trailing spaces, and
   the last line does not have a terminating line break.)  The octets
   representing UTF8(JWS Protected Header) in this example (using JSON
   array notation) are:

   [123, 34, 116, 121, 112, 34, 58, 34, 74, 87, 84, 34, 44, 13, 10, 32,
   34, 97, 108, 103, 34, 58, 34, 72, 83, 50, 53, 54, 34, 125]

   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9

   The JWS Payload used in this example is the octets of the UTF-8
   representation of the JSON object below.  (Note that the payload can
   be any base64url-encoded octet sequence and need not be a base64url-
   encoded JSON object.)

     {"iss":"joe",
      "exp":1300819380,
      "http://example.com/is_root":true}




<span class="grey">Jones, et al.                Standards Track                   [Page 37]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-38" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   The following octet sequence, which is the UTF-8 representation used
   in this example for the JSON object above, is the JWS Payload:

   [123, 34, 105, 115, 115, 34, 58, 34, 106, 111, 101, 34, 44, 13, 10,
   32, 34, 101, 120, 112, 34, 58, 49, 51, 48, 48, 56, 49, 57, 51, 56,
   48, 44, 13, 10, 32, 34, 104, 116, 116, 112, 58, 47, 47, 101, 120, 97,
   109, 112, 108, 101, 46, 99, 111, 109, 47, 105, 115, 95, 114, 111,
   111, 116, 34, 58, 116, 114, 117, 101, 125]

   Encoding this JWS Payload as BASE64URL(UTF8(JWS Payload)) gives this
   value (with line breaks for display purposes only):

     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   Combining these as BASE64URL(UTF8(JWS Protected Header)) || '.' ||
   BASE64URL(JWS Payload) gives this string (with line breaks for
   display purposes only):

     eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   The resulting JWS Signing Input value, which is the ASCII
   representation of above string, is the following octet sequence
   (using JSON array notation):

   [101, 121, 74, 48, 101, 88, 65, 105, 79, 105, 74, 75, 86, 49, 81,
   105, 76, 65, 48, 75, 73, 67, 74, 104, 98, 71, 99, 105, 79, 105, 74,
   73, 85, 122, 73, 49, 78, 105, 74, 57, 46, 101, 121, 74, 112, 99, 51,
   77, 105, 79, 105, 74, 113, 98, 50, 85, 105, 76, 65, 48, 75, 73, 67,
   74, 108, 101, 72, 65, 105, 79, 106, 69, 122, 77, 68, 65, 52, 77, 84,
   107, 122, 79, 68, 65, 115, 68, 81, 111, 103, 73, 109, 104, 48, 100,
   72, 65, 54, 76, 121, 57, 108, 101, 71, 70, 116, 99, 71, 120, 108, 76,
   109, 78, 118, 98, 83, 57, 112, 99, 49, 57, 121, 98, 50, 57, 48, 73,
   106, 112, 48, 99, 110, 86, 108, 102, 81]

   HMACs are generated using keys.  This example uses the symmetric key
   represented in JSON Web Key [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>] format below (with line breaks
   within values for display purposes only):

     {"kty":"oct",
      "k":"AyM1SysPpbyDfgZld3umj1qzKObwVMkoqQ-EstJQLr_T-1qS0gZH75
           aKtMN3Yj0iPS4hcgUuTwjAzZr1Z9CAow"
     }





<span class="grey">Jones, et al.                Standards Track                   [Page 38]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-39" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Running the HMAC SHA-256 algorithm on the JWS Signing Input with this
   key yields this JWS Signature octet sequence:

   [116, 24, 223, 180, 151, 153, 224, 37, 79, 250, 96, 125, 216, 173,
   187, 186, 22, 212, 37, 77, 105, 214, 191, 240, 91, 88, 5, 88, 83,
   132, 141, 121]

   Encoding this JWS Signature as BASE64URL(JWS Signature) gives this
   value:

     dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk

   Concatenating these values in the order Header.Payload.Signature with
   period ('.') characters between the parts yields this complete JWS
   representation using the JWS Compact Serialization (with line breaks
   for display purposes only):

     eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
     .
     dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk

<span class="h4"><a class="selflink" id="appendix-A.1.2" href="#appendix-A.1.2">A.1.2</a>.  Validating</span>

   Since the "alg" Header Parameter is "HS256", we validate the HMAC
   SHA-256 value contained in the JWS Signature.

   To validate the HMAC value, we repeat the previous process of using
   the correct key and the JWS Signing Input (which is the initial
   substring of the JWS Compact Serialization representation up until
   but not including the second period character) as input to the HMAC
   SHA-256 function and then taking the output and determining if it
   matches the JWS Signature (which is base64url decoded from the value
   encoded in the JWS representation).  If it matches exactly, the HMAC
   has been validated.

<span class="h3"><a class="selflink" id="appendix-A.2" href="#appendix-A.2">A.2</a>.  Example JWS Using RSASSA-PKCS1-v1_5 SHA-256</span>

<span class="h4"><a class="selflink" id="appendix-A.2.1" href="#appendix-A.2.1">A.2.1</a>.  Encoding</span>

   The JWS Protected Header in this example is different from the
   previous example in two ways.  First, because a different algorithm
   is being used, the "alg" value is different.  Second, for
   illustration purposes only, the optional "typ" (type) Header
   Parameter is not used.  (This difference is not related to the
   algorithm employed.)  The JWS Protected Header used is:



<span class="grey">Jones, et al.                Standards Track                   [Page 39]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-40" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


     {"alg":"RS256"}

   The octets representing UTF8(JWS Protected Header) in this example
   (using JSON array notation) are:

   [123, 34, 97, 108, 103, 34, 58, 34, 82, 83, 50, 53, 54, 34, 125]

   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJSUzI1NiJ9

   The JWS Payload used in this example, which follows, is the same as
   in the previous example.  Since the BASE64URL(JWS Payload) value will
   therefore be the same, its computation is not repeated here.

     {"iss":"joe",
      "exp":1300819380,
      "http://example.com/is_root":true}

   Combining these as BASE64URL(UTF8(JWS Protected Header)) || '.' ||
   BASE64URL(JWS Payload) gives this string (with line breaks for
   display purposes only):

     eyJhbGciOiJSUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   The resulting JWS Signing Input value, which is the ASCII
   representation of above string, is the following octet sequence:

   [101, 121, 74, 104, 98, 71, 99, 105, 79, 105, 74, 83, 85, 122, 73,
   49, 78, 105, 74, 57, 46, 101, 121, 74, 112, 99, 51, 77, 105, 79, 105,
   74, 113, 98, 50, 85, 105, 76, 65, 48, 75, 73, 67, 74, 108, 101, 72,
   65, 105, 79, 106, 69, 122, 77, 68, 65, 52, 77, 84, 107, 122, 79, 68,
   65, 115, 68, 81, 111, 103, 73, 109, 104, 48, 100, 72, 65, 54, 76,
   121, 57, 108, 101, 71, 70, 116, 99, 71, 120, 108, 76, 109, 78, 118,
   98, 83, 57, 112, 99, 49, 57, 121, 98, 50, 57, 48, 73, 106, 112, 48,
   99, 110, 86, 108, 102, 81]











<span class="grey">Jones, et al.                Standards Track                   [Page 40]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-41" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   This example uses the RSA key represented in JSON Web Key [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>]
   format below (with line breaks within values for display purposes
   only):

     {"kty":"RSA",
      "n":"ofgWCuLjybRlzo0tZWJjNiuSfb4p4fAkd_wWJcyQoTbji9k0l8W26mPddx
           HmfHQp-Vaw-4qPCJrcS2mJPMEzP1Pt0Bm4d4QlL-yRT-SFd2lZS-pCgNMs
           D1W_YpRPEwOWvG6b32690r2jZ47soMZo9wGzjb_7OMg0LOL-bSf63kpaSH
           SXndS5z5rexMdbBYUsLA9e-KXBdQOS-UTo7WTBEMa2R2CapHg665xsmtdV
           MTBQY4uDZlxvb3qCo5ZwKh9kG4LT6_I5IhlJH7aGhyxXFvUK-DWNmoudF8
           NAco9_h9iaGNj8q2ethFkMLs91kzk2PAcDTW9gb54h4FRWyuXpoQ",
      "e":"AQAB",
      "d":"Eq5xpGnNCivDflJsRQBXHx1hdR1k6Ulwe2JZD50LpXyWPEAeP88vLNO97I
           jlA7_GQ5sLKMgvfTeXZx9SE-7YwVol2NXOoAJe46sui395IW_GO-pWJ1O0
           BkTGoVEn2bKVRUCgu-GjBVaYLU6f3l9kJfFNS3E0QbVdxzubSu3Mkqzjkn
           439X0M_V51gfpRLI9JYanrC4D4qAdGcopV_0ZHHzQlBjudU2QvXt4ehNYT
           CBr6XCLQUShb1juUO1ZdiYoFaFQT5Tw8bGUl_x_jTj3ccPDVZFD9pIuhLh
           BOneufuBiB4cS98l2SR_RQyGWSeWjnczT0QU91p1DhOVRuOopznQ",
      "p":"4BzEEOtIpmVdVEZNCqS7baC4crd0pqnRH_5IB3jw3bcxGn6QLvnEtfdUdi
           YrqBdss1l58BQ3KhooKeQTa9AB0Hw_Py5PJdTJNPY8cQn7ouZ2KKDcmnPG
           BY5t7yLc1QlQ5xHdwW1VhvKn-nXqhJTBgIPgtldC-KDV5z-y2XDwGUc",
      "q":"uQPEfgmVtjL0Uyyx88GZFF1fOunH3-7cepKmtH4pxhtCoHqpWmT8YAmZxa
           ewHgHAjLYsp1ZSe7zFYHj7C6ul7TjeLQeZD_YwD66t62wDmpe_HlB-TnBA
           -njbglfIsRLtXlnDzQkv5dTltRJ11BKBBypeeF6689rjcJIDEz9RWdc",
      "dp":"BwKfV3Akq5_MFZDFZCnW-wzl-CCo83WoZvnLQwCTeDv8uzluRSnm71I3Q
           CLdhrqE2e9YkxvuxdBfpT_PI7Yz-FOKnu1R6HsJeDCjn12Sk3vmAktV2zb
           34MCdy7cpdTh_YVr7tss2u6vneTwrA86rZtu5Mbr1C1XsmvkxHQAdYo0",
      "dq":"h_96-mK1R_7glhsum81dZxjTnYynPbZpHziZjeeHcXYsXaaMwkOlODsWa
           7I9xXDoRwbKgB719rrmI2oKr6N3Do9U0ajaHF-NKJnwgjMd2w9cjz3_-ky
           NlxAr2v4IKhGNpmM5iIgOS1VZnOZ68m6_pbLBSp3nssTdlqvd0tIiTHU",
      "qi":"IYd7DHOhrWvxkwPQsRM2tOgrjbcrfvtQJipd-DlcxyVuuM9sQLdgjVk2o
           y26F0EmpScGLq2MowX7fhd_QJQ3ydy5cY7YIBi87w93IKLEdfnbJtoOPLU
           W0ITrJReOgo1cq9SbsxYawBgfp_gh6A5603k2-ZQwVK0JKSHuLFkuQ3U"
     }

















<span class="grey">Jones, et al.                Standards Track                   [Page 41]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-42" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   The RSA private key is then passed to the RSA signing function, which
   also takes the hash type, SHA-256, and the JWS Signing Input as
   inputs.  The result of the digital signature is an octet sequence,
   which represents a big-endian integer.  In this example, it is:

   [112, 46, 33, 137, 67, 232, 143, 209, 30, 181, 216, 45, 191, 120, 69,
   243, 65, 6, 174, 27, 129, 255, 247, 115, 17, 22, 173, 209, 113, 125,
   131, 101, 109, 66, 10, 253, 60, 150, 238, 221, 115, 162, 102, 62, 81,
   102, 104, 123, 0, 11, 135, 34, 110, 1, 135, 237, 16, 115, 249, 69,
   229, 130, 173, 252, 239, 22, 216, 90, 121, 142, 232, 198, 109, 219,
   61, 184, 151, 91, 23, 208, 148, 2, 190, 237, 213, 217, 217, 112, 7,
   16, 141, 178, 129, 96, 213, 248, 4, 12, 167, 68, 87, 98, 184, 31,
   190, 127, 249, 217, 46, 10, 231, 111, 36, 242, 91, 51, 187, 230, 244,
   74, 230, 30, 177, 4, 10, 203, 32, 4, 77, 62, 249, 18, 142, 212, 1,
   48, 121, 91, 212, 189, 59, 65, 238, 202, 208, 102, 171, 101, 25, 129,
   253, 228, 141, 247, 127, 55, 45, 195, 139, 159, 175, 221, 59, 239,
   177, 139, 93, 163, 204, 60, 46, 176, 47, 158, 58, 65, 214, 18, 202,
   173, 21, 145, 18, 115, 160, 95, 35, 185, 232, 56, 250, 175, 132, 157,
   105, 132, 41, 239, 90, 30, 136, 121, 130, 54, 195, 212, 14, 96, 69,
   34, 165, 68, 200, 242, 122, 122, 45, 184, 6, 99, 209, 108, 247, 202,
   234, 86, 222, 64, 92, 178, 33, 90, 69, 178, 194, 85, 102, 181, 90,
   193, 167, 72, 160, 112, 223, 200, 163, 42, 70, 149, 67, 208, 25, 238,
   251, 71]

   Encoding the signature as BASE64URL(JWS Signature) produces this
   value (with line breaks for display purposes only):

     cC4hiUPoj9Eetdgtv3hF80EGrhuB__dzERat0XF9g2VtQgr9PJbu3XOiZj5RZmh7
     AAuHIm4Bh-0Qc_lF5YKt_O8W2Fp5jujGbds9uJdbF9CUAr7t1dnZcAcQjbKBYNX4
     BAynRFdiuB--f_nZLgrnbyTyWzO75vRK5h6xBArLIARNPvkSjtQBMHlb1L07Qe7K
     0GarZRmB_eSN9383LcOLn6_dO--xi12jzDwusC-eOkHWEsqtFZESc6BfI7noOPqv
     hJ1phCnvWh6IeYI2w9QOYEUipUTI8np6LbgGY9Fs98rqVt5AXLIhWkWywlVmtVrB
     p0igcN_IoypGlUPQGe77Rw


















<span class="grey">Jones, et al.                Standards Track                   [Page 42]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-43" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Concatenating these values in the order Header.Payload.Signature with
   period ('.') characters between the parts yields this complete JWS
   representation using the JWS Compact Serialization (with line breaks
   for display purposes only):

     eyJhbGciOiJSUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
     .
     cC4hiUPoj9Eetdgtv3hF80EGrhuB__dzERat0XF9g2VtQgr9PJbu3XOiZj5RZmh7
     AAuHIm4Bh-0Qc_lF5YKt_O8W2Fp5jujGbds9uJdbF9CUAr7t1dnZcAcQjbKBYNX4
     BAynRFdiuB--f_nZLgrnbyTyWzO75vRK5h6xBArLIARNPvkSjtQBMHlb1L07Qe7K
     0GarZRmB_eSN9383LcOLn6_dO--xi12jzDwusC-eOkHWEsqtFZESc6BfI7noOPqv
     hJ1phCnvWh6IeYI2w9QOYEUipUTI8np6LbgGY9Fs98rqVt5AXLIhWkWywlVmtVrB
     p0igcN_IoypGlUPQGe77Rw

<span class="h4"><a class="selflink" id="appendix-A.2.2" href="#appendix-A.2.2">A.2.2</a>.  Validating</span>

   Since the "alg" Header Parameter is "RS256", we validate the RSASSA-
   PKCS1-v1_5 SHA-256 digital signature contained in the JWS Signature.

   Validating the JWS Signature is a bit different from the previous
   example.  We pass the public key (n, e), the JWS Signature (which is
   base64url decoded from the value encoded in the JWS representation),
   and the JWS Signing Input (which is the initial substring of the JWS
   Compact Serialization representation up until but not including the
   second period character) to an RSASSA-PKCS1-v1_5 signature verifier
   that has been configured to use the SHA-256 hash function.

<span class="h3"><a class="selflink" id="appendix-A.3" href="#appendix-A.3">A.3</a>.  Example JWS Using ECDSA P-256 SHA-256</span>

<span class="h4"><a class="selflink" id="appendix-A.3.1" href="#appendix-A.3.1">A.3.1</a>.  Encoding</span>

   The JWS Protected Header for this example differs from the previous
   example because a different algorithm is being used.  The JWS
   Protected Header used is:

     {"alg":"ES256"}

   The octets representing UTF8(JWS Protected Header) in this example
   (using JSON array notation) are:

   [123, 34, 97, 108, 103, 34, 58, 34, 69, 83, 50, 53, 54, 34, 125]







<span class="grey">Jones, et al.                Standards Track                   [Page 43]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-44" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJFUzI1NiJ9

   The JWS Payload used in this example, which follows, is the same as
   in the previous examples.  Since the BASE64URL(JWS Payload) value
   will therefore be the same, its computation is not repeated here.

     {"iss":"joe",
      "exp":1300819380,
      "http://example.com/is_root":true}

   Combining these as BASE64URL(UTF8(JWS Protected Header)) || '.' ||
   BASE64URL(JWS Payload) gives this string (with line breaks for
   display purposes only):

     eyJhbGciOiJFUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   The resulting JWS Signing Input value, which is the ASCII
   representation of above string, is the following octet sequence:

   [101, 121, 74, 104, 98, 71, 99, 105, 79, 105, 74, 70, 85, 122, 73,
   49, 78, 105, 74, 57, 46, 101, 121, 74, 112, 99, 51, 77, 105, 79, 105,
   74, 113, 98, 50, 85, 105, 76, 65, 48, 75, 73, 67, 74, 108, 101, 72,
   65, 105, 79, 106, 69, 122, 77, 68, 65, 52, 77, 84, 107, 122, 79, 68,
   65, 115, 68, 81, 111, 103, 73, 109, 104, 48, 100, 72, 65, 54, 76,
   121, 57, 108, 101, 71, 70, 116, 99, 71, 120, 108, 76, 109, 78, 118,
   98, 83, 57, 112, 99, 49, 57, 121, 98, 50, 57, 48, 73, 106, 112, 48,
   99, 110, 86, 108, 102, 81]

   This example uses the Elliptic Curve key represented in JSON Web Key
   [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>] format below:

     {"kty":"EC",
      "crv":"P-256",
      "x":"f83OJ3D2xF1Bg8vub9tLe1gHMzV76e8Tus9uPHvRVEU",
      "y":"x_FEzRu9m36HLN_tue659LNpXW6pCyStikYjKIWI5a0",
      "d":"jpsQnnGQmL-YBIffH1136cspYG6-0iY7X1fCE9-E9LI"
     }

   The Elliptic Curve Digital Signature Algorithm (ECDSA) private part d
   is then passed to an ECDSA signing function, which also takes the
   curve type, P-256, the hash type, SHA-256, and the JWS Signing Input
   as inputs.  The result of the digital signature is the Elliptic Curve



<span class="grey">Jones, et al.                Standards Track                   [Page 44]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-45" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   (EC) point (R, S), where R and S are unsigned integers.  In this
   example, the R and S values, given as octet sequences representing
   big-endian integers are:

   +--------+----------------------------------------------------------+
   | Result | Value                                                    |
   | Name   |                                                          |
   +--------+----------------------------------------------------------+
   | R      | [14, 209, 33, 83, 121, 99, 108, 72, 60, 47, 127, 21, 88, |
   |        | 7, 212, 2, 163, 178, 40, 3, 58, 249, 124, 126, 23, 129,  |
   |        | 154, 195, 22, 158, 166, 101]                             |
   | S      | [197, 10, 7, 211, 140, 60, 112, 229, 216, 241, 45, 175,  |
   |        | 8, 74, 84, 128, 166, 101, 144, 197, 242, 147, 80, 154,   |
   |        | 143, 63, 127, 138, 131, 163, 84, 213]                    |
   +--------+----------------------------------------------------------+

   The JWS Signature is the value R || S.  Encoding the signature as
   BASE64URL(JWS Signature) produces this value (with line breaks for
   display purposes only):

     DtEhU3ljbEg8L38VWAfUAqOyKAM6-Xx-F4GawxaepmXFCgfTjDxw5djxLa8ISlSA
     pmWQxfKTUJqPP3-Kg6NU1Q

   Concatenating these values in the order Header.Payload.Signature with
   period ('.') characters between the parts yields this complete JWS
   representation using the JWS Compact Serialization (with line breaks
   for display purposes only):

     eyJhbGciOiJFUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
     .
     DtEhU3ljbEg8L38VWAfUAqOyKAM6-Xx-F4GawxaepmXFCgfTjDxw5djxLa8ISlSA
     pmWQxfKTUJqPP3-Kg6NU1Q

<span class="h4"><a class="selflink" id="appendix-A.3.2" href="#appendix-A.3.2">A.3.2</a>.  Validating</span>

   Since the "alg" Header Parameter is "ES256", we validate the ECDSA
   P-256 SHA-256 digital signature contained in the JWS Signature.

   Validating the JWS Signature is a bit different from the previous
   examples.  We need to split the 64 member octet sequence of the JWS
   Signature (which is base64url decoded from the value encoded in the
   JWS representation) into two 32 octet sequences, the first
   representing R and the second S.  We then pass the public key (x, y),
   the signature (R, S), and the JWS Signing Input (which is the initial
   substring of the JWS Compact Serialization representation up until



<span class="grey">Jones, et al.                Standards Track                   [Page 45]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-46" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   but not including the second period character) to an ECDSA signature
   verifier that has been configured to use the P-256 curve with the
   SHA-256 hash function.

<span class="h3"><a class="selflink" id="appendix-A.4" href="#appendix-A.4">A.4</a>.  Example JWS Using ECDSA P-521 SHA-512</span>

<span class="h4"><a class="selflink" id="appendix-A.4.1" href="#appendix-A.4.1">A.4.1</a>.  Encoding</span>

   The JWS Protected Header for this example differs from the previous
   example because different ECDSA curves and hash functions are used.
   The JWS Protected Header used is:

     {"alg":"ES512"}

   The octets representing UTF8(JWS Protected Header) in this example
   (using JSON array notation) are:

   [123, 34, 97, 108, 103, 34, 58, 34, 69, 83, 53, 49, 50, 34, 125]

   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJFUzUxMiJ9

   The JWS Payload used in this example is the ASCII string "Payload".
   The representation of this string is the following octet sequence:

   [80, 97, 121, 108, 111, 97, 100]

   Encoding this JWS Payload as BASE64URL(JWS Payload) gives this value:

     UGF5bG9hZA

   Combining these as BASE64URL(UTF8(JWS Protected Header)) || '.' ||
   BASE64URL(JWS Payload) gives this string:

     eyJhbGciOiJFUzUxMiJ9.UGF5bG9hZA

   The resulting JWS Signing Input value, which is the ASCII
   representation of above string, is the following octet sequence:

   [101, 121, 74, 104, 98, 71, 99, 105, 79, 105, 74, 70, 85, 122, 85,
   120, 77, 105, 74, 57, 46, 85, 71, 70, 53, 98, 71, 57, 104, 90, 65]








<span class="grey">Jones, et al.                Standards Track                   [Page 46]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-47" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   This example uses the Elliptic Curve key represented in JSON Web Key
   [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>] format below (with line breaks within values for display
   purposes only):

     {"kty":"EC",
      "crv":"P-521",
      "x":"AekpBQ8ST8a8VcfVOTNl353vSrDCLLJXmPk06wTjxrrjcBpXp5EOnYG_
           NjFZ6OvLFV1jSfS9tsz4qUxcWceqwQGk",
      "y":"ADSmRA43Z1DSNx_RvcLI87cdL07l6jQyyBXMoxVg_l2Th-x3S1WDhjDl
           y79ajL4Kkd0AZMaZmh9ubmf63e3kyMj2",
      "d":"AY5pb7A0UFiB3RELSD64fTLOSV_jazdF7fLYyuTw8lOfRhWg6Y6rUrPA
           xerEzgdRhajnu0ferB0d53vM9mE15j2C"
     }

   The ECDSA private part d is then passed to an ECDSA signing function,
   which also takes the curve type, P-521, the hash type, SHA-512, and
   the JWS Signing Input as inputs.  The result of the digital signature
   is the EC point (R, S), where R and S are unsigned integers.  In this
   example, the R and S values, given as octet sequences representing
   big-endian integers are:

   +--------+----------------------------------------------------------+
   | Result | Value                                                    |
   | Name   |                                                          |
   +--------+----------------------------------------------------------+
   | R      | [1, 220, 12, 129, 231, 171, 194, 209, 232, 135, 233,     |
   |        | 117, 247, 105, 122, 210, 26, 125, 192, 1, 217, 21, 82,   |
   |        | 91, 45, 240, 255, 83, 19, 34, 239, 71, 48, 157, 147,     |
   |        | 152, 105, 18, 53, 108, 163, 214, 68, 231, 62, 153, 150,  |
   |        | 106, 194, 164, 246, 72, 143, 138, 24, 50, 129, 223, 133, |
   |        | 206, 209, 172, 63, 237, 119, 109]                        |
   | S      | [0, 111, 6, 105, 44, 5, 41, 208, 128, 61, 152, 40, 92,   |
   |        | 61, 152, 4, 150, 66, 60, 69, 247, 196, 170, 81, 193,     |
   |        | 199, 78, 59, 194, 169, 16, 124, 9, 143, 42, 142, 131,    |
   |        | 48, 206, 238, 34, 175, 83, 203, 220, 159, 3, 107, 155,   |
   |        | 22, 27, 73, 111, 68, 68, 21, 238, 144, 229, 232, 148,    |
   |        | 188, 222, 59, 242, 103]                                  |
   +--------+----------------------------------------------------------+

   The JWS Signature is the value R || S.  Encoding the signature as
   BASE64URL(JWS Signature) produces this value (with line breaks for
   display purposes only):

     AdwMgeerwtHoh-l192l60hp9wAHZFVJbLfD_UxMi70cwnZOYaRI1bKPWROc-mZZq
     wqT2SI-KGDKB34XO0aw_7XdtAG8GaSwFKdCAPZgoXD2YBJZCPEX3xKpRwcdOO8Kp
     EHwJjyqOgzDO7iKvU8vcnwNrmxYbSW9ERBXukOXolLzeO_Jn





<span class="grey">Jones, et al.                Standards Track                   [Page 47]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-48" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Concatenating these values in the order Header.Payload.Signature with
   period ('.') characters between the parts yields this complete JWS
   representation using the JWS Compact Serialization (with line breaks
   for display purposes only):

     eyJhbGciOiJFUzUxMiJ9
     .
     UGF5bG9hZA
     .
     AdwMgeerwtHoh-l192l60hp9wAHZFVJbLfD_UxMi70cwnZOYaRI1bKPWROc-mZZq
     wqT2SI-KGDKB34XO0aw_7XdtAG8GaSwFKdCAPZgoXD2YBJZCPEX3xKpRwcdOO8Kp
     EHwJjyqOgzDO7iKvU8vcnwNrmxYbSW9ERBXukOXolLzeO_Jn

<span class="h4"><a class="selflink" id="appendix-A.4.2" href="#appendix-A.4.2">A.4.2</a>.  Validating</span>

   Since the "alg" Header Parameter is "ES512", we validate the ECDSA
   P-521 SHA-512 digital signature contained in the JWS Signature.

   Validating this JWS Signature is very similar to the previous
   example.  We need to split the 132-member octet sequence of the JWS
   Signature into two 66-octet sequences, the first representing R and
   the second S.  We then pass the public key (x, y), the signature (R,
   S), and the JWS Signing Input to an ECDSA signature verifier that has
   been configured to use the P-521 curve with the SHA-512 hash
   function.

<span class="h3"><a class="selflink" id="appendix-A.5" href="#appendix-A.5">A.5</a>.  Example Unsecured JWS</span>

   The following example JWS Protected Header declares that the encoded
   object is an Unsecured JWS:

     {"alg":"none"}

   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJub25lIn0

   The JWS Payload used in this example, which follows, is the same as
   in the previous examples.  Since the BASE64URL(JWS Payload) value
   will therefore be the same, its computation is not repeated here.

     {"iss":"joe",
      "exp":1300819380,
      "http://example.com/is_root":true}

   The JWS Signature is the empty octet string and BASE64URL(JWS
   Signature) is the empty string.



<span class="grey">Jones, et al.                Standards Track                   [Page 48]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-49" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Concatenating these values in the order Header.Payload.Signature with
   period ('.') characters between the parts yields this complete JWS
   representation using the JWS Compact Serialization (with line breaks
   for display purposes only):

     eyJhbGciOiJub25lIn0
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
     .

<span class="h3"><a class="selflink" id="appendix-A.6" href="#appendix-A.6">A.6</a>.  Example JWS Using General JWS JSON Serialization</span>

   This section contains an example using the general JWS JSON
   Serialization syntax.  This example demonstrates the capability for
   conveying multiple digital signatures and/or MACs for the same
   payload.

   The JWS Payload used in this example is the same as that used in the
   examples in <a href="#appendix-A.2">Appendix A.2</a> and <a href="#appendix-A.3">Appendix A.3</a> (with line breaks for
   display purposes only):

     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   Two digital signatures are used in this example: the first using
   RSASSA-PKCS1-v1_5 SHA-256 and the second using ECDSA P-256 SHA-256.
   For the first, the JWS Protected Header and key are the same as in
   <a href="#appendix-A.2">Appendix A.2</a>, resulting in the same JWS Signature value; therefore,
   its computation is not repeated here.  For the second, the JWS
   Protected Header and key are the same as in <a href="#appendix-A.3">Appendix A.3</a>, resulting
   in the same JWS Signature value; therefore, its computation is not
   repeated here.

<span class="h4"><a class="selflink" id="appendix-A.6.1" href="#appendix-A.6.1">A.6.1</a>.  JWS Per-Signature Protected Headers</span>

   The JWS Protected Header value used for the first signature is:

     {"alg":"RS256"}

   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJSUzI1NiJ9

   The JWS Protected Header value used for the second signature is:

     {"alg":"ES256"}



<span class="grey">Jones, et al.                Standards Track                   [Page 49]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-50" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJFUzI1NiJ9

<span class="h4"><a class="selflink" id="appendix-A.6.2" href="#appendix-A.6.2">A.6.2</a>.  JWS Per-Signature Unprotected Headers</span>

   Key ID values are supplied for both keys using per-signature Header
   Parameters.  The two JWS Unprotected Header values used to represent
   these key IDs are:

     {"kid":"2010-12-29"}

   and

     {"kid":"e9bc097a-ce51-4036-9562-d2ade882db0d"}

<span class="h4"><a class="selflink" id="appendix-A.6.3" href="#appendix-A.6.3">A.6.3</a>.  Complete JOSE Header Values</span>

   Combining the JWS Protected Header and JWS Unprotected Header values
   supplied, the JOSE Header values used for the first and second
   signatures, respectively, are:

     {"alg":"RS256",
      "kid":"2010-12-29"}

   and

     {"alg":"ES256",
      "kid":"e9bc097a-ce51-4036-9562-d2ade882db0d"}





















<span class="grey">Jones, et al.                Standards Track                   [Page 50]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-51" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h4"><a class="selflink" id="appendix-A.6.4" href="#appendix-A.6.4">A.6.4</a>.  Complete JWS JSON Serialization Representation</span>

   The complete JWS JSON Serialization for these values is as follows
   (with line breaks within values for display purposes only):

     {
      "payload":
       "eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGF
        tcGxlLmNvbS9pc19yb290Ijp0cnVlfQ",
      "signatures":[
       {"protected":"eyJhbGciOiJSUzI1NiJ9",
        "header":
         {"kid":"2010-12-29"},
        "signature":
         "cC4hiUPoj9Eetdgtv3hF80EGrhuB__dzERat0XF9g2VtQgr9PJbu3XOiZj5RZ
          mh7AAuHIm4Bh-0Qc_lF5YKt_O8W2Fp5jujGbds9uJdbF9CUAr7t1dnZcAcQjb
          KBYNX4BAynRFdiuB--f_nZLgrnbyTyWzO75vRK5h6xBArLIARNPvkSjtQBMHl
          b1L07Qe7K0GarZRmB_eSN9383LcOLn6_dO--xi12jzDwusC-eOkHWEsqtFZES
          c6BfI7noOPqvhJ1phCnvWh6IeYI2w9QOYEUipUTI8np6LbgGY9Fs98rqVt5AX
          LIhWkWywlVmtVrBp0igcN_IoypGlUPQGe77Rw"},
       {"protected":"eyJhbGciOiJFUzI1NiJ9",
        "header":
         {"kid":"e9bc097a-ce51-4036-9562-d2ade882db0d"},
        "signature":
         "DtEhU3ljbEg8L38VWAfUAqOyKAM6-Xx-F4GawxaepmXFCgfTjDxw5djxLa8IS
          lSApmWQxfKTUJqPP3-Kg6NU1Q"}]
     }
























<span class="grey">Jones, et al.                Standards Track                   [Page 51]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-52" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h3"><a class="selflink" id="appendix-A.7" href="#appendix-A.7">A.7</a>.  Example JWS Using Flattened JWS JSON Serialization</span>

   This section contains an example using the flattened JWS JSON
   Serialization syntax.  This example demonstrates the capability for
   conveying a single digital signature or MAC in a flattened JSON
   structure.

   The values in this example are the same as those in the second
   signature of the previous example in <a href="#appendix-A.6">Appendix A.6</a>.

   The complete JWS JSON Serialization for these values is as follows
   (with line breaks within values for display purposes only):

     {
      "payload":
       "eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGF
        tcGxlLmNvbS9pc19yb290Ijp0cnVlfQ",
      "protected":"eyJhbGciOiJFUzI1NiJ9",
      "header":
       {"kid":"e9bc097a-ce51-4036-9562-d2ade882db0d"},
      "signature":
       "DtEhU3ljbEg8L38VWAfUAqOyKAM6-Xx-F4GawxaepmXFCgfTjDxw5djxLa8IS
        lSApmWQxfKTUJqPP3-Kg6NU1Q"
     }



























<span class="grey">Jones, et al.                Standards Track                   [Page 52]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-53" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h2"><a class="selflink" id="appendix-B" href="#appendix-B">Appendix B</a>.  "x5c" (X.509 Certificate Chain) Example</span>

   The JSON array below is an example of a certificate chain that could
   be used as the value of an "x5c" (X.509 certificate chain) Header
   Parameter, per <a href="#section-4.1.6">Section 4.1.6</a> (with line breaks within values for
   display purposes only):

     ["MIIE3jCCA8agAwIBAgICAwEwDQYJKoZIhvcNAQEFBQAwYzELMAkGA1UEBhMCVVM
       xITAfBgNVBAoTGFRoZSBHbyBEYWRkeSBHcm91cCwgSW5jLjExMC8GA1UECxMoR2
       8gRGFkZHkgQ2xhc3MgMiBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTAeFw0wNjExM
       TYwMTU0MzdaFw0yNjExMTYwMTU0MzdaMIHKMQswCQYDVQQGEwJVUzEQMA4GA1UE
       CBMHQXJpem9uYTETMBEGA1UEBxMKU2NvdHRzZGFsZTEaMBgGA1UEChMRR29EYWR
       keS5jb20sIEluYy4xMzAxBgNVBAsTKmh0dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYW
       RkeS5jb20vcmVwb3NpdG9yeTEwMC4GA1UEAxMnR28gRGFkZHkgU2VjdXJlIENlc
       nRpZmljYXRpb24gQXV0aG9yaXR5MREwDwYDVQQFEwgwNzk2OTI4NzCCASIwDQYJ
       KoZIhvcNAQEBBQADggEPADCCAQoCggEBAMQt1RWMnCZM7DI161+4WQFapmGBWTt
       wY6vj3D3HKrjJM9N55DrtPDAjhI6zMBS2sofDPZVUBJ7fmd0LJR4h3mUpfjWoqV
       Tr9vcyOdQmVZWt7/v+WIbXnvQAjYwqDL1CBM6nPwT27oDyqu9SoWlm2r4arV3aL
       GbqGmu75RpRSgAvSMeYddi5Kcju+GZtCpyz8/x4fKL4o/K1w/O5epHBp+YlLpyo
       7RJlbmr2EkRTcDCVw5wrWCs9CHRK8r5RsL+H0EwnWGu1NcWdrxcx+AuP7q2BNgW
       JCJjPOq8lh8BJ6qf9Z/dFjpfMFDniNoW1fho3/Rb2cRGadDAW/hOUoz+EDU8CAw
       EAAaOCATIwggEuMB0GA1UdDgQWBBT9rGEyk2xF1uLuhV+auud2mWjM5zAfBgNVH
       SMEGDAWgBTSxLDSkdRMEXGzYcs9of7dqGrU4zASBgNVHRMBAf8ECDAGAQH/AgEA
       MDMGCCsGAQUFBwEBBCcwJTAjBggrBgEFBQcwAYYXaHR0cDovL29jc3AuZ29kYWR
       keS5jb20wRgYDVR0fBD8wPTA7oDmgN4Y1aHR0cDovL2NlcnRpZmljYXRlcy5nb2
       RhZGR5LmNvbS9yZXBvc2l0b3J5L2dkcm9vdC5jcmwwSwYDVR0gBEQwQjBABgRVH
       SAAMDgwNgYIKwYBBQUHAgEWKmh0dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5j
       b20vcmVwb3NpdG9yeTAOBgNVHQ8BAf8EBAMCAQYwDQYJKoZIhvcNAQEFBQADggE
       BANKGwOy9+aG2Z+5mC6IGOgRQjhVyrEp0lVPLN8tESe8HkGsz2ZbwlFalEzAFPI
       UyIXvJxwqoJKSQ3kbTJSMUA2fCENZvD117esyfxVgqwcSeIaha86ykRvOe5GPLL
       5CkKSkB2XIsKd83ASe8T+5o0yGPwLPk9Qnt0hCqU7S+8MxZC9Y7lhyVJEnfzuz9
       p0iRFEUOOjZv2kWzRaJBydTXRE4+uXR21aITVSzGh6O1mawGhId/dQb8vxRMDsx
       uxN89txJx9OjxUUAiKEngHUuHqDTMBqLdElrRhjZkAzVvb3du6/KFUJheqwNTrZ
       EjYx8WnM25sgVjOuH0aBsXBTWVU+4=",
      "MIIE+zCCBGSgAwIBAgICAQ0wDQYJKoZIhvcNAQEFBQAwgbsxJDAiBgNVBAcTG1Z
       hbGlDZXJ0IFZhbGlkYXRpb24gTmV0d29yazEXMBUGA1UEChMOVmFsaUNlcnQsIE
       luYy4xNTAzBgNVBAsTLFZhbGlDZXJ0IENsYXNzIDIgUG9saWN5IFZhbGlkYXRpb
       24gQXV0aG9yaXR5MSEwHwYDVQQDExhodHRwOi8vd3d3LnZhbGljZXJ0LmNvbS8x
       IDAeBgkqhkiG9w0BCQEWEWluZm9AdmFsaWNlcnQuY29tMB4XDTA0MDYyOTE3MDY
       yMFoXDTI0MDYyOTE3MDYyMFowYzELMAkGA1UEBhMCVVMxITAfBgNVBAoTGFRoZS
       BHbyBEYWRkeSBHcm91cCwgSW5jLjExMC8GA1UECxMoR28gRGFkZHkgQ2xhc3MgM
       iBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTCCASAwDQYJKoZIhvcNAQEBBQADggEN
       ADCCAQgCggEBAN6d1+pXGEmhW+vXX0iG6r7d/+TvZxz0ZWizV3GgXne77ZtJ6XC
       APVYYYwhv2vLM0D9/AlQiVBDYsoHUwHU9S3/Hd8M+eKsaA7Ugay9qK7HFiH7Eux
       6wwdhFJ2+qN1j3hybX2C32qRe3H3I2TqYXP2WYktsqbl2i/ojgC95/5Y0V4evLO
       tXiEqITLdiOr18SPaAIBQi2XKVlOARFmR6jYGB0xUGlcmIbYsUfb18aQr4CUWWo
       riMYavx4A6lNf4DD+qta/KFApMoZFv6yyO9ecw3ud72a9nmYvLEHZ6IVDd2gWMZ
       Eewo+YihfukEHU1jPEX44dMX4/7VpkI+EdOqXG68CAQOjggHhMIIB3TAdBgNVHQ



<span class="grey">Jones, et al.                Standards Track                   [Page 53]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-54" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


       4EFgQU0sSw0pHUTBFxs2HLPaH+3ahq1OMwgdIGA1UdIwSByjCBx6GBwaSBvjCBu
       zEkMCIGA1UEBxMbVmFsaUNlcnQgVmFsaWRhdGlvbiBOZXR3b3JrMRcwFQYDVQQK
       Ew5WYWxpQ2VydCwgSW5jLjE1MDMGA1UECxMsVmFsaUNlcnQgQ2xhc3MgMiBQb2x
       pY3kgVmFsaWRhdGlvbiBBdXRob3JpdHkxITAfBgNVBAMTGGh0dHA6Ly93d3cudm
       FsaWNlcnQuY29tLzEgMB4GCSqGSIb3DQEJARYRaW5mb0B2YWxpY2VydC5jb22CA
       QEwDwYDVR0TAQH/BAUwAwEB/zAzBggrBgEFBQcBAQQnMCUwIwYIKwYBBQUHMAGG
       F2h0dHA6Ly9vY3NwLmdvZGFkZHkuY29tMEQGA1UdHwQ9MDswOaA3oDWGM2h0dHA
       6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS9yb290LmNybD
       BLBgNVHSAERDBCMEAGBFUdIAAwODA2BggrBgEFBQcCARYqaHR0cDovL2NlcnRpZ
       mljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5MA4GA1UdDwEB/wQEAwIBBjAN
       BgkqhkiG9w0BAQUFAAOBgQC1QPmnHfbq/qQaQlpE9xXUhUaJwL6e4+PrxeNYiY+
       Sn1eocSxI0YGyeR+sBjUZsE4OWBsUs5iB0QQeyAfJg594RAoYC5jcdnplDQ1tgM
       QLARzLrUc+cb53S8wGd9D0VmsfSxOaFIqII6hR8INMqzW/Rn453HWkrugp++85j
       09VZw==",
      "MIIC5zCCAlACAQEwDQYJKoZIhvcNAQEFBQAwgbsxJDAiBgNVBAcTG1ZhbGlDZXJ
       0IFZhbGlkYXRpb24gTmV0d29yazEXMBUGA1UEChMOVmFsaUNlcnQsIEluYy4xNT
       AzBgNVBAsTLFZhbGlDZXJ0IENsYXNzIDIgUG9saWN5IFZhbGlkYXRpb24gQXV0a
       G9yaXR5MSEwHwYDVQQDExhodHRwOi8vd3d3LnZhbGljZXJ0LmNvbS8xIDAeBgkq
       hkiG9w0BCQEWEWluZm9AdmFsaWNlcnQuY29tMB4XDTk5MDYyNjAwMTk1NFoXDTE
       5MDYyNjAwMTk1NFowgbsxJDAiBgNVBAcTG1ZhbGlDZXJ0IFZhbGlkYXRpb24gTm
       V0d29yazEXMBUGA1UEChMOVmFsaUNlcnQsIEluYy4xNTAzBgNVBAsTLFZhbGlDZ
       XJ0IENsYXNzIDIgUG9saWN5IFZhbGlkYXRpb24gQXV0aG9yaXR5MSEwHwYDVQQD
       ExhodHRwOi8vd3d3LnZhbGljZXJ0LmNvbS8xIDAeBgkqhkiG9w0BCQEWEWluZm9
       AdmFsaWNlcnQuY29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDOOnHK5a
       vIWZJV16vYdA757tn2VUdZZUcOBVXc65g2PFxTXdMwzzjsvUGJ7SVCCSRrCl6zf
       N1SLUzm1NZ9WlmpZdRJEy0kTRxQb7XBhVQ7/nHk01xC+YDgkRoKWzk2Z/M/VXwb
       P7RfZHM047QSv4dk+NoS/zcnwbNDu+97bi5p9wIDAQABMA0GCSqGSIb3DQEBBQU
       AA4GBADt/UG9vUJSZSWI4OB9L+KXIPqeCgfYrx+jFzug6EILLGACOTb2oWH+heQ
       C1u+mNr0HZDzTuIYEZoDJJKPTEjlbVUjP9UNV+mWwD5MlM/Mtsq2azSiGM5bUMM
       j4QssxsodyamEwCW/POuZ6lcg5Ktz885hZo+L7tdEy8W9ViH0Pd"]





















<span class="grey">Jones, et al.                Standards Track                   [Page 54]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-55" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h2"><a class="selflink" id="appendix-C" href="#appendix-C">Appendix C</a>.  Notes on Implementing base64url Encoding without Padding</span>

   This appendix describes how to implement base64url encoding and
   decoding functions without padding based upon standard base64
   encoding and decoding functions that do use padding.

   To be concrete, example C# code implementing these functions is shown
   below.  Similar code could be used in other languages.

     static string base64urlencode(byte [] arg)
     {
       string s = Convert.ToBase64String(arg); // Regular base64 encoder
       s = s.Split('=')[0]; // Remove any trailing '='s
       s = s.Replace('+', '-'); // 62nd char of encoding
       s = s.Replace('/', '_'); // 63rd char of encoding
       return s;
     }

     static byte [] base64urldecode(string arg)
     {
       string s = arg;
       s = s.Replace('-', '+'); // 62nd char of encoding
       s = s.Replace('_', '/'); // 63rd char of encoding
       switch (s.Length % 4) // Pad with trailing '='s
       {
         case 0: break; // No pad chars in this case
         case 2: s += "=="; break; // Two pad chars
         case 3: s += "="; break; // One pad char
         default: throw new System.Exception(
           "Illegal base64url string!");
       }
       return Convert.FromBase64String(s); // Standard base64 decoder
     }

   As per the example code above, the number of '=' padding characters
   that needs to be added to the end of a base64url-encoded string
   without padding to turn it into one with padding is a deterministic
   function of the length of the encoded string.  Specifically, if the
   length mod 4 is 0, no padding is added; if the length mod 4 is 2, two
   '=' padding characters are added; if the length mod 4 is 3, one '='
   padding character is added; if the length mod 4 is 1, the input is
   malformed.









<span class="grey">Jones, et al.                Standards Track                   [Page 55]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-56" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   An example correspondence between unencoded and encoded values
   follows.  The octet sequence below encodes into the string below,
   which when decoded, reproduces the octet sequence.

   3 236 255 224 193
   A-z_4ME

<span class="h2"><a class="selflink" id="appendix-D" href="#appendix-D">Appendix D</a>.  Notes on Key Selection</span>

   This appendix describes a set of possible algorithms for selecting
   the key to be used to validate the digital signature or MAC of a JWS
   or for selecting the key to be used to decrypt a JWE.  This guidance
   describes a family of possible algorithms rather than a single
   algorithm, because in different contexts, not all the sources of keys
   will be used, they can be tried in different orders, and sometimes
   not all the collected keys will be tried; hence, different algorithms
   will be used in different application contexts.

   The steps below are described for illustration purposes only;
   specific applications can and are likely to use different algorithms
   or perform some of the steps in different orders.  Specific
   applications will frequently have a much simpler method of
   determining the keys to use, as there may be one or two key selection
   methods that are profiled for the application's use.  This appendix
   supplements the normative information on key location in <a href="#section-6">Section 6</a>.

   These algorithms include the following steps.  Note that the steps
   can be performed in any order and do not need to be treated as
   distinct.  For example, keys can be tried as soon as they are found,
   rather than collecting all the keys before trying any.

   1.  Collect the set of potentially applicable keys.  Sources of keys
       may include:

       *  Keys supplied by the application protocol being used.

       *  Keys referenced by the "jku" (JWK Set URL) Header Parameter.

       *  The key provided by the "jwk" (JSON Web Key) Header Parameter.

       *  The key referenced by the "x5u" (X.509 URL) Header Parameter.

       *  The key provided by the "x5c" (X.509 certificate chain) Header
          Parameter.

       *  Other applicable keys available to the application.





<span class="grey">Jones, et al.                Standards Track                   [Page 56]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-57" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


       The order for collecting and trying keys from different key
       sources is typically application dependent.  For example,
       frequently, all keys from a one set of locations, such as local
       caches, will be tried before collecting and trying keys from
       other locations.

   2.  Filter the set of collected keys.  For instance, some
       applications will use only keys referenced by "kid" (key ID) or
       "x5t" (X.509 certificate SHA-1 thumbprint) parameters.  If the
       application uses the JWK "alg" (algorithm), "use" (public key
       use), or "key_ops" (key operations) parameters, keys with
       inappropriate values of those parameters would be excluded.
       Additionally, keys might be filtered to include or exclude keys
       with certain other member values in an application-specific
       manner.  For some applications, no filtering will be applied.

   3.  Order the set of collected keys.  For instance, keys referenced
       by "kid" (key ID) or "x5t" (X.509 certificate SHA-1 thumbprint)
       parameters might be tried before keys with neither of these
       values.  Likewise, keys with certain member values might be
       ordered before keys with other member values.  For some
       applications, no ordering will be applied.

   4.  Make trust decisions about the keys.  Signatures made with keys
       not meeting the application's trust criteria would not be
       accepted.  Such criteria might include, but is not limited to,
       the source of the key, whether the TLS certificate validates for
       keys retrieved from URLs, whether a key in an X.509 certificate
       is backed by a valid certificate chain, and other information
       known by the application.

   5.  Attempt signature or MAC validation for a JWS or decryption of a
       JWE with some or all of the collected and possibly filtered and/
       or ordered keys.  A limit on the number of keys to be tried might
       be applied.  This process will normally terminate following a
       successful validation or decryption.

   Note that it is reasonable for some applications to perform signature
   or MAC validation prior to making a trust decision about a key, since
   keys for which the validation fails need no trust decision.











<span class="grey">Jones, et al.                Standards Track                   [Page 57]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-58" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h2"><a class="selflink" id="appendix-E" href="#appendix-E">Appendix E</a>.  Negative Test Case for "crit" Header Parameter</span>

   Conforming implementations must reject input containing critical
   extensions that are not understood or cannot be processed.  The
   following JWS must be rejected by all implementations, because it
   uses an extension Header Parameter name "<a href="http://example.invalid/UNDEFINED">http://example.invalid/</a>
   <a href="http://example.invalid/UNDEFINED">UNDEFINED</a>" that they do not understand.  Any other similar input, in
   which the use of the value "<a href="http://example.invalid/UNDEFINED">http://example.invalid/UNDEFINED</a>" is
   substituted for any other Header Parameter name not understood by the
   implementation, must also be rejected.

   The JWS Protected Header value for this JWS is:

     {"alg":"none",
      "crit":["<a href="http://example.invalid/UNDEFINED">http://example.invalid/UNDEFINED</a>"],
      "<a href="http://example.invalid/UNDEFINED">http://example.invalid/UNDEFINED</a>":true
     }

   The complete JWS that must be rejected is as follows (with line
   breaks for display purposes only):

     eyJhbGciOiJub25lIiwNCiAiY3JpdCI6WyJodHRwOi8vZXhhbXBsZS5jb20vVU5ERU
     ZJTkVEIl0sDQogImh0dHA6Ly9leGFtcGxlLmNvbS9VTkRFRklORUQiOnRydWUNCn0.
     RkFJTA.

<span class="h2"><a class="selflink" id="appendix-F" href="#appendix-F">Appendix F</a>.  Detached Content</span>

   In some contexts, it is useful to integrity-protect content that is
   not itself contained in a JWS.  One way to do this is to create a JWS
   in the normal fashion using a representation of the content as the
   payload but then delete the payload representation from the JWS and
   send this modified object to the recipient rather than the JWS.  When
   using the JWS Compact Serialization, the deletion is accomplished by
   replacing the second field (which contains BASE64URL(JWS Payload))
   value with the empty string; when using the JWS JSON Serialization,
   the deletion is accomplished by deleting the "payload" member.  This
   method assumes that the recipient can reconstruct the exact payload
   used in the JWS.  To use the modified object, the recipient
   reconstructs the JWS by re-inserting the payload representation into
   the modified object and uses the resulting JWS in the usual manner.
   Note that this method needs no support from JWS libraries, as
   applications can use this method by modifying the inputs and outputs
   of standard JWS libraries.








<span class="grey">Jones, et al.                Standards Track                   [Page 58]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-59" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


Acknowledgements

   Solutions for signing JSON content were previously explored by Magic
   Signatures [<a href="#ref-MagicSignatures">MagicSignatures</a>], JSON Simple Sign [<a href="#ref-JSS" title="&quot;JSON Simple Sign&quot;">JSS</a>], and Canvas
   Applications [<a href="#ref-CanvasApp" title="&quot;Canvas Applications&quot;">CanvasApp</a>], all of which influenced this document.

   Thanks to Axel Nennker for his early implementation and feedback on
   the JWS and JWE specifications.

   This specification is the work of the JOSE working group, which
   includes dozens of active and dedicated participants.  In particular,
   the following individuals contributed ideas, feedback, and wording
   that influenced this specification:

   Dirk Balfanz, Richard Barnes, Brian Campbell, Alissa Cooper, Breno de
   Medeiros, Stephen Farrell, Yaron Y. Goland, Dick Hardt, Joe
   Hildebrand, Jeff Hodges, Russ Housley, Edmund Jay, Tero Kivinen, Ben
   Laurie, Ted Lemon, James Manger, Matt Miller, Kathleen Moriarty, Tony
   Nadalin, Hideki Nara, Axel Nennker, John Panzer, Ray Polk, Emmanuel
   Raviart, Eric Rescorla, Pete Resnick, Jim Schaad, Paul Tarjan, Hannes
   Tschofenig, and Sean Turner.

   Jim Schaad and Karen O'Donoghue chaired the JOSE working group and
   Sean Turner, Stephen Farrell, and Kathleen Moriarty served as
   Security Area Directors during the creation of this specification.

Authors' Addresses

   Michael B. Jones
   Microsoft

   EMail: mbj@microsoft.com
   URI:   <a href="http://self-issued.info/">http://self-issued.info/</a>


   John Bradley
   Ping Identity

   EMail: ve7jtb@ve7jtb.com
   URI:   <a href="http://www.thread-safe.com/">http://www.thread-safe.com/</a>


   Nat Sakimura
   Nomura Research Institute

   EMail: n-sakimura@nri.co.jp
   URI:   <a href="http://nat.sakimura.org/">http://nat.sakimura.org/</a>




Jones, et al.                Standards Track                   [Page 59]
</pre>

</body>
</html>

