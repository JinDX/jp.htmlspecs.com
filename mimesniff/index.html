<!doctype html>
<html lang="ja-JP">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <meta content="#3c790a" name="theme-color">
    <meta content="light dark" name="color-scheme">
    <title>MIMEスニッフィング標準</title>
    <link crossorigin href="https://resources.whatwg.org/standard-shared-with-dev.css" rel="stylesheet">
    <link crossorigin href="https://resources.whatwg.org/standard.css" rel="stylesheet">
    <link crossorigin href="https://resources.whatwg.org/spec.css" rel="stylesheet">
    <link crossorigin href="https://resources.whatwg.org/logo-mimesniff.svg" rel="icon">
    <script crossorigin defer src="https://resources.whatwg.org/commit-snapshot-shortcut-key.js"></script>
    <!-- <meta content="Bikeshed version 7a96e07ec, updated Mon Jul 14 11:12:36 2025 -0700" name="generator">
    <meta content="1e18dd2c442d3fa249c80c4aaa778e9053ba1477" name="revision"> -->
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-var-click-highlighting */
        /*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)

For darkmode:
0 = oklab(50%   0%  108%)
1 = oklab(50% -51%   51%)
2 = oklab(50% -64%  -20%)
3 = oklab(50%   6%   19%)
4 = oklab(50% -12%  -64%)
5 = oklab(50%  44%  -19%)  
6 = oklab(50% 102%   38%)
*/

        [data-algorithm] var {
            cursor: pointer;
        }

        var[data-var-color] {
            background-color: var(--var-bg);
            box-shadow: 0 0 0 2px var(--var-bg);
        }

        var[data-var-color] {
            --var-bg: #F4D200;
        }

        var[data-var-color="1"] {
            --var-bg: #FF87A2;
        }

        var[data-var-color="2"] {
            --var-bg: #96E885;
        }

        var[data-var-color="3"] {
            --var-bg: #3EEED2;
        }

        var[data-var-color="4"] {
            --var-bg: #EACFB6;
        }

        var[data-var-color="5"] {
            --var-bg: #82DDFF;
        }

        var[data-var-color="6"] {
            --var-vg: #FFBCF2;
        }

        @media (prefers-color-scheme: dark) {
            var[data-var-color] {
                --var-bg: #bc1a00;
            }

            var[data-var-color="1"] {
                --var-bg: #007f00;
            }

            var[data-var-color="2"] {
                --var-bg: #008698;
            }

            var[data-var-color="3"] {
                --var-bg: #7f5b2b;
            }

            var[data-var-color="4"] {
                --var-bg: #004df3;
            }

            var[data-var-color="5"] {
                --var-bg: #a1248a;
            }

            var[data-var-color="6"] {
                --var-vg: #ff0000;
            }
        }
    </style>

<body class="h-entry status-LS">
    <div class="head">

        <a class="logo" href="https://whatwg.org/">
            <img alt="WHATWG" class="darkmode-aware" crossorigin height="100"
                src="https://resources.whatwg.org/logo-mimesniff.svg">
        </a>

        <hgroup>
            <h1 class="p-name no-ref" id="title">MIMEスニッフィング</h1>
            <p id="subtitle">現行標準 — 最終更新 <time class="dt-updated" datetime="2025-08-12">2025年8月12日</time>
            </p>
        </hgroup>
        <div data-fill-with="spec-metadata">
            <dl>
                <dt>参加方法:
                <dd><a href="https://github.com/whatwg/mimesniff">GitHub whatwg/mimesniff</a> (<a
                        href="https://github.com/whatwg/mimesniff/issues/new/choose">新しいIssue</a>, <a
                        href="https://github.com/whatwg/mimesniff/issues">オープン中のIssue</a>)
                <dd><a href="https://whatwg.org/chat">Matrixでチャット</a>
                <dt>コミット履歴:
                <dd><a href="https://github.com/whatwg/mimesniff/commits">GitHub whatwg/mimesniff/commits</a>
                <dd><a href="https://mimesniff.spec.whatwg.org/commit-snapshots/e7594d531819053508447f688a3bde465531aca5/"
                        id="commit-snapshot-link">このコミット時点のスナップショット</a>
                <dd><a href="https://twitter.com/mimesniff">@mimesniff</a>
                <dt>テスト:
                <dd><a href="https://github.com/web-platform-tests/wpt/tree/master/mimesniff">web-platform-tests
                        mimesniff/</a> (<a href="https://github.com/web-platform-tests/wpt/labels/mimesniff">継続中の作業</a>)
                <dt>翻訳 <small>(参考資料)</small>:
                <dd><span title="Japanese"><a href="https://triple-underscore.github.io/mimesniff-ja.html" hreflang="ja"
                            lang="ja" rel="alternate">日本語</a></span>
                <dd><span title="Simplified Chinese"><a href="https://htmlspecs.com/mimesniff/" hreflang="zh-hans"
                            lang="zh-hans" rel="alternate">简体中文</a></span>
                <dd><span title="Korean"><a href="https://ko.htmlspecs.com/mimesniff/" hreflang="ko" lang="ko"
                            rel="alternate">한국어</a></span>
            </dl>
        </div>
        <div data-fill-with="warning"></div>
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">概要</span></h2>
        <p>MIMEスニッフィング標準は、リソースのスニッフィング方法を定義します。</p>
    </div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目次</h2>
        <ol class="toc" role="directory">
            <li><a href="#introduction"><span class="secno">1</span> <span class="content">はじめに</span></a>
            <li><a href="#conformance-requirements"><span class="secno">2</span> <span class="content">適合性要件</span></a>
            <li><a href="#terminology"><span class="secno">3</span> <span class="content">用語</span></a>
            <li>
                <a href="#understanding-mime-types"><span class="secno">4</span> <span
                        class="content">MIMEタイプ</span></a>
                <ol class="toc">
                    <li><a href="#mime-type-representation"><span class="secno">4.1</span> <span
                                class="content">MIMEタイプの表現</span></a>
                    <li><a href="#mime-type-miscellaneous"><span class="secno">4.2</span> <span class="content">MIMEタイプ
                                その他</span></a>
                    <li><a href="#mime-type-writing"><span class="secno">4.3</span> <span
                                class="content">MIMEタイプの記述</span></a>
                    <li><a href="#parsing-a-mime-type"><span class="secno">4.4</span> <span
                                class="content">MIMEタイプの構文解析</span></a>
                    <li><a href="#serializing-a-mime-type"><span class="secno">4.5</span> <span
                                class="content">MIMEタイプの直列化</span></a>
                    <li><a href="#mime-type-groups"><span class="secno">4.6</span> <span
                                class="content">MIMEタイプのグループ</span></a>
                </ol>
            <li>
                <a href="#handling-a-resource"><span class="secno">5</span> <span class="content">リソースの取り扱い</span></a>
                <ol class="toc">
                    <li><a href="#interpreting-the-resource-metadata"><span class="secno">5.1</span> <span
                                class="content">リソースメタデータの解釈</span></a>
                    <li><a href="#reading-the-resource-header"><span class="secno">5.2</span> <span
                                class="content">リソースヘッダーの読み取り</span></a>
                </ol>
            <li>
                <a href="#matching-a-mime-type-pattern"><span class="secno">6</span> <span
                        class="content">MIMEタイプパターンの照合</span></a>
                <ol class="toc">
                    <li><a href="#matching-an-image-type-pattern"><span class="secno">6.1</span> <span
                                class="content">画像タイプパターンの照合</span></a>
                    <li>
                        <a href="#matching-an-audio-or-video-type-pattern"><span class="secno">6.2</span> <span
                                class="content">音声/動画タイプパターンの照合</span></a>
                        <ol class="toc">
                            <li><a href="#signature-for-mp4"><span class="secno">6.2.1</span> <span
                                        class="content">MP4のシグネチャ</span></a>
                            <li><a href="#signature-for-webm"><span class="secno">6.2.2</span> <span
                                        class="content">WebMのシグネチャ</span></a>
                            <li><a href="#signature-for-mp3-without-id3"><span class="secno">6.2.3</span> <span
                                        class="content">ID3なしMP3のシグネチャ</span></a>
                        </ol>
                    <li><a href="#matching-a-font-type-pattern"><span class="secno">6.3</span> <span
                                class="content">フォントタイプパターンの照合</span></a>
                    <li><a href="#matching-an-archive-type-pattern"><span class="secno">6.4</span> <span
                                class="content">アーカイブタイプパターンの照合</span></a>
                </ol>
            <li>
                <a href="#determining-the-computed-mime-type-of-a-resource"><span class="secno">7</span> <span
                        class="content">リソースの計算されたMIMEタイプの決定</span></a>
                <ol class="toc">
                    <li><a href="#identifying-a-resource-with-an-unknown-mime-type"><span class="secno">7.1</span> <span
                                class="content">未知のMIMEタイプのリソースの識別</span></a>
                    <li><a href="#sniffing-a-mislabeled-binary-resource"><span class="secno">7.2</span> <span
                                class="content">誤ラベルのバイナリリソースのスニッフィング</span></a>
                </ol>
            <li>
                <a href="#context-specific-sniffing"><span class="secno">8</span> <span
                        class="content">コンテキスト固有のスニッフィング</span></a>
                <ol class="toc">
                    <li><a href="#sniffing-in-a-browsing-context"><span class="secno">8.1</span> <span
                                class="content">ブラウジングコンテキストでのスニッフィング</span></a>
                    <li><a href="#sniffing-in-an-image-context"><span class="secno">8.2</span> <span
                                class="content">画像コンテキストでのスニッフィング</span></a>
                    <li><a href="#sniffing-in-an-audio-or-video-context"><span class="secno">8.3</span> <span
                                class="content">音声/動画コンテキストでのスニッフィング</span></a>
                    <li><a href="#sniffing-in-a-plugin-context"><span class="secno">8.4</span> <span
                                class="content">プラグインコンテキストでのスニッフィング</span></a>
                    <li><a href="#sniffing-in-a-style-context"><span class="secno">8.5</span> <span
                                class="content">スタイルコンテキストでのスニッフィング</span></a>
                    <li><a href="#sniffing-in-a-script-context"><span class="secno">8.6</span> <span
                                class="content">スクリプトコンテキストでのスニッフィング</span></a>
                    <li><a href="#sniffing-in-a-font-context"><span class="secno">8.7</span> <span
                                class="content">フォントコンテキストでのスニッフィング</span></a>
                    <li><a href="#sniffing-in-a-text-track-context"><span class="secno">8.8</span> <span
                                class="content">テキストトラックコンテキストでのスニッフィング</span></a>
                    <li><a href="#sniffing-in-a-cache-manifest-context"><span class="secno">8.9</span> <span
                                class="content">キャッシュマニフェストコンテキストでのスニッフィング</span></a>
                </ol>
            <li><a href="#acknowledgements"><span class="secno"></span> <span class="content">謝辞</span></a>
            <li><a href="#ipr"><span class="secno"></span> <span class="content">知的財産権</span></a>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本仕様で定義される用語</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">参照先で定義される用語</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">規定参考文献</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">参考情報</span></a>
                </ol>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span
                class="content">はじめに</span><a class="self-link" href="#introduction"></a></h2>
        <p>
            HTTPの<code>Content-Type</code>ヘッダー・フィールドは、HTTPレスポンスのMIMEタイプを示すことを意図しています。
            しかし、多くのHTTPサーバーは、<code>Content-Type</code>ヘッダー・フィールドの値が、実際のレスポンス内容と一致していません。
            歴史的に、Webブラウザーはこれらのサーバーに対応するため、HTTPレスポンスの内容を<code>Content-Type</code>ヘッダー・フィールドと併せて調査し、レスポンスの実効MIMEタイプを判定してきました。
        </p>
        <p>
            MIMEタイプの「スニッフィング」方法に関する明確な仕様がないため、各ユーザーエージェントは他のユーザーエージェントのアルゴリズムをリバースエンジニアリングすることを余儀なくされ、相互運用性を維持しようとしてきました。
            当然ながら、これらの試みは完全には成功せず、ユーザーエージェント間で異なる挙動が生じています。
            場合によっては、こうした挙動の違いがセキュリティ上の問題を引き起こし、ユーザーエージェントがサーバーの意図と異なるMIMEタイプでHTTPレスポンスを解釈することがありました。
        </p>
        <p>
            これらのセキュリティ問題は、「正直な」サーバーが悪意ある利用者にファイルのアップロードを許し、その内容を低権限のMIMEタイプで配信する場合に特に深刻です。
            例えば、サーバーがアップロードされたファイルを画像として扱う（したがって無害とみなす）と信じていても、ユーザーエージェントがその内容をHTMLと判断し（結果として含まれるスクリプトを実行できる）、攻撃者がユーザーの認証情報を盗んだり、クロスサイトスクリプティング攻撃を仕掛けたりする可能性があります。
            （悪意あるサーバーは、もちろん<code>Content-Type</code>ヘッダー・フィールドに任意のMIMEタイプを指定できます。）
        </p>
        <p>
            この文書では、ユーザーエージェントの互換性ニーズと既存Webコンテンツがもたらすセキュリティ制約とのバランスを慎重に考慮したコンテンツスニッフィング・アルゴリズムについて説明します。
            このアルゴリズムは、Adam Barth、Juan Caballero、Dawn
            Songによる調査に基づいており、主要なユーザーエージェントに実装されたコンテンツスニッフィング・アルゴリズム、既存Webコンテンツの広範なデータベース、および多数のユーザーに展開された実装から収集されたメトリクスが活用されています。
            <a data-link-type="biblio" href="#biblio-seccontsniff"
                title="Secure Content Sniffing for Web Browsers, or How to Stop Papers from Reviewing Themselves">[SECCONTSNIFF]</a>
        </p>
        <h2 class="heading settled" data-level="2" id="conformance-requirements"><span class="secno">2. </span><span
                class="content">適合性要件</span><a class="self-link" href="#conformance-requirements"></a></h2>
        <p>
            本文書中の "MUST"、"MUST NOT"、"REQUIRED"、"SHALL"、"SHALL NOT"、"SHOULD"、"SHOULD NOT"、"RECOMMENDED"、"NOT
            RECOMMENDED"、"MAY"、"OPTIONAL" というキーワードは、RFC 2119の定義に従い解釈されます。
            可読性のため、これらのキーワードは通常すべて大文字では記載しません。
            <a data-link-type="biblio" href="#biblio-keywords"
                title="Key words for use in RFCs to Indicate Requirement Levels">[KEYWORDS]</a>
        </p>
        <p>
            アルゴリズムの一部として命令形で記述された要件（例："先頭の空白文字を除去する" や "偽を返してこれらの手順を中止する"）は、アルゴリズムの導入に使用されたキーワードの意味で解釈されます。
        </p>
        <p>
            アルゴリズムや特定の手順として記述された適合性要件は、最終的な結果が同等であればどのような方法で実装しても構いません。
            特に、本仕様で定義されたアルゴリズムは理解しやすさを重視しており、性能を重視しているわけではないことに留意してください。
        </p>
        <h2 class="heading settled" data-level="3" id="terminology"><span class="secno">3. </span><span
                class="content">用語</span><a class="self-link" href="#terminology"></a></h2>
        <p>
            本仕様はInfra標準に依存しています。<a data-link-type="biblio" href="#biblio-infra" title="Infra Standard">[INFRA]</a>
        </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="http-token-code-point">HTTPトークンコードポイント</dfn>は、U+0021 (!)、U+0023 (#)、U+0024 ($)、U+0025 (%)、
            U+0026 (&amp;)、U+0027 (')、U+002A (*)、U+002B (+)、U+002D (-)、U+002E (.)、U+005E (^)、U+005F (_)、
            U+0060 (`)、U+007C (|)、U+007E (~)、または <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ascii-alphanumeric" id="ref-for-ascii-alphanumeric">ASCII英数字</a>です。
        </p>
        <p class="note" role="note">これは <a data-link-type="dfn"
                href="https://www.rfc-editor.org/rfc/rfc9110#name-tokens" id="ref-for-name-tokens">token</a>
            トークン生成規則の値空間と一致します。<a data-link-type="biblio" href="#biblio-http-semantics"
                title="HTTP Semantics">[HTTP-SEMANTICS]</a>
        </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="http-quoted-string-token-code-point">HTTP引用文字列トークンコードポイント</dfn>は、U+0009 TAB、範囲U+0020 SPACE〜U+007E
            (~)の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#code-point"
                id="ref-for-code-point">コードポイント</a>、または範囲U+0080〜
            U+00FF (ÿ)の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#code-point"
                id="ref-for-code-point①">コードポイント</a>です。
        </p>
        <p class="note" role="note">これは <a data-link-type="dfn"
                href="https://www.rfc-editor.org/rfc/rfc9110#name-quoted-strings"
                id="ref-for-name-quoted-strings">quoted-string</a> トークン生成規則の有効な値空間に一致します。定義上、<a data-link-type="dfn"
                href="#http-token-code-point" id="ref-for-http-token-code-point">HTTPトークンコードポイント</a>の上位集合です。<a
                data-link-type="biblio" href="#biblio-http-semantics" title="HTTP Semantics">[HTTP-SEMANTICS]</a>
        </p>
        <p>
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="binary-data-byte">バイナリデータバイト</dfn>は、
            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte">バイト</a>が0x00〜0x08
            (NUL〜BS)、0x0B (VT)、0x0E〜0x1A (SO〜SUB)、
            または0x1C〜0x1F (FS〜US)の範囲にあるものです。
        </p>
        <p>
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="whitespace-byte">空白バイト</dfn>
            （略称<abbr data-lt="whitespace byte">0xWS</abbr>）は、以下のいずれかの
            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte④">バイト</a>です：0x09
            (HT)、0x0A (LF)、0x0C (FF)、0x0D (CR)、
            0x20 (SP)。
        </p>
        <p>
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="tag-terminating-byte">タグ終端バイト</dfn>
            （略称<abbr data-lt="tag terminating byte">0xTT</abbr>）は、以下のいずれかの
            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte⑤">バイト</a>です：0x20
            (SP)、0x3E ("<code>></code>")。
        </p>
        <p>
            式中の演算子は<a data-link-type="biblio" href="#biblio-encoding"
                title="Encoding Standard">[ENCODING]</a>で定義されている数学演算子を使用します。加えて、ビット単位のNOTは ~ で表されます。
        </p>
        <h2 class="heading settled" data-level="4" id="understanding-mime-types"><span class="secno">4. </span><span
                class="content">MIMEタイプ</span><a class="self-link" href="#understanding-mime-types"></a></h2>
        <h3 class="heading settled" data-level="4.1" id="mime-type-representation"><span class="secno">4.1. </span><span
                class="content">MIMEタイプの表現</span><a class="self-link" href="#mime-type-representation"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="MIME type|MIME type record"
                id="mime-type">MIMEタイプ</dfn>は、
            <i>インターネットメディアタイプ</i>（<cite>Multipurpose Internet Mail Extensions (MIME) Part Two: Media
                Types</cite>で定義）を表現します。また、<a data-link-type="dfn" href="#mime-type"
                id="ref-for-mime-type">MIMEタイプレコード</a>とも呼ばれます。<a data-link-type="biblio" href="#biblio-mimetype"
                title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">[MIMETYPE]</a>
        </p>
        <p class="note" role="note">標準類は混乱を避けるために、一貫して<a data-link-type="dfn" href="#mime-type"
                id="ref-for-mime-type①">MIMEタイプ</a>という用語を使用することが推奨されます。これは<cite>Media
                Queries</cite>で記述される<i>メディアタイプ</i>の使用と混同しないためです。
            <a data-link-type="biblio" href="#biblio-mediaqueries" title="Media Queries Level 4">[MEDIAQUERIES]</a>
        </p>
        <p><a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②">MIMEタイプ</a>の<dfn class="dfn-paneled"
                data-dfn-for="MIME type" data-dfn-type="dfn" data-export id="type">type</dfn>は、空でない
            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                id="ref-for-ascii-string">ASCII文字列</a>です。
        </p>
        <p><a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type③">MIMEタイプ</a>の<dfn class="dfn-paneled"
                data-dfn-for="MIME type" data-dfn-type="dfn" data-export id="subtype">subtype</dfn>は、空でない
            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                id="ref-for-ascii-string①">ASCII文字列</a>です。
        </p>
        <p><a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type④">MIMEタイプ</a>の<dfn class="dfn-paneled"
                data-dfn-for="MIME type" data-dfn-type="dfn" data-export id="parameters">parameters</dfn>は、
            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
                id="ref-for-ordered-map">順序付きマップ</a>であり、<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#map-getting-the-keys" id="ref-for-map-getting-the-keys">キー</a>は<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                id="ref-for-ascii-string②">ASCII文字列</a>、<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#map-getting-the-values"
                id="ref-for-map-getting-the-values">値</a>は<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#string" id="ref-for-string">文字列</a>であり、
            <a data-link-type="dfn" href="#http-quoted-string-token-code-point"
                id="ref-for-http-quoted-string-token-code-point">HTTP引用文字列トークンコードポイント</a>に制限されています。初期値は空です。
        </p>
        <h3 class="heading settled" data-level="4.2" id="mime-type-miscellaneous"><span class="secno">4.2. </span><span
                class="content">MIMEタイプ その他</span><a class="self-link" href="#mime-type-miscellaneous"></a>
        </h3>
        <p><a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type⑤">MIMEタイプ</a><var>mimeType</var>の<dfn
                class="dfn-paneled" data-dfn-for="MIME type" data-dfn-type="dfn" data-export
                id="mime-type-essence">本質</dfn>は、
            <var>mimeType</var>の<a data-link-type="dfn" href="#type"
                id="ref-for-type">type</a>、U+002F（/）、<var>mimeType</var>の<a data-link-type="dfn" href="#subtype"
                id="ref-for-subtype">subtype</a>の順で構成されます。
        </p>
        <p><a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type⑥">MIMEタイプ</a>は、<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-export id="supported-by-the-user-agent">ユーザーエージェントがサポートする</dfn>場合、
            ユーザーエージェントがその<a data-link-type="dfn" href="#resource"
                id="ref-for-resource">リソース</a>を解釈し、ユーザーに提示できる機能を持つことを意味します。
        </p>
        <p class="XXX">理想的には、より厳密に記述すべきです。<a href="https://github.com/w3c/preload/issues/113">w3c/preload #113</a>
        </p>
        <div class="algorithm" data-algorithm="minimize a supported MIME type">
            <p><a class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="minimize-a-supported-mime-type">ユーザーエージェントがサポートするMIMEタイプを最小化する</a>には、<a data-link-type="dfn"
                    href="#mime-type" id="ref-for-mime-type⑧">MIMEタイプ</a><var>mimeType</var>を受け取り、以下の手順を実行します。返す値は<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                    id="ref-for-ascii-string③">ASCII文字列</a>です。
            </p>
            <ol>
                <li>
                    <p><var>mimeType</var>が<a data-link-type="dfn" href="#javascript-mime-type"
                            id="ref-forvascript-mime-type">JavaScript
                            MIMEタイプ</a>なら、"<code>text/javascript</code>"を返す。
                    </p>
                <li>
                    <p><var>mimeType</var>が<a data-link-type="dfn" href="#json-mime-type"
                            id="ref-for-json-mime-type">JSON MIMEタイプ</a>なら、"<code>application/json</code>"を返す。
                    </p>
                <li>
                    <p><var>mimeType</var>の<a data-link-type="dfn" href="#mime-type-essence"
                            id="ref-for-mime-type-essence">本質</a>が"<code>image/svg+xml</code>"なら、"<code>image/svg+xml</code>"を返す。
                    </p>
                    <p class="note" role="note">SVGは他の<a data-link-type="dfn" href="#xml-mime-type"
                            id="ref-for-xml-mime-type">XML MIMEタイプ</a>と区別する価値があります。
                    </p>
                <li>
                    <p><var>mimeType</var>が<a data-link-type="dfn" href="#xml-mime-type" id="ref-for-xml-mime-type①">XML
                            MIMEタイプ</a>なら、"<code>application/xml</code>"を返す。
                    </p>
                <li>
                    <p><var>mimeType</var>が<a data-link-type="dfn" href="#supported-by-the-user-agent"
                            id="ref-for-supported-by-the-user-agent">ユーザーエージェントがサポートする</a>なら、<var>mimeType</var>の<a
                            data-link-type="dfn" href="#mime-type-essence" id="ref-for-mime-type-essence①">本質</a>を返す。
                    </p>
                <li>
                    <p>空文字列を返す。
                    </p>
            </ol>
            <p class="note" role="note">このアルゴリズムの目的は、GIFとPNGなど処理モデルが異なるMIMEタイプを識別できるようにすることですが、それ以外は可能な限り情報を少なくすることです。
            </p>
        </div>
        <h3 class="heading settled" data-level="4.3" id="mime-type-writing"><span class="secno">4.3. </span><span
                class="content">MIMEタイプの記述</span><a class="self-link" href="#mime-type-writing"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="valid-mime-type">有効なMIMEタイプ文字列</dfn>は、
            <a data-link-type="dfn" href="https://www.rfc-editor.org/rfc/rfc9110#name-media-type"
                id="ref-for-name-media-type">media-type</a>トークン生成規則に一致する文字列です。特に、<a data-link-type="dfn"
                href="#valid-mime-type" id="ref-for-valid-mime-type">有効なMIMEタイプ文字列</a>は<a data-link-type="dfn"
                href="#parameters" id="ref-for-parameters">parameters</a>を含むことがあります。<a data-link-type="biblio"
                href="#biblio-http-semantics" title="HTTP Semantics">[HTTP-SEMANTICS]</a>
        </p>
        <p class="note" role="note"><a data-link-type="dfn" href="#valid-mime-type"
                id="ref-for-valid-mime-type①">有効なMIMEタイプ文字列</a>は、適合性チェッカーのみで使用することが想定されています。
        </p>
        <div class="example" id="example-valid-mime-type-string">
            <a class="self-link" href="#example-valid-mime-type-string"></a>
            <p>"<code>text/html</code>"は<a data-link-type="dfn" href="#valid-mime-type"
                    id="ref-for-valid-mime-type②">有効なMIMEタイプ文字列</a>です。
            </p>
            <p>"<code>text/html;</code>"は<a data-link-type="dfn" href="#valid-mime-type"
                    id="ref-for-valid-mime-type③">有効なMIMEタイプ文字列</a>ではありませんが、
                <a data-link-type="dfn" href="#parse-a-mime-type"
                    id="ref-for-parse-a-mime-type">MIMEタイプの構文解析</a>は、入力が"<code>text/html</code>"の場合と同じ<a
                    data-link-type="dfn" href="#mime-type" id="ref-for-mime-type⑨">MIMEタイプレコード</a>を返します。
            </p>
        </div>
        <p>
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="valid-mime-type-with-no-parameters">パラメータなしの有効なMIMEタイプ文字列</dfn>は、
            U+003B（;）を含まない<a data-link-type="dfn" href="#valid-mime-type"
                id="ref-for-valid-mime-type④">有効なMIMEタイプ文字列</a>です。
        </p>
        <h3 class="heading settled" data-level="4.4" id="parsing-a-mime-type"><span class="secno">4.4. </span><span
                class="content">MIMEタイプの構文解析</span><a class="self-link" href="#parsing-a-mime-type"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="parse-a-mime-type">MIMEタイプの構文解析</dfn>を行うには、文字列<var>input</var>を受け取り、以下の手順を実行する：

        </p>
        <ol>
            <li>
                <p><var>input</var>の先頭および末尾の<a data-link-type="dfn"
                        href="https://fetch.spec.whatwg.org/#http-whitespace" id="ref-for-http-whitespace">HTTP
                        空白</a>を削除する。</p>
            <li>
                <p><var>position</var>を<var>input</var>の<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#string-position-variable"
                        id="ref-for-string-position-variable">位置変数</a>とし、最初は<var>input</var>の先頭を指す。</p>
            <li>
                <p><var>type</var>を、<var>position</var>を指定して<var>input</var>からU+002F (/) ではないコードポイントの<a
                        data-link-type="dfn" href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                        id="ref-for-collect-a-sequence-of-code-points">並びを収集</a>した結果とする。</p>
            <li>
                <p><var>type</var>が空文字列であるか、<a data-link-type="dfn" href="#http-token-code-point"
                        id="ref-for-http-token-code-point①">HTTPトークンコードポイント</a>のみで構成されていない場合、失敗を返す。</p>
            <li>
                <p><var>position</var>が<var>input</var>の末尾を越えている場合、失敗を返す。</p>
            <li>
                <p><var>position</var>を1進める。（U+002F (/) を飛ばす。）</p>
            <li>
                <p><var>subtype</var>を、<var>position</var>を指定して<var>input</var>からU+003B (;) ではないコードポイントの<a
                        data-link-type="dfn" href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                        id="ref-for-collect-a-sequence-of-code-points①">並びを収集</a>した結果とする。</p>
            <li>
                <p><var>subtype</var>の末尾から<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-whitespace"
                        id="ref-for-http-whitespace①">HTTP空白</a>を削除する。</p>
            <li>
                <p><var>subtype</var>が空文字列であるか、<a data-link-type="dfn" href="#http-token-code-point"
                        id="ref-for-http-token-code-point②">HTTPトークンコードポイント</a>のみで構成されていない場合、失敗を返す。</p>
            <li>
                <p><var>mimeType</var>を新しい<a data-link-type="dfn" href="#mime-type"
                        id="ref-for-mime-type①⓪">MIMEタイプレコード</a>とし、<a data-link-type="dfn" href="#type"
                        id="ref-for-type①">type</a>は<var>type</var>を<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#ascii-lowercase"
                        id="ref-for-ascii-lowercase">ASCII小文字</a>で、<a data-link-type="dfn" href="#subtype"
                        id="ref-for-subtype①">subtype</a>は<var>subtype</var>を<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#ascii-lowercase"
                        id="ref-for-ascii-lowercase①">ASCII小文字</a>とする。</p>
            <li>
                <p><var>position</var>が<var>input</var>の末尾を越えていない間、以下を繰り返す：</p>
                <ol>
                    <li>
                        <p><var>position</var>を1進める。（U+003B (;) を飛ばす。）</p>
                    <li>
                        <p><var>position</var>を指定して<var>input</var>から<a data-link-type="dfn"
                                href="https://fetch.spec.whatwg.org/#http-whitespace"
                                id="ref-for-http-whitespace②">HTTP空白</a>の<a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                                id="ref-for-collect-a-sequence-of-code-points②">並びを収集</a>する。</p>
                        <p class="note" role="note">これは<a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#skip-ascii-whitespace"
                                id="ref-for-skip-ascii-whitespace">ASCII空白のスキップ</a>に概ね相当するが、<a data-link-type="dfn"
                                href="https://fetch.spec.whatwg.org/#http-whitespace"
                                id="ref-for-http-whitespace③">HTTP空白</a>を使用し、<a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#ascii-whitespace"
                                id="ref-for-ascii-whitespace">ASCII空白</a>ではない。</p>
                    <li>
                        <p><var>position</var>を指定して<var>input</var>からU+003B (;) または U+003D (=) ではないコードポイントの<a
                                data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                                id="ref-for-collect-a-sequence-of-code-points③">並びを収集</a>し、<var>parameterName</var>とする。
                        </p>
                    <li>
                        <p><var>parameterName</var>を<a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#ascii-lowercase"
                                id="ref-for-ascii-lowercase②">ASCII小文字</a>にする。</p>
                    <li>
                        <p><var>position</var>が<var>input</var>の末尾を越えていない場合：</p>
                        <ol>
                            <li>
                                <p><var>position</var>の<var>input</var>内の<a data-link-type="dfn"
                                        href="https://infra.spec.whatwg.org/#code-point"
                                        id="ref-for-code-point②">コードポイント</a>がU+003B (;) ならば、<a data-link-type="dfn"
                                        href="https://infra.spec.whatwg.org/#iteration-continue"
                                        id="ref-for-iteration-continue">続行</a>する。</p>
                            <li>
                                <p><var>position</var>を1進める。（U+003D (=) を飛ばす。）</p>
                        </ol>
                    <li>
                        <p><var>position</var>が<var>input</var>の末尾を越えている場合、<a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#iteration-break"
                                id="ref-for-iteration-break">中断</a>する。</p>
                    <li>
                        <p><var>parameterValue</var>をnullとする。</p>
                    <li>
                        <p><var>position</var>の<var>input</var>内の<a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#code-point"
                                id="ref-for-code-point③">コードポイント</a>がU+0022 (") ならば：</p>
                        <ol>
                            <li>
                                <p><var>parameterValue</var>に、<var>position</var>とtrueを指定し<var>input</var>から<a
                                        data-link-type="dfn"
                                        href="https://fetch.spec.whatwg.org/#collect-an-http-quoted-string"
                                        id="ref-for-collect-an-http-quoted-string">HTTP引用文字列を収集</a>した結果を設定する。</p>
                            <li>
                                <p><var>position</var>を指定して<var>input</var>からU+003B (;) ではないコードポイントの<a
                                        data-link-type="dfn"
                                        href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                                        id="ref-for-collect-a-sequence-of-code-points④">並びを収集</a>する。</p>
                                <p class="example" id="example-mime-type-parser-trailing-garbage"><a class="self-link"
                                        href="#example-mime-type-parser-trailing-garbage"></a>例：
                                    <code>text/html;charset="shift_jis"iso-2022-jp</code>の場合、<code>text/html;charset=shift_jis</code>となる。
                                </p>
                        </ol>
                    <li>
                        <p>それ以外の場合：</p>
                        <ol>
                            <li>
                                <p><var>position</var>を指定して<var>input</var>からU+003B (;) ではないコードポイントの<a
                                        data-link-type="dfn"
                                        href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                                        id="ref-for-collect-a-sequence-of-code-points⑤">並びを収集</a>し、<var>parameterValue</var>とする。
                                </p>
                            <li>
                                <p><var>parameterValue</var>の末尾から<a data-link-type="dfn"
                                        href="https://fetch.spec.whatwg.org/#http-whitespace"
                                        id="ref-for-http-whitespace④">HTTP空白</a>を削除する。</p>
                            <li>
                                <p><var>parameterValue</var>が空文字列ならば、<a data-link-type="dfn"
                                        href="https://infra.spec.whatwg.org/#iteration-continue"
                                        id="ref-for-iteration-continue①">続行</a>する。</p>
                        </ol>
                    <li>
                        <p>すべて以下が真なら：</p>
                        <ul class="brief">
                            <li><var>parameterName</var>が空文字列でない

                            <li><var>parameterName</var>が<a data-link-type="dfn" href="#http-token-code-point"
                                    id="ref-for-http-token-code-point③">HTTPトークンコードポイント</a>のみで構成されている

                            <li><var>parameterValue</var>が<a data-link-type="dfn"
                                    href="#http-quoted-string-token-code-point"
                                    id="ref-for-http-quoted-string-token-code-point①">HTTP引用文字列トークンコードポイント</a>のみで構成されている

                            <li><var>mimeType</var>の<a data-link-type="dfn" href="#parameters"
                                    id="ref-for-parameters①">parameters</a>[<var>parameterName</var>]が<a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists"
                                    id="ref-for-map-exists">存在しない</a>
                        </ul>
                        <p>その場合、<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set"
                                id="ref-for-map-set">設定する</a> <var>mimeType</var>の
                            <a data-link-type="dfn" href="#parameters"
                                id="ref-for-parameters②">parameters</a>[<var>parameterName</var>] を
                            <var>parameterValue</var>に。
                        </p>
                </ol>
            <li>
                <p><var>mimeType</var>を返す。</p>
        </ol>
        <hr>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="parse-a-mime-type-from-bytes">バイト列からMIMEタイプを構文解析する</dfn>には、<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence">バイト列</a><var>input</var>を受け取り、
            以下の手順を実行する：
        </p>
        <ol>
            <li>
                <p><var>string</var>を<var>input</var>の<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#isomorphic-decode"
                        id="ref-for-isomorphic-decode">等価デコード</a>したものとする。</p>
            <li>
                <p><var>string</var>で<a data-link-type="dfn" href="#parse-a-mime-type"
                        id="ref-for-parse-a-mime-type①">MIMEタイプを解析する</a>結果を返す。</p>
        </ol>
        <h3 class="heading settled" data-level="4.5" id="serializing-a-mime-type"><span class="secno">4.5. </span><span
                class="content">MIMEタイプの直列化</span><a class="self-link" href="#serializing-a-mime-type"></a>
        </h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="serialize-a-mime-type">MIMEタイプを直列化する</dfn>には、<a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①①">MIMEタイプ</a>
            <var>mimeType</var>が与えられたとき、次の手順を実行する：
        </p>
        <ol>
            <li>
                <p><var>serialization</var>を<var>mimeType</var>の<a data-link-type="dfn" href="#type"
                        id="ref-for-type②">type</a>、U+002F (/)、<var>mimeType</var>の<a data-link-type="dfn"
                        href="#subtype" id="ref-for-subtype②">subtype</a>を連結したものとする。</p>
            <li>
                <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                        id="ref-for-map-iterate">各</a> <var>name</var> → <var>value</var> を<var>mimeType</var>の<a
                        data-link-type="dfn" href="#parameters" id="ref-for-parameters③">parameters</a>から取り出し：</p>
                <ol>
                    <li>
                        <p><var>serialization</var>にU+003B (;)を追加する。</p>
                    <li>
                        <p><var>serialization</var>に<var>name</var>を追加する。</p>
                    <li>
                        <p><var>serialization</var>にU+003D (=)を追加する。</p>
                    <li>
                        <p><var>value</var>が<a data-link-type="dfn" href="#http-token-code-point"
                                id="ref-for-http-token-code-point④">HTTPトークンコードポイント</a>のみで構成されていない、または<var>value</var>が空文字列の場合：
                        </p>
                        <ol>
                            <li>
                                <p><var>value</var>内のU+0022 (")またはU+005C (\)の各出現の前にU+005C (\)を付ける。</p>
                            <li>
                                <p><var>value</var>の先頭にU+0022 (")を付加する。</p>
                            <li>
                                <p><var>value</var>の末尾にU+0022 (")を付加する。</p>
                        </ol>
                    <li>
                        <p><var>serialization</var>に<var>value</var>を追加する。</p>
                </ol>
            <li>
                <p><var>serialization</var>を返す。</p>
        </ol>
        <hr>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="serialize-a-mime-type-to-bytes">MIMEタイプをバイト列に直列化する</dfn>には、<a data-link-type="dfn" href="#mime-type"
                id="ref-for-mime-type①②">MIMEタイプ</a>
            <var>mimeType</var>が与えられたとき、次の手順を実行する：
        </p>
        <ol>
            <li>
                <p><var>stringSerialization</var>を<var>mimeType</var>で<a data-link-type="dfn"
                        href="#serialize-a-mime-type" id="ref-for-serialize-a-mime-type">MIMEタイプを直列化する</a>結果とする。</p>
            <li>
                <p><var>stringSerialization</var>を<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#isomorphic-encode"
                        id="ref-for-isomorphic-encode">等価エンコード</a>したものを返す。</p>
        </ol>
        <h3 class="heading settled" data-level="4.6" id="mime-type-groups"><span class="secno">4.6. </span><span
                class="content">MIMEタイプグループ</span><a class="self-link" href="#mime-type-groups"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="image-mime-type">画像MIMEタイプ</dfn>は、<a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①③">MIMEタイプ</a>であり、その<a data-link-type="dfn"
                href="#type" id="ref-for-type③">type</a>が"<code>image</code>"であるもの。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="audio-or-video-mime-type">音声または動画MIMEタイプ</dfn>は、<a data-link-type="dfn" href="#mime-type"
                id="ref-for-mime-type①④">MIMEタイプ</a>であり、<a data-link-type="dfn" href="#type"
                id="ref-for-type④">type</a>が"<code>audio</code>"または"<code>video</code>"であるもの、または<a data-link-type="dfn"
                href="#mime-type-essence"
                id="ref-for-mime-type-essence②">essence</a>が"<code>application/ogg</code>"であるもの。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="font-mime-type">フォントMIMEタイプ</dfn>は、<a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①⑤">MIMEタイプ</a>であり、<a data-link-type="dfn"
                href="#type" id="ref-for-type⑤">type</a>が"<code>font</code>"であるもの、または<a data-link-type="dfn"
                href="#mime-type-essence" id="ref-for-mime-type-essence③">essence</a>が下記いずれかであるもの：<a
                data-link-type="biblio" href="#biblio-rfc8081"
                title="The &quot;font&quot; Top-Level Media Type">[RFC8081]</a></p>
        <ul class="brief">
            <li><code>application/font-cff</code>
            <li><code>application/font-otf</code>
            <li><code>application/font-sfnt</code>
            <li><code>application/font-ttf</code>
            <li><code>application/font-woff</code>
            <li><code>application/vnd.ms-fontobject</code>
            <li><code>application/vnd.ms-opentype</code>
        </ul>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="zip-based-mime-type">ZIPベースMIMEタイプ</dfn>は、<a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①⑥">MIMEタイプ</a>であり、<a data-link-type="dfn"
                href="#subtype" id="ref-for-subtype③">subtype</a>が"<code>+zip</code>"で終わるもの、または<a data-link-type="dfn"
                href="#mime-type-essence" id="ref-for-mime-type-essence④">essence</a>が下記いずれかであるもの：</p>
        <ul class="XXX brief">
            <li><code>application/zip</code>
        </ul>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="archive-mime-type">アーカイブMIMEタイプ</dfn>は、<a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①⑦">MIMEタイプ</a>であり、<a data-link-type="dfn"
                href="#mime-type-essence" id="ref-for-mime-type-essence⑤">essence</a>が下記いずれかであるもの：</p>
        <ul class="brief">
            <li><code>application/x-rar-compressed</code>
            <li><code>application/zip</code>
            <li><code>application/x-gzip</code>
        </ul>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="xml-mime-type">XML MIMEタイプ</dfn>は、<a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①⑧">MIMEタイプ</a>であり、<a data-link-type="dfn"
                href="#subtype" id="ref-for-subtype④">subtype</a>が"<code>+xml</code>"で終わるもの、または<a data-link-type="dfn"
                href="#mime-type-essence"
                id="ref-for-mime-type-essence⑥">essence</a>が"<code>text/xml</code>"または"<code>application/xml</code>"であるもの。<a
                data-link-type="biblio" href="#biblio-rfc7303" title="XML Media Types">[RFC7303]</a></p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="html-mime-type">HTML MIMEタイプ</dfn>は、<a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①⑨">MIMEタイプ</a>であり、<a data-link-type="dfn"
                href="#mime-type-essence" id="ref-for-mime-type-essence⑦">essence</a>が"<code>text/html</code>"であるもの。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="scriptable-mime-type">スクリプト可能MIMEタイプ</dfn>は、<a
                data-link-type="dfn" href="#xml-mime-type" id="ref-for-xml-mime-type②">XML MIMEタイプ</a>、<a
                data-link-type="dfn" href="#html-mime-type" id="ref-for-html-mime-type">HTML MIMEタイプ</a>、または<a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②⓪">MIMEタイプ</a>であり<a data-link-type="dfn"
                href="#mime-type-essence"
                id="ref-for-mime-type-essence⑧">essence</a>が"<code>application/pdf</code>"であるもの。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="javascript-mime-type">JavaScript
                MIMEタイプ</dfn>は、<a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②①">MIMEタイプ</a>であり、<a
                data-link-type="dfn" href="#mime-type-essence" id="ref-for-mime-type-essence⑨">essence</a>が下記いずれかであるもの：
        </p>
        <ul class="brief">
            <li><code>application/ecmascript</code>
            <li><code>application/javascript</code>
            <li><code>application/x-ecmascript</code>
            <li><code>application/x-javascript</code>
            <li><code>text/ecmascript</code>
            <li><code>text/javascript</code>
            <li><code>text/javascript1.0</code>
            <li><code>text/javascript1.1</code>
            <li><code>text/javascript1.2</code>
            <li><code>text/javascript1.3</code>
            <li><code>text/javascript1.4</code>
            <li><code>text/javascript1.5</code>
            <li><code>text/jscript</code>
            <li><code>text/livescript</code>
            <li><code>text/x-ecmascript</code>
            <li><code>text/x-javascript</code>
        </ul>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①">文字列</a>は、<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-export id="javascript-mime-type-essence-match">JavaScript
                MIMEタイプessence一致</dfn>であり、<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                id="ref-for-ascii-case-insensitive">ASCII大文字小文字無視</a>で<a data-link-type="dfn"
                href="#javascript-mime-type" id="ref-for-javascript-mime-type①">JavaScript
                MIMEタイプ</a>essence文字列のいずれかと一致する場合。</p>
        <p class="note" role="note">このフックは
            <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/scripting.html#attr-script-type" id="ref-for-attr-script-type">type</a></code>
            属性や
            <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script">script</a></code>
            要素で使用される。<a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>
        </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="json-mime-type">JSON MIMEタイプ</dfn>は、<a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②②">MIMEタイプ</a>であり、<a data-link-type="dfn"
                href="#subtype" id="ref-for-subtype⑤">subtype</a>が"<code>+json</code>"で終わるもの、または<a data-link-type="dfn"
                href="#mime-type-essence"
                id="ref-for-mime-type-essence①⓪">essence</a>が"<code>application/json</code>"または"<code>text/json</code>"であるもの。
        </p>
        <h2 class="heading settled" data-level="5" id="handling-a-resource"><span class="secno">5. </span><span
                class="content">リソースの取り扱い</span><a class="self-link" href="#handling-a-resource"></a></h2>
        <p class="XXX">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="resource">リソース</dfn>とは ...。
        </p>
        <p>
            ユーザーエージェントは、取り扱う各<a data-link-type="dfn" href="#resource"
                id="ref-for-resource①">リソース</a>について、次の関連メタデータを管理しなければならない：
        </p>
        <ul>
            <li>
                <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="supplied-mime-type">指定MIMEタイプ</dfn>。<a
                    data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②③">MIMEタイプ</a>であり、<a
                    data-link-type="dfn" href="#supplied-mime-type-detection-algorithm"
                    id="ref-for-supplied-mime-type-detection-algorithm">指定MIMEタイプ検出アルゴリズム</a>によって決定される。
            <li>
                <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                    id="check-for-apache-bug-flag">Apacheバグ確認フラグ</dfn>。初期状態は未設定。
            <li>
                <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                    id="no-sniff-flag">no-sniffフラグ</dfn>。ユーザーエージェントが<a data-link-type="dfn" href="#resource"
                    id="ref-for-resource②">リソース</a>に対してスニッフィングを行わない場合は設定され、それ以外は未設定。
                <p class="note" role="note">
                    ユーザーエージェントは、サイトとの過去の経験など外部情報を用いて、特定の<a data-link-type="dfn" href="#resource"
                        id="ref-for-resource③">リソース</a>のスニッフィングを回避するかどうか判断できる。また、すべての<a data-link-type="dfn"
                        href="#resource" id="ref-for-resource④">リソース</a>に対してスニッフィングを回避することもできる。ただし、スニッフィングを回避しても、<a
                        data-link-type="dfn" href="#mime-type-sniffing-algorithm"
                        id="ref-for-mime-type-sniffing-algorithm">MIMEタイプスニッフィングアルゴリズム</a>の使用義務は免除されない。
                </p>
            <li>
                <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="computed-mime-type">算出MIMEタイプ</dfn>。<a
                    data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②④">MIMEタイプ</a>であり、<a
                    data-link-type="dfn" href="#mime-type-sniffing-algorithm"
                    id="ref-for-mime-type-sniffing-algorithm①">MIMEタイプスニッフィングアルゴリズム</a>によって決定される。
        </ul>
        <h3 class="heading settled" data-level="5.1" id="interpreting-the-resource-metadata"><span class="secno">5.1.
            </span><span class="content">リソースメタデータの解釈</span><a class="self-link"
                href="#interpreting-the-resource-metadata"></a></h3>
        <p>
            <a data-link-type="dfn" href="#resource" id="ref-for-resource⑤">リソース</a>の<a data-link-type="dfn"
                href="#supplied-mime-type" id="ref-for-supplied-mime-type">指定MIMEタイプ</a>は、その<a data-link-type="dfn"
                href="#resource" id="ref-for-resource⑥">リソース</a>に関連する外部ソースからユーザーエージェントに提供される。
            この情報の取得方法は、<a data-link-type="dfn" href="#resource" id="ref-for-resource⑦">リソース</a>の取得方法により異なる。
        </p>
        <p>
            <a data-link-type="dfn" href="#resource" id="ref-for-resource⑧">リソース</a>の<a data-link-type="dfn"
                href="#supplied-mime-type" id="ref-for-supplied-mime-type①">指定MIMEタイプ</a>を決定するには、ユーザーエージェントは以下の<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-lt="supplied MIME type detection algorithm" data-noexport
                id="supplied-mime-type-detection-algorithm">指定MIMEタイプ検出アルゴリズム</dfn>を用いなければならない：
        </p>
        <ol>
            <li>
                <var>supplied-type</var>をnullとする。
            <li>
                <a data-link-type="dfn" href="#resource" id="ref-for-resource⑨">リソース</a>がHTTP経由で取得された場合、以下を実行する：
                <ol>
                    <li>
                        一つ以上の<code>Content-Type</code>ヘッダーが<a data-link-type="dfn" href="#resource"
                            id="ref-for-resource①⓪">リソース</a>に関連付けられている場合、以下を実行する：
                        <ol>
                            <li>
                                <var>supplied-type</var>に、<a data-link-type="dfn" href="#resource"
                                    id="ref-for-resource①①">リソース</a>に関連付けられている最後の<code>Content-Type</code>ヘッダーの値を設定する。
                                <p class="note" role="note">
                                    ファイル拡張子は、HTTP経由で取得された<a data-link-type="dfn" href="#resource"
                                        id="ref-for-resource①②">リソース</a>の<a data-link-type="dfn"
                                        href="#supplied-mime-type"
                                        id="ref-for-supplied-mime-type②">指定MIMEタイプ</a>の決定には使用しない。これは信頼性が低く、容易に偽装可能であるためである。
                                </p>
                            <li>
                                <var>supplied-type</var>が下記の値のいずれかと<strong>完全一致</strong>する場合、<a data-link-type="dfn"
                                    href="#check-for-apache-bug-flag"
                                    id="ref-for-check-for-apache-bug-flag">Apacheバグ確認フラグ</a>を設定する：
                                <table>
                                    <thead>
                                        <tr>
                                            <th>16進数のバイト値
                                            <th>ASCIIのバイト値
                                    <tbody>
                                        <tr>
                                            <td>
                                                74 65 78 74 2F 70 6C 61 69 6E
                                            <td>
                                                <code>text/plain</code>
                                        <tr>
                                            <td>
                                                74 65 78 74 2F 70 6C 61 69 6E<br>
                                                3B 20 63 68 61 72 73 65 74 3D<br>
                                                49 53 4F 2D 38 38 35 39 2D 31
                                            <td>
                                                <code>text/plain; charset=ISO-8859-1</code>
                                        <tr>
                                            <td>
                                                74 65 78 74 2F 70 6C 61 69 6E<br>
                                                3B 20 63 68 61 72 73 65 74 3D<br>
                                                69 73 6F 2D 38 38 35 39 2D 31
                                            <td>
                                                <code>text/plain; charset=iso-8859-1</code>
                                        <tr>
                                            <td>
                                                74 65 78 74 2F 70 6C 61 69 6E<br>
                                                3B 20 63 68 61 72 73 65 74 3D<br>
                                                55 54 46 2D 38
                                            <td>
                                                <code>text/plain; charset=UTF-8</code>
                                </table>
                                <p class="note" role="note">
                                    <a data-link-type="dfn" href="#supplied-mime-type-detection-algorithm"
                                        id="ref-for-supplied-mime-type-detection-algorithm①">指定MIMEタイプ検出アルゴリズム</a>は、これらの正確な<a
                                        data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                        id="ref-for-byte⑥">バイト列</a>を検出する。これは、古いApacheの一部インストールに<a
                                        href="https://issues.apache.org/bugzilla/show_bug.cgi?id=13986">バグ</a>があり、認識できない<a
                                        data-link-type="dfn" href="#mime-type"
                                        id="ref-for-mime-type②⑤">MIMEタイプ</a>のファイルを提供する際にこれらのContent-Typeヘッダーを返すためである。
                                </p>
                        </ol>
                </ol>
                <p><a data-link-type="biblio" href="#biblio-http-semantics" title="HTTP Semantics">[HTTP-SEMANTICS]</a>
                </p>
            <li>
                <a data-link-type="dfn" href="#resource"
                    id="ref-for-resource①③">リソース</a>がファイルシステムから直接取得された場合、<var>supplied-type</var>にファイルシステムが提供した<a
                    data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②⑥">MIMEタイプ</a>を設定する。
            <li>
                <a data-link-type="dfn" href="#resource"
                    id="ref-for-resource①④">リソース</a>が他のプロトコル（FTPなど）経由で取得された場合、<var>supplied-type</var>にそのプロトコルで決定された<a
                    data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②⑦">MIMEタイプ</a>を設定する（該当する場合）。
                <p><a data-link-type="biblio" href="#biblio-ftp" title="File Transfer Protocol">[FTP]</a></p>
            <li>
                <var>supplied-type</var>が<a data-link-type="dfn" href="#mime-type"
                    id="ref-for-mime-type②⑧">MIMEタイプ</a>でない場合、<a data-link-type="dfn" href="#supplied-mime-type"
                    id="ref-for-supplied-mime-type③">指定MIMEタイプ</a>は未定義とする。
                <p>これらの手順を中止する。</p>
            <li>
                <a data-link-type="dfn" href="#supplied-mime-type"
                    id="ref-for-supplied-mime-type④">指定MIMEタイプ</a>は<var>supplied-type</var>とする。
        </ol>
        <h3 class="heading settled" data-level="5.2" id="reading-the-resource-header"><span class="secno">5.2.
            </span><span class="content">リソースヘッダーの読み取り</span><a class="self-link"
                href="#reading-the-resource-header"></a></h3>
        <p>
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="resource-header">リソースヘッダー</dfn>は、<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence①">バイト列</a>であり、<a data-link-type="dfn" href="#resource"
                id="ref-for-resource①⑤">リソース</a>の先頭部分として、<a data-link-type="dfn" href="#read-the-resource-header"
                id="ref-for-read-the-resource-header">リソースヘッダーを読み取る</a>によって定義される。
        </p>
        <p>
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="read-the-resource-header">リソースヘッダーを読み取る</dfn>には、次の手順を実行する：
        </p>
        <ol>
            <li>
                <var>buffer</var>を<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence②">バイト列</a>とする。
            <li>
                <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte⑦">バイト</a>を<a
                    data-link-type="dfn" href="#resource"
                    id="ref-for-resource①⑥">リソース</a>から<var>buffer</var>に読み込む。次のいずれかの条件を満たすまで繰り返す：
                <ul>
                    <li>
                        <a data-link-type="dfn" href="#resource" id="ref-for-resource①⑦">リソース</a>の終端に到達した場合。
                    <li>
                        <var>buffer</var>の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                            id="ref-for-byte⑧">バイト</a>数が1445以上になった場合。
                    <li>
                        ユーザーエージェントが判断する合理的な時間が経過した場合。
                </ul>
                <p class="note" role="note">
                    <var>buffer</var>の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                        id="ref-for-byte⑨">バイト</a>数が1445以上の場合、<a data-link-type="dfn"
                        href="#mime-type-sniffing-algorithm"
                        id="ref-for-mime-type-sniffing-algorithm②">MIMEタイプスニッフィングアルゴリズム</a>は大多数のケースで決定的となる。
                </p>
                <p>ただし、回線が遅いなどの理由で、ユーザーエージェントが合理的な時間で1445<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte①⓪">バイト</a>を読み取れない場合もある。</p>
            <li>
                <a data-link-type="dfn" href="#resource-header"
                    id="ref-for-resource-header">リソースヘッダー</a>は<var>buffer</var>とする。
        </ol>
        <p class="note" role="note">
            <a data-link-type="dfn" href="#resource-header" id="ref-for-resource-header①">リソースヘッダー</a>は、各<a
                data-link-type="dfn" href="#resource" id="ref-for-resource①⑧">リソース</a>ごとに一度だけ決定すればよい。
        </p>
        <h2 class="heading settled" data-level="6" id="matching-a-mime-type-pattern"><span class="secno">6.
            </span><span class="content">MIMEタイプパターンの照合</span><a class="self-link"
                href="#matching-a-mime-type-pattern"></a></h2>
        <p>
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="byte-pattern">バイトパターン</dfn>は、<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence③">バイト列</a>であり、<a data-link-type="dfn" href="#pattern-matching-algorithm"
                id="ref-for-pattern-matching-algorithm">パターンマッチングアルゴリズム</a>において照合用テンプレートとして使われる。
        </p>
        <p>
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="pattern-mask">パターンマスク</dfn>は、<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence④">バイト列</a>であり、<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte①①">バイト</a>が<a data-link-type="dfn"
                href="#byte-pattern" id="ref-for-byte-pattern">バイトパターン</a>との比較でどれだけ重要かを
            <a data-link-type="dfn" href="#pattern-matching-algorithm"
                id="ref-for-pattern-matching-algorithm①">パターンマッチングアルゴリズム</a>で決定するために使用する。
        </p>
        <p class="note" role="note">
            <a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask">パターンマスク</a>では、0xFFは<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                id="ref-for-byte①②">バイト</a>が厳密に重要であること、0xDFは<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte①③">バイト</a>がASCIIの大文字小文字無視で重要であること、0x00は<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte①④">バイト</a>が重要でないことを示す。
        </p>
        <p>特定の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence⑤">バイト列</a>が所定の<a data-link-type="dfn" href="#byte-pattern"
                id="ref-for-byte-pattern①">バイトパターン</a>に一致するかどうかは、以下の<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-noexport id="pattern-matching-algorithm">パターンマッチングアルゴリズム</dfn>で判定する。これは、<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence⑥">バイト列</a>
            <var>input</var>、<a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern②">バイトパターン</a>
            <var>pattern</var>、<a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask①">パターンマスク</a>
            <var>mask</var>、無視する<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set"
                id="ref-for-ordered-set">集合</a>の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                id="ref-for-byte①⑤">バイト</a> <var>ignored</var> を受け取り、trueまたはfalseを返す。
        </p>
        <ol>
            <li>
                <p>Assert: <var>pattern</var>の<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length">長さ</a>は
                    <var>mask</var>の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length①">長さ</a>と等しい。
                </p>
            <li>
                <p><var>input</var>の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length②">長さ</a>が<var>pattern</var>の
                    <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length③">長さ</a>未満なら、falseを返す。
                </p>
            <li>
                <p><var>s</var>を0とする。
                </p>
            <li>
                <p><var>s</var> &lt; <var>input</var>の<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length④">長さ</a>の間、繰り返す：</p>
                <ol>
                    <li>
                        <p><var>ignored</var>が<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain"
                                id="ref-for-list-contain">含まない</a>
                            <var>input</var>[<var>s</var>]なら、
                            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-break"
                                id="ref-for-iteration-break①">break</a>する。
                        </p>
                    <li>
                        <p><var>s</var>を<var>s</var> + 1にする。
                        </p>
                </ol>
            <li>
                <p><var>p</var>を0とする。
                </p>
            <li>
                <p><var>p</var> &lt; <var>pattern</var>の<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length⑤">長さ</a>の間、繰り返す：</p>
                <ol>
                    <li>
                        <p><var>maskedData</var>を<var>input</var>[<var>s</var>]と<var>mask</var>[<var>p</var>]にビットAND演算子を適用した結果とする。
                        </p>
                    <li>
                        <p><var>maskedData</var>が<var>pattern</var>[<var>p</var>]と等しくない場合、falseを返す。
                        </p>
                    <li>
                        <p><var>s</var>を<var>s</var> + 1にする。
                        </p>
                    <li>
                        <p><var>p</var>を<var>p</var> + 1にする。
                        </p>
                </ol>
            <li>
                <p>trueを返す。
                </p>
        </ol>
        <h3 class="heading settled" data-level="6.1" id="matching-an-image-type-pattern"><span class="secno">6.1.
            </span><span class="content">画像タイプパターンの照合</span><a class="self-link"
                href="#matching-an-image-type-pattern"></a></h3>
        <p>どの<a data-link-type="dfn" href="#image-mime-type" id="ref-for-image-mime-type">画像MIMEタイプ</a>の<a
                data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern③">バイトパターン</a>に<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence⑦">バイト列</a><var>input</var>が一致するか（該当する場合）、次の<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-export
                id="image-type-pattern-matching-algorithm">画像タイプパターンマッチングアルゴリズム</dfn>を利用する：</p>
        <ol>
            <li>
                <p>以下の表の各行<var>row</var>について、次の手順を実行する：</p>
                <ol>
                    <li>
                        <p><var>patternMatched</var>を、<a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm②">パターンマッチングアルゴリズム</a>に<var>input</var>、<var>row</var>の第1列・第2列・第3列の値を与えた結果とする。
                        </p>
                    <li>
                        <p><var>patternMatched</var>がtrueなら、<var>row</var>の第4列の値を返す。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th>
                                <a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern④">バイトパターン</a>
                            <th>
                                <a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask②">パターンマスク</a>
                            <th>
                                先頭の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte①⑥">バイト</a>で無視するもの
                            <th>
                                <a data-link-type="dfn" href="#image-mime-type"
                                    id="ref-for-image-mime-type①">画像MIMEタイプ</a>
                            <th>
                                備考
                    <tbody>
                        <tr>
                            <td>
                                00 00 01 00
                            <td>
                                FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>image/x-icon</code>
                            <td>
                                Windowsアイコンシグネチャ。
                        <tr>
                            <td>
                                00 00 02 00
                            <td>
                                FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>image/x-icon</code>
                            <td>
                                Windowsカーソルシグネチャ。
                        <tr>
                            <td>
                                42 4D
                            <td>
                                FF FF
                            <td>
                                なし。
                            <td>
                                <code>image/bmp</code>
                            <td>
                                文字列"<code>BM</code>"、BMPシグネチャ。
                        <tr>
                            <td>
                                47 49 46 38 37 61
                            <td>
                                FF FF FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>image/gif</code>
                            <td>
                                文字列"<code>GIF87a</code>"、GIFシグネチャ。
                        <tr>
                            <td>
                                47 49 46 38 39 61
                            <td>
                                FF FF FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>image/gif</code>
                            <td>
                                文字列"<code>GIF89a</code>"、GIFシグネチャ。
                        <tr>
                            <td>
                                52 49 46 46 00 00 00 00 57 45 42 50 56 50
                            <td>
                                FF FF FF FF 00 00 00 00 FF FF FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>image/webp</code>
                            <td>
                                文字列"<code>RIFF</code>"の後に4つの<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte①⑦">バイト</a>、続いて文字列"<code>WEBPVP</code>"。
                        <tr>
                            <td>
                                89 50 4E 47 0D 0A 1A 0A
                            <td>
                                FF FF FF FF FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>image/png</code>
                            <td>
                                エラーチェック用<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte①⑧">バイト</a>、続いて文字列"<code>PNG</code>"、CR LF SUB LF、PNGシグネチャ。
                        <tr>
                            <td>
                                FF D8 FF
                            <td>
                                FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>image/jpeg</code>
                            <td>
                                JPEG開始マーカーの後に他のマーカーの指示<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte①⑨">バイト</a>。
                </table>
            <li>
                <p>undefinedを返す。</p>
        </ol>
        <h3 class="heading settled" data-level="6.2" id="matching-an-audio-or-video-type-pattern"><span
                class="secno">6.2. </span><span class="content">音声/動画タイプパターンの照合</span><a class="self-link"
                href="#matching-an-audio-or-video-type-pattern"></a></h3>
        <p>どの<a data-link-type="dfn" href="#audio-or-video-mime-type"
                id="ref-for-audio-or-video-mime-type">音声または動画MIMEタイプ</a>の<a data-link-type="dfn" href="#byte-pattern"
                id="ref-for-byte-pattern⑤">バイトパターン</a>に<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence⑧">バイト列</a>
            <var>input</var>が一致するか（該当する場合）、次の<dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                data-lt="audio or video type pattern matching algorithm"
                id="audio-or-video-type-pattern-matching-algorithm">音声または動画タイプパターンマッチングアルゴリズム</dfn>を利用する：
        </p>
        <ol>
            <li>
                <p>以下の表の各行<var>row</var>について、次の手順を実行する：</p>
                <ol>
                    <li>
                        <p><var>patternMatched</var>を、<a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm③">パターンマッチングアルゴリズム</a>に<var>input</var>、<var>row</var>の第1列・第2列・第3列の値を与えた結果とする。
                        </p>
                    <li>
                        <p><var>patternMatched</var>がtrueなら、<var>row</var>の第4列の値を返す。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th>
                                <a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern⑥">バイトパターン</a>
                            <th>
                                <a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask③">パターンマスク</a>
                            <th>
                                先頭の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte②⓪">バイト</a>で無視するもの
                            <th>
                                <a data-link-type="dfn" href="#audio-or-video-mime-type"
                                    id="ref-for-audio-or-video-mime-type①">音声または動画MIMEタイプ</a>
                            <th>
                                備考
                    <tbody>
                        <tr>
                            <td>
                                46 4F 52 4D 00 00 00 00 41 49 46 46
                            <td>
                                FF FF FF FF 00 00 00 00 FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>audio/aiff</code>
                            <td>
                                文字列"<code>FORM</code>"の後に4つの<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte②①">バイト</a>、続いて文字列"<code>AIFF</code>"、AIFFシグネチャ。
                        <tr>
                            <td>
                                49 44 33
                            <td>
                                FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>audio/mpeg</code>
                            <td>
                                文字列"<code>ID3</code>"、ID3v2付きMP3シグネチャ。
                        <tr>
                            <td>
                                4F 67 67 53 00
                            <td>
                                FF FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>application/ogg</code>
                            <td>
                                文字列"<code>OggS</code>"の後にNUL、Oggコンテナシグネチャ。
                        <tr>
                            <td>
                                4D 54 68 64 00 00 00 06
                            <td>
                                FF FF FF FF FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>audio/midi</code>
                            <td>
                                文字列"<code>MThd</code>"の後に32bitで6を表す4つの<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte②②">バイト</a>、MIDIシグネチャ。
                        <tr>
                            <td>
                                52 49 46 46 00 00 00 00 41 56 49 20
                            <td>
                                FF FF FF FF 00 00 00 00 FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>video/avi</code>
                            <td>
                                文字列"<code>RIFF</code>"の後に4つの<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte②③">バイト</a>、続いて文字列"<code>AVI </code>"、AVIシグネチャ。
                        <tr>
                            <td>
                                52 49 46 46 00 00 00 00 57 41 56 45
                            <td>
                                FF FF FF FF 00 00 00 00 FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>audio/wave</code>
                            <td>
                                文字列"<code>RIFF</code>"の後に4つの<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte②④">バイト</a>、続いて文字列"<code>WAVE</code>"、WAVEシグネチャ。
                </table>
            <li>
                <p><var>input</var>が<a data-link-type="dfn" href="#matches-the-signature-for-mp4"
                        id="ref-for-matches-the-signature-for-mp4">MP4のシグネチャに一致</a>する場合、"<code>video/mp4</code>"を返す。</p>
            <li>
                <p><var>input</var>が<a data-link-type="dfn" href="#matches-the-signature-for-webm"
                        id="ref-for-matches-the-signature-for-webm">WebMのシグネチャに一致</a>する場合、"<code>video/webm</code>"を返す。
                </p>
            <li>
                <p><var>input</var>が<a data-link-type="dfn" href="#matches-the-signature-for-mp3-without-id3"
                        id="ref-for-matches-the-signature-for-mp3-without-id3">ID3なしMP3のシグネチャに一致</a>する場合、"<code>audio/mpeg</code>"を返す。
                </p>
            <li>
                <p>undefinedを返す。</p>
        </ol>

        <h4 class="heading settled" data-level="6.2.1" id="signature-for-mp4"><span class="secno">6.2.1. </span><span
                class="content">MP4のシグネチャ</span><a class="self-link" href="#signature-for-mp4"></a></h4>
        <p>
            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence9">バイト列</a><dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="matches the signature for MP4" data-noexport
                id="matches-the-signature-for-mp4">MP4のシグネチャと一致する</dfn>かどうか判定するには、以下の手順を使用する：
        </p>
        <ol>
            <li>
                <var>sequence</var>を照合対象とする<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence10">バイト列</a>とし、<var>sequence</var>[<var>s</var>]が<var>sequence</var>の<var>s</var>番目の<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte11">バイト</a>、<var>sequence</var>[0]が最初の<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte12">バイト</a>であるとする。
            <li>
                <var>length</var>を<var>sequence</var>中の<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte13">バイト</a>数とする。
            <li>
                <var>length</var>が12未満ならfalseを返す。
            <li>
                <var>box-size</var>を<var>sequence</var>[0]~[3]の4<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte14">バイト</a>を、32ビット符号なしビッグエンディアン整数として解釈した値とする。
            <li>
                <var>length</var>が<var>box-size</var>未満、または<var>box-size</var>を4で割った余りが0でない場合、falseを返す。
            <li>
                <var>sequence</var>[4]~[7]の4<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte15">バイト</a>が0x66 0x74 0x79 0x70（"<code>ftyp</code>"）と等しくない場合、falseを返す。
            <li>
                <var>sequence</var>[8]~[10]の3<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte16">バイト</a>が0x6D 0x70 0x34（"<code>mp4</code>"）と等しい場合、trueを返す。
            <li>
                <var>bytes-read</var>を16とする。
                <p class="note" role="note">
                    これは"major brand"のバージョン番号に対応する4<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                        id="ref-for-byte17">バイト</a>を無視している。
                </p>
            <li>
                <var>bytes-read</var>が<var>box-size</var>未満の間、以下を繰り返す：
                <ol>
                    <li>
                        <var>sequence</var>[<var>bytes-read</var>]~[<var>bytes-read</var>+2]の3<a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte18">バイト</a>が0x6D 0x70
                        0x34（"<code>mp4</code>"）と等しい場合、trueを返す。
                    <li>
                        <var>bytes-read</var>を4増やす。
                </ol>
            <li>
                falseを返す。
        </ol>
        <h4 class="heading settled" data-level="6.2.2" id="signature-for-webm"><span class="secno">6.2.2.
            </span><span class="content">WebMのシグネチャ</span><a class="self-link" href="#signature-for-webm"></a></h4>
        <p>
            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence11">バイト列</a><dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="matches the signature for WebM" data-noexport
                id="matches-the-signature-for-webm">WebMのシグネチャと一致する</dfn>かどうか判定するには、以下の手順を使用する：
        </p>
        <ol>
            <li>
                <var>sequence</var>を照合対象とする<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence12">バイト列</a>とし、<var>sequence</var>[<var>s</var>]が<var>sequence</var>の<var>s</var>番目の<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte19">バイト</a>、<var>sequence</var>[0]が最初の<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte20">バイト</a>であるとする。
            <li>
                <var>length</var>を<var>sequence</var>中の<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte21">バイト</a>数とする。
            <li>
                <var>length</var>が4未満ならfalseを返す。
            <li>
                <var>sequence</var>[0]~[3]の4<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte22">バイト</a>が0x1A 0x45 0xDF 0xA3と等しくない場合、falseを返す。
            <li>
                <var>iter</var>を4とする。
            <li>
                <var>iter</var>が<var>length</var>未満かつ<var>iter</var>が38未満の間、以下を繰り返す：
                <ol>
                    <li>
                        <var>sequence</var>[<var>iter</var>]~[<var>iter</var>+1]の2バイトが0x42 0x82と等しい場合、
                        <ol>
                            <li> <var>iter</var>を2増やす。
                            <li> <var>iter</var>が<var>length</var>以上なら、これらの手順を中止する。
                            <li> <var>number size</var>を<var>sequence</var>[<var>iter</var>]から<code>vint</code>を<a
                                    href="#parse-a-vint" id="ref-for-parse-a-vint">パース</a>した結果とする。
                            <li> <var>iter</var>を<var>number size</var>だけ増やす。
                            <li> <var>iter</var>が<var>length</var>-4以上なら、これらの手順を中止する。
                            <li> <var>matched</var>を<a href="#matching-a-padded-sequence"
                                    id="ref-for-matching-a-padded-sequence">パディング付きシーケンス照合</a>0x77 0x65 0x62
                                0x6D（"<code>webm</code>"）を<var>sequence</var>の<var>iter</var>オフセットで実行した結果とする。
                            <li> <var>matched</var>がtrueなら、これらの手順を中止しtrueを返す。
                        </ol>
                    <li> <var>iter</var>を1増やす。
                </ol>
            <li> falseを返す。
        </ol>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-a-vint"><code>vint</code>のパース</dfn>は、<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence13">バイト列</a><var>sequence</var>（サイズ<var>length</var>）の<var>iter</var>から開始して以下の手順を実行する：
        </p>
        <ol>
            <li><var>mask</var>を128とする。
            <li><var>max vint length</var>を8とする。
            <li><var>number size</var>を1とする。
            <li><var>index</var>を0とする。
            <li>
                <var>number size</var>が<var>max vint length</var>未満かつ<var>length</var>未満の間、以下を繰り返す：
                <ol>
                    <li><var>sequence</var>[<var>index</var>] &amp; <var>mask</var>が0でなければ、これらの手順を中止する。
                    <li><var>mask</var>を<var>mask</var> >> 1の値とする。
                    <li><var>number size</var>を1増やす。
                </ol>
            <li><var>parsed number</var>を<var>sequence</var>[<var>index</var>] &amp; ~<var>mask</var>とする。
            <li><var>index</var>を1増やす。
            <li><var>bytes remaining</var>を<var>number size</var> - 1とする。
            <li>
                <var>bytes remaining</var>が0でない間、以下を繰り返す：
                <ol>
                    <li><var>parsed number</var>を<var>parsed number</var> &lt;&lt; 8とする。
                    <li><var>parsed number</var>を<var>parsed number</var> | <var>sequence</var>[<var>index</var>]とする。
                    <li><var>index</var>を1増やす。
                    <li><var>index</var>が<var>length</var>以上ならこれらの手順を中止する。
                    <li><var>bytes remaining</var>を1減らす。
                </ol>
            <li><var>parsed number</var>と<var>number size</var>を返す。
        </ol>
        <p>
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="matching-a-padded-sequence">パディング付きシーケンス照合</dfn>は、<var>pattern</var>を<var>sequence</var>の<var>offset</var>から<var>end</var>までの範囲で、長さが<var>end</var>を超え、範囲[<var>offset</var>,
            <var>end</var>]で<var>pattern</var>のバイトが同順で含まれていて、先頭に0x00値のバイトが任意個並んでいる場合true、そうでなければfalseを返すことを意味する。
        </p>
        <h4 class="heading settled" data-level="6.2.3" id="signature-for-mp3-without-id3"><span class="secno">6.2.3.
            </span><span class="content">ID3なしMP3のシグネチャ</span><a class="self-link"
                href="#signature-for-mp3-without-id3"></a></h4>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence14">バイト列</a><dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="matches the signature for MP3 without ID3" data-noexport
                id="matches-the-signature-for-mp3-without-id3">ID3なしMP3のシグネチャと一致する</dfn>かどうか判定するには、以下の手順を使用する：</p>
        <ol>
            <li>
                <var>sequence</var>を照合対象の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence①⑤">バイト列</a>とし、<var>sequence</var>[<var>s</var>]は<var>sequence</var>の<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte③⑦">バイト</a>
                <var>s</var>、<var>sequence</var>[0]は<var>sequence</var>の最初の<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte③⑧">バイト</a>とする。
            <li>
                <var>length</var>を<var>sequence</var>の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte③⑨">バイト</a>数とする。
            <li>
                sを0で初期化する。
            <li>
                <a href="#match-an-mp3-header" id="ref-for-match-an-mp3-header">mp3ヘッダー照合</a>の結果がfalseなら、falseを返す。
            <li>
                <var>sequence</var>のオフセット<var>s</var>で<a href="#parse-an-mp3-frame"
                    id="ref-for-parse-an-mp3-frame">mp3フレーム解析</a>を行う。
            <li>
                <a href="#compute-an-mp3-frame-size"
                    id="ref-for-compute-an-mp3-frame-size">mp3フレームサイズ算出</a>の実行結果を<var>skipped-bytes</var>とする。
            <li>
                <var>skipped-bytes</var>が4未満、または<var>skipped-bytes</var>が<var>s</var> -
                <var>length</var>より大きい場合、falseを返す。
            <li>
                sに<var>skipped-bytes</var>を加算する。
            <li>
                <a href="#match-an-mp3-header"
                    id="ref-for-match-an-mp3-header①">mp3ヘッダー照合</a>の結果がfalseならfalseを返し、そうでなければtrueを返す。
        </ol>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="match-an-mp3-header">mp3ヘッダー照合</dfn>は、<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence16">バイト列</a><var>sequence</var>（長さ<var>length</var>）のオフセット<var>s</var>で以下の手順を実行する：
        </p>
        <ol>
            <li><var>length</var>が4未満ならfalseを返す。
            <li><var>sequence</var>[<var>s</var>]が0xffでない、または<var>sequence</var>[<var>s</var> + 1] &amp;
                0xe0が0xe0でない場合、falseを返す。
            <li><var>layer</var>を<var>sequence</var>[<var>s</var> + 1] &amp; 0x06 >> 1の結果とする。
            <li><var>layer</var>が0ならfalseを返す。
            <li><var>bit-rate</var>を<var>sequence</var>[<var>s</var> + 2] &amp; 0xf0 >> 4の結果とする。
            <li><var>bit-rate</var>が15ならfalseを返す。
            <li><var>sample-rate</var>を<var>sequence</var>[<var>s</var> + 2] &amp; 0x0c >> 2の結果とする。
            <li><var>sample-rate</var>が3ならfalseを返す。
            <li><var>freq</var>を<var>sample-rate</var>テーブルから<var>sample-rate</var>に対応する値とする。
            <li><var>final-layer</var>を4−(<var>sequence</var>[<var>s</var> + 1])の結果とする。
            <li><var>final-layer</var> &amp; 0x06 >> 1が3でなければfalseを返す。
            <li>trueを返す。
        </ol>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="compute-an-mp3-frame-size">mp3フレームサイズ計算</dfn>は以下の手順：</p>
        <ol>
            <li><var>version</var>が1なら<var>scale</var>を72、それ以外は144とする。
            <li><var>size</var>を<var>bitrate</var> * <var>scale</var> / <var>freq</var>とする。
            <li><var>pad</var>が0でなければ<var>size</var>を1加算する。
            <li><var>size</var>を返す。
        </ol>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-an-mp3-frame">mp3フレーム解析</dfn>は以下の手順：
        </p>
        <ol>
            <li><var>version</var>を<var>sequence</var>[<var>s</var> + 1] &amp; 0x18 >> 3とする。
            <li><var>bitrate-index</var>をsequence[s + 2] &amp; 0xf0 >> 4とする。
            <li><var>version</var> &amp; 0x01が非ゼロなら、<var>bitrate</var>をmp2.5-ratesテーブルの<var>bitrate-index</var>番目の値とする。
            <li><var>version</var> &amp; 0x01がゼロなら、<var>bitrate</var>をmp3-ratesテーブルの<var>bitrate-index</var>番目の値とする。
            <li><var>samplerate-index</var>を<var>sequence</var>[<var>s</var> + 2] &amp; 0x0c >> 2とする。
            <li><var>samplerate</var>を<var>sample-rate</var>テーブルから<var>samplerate-index</var>に対応する値とする。
            <li><var>pad</var>を<var>sequence</var>[<var>s</var> + 2] &amp; 0x02 >> 1とする。
        </ol>
        <figure>
            <figcaption>mp3-ratesテーブル</figcaption>
            <table>
                <thead>
                    <tr>
                        <th>index
                        <th>mp3-rates
                <tbody>
                    <tr>
                        <td>0
                        <td>0
                    <tr>
                        <td>1
                        <td>32000
                    <tr>
                        <td>2
                        <td>40000
                    <tr>
                        <td>3
                        <td>48000
                    <tr>
                        <td>4
                        <td>56000
                    <tr>
                        <td>5
                        <td>64000
                    <tr>
                        <td>6
                        <td>80000
                    <tr>
                        <td>7
                        <td>96000
                    <tr>
                        <td>8
                        <td>112000
                    <tr>
                        <td>9
                        <td>128000
                    <tr>
                        <td>10
                        <td>160000
                    <tr>
                        <td>11
                        <td>192000
                    <tr>
                        <td>12
                        <td>224000
                    <tr>
                        <td>13
                        <td>256000
                    <tr>
                        <td>14
                        <td>320000
            </table>
        </figure>
        <figure>
            <figcaption>mp2.5-ratesテーブル</figcaption>
            <table>
                <thead>
                    <tr>
                        <th>index
                        <th>mp2.5-rates
                <tbody>
                    <tr>
                        <td>0
                        <td>0
                    <tr>
                        <td>1
                        <td>8000
                    <tr>
                        <td>2
                        <td>16000
                    <tr>
                        <td>3
                        <td>24000
                    <tr>
                        <td>4
                        <td>32000
                    <tr>
                        <td>5
                        <td>40000
                    <tr>
                        <td>6
                        <td>48000
                    <tr>
                        <td>7
                        <td>56000
                    <tr>
                        <td>8
                        <td>64000
                    <tr>
                        <td>9
                        <td>80000
                    <tr>
                        <td>10
                        <td>96000
                    <tr>
                        <td>11
                        <td>112000
                    <tr>
                        <td>12
                        <td>128000
                    <tr>
                        <td>13
                        <td>144000
                    <tr>
                        <td>14
                        <td>160000
            </table>
        </figure>
        <figure>
            <figcaption>sample-rateテーブル</figcaption>
            <table>
                <thead>
                    <tr>
                        <th>index
                        <th>samplerate
                <tbody>
                    <tr>
                        <td>0
                        <td>44100
                    <tr>
                        <td>1
                        <td>48000
                    <tr>
                        <td>2
                        <td>32000
            </table>
        </figure>
        <h3 class="heading settled" data-level="6.3" id="matching-a-font-type-pattern"><span class="secno">6.3.
            </span><span class="content">フォントタイプパターンの照合</span><a class="self-link"
                href="#matching-a-font-type-pattern"></a></h3>
        <p>どの<a data-link-type="dfn" href="#font-mime-type" id="ref-for-font-mime-type">フォントMIMEタイプ</a>の<a
                data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern⑦">バイトパターン</a>に<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence①⑦">バイト列</a><var>input</var>が一致するか（該当する場合）、次の<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-noexport
                id="font-type-pattern-matching-algorithm">フォントタイプパターンマッチングアルゴリズム</dfn>を利用する：</p>
        <ol>
            <li>
                <p>以下の表の各行<var>row</var>について、次の手順を実行する：</p>
                <ol>
                    <li>
                        <p><var>patternMatched</var>を、<a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm④">パターンマッチングアルゴリズム</a>に<var>input</var>、<var>row</var>の第1列・第2列・第3列の値を与えた結果とする。
                        </p>
                    <li>
                        <p><var>patternMatched</var>がtrueなら、<var>row</var>の第4列の値を返す。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th>
                                <a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern⑧">バイトパターン</a>
                            <th>
                                <a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask④">パターンマスク</a>
                            <th>
                                先頭の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④⓪">バイト</a>で無視するもの
                            <th>
                                <a data-link-type="dfn" href="#font-mime-type"
                                    id="ref-for-font-mime-type①">フォントMIMEタイプ</a>
                            <th>
                                備考
                    <tbody>
                        <tr>
                            <td>
                                00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
                                00 00 00 00 00 00 00 00 00 00 4C 50
                            <td>
                                00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
                                00 00 00 00 00 00 00 00 00 00 FF FF
                            <td>
                                なし。
                            <td>
                                <code>application/vnd.ms-fontobject</code>
                            <td>
                                34<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④①">バイト</a>の後に文字列"<code>LP</code>"、Embedded OpenTypeシグネチャ。
                        <tr>
                            <td>
                                00 01 00 00
                            <td>
                                FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>font/ttf</code>
                            <td>
                                4<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④②">バイト</a>でバージョン番号1.0を表す、TrueTypeシグネチャ。
                        <tr>
                            <td>
                                4F 54 54 4F
                            <td>
                                FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>font/otf</code>
                            <td>
                                文字列"<code>OTTO</code>"、OpenTypeシグネチャ。
                        <tr>
                            <td>
                                74 74 63 66
                            <td>
                                FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>font/collection</code>
                            <td>
                                文字列"<code>ttcf</code>"、TrueType Collectionシグネチャ。
                        <tr>
                            <td>
                                77 4F 46 46
                            <td>
                                FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>font/woff</code>
                            <td>
                                文字列"<code>wOFF</code>"、Web Open Font Format 1.0シグネチャ。
                        <tr>
                            <td>
                                77 4F 46 32
                            <td>
                                FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>font/woff2</code>
                            <td>
                                文字列"<code>wOF2</code>"、Web Open Font Format 2.0シグネチャ。
                </table>
            <li>
                <p>undefinedを返す。</p>
        </ol>

        <h3 class="heading settled" data-level="6.4" id="matching-an-archive-type-pattern"><span class="secno">6.4.
            </span><span class="content">アーカイブタイプパターンの照合</span><a class="self-link"
                href="#matching-an-archive-type-pattern"></a></h3>
        <p>どの<a data-link-type="dfn" href="#archive-mime-type" id="ref-for-archive-mime-type">アーカイブMIMEタイプ</a>の<a
                data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern⑨">バイトパターン</a>に<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence①⑧">バイト列</a><var>input</var>が一致するか（該当する場合）、次の<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-lt="archive type pattern matching algorithm" data-noexport
                id="archive-type-pattern-matching-algorithm">アーカイブタイプパターンマッチングアルゴリズム</dfn>を利用する：</p>
        <ol>
            <li>
                <p>以下の表の各行<var>row</var>について、次の手順を実行する：</p>
                <ol>
                    <li>
                        <p><var>patternMatched</var>を、<a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm⑤">パターンマッチングアルゴリズム</a>に<var>input</var>、<var>row</var>の第1列・第2列・第3列の値を与えた結果とする。
                        </p>
                    <li>
                        <p><var>patternMatched</var>がtrueなら、<var>row</var>の第4列の値を返す。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th>
                                <a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern①⓪">バイトパターン</a>
                            <th>
                                <a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask⑤">パターンマスク</a>
                            <th>
                                先頭の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④③">バイト</a>で無視するもの
                            <th>
                                <a data-link-type="dfn" href="#archive-mime-type"
                                    id="ref-for-archive-mime-type①">アーカイブMIMEタイプ</a>
                            <th>
                                備考
                    <tbody>
                        <tr>
                            <td>
                                1F 8B 08
                            <td>
                                FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>application/x-gzip</code>
                            <td>
                                GZIPアーカイブシグネチャ。
                        <tr>
                            <td>
                                50 4B 03 04
                            <td>
                                FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>application/zip</code>
                            <td>
                                文字列"<code>PK</code>"の後にETX EOT、ZIPアーカイブシグネチャ。
                        <tr>
                            <td>
                                52 61 72 21 1A 07 00
                            <td>
                                FF FF FF FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>application/x-rar-compressed</code>
                            <td>
                                文字列"<code>Rar!</code>"の後にSUB BEL NUL、RAR 4.xアーカイブシグネチャ。
                </table>
            <li>
                <p>undefinedを返す。</p>
        </ol>
        <h2 class="heading settled" data-level="7" id="determining-the-computed-mime-type-of-a-resource"><span
                class="secno">7. </span><span class="content">リソースの計算されたMIMEタイプの決定</span><a class="self-link"
                href="#determining-the-computed-mime-type-of-a-resource"></a></h2>
        <p>
            <a data-link-type="dfn" href="#resource" id="ref-for-resource①⑨">リソース</a>の<a data-link-type="dfn"
                href="#computed-mime-type" id="ref-for-computed-mime-type">算出MIMEタイプ</a>を決定するために、ユーザーエージェントは次の<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="mime-type-sniffing-algorithm">MIMEタイプスニッフィングアルゴリズム</dfn>を用いなければならない：
        </p>
        <ol>
            <li>
                <a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type⑤">指定MIMEタイプ</a>が<a
                    data-link-type="dfn" href="#xml-mime-type" id="ref-for-xml-mime-type③">XML MIMEタイプ</a>または<a
                    data-link-type="dfn" href="#html-mime-type" id="ref-for-html-mime-type①">HTML MIMEタイプ</a>の場合、<a
                    data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type①">算出MIMEタイプ</a>は<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type⑥">指定MIMEタイプ</a>とする。
                <p>これ以降の手順を中止する。</p>
            <li>
                <a data-link-type="dfn" href="#supplied-mime-type"
                    id="ref-for-supplied-mime-type⑦">指定MIMEタイプ</a>が未定義、または<a data-link-type="dfn"
                    href="#supplied-mime-type" id="ref-for-supplied-mime-type⑧">指定MIMEタイプ</a>の<a data-link-type="dfn"
                    href="#mime-type-essence"
                    id="ref-for-mime-type-essence①①">エッセンス</a>が"<code>unknown/unknown</code>"、"<code>application/unknown</code>"、または"<code>*/*</code>"の場合、<a
                    data-link-type="dfn" href="#sniff-scriptable-flag"
                    id="ref-for-sniff-scriptable-flag">sniff-scriptableフラグ</a>を<a data-link-type="dfn"
                    href="#no-sniff-flag" id="ref-for-no-sniff-flag">no-sniffフラグ</a>の逆にして<a data-link-type="dfn"
                    href="#rules-for-identifying-an-unknown-mime-type"
                    id="ref-for-rules-for-identifying-an-unknown-mime-type">不明なMIMEタイプ識別の規則</a>を実行し、これ以降の手順を中止する。
            <li>
                <a data-link-type="dfn" href="#no-sniff-flag" id="ref-for-no-sniff-flag①">no-sniffフラグ</a>が設定されている場合、<a
                    data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type②">算出MIMEタイプ</a>は<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type⑨">指定MIMEタイプ</a>とする。
                <p>これ以降の手順を中止する。</p>
            <li>
                <a data-link-type="dfn" href="#check-for-apache-bug-flag"
                    id="ref-for-check-for-apache-bug-flag①">Apacheバグ確認フラグ</a>が設定されている場合、<a data-link-type="dfn"
                    href="#rules-for-text-or-binary"
                    id="ref-for-rules-for-text-or-binary">リソースがテキストかバイナリか判別する規則</a>を実行し、これ以降の手順を中止する。
            <li>
                <a data-link-type="dfn" href="#supplied-mime-type"
                    id="ref-for-supplied-mime-type①⓪">指定MIMEタイプ</a>がユーザーエージェントで<a data-link-type="dfn"
                    href="#supported-by-the-user-agent" id="ref-for-supported-by-the-user-agent①">サポートされている</a><a
                    data-link-type="dfn" href="#image-mime-type"
                    id="ref-for-image-mime-type②">画像MIMEタイプ</a>の場合、<var>matched-type</var>を<a data-link-type="dfn"
                    href="#image-type-pattern-matching-algorithm"
                    id="ref-for-image-type-pattern-matching-algorithm">画像タイプパターンマッチングアルゴリズム</a>に<a data-link-type="dfn"
                    href="#resource-header" id="ref-for-resource-header②">リソースヘッダー</a>を<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence①⑨">バイト列</a>として与えた結果とする。
            <li>
                <var>matched-type</var>がundefinedでない場合、<a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type③">算出MIMEタイプ</a>は<var>matched-type</var>とする。
                <p>これ以降の手順を中止する。</p>
            <li>
                <a data-link-type="dfn" href="#supplied-mime-type"
                    id="ref-for-supplied-mime-type①①">指定MIMEタイプ</a>がユーザーエージェントで<a data-link-type="dfn"
                    href="#supported-by-the-user-agent" id="ref-for-supported-by-the-user-agent②">サポートされている</a><a
                    data-link-type="dfn" href="#audio-or-video-mime-type"
                    id="ref-for-audio-or-video-mime-type②">音声または動画MIMEタイプ</a>の場合、<var>matched-type</var>を<a
                    data-link-type="dfn" href="#audio-or-video-type-pattern-matching-algorithm"
                    id="ref-for-audio-or-video-type-pattern-matching-algorithm">音声または動画タイプパターンマッチングアルゴリズム</a>に<a
                    data-link-type="dfn" href="#resource-header" id="ref-for-resource-header③">リソースヘッダー</a>を<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence②⓪">バイト列</a>として与えた結果とする。
            <li>
                <var>matched-type</var>がundefinedでない場合、<a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type④">算出MIMEタイプ</a>は<var>matched-type</var>とする。
                <p>これ以降の手順を中止する。</p>
            <li>
                <a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type⑤">算出MIMEタイプ</a>は<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type①②">指定MIMEタイプ</a>とする。
        </ol>

        <h3 class="heading settled" data-level="7.1" id="identifying-a-resource-with-an-unknown-mime-type"><span
                class="secno">7.1. </span><span class="content">未知MIMEタイプのリソースの識別</span><a class="self-link"
                href="#identifying-a-resource-with-an-unknown-mime-type"></a></h3>
        <p>
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="sniff-scriptable-flag">sniff-scriptableフラグ</dfn>は、<a data-link-type="dfn"
                href="#rules-for-identifying-an-unknown-mime-type"
                id="ref-for-rules-for-identifying-an-unknown-mime-type①">不明なMIMEタイプ識別の規則</a>において、<a data-link-type="dfn"
                href="#scriptable-mime-type"
                id="ref-for-scriptable-mime-type">スクリプト可能MIMEタイプ</a>をスニッフィングするかどうか決定するために使用される。
        </p>
        <p>
            <a data-link-type="dfn" href="#rules-for-identifying-an-unknown-mime-type"
                id="ref-for-rules-for-identifying-an-unknown-mime-type②">不明なMIMEタイプ識別の規則</a>を呼び出す際に<a
                data-link-type="dfn" href="#sniff-scriptable-flag"
                id="ref-for-sniff-scriptable-flag①">sniff-scriptableフラグ</a>の設定が指定されていない場合、<a data-link-type="dfn"
                href="#sniff-scriptable-flag"
                id="ref-for-sniff-scriptable-flag②">sniff-scriptableフラグ</a>は既定で未設定としなければならない。
        </p>
        <p>
            不明な<a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②⑨">MIMEタイプ</a>を持つ<a data-link-type="dfn"
                href="#resource" id="ref-for-resource②⓪">リソース</a><var>resource</var>の<a data-link-type="dfn"
                href="#computed-mime-type" id="ref-for-computed-mime-type⑥">算出MIMEタイプ</a>を決定するには、次の<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-lt="rules for identifying an unknown MIME type"
                data-noexport id="rules-for-identifying-an-unknown-mime-type">不明なMIMEタイプ識別の規則</dfn>を実行する：
        </p>
        <ol>
            <li>
                <p><a data-link-type="dfn" href="#sniff-scriptable-flag"
                        id="ref-for-sniff-scriptable-flag③">sniff-scriptableフラグ</a>が設定されている場合、次の表の各行<var>row</var>について以下の手順を実行する：
                </p>
                <ol>
                    <li>
                        <p><var>patternMatched</var>を、<a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm⑥">パターンマッチングアルゴリズム</a>に<var>resource</var>の<a
                                data-link-type="dfn" href="#resource-header"
                                id="ref-for-resource-header④">リソースヘッダー</a>、<var>row</var>の第1列・第2列・第3列の値を与えた結果とする。</p>
                    <li>
                        <p><var>patternMatched</var>がtrueなら、<var>row</var>の第4列の値を返す。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th>
                                <a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern①①">バイトパターン</a>
                            <th>
                                <a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask⑥">パターンマスク</a>
                            <th>
                                先頭の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④④">バイト</a>で無視するもの
                            <th>
                                <a data-link-type="dfn" href="#computed-mime-type"
                                    id="ref-for-computed-mime-type⑦">算出MIMEタイプ</a>
                            <th>
                                備考
                    <tbody>
                        <tr>
                            <td>
                                3C 21 44 4F 43 54 59 50 45 20 48 54 4D 4C <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF FF DF DF DF DF DF DF DF FF DF DF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;!DOCTYPE HTML</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 48 54 4D 4C <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF DF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte①">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;HTML</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte①">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 48 45 41 44 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF DF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte②">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;HEAD</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte②">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 53 43 52 49 50 54 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF DF DF DF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte③">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;SCRIPT</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte③">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 49 46 52 41 4D 45 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF DF DF DF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte④">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;IFRAME</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte④">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 48 31 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF FF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte⑤">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;H1</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte⑤">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 44 49 56 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte⑥">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;DIV</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte⑥">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 46 4F 4E 54 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF DF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte⑦">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;FONT</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte⑦">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 54 41 42 4C 45 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF DF DF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte⑧">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;TABLE</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte⑧">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 41 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte⑨">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;A</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte⑨">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 53 54 59 4C 45 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF DF DF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte"
                                    id="ref-for-whitespace-byte①⓪">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;STYLE</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte①⓪">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 54 49 54 4C 45 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF DF DF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte"
                                    id="ref-for-whitespace-byte①①">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;TITLE</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte①①">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 42 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte"
                                    id="ref-for-whitespace-byte①②">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;B</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte①②">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 42 4F 44 59 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF DF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte"
                                    id="ref-for-whitespace-byte①③">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;BODY</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte①③">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 42 52 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte"
                                    id="ref-for-whitespace-byte①④">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;BR</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte①④">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 50 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF DF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte"
                                    id="ref-for-whitespace-byte①⑤">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                大文字小文字を区別しない文字列"<code>&lt;P</code>"の後に<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte①⑤">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 21 2D 2D <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>
                                FF FF FF FF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte"
                                    id="ref-for-whitespace-byte①⑥">空白バイト</a>。
                            <td>
                                <code>text/html</code>
                            <td>
                                文字列"<code>&lt;!--</code>"の後に<a data-link-type="dfn" href="#tag-terminating-byte"
                                    id="ref-for-tag-terminating-byte①⑥">タグ終了バイト</a>。
                        <tr>
                            <td>
                                3C 3F 78 6D 6C
                            <td>
                                FF FF FF FF FF
                            <td>
                                <a data-link-type="dfn" href="#whitespace-byte"
                                    id="ref-for-whitespace-byte①⑦">空白バイト</a>。
                            <td>
                                <code>text/xml</code>
                            <td>
                                文字列"<code>&lt;?xml</code>"。
                        <tr>
                            <td>
                                25 50 44 46 2D
                            <td>
                                FF FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>application/pdf</code>
                            <td>
                                文字列"<code>%PDF-</code>"、PDFシグネチャ。
                </table>
            <li>
                <p>次の表の各行<var>row</var>について、以下の手順を実行する：</p>
                <ol>
                    <li>
                        <p><var>patternMatched</var>を、<a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm⑦">パターンマッチングアルゴリズム</a>に<var>resource</var>の<a
                                data-link-type="dfn" href="#resource-header"
                                id="ref-for-resource-header⑤">リソースヘッダー</a>、<var>row</var>の第1列・第2列・第3列の値を与えた結果とする。</p>
                    <li>
                        <p><var>patternMatched</var>がtrueなら、<var>row</var>の第4列の値を返す。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th>
                                <a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern①②">バイトパターン</a>
                            <th>
                                <a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask⑦">パターンマスク</a>
                            <th>
                                先頭の<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④⑤">バイト</a>で無視するもの
                            <th>
                                <a data-link-type="dfn" href="#computed-mime-type"
                                    id="ref-for-computed-mime-type⑧">算出MIMEタイプ</a>
                            <th>
                                備考
                    <tbody>
                        <tr>
                            <td>
                                25 21 50 53 2D 41 64 6F 62 65 2D
                            <td>
                                FF FF FF FF FF FF FF FF FF FF FF
                            <td>
                                なし。
                            <td>
                                <code>application/postscript</code>
                            <td>
                                文字列"<code>%!PS-Adobe-</code>"、PostScriptシグネチャ。
                        <tr>
                            <td>
                                FE FF 00 00
                            <td>
                                FF FF 00 00
                            <td>
                                なし。
                            <td>
                                <code>text/plain</code>
                            <td>
                                UTF-16BE BOM
                        <tr>
                            <td>
                                FF FE 00 00
                            <td>
                                FF FF 00 00
                            <td>
                                なし。
                            <td>
                                <code>text/plain</code>
                            <td>
                                UTF-16LE BOM
                        <tr>
                            <td>
                                EF BB BF 00
                            <td>
                                FF FF FF 00
                            <td>
                                なし。
                            <td>
                                <code>text/plain</code>
                            <td>
                                UTF-8 BOM
                </table>
                <p>ユーザーエージェントは、追加の<a data-link-type="dfn" href="#mime-type"
                        id="ref-for-mime-type③⓪">MIMEタイプ</a>をサポートするために、この表を暗黙的に拡張してもよい。</p>
                <p>ただし、ユーザーエージェントは、この表にすでに存在する<a data-link-type="dfn" href="#computed-mime-type"
                        id="ref-for-computed-mime-type⑨">算出MIMEタイプ</a>について追加の<a data-link-type="dfn"
                        href="#byte-pattern"
                        id="ref-for-byte-pattern①③">バイトパターン</a>を暗黙的に追加すべきではない。そうすると権限昇格の脆弱性を招くおそれがあるためである。</p>
                <p>ユーザーエージェントは、この表を拡張する際に権限昇格の脆弱性を導入してはならない。</p>
            <li>
                <p><var>matchedType</var>を、<a data-link-type="dfn" href="#image-type-pattern-matching-algorithm"
                        id="ref-for-image-type-pattern-matching-algorithm①">画像タイプパターンマッチングアルゴリズム</a>に<var>resource</var>の<a
                        data-link-type="dfn" href="#resource-header"
                        id="ref-for-resource-header⑥">リソースヘッダー</a>を与えて実行した結果とする。</p>
            <li>
                <p><var>matchedType</var>がundefinedでない場合、<var>matchedType</var>を返す。</p>
            <li>
                <p><var>matchedType</var>を、<a data-link-type="dfn"
                        href="#audio-or-video-type-pattern-matching-algorithm"
                        id="ref-for-audio-or-video-type-pattern-matching-algorithm①">音声または動画タイプパターンマッチングアルゴリズム</a>に<var>resource</var>の<a
                        data-link-type="dfn" href="#resource-header"
                        id="ref-for-resource-header⑦">リソースヘッダー</a>を与えて実行した結果とする。</p>
            <li>
                <p><var>matchedType</var>がundefinedでない場合、<var>matchedType</var>を返す。</p>
            <li>
                <p><var>matchedType</var>を、<a data-link-type="dfn" href="#archive-type-pattern-matching-algorithm"
                        id="ref-for-archive-type-pattern-matching-algorithm">アーカイブタイプパターンマッチングアルゴリズム</a>に<var>resource</var>の<a
                        data-link-type="dfn" href="#resource-header"
                        id="ref-for-resource-header⑧">リソースヘッダー</a>を与えて実行した結果とする。</p>
            <li>
                <p><var>matchedType</var>がundefinedでない場合、<var>matchedType</var>を返す。</p>
            <li>
                <p><var>resource</var>の<a data-link-type="dfn" href="#resource-header"
                        id="ref-for-resource-header⑨">リソースヘッダー</a>に<a data-link-type="dfn" href="#binary-data-byte"
                        id="ref-for-binary-data-byte">バイナリデータバイト</a>が含まれていない場合、"<code>text/plain</code>"を返す。</p>
            <li>
                <p>"<code>application/octet-stream</code>"を返す。</p>
        </ol>
        <h3 class="heading settled" data-level="7.2" id="sniffing-a-mislabeled-binary-resource"><span class="secno">7.2.
            </span><span class="content">誤ラベルされたバイナリリソースのスニッフィング</span><a class="self-link"
                href="#sniffing-a-mislabeled-binary-resource"></a></h3>
        <p>
            バイナリ<a data-link-type="dfn" href="#resource"
                id="ref-for-resource②①">リソース</a>がプレーンテキストとして誤ってラベル付けされているかどうかを判定するには、次の<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-lt="rules for distinguishing if a resource is text or binary" data-noexport
                id="rules-for-text-or-binary">リソースがテキストかバイナリか判別する規則</dfn>を実行する：
        </p>
        <ol>
            <li>
                <var>length</var>を<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte④⑥">バイト</a>数として<a data-link-type="dfn" href="#resource-header"
                    id="ref-for-resource-header①⓪">リソースヘッダー</a>の長さとする。
            <li>
                <var>length</var>が2以上かつ<a data-link-type="dfn" href="#resource-header"
                    id="ref-for-resource-header①①">リソースヘッダー</a>の最初の2バイトが0xFE 0xFF（UTF-16BE BOM）または0xFF 0xFE（UTF-16LE
                BOM）に等しい場合、<a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type①⓪">算出MIMEタイプ</a>は"<code>text/plain</code>"とする。
                <p>これ以降の手順を中止する。</p>
            <li>
                <var>length</var>が3以上かつ<a data-link-type="dfn" href="#resource-header"
                    id="ref-for-resource-header①②">リソースヘッダー</a>の最初の3バイトが0xEF 0xBB 0xBF（UTF-8 BOM）に等しい場合、<a
                    data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type①①">算出MIMEタイプ</a>は"<code>text/plain</code>"とする。
                <p>これ以降の手順を中止する。</p>
            <li>
                <a data-link-type="dfn" href="#resource-header" id="ref-for-resource-header①③">リソースヘッダー</a>に<a
                    data-link-type="dfn" href="#binary-data-byte"
                    id="ref-for-binary-data-byte①">バイナリデータバイト</a>が含まれていない場合、<a data-link-type="dfn"
                    href="#computed-mime-type"
                    id="ref-for-computed-mime-type①②">算出MIMEタイプ</a>は"<code>text/plain</code>"とする。
                <p>これ以降の手順を中止する。</p>
            <li>
                <a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type①③">算出MIMEタイプ</a>は"<code>application/octet-stream</code>"とする。
                <p class="warning">
                    <a data-link-type="dfn" href="#rules-for-text-or-binary"
                        id="ref-for-rules-for-text-or-binary①">リソースがテキストかバイナリか判別する規則</a>が<a data-link-type="dfn"
                        href="#computed-mime-type" id="ref-for-computed-mime-type①④">算出MIMEタイプ</a>として<a
                        data-link-type="dfn" href="#scriptable-mime-type"
                        id="ref-for-scriptable-mime-type①">スクリプト可能MIMEタイプ</a>を決定してはならない。これは権限昇格攻撃を許すおそれがあるためである。
                </p>
        </ol>
        <h2 class="heading settled" data-level="8" id="context-specific-sniffing"><span class="secno">8. </span><span
                class="content">コンテキスト固有のスニッフィング</span><a class="self-link" href="#context-specific-sniffing"></a>
        </h2>
        <p class="XXX">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="context">コンテキスト</dfn>とは……。
        </p>
        <p>
            特定の<a data-link-type="dfn" href="#context" id="ref-for-context">コンテキスト</a>では、特定のサブセットの<a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type③①">MIMEタイプ</a>に属する<a data-link-type="dfn"
                href="#resource" id="ref-for-resource②②">リソース</a>のみを識別することが有用な場合がある。
        </p>
        <p>
            そのような<a data-link-type="dfn" href="#context" id="ref-for-context①">コンテキスト</a>では、<a data-link-type="dfn"
                href="#resource" id="ref-for-resource②③">リソース</a>の<a data-link-type="dfn" href="#computed-mime-type"
                id="ref-for-computed-mime-type①⑤">算出MIMEタイプ</a>を決定する際に、<a data-link-type="dfn"
                href="#mime-type-sniffing-algorithm"
                id="ref-for-mime-type-sniffing-algorithm③">MIMEタイプスニッフィングアルゴリズム</a>の代わりに<a data-link-type="dfn"
                href="#context-specific-sniffing-algorithm"
                id="ref-for-context-specific-sniffing-algorithm">コンテキスト固有スニッフィングアルゴリズム</a>を用いるのが適切である。
        </p>
        <p>
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="context-specific-sniffing-algorithm">コンテキスト固有スニッフィングアルゴリズム</dfn>は、特定の<a data-link-type="dfn"
                href="#context" id="ref-for-context②">コンテキスト</a>に関連する<a data-link-type="dfn" href="#mime-type"
                id="ref-for-mime-type③②">MIMEタイプ</a>である<a data-link-type="dfn" href="#resource"
                id="ref-for-resource②⑤">リソース</a>の場合のみ、その<a data-link-type="dfn" href="#resource"
                id="ref-for-resource②④">リソース</a>の<a data-link-type="dfn" href="#computed-mime-type"
                id="ref-for-computed-mime-type①⑥">算出MIMEタイプ</a>を決定する。
        </p>

        <h3 class="heading settled" data-level="8.1" id="sniffing-in-a-browsing-context"><span class="secno">8.1.
            </span><span class="content">ブラウジングコンテキストでのスニッフィング</span><a class="self-link"
                href="#sniffing-in-a-browsing-context"></a></h3>
        <p class="XXX">
            <a data-link-type="dfn" href="#mime-type-sniffing-algorithm"
                id="ref-for-mime-type-sniffing-algorithm5">MIMEタイプスニッフィングアルゴリズム</a>を使用する。
        </p>
        <h3 class="heading settled" data-level="8.2" id="sniffing-in-an-image-context"><span class="secno">8.2.
            </span><span class="content">画像コンテキストでのスニッフィング</span><a class="self-link"
                href="#sniffing-in-an-image-context"></a></h3>
        <p>
            <a data-link-type="dfn" href="#image-mime-type" id="ref-for-image-mime-type4">画像MIMEタイプ</a>の<a
                data-link-type="dfn" href="#resource" id="ref-for-resource23">リソース</a>について<a data-link-type="dfn"
                href="#computed-mime-type" id="ref-for-computed-mime-type18">計算されたMIMEタイプ</a>を決定するには、以下の<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="rules for sniffing images specifically"
                id="rules-for-sniffing-images-specifically">画像専用スニッフィング規則</dfn>を実行する：
        </p>
        <ol>
            <li>
                <a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type14">提供MIMEタイプ</a>が<a
                    data-link-type="dfn" href="#xml-mime-type" id="ref-for-xml-mime-type3">XML MIMEタイプ</a>の場合、<a
                    data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type19">計算されたMIMEタイプ</a>は<a data-link-type="dfn"
                    href="#supplied-mime-type" id="ref-for-supplied-mime-type15">提供MIMEタイプ</a>とする。
                <p>これらの手順を中止する。</p>
            <li>
                <var>image-type-matched</var>を<a data-link-type="dfn" href="#image-type-pattern-matching-algorithm"
                    id="ref-for-image-type-pattern-matching-algorithm3">画像タイプパターン照合アルゴリズム</a>を<a data-link-type="dfn"
                    href="#resource-header" id="ref-for-resource-header13">リソースヘッダー</a>（照合する<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence21">バイト列</a>）で実行した結果とする。
            <li>
                <var>image-type-matched</var>がundefinedでない場合、<a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type20">計算されたMIMEタイプ</a>は<var>image-type-matched</var>とする。
                <p>これらの手順を中止する。</p>
            <li>
                <a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type21">計算されたMIMEタイプ</a>は<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type16">提供MIMEタイプ</a>とする。
        </ol>
        <h3 class="heading settled" data-level="8.3" id="sniffing-in-an-audio-or-video-context"><span class="secno">8.3.
            </span><span class="content">音声／動画コンテキストでのスニッフィング</span><a class="self-link"
                href="#sniffing-in-an-audio-or-video-context"></a></h3>
        <p>
            <a data-link-type="dfn" href="#audio-or-video-mime-type"
                id="ref-for-audio-or-video-mime-type4">音声または動画MIMEタイプ</a>の<a data-link-type="dfn" href="#resource"
                id="ref-for-resource24">リソース</a>について<a data-link-type="dfn" href="#computed-mime-type"
                id="ref-for-computed-mime-type22">計算されたMIMEタイプ</a>を決定するには、以下の<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-export data-lt="rules for sniffing audio and video specifically"
                id="rules-for-sniffing-audio-and-video-specifically">音声・動画専用スニッフィング規則</dfn>を実行する：
        </p>
        <ol>
            <li>
                <a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type17">提供MIMEタイプ</a>が<a
                    data-link-type="dfn" href="#xml-mime-type" id="ref-for-xml-mime-type4">XML MIMEタイプ</a>の場合、<a
                    data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type23">計算されたMIMEタイプ</a>は<a data-link-type="dfn"
                    href="#supplied-mime-type" id="ref-for-supplied-mime-type18">提供MIMEタイプ</a>とする。
                <p>これらの手順を中止する。</p>
            <li>
                <var>audio-or-video-type-matched</var>を<a data-link-type="dfn"
                    href="#audio-or-video-type-pattern-matching-algorithm"
                    id="ref-for-audio-or-video-type-pattern-matching-algorithm3">音声／動画タイプパターン照合アルゴリズム</a>を<a
                    data-link-type="dfn" href="#resource-header" id="ref-for-resource-header14">リソースヘッダー</a>（照合する<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence22">バイト列</a>）で実行した結果とする。
            <li>
                <var>audio-or-video-type-matched</var>がundefinedでない場合、<a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type24">計算されたMIMEタイプ</a>は<var>audio-or-video-type-matched</var>とする。
                <p>これらの手順を中止する。</p>
            <li>
                <a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type25">計算されたMIMEタイプ</a>は<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type19">提供MIMEタイプ</a>とする。
        </ol>
        <h3 class="heading settled" data-level="8.4" id="sniffing-in-a-plugin-context"><span class="secno">8.4.
            </span><span class="content">プラグインコンテキストでのスニッフィング</span><a class="self-link"
                href="#sniffing-in-a-plugin-context"></a></h3>
        <p>
            プラグインコンテキストで<a data-link-type="dfn" href="#resource" id="ref-for-resource25">リソース</a>が<a
                data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
                id="ref-for-concept-fetch">フェッチ</a>された場合、<a data-link-type="dfn" href="#computed-mime-type"
                id="ref-for-computed-mime-type26">計算されたMIMEタイプ</a>を決定するには、以下の<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-export
                id="rules-for-sniffing-in-a-plugin-context">プラグインコンテキスト専用スニッフィング規則</dfn>を実行する：
        </p>
        <ol>
            <li class="XXX">
                <a data-link-type="dfn" href="#supplied-mime-type"
                    id="ref-for-supplied-mime-type20">提供MIMEタイプ</a>が未定義の場合、<a data-link-type="dfn"
                    href="#computed-mime-type"
                    id="ref-for-computed-mime-type27">計算されたMIMEタイプ</a>は"<code>application/octet-stream</code>"とする。
            <li>
                <a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type28">計算されたMIMEタイプ</a>は<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type21">提供MIMEタイプ</a>とする。
        </ol>
        <h3 class="heading settled" data-level="8.5" id="sniffing-in-a-style-context"><span class="secno">8.5.
            </span><span class="content">スタイルコンテキストでのスニッフィング</span><a class="self-link"
                href="#sniffing-in-a-style-context"></a></h3>
        <p>
            スタイルコンテキストで<a data-link-type="dfn" href="#resource" id="ref-for-resource②⑨">リソース</a>が<a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch①">フェッチ</a>された場合、その<a
                data-link-type="dfn" href="#computed-mime-type"
                id="ref-for-computed-mime-type②⑧">算出MIMEタイプ</a>を決定するには、次の<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-export id="rules-for-sniffing-in-a-style-context">スタイルコンテキストにおけるスニッフィング規則</dfn>を実行する：
        </p>
        <ol>
            <li class="XXX">
                <a data-link-type="dfn" href="#supplied-mime-type"
                    id="ref-for-supplied-mime-type②①">指定MIMEタイプ</a>が未定義の場合、…。
            <li>
                <a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type②⑨">算出MIMEタイプ</a>は<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type②②">指定MIMEタイプ</a>とする。
        </ol>

        <h3 class="heading settled" data-level="8.6" id="sniffing-in-a-script-context"><span class="secno">8.6.
            </span><span class="content">スクリプトコンテキストでのスニッフィング</span><a class="self-link"
                href="#sniffing-in-a-script-context"></a></h3>
        <p>
            スクリプトコンテキストで<a data-link-type="dfn" href="#resource" id="ref-for-resource27">リソース</a>が<a
                data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
                id="ref-for-concept-fetch3">フェッチ</a>された場合、<a data-link-type="dfn" href="#computed-mime-type"
                id="ref-for-computed-mime-type31">計算されたMIMEタイプ</a>を決定するには、以下の<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-export
                id="rules-for-sniffing-in-a-script-context">スクリプトコンテキスト専用スニッフィング規則</dfn>を実行する：
        </p>
        <ol>
            <li class="XXX">
                <a data-link-type="dfn" href="#supplied-mime-type"
                    id="ref-for-supplied-mime-type24">提供MIMEタイプ</a>が未定義の場合、 ….
            <li>
                <a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type32">計算されたMIMEタイプ</a>は<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type25">提供MIMEタイプ</a>とする。
        </ol>
        <h3 class="heading settled" data-level="8.7" id="sniffing-in-a-font-context"><span class="secno">8.7.
            </span><span class="content">フォントコンテキストでのスニッフィング</span><a class="self-link"
                href="#sniffing-in-a-font-context"></a></h3>
        <p>
            <a data-link-type="dfn" href="#font-mime-type" id="ref-for-font-mime-type3">フォントMIMEタイプ</a>の<a
                data-link-type="dfn" href="#resource" id="ref-for-resource28">リソース</a>について<a data-link-type="dfn"
                href="#computed-mime-type" id="ref-for-computed-mime-type33">計算されたMIMEタイプ</a>を決定するには、以下の<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="rules for sniffing fonts specifically"
                id="rules-for-sniffing-fonts-specifically">フォント専用スニッフィング規則</dfn>を実行する：
        </p>
        <ol>
            <li>
                <a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type26">提供MIMEタイプ</a>が<a
                    data-link-type="dfn" href="#xml-mime-type" id="ref-for-xml-mime-type5">XML MIMEタイプ</a>の場合、<a
                    data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type34">計算されたMIMEタイプ</a>は<a data-link-type="dfn"
                    href="#supplied-mime-type" id="ref-for-supplied-mime-type27">提供MIMEタイプ</a>とする。
                <p>これらの手順を中止する。</p>
            <li>
                <var>font-type-matched</var>を<a data-link-type="dfn" href="#font-type-pattern-matching-algorithm"
                    id="ref-for-font-type-pattern-matching-algorithm">フォントタイプパターン照合アルゴリズム</a>を<a data-link-type="dfn"
                    href="#resource-header" id="ref-for-resource-header15">リソースヘッダー</a>（照合する<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence23">バイト列</a>）で実行した結果とする。
            <li>
                <var>font-type-matched</var>がundefinedでない場合、<a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type35">計算されたMIMEタイプ</a>は<var>font-type-matched</var>とする。
                <p>これらの手順を中止する。</p>
            <li>
                <a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type36">計算されたMIMEタイプ</a>は<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type28">提供MIMEタイプ</a>とする。
        </ol>
        <h3 class="heading settled" data-level="8.8" id="sniffing-in-a-text-track-context"><span class="secno">8.8.
            </span><span class="content">テキストトラックコンテキストでのスニッフィング</span><a class="self-link"
                href="#sniffing-in-a-text-track-context"></a></h3>
        <p class="XXX">
            <a data-link-type="dfn" href="#computed-mime-type"
                id="ref-for-computed-mime-type37">計算されたMIMEタイプ</a>は"<code>text/vtt</code>"。
        </p>
        <h3 class="heading settled" data-level="8.9" id="sniffing-in-a-cache-manifest-context"><span class="secno">8.9.
            </span><span class="content">キャッシュマニフェストコンテキストでのスニッフィング</span><a class="self-link"
                href="#sniffing-in-a-cache-manifest-context"></a></h3>
        <p class="XXX">
            <a data-link-type="dfn" href="#computed-mime-type"
                id="ref-for-computed-mime-type38">計算されたMIMEタイプ</a>は"<code>text/cache-manifest</code>"。
        </p>
        <h2 class="no-num heading settled" id="acknowledgements"><span class="content">謝辞</span><a class="self-link"
                href="#acknowledgements"></a></h2>
        <p>
            この文書の過去の版を管理したAdam Barth氏とIan Hickson氏に特別な感謝を。
        </p>
        <p>
            また、以下の方々にも感謝します：
            Alfred Hönes、
            Andreu Botella、
            Anne van Kesteren、
            Ben Eidson、
            Boris Zbarsky、
            Darien Maillet Valentine、
            David Singer、
            Domenic Denicola、
            Henri Sivonen、
            Jean-Yves Avenard、
            Jonathan Neal、
            Joshua Cranmer、
            Larry Masinter、
            罗泽轩、
            Mariko Kosaka、
            Mark Pilgrim、
            Paul Adenot、
            Peter Occil、
            Rob Buis、
            Russ Cox、
            Simon Pieters、
            triple-underscore
            ― 彼らの多大な貢献に感謝いたします。
        </p>
        <p>この現行標準は<a href="https://gphemsley.org/">Gordon P. Hemsley</a>
            (<a href="mailto:me@gphemsley.org">me@gphemsley.org</a>)によって執筆されています。
        </p>
        <h2 class="no-num heading settled" id="ipr"><span class="content">知的財産権</span><a class="self-link"
                href="#ipr"></a></h2>
        <p>Copyright © WHATWG (Apple, Google, Mozilla, Microsoft)。本作業は<a
                href="https://creativecommons.org/licenses/by/4.0/" rel="license">クリエイティブ・コモンズ 表示 4.0
                国際ライセンス</a>の下でライセンスされています。一部がソースコードに組み込まれている場合、その部分は<a
                href="https://opensource.org/licenses/BSD-3-Clause" rel="license">BSD 3-Clause License</a>の下でライセンスされます。
        </p>
        <p>これは現行標準です。
            特許審査版に興味のある方は
            <a href="/review-drafts/2025-07/">現行標準レビュー草案</a>をご覧ください。
        </p>
    </main>
    <script>
        // "use strict";
        // if ("serviceWorker" in navigator) {
        //     navigator.serviceWorker.register("/service-worker.js");
        // }
    </script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本仕様で定義される用語</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#archive-mime-type">アーカイブMIMEタイプ</a><span>、§ 4.6</span>
        <li><a href="#archive-type-pattern-matching-algorithm">アーカイブタイプパターン照合アルゴリズム</a><span>、§ 6.4</span>
        <li><a href="#audio-or-video-mime-type">音声または動画MIMEタイプ</a><span>、§ 4.6</span>
        <li><a href="#audio-or-video-type-pattern-matching-algorithm">音声／動画タイプパターン照合アルゴリズム</a><span>、§ 6.2</span>
        <li><a href="#binary-data-byte">バイナリデータバイト</a><span>、§ 3</span>
        <li><a href="#byte-pattern">バイトパターン</a><span>、§ 6</span>
        <li><a href="#check-for-apache-bug-flag">Apacheバグ検査フラグ</a><span>、§ 5</span>
        <li><a href="#compute-an-mp3-frame-size">mp3フレームサイズ計算</a><span>、§ 6.2.3</span>
        <li><a href="#computed-mime-type">計算されたMIMEタイプ</a><span>、§ 5</span>
        <li><a href="#context">コンテキスト</a><span>、§ 8</span>
        <li><a href="#context-specific-sniffing-algorithm">コンテキスト固有のスニッフィングアルゴリズム</a><span>、§ 8</span>
        <li><a href="#mime-type-essence">本質</a><span>、§ 4.2</span>
        <li><a href="#font-mime-type">フォントMIMEタイプ</a><span>、§ 4.6</span>
        <li><a href="#font-type-pattern-matching-algorithm">フォントタイプパターン照合アルゴリズム</a><span>、§ 6.3</span>
        <li><a href="#html-mime-type">HTML MIMEタイプ</a><span>、§ 4.6</span>
        <li><a href="#http-quoted-string-token-code-point">HTTP引用文字列トークンコードポイント</a><span>、§ 3</span>
        <li><a href="#http-token-code-point">HTTPトークンコードポイント</a><span>、§ 3</span>
        <li><a href="#image-mime-type">画像MIMEタイプ</a><span>、§ 4.6</span>
        <li><a href="#image-type-pattern-matching-algorithm">画像タイプパターン照合アルゴリズム</a><span>、§ 6.1</span>
        <li><a href="#javascript-mime-type">JavaScript MIMEタイプ</a><span>、§ 4.6</span>
        <li><a href="#javascript-mime-type-essence-match">JavaScript MIMEタイプ本質一致</a><span>、§ 4.6</span>
        <li><a href="#json-mime-type">JSON MIMEタイプ</a><span>、§ 4.6</span>
        <li><a href="#match-an-mp3-header">mp3ヘッダー照合</a><span>、§ 6.2.3</span>
        <li><a href="#matches-the-signature-for-mp3-without-id3">ID3なしMP3のシグネチャと一致する</a><span>、§ 6.2.3</span>
        <li><a href="#matches-the-signature-for-mp4">MP4のシグネチャと一致する</a><span>、§ 6.2.1</span>
        <li><a href="#matches-the-signature-for-webm">WebMのシグネチャと一致する</a><span>、§ 6.2.2</span>
        <li><a href="#matching-a-padded-sequence">パディング付きシーケンス照合</a><span>、§ 6.2.2</span>
        <li><a href="#mime-type">MIMEタイプ</a><span>、§ 4.1</span>
        <li><a href="#mime-type">MIMEタイプレコード</a><span>、§ 4.1</span>
        <li><a href="#mime-type-sniffing-algorithm">MIMEタイプスニッフィングアルゴリズム</a><span>、§ 7</span>
        <li><a href="#minimize-a-supported-mime-type">サポートMIMEタイプの最小化</a><span>、§ 4.2</span>
        <li><a href="#no-sniff-flag">no-sniffフラグ</a><span>、§ 5</span>
        <li><a href="#parameters">パラメータ</a><span>、§ 4.1</span>
        <li><a href="#parse-a-mime-type">MIMEタイプの構文解析</a><span>、§ 4.4</span>
        <li><a href="#parse-a-mime-type-from-bytes">バイト列からMIMEタイプを構文解析</a><span>、§ 4.4</span>
        <li><a href="#parse-an-mp3-frame">mp3フレーム解析</a><span>、§ 6.2.3</span>
        <li><a href="#parse-a-vint">vintのパース</a><span>、§ 6.2.2</span>
        <li><a href="#pattern-mask">パターンマスク</a><span>、§ 6</span>
        <li><a href="#pattern-matching-algorithm">パターン照合アルゴリズム</a><span>、§ 6</span>
        <li><a href="#read-the-resource-header">リソースヘッダーの読み取り</a><span>、§ 5.2</span>
        <li><a href="#resource">リソース</a><span>、§ 5</span>
        <li><a href="#resource-header">リソースヘッダー</a><span>、§ 5.2</span>
        <li><a href="#rules-for-text-or-binary">リソースがテキストかバイナリかの判別規則</a><span>、§ 7.2</span>
        <li><a href="#rules-for-identifying-an-unknown-mime-type">未知MIMEタイプ識別規則</a><span>、§ 7.1</span>
        <li><a href="#rules-for-sniffing-audio-and-video-specifically">音声・動画専用スニッフィング規則</a><span>、§ 8.3</span>
        <li><a href="#rules-for-sniffing-fonts-specifically">フォント専用スニッフィング規則</a><span>、§ 8.7</span>
        <li><a href="#rules-for-sniffing-images-specifically">画像専用スニッフィング規則</a><span>、§ 8.2</span>
        <li><a href="#rules-for-sniffing-in-a-plugin-context">プラグインコンテキスト専用スニッフィング規則</a><span>、§ 8.4</span>
        <li><a href="#rules-for-sniffing-in-a-script-context">スクリプトコンテキスト専用スニッフィング規則</a><span>、§ 8.6</span>
        <li><a href="#rules-for-sniffing-in-a-style-context">スタイルコンテキスト専用スニッフィング規則</a><span>、§ 8.5</span>
        <li><a href="#scriptable-mime-type">スクリプト可能MIMEタイプ</a><span>、§ 4.6</span>
        <li><a href="#serialize-a-mime-type">MIMEタイプの直列化</a><span>、§ 4.5</span>
        <li><a href="#serialize-a-mime-type-to-bytes">MIMEタイプをバイト列に直列化</a><span>、§ 4.5</span>
        <li><a href="#sniff-scriptable-flag">sniff-scriptableフラグ</a><span>、§ 7.1</span>
        <li><a href="#subtype">subtype</a><span>、§ 4.1</span>
        <li><a href="#supplied-mime-type">提供MIMEタイプ</a><span>、§ 5</span>
        <li><a href="#supplied-mime-type-detection-algorithm">提供MIMEタイプ検出アルゴリズム</a><span>、§ 5.1</span>
        <li><a href="#supported-by-the-user-agent">ユーザーエージェントがサポートする</a><span>、§ 4.2</span>
        <li><a href="#tag-terminating-byte">タグ終端バイト</a><span>、§ 3</span>
        <li><a href="#type">type</a><span>、§ 4.1</span>
        <li><a href="#valid-mime-type">有効なMIMEタイプ文字列</a><span>、§ 4.3</span>
        <li><a href="#valid-mime-type-with-no-parameters">パラメータなし有効MIMEタイプ文字列</a><span>、§ 4.3</span>
        <li><a href="#whitespace-byte">空白バイト</a><span>、§ 3</span>
        <li><a href="#xml-mime-type">XML MIMEタイプ</a><span>、§ 4.6</span>
        <li><a href="#zip-based-mime-type">ZIPベースMIMEタイプ</a><span>、§ 4.6</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">参照先で定義される用語</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[FETCH]</a>が定義する用語：
            <ul>
                <li><span class="dfn-paneled" id="4456bfd9">HTTP引用文字列の収集</span>
                <li><span class="dfn-paneled" id="a33db89a">フェッチ</span>
                <li><span class="dfn-paneled" id="5fe4ff5e">HTTP空白</span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a>が定義する用語：
            <ul>
                <li><span class="dfn-paneled" id="0cf3964f">script</span>
                <li><span class="dfn-paneled" id="ee18ab25">type</span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTTP-SEMANTICS]</a>が定義する用語：
            <ul>
                <li><span class="dfn-paneled" id="9715e3ca">media-type</span>
                <li><span class="dfn-paneled" id="5bc6d4d9">quoted-string</span>
                <li><span class="dfn-paneled" id="750904b2">token</span>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a>が定義する用語：
            <ul>
                <li><span class="dfn-paneled" id="f43d6978">ASCII英数字</span>
                <li><span class="dfn-paneled" id="7f9469b5">ASCII大文字・小文字を区別しない</span>
                <li><span class="dfn-paneled" id="6f2dfa22">ASCII小文字</span>
                <li><span class="dfn-paneled" id="2d5a2765">ASCII文字列</span>
                <li><span class="dfn-paneled" id="5fb1ed8a">ASCII空白</span>
                <li><span class="dfn-paneled" id="7b0d918d">繰り返し終了</span>
                <li><span class="dfn-paneled" id="f5354b9d">バイト</span>
                <li><span class="dfn-paneled" id="3de9e659">バイト列</span>
                <li><span class="dfn-paneled" id="915aff5e">コードポイント</span>
                <li><span class="dfn-paneled" id="d24334b4">コードポイントのシーケンス収集</span>
                <li><span class="dfn-paneled" id="60184fa5">コードポイントのシーケンスを収集</span>
                <li><span class="dfn-paneled" id="ae8def21">含む</span>
                <li><span class="dfn-paneled" id="f937b7b6">次の繰り返し</span>
                <li><span class="dfn-paneled" id="1243a891">存在</span>
                <li><span class="dfn-paneled" id="45209803">各</span>
                <li><span class="dfn-paneled" id="d8b963e8">等価デコード</span>
                <li><span class="dfn-paneled" id="16b1470a">等価エンコード</span>
                <li><span class="dfn-paneled" id="31db57e6">キー</span>
                <li><span class="dfn-paneled" id="36333997">長さ</span>
                <li><span class="dfn-paneled" id="84b454ff">順序付きマップ</span>
                <li><span class="dfn-paneled" id="75bee4d5">位置変数</span>
                <li><span class="dfn-paneled" id="15e48c39">セット</span>
                <li><span class="dfn-paneled" id="0e6b2056">セット <small>(マップ用)</small></span>
                <li><span class="dfn-paneled" id="50c91fa5">ASCII空白のスキップ</span>
                <li><span class="dfn-paneled" id="0698d556">文字列</span>
                <li><span class="dfn-paneled" id="12d6b9a8">値</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">規定参考文献</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-encoding">[ENCODING]
        <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/"><cite>Encoding Standard</cite></a>. 現行標準.
            URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
        <dt id="biblio-fetch">[FETCH]
        <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. 現行標準. URL: <a
                href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
        <dt id="biblio-http-semantics">[HTTP-SEMANTICS]
        <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a
                href="https://httpwg.org/specs/rfc9110.html"><cite>HTTP Semantics</cite></a>. 2022年6月. インターネット標準. URL:
            <a href="https://httpwg.org/specs/rfc9110.html">https://httpwg.org/specs/rfc9110.html</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra
                    Standard</cite></a>. 現行標準. URL: <a
                href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-keywords">[KEYWORDS]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to
                    Indicate Requirement Levels</cite></a>. 1997年3月. 最良現行慣行. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-mimetype">[MIMETYPE]
        <dd>N. Freed; N. Borenstein. <a href="https://www.rfc-editor.org/rfc/rfc2046"><cite>Multipurpose Internet Mail
                    Extensions (MIME) Part Two: Media Types</cite></a>. 1996年11月. 草案標準. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc2046">https://www.rfc-editor.org/rfc/rfc2046</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">参考情報</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-ftp">[FTP]
        <dd>J. Postel; J. Reynolds. <a href="https://www.rfc-editor.org/rfc/rfc959"><cite>File Transfer
                    Protocol</cite></a>. 1985年10月. インターネット標準. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc959">https://www.rfc-editor.org/rfc/rfc959</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>.
            現行標準. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-mediaqueries">[MEDIAQUERIES]
        <dd>Florian Rivoal; Tab Atkins Jr.. <a href="https://drafts.csswg.org/mediaqueries-4/"><cite>Media Queries Level
                    4</cite></a>. URL: <a
                href="https://drafts.csswg.org/mediaqueries-4/">https://drafts.csswg.org/mediaqueries-4/</a>
        <dt id="biblio-rfc7303">[RFC7303]
        <dd>H. Thompson; C. Lilley. <a href="https://www.rfc-editor.org/rfc/rfc7303"><cite>XML Media Types</cite></a>.
            2014年7月. 提案標準. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc7303">https://www.rfc-editor.org/rfc/rfc7303</a>
        <dt id="biblio-rfc8081">[RFC8081]
        <dd>C. Lilley. <a href="https://www.rfc-editor.org/rfc/rfc8081"><cite>The "font" Top-Level Media
                    Type</cite></a>. 2017年2月. 提案標準. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc8081">https://www.rfc-editor.org/rfc/rfc8081</a>
        <dt id="biblio-seccontsniff">[SECCONTSNIFF]
        <dd>Adam Barth; Juan Caballero; Dawn Song. <a
                href="https://www.adambarth.com/papers/2009/barth-caballero-song.pdf"><cite>Secure Content Sniffing for
                    Web Browsers, or How to Stop Papers from Reviewing Themselves</cite></a>. 2009年5月. URL: <a
                href="https://www.adambarth.com/papers/2009/barth-caballero-song.pdf">https://www.adambarth.com/papers/2009/barth-caballero-song.pdf</a>
    </dl>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "0698d556": { "dfnID": "0698d556", "dfnText": "string", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-string" }], "title": "4.1. MIME type representation" }, { "refs": [{ "id": "ref-for-string\u2460" }], "title": "4.6. MIME type groups" }], "url": "https://infra.spec.whatwg.org/#string" },
                "0cf3964f": { "dfnID": "0cf3964f", "dfnText": "script", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-script" }], "title": "4.6. MIME type groups" }], "url": "https://html.spec.whatwg.org/multipage/scripting.html#script" },
                "0e6b2056": { "dfnID": "0e6b2056", "dfnText": "set (for map)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-set" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#map-set" },
                "1243a891": { "dfnID": "1243a891", "dfnText": "exist", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-exists" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#map-exists" },
                "12d6b9a8": { "dfnID": "12d6b9a8", "dfnText": "values", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-getting-the-values" }], "title": "4.1. MIME type representation" }], "url": "https://infra.spec.whatwg.org/#map-getting-the-values" },
                "15e48c39": { "dfnID": "15e48c39", "dfnText": "set", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ordered-set" }], "title": "6. Matching a MIME type pattern" }], "url": "https://infra.spec.whatwg.org/#ordered-set" },
                "16b1470a": { "dfnID": "16b1470a", "dfnText": "isomorphic encode", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-isomorphic-encode" }], "title": "4.5. Serializing a MIME type" }], "url": "https://infra.spec.whatwg.org/#isomorphic-encode" },
                "2d5a2765": { "dfnID": "2d5a2765", "dfnText": "ASCII string", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ascii-string" }, { "id": "ref-for-ascii-string\u2460" }, { "id": "ref-for-ascii-string\u2461" }], "title": "4.1. MIME type representation" }, { "refs": [{ "id": "ref-for-ascii-string\u2462" }], "title": "4.2. MIME type miscellaneous" }], "url": "https://infra.spec.whatwg.org/#ascii-string" },
                "31db57e6": { "dfnID": "31db57e6", "dfnText": "keys", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-getting-the-keys" }], "title": "4.1. MIME type representation" }], "url": "https://infra.spec.whatwg.org/#map-getting-the-keys" },
                "36333997": { "dfnID": "36333997", "dfnText": "length", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-byte-sequence-length" }, { "id": "ref-for-byte-sequence-length\u2460" }, { "id": "ref-for-byte-sequence-length\u2461" }, { "id": "ref-for-byte-sequence-length\u2462" }, { "id": "ref-for-byte-sequence-length\u2463" }, { "id": "ref-for-byte-sequence-length\u2464" }], "title": "6. Matching a MIME type pattern" }], "url": "https://infra.spec.whatwg.org/#byte-sequence-length" },
                "3de9e659": { "dfnID": "3de9e659", "dfnText": "byte sequence", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-byte-sequence" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460" }, { "id": "ref-for-byte-sequence\u2461" }], "title": "5.2. Reading the resource header" }, { "refs": [{ "id": "ref-for-byte-sequence\u2462" }, { "id": "ref-for-byte-sequence\u2463" }, { "id": "ref-for-byte-sequence\u2464" }, { "id": "ref-for-byte-sequence\u2465" }], "title": "6. Matching a MIME type pattern" }, { "refs": [{ "id": "ref-for-byte-sequence\u2466" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-byte-sequence\u2467" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-byte-sequence\u2468" }, { "id": "ref-for-byte-sequence\u2460\u24ea" }], "title": "6.2.1. Signature for MP4" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460\u2460" }, { "id": "ref-for-byte-sequence\u2460\u2461" }, { "id": "ref-for-byte-sequence\u2460\u2462" }], "title": "6.2.2. Signature for WebM" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460\u2463" }, { "id": "ref-for-byte-sequence\u2460\u2464" }, { "id": "ref-for-byte-sequence\u2460\u2465" }], "title": "6.2.3. Signature for MP3 without ID3" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460\u2466" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460\u2467" }], "title": "6.4. Matching an archive type pattern" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460\u2468" }, { "id": "ref-for-byte-sequence\u2461\u24ea" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-byte-sequence\u2461\u2460" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-byte-sequence\u2461\u2461" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-byte-sequence\u2461\u2462" }], "title": "8.7. Sniffing in a font context" }], "url": "https://infra.spec.whatwg.org/#byte-sequence" },
                "4456bfd9": { "dfnID": "4456bfd9", "dfnText": "collecting an HTTP quoted string", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-collect-an-http-quoted-string" }], "title": "4.4. Parsing a MIME type" }], "url": "https://fetch.spec.whatwg.org/#collect-an-http-quoted-string" },
                "45209803": { "dfnID": "45209803", "dfnText": "for each", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-iterate" }], "title": "4.5. Serializing a MIME type" }], "url": "https://infra.spec.whatwg.org/#map-iterate" },
                "50c91fa5": { "dfnID": "50c91fa5", "dfnText": "skip ASCII whitespace", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-skip-ascii-whitespace" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#skip-ascii-whitespace" },
                "5bc6d4d9": { "dfnID": "5bc6d4d9", "dfnText": "quoted-string", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-name-quoted-strings" }], "title": "3. Terminology" }], "url": "https://www.rfc-editor.org/rfc/rfc9110#name-quoted-strings" },
                "5fb1ed8a": { "dfnID": "5fb1ed8a", "dfnText": "ASCII whitespace", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ascii-whitespace" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#ascii-whitespace" },
                "5fe4ff5e": { "dfnID": "5fe4ff5e", "dfnText": "HTTP whitespace", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-http-whitespace" }, { "id": "ref-for-http-whitespace\u2460" }, { "id": "ref-for-http-whitespace\u2461" }, { "id": "ref-for-http-whitespace\u2462" }, { "id": "ref-for-http-whitespace\u2463" }], "title": "4.4. Parsing a MIME type" }], "url": "https://fetch.spec.whatwg.org/#http-whitespace" },
                "60184fa5": { "dfnID": "60184fa5", "dfnText": "collecting a sequence of code points", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-collect-a-sequence-of-code-points" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2460" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2461" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2462" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2463" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2464" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points" },
                "6f2dfa22": { "dfnID": "6f2dfa22", "dfnText": "ASCII lowercase", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ascii-lowercase" }, { "id": "ref-for-ascii-lowercase\u2460" }, { "id": "ref-for-ascii-lowercase\u2461" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#ascii-lowercase" },
                "750904b2": { "dfnID": "750904b2", "dfnText": "token", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-name-tokens" }], "title": "3. Terminology" }], "url": "https://www.rfc-editor.org/rfc/rfc9110#name-tokens" },
                "75bee4d5": { "dfnID": "75bee4d5", "dfnText": "position variable", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-string-position-variable" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#string-position-variable" },
                "7b0d918d": { "dfnID": "7b0d918d", "dfnText": "break", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-iteration-break" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-iteration-break\u2460" }], "title": "6. Matching a MIME type pattern" }], "url": "https://infra.spec.whatwg.org/#iteration-break" },
                "7f9469b5": { "dfnID": "7f9469b5", "dfnText": "ASCII case-insensitive", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ascii-case-insensitive" }], "title": "4.6. MIME type groups" }], "url": "https://infra.spec.whatwg.org/#ascii-case-insensitive" },
                "84b454ff": { "dfnID": "84b454ff", "dfnText": "ordered map", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ordered-map" }], "title": "4.1. MIME type representation" }], "url": "https://infra.spec.whatwg.org/#ordered-map" },
                "915aff5e": { "dfnID": "915aff5e", "dfnText": "code point", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-code-point" }, { "id": "ref-for-code-point\u2460" }], "title": "3. Terminology" }, { "refs": [{ "id": "ref-for-code-point\u2461" }, { "id": "ref-for-code-point\u2462" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#code-point" },
                "9715e3ca": { "dfnID": "9715e3ca", "dfnText": "media-type", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-name-media-type" }], "title": "4.3. MIME type writing" }], "url": "https://www.rfc-editor.org/rfc/rfc9110#name-media-type" },
                "a33db89a": { "dfnID": "a33db89a", "dfnText": "fetch", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-fetch" }], "title": "8.4. Sniffing in a plugin context" }, { "refs": [{ "id": "ref-for-concept-fetch\u2460" }], "title": "8.5. Sniffing in a style context" }, { "refs": [{ "id": "ref-for-concept-fetch\u2461" }], "title": "8.6. Sniffing in a script context" }], "url": "https://fetch.spec.whatwg.org/#concept-fetch" },
                "ae8def21": { "dfnID": "ae8def21", "dfnText": "contain", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-list-contain" }], "title": "6. Matching a MIME type pattern" }], "url": "https://infra.spec.whatwg.org/#list-contain" },
                "archive-mime-type": { "dfnID": "archive-mime-type", "dfnText": "archive MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-archive-mime-type" }, { "id": "ref-for-archive-mime-type\u2460" }], "title": "6.4. Matching an archive type pattern" }], "url": "#archive-mime-type" },
                "archive-type-pattern-matching-algorithm": { "dfnID": "archive-type-pattern-matching-algorithm", "dfnText": "archive type pattern matching\nalgorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-archive-type-pattern-matching-algorithm" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#archive-type-pattern-matching-algorithm" },
                "audio-or-video-mime-type": { "dfnID": "audio-or-video-mime-type", "dfnText": "audio or video MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-audio-or-video-mime-type" }, { "id": "ref-for-audio-or-video-mime-type\u2460" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-audio-or-video-mime-type\u2461" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-audio-or-video-mime-type\u2462" }], "title": "8.3. Sniffing in an audio or video context" }], "url": "#audio-or-video-mime-type" },
                "audio-or-video-type-pattern-matching-algorithm": { "dfnID": "audio-or-video-type-pattern-matching-algorithm", "dfnText": "audio or video type pattern matching\nalgorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-audio-or-video-type-pattern-matching-algorithm" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-audio-or-video-type-pattern-matching-algorithm\u2460" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-audio-or-video-type-pattern-matching-algorithm\u2461" }], "title": "8.3. Sniffing in an audio or video context" }], "url": "#audio-or-video-type-pattern-matching-algorithm" },
                "binary-data-byte": { "dfnID": "binary-data-byte", "dfnText": "binary data byte", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-binary-data-byte" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-binary-data-byte\u2460" }], "title": "7.2. Sniffing a mislabeled binary resource" }], "url": "#binary-data-byte" },
                "byte-pattern": { "dfnID": "byte-pattern", "dfnText": "byte pattern", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-byte-pattern" }, { "id": "ref-for-byte-pattern\u2460" }, { "id": "ref-for-byte-pattern\u2461" }], "title": "6. Matching a MIME type pattern" }, { "refs": [{ "id": "ref-for-byte-pattern\u2462" }, { "id": "ref-for-byte-pattern\u2463" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-byte-pattern\u2464" }, { "id": "ref-for-byte-pattern\u2465" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-byte-pattern\u2466" }, { "id": "ref-for-byte-pattern\u2467" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-byte-pattern\u2468" }, { "id": "ref-for-byte-pattern\u2460\u24ea" }], "title": "6.4. Matching an archive type pattern" }, { "refs": [{ "id": "ref-for-byte-pattern\u2460\u2460" }, { "id": "ref-for-byte-pattern\u2460\u2461" }, { "id": "ref-for-byte-pattern\u2460\u2462" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#byte-pattern" },
                "check-for-apache-bug-flag": { "dfnID": "check-for-apache-bug-flag", "dfnText": "check-for-apache-bug flag", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-check-for-apache-bug-flag" }], "title": "5.1. Interpreting the resource metadata" }, { "refs": [{ "id": "ref-for-check-for-apache-bug-flag\u2460" }], "title": "7. Determining the computed MIME type of a resource" }], "url": "#check-for-apache-bug-flag" },
                "compute-an-mp3-frame-size": { "dfnID": "compute-an-mp3-frame-size", "dfnText": "compute an mp3 frame size", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-compute-an-mp3-frame-size" }], "title": "6.2.3. Signature for MP3 without ID3" }], "url": "#compute-an-mp3-frame-size" },
                "computed-mime-type": { "dfnID": "computed-mime-type", "dfnText": "computed MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-computed-mime-type" }, { "id": "ref-for-computed-mime-type\u2460" }, { "id": "ref-for-computed-mime-type\u2461" }, { "id": "ref-for-computed-mime-type\u2462" }, { "id": "ref-for-computed-mime-type\u2463" }, { "id": "ref-for-computed-mime-type\u2464" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2465" }, { "id": "ref-for-computed-mime-type\u2466" }, { "id": "ref-for-computed-mime-type\u2467" }, { "id": "ref-for-computed-mime-type\u2468" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2460\u24ea" }, { "id": "ref-for-computed-mime-type\u2460\u2460" }, { "id": "ref-for-computed-mime-type\u2460\u2461" }, { "id": "ref-for-computed-mime-type\u2460\u2462" }, { "id": "ref-for-computed-mime-type\u2460\u2463" }], "title": "7.2. Sniffing a mislabeled binary resource" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2460\u2464" }, { "id": "ref-for-computed-mime-type\u2460\u2465" }], "title": "8. Context-specific sniffing" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2460\u2466" }, { "id": "ref-for-computed-mime-type\u2460\u2467" }, { "id": "ref-for-computed-mime-type\u2460\u2468" }, { "id": "ref-for-computed-mime-type\u2461\u24ea" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2461\u2460" }, { "id": "ref-for-computed-mime-type\u2461\u2461" }, { "id": "ref-for-computed-mime-type\u2461\u2462" }, { "id": "ref-for-computed-mime-type\u2461\u2463" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2461\u2464" }, { "id": "ref-for-computed-mime-type\u2461\u2465" }, { "id": "ref-for-computed-mime-type\u2461\u2466" }], "title": "8.4. Sniffing in a plugin context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2461\u2467" }, { "id": "ref-for-computed-mime-type\u2461\u2468" }], "title": "8.5. Sniffing in a style context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2462\u24ea" }, { "id": "ref-for-computed-mime-type\u2462\u2460" }], "title": "8.6. Sniffing in a script context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2462\u2461" }, { "id": "ref-for-computed-mime-type\u2462\u2462" }, { "id": "ref-for-computed-mime-type\u2462\u2463" }, { "id": "ref-for-computed-mime-type\u2462\u2464" }], "title": "8.7. Sniffing in a font context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2462\u2465" }], "title": "8.8. Sniffing in a text track context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2462\u2466" }], "title": "8.9. Sniffing in a cache manifest context" }], "url": "#computed-mime-type" },
                "context": { "dfnID": "context", "dfnText": "context", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-context" }, { "id": "ref-for-context\u2460" }, { "id": "ref-for-context\u2461" }], "title": "8. Context-specific sniffing" }], "url": "#context" },
                "context-specific-sniffing-algorithm": { "dfnID": "context-specific-sniffing-algorithm", "dfnText": "context-specific sniffing algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-context-specific-sniffing-algorithm" }], "title": "8. Context-specific sniffing" }], "url": "#context-specific-sniffing-algorithm" },
                "d24334b4": { "dfnID": "d24334b4", "dfnText": "collect a sequence of code points", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-collect-a-sequence-of-code-points" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2460" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2461" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2462" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2463" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2464" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points" },
                "d8b963e8": { "dfnID": "d8b963e8", "dfnText": "isomorphic decode", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-isomorphic-decode" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#isomorphic-decode" },
                "ee18ab25": { "dfnID": "ee18ab25", "dfnText": "type", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-attr-script-type" }], "title": "4.6. MIME type groups" }], "url": "https://html.spec.whatwg.org/multipage/scripting.html#attr-script-type" },
                "f43d6978": { "dfnID": "f43d6978", "dfnText": "ASCII alphanumeric", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ascii-alphanumeric" }], "title": "3. Terminology" }], "url": "https://infra.spec.whatwg.org/#ascii-alphanumeric" },
                "f5354b9d": { "dfnID": "f5354b9d", "dfnText": "byte", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-byte" }, { "id": "ref-for-byte\u2460" }, { "id": "ref-for-byte\u2461" }, { "id": "ref-for-byte\u2462" }, { "id": "ref-for-byte\u2463" }, { "id": "ref-for-byte\u2464" }], "title": "3. Terminology" }, { "refs": [{ "id": "ref-for-byte\u2465" }], "title": "5.1. Interpreting the resource metadata" }, { "refs": [{ "id": "ref-for-byte\u2466" }, { "id": "ref-for-byte\u2467" }, { "id": "ref-for-byte\u2468" }, { "id": "ref-for-byte\u2460\u24ea" }], "title": "5.2. Reading the resource header" }, { "refs": [{ "id": "ref-for-byte\u2460\u2460" }, { "id": "ref-for-byte\u2460\u2461" }, { "id": "ref-for-byte\u2460\u2462" }, { "id": "ref-for-byte\u2460\u2463" }, { "id": "ref-for-byte\u2460\u2464" }], "title": "6. Matching a MIME type pattern" }, { "refs": [{ "id": "ref-for-byte\u2460\u2465" }, { "id": "ref-for-byte\u2460\u2466" }, { "id": "ref-for-byte\u2460\u2467" }, { "id": "ref-for-byte\u2460\u2468" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-byte\u2461\u24ea" }, { "id": "ref-for-byte\u2461\u2460" }, { "id": "ref-for-byte\u2461\u2461" }, { "id": "ref-for-byte\u2461\u2462" }, { "id": "ref-for-byte\u2461\u2463" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-byte\u2461\u2464" }, { "id": "ref-for-byte\u2461\u2465" }, { "id": "ref-for-byte\u2461\u2466" }, { "id": "ref-for-byte\u2461\u2467" }, { "id": "ref-for-byte\u2461\u2468" }, { "id": "ref-for-byte\u2462\u24ea" }, { "id": "ref-for-byte\u2462\u2460" }, { "id": "ref-for-byte\u2462\u2461" }], "title": "6.2.1. Signature for MP4" }, { "refs": [{ "id": "ref-for-byte\u2462\u2462" }, { "id": "ref-for-byte\u2462\u2463" }, { "id": "ref-for-byte\u2462\u2464" }, { "id": "ref-for-byte\u2462\u2465" }], "title": "6.2.2. Signature for WebM" }, { "refs": [{ "id": "ref-for-byte\u2462\u2466" }, { "id": "ref-for-byte\u2462\u2467" }, { "id": "ref-for-byte\u2462\u2468" }], "title": "6.2.3. Signature for MP3 without ID3" }, { "refs": [{ "id": "ref-for-byte\u2463\u24ea" }, { "id": "ref-for-byte\u2463\u2460" }, { "id": "ref-for-byte\u2463\u2461" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-byte\u2463\u2462" }], "title": "6.4. Matching an archive type pattern" }, { "refs": [{ "id": "ref-for-byte\u2463\u2463" }, { "id": "ref-for-byte\u2463\u2464" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-byte\u2463\u2465" }], "title": "7.2. Sniffing a mislabeled binary resource" }], "url": "https://infra.spec.whatwg.org/#byte" },
                "f937b7b6": { "dfnID": "f937b7b6", "dfnText": "continue", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-iteration-continue" }, { "id": "ref-for-iteration-continue\u2460" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#iteration-continue" },
                "font-mime-type": { "dfnID": "font-mime-type", "dfnText": "font MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-font-mime-type" }, { "id": "ref-for-font-mime-type\u2460" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-font-mime-type\u2461" }], "title": "8.7. Sniffing in a font context" }], "url": "#font-mime-type" },
                "font-type-pattern-matching-algorithm": { "dfnID": "font-type-pattern-matching-algorithm", "dfnText": "font type pattern matching algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-font-type-pattern-matching-algorithm" }], "title": "8.7. Sniffing in a font context" }], "url": "#font-type-pattern-matching-algorithm" },
                "html-mime-type": { "dfnID": "html-mime-type", "dfnText": "HTML MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-html-mime-type" }], "title": "4.6. MIME type groups" }, { "refs": [{ "id": "ref-for-html-mime-type\u2460" }], "title": "7. Determining the computed MIME type of a resource" }], "url": "#html-mime-type" },
                "http-quoted-string-token-code-point": { "dfnID": "http-quoted-string-token-code-point", "dfnText": "HTTP quoted-string token code point", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-http-quoted-string-token-code-point" }], "title": "4.1. MIME type representation" }, { "refs": [{ "id": "ref-for-http-quoted-string-token-code-point\u2460" }], "title": "4.4. Parsing a MIME type" }], "url": "#http-quoted-string-token-code-point" },
                "http-token-code-point": { "dfnID": "http-token-code-point", "dfnText": "HTTP token code point", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-http-token-code-point" }], "title": "3. Terminology" }, { "refs": [{ "id": "ref-for-http-token-code-point\u2460" }, { "id": "ref-for-http-token-code-point\u2461" }, { "id": "ref-for-http-token-code-point\u2462" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-http-token-code-point\u2463" }], "title": "4.5. Serializing a MIME type" }], "url": "#http-token-code-point" },
                "image-mime-type": { "dfnID": "image-mime-type", "dfnText": "image MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-image-mime-type" }, { "id": "ref-for-image-mime-type\u2460" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-image-mime-type\u2461" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-image-mime-type\u2462" }], "title": "8.2. Sniffing in an image context" }], "url": "#image-mime-type" },
                "image-type-pattern-matching-algorithm": { "dfnID": "image-type-pattern-matching-algorithm", "dfnText": "image type pattern matching algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-image-type-pattern-matching-algorithm" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-image-type-pattern-matching-algorithm\u2460" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-image-type-pattern-matching-algorithm\u2461" }], "title": "8.2. Sniffing in an image context" }], "url": "#image-type-pattern-matching-algorithm" },
                "javascript-mime-type": { "dfnID": "javascript-mime-type", "dfnText": "JavaScript MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-forvascript-mime-type" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-forvascript-mime-type\u2460" }], "title": "4.6. MIME type groups" }], "url": "#javascript-mime-type" },
                "javascript-mime-type-essence-match": { "dfnID": "javascript-mime-type-essence-match", "dfnText": "JavaScript MIME type essence match", "external": false, "refSections": [], "url": "#javascript-mime-type-essence-match" },
                "json-mime-type": { "dfnID": "json-mime-type", "dfnText": "JSON MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-json-mime-type" }], "title": "4.2. MIME type miscellaneous" }], "url": "#json-mime-type" },
                "match-an-mp3-header": { "dfnID": "match-an-mp3-header", "dfnText": "match an mp3 header", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-match-an-mp3-header" }, { "id": "ref-for-match-an-mp3-header" }], "title": "6.2.3. Signature for MP3 without ID3" }], "url": "#match-an-mp3-header" },
                "matches-the-signature-for-mp3-without-id3": { "dfnID": "matches-the-signature-for-mp3-without-id3", "dfnText": "matches the signature\nfor MP3 without ID3", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-matches-the-signature-for-mp3-without-id3" }], "title": "6.2. Matching an audio or video type pattern" }], "url": "#matches-the-signature-for-mp3-without-id3" },
                "matches-the-signature-for-mp4": { "dfnID": "matches-the-signature-for-mp4", "dfnText": "matches the signature\n for MP4", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-matches-the-signature-for-mp4" }], "title": "6.2. Matching an audio or video type pattern" }], "url": "#matches-the-signature-for-mp4" },
                "matches-the-signature-for-webm": { "dfnID": "matches-the-signature-for-webm", "dfnText": "matches the signature\n for WebM", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-matches-the-signature-for-webm" }], "title": "6.2. Matching an audio or video type pattern" }], "url": "#matches-the-signature-for-webm" },
                "matching-a-padded-sequence": { "dfnID": "matching-a-padded-sequence", "dfnText": "Matching a padded sequence", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-matching-a-padded-sequence" }], "title": "6.2.2. Signature for WebM" }], "url": "#matching-a-padded-sequence" },
                "mime-type": { "dfnID": "mime-type", "dfnText": "MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-mime-type" }, { "id": "ref-for-mime-type\u2460" }, { "id": "ref-for-mime-type\u2461" }, { "id": "ref-for-mime-type\u2462" }, { "id": "ref-for-mime-type\u2463" }], "title": "4.1. MIME type representation" }, { "refs": [{ "id": "ref-for-mime-type\u2464" }, { "id": "ref-for-mime-type\u2465" }, { "id": "ref-for-mime-type\u2466" }, { "id": "ref-for-mime-type\u2467" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-mime-type\u2468" }], "title": "4.3. MIME type writing" }, { "refs": [{ "id": "ref-for-mime-type\u2460\u24ea" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-mime-type\u2460\u2460" }, { "id": "ref-for-mime-type\u2460\u2461" }], "title": "4.5. Serializing a MIME type" }, { "refs": [{ "id": "ref-for-mime-type\u2460\u2462" }, { "id": "ref-for-mime-type\u2460\u2463" }, { "id": "ref-for-mime-type\u2460\u2464" }, { "id": "ref-for-mime-type\u2460\u2465" }, { "id": "ref-for-mime-type\u2460\u2466" }, { "id": "ref-for-mime-type\u2460\u2467" }, { "id": "ref-for-mime-type\u2460\u2468" }, { "id": "ref-for-mime-type\u2461\u24ea" }, { "id": "ref-for-mime-type\u2461\u2460" }, { "id": "ref-for-mime-type\u2461\u2461" }], "title": "4.6. MIME type groups" }, { "refs": [{ "id": "ref-for-mime-type\u2461\u2462" }, { "id": "ref-for-mime-type\u2461\u2463" }], "title": "5. Handling a resource" }, { "refs": [{ "id": "ref-for-mime-type\u2461\u2464" }, { "id": "ref-for-mime-type\u2461\u2465" }, { "id": "ref-for-mime-type\u2461\u2466" }, { "id": "ref-for-mime-type\u2461\u2467" }], "title": "5.1. Interpreting the resource metadata" }, { "refs": [{ "id": "ref-for-mime-type\u2461\u2468" }, { "id": "ref-for-mime-type\u2462\u24ea" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-mime-type\u2462\u2460" }, { "id": "ref-for-mime-type\u2462\u2461" }], "title": "8. Context-specific sniffing" }], "url": "#mime-type" },
                "mime-type-essence": { "dfnID": "mime-type-essence", "dfnText": "essence", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-mime-type-essence" }, { "id": "ref-for-mime-type-essence\u2460" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-mime-type-essence\u2461" }, { "id": "ref-for-mime-type-essence\u2462" }, { "id": "ref-for-mime-type-essence\u2463" }, { "id": "ref-for-mime-type-essence\u2464" }, { "id": "ref-for-mime-type-essence\u2465" }, { "id": "ref-for-mime-type-essence\u2466" }, { "id": "ref-for-mime-type-essence\u2467" }, { "id": "ref-for-mime-type-essence\u2468" }, { "id": "ref-for-mime-type-essence\u2460\u24ea" }], "title": "4.6. MIME type groups" }, { "refs": [{ "id": "ref-for-mime-type-essence\u2460\u2460" }], "title": "7. Determining the computed MIME type of a resource" }], "url": "#mime-type-essence" },
                "mime-type-sniffing-algorithm": { "dfnID": "mime-type-sniffing-algorithm", "dfnText": "MIME type sniffing algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-mime-type-sniffing-algorithm" }, { "id": "ref-for-mime-type-sniffing-algorithm\u2460" }], "title": "5. Handling a resource" }, { "refs": [{ "id": "ref-for-mime-type-sniffing-algorithm\u2461" }], "title": "5.2. Reading the resource header" }, { "refs": [{ "id": "ref-for-mime-type-sniffing-algorithm\u2462" }], "title": "8. Context-specific sniffing" }, { "refs": [{ "id": "ref-for-mime-type-sniffing-algorithm\u2463" }], "title": "8.1. Sniffing in a browsing context" }], "url": "#mime-type-sniffing-algorithm" },
                "minimize-a-supported-mime-type": { "dfnID": "minimize-a-supported-mime-type", "dfnText": "minimize a supported MIME type", "external": false, "refSections": [], "url": "#minimize-a-supported-mime-type" },
                "no-sniff-flag": { "dfnID": "no-sniff-flag", "dfnText": "no-sniff flag", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-no-sniff-flag" }, { "id": "ref-for-no-sniff-flag\u2460" }], "title": "7. Determining the computed MIME type of a resource" }], "url": "#no-sniff-flag" },
                "parameters": { "dfnID": "parameters", "dfnText": "parameters", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-parameters" }], "title": "4.3. MIME type writing" }, { "refs": [{ "id": "ref-for-parameters\u2460" }, { "id": "ref-for-parameters\u2461" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-parameters\u2462" }], "title": "4.5. Serializing a MIME type" }], "url": "#parameters" },
                "parse-a-mime-type": { "dfnID": "parse-a-mime-type", "dfnText": "parse a MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-parse-a-mime-type" }], "title": "4.3. MIME type writing" }, { "refs": [{ "id": "ref-for-parse-a-mime-type\u2460" }], "title": "4.4. Parsing a MIME type" }], "url": "#parse-a-mime-type" },
                "parse-a-mime-type-from-bytes": { "dfnID": "parse-a-mime-type-from-bytes", "dfnText": "parse a MIME type from bytes", "external": false, "refSections": [], "url": "#parse-a-mime-type-from-bytes" },
                "parse-a-vint": { "dfnID": "parse-a-vint", "dfnText": "parse a vint", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-parse-a-vint" }], "title": "6.2.2. Signature for WebM" }], "url": "#parse-a-vint" },
                "parse-an-mp3-frame": { "dfnID": "parse-an-mp3-frame", "dfnText": "parse an mp3 frame", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-parse-an-mp3-frame" }], "title": "6.2.3. Signature for MP3 without ID3" }], "url": "#parse-an-mp3-frame" },
                "pattern-mask": { "dfnID": "pattern-mask", "dfnText": "pattern mask", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-pattern-mask" }, { "id": "ref-for-pattern-mask\u2460" }], "title": "6. Matching a MIME type pattern" }, { "refs": [{ "id": "ref-for-pattern-mask\u2461" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-pattern-mask\u2462" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-pattern-mask\u2463" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-pattern-mask\u2464" }], "title": "6.4. Matching an archive type pattern" }, { "refs": [{ "id": "ref-for-pattern-mask\u2465" }, { "id": "ref-for-pattern-mask\u2466" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#pattern-mask" },
                "pattern-matching-algorithm": { "dfnID": "pattern-matching-algorithm", "dfnText": "pattern matching algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-pattern-matching-algorithm" }, { "id": "ref-for-pattern-matching-algorithm\u2460" }], "title": "6. Matching a MIME type pattern" }, { "refs": [{ "id": "ref-for-pattern-matching-algorithm\u2461" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-pattern-matching-algorithm\u2462" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-pattern-matching-algorithm\u2463" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-pattern-matching-algorithm\u2464" }], "title": "6.4. Matching an archive type pattern" }, { "refs": [{ "id": "ref-for-pattern-matching-algorithm\u2465" }, { "id": "ref-for-pattern-matching-algorithm\u2466" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#pattern-matching-algorithm" },
                "read-the-resource-header": { "dfnID": "read-the-resource-header", "dfnText": "read the resource header", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-read-the-resource-header" }], "title": "5.2. Reading the resource header" }], "url": "#read-the-resource-header" },
                "resource": { "dfnID": "resource", "dfnText": "resource", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-resource" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-resource\u2460" }, { "id": "ref-for-resource\u2461" }, { "id": "ref-for-resource\u2462" }, { "id": "ref-for-resource\u2463" }], "title": "5. Handling a resource" }, { "refs": [{ "id": "ref-for-resource\u2464" }, { "id": "ref-for-resource\u2465" }, { "id": "ref-for-resource\u2466" }, { "id": "ref-for-resource\u2467" }, { "id": "ref-for-resource\u2468" }, { "id": "ref-for-resource\u2460\u24ea" }, { "id": "ref-for-resource\u2460\u2460" }, { "id": "ref-for-resource\u2460\u2461" }, { "id": "ref-for-resource\u2460\u2462" }, { "id": "ref-for-resource\u2460\u2463" }], "title": "5.1. Interpreting the resource metadata" }, { "refs": [{ "id": "ref-for-resource\u2460\u2464" }, { "id": "ref-for-resource\u2460\u2465" }, { "id": "ref-for-resource\u2460\u2466" }, { "id": "ref-for-resource\u2460\u2467" }], "title": "5.2. Reading the resource header" }, { "refs": [{ "id": "ref-for-resource\u2460\u2468" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-resource\u2461\u24ea" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-resource\u2461\u2460" }], "title": "7.2. Sniffing a mislabeled binary resource" }, { "refs": [{ "id": "ref-for-resource\u2461\u2461" }, { "id": "ref-for-resource\u2461\u2462" }, { "id": "ref-for-resource\u2461\u2463" }, { "id": "ref-for-resource\u2461\u2464" }], "title": "8. Context-specific sniffing" }, { "refs": [{ "id": "ref-for-resource\u2461\u2465" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-resource\u2461\u2466" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-resource\u2461\u2467" }], "title": "8.4. Sniffing in a plugin context" }, { "refs": [{ "id": "ref-for-resource\u2461\u2468" }], "title": "8.5. Sniffing in a style context" }, { "refs": [{ "id": "ref-for-resource\u2462\u24ea" }], "title": "8.6. Sniffing in a script context" }, { "refs": [{ "id": "ref-for-resource\u2462\u2460" }], "title": "8.7. Sniffing in a font context" }], "url": "#resource" },
                "resource-header": { "dfnID": "resource-header", "dfnText": "resource header", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-resource-header" }, { "id": "ref-for-resource-header\u2460" }], "title": "5.2. Reading the resource header" }, { "refs": [{ "id": "ref-for-resource-header\u2461" }, { "id": "ref-for-resource-header\u2462" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-resource-header\u2463" }, { "id": "ref-for-resource-header\u2464" }, { "id": "ref-for-resource-header\u2465" }, { "id": "ref-for-resource-header\u2466" }, { "id": "ref-for-resource-header\u2467" }, { "id": "ref-for-resource-header\u2468" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-resource-header\u2460\u24ea" }, { "id": "ref-for-resource-header\u2460\u2460" }, { "id": "ref-for-resource-header\u2460\u2461" }, { "id": "ref-for-resource-header\u2460\u2462" }], "title": "7.2. Sniffing a mislabeled binary resource" }, { "refs": [{ "id": "ref-for-resource-header\u2460\u2463" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-resource-header\u2460\u2464" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-resource-header\u2460\u2465" }], "title": "8.7. Sniffing in a font context" }], "url": "#resource-header" },
                "rules-for-identifying-an-unknown-mime-type": { "dfnID": "rules-for-identifying-an-unknown-mime-type", "dfnText": "rules for identifying an unknown MIME\ntype", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-rules-for-identifying-an-unknown-mime-type" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-rules-for-identifying-an-unknown-mime-type\u2460" }, { "id": "ref-for-rules-for-identifying-an-unknown-mime-type\u2461" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#rules-for-identifying-an-unknown-mime-type" },
                "rules-for-sniffing-audio-and-video-specifically": { "dfnID": "rules-for-sniffing-audio-and-video-specifically", "dfnText": "rules\n for sniffing audio and video specifically", "external": false, "refSections": [], "url": "#rules-for-sniffing-audio-and-video-specifically" },
                "rules-for-sniffing-fonts-specifically": { "dfnID": "rules-for-sniffing-fonts-specifically", "dfnText": "rules for sniffing\n fonts specifically", "external": false, "refSections": [], "url": "#rules-for-sniffing-fonts-specifically" },
                "rules-for-sniffing-images-specifically": { "dfnID": "rules-for-sniffing-images-specifically", "dfnText": "rules for\n sniffing images specifically", "external": false, "refSections": [], "url": "#rules-for-sniffing-images-specifically" },
                "rules-for-sniffing-in-a-plugin-context": { "dfnID": "rules-for-sniffing-in-a-plugin-context", "dfnText": "rules for sniffing in a plugin context", "external": false, "refSections": [], "url": "#rules-for-sniffing-in-a-plugin-context" },
                "rules-for-sniffing-in-a-script-context": { "dfnID": "rules-for-sniffing-in-a-script-context", "dfnText": "rules for sniffing in a script context", "external": false, "refSections": [], "url": "#rules-for-sniffing-in-a-script-context" },
                "rules-for-sniffing-in-a-style-context": { "dfnID": "rules-for-sniffing-in-a-style-context", "dfnText": "rules for sniffing in a style context", "external": false, "refSections": [], "url": "#rules-for-sniffing-in-a-style-context" },
                "rules-for-text-or-binary": { "dfnID": "rules-for-text-or-binary", "dfnText": "rules for\n distinguishing if a resource is text or binary", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-rules-for-text-or-binary" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-rules-for-text-or-binary\u2460" }], "title": "7.2. Sniffing a mislabeled binary resource" }], "url": "#rules-for-text-or-binary" },
                "scriptable-mime-type": { "dfnID": "scriptable-mime-type", "dfnText": "scriptable MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-scriptable-mime-type" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-scriptable-mime-type\u2460" }], "title": "7.2. Sniffing a mislabeled binary resource" }], "url": "#scriptable-mime-type" },
                "serialize-a-mime-type": { "dfnID": "serialize-a-mime-type", "dfnText": "serialize a MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-serialize-a-mime-type" }], "title": "4.5. Serializing a MIME type" }], "url": "#serialize-a-mime-type" },
                "serialize-a-mime-type-to-bytes": { "dfnID": "serialize-a-mime-type-to-bytes", "dfnText": "serialize a MIME type to bytes", "external": false, "refSections": [], "url": "#serialize-a-mime-type-to-bytes" },
                "sniff-scriptable-flag": { "dfnID": "sniff-scriptable-flag", "dfnText": "sniff-scriptable flag", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-sniff-scriptable-flag" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-sniff-scriptable-flag\u2460" }, { "id": "ref-for-sniff-scriptable-flag\u2461" }, { "id": "ref-for-sniff-scriptable-flag\u2462" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#sniff-scriptable-flag" },
                "subtype": { "dfnID": "subtype", "dfnText": "subtype", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-subtype" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-subtype\u2460" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-subtype\u2461" }], "title": "4.5. Serializing a MIME type" }, { "refs": [{ "id": "ref-for-subtype\u2462" }, { "id": "ref-for-subtype\u2463" }, { "id": "ref-for-subtype\u2464" }], "title": "4.6. MIME type groups" }], "url": "#subtype" },
                "supplied-mime-type": { "dfnID": "supplied-mime-type", "dfnText": "supplied MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-supplied-mime-type" }, { "id": "ref-for-supplied-mime-type\u2460" }, { "id": "ref-for-supplied-mime-type\u2461" }, { "id": "ref-for-supplied-mime-type\u2462" }, { "id": "ref-for-supplied-mime-type\u2463" }], "title": "5.1. Interpreting the resource metadata" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2464" }, { "id": "ref-for-supplied-mime-type\u2465" }, { "id": "ref-for-supplied-mime-type\u2466" }, { "id": "ref-for-supplied-mime-type\u2467" }, { "id": "ref-for-supplied-mime-type\u2468" }, { "id": "ref-for-supplied-mime-type\u2460\u24ea" }, { "id": "ref-for-supplied-mime-type\u2460\u2460" }, { "id": "ref-for-supplied-mime-type\u2460\u2461" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2460\u2462" }, { "id": "ref-for-supplied-mime-type\u2460\u2463" }, { "id": "ref-for-supplied-mime-type\u2460\u2464" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2460\u2465" }, { "id": "ref-for-supplied-mime-type\u2460\u2466" }, { "id": "ref-for-supplied-mime-type\u2460\u2467" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2460\u2468" }, { "id": "ref-for-supplied-mime-type\u2461\u24ea" }], "title": "8.4. Sniffing in a plugin context" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2461\u2460" }, { "id": "ref-for-supplied-mime-type\u2461\u2461" }], "title": "8.5. Sniffing in a style context" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2461\u2462" }, { "id": "ref-for-supplied-mime-type\u2461\u2463" }], "title": "8.6. Sniffing in a script context" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2461\u2464" }, { "id": "ref-for-supplied-mime-type\u2461\u2465" }, { "id": "ref-for-supplied-mime-type\u2461\u2466" }], "title": "8.7. Sniffing in a font context" }], "url": "#supplied-mime-type" },
                "supplied-mime-type-detection-algorithm": { "dfnID": "supplied-mime-type-detection-algorithm", "dfnText": "supplied MIME type detection\n algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-supplied-mime-type-detection-algorithm" }], "title": "5. Handling a resource" }, { "refs": [{ "id": "ref-for-supplied-mime-type-detection-algorithm\u2460" }], "title": "5.1. Interpreting the resource metadata" }], "url": "#supplied-mime-type-detection-algorithm" },
                "supported-by-the-user-agent": { "dfnID": "supported-by-the-user-agent", "dfnText": "supported by the user agent", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-supported-by-the-user-agent" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-supported-by-the-user-agent\u2460" }, { "id": "ref-for-supported-by-the-user-agent\u2461" }], "title": "7. Determining the computed MIME type of a resource" }], "url": "#supported-by-the-user-agent" },
                "tag-terminating-byte": { "dfnID": "tag-terminating-byte", "dfnText": "tag-terminating byte", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-tag-terminating-byte" }, { "id": "ref-for-tag-terminating-byte\u2460" }, { "id": "ref-for-tag-terminating-byte\u2461" }, { "id": "ref-for-tag-terminating-byte\u2462" }, { "id": "ref-for-tag-terminating-byte\u2463" }, { "id": "ref-for-tag-terminating-byte\u2464" }, { "id": "ref-for-tag-terminating-byte\u2465" }, { "id": "ref-for-tag-terminating-byte\u2466" }, { "id": "ref-for-tag-terminating-byte\u2467" }, { "id": "ref-for-tag-terminating-byte\u2468" }, { "id": "ref-for-tag-terminating-byte\u2460\u24ea" }, { "id": "ref-for-tag-terminating-byte\u2460\u2460" }, { "id": "ref-for-tag-terminating-byte\u2460\u2461" }, { "id": "ref-for-tag-terminating-byte\u2460\u2462" }, { "id": "ref-for-tag-terminating-byte\u2460\u2463" }, { "id": "ref-for-tag-terminating-byte\u2460\u2464" }, { "id": "ref-for-tag-terminating-byte\u2460\u2465" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#tag-terminating-byte" },
                "type": { "dfnID": "type", "dfnText": "type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-type" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-type\u2460" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-type\u2461" }], "title": "4.5. Serializing a MIME type" }, { "refs": [{ "id": "ref-for-type\u2462" }, { "id": "ref-for-type\u2463" }, { "id": "ref-for-type\u2464" }], "title": "4.6. MIME type groups" }], "url": "#type" },
                "valid-mime-type": { "dfnID": "valid-mime-type", "dfnText": "valid MIME type string", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valid-mime-type" }, { "id": "ref-for-valid-mime-type\u2460" }, { "id": "ref-for-valid-mime-type\u2461" }, { "id": "ref-for-valid-mime-type\u2462" }, { "id": "ref-for-valid-mime-type\u2463" }], "title": "4.3. MIME type writing" }], "url": "#valid-mime-type" },
                "valid-mime-type-with-no-parameters": { "dfnID": "valid-mime-type-with-no-parameters", "dfnText": "valid MIME type string with no parameters", "external": false, "refSections": [], "url": "#valid-mime-type-with-no-parameters" },
                "whitespace-byte": { "dfnID": "whitespace-byte", "dfnText": "whitespace byte", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-whitespace-byte" }, { "id": "ref-for-whitespace-byte\u2460" }, { "id": "ref-for-whitespace-byte\u2461" }, { "id": "ref-for-whitespace-byte\u2462" }, { "id": "ref-for-whitespace-byte\u2463" }, { "id": "ref-for-whitespace-byte\u2464" }, { "id": "ref-for-whitespace-byte\u2465" }, { "id": "ref-for-whitespace-byte\u2466" }, { "id": "ref-for-whitespace-byte\u2467" }, { "id": "ref-for-whitespace-byte\u2468" }, { "id": "ref-for-whitespace-byte\u2460\u24ea" }, { "id": "ref-for-whitespace-byte\u2460\u2460" }, { "id": "ref-for-whitespace-byte\u2460\u2461" }, { "id": "ref-for-whitespace-byte\u2460\u2462" }, { "id": "ref-for-whitespace-byte\u2460\u2463" }, { "id": "ref-for-whitespace-byte\u2460\u2464" }, { "id": "ref-for-whitespace-byte\u2460\u2465" }, { "id": "ref-for-whitespace-byte\u2460\u2466" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#whitespace-byte" },
                "xml-mime-type": { "dfnID": "xml-mime-type", "dfnText": "XML MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-xml-mime-type" }, { "id": "ref-for-xml-mime-type\u2460" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-xml-mime-type\u2461" }], "title": "4.6. MIME type groups" }, { "refs": [{ "id": "ref-for-xml-mime-type\u2462" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-xml-mime-type\u2463" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-xml-mime-type\u2464" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-xml-mime-type\u2465" }], "title": "8.7. Sniffing in a font context" }], "url": "#xml-mime-type" },
                "zip-based-mime-type": { "dfnID": "zip-based-mime-type", "dfnText": "ZIP-based MIME type", "external": false, "refSections": [], "url": "#zip-based-mime-type" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#archive-mime-type": { "displayText": "archive mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "archive mime type", "type": "dfn", "url": "#archive-mime-type" },
                "#archive-type-pattern-matching-algorithm": { "displayText": "archive type pattern matching algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "archive type pattern matching algorithm", "type": "dfn", "url": "#archive-type-pattern-matching-algorithm" },
                "#audio-or-video-mime-type": { "displayText": "audio or video mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "audio or video mime type", "type": "dfn", "url": "#audio-or-video-mime-type" },
                "#audio-or-video-type-pattern-matching-algorithm": { "displayText": "audio or video type pattern matching algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "audio or video type pattern matching algorithm", "type": "dfn", "url": "#audio-or-video-type-pattern-matching-algorithm" },
                "#binary-data-byte": { "displayText": "binary data byte", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "binary data byte", "type": "dfn", "url": "#binary-data-byte" },
                "#byte-pattern": { "displayText": "byte pattern", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "byte pattern", "type": "dfn", "url": "#byte-pattern" },
                "#check-for-apache-bug-flag": { "displayText": "check-for-apache-bug flag", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "check-for-apache-bug flag", "type": "dfn", "url": "#check-for-apache-bug-flag" },
                "#computed-mime-type": { "displayText": "computed mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "computed mime type", "type": "dfn", "url": "#computed-mime-type" },
                "#context": { "displayText": "context", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "context", "type": "dfn", "url": "#context" },
                "#context-specific-sniffing-algorithm": { "displayText": "context-specific sniffing algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "context-specific sniffing algorithm", "type": "dfn", "url": "#context-specific-sniffing-algorithm" },
                "#font-mime-type": { "displayText": "font mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "font mime type", "type": "dfn", "url": "#font-mime-type" },
                "#font-type-pattern-matching-algorithm": { "displayText": "font type pattern matching algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "font type pattern matching algorithm", "type": "dfn", "url": "#font-type-pattern-matching-algorithm" },
                "#html-mime-type": { "displayText": "html mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "html mime type", "type": "dfn", "url": "#html-mime-type" },
                "#http-quoted-string-token-code-point": { "displayText": "http quoted-string token code point", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "http quoted-string token code point", "type": "dfn", "url": "#http-quoted-string-token-code-point" },
                "#http-token-code-point": { "displayText": "http token code point", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "http token code point", "type": "dfn", "url": "#http-token-code-point" },
                "#image-mime-type": { "displayText": "image mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "image mime type", "type": "dfn", "url": "#image-mime-type" },
                "#image-type-pattern-matching-algorithm": { "displayText": "image type pattern matching algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "image type pattern matching algorithm", "type": "dfn", "url": "#image-type-pattern-matching-algorithm" },
                "#javascript-mime-type": { "displayText": "javascript mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "javascript mime type", "type": "dfn", "url": "#javascript-mime-type" },
                "#json-mime-type": { "displayText": "json mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "json mime type", "type": "dfn", "url": "#json-mime-type" },
                "#matches-the-signature-for-mp3-without-id3": { "displayText": "matches the signature for mp3 without id3", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "matches the signature for mp3 without id3", "type": "dfn", "url": "#matches-the-signature-for-mp3-without-id3" },
                "#matches-the-signature-for-mp4": { "displayText": "matches the signature for mp4", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "matches the signature for mp4", "type": "dfn", "url": "#matches-the-signature-for-mp4" },
                "#matches-the-signature-for-webm": { "displayText": "matches the signature for webm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "matches the signature for webm", "type": "dfn", "url": "#matches-the-signature-for-webm" },
                "#mime-type": { "displayText": "mime type record", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "mime type record", "type": "dfn", "url": "#mime-type" },
                "#mime-type-essence": { "displayText": "essence", "export": true, "for_": ["MIME type"], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "essence", "type": "dfn", "url": "#mime-type-essence" },
                "#mime-type-sniffing-algorithm": { "displayText": "mime type sniffing algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "mime type sniffing algorithm", "type": "dfn", "url": "#mime-type-sniffing-algorithm" },
                "#no-sniff-flag": { "displayText": "no-sniff flag", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "no-sniff flag", "type": "dfn", "url": "#no-sniff-flag" },
                "#parameters": { "displayText": "parameters", "export": true, "for_": ["MIME type"], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "parameters", "type": "dfn", "url": "#parameters" },
                "#parse-a-mime-type": { "displayText": "parse a mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "parse a mime type", "type": "dfn", "url": "#parse-a-mime-type" },
                "#pattern-mask": { "displayText": "pattern mask", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "pattern mask", "type": "dfn", "url": "#pattern-mask" },
                "#pattern-matching-algorithm": { "displayText": "pattern matching algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "pattern matching algorithm", "type": "dfn", "url": "#pattern-matching-algorithm" },
                "#read-the-resource-header": { "displayText": "read the resource header", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "read the resource header", "type": "dfn", "url": "#read-the-resource-header" },
                "#resource": { "displayText": "resource", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "resource", "type": "dfn", "url": "#resource" },
                "#resource-header": { "displayText": "resource header", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "resource header", "type": "dfn", "url": "#resource-header" },
                "#rules-for-identifying-an-unknown-mime-type": { "displayText": "rules for identifying an unknown mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "rules for identifying an unknown mime type", "type": "dfn", "url": "#rules-for-identifying-an-unknown-mime-type" },
                "#rules-for-text-or-binary": { "displayText": "rules for distinguishing if a resource is text or binary", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "rules for distinguishing if a resource is text or binary", "type": "dfn", "url": "#rules-for-text-or-binary" },
                "#scriptable-mime-type": { "displayText": "scriptable mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "scriptable mime type", "type": "dfn", "url": "#scriptable-mime-type" },
                "#serialize-a-mime-type": { "displayText": "serialize a mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "serialize a mime type", "type": "dfn", "url": "#serialize-a-mime-type" },
                "#sniff-scriptable-flag": { "displayText": "sniff-scriptable flag", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "sniff-scriptable flag", "type": "dfn", "url": "#sniff-scriptable-flag" },
                "#subtype": { "displayText": "subtype", "export": true, "for_": ["MIME type"], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "subtype", "type": "dfn", "url": "#subtype" },
                "#supplied-mime-type": { "displayText": "supplied mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "supplied mime type", "type": "dfn", "url": "#supplied-mime-type" },
                "#supplied-mime-type-detection-algorithm": { "displayText": "supplied mime type detection algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "supplied mime type detection algorithm", "type": "dfn", "url": "#supplied-mime-type-detection-algorithm" },
                "#supported-by-the-user-agent": { "displayText": "supported by the user agent", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "supported by the user agent", "type": "dfn", "url": "#supported-by-the-user-agent" },
                "#tag-terminating-byte": { "displayText": "tag-terminating byte", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "tag-terminating byte", "type": "dfn", "url": "#tag-terminating-byte" },
                "#type": { "displayText": "type", "export": true, "for_": ["MIME type"], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "type", "type": "dfn", "url": "#type" },
                "#valid-mime-type": { "displayText": "valid mime type string", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "valid mime type string", "type": "dfn", "url": "#valid-mime-type" },
                "#whitespace-byte": { "displayText": "whitespace byte", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "whitespace byte", "type": "dfn", "url": "#whitespace-byte" },
                "#xml-mime-type": { "displayText": "xml mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "xml mime type", "type": "dfn", "url": "#xml-mime-type" },
                "https://fetch.spec.whatwg.org/#collect-an-http-quoted-string": { "displayText": "collecting an HTTP quoted string", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "fetch", "spec": "fetch", "status": "current", "text": "collecting an http quoted string", "type": "dfn", "url": "https://fetch.spec.whatwg.org/#collect-an-http-quoted-string" },
                "https://fetch.spec.whatwg.org/#concept-fetch": { "displayText": "fetch", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "fetch", "spec": "fetch", "status": "current", "text": "fetch", "type": "dfn", "url": "https://fetch.spec.whatwg.org/#concept-fetch" },
                "https://fetch.spec.whatwg.org/#http-whitespace": { "displayText": "HTTP whitespace", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "fetch", "spec": "fetch", "status": "current", "text": "http whitespace", "type": "dfn", "url": "https://fetch.spec.whatwg.org/#http-whitespace" },
                "https://html.spec.whatwg.org/multipage/scripting.html#attr-script-type": { "displayText": "type", "export": true, "for_": ["script"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "type", "type": "element-attr", "url": "https://html.spec.whatwg.org/multipage/scripting.html#attr-script-type" },
                "https://html.spec.whatwg.org/multipage/scripting.html#script": { "displayText": "script", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "script", "type": "element", "url": "https://html.spec.whatwg.org/multipage/scripting.html#script" },
                "https://infra.spec.whatwg.org/#ascii-alphanumeric": { "displayText": "ASCII alphanumeric", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ascii alphanumeric", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ascii-alphanumeric" },
                "https://infra.spec.whatwg.org/#ascii-case-insensitive": { "displayText": "ASCII case-insensitive", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ascii case-insensitive", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ascii-case-insensitive" },
                "https://infra.spec.whatwg.org/#ascii-lowercase": { "displayText": "ASCII lowercase", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ascii lowercase", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ascii-lowercase" },
                "https://infra.spec.whatwg.org/#ascii-string": { "displayText": "ASCII string", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ascii string", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ascii-string" },
                "https://infra.spec.whatwg.org/#ascii-whitespace": { "displayText": "ASCII whitespace", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ascii whitespace", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ascii-whitespace" },
                "https://infra.spec.whatwg.org/#byte": { "displayText": "byte", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "byte", "type": "dfn", "url": "https://infra.spec.whatwg.org/#byte" },
                "https://infra.spec.whatwg.org/#byte-sequence": { "displayText": "byte sequence", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "byte sequence", "type": "dfn", "url": "https://infra.spec.whatwg.org/#byte-sequence" },
                "https://infra.spec.whatwg.org/#byte-sequence-length": { "displayText": "length", "export": true, "for_": ["byte sequence"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "length", "type": "dfn", "url": "https://infra.spec.whatwg.org/#byte-sequence-length" },
                "https://infra.spec.whatwg.org/#code-point": { "displayText": "code point", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "code point", "type": "dfn", "url": "https://infra.spec.whatwg.org/#code-point" },
                "https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points": { "displayText": "collecting a sequence of code points", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "collecting a sequence of code points", "type": "dfn", "url": "https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points" },
                "https://infra.spec.whatwg.org/#isomorphic-decode": { "displayText": "isomorphic decode", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "isomorphic decode", "type": "dfn", "url": "https://infra.spec.whatwg.org/#isomorphic-decode" },
                "https://infra.spec.whatwg.org/#isomorphic-encode": { "displayText": "isomorphic encode", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "isomorphic encode", "type": "dfn", "url": "https://infra.spec.whatwg.org/#isomorphic-encode" },
                "https://infra.spec.whatwg.org/#iteration-break": { "displayText": "break", "export": true, "for_": ["iteration"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "break", "type": "dfn", "url": "https://infra.spec.whatwg.org/#iteration-break" },
                "https://infra.spec.whatwg.org/#iteration-continue": { "displayText": "continue", "export": true, "for_": ["iteration"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "continue", "type": "dfn", "url": "https://infra.spec.whatwg.org/#iteration-continue" },
                "https://infra.spec.whatwg.org/#list-contain": { "displayText": "contain", "export": true, "for_": ["list", "stack", "queue", "set"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "contain", "type": "dfn", "url": "https://infra.spec.whatwg.org/#list-contain" },
                "https://infra.spec.whatwg.org/#map-exists": { "displayText": "exist", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "exist", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-exists" },
                "https://infra.spec.whatwg.org/#map-getting-the-keys": { "displayText": "keys", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "keys", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-getting-the-keys" },
                "https://infra.spec.whatwg.org/#map-getting-the-values": { "displayText": "values", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "values", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-getting-the-values" },
                "https://infra.spec.whatwg.org/#map-iterate": { "displayText": "for each", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "for each", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-iterate" },
                "https://infra.spec.whatwg.org/#map-set": { "displayText": "set", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "set", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-set" },
                "https://infra.spec.whatwg.org/#ordered-map": { "displayText": "ordered map", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ordered map", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ordered-map" },
                "https://infra.spec.whatwg.org/#ordered-set": { "displayText": "set", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "set", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ordered-set" },
                "https://infra.spec.whatwg.org/#skip-ascii-whitespace": { "displayText": "skip ASCII whitespace", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "skip ascii whitespace", "type": "dfn", "url": "https://infra.spec.whatwg.org/#skip-ascii-whitespace" },
                "https://infra.spec.whatwg.org/#string": { "displayText": "string", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "string", "type": "dfn", "url": "https://infra.spec.whatwg.org/#string" },
                "https://infra.spec.whatwg.org/#string-position-variable": { "displayText": "position variable", "export": true, "for_": ["string"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "position variable", "type": "dfn", "url": "https://infra.spec.whatwg.org/#string-position-variable" },
                "https://www.rfc-editor.org/rfc/rfc9110#name-media-type": { "displayText": "media-type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "http-semantics", "spec": "http-semantics", "status": "anchor-block", "text": "media-type", "type": "dfn", "url": "https://www.rfc-editor.org/rfc/rfc9110#name-media-type" },
                "https://www.rfc-editor.org/rfc/rfc9110#name-quoted-strings": { "displayText": "quoted-string", "export": true, "for_": [], "level": "", "normative": true, "shortname": "http-semantics", "spec": "http-semantics", "status": "anchor-block", "text": "quoted-string", "type": "dfn", "url": "https://www.rfc-editor.org/rfc/rfc9110#name-quoted-strings" },
                "https://www.rfc-editor.org/rfc/rfc9110#name-tokens": { "displayText": "token", "export": true, "for_": [], "level": "", "normative": true, "shortname": "http-semantics", "spec": "http-semantics", "status": "anchor-block", "text": "token", "type": "dfn", "url": "https://www.rfc-editor.org/rfc/rfc9110#name-tokens" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
                    // Give the original term if it's being displayed in a different way.
                    // But allow casing differences, they're insignificant.
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.displayText)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const refHintKey = link.getAttribute("data-refhint-key");
                let key = url;
                if (refHintKey) {
                    key = refHintKey + "_" + url;
                }
                const ref = refsData[key];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-var-click-highlighting */
        "use strict";
        {
            /*
            Color-choosing design:
            
            * Colors are ordered by goodness.
            * On clicking a var, give it the earliest color
                with the lowest usage in the algorithm.
            * On re-clicking, re-use the var's most recent color
                if that's not currently being used elsewhere.
            */

            const COLOR_COUNT = 7;

            document.addEventListener("click", e => {
                if (e.target.nodeName == "VAR") {
                    highlightSameAlgoVars(e.target);
                }
            });

            function highlightSameAlgoVars(v) {
                // Find the algorithm container.
                let algoContainer = findAlgoContainer(v);

                // Not highlighting document-global vars,
                // too likely to be unrelated.
                if (algoContainer == null) return;

                const varName = nameFromVar(v);
                if (!v.hasAttribute("data-var-color")) {
                    const newColor = chooseHighlightColor(algoContainer, v);
                    for (const el of algoContainer.querySelectorAll("var")) {
                        if (nameFromVar(el) == varName) {
                            el.setAttribute("data-var-color", newColor);
                            el.setAttribute("data-var-last-color", newColor);
                        }
                    }
                } else {
                    for (const el of algoContainer.querySelectorAll("var")) {
                        if (nameFromVar(el) == varName) {
                            el.removeAttribute("data-var-color");
                        }
                    }
                }
            }
            function findAlgoContainer(el) {
                while (el != document.body) {
                    if (el.hasAttribute("data-algorithm")) return el;
                    el = el.parentNode;
                }
                return null;
            }
            function nameFromVar(el) {
                return el.textContent.replace(/(\s|\xa0)+/g, " ").trim();
            }
            function colorCountsFromContainer(container) {
                const namesFromColor = Array.from({ length: COLOR_COUNT }, x => new Set());
                for (let v of container.querySelectorAll("var[data-var-color]")) {
                    let color = +v.getAttribute("data-var-color");
                    namesFromColor[color].add(nameFromVar(v));
                }

                return namesFromColor.map(x => x.size);
            }
            function leastUsedColor(colors) {
                // Find the earliest color with the lowest count.
                let minCount = Infinity;
                let minColor = null;
                for (var i = 0; i < colors.length; i++) {
                    if (colors[i] < minCount) {
                        minColor = i;
                        minCount = colors[i];
                    }
                }
                return minColor;
            }
            function chooseHighlightColor(container, v) {
                const colorCounts = colorCountsFromContainer(container);
                if (v.hasAttribute("data-var-last-color")) {
                    let color = +v.getAttribute("data-var-last-color");
                    if (colorCounts[color] == 0) return color;
                }
                return leastUsedColor(colorCounts);
            }
        }
    </script>