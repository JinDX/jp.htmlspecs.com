<!doctype html>
<html lang="ja-JP">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>環境光センサー</title>
    <meta content="WD" name="w3c-status">
    <!-- <meta content="Bikeshed version 97a1608be, updated Mon Feb 3 16:09:34 2025 -0800" name="generator"> -->
    <link href="https://www.w3.org/TR/ambient-light/" rel="canonical">
    <!-- <meta content="bcd9e1695b5f0365641d328314058384103594c1" name="revision"> -->
    <meta content="dark light" name="color-scheme">
    <style>
        /* Boilerplate: style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-colors */
        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-idl-highlighting */
        pre.idl.highlight {
            background: var(--borderedblock-bg, var(--def-bg));
        }
    </style>
    <style>
        /* Boilerplate: style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* Boilerplate: style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-selflinks */
        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* Boilerplate: style-syntax-highlighting */
        code.highlight {
            padding: .1em;
            border-radius: .3em;
        }

        pre.highlight,
        pre>code.highlight {
            display: block;
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
            border-radius: 0;
        }

        .highlight:not(.idl) {
            background: rgba(0, 0, 0, .03);
        }

        c-[a] {
            color: #990055
        }

        /* Keyword.Declaration */
        c-[b] {
            color: #990055
        }

        /* Keyword.Type */
        c-[c] {
            color: #708090
        }

        /* Comment */
        c-[d] {
            color: #708090
        }

        /* Comment.Multiline */
        c-[e] {
            color: #0077aa
        }

        /* Name.Attribute */
        c-[f] {
            color: #669900
        }

        /* Name.Tag */
        c-[g] {
            color: #222222
        }

        /* Name.Variable */
        c-[k] {
            color: #990055
        }

        /* Keyword */
        c-[l] {
            color: #000000
        }

        /* Literal */
        c-[m] {
            color: #000000
        }

        /* Literal.Number */
        c-[n] {
            color: #0077aa
        }

        /* Name */
        c-[o] {
            color: #999999
        }

        /* Operator */
        c-[p] {
            color: #999999
        }

        /* Punctuation */
        c-[s] {
            color: #a67f59
        }

        /* Literal.String */
        c-[t] {
            color: #a67f59
        }

        /* Literal.String.Single */
        c-[u] {
            color: #a67f59
        }

        /* Literal.String.Double */
        c-[cp] {
            color: #708090
        }

        /* Comment.Preproc */
        c-[c1] {
            color: #708090
        }

        /* Comment.Single */
        c-[cs] {
            color: #708090
        }

        /* Comment.Special */
        c-[kc] {
            color: #990055
        }

        /* Keyword.Constant */
        c-[kn] {
            color: #990055
        }

        /* Keyword.Namespace */
        c-[kp] {
            color: #990055
        }

        /* Keyword.Pseudo */
        c-[kr] {
            color: #990055
        }

        /* Keyword.Reserved */
        c-[ld] {
            color: #000000
        }

        /* Literal.Date */
        c-[nc] {
            color: #0077aa
        }

        /* Name.Class */
        c-[no] {
            color: #0077aa
        }

        /* Name.Constant */
        c-[nd] {
            color: #0077aa
        }

        /* Name.Decorator */
        c-[ni] {
            color: #0077aa
        }

        /* Name.Entity */
        c-[ne] {
            color: #0077aa
        }

        /* Name.Exception */
        c-[nf] {
            color: #0077aa
        }

        /* Name.Function */
        c-[nl] {
            color: #0077aa
        }

        /* Name.Label */
        c-[nn] {
            color: #0077aa
        }

        /* Name.Namespace */
        c-[py] {
            color: #0077aa
        }

        /* Name.Property */
        c-[ow] {
            color: #999999
        }

        /* Operator.Word */
        c-[mb] {
            color: #000000
        }

        /* Literal.Number.Bin */
        c-[mf] {
            color: #000000
        }

        /* Literal.Number.Float */
        c-[mh] {
            color: #000000
        }

        /* Literal.Number.Hex */
        c-[mi] {
            color: #000000
        }

        /* Literal.Number.Integer */
        c-[mo] {
            color: #000000
        }

        /* Literal.Number.Oct */
        c-[sb] {
            color: #a67f59
        }

        /* Literal.String.Backtick */
        c-[sc] {
            color: #a67f59
        }

        /* Literal.String.Char */
        c-[sd] {
            color: #a67f59
        }

        /* Literal.String.Doc */
        c-[se] {
            color: #a67f59
        }

        /* Literal.String.Escape */
        c-[sh] {
            color: #a67f59
        }

        /* Literal.String.Heredoc */
        c-[si] {
            color: #a67f59
        }

        /* Literal.String.Interpol */
        c-[sx] {
            color: #a67f59
        }

        /* Literal.String.Other */
        c-[sr] {
            color: #a67f59
        }

        /* Literal.String.Regex */
        c-[ss] {
            color: #a67f59
        }

        /* Literal.String.Symbol */
        c-[vc] {
            color: #0077aa
        }

        /* Name.Variable.Class */
        c-[vg] {
            color: #0077aa
        }

        /* Name.Variable.Global */
        c-[vi] {
            color: #0077aa
        }

        /* Name.Variable.Instance */
        c-[il] {
            color: #000000
        }

        /* Literal.Number.Integer.Long */

        @media (prefers-color-scheme: dark) {
            .highlight:not(.idl) {
                background: rgba(255, 255, 255, .05);
            }

            c-[a] {
                color: #d33682
            }

            /* Keyword.Declaration */
            c-[b] {
                color: #d33682
            }

            /* Keyword.Type */
            c-[c] {
                color: #2aa198
            }

            /* Comment */
            c-[d] {
                color: #2aa198
            }

            /* Comment.Multiline */
            c-[e] {
                color: #268bd2
            }

            /* Name.Attribute */
            c-[f] {
                color: #b58900
            }

            /* Name.Tag */
            c-[g] {
                color: #cb4b16
            }

            /* Name.Variable */
            c-[k] {
                color: #d33682
            }

            /* Keyword */
            c-[l] {
                color: #657b83
            }

            /* Literal */
            c-[m] {
                color: #657b83
            }

            /* Literal.Number */
            c-[n] {
                color: #268bd2
            }

            /* Name */
            c-[o] {
                color: #657b83
            }

            /* Operator */
            c-[p] {
                color: #657b83
            }

            /* Punctuation */
            c-[s] {
                color: #6c71c4
            }

            /* Literal.String */
            c-[t] {
                color: #6c71c4
            }

            /* Literal.String.Single */
            c-[u] {
                color: #6c71c4
            }

            /* Literal.String.Double */
            c-[ch] {
                color: #2aa198
            }

            /* Comment.Hashbang */
            c-[cp] {
                color: #2aa198
            }

            /* Comment.Preproc */
            c-[cpf] {
                color: #2aa198
            }

            /* Comment.PreprocFile */
            c-[c1] {
                color: #2aa198
            }

            /* Comment.Single */
            c-[cs] {
                color: #2aa198
            }

            /* Comment.Special */
            c-[kc] {
                color: #d33682
            }

            /* Keyword.Constant */
            c-[kn] {
                color: #d33682
            }

            /* Keyword.Namespace */
            c-[kp] {
                color: #d33682
            }

            /* Keyword.Pseudo */
            c-[kr] {
                color: #d33682
            }

            /* Keyword.Reserved */
            c-[ld] {
                color: #657b83
            }

            /* Literal.Date */
            c-[nc] {
                color: #268bd2
            }

            /* Name.Class */
            c-[no] {
                color: #268bd2
            }

            /* Name.Constant */
            c-[nd] {
                color: #268bd2
            }

            /* Name.Decorator */
            c-[ni] {
                color: #268bd2
            }

            /* Name.Entity */
            c-[ne] {
                color: #268bd2
            }

            /* Name.Exception */
            c-[nf] {
                color: #268bd2
            }

            /* Name.Function */
            c-[nl] {
                color: #268bd2
            }

            /* Name.Label */
            c-[nn] {
                color: #268bd2
            }

            /* Name.Namespace */
            c-[py] {
                color: #268bd2
            }

            /* Name.Property */
            c-[ow] {
                color: #657b83
            }

            /* Operator.Word */
            c-[mb] {
                color: #657b83
            }

            /* Literal.Number.Bin */
            c-[mf] {
                color: #657b83
            }

            /* Literal.Number.Float */
            c-[mh] {
                color: #657b83
            }

            /* Literal.Number.Hex */
            c-[mi] {
                color: #657b83
            }

            /* Literal.Number.Integer */
            c-[mo] {
                color: #657b83
            }

            /* Literal.Number.Oct */
            c-[sa] {
                color: #6c71c4
            }

            /* Literal.String.Affix */
            c-[sb] {
                color: #6c71c4
            }

            /* Literal.String.Backtick */
            c-[sc] {
                color: #6c71c4
            }

            /* Literal.String.Char */
            c-[dl] {
                color: #6c71c4
            }

            /* Literal.String.Delimiter */
            c-[sd] {
                color: #6c71c4
            }

            /* Literal.String.Doc */
            c-[se] {
                color: #6c71c4
            }

            /* Literal.String.Escape */
            c-[sh] {
                color: #6c71c4
            }

            /* Literal.String.Heredoc */
            c-[si] {
                color: #6c71c4
            }

            /* Literal.String.Interpol */
            c-[sx] {
                color: #6c71c4
            }

            /* Literal.String.Other */
            c-[sr] {
                color: #6c71c4
            }

            /* Literal.String.Regex */
            c-[ss] {
                color: #6c71c4
            }

            /* Literal.String.Symbol */
            c-[fm] {
                color: #268bd2
            }

            /* Name.Function.Magic */
            c-[vc] {
                color: #cb4b16
            }

            /* Name.Variable.Class */
            c-[vg] {
                color: #cb4b16
            }

            /* Name.Variable.Global */
            c-[vi] {
                color: #cb4b16
            }

            /* Name.Variable.Instance */
            c-[vm] {
                color: #cb4b16
            }

            /* Name.Variable.Magic */
            c-[il] {
                color: #657b83
            }

            /* Literal.Number.Integer.Long */
        }
    </style>
    <style>
        /* Boilerplate: style-var-click-highlighting */
        /*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)

For darkmode:
0 = oklab(50%   0%  108%)
1 = oklab(50% -51%   51%)
2 = oklab(50% -64%  -20%)
3 = oklab(50%   6%   19%)
4 = oklab(50% -12%  -64%)
5 = oklab(50%  44%  -19%)  
6 = oklab(50% 102%   38%)
*/

        [data-algorithm] var {
            cursor: pointer;
        }

        var[data-var-color] {
            background-color: var(--var-bg);
            box-shadow: 0 0 0 2px var(--var-bg);
        }

        var[data-var-color] {
            --var-bg: #F4D200;
        }

        var[data-var-color="1"] {
            --var-bg: #FF87A2;
        }

        var[data-var-color="2"] {
            --var-bg: #96E885;
        }

        var[data-var-color="3"] {
            --var-bg: #3EEED2;
        }

        var[data-var-color="4"] {
            --var-bg: #EACFB6;
        }

        var[data-var-color="5"] {
            --var-bg: #82DDFF;
        }

        var[data-var-color="6"] {
            --var-vg: #FFBCF2;
        }

        @media (prefers-color-scheme: dark) {
            var[data-var-color] {
                --var-bg: #bc1a00;
            }

            var[data-var-color="1"] {
                --var-bg: #007f00;
            }

            var[data-var-color="2"] {
                --var-bg: #008698;
            }

            var[data-var-color="3"] {
                --var-bg: #7f5b2b;
            }

            var[data-var-color="4"] {
                --var-bg: #004df3;
            }

            var[data-var-color="5"] {
                --var-bg: #a1248a;
            }

            var[data-var-color="6"] {
                --var-vg: #ff0000;
            }
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">
    <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet"
        type="text/css">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">環境光センサー</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types/#WD">W3C作業草案</a>、<time class="dt-updated"
                datetime="2025-02-12">2025年2月12日</time></p>
        <details open>
            <summary>この文書の詳細情報</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>このバージョン:
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2025/WD-ambient-light-20250212/">https://www.w3.org/TR/2025/WD-ambient-light-20250212/</a>
                    <dt>最新公開バージョン:
                    <dd><a href="https://www.w3.org/TR/ambient-light/">https://www.w3.org/TR/ambient-light/</a>
                    <dt>編集者ドラフト:
                    <dd><a href="https://w3c.github.io/ambient-light/">https://w3c.github.io/ambient-light/</a>
                    <dt>以前のバージョン:
                    <dd><a href="https://www.w3.org/TR/2024/WD-ambient-light-20240124/"
                            rel="prev">https://www.w3.org/TR/2024/WD-ambient-light-20240124/</a>
                    <dt>履歴:
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/ambient-light/">https://www.w3.org/standards/history/ambient-light/</a>
                    <dt>フィードバック:
                    <dd><span><a
                                href="mailto:public-device-apis@w3.org?subject=%5Bambient-light%5D%20YOUR%20TOPIC%20HERE">public-device-apis@w3.org</a>
                            件名 “<kbd>[ambient-light] <i data-lt>… メッセージトピック …</i></kbd>” (<a
                                href="https://lists.w3.org/Archives/Public/public-device-apis/"
                                rel="discussion">アーカイブ</a>)</span>
                    <dd><a href="https://github.com/w3c/ambient-light/issues/">GitHub</a>
                    <dt>テストスイート:
                    <dd><a
                            href="https://github.com/web-platform-tests/wpt/tree/master/ambient-light">https://github.com/web-platform-tests/wpt/tree/master/ambient-light</a>
                    <dt class="editor">編集者:
                    <dd class="editor p-author h-card vcard" data-editor-id="41974"><a class="p-name fn u-url url"
                            href="https://intel.com/">Anssi Kostiainen</a> (<span class="p-org org">Intel
                            Corporation</span>)
                    <dd class="editor p-author h-card vcard" data-editor-id="80407"><a class="p-name fn u-url url"
                            href="https://intel.com/">Rijubrata Bhaumik</a> (<span class="p-org org">Intel
                            Corporation</span>)
                    <dt class="editor">以前の編集者:
                    <dd class="editor p-author h-card vcard" data-editor-id="60809"><a class="p-name fn u-url url"
                            href="https://tobie.me">Tobie Langel</a> (<span class="p-org org">Codespeaks、元Intel
                            Corporation代表</span>) <a class="u-email email"
                            href="mailto:tobie@codespeaks.com">tobie@codespeaks.com</a>
                    <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url"
                            href="https://mozilla.com/">Doug Turner</a> (<span class="p-org org">Mozilla
                            Corporation</span>)
                    <dt>課題管理:
                    <dd><a href="https://github.com/w3c/ambient-light/milestones/Level%202">Level 2の課題</a>
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> ©
            2025 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr
                title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a
                href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/copyright/software-license/" rel="license"
                title="W3C Software and Document License">permissive document license</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">概要</span></h2>
        <p>本仕様は、デバイスの周辺環境の環境光レベル（照度）を監視するための具体的なセンサーインターフェースを定義します。</p>
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">この文書のステータス</span></h2>
    <div data-fill-with="status">
        <p> <em>このセクションは、公開時点での本書のステータスについて説明しています。現在のW3C出版物および最新の技術レポートの改訂版は、<a
                    href="https://www.w3.org/TR/">W3C技術レポート一覧（https://www.w3.org/TR/）</a>でご覧いただけます。</em> </p>
        <p> 本文書は<a href="https://www.w3.org/groups/wg/das">Devices and Sensors Working Group</a>によって、<a
                href="https://www.w3.org/policies/process/20231103/#recs-and-notes">勧告プロセス</a>を用いて作業草案として公開されました。本書はW3C勧告となることを目的としています。
        </p>
        <p> 本書に関するコメントがある場合は、<a
                href="mailto:public-device-apis@w3.org?Subject=%5Bambient-light%5D%20PUT%20SUBJECT%20HERE">public-device-apis@w3.org</a>
            （<a href="mailto:public-device-apis-request@w3.org?subject=subscribe">購読</a>, <a
                href="https://lists.w3.org/Archives/Public/public-device-apis/">アーカイブ</a>）へお送りください。
            メール送信時は、件名に“ambient-light”と記載してください。例：“[ambient-light] <em>…コメント要約…</em>”。
            すべてのコメントを歓迎します。</p>
        <p> 作業草案として公開された文書は、<abbr
                title="World Wide Web Consortium">W3C</abbr>およびそのメンバーによる承認を意味するものではありません。本書はドラフト文書であり、いつでも更新、差し替え、または廃止される可能性があります。進行中の作業以外の目的で引用することは不適切です。
        </p>
        <p> 本書は<a href="https://www.w3.org/policies/patent-policy/">W3C特許ポリシー</a>の下で活動するグループにより作成されました。
            W3Cは、グループの成果物に関連する<a href="https://www.w3.org/groups/wg/das/ipr" rel="disclosure">公的な特許開示リスト</a>を管理しています。
            また、そのページには特許開示の手続きも記載されています。
            個人が、本書に関連する<a href="https://www.w3.org/policies/patent-policy/#def-essential">必須請求項</a>を含む特許について知っている場合は、<a
                href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">W3C特許ポリシー第6節</a>に従い開示する必要があります。</p>
        <p> 本書は<a href="https://www.w3.org/policies/process/20231103/"
                id="w3c_process_revision">2023年11月3日W3Cプロセス文書</a>に従って管理されています。</p>
        <p></p>
        <p>Devices and Sensors Working
            Groupは、本仕様およびプライバシー・セキュリティレビューの実施方法が変化していることを踏まえ、現代的なセキュリティ・プライバシーレビューを進めています。2017年10月3日に実施された<a
                href="https://github.com/w3c/sensors/issues/299#issue-262392533">水平レビュー</a>以降の変更も考慮しています。同様に、最新のアーキテクチャレビューの実施方法に対応するため、Technical
            Architecture Groupレビューの更新も進めています。</p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目次</h2>
        <ol class="toc" role="directory">
            <li>
                <a href="#intro"><span class="secno">1</span> <span class="content">はじめに</span></a>
                <ol class="toc">
                    <li><a href="#scope"><span class="secno">1.1</span> <span class="content">対象範囲</span></a>
                </ol>
            <li><a href="#examples"><span class="secno">2</span> <span class="content">例</span></a>
            <li>
                <a href="#security-and-privacy"><span class="secno">3</span> <span
                        class="content">セキュリティとプライバシーに関する考慮事項</span></a>
                <ol class="toc">
                    <li><a href="#reduce-sensor-accuracy"><span class="secno">3.1</span> <span
                                class="content">センサー読み取り値の精度低減</span></a>
                </ol>
            <li><a href="#model"><span class="secno">4</span> <span class="content">モデル</span></a>
            <li>
                <a href="#api"><span class="secno">5</span> <span class="content">API</span></a>
                <ol class="toc">
                    <li>
                        <a href="#ambient-light-sensor-interface"><span class="secno">5.1</span> <span
                                class="content">AmbientLightSensorインターフェース</span></a>
                        <ol class="toc">
                            <li><a href="#ambient-light-sensor-reading-attribute"><span class="secno">5.1.1</span> <span
                                        class="content">illuminance属性</span></a>
                        </ol>
                </ol>
            <li>
                <a href="#abstract-operations"><span class="secno">6</span> <span class="content">抽象的な操作</span></a>
                <ol class="toc">
                    <li><a href="#construct-an-ambient-light-sensor-object"><span class="secno">6.1</span> <span
                                class="content">ambient light sensorオブジェクトの構築</span></a>
                    <li><a href="#ambient-light-threshold-check-algorithm"><span class="secno">6.2</span> <span
                                class="content">ambient lightしきい値チェックアルゴリズム</span></a>
                    <li><a href="#ambient-light-reading-quantization-algorithm"><span class="secno">6.3</span> <span
                                class="content">ambient light読み取り量子化アルゴリズム</span></a>
                </ol>
            <li><a href="#automation"><span class="secno">7</span> <span class="content">自動化</span></a>
            <li><a href="#usecases-requirements"><span class="secno">8</span> <span class="content">ユースケースと要件</span></a>
            <li><a href="#acknowledgements"><span class="secno">9</span> <span class="content">謝辞</span></a>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content">適合性</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">文書上の慣例</span></a>
                    <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span
                                class="content">適合するアルゴリズム</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本仕様で定義される用語</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">他で参照定義される用語</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">規定参考文献</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">参考情報文献</span></a>
                </ol>
            <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span
                class="content">はじめに</span><a class="self-link" href="#intro"></a></h2>
        <p>Ambient Light SensorはGeneric Sensor API <a data-link-type="biblio" href="#biblio-generic-sensor"
                title="Generic Sensor API">[GENERIC-SENSOR]</a>を拡張し、デバイスのメイン光検出器によって検出された環境光レベル（lux単位）に関する情報を提供します。</p>
        <h3 class="heading settled" data-level="1.1" id="scope"><span class="secno">1.1. </span><span
                class="content">対象範囲</span><a class="self-link" href="#scope"></a></h3>
        <p>本書は、低レイテンシで高頻度のサンプリングが可能な、詳細な照度データを必要とする<a href="#usecases-requirements">ユースケース</a>向けに設計されたAPIを規定します。</p>
        <p>コントラストレベルやデバイスの測定した環境光レベルに基づく推奨カラースキームなど、少数の照度値に依存する一般的なユースケースには、<code>prefers-contrast</code>および<code>prefers-color-scheme</code>
            CSSメディア特性 <a data-link-type="biblio" href="#biblio-mediaqueries-5"
                title="Media Queries Level 5">[MEDIAQUERIES-5]</a>、並びに<code>matchMedia</code> API <a
                data-link-type="biblio" href="#biblio-cssom-view-1"
                title="CSSOM View Module">[CSSOM-VIEW-1]</a>の利用が推奨され、本APIの対象外となります。
        </p>
        <p class="note" role="note"><span class="marker">注:</span> <a data-link-type="biblio"
                href="#biblio-mediaqueries-5"
                title="Media Queries Level 5">[MEDIAQUERIES-5]</a>仕様には、かつて環境光の測定値に直接対応する<code>light-level</code>メディア特性が含まれていましたが、より高レベルな<code>prefers-color-scheme</code>および<code>prefers-contrast</code>メディア特性が推奨されることとなり、仕様から<a
                href="https://github.com/w3c/csswg-drafts/commit/f5b663c27d5a2715239633f4916880563969d770">削除</a>されました。
        </p>
        <h2 class="heading settled" data-level="2" id="examples"><span class="secno">2. </span><span
                class="content">例</span><a class="self-link" href="#examples"></a></h2>
        <div class="example" id="example-cdf5e857">
            <a class="self-link" href="#example-cdf5e857"></a> この簡単な例では、ambient light sensorがデフォルト設定で作成されます。新しい<a
                data-link-type="dfn" href="https://w3c.github.io/sensors/#sensor-reading"
                id="ref-for-sensor-reading">読み取り値</a>が利用可能になるたび、コンソールに出力されます。
            <pre class="highlight"><c- a>const</c-> sensor <c- o>=</c-> <c- ow>new</c-> AmbientLightSensor<c- p>();</c->
sensor<c- p>.</c->onreading <c- o>=</c-> <c- p>()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c->sensor<c- p>.</c->illuminance<c- p>);</c->
sensor<c- p>.</c->onerror <c- o>=</c-> event <c- p>=></c-> console<c- p>.</c->log<c- p>(</c->event<c- p>.</c->error<c- p>.</c->name<c- p>,</c-> event<c- p>.</c->error<c- p>.</c->message<c- p>);</c->
sensor<c- p>.</c->start<c- p>();</c->
</pre>
        </div>
        <div class="example" id="example-20e631c4">
            <a class="self-link" href="#example-20e631c4"></a> この例では、ISO 100での露出値（EV）を環境光<a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#sensor-reading"
                id="ref-for-sensor-reading①">センサーの読み取り値</a>から計算します。最初に、ユーザーエージェントが環境光<a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#sensor-reading"
                id="ref-for-sensor-reading②">センサーの読み取り値</a>にアクセスする権限があるか確認します。
            その後、<code
                class="idl"><a class="idl-code" data-link-type="attribute" href="#dom-ambientlightsensor-illuminance" id="ref-for-dom-ambientlightsensor-illuminance">illuminance</a></code>
            の値を最も近い露出値に変換します。
            <pre class="highlight">navigator<c- p>.</c->permissions<c- p>.</c->query<c- p>({</c-> name<c- o>:</c-> <c- t>'ambient-light-sensor'</c-> <c- p>}).</c->then<c- p>(</c->result <c- p>=></c-> <c- p>{</c->
    <c- k>if</c-> <c- p>(</c->result<c- p>.</c->state <c- o>===</c-> <c- t>'denied'</c-><c- p>)</c-> <c- p>{</c->
        console<c- p>.</c->log<c- p>(</c-><c- t>'Permission to use ambient light sensor is denied.'</c-><c- p>);</c->
        <c- k>return</c-><c- p>;</c->
    <c- p>}</c->

    <c- a>const</c-> als <c- o>=</c-> <c- ow>new</c-> AmbientLightSensor<c- p>({</c->frequency<c- o>:</c-> <c- mf>20</c-><c- p>});</c->
    als<c- p>.</c->addEventListener<c- p>(</c-><c- t>'activate'</c-><c- p>,</c-> <c- p>()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- t>'Ready to measure EV.'</c-><c- p>));</c->
    als<c- p>.</c->addEventListener<c- p>(</c-><c- t>'error'</c-><c- p>,</c-> event <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- sb>`Error: </c-><c- si>${</c->event<c- p>.</c->error<c- p>.</c->name<c- si>}</c-><c- sb>`</c-><c- p>));</c->
    als<c- p>.</c->addEventListener<c- p>(</c-><c- t>'reading'</c-><c- p>,</c-> <c- p>()</c-> <c- p>=></c-> <c- p>{</c->
        <c- c1>// デフォルトISO値</c->
        <c- a>const</c-> ISO <c- o>=</c-> <c- mf>100</c-><c- p>;</c->
        <c- c1>// 入射光較正定数</c->
        <c- a>const</c-> C <c- o>=</c-> <c- mf>250</c-><c- p>;</c->

        <c- a>let</c-> EV <c- o>=</c-> Math<c- p>.</c->round<c- p>(</c->Math<c- p>.</c->log2<c- p>((</c->als<c- p>.</c->illuminance <c- o>*</c-> ISO<c- p>)</c-> <c- o>/</c-> C<c- p>));</c->
        console<c- p>.</c->log<c- p>(</c-><c- sb>`露出値（EV）は: </c-><c- si>${</c->EV<c- si>}</c-><c- sb>`</c-><c- p>);</c->
    <c- p>});</c->

    als<c- p>.</c->start<c- p>();</c->
<c- p>});</c->
</pre>
        </div>
        <div class="example" id="example-ad1f42be">
            <a class="self-link" href="#example-ad1f42be"></a> この例は、環境光<a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#sensor-reading"
                id="ref-for-sensor-reading③">センサーの読み取り値</a>を推奨される作業環境の照度レベルにマッピングする方法を示します。
            <pre class="highlight"><c- a>const</c-> als <c- o>=</c-> <c- ow>new</c-> AmbientLightSensor<c- p>();</c->

als<c- p>.</c->onreading <c- o>=</c-> <c- p>()</c-> <c- p>=></c-> <c- p>{</c->
    <c- a>let</c-> str <c- o>=</c-> luxToWorkplaceLevel<c- p>(</c->als<c- p>.</c->illuminance<c- p>);</c->
    <c- k>if</c-> <c- p>(</c->str<c- p>)</c-> <c- p>{</c->
        console<c- p>.</c->log<c- p>(</c-><c- sb>`照度レベルは以下に適しています: </c-><c- si>${</c->str<c- si>}</c-><c- sb>.`</c-><c- p>);</c->
    <c- p>}</c->
<c- p>};</c->

als<c- p>.</c->start<c- p>();</c->

<c- a>function</c-> luxToWorkplaceLevel<c- p>(</c->lux<c- p>)</c-> <c- p>{</c->
    <c- k>if</c-> <c- p>(</c->lux <c- o>></c-> <c- mf>20</c-> <c- o>&amp;&amp;</c-> lux <c- o>&lt;</c-> <c- mf>100</c-><c- p>)</c-> <c- p>{</c->
        <c- k>return</c-> <c- t>'共用エリアや短時間の滞在'</c-><c- p>;</c->
    <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c->lux <c- o>></c-> <c- mf>100</c-> <c- o>&amp;&amp;</c-> lux <c- o>&lt;</c-> <c- mf>150</c-><c- p>)</c-> <c- p>{</c->
        <c- k>return</c-> <c- t>'時々行う視覚作業'</c-><c- p>;</c->
    <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c->lux <c- o>></c-> <c- mf>150</c-> <c- o>&amp;&amp;</c-> lux <c- o>&lt;</c-> <c- mf>250</c-><c- p>)</c-> <c- p>{</c->
        <c- k>return</c-> <c- t>'簡単な事務作業、授業、家庭、劇場'</c-><c- p>;</c->
    <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c->lux <c- o>></c-> <c- mf>250</c-> <c- o>&amp;&amp;</c-> lux <c- o>&lt;</c-> <c- mf>500</c-><c- p>)</c-> <c- p>{</c->
        <c- k>return</c-> <c- t>'通常の事務作業、食料品店、研究室'</c-><c- p>;</c->
    <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c->lux <c- o>></c-> <c- mf>500</c-> <c- o>&amp;&amp;</c-> lux <c- o>&lt;</c-> <c- mf>1000</c-><c- p>)</c-> <c- p>{</c->
        <c- k>return</c-> <c- t>'機械工場、製図、スーパーマーケット'</c-><c- p>;</c->
    <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c->lux <c- o>></c-> <c- mf>1000</c-> <c- o>&amp;&amp;</c-> lux <c- o>&lt;</c-> <c- mf>5000</c-><c- p>)</c-> <c- p>{</c->
        <c- k>return</c-> <c- t>'詳細な製図作業、コントラストの低い視覚作業'</c-><c- p>;</c->
    <c- p>}</c->

    <c- k>return</c-><c- p>;</c->
<c- p>}</c->
</pre>
        </div>
        <h2 class="heading settled" data-level="3" id="security-and-privacy"><span class="secno">3. </span><span
                class="content">セキュリティとプライバシーに関する考慮事項</span><a class="self-link" href="#security-and-privacy"></a></h2>
        <p><a class="tracking-vector" href="https://infra.spec.whatwg.org/#tracking-vector"
                style="color: currentcolor"><svg aria-label="(This is a tracking vector.)" class="darkmode-aware"
                    height="64" role="img" width="46">
                    <title>トラッキングベクトルがあります。</title>
                    <use href="#b732b3fe"></use>
                </svg></a> Ambient Light Sensorはデバイス周辺の照明状況に関する情報を提供します。潜在的なプライバシーリスクには以下が含まれます：</p>
        <ul>
            <li data-md>
                <p>プロファイリング。Ambient Light
                    Sensorは、ユーザーの利用パターンや周辺環境に関する情報を漏洩する可能性があります。この情報はユーザープロファイリングや行動分析の強化に利用される可能性があります。</p>
            <li data-md>
                <p>クロスデバイスリンク。2台のデバイスが同じサードパーティスクリプトを含むウェブサイトにアクセスし、時間をかけて照度レベルを相関させることができます。</p>
            <li data-md>
                <p>クロスデバイス通信。デバイスの画面やカメラLEDのフラッシュを利用し、近くのデバイスのAmbient Light Sensorで読み取らせてメッセージをブロードキャストするシンプルな通信方法が可能です。
                </p>
            <li data-md>
                <p>クロスオリジンリーク。画面から発せられる光が近くの反射面からセンサーへ反射されることがあります。悪意のあるサイトが異なるオリジンからリソースを埋め込み、特定のピクセルを表示・識別できるようにコンテンツをスケールすることが可能です。
                </p>
            <li data-md>
                <p>閲覧履歴のハイジャック。訪問済みリンクや未訪問リンクに異なるスタイル（例：訪問済みリンクは黒、未訪問リンクは白）を適用し、それにより照度レベルの違いからリンクの状態を識別できるようにすること。</p>
        </ul>
        <p><a data-link-type="biblio" href="#biblio-alsprivacyanalysis"
                title="Privacy analysis of Ambient Light Sensors">[ALSPRIVACYANALYSIS]</a>、<a data-link-type="biblio"
                href="#biblio-pinskimmingviasensor"
                title="PIN Skimming: Exploiting the Ambient-Light Sensor in Mobile Devices">[PINSKIMMINGVIASENSOR]</a>、
            <a data-link-type="biblio" href="#biblio-stealingsensitivedata"
                title="Stealing sensitive browser data with the W3C Ambient Light Sensor API">[STEALINGSENSITIVEDATA]</a>、
            <a data-link-type="biblio" href="#biblio-videorecognitionambientlight"
                title="Video recognition using ambient light sensors">[VIDEORECOGNITIONAMBIENTLIGHT]</a>、および <a
                data-link-type="biblio" href="#biblio-imagingprivacy"
                title="Imaging privacy threats from an ambient light sensor">[IMAGINGPRIVACY]</a>
            などの研究で、これらの問題がさらに深く検討されています。
        </p>
        <p>Ambient Light Sensor固有の脅威を軽減するため、ユーザーエージェントはセンサーの読み取り値の<a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#reduce-accuracy"
                id="ref-for-reduce-accuracy">精度を低減</a>しなければなりません。また、ユーザーエージェントは<a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#limit-max-frequency"
                id="ref-for-limit-max-frequency">最大サンプリング周波数を制限</a>してもよいです。</p>
        <p>これらの緩和策は、Generic Sensor APIで定義される<a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#mitigation-strategies"
                id="ref-for-mitigation-strategies">汎用的な緩和策</a>を補完するものです。<a data-link-type="biblio"
                href="#biblio-generic-sensor" title="Generic Sensor API">[GENERIC-SENSOR]</a></p>
        <h3 class="heading settled" data-level="3.1" id="reduce-sensor-accuracy"><span class="secno">3.1. </span><span
                class="content">センサー読み取り値の精度低減</span><a class="self-link" href="#reduce-sensor-accuracy"></a></h3>
        <p>センサーの読み取り値の<a data-link-type="dfn" href="https://w3c.github.io/sensors/#reduce-accuracy"
                id="ref-for-reduce-accuracy①">精度を低減</a>するため、本仕様は<a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#threshold-check-algorithm"
                id="ref-for-threshold-check-algorithm">しきい値チェックアルゴリズム</a>（<a data-link-type="dfn"
                href="#ambient-light-threshold-check-algorithm"
                id="ref-for-ambient-light-threshold-check-algorithm">ambient lightしきい値チェックアルゴリズム</a>）と、
            <a data-link-type="dfn" href="https://w3c.github.io/sensors/#reading-quantization-algorithm"
                id="ref-for-reading-quantization-algorithm">読み取り量子化アルゴリズム</a>（<a data-link-type="dfn"
                href="#ambient-light-reading-quantization-algorithm"
                id="ref-for-ambient-light-reading-quantization-algorithm">ambient light読み取り量子化アルゴリズム</a>）を定義します。
        </p>
        <p>これらのアルゴリズムは<a data-link-type="dfn" href="#illuminance-rounding-multiple"
                id="ref-for-illuminance-rounding-multiple">illuminance rounding multiple</a>および<a data-link-type="dfn"
                href="#illuminance-threshold-value" id="ref-for-illuminance-threshold-value">illuminance threshold
                value</a>を利用します。実装はそれらの値に関して以下の要件を遵守しなければなりません：</p>
        <ul>
            <li data-md>
                <p><a data-link-type="dfn" href="#illuminance-rounding-multiple"
                        id="ref-for-illuminance-rounding-multiple①">illuminance rounding multiple</a>は50ルクス以上でなければなりません。
                </p>
            <li data-md>
                <p><a data-link-type="dfn" href="#illuminance-threshold-value"
                        id="ref-for-illuminance-threshold-value①">illuminance threshold value</a>は<a
                        data-link-type="dfn" href="#illuminance-rounding-multiple"
                        id="ref-for-illuminance-rounding-multiple②">illuminance rounding multiple</a>の半分以上であるべきです。</p>
        </ul>
        <p class="note" role="note"><span class="marker">注:</span> <a data-link-type="dfn"
                href="#illuminance-rounding-multiple" id="ref-for-illuminance-rounding-multiple③">illuminance rounding
                multiple</a>の値の選定は、読み取り値があまりにも精密にならないようにしつつ、API利用者にとって有用な値を提供するバランスが必要です。<a data-link-type="dfn"
                href="#illuminance-rounding-multiple" id="ref-for-illuminance-rounding-multiple④">illuminance rounding
                multiple</a>の最小値50ルクスは、異なる照明条件下での環境光レベルの測定が<a
                href="https://docs.google.com/spreadsheets/d/1vUojkaaif6AmftQmtqra1w9Z7CH00Cn9pb0Ci6v5_Jk">収集</a>され、<a
                data-link-type="biblio" href="#biblio-stealingsensitivedata"
                title="Stealing sensitive browser data with the W3C Ambient Light Sensor API">[STEALINGSENSITIVEDATA]</a>で記述された攻撃を防げることが<a
                href="https://github.com/w3c/ambient-light/issues/13#issuecomment-302393458">GitHub issue
                #13</a>で示されました。また、50ルクスは、環境光センサー読み取り値を使った<a data-link-type="biblio"
                href="#biblio-videorecognitionambientlight"
                title="Video recognition using ambient light sensors">[VIDEORECOGNITIONAMBIENTLIGHT]</a>によるビデオ認識を不可能にするために必要な5ルクスより高い値です。
        </p>
        <p class="note" role="note"><span class="marker">注:</span> <a data-link-type="dfn"
                href="#illuminance-threshold-value" id="ref-for-illuminance-threshold-value②">illuminance threshold
                value</a>は、読み取り値が特定の値付近で量子化されて切り替わる事実が漏洩するのを防ぐために使われます。例えば、<a data-link-type="dfn"
                href="#illuminance-rounding-multiple" id="ref-for-illuminance-rounding-multiple⑤">illuminance rounding
                multiple</a>が50の場合、生の読み取り値が24から26の間で変動しても、illuminance値が0と50の間で切り替わることを防げます。<a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#threshold-check-algorithm"
                id="ref-for-threshold-check-algorithm①">threshold check
                algorithm</a>の補助的なフィンガープリント緩和策としての有効性は数学的に証明されていませんが、実装経験に基づき本仕様に追加されています。詳細は<a
                href="https://crbug.com/1332536">Chromium bug 1332536</a>および<a
                href="https://crrev.com/c/3666917">Chromium review 3666917</a>をご覧ください。</p>
        <h2 class="heading settled" data-level="4" id="model"><span class="secno">4. </span><span
                class="content">モデル</span><a class="self-link" href="#model"></a></h2>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="ambient-light-sensor">Ambient Light
                Sensor</dfn> <a data-link-type="dfn" href="https://w3c.github.io/sensors/#sensor-type"
                id="ref-for-sensor-type">センサータイプ</a>に関連する<code
                class="idl"><a data-link-type="idl" href="https://w3c.github.io/sensors/#sensor" id="ref-for-sensor">Sensor</a></code>
            のサブクラスは<code
                class="idl"><a data-link-type="idl" href="#ambientlightsensor" id="ref-for-ambientlightsensor">AmbientLightSensor</a></code>クラスです。
        </p>
        <p><a data-link-type="dfn" href="#ambient-light-sensor" id="ref-for-ambient-light-sensor">Ambient Light
                Sensor</a>には、デバイスのメイン光検出器である<a data-link-type="dfn" href="https://w3c.github.io/sensors/#default-sensor"
                id="ref-for-default-sensor">default sensor</a>があります。</p>
        <p><a data-link-type="dfn" href="#ambient-light-sensor" id="ref-for-ambient-light-sensor①">Ambient Light
                Sensor</a>は、<a data-link-type="dfn" href="https://w3c.github.io/permissions/#dfn-powerful-feature"
                id="ref-for-dfn-powerful-feature">強力な機能</a>であり、<a data-link-type="dfn"
                href="https://w3c.github.io/permissions/#dfn-name" id="ref-for-dfn-name">名前</a>は"<dfn
                class="dfn-paneled idl-code" data-dfn-type="permission" data-export
                id="permissiondef-ambient-light-sensor"><code>ambient-light-sensor</code></dfn>"です。これが<a
                data-link-type="dfn" href="https://w3c.github.io/sensors/#sensor-permission-names"
                id="ref-for-sensor-permission-names">センサーの権限名</a>にもなります。その<a data-link-type="dfn"
                href="https://w3c.github.io/permissions/#dfn-permission-revocation-algorithm"
                id="ref-for-dfn-permission-revocation-algorithm">権限取り消しアルゴリズム</a>は、
            <a data-link-type="dfn" href="https://w3c.github.io/sensors/#generic-sensor-permission-revocation-algorithm"
                id="ref-for-generic-sensor-permission-revocation-algorithm">generic sensor permission revocation
                algorithm</a>を"ambient-light-sensor"で呼び出した結果です。
        </p>
        <p><a data-link-type="dfn" href="#ambient-light-sensor" id="ref-for-ambient-light-sensor②">Ambient Light
                Sensor</a>は、"ambient-light-sensor"という文字列で識別される<a data-link-type="dfn"
                href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature"
                id="ref-for-policy-controlled-feature">ポリシー制御機能</a>です。その<a data-link-type="dfn"
                href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist"
                id="ref-for-policy-controlled-feature-default-allowlist">デフォルト許可リスト</a>は<code>'self'</code>です。
        </p>
        <p><a data-link-type="dfn" href="#ambient-light-sensor" id="ref-for-ambient-light-sensor③">Ambient Light
                Sensor</a>には<a data-link-type="dfn" href="https://w3c.github.io/sensors/#virtual-sensor-type"
                id="ref-for-virtual-sensor-type">仮想センサータイプ</a>があり、その値は"<code><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="ambient-light virtual sensor type" data-noexport id="ambient-light-virtual-sensor-type">ambient-light</dfn></code>"です。
        </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="current-light-level">現在の照度レベル</dfn>または<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="illuminance">照度</dfn>は、ホストデバイスの周辺環境光レベルを表す値です。単位はルクス（lx）です<a data-link-type="biblio"
                href="#biblio-si" title="SI Brochure: The International System of Units (SI), 8th edition">[SI]</a>。</p>
        <p class="note" role="note"><span class="marker">注:</span> 同じ照明下でも、異なるデバイスが報告する正確なルクス値は検出方法やセンサー構造などの違いにより異なります。
        </p>
        <p><a data-link-type="dfn" href="#ambient-light-sensor" id="ref-for-ambient-light-sensor④">Ambient Light
                Sensor</a>には、ルクス単位の<dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="illuminance rounding multiple"
                data-noexport id="illuminance-rounding-multiple">illuminance rounding
                multiple</dfn>があり、その倍数に照度の読み取り値が切り上げられます。</p>
        <p><a data-link-type="dfn" href="#ambient-light-sensor" id="ref-for-ambient-light-sensor⑤">Ambient Light
                Sensor</a>には、ルクス単位の<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="illuminance-threshold-value">illuminance threshold value</dfn>があり、<a data-link-type="dfn"
                href="#ambient-light-threshold-check-algorithm"
                id="ref-for-ambient-light-threshold-check-algorithm①">ambient lightしきい値チェックアルゴリズム</a>で利用されます。</p>
        <p class="note" role="note"><span class="marker">注:</span> 上記値の最小要件については<a href="#reduce-sensor-accuracy">§ 3.1
                センサー読み取り値の精度低減</a>を参照してください。</p>
        <h2 class="heading settled" data-level="5" id="api"><span class="secno">5. </span><span
                class="content">API</span><a class="self-link" href="#api"></a></h2>
        <h3 class="heading settled" data-level="5.1" id="ambient-light-sensor-interface"><span class="secno">5.1.
            </span><span class="content">AmbientLightSensor インターフェース</span><a class="self-link"
                href="#ambient-light-sensor-interface"></a></h3>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="ambientlightsensor"><code><c- g>AmbientLightSensor</c-></code></dfn> : <a data-link-type="idl-name" href="https://w3c.github.io/sensors/#sensor" id="ref-for-sensor①"><c- n>Sensor</c-></a> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="AmbientLightSensor" data-dfn-type="constructor" data-export data-lt="AmbientLightSensor(sensorOptions)|constructor(sensorOptions)|AmbientLightSensor()|constructor()" id="dom-ambientlightsensor-ambientlightsensor"><code><c- g>constructor</c-></code></dfn>(<c- b>optional</c-> <a data-link-type="idl-name" href="https://w3c.github.io/sensors/#dictdef-sensoroptions" id="ref-for-dictdef-sensoroptions"><c- n>SensorOptions</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="AmbientLightSensor/AmbientLightSensor(sensorOptions), AmbientLightSensor/constructor(sensorOptions), AmbientLightSensor/AmbientLightSensor(), AmbientLightSensor/constructor()" data-dfn-type="argument" data-export id="dom-ambientlightsensor-ambientlightsensor-sensoroptions-sensoroptions"><code><c- g>sensorOptions</c-></code></dfn> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double" id="ref-for-idl-double"><c- b>double</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="AmbientLightSensor" data-dfn-type="attribute" data-export data-readonly data-type="double?" id="dom-ambientlightsensor-illuminance"><code><c- g>illuminance</c-></code></dfn>;
};
</pre>
        <p><code
                class="idl"><a data-link-type="idl" href="#ambientlightsensor" id="ref-for-ambientlightsensor①">AmbientLightSensor</a></code>
            オブジェクトを構築するには、ユーザーエージェントは <a data-link-type="dfn" href="#construct-an-ambient-light-sensor-object"
                id="ref-for-construct-an-ambient-light-sensor-object">ambient light sensor オブジェクトの構築</a>
            抽象操作を実行しなければなりません。</p>
        <h4 class="heading settled" data-level="5.1.1" id="ambient-light-sensor-reading-attribute"><span
                class="secno">5.1.1. </span><span class="content">illuminance 属性</span><a class="self-link"
                href="#ambient-light-sensor-reading-attribute"></a></h4>
        <p><code
                class="idl"><a data-link-type="idl" href="#dom-ambientlightsensor-illuminance" id="ref-for-dom-ambientlightsensor-illuminance①">illuminance</a></code>
            の getter の手順は次の通りです：</p>
        <ol>
            <li data-md>
                <p><var>illuminance</var> を <a data-link-type="dfn"
                        href="https://w3c.github.io/sensors/#get-value-from-latest-reading"
                        id="ref-for-get-value-from-latest-reading">get value from latest reading</a> を <a
                        data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a> と
                    "illuminance" を引数として呼び出した結果とする。</p>
            <li data-md>
                <p><var>illuminance</var> を返す。</p>
        </ol>
        <h2 class="heading settled" data-level="6" id="abstract-operations"><span class="secno">6. </span><span
                class="content">抽象的な操作</span><a class="self-link" href="#abstract-operations"></a></h2>
        <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="6.1"
            data-lt="Construct an ambient light sensor object" id="construct-an-ambient-light-sensor-object"><span
                class="secno">6.1. </span><span class="content">ambient light sensor オブジェクトの構築</span><a
                class="self-link" href="#construct-an-ambient-light-sensor-object"
                id="ref-for-construct-an-ambient-light-sensor-object①"></a></h3>
        <div class="algorithm" data-algorithm="construct an ambient light sensor object">
            <dl>
                <dt data-md>input
                <dd data-md>
                    <p><var>options</var>、<code
                            class="idl"><a data-link-type="idl" href="https://w3c.github.io/sensors/#dictdef-sensoroptions" id="ref-for-dictdef-sensoroptions①">SensorOptions</a></code>
                        オブジェクト。</p>
                <dt data-md>output
                <dd data-md>
                    <p><code
                            class="idl"><a data-link-type="idl" href="#ambientlightsensor" id="ref-for-ambientlightsensor②">AmbientLightSensor</a></code>
                        オブジェクト。</p>
            </dl>
            <ol>
                <li data-md>
                    <p><var>allowed</var> を <a data-link-type="dfn"
                            href="https://w3c.github.io/sensors/#check-sensor-policy-controlled-features"
                            id="ref-for-check-sensor-policy-controlled-features">check sensor policy-controlled
                            features</a> を <code
                            class="idl"><a data-link-type="idl" href="#ambientlightsensor" id="ref-for-ambientlightsensor③">AmbientLightSensor</a></code>
                        で呼び出した結果とする。
                    </p>
                <li data-md>
                    <p><var>allowed</var> が false なら、</p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw"
                                    id="ref-for-dfn-throw">例外を投げる</a>。<code
                                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror">SecurityError</a></code>
                                <code
                                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code>。
                            </p>
                    </ol>
                <li data-md>
                    <p><var>ambient_light_sensor</var> を新しい <code
                            class="idl"><a data-link-type="idl" href="#ambientlightsensor" id="ref-for-ambientlightsensor④">AmbientLightSensor</a></code>
                        オブジェクトとする。</p>
                <li data-md>
                    <p><var>ambient_light_sensor</var> と <var>options</var> を引数として <a data-link-type="dfn"
                            href="https://w3c.github.io/sensors/#initialize-a-sensor-object"
                            id="ref-for-initialize-a-sensor-object">initialize a sensor object</a> を呼び出す。
                    </p>
                <li data-md>
                    <p><var>ambient_light_sensor</var> を返す。</p>
            </ol>
        </div>
        <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="6.2"
            data-lt="Ambient light threshold check algorithm" data-noexport
            id="ambient-light-threshold-check-algorithm"><span class="secno">6.2. </span><span class="content">ambient
                light しきい値チェックアルゴリズム</span><a class="self-link" href="#ambient-light-threshold-check-algorithm"
                id="ref-for-ambient-light-threshold-check-algorithm②"></a></h3>
        <p><a data-link-type="dfn" href="#ambient-light-sensor" id="ref-for-ambient-light-sensor⑥">Ambient Light
                Sensor</a> の <a data-link-type="dfn" href="https://w3c.github.io/sensors/#sensor-type"
                id="ref-for-sensor-type①">センサータイプ</a>は以下の <a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#threshold-check-algorithm"
                id="ref-for-threshold-check-algorithm②">しきい値チェックアルゴリズム</a>を定義します：</p>
        <div class="algorithm" data-algorithm="ambient light threshold check">
            <dl>
                <dt data-md>input
                <dd data-md>
                    <p><var>newReading</var>、<a data-link-type="dfn"
                            href="https://w3c.github.io/sensors/#sensor-reading" id="ref-for-sensor-reading④">sensor
                            reading</a></p>
                <dd data-md>
                    <p><var>latestReading</var>、<a data-link-type="dfn"
                            href="https://w3c.github.io/sensors/#sensor-reading" id="ref-for-sensor-reading⑤">sensor
                            reading</a></p>
                <dt data-md>output
                <dd data-md>
                    <p>差分が十分に大きいかどうかを示す <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean"
                            id="ref-for-boolean">boolean</a>。</p>
            </dl>
            <ol>
                <li data-md>
                    <p><var>newReading</var>["illuminance"] が null なら true を返す。</p>
                <li data-md>
                    <p><var>latestReading</var>["illuminance"] が null なら true を返す。</p>
                <li data-md>
                    <p><var>newIlluminance</var> を <var>newReading</var>["illuminance"] とする。</p>
                <li data-md>
                    <p><var>latestIlluminance</var> を <var>latestReading</var>["illuminance"] とする。</p>
                <li data-md>
                    <p><a data-link-type="abstract-op" href="https://tc39.es/ecma262/#eqn-abs"
                            id="ref-for-eqn-abs">abs</a>(<var>latestIlluminance</var> - <var>newIlluminance</var>) が <a
                            data-link-type="dfn" href="#illuminance-threshold-value"
                            id="ref-for-illuminance-threshold-value③">illuminance threshold value</a> より小さいなら false を返す。
                    </p>
                <li data-md>
                    <p><var>roundedNewReading</var> を <a data-link-type="dfn"
                            href="#ambient-light-reading-quantization-algorithm"
                            id="ref-for-ambient-light-reading-quantization-algorithm①">ambient light 読み取り量子化アルゴリズム</a> を
                        <var>newIlluminance</var> で呼び出した結果とする。
                    </p>
                <li data-md>
                    <p><var>roundedLatestReading</var> を <a data-link-type="dfn"
                            href="#ambient-light-reading-quantization-algorithm"
                            id="ref-for-ambient-light-reading-quantization-algorithm②">ambient light 読み取り量子化アルゴリズム</a> を
                        <var>latestIlluminance</var> で呼び出した結果とする。
                    </p>
                <li data-md>
                    <p><var>roundedNewReading</var>["illuminance"] と
                        <var>roundedLatestIlluminance</var>["illuminance"]
                        が等しいなら false を返す。
                    </p>
                <li data-md>
                    <p>それ以外の場合は true を返す。</p>
            </ol>
        </div>
        <p class="note" role="note"><span class="marker">注:</span> このアルゴリズムは <a data-link-type="dfn"
                href="#ambient-light-reading-quantization-algorithm"
                id="ref-for-ambient-light-reading-quantization-algorithm③">ambient light 読み取り量子化アルゴリズム</a>
            を呼び出し、同じ値に切り上げられる読み取り値ではメインの <a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#update-latest-reading" id="ref-for-update-latest-reading">update
                latest reading</a> アルゴリズムの更新をトリガーしないことを保証します。そうしなければ、生の照度値が <a data-link-type="dfn"
                href="#illuminance-threshold-value" id="ref-for-illuminance-threshold-value④">illuminance threshold
                value</a> 以上の範囲で異なることをユーザーに示してしまい、異なる <a data-link-type="dfn" href="#illuminance-rounding-multiple"
                id="ref-for-illuminance-rounding-multiple⑥">illuminance rounding multiple</a>
            に切り上げられない場合でも情報が漏れることになります。</p>
        <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="6.3"
            data-lt="Ambient light reading quantization algorithm" data-noexport
            id="ambient-light-reading-quantization-algorithm"><span class="secno">6.3. </span><span
                class="content">ambient light 読み取り量子化アルゴリズム</span><a class="self-link"
                href="#ambient-light-reading-quantization-algorithm"
                id="ref-for-ambient-light-reading-quantization-algorithm④"></a></h3>
        <p><a data-link-type="dfn" href="#ambient-light-sensor" id="ref-for-ambient-light-sensor⑦">Ambient Light
                Sensor</a> の <a data-link-type="dfn" href="https://w3c.github.io/sensors/#sensor-type"
                id="ref-for-sensor-type②">センサータイプ</a>は以下の <a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#reading-quantization-algorithm"
                id="ref-for-reading-quantization-algorithm①">読み取り量子化アルゴリズム</a>を定義します：</p>
        <div class="algorithm" data-algorithm="ambient light reading quantization">
            <dl>
                <dt data-md>input
                <dd data-md>
                    <p><var>reading</var>、<a data-link-type="dfn" href="https://w3c.github.io/sensors/#sensor-reading"
                            id="ref-for-sensor-reading⑥">sensor
                            reading</a></p>
                <dt data-md>output
                <dd data-md>
                    <p><a data-link-type="dfn" href="https://w3c.github.io/sensors/#sensor-reading"
                            id="ref-for-sensor-reading⑦">sensor reading</a></p>
            </dl>
            <ol>
                <li data-md>
                    <p><var>quantizedReading</var> を <var>reading</var> とする。</p>
                <li data-md>
                    <p><var>quantizedReading</var>["illuminance"] を <a data-link-type="dfn"
                            href="#illuminance-rounding-multiple"
                            id="ref-for-illuminance-rounding-multiple⑦">illuminance rounding multiple</a> の倍数で
                        <var>reading</var>["illuminance"] に最も近い値に設定する。
                    </p>
                <li data-md>
                    <p><var>quantizedReading</var> を返す。</p>
            </ol>
        </div>
        <h2 class="heading settled" data-level="7" id="automation"><span class="secno">7. </span><span
                class="content">自動化</span><a class="self-link" href="#automation"></a></h2>
        <p>このセクションは、<a href="https://w3c.github.io/sensors/#automation"><cite>Generic Sensor API</cite> § 9
                自動化</a>を拡張し、<a data-link-type="dfn" href="#ambient-light-sensor"
                id="ref-for-ambient-light-sensor⑧">Ambient Light Sensor</a>固有の仮想センサーメタデータを提供します。</p>
        <div class="algorithm" data-algorithm="illuminance reading parsing algorithm"> <dfn class="dfn-paneled"
                data-dfn-type="dfn" data-noexport id="illuminance-reading-parsing-algorithm">illuminance
                読み取り値解析アルゴリズム</dfn>は、JSON <code
                class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/multipage/fundamental-objects.html#sec-object-objects" id="ref-for-sec-object-objects">Object</a></code>
            <var>parameters</var>が与えられたとき、<a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#parse-single-value-number-reading"
                id="ref-for-parse-single-value-number-reading">parse single-value number
                reading</a>を<var>parameters</var>と"<code>illuminance</code>"で呼び出した結果を返さなければなりません。
        </div>
        <p><a data-link-type="dfn" href="https://w3c.github.io/sensors/#per-type-virtual-sensor-metadata"
                id="ref-for-per-type-virtual-sensor-metadata">タイプごとの仮想センサーメタデータ</a> <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">マップ</a>には、以下の<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry"
                id="ref-for-map-entry">エントリ</a>を含めなければなりません：</p>
        <dl>
            <dt data-md><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-key"
                    id="ref-for-map-key">キー</a>
            <dd data-md>
                <p>"<code><a data-link-type="dfn" href="#ambient-light-virtual-sensor-type" id="ref-for-ambient-light-virtual-sensor-type">ambient-light</a></code>"
                </p>
            <dt data-md><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-value"
                    id="ref-for-map-value">値</a>
            <dd data-md>
                <p><a data-link-type="dfn" href="https://w3c.github.io/sensors/#virtual-sensor-metadata"
                        id="ref-for-virtual-sensor-metadata">仮想センサーメタデータ</a>であり、その<a data-link-type="dfn"
                        href="https://w3c.github.io/sensors/#virtual-sensor-metadata-reading-parsing-algorithm"
                        id="ref-for-virtual-sensor-metadata-reading-parsing-algorithm">reading parsing algorithm</a>は
                    <a data-link-type="dfn" href="#illuminance-reading-parsing-algorithm"
                        id="ref-for-illuminance-reading-parsing-algorithm">illuminance 読み取り値解析アルゴリズム</a>です。
                </p>
        </dl>
        <h2 class="heading settled" data-level="8" id="usecases-requirements"><span class="secno">8. </span><span
                class="content">ユースケースと要件</span><a class="self-link" href="#usecases-requirements"></a>
        </h2>
        <ul>
            <li data-md>
                <p>Webアプリケーションがスマートホームシステムの照明制御に入力を提供する。</p>
            <li data-md>
                <p>Webアプリケーションが作業空間の光レベルが十分かどうかを確認する。</p>
            <li data-md>
                <p>Webアプリケーションがマニュアル制御（絞り、シャッター速度、ISO）付きカメラの設定を計算する。</p>
            <li data-md>
                <p>Webアプリケーションが現在の照度レベルを確認し、カメラストリームが目的に十分な精度のデータを含むか（例：人の存在確認など）を判断する。</p>
        </ul>
        <p>一部のユースケースは精密な環境光測定値の取得から恩恵を受ける可能性がありますが、環境光レベルの変動をユーザー入力イベントに変換するユースケースは、より高い<a data-link-type="dfn"
                href="https://w3c.github.io/sensors/#sampling-frequency"
                id="ref-for-sampling-frequency">サンプリング周波数</a>が有用です。</p>
        <h2 class="heading settled" data-level="9" id="acknowledgements"><span class="secno">9. </span><span
                class="content">謝辞</span><a class="self-link" href="#acknowledgements"></a></h2>
        <p>Doug Turner（初期プロトタイプ）および
            Marcos Caceres（テストスイート）に感謝します。</p>
        <p>Paul Bakaus（LightLevelSensorのアイディア）に感謝します。</p>
        <p>Mikhail Pozdnyakov と Alexander Shalamov（ユースケースと要件）に感謝します。</p>
        <p>Lukasz Olejnik（プライバシーリスク評価）に感謝します。</p>
    </main>
    <div data-fill-with="conformance">
        <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">適合性</span><a
                class="self-link" href="#w3c-conformance"></a></h2>
        <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">文書上の慣例</span><a
                class="self-link" href="#w3c-conventions"></a></h3>
        <p>適合性要件は、記述的な主張とRFC 2119の用語の組み合わせで示されます。
            この文書の規範的部分におけるキーワード「MUST」「MUST NOT」「REQUIRED」「SHALL」「SHALL NOT」「SHOULD」「SHOULD
            NOT」「RECOMMENDED」「MAY」「OPTIONAL」は、
            RFC 2119に記載された意味で解釈されます。
            ただし、可読性のため、これらの語は本仕様書ではすべて大文字で記載されていません。</p>
        <p>この仕様書のすべてのテキストは規範的ですが、明示的に非規範であると記載されたセクション、例、および注記は除きます。<a data-link-type="biblio" href="#biblio-rfc2119"
                title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a>
        </p>
        <p>この仕様書の例は「例えば」という語で始まるか、規範的テキストから <code>class="example"</code>
            を用いて区別されています。例えば：</p>
        <div class="example" id="w3c-example">
            <a class="self-link" href="#w3c-example"></a>
            <p>これは情報例の一例です。</p>
        </div>
        <p>情報的な注記は「注:」で始まり、規範的テキストから <code>class="note"</code>
            を用いて区別されています。例えば：</p>
        <p class="note" role="note">注: これは情報的な注記です。</p>
        <section>
            <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span
                    class="content">適合するアルゴリズム</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
            <p>アルゴリズムの一部として命令形で記載された要件（例：「先頭の空白文字をすべて削除する」「falseを返してこれらの手順を中止する」）は、そのアルゴリズムの導入部に用いられるキーワード（"must"、"should"、"may"など）の意味で解釈されます。
            </p>
            <p>アルゴリズムや特定の手順として記載された適合性要件は、最終結果が同等である限り、どのような方法で実装してもかまいません。
                特に、この仕様で定義されるアルゴリズムは理解しやすいことを目的としており、パフォーマンスを意図したものではありません。
                実装者は最適化することが推奨されます。</p>
        </section>
    </div>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本仕様で定義される用語</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#ambient-light-reading-quantization-algorithm">ambient light 読み取り量子化アルゴリズム</a><span>、§ 6.2</span>
        <li><a href="#ambient-light-sensor">Ambient Light Sensor</a><span>、§ 4</span>
        <li><a href="#permissiondef-ambient-light-sensor">ambient-light-sensor</a><span>、§ 4</span>
        <li><a href="#ambientlightsensor">AmbientLightSensor</a><span>、§ 5.1</span>
        <li><a href="#dom-ambientlightsensor-ambientlightsensor">AmbientLightSensor()</a><span>、§ 5.1</span>
        <li><a
                href="#dom-ambientlightsensor-ambientlightsensor">AmbientLightSensor(sensorOptions)</a><span>、§ 5.1</span>
        <li><a href="#ambient-light-threshold-check-algorithm">ambient light しきい値チェックアルゴリズム</a><span>、§ 6.1</span>
        <li><a href="#ambient-light-virtual-sensor-type">ambient-light 仮想センサータイプ</a><span>、§ 4</span>
        <li><a href="#construct-an-ambient-light-sensor-object">ambient light sensor オブジェクトの構築</a><span>、§ 6</span>
        <li><a href="#dom-ambientlightsensor-ambientlightsensor">constructor()</a><span>、§ 5.1</span>
        <li><a href="#dom-ambientlightsensor-ambientlightsensor">constructor(sensorOptions)</a><span>、§ 5.1</span>
        <li><a href="#current-light-level">現在の照度レベル</a><span>、§ 4</span>
        <li>
            照度
            <ul>
                <li><a href="#dom-ambientlightsensor-illuminance">AmbientLightSensorの属性</a><span>、§ 5.1</span>
                <li><a href="#illuminance">定義</a><span>、§ 4</span>
            </ul>
        <li><a href="#illuminance-reading-parsing-algorithm">illuminance 読み取り値解析アルゴリズム</a><span>、§ 7</span>
        <li><a href="#illuminance-rounding-multiple">illuminance rounding multiple</a><span>、§ 4</span>
        <li><a href="#illuminance-threshold-value">illuminance threshold value</a><span>、§ 4</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">他で参照定義される用語</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[ECMASCRIPT]</a>では以下の用語を定義しています:
            <ul>
                <li><span class="dfn-paneled" id="a6e67972">Object</span>
                <li><span class="dfn-paneled" id="b01bbc68">abs</span>
            </ul>
        <li>
            <a data-link-type="biblio">[GENERIC-SENSOR]</a>では以下の用語を定義しています:
            <ul>
                <li><span class="dfn-paneled" id="1b956603">Sensor</span>
                <li><span class="dfn-paneled" id="207de9db">SensorOptions</span>
                <li><span class="dfn-paneled" id="5822d2f3">check sensor policy-controlled features</span>
                <li><span class="dfn-paneled" id="2797dd43">default sensor</span>
                <li><span class="dfn-paneled" id="a09cf46b">Generic Sensor permission revocation algorithm</span>
                <li><span class="dfn-paneled" id="fd4ad34f">get value from latest reading</span>
                <li><span class="dfn-paneled" id="0026f53f">initialize a sensor object</span>
                <li><span class="dfn-paneled" id="c79c290a">limit maximum sampling frequency</span>
                <li><span class="dfn-paneled" id="a296510f">mitigation strategies</span>
                <li><span class="dfn-paneled" id="c1bbb186">parse single-value number reading</span>
                <li><span class="dfn-paneled" id="5d47b5a4">per-type virtual sensor metadata</span>
                <li><span class="dfn-paneled" id="611c5008">reading parsing algorithm</span>
                <li><span class="dfn-paneled" id="1f45ff31">reading quantization algorithm</span>
                <li><span class="dfn-paneled" id="214e5c65">reduce accuracy</span>
                <li><span class="dfn-paneled" id="6f3f0749">sampling frequency</span>
                <li><span class="dfn-paneled" id="80bf03eb">sensor permission names</span>
                <li><span class="dfn-paneled" id="5afb8cab">sensor reading</span>
                <li><span class="dfn-paneled" id="f96b75e9">sensor type</span>
                <li><span class="dfn-paneled" id="6048fac5">threshold check algorithm</span>
                <li><span class="dfn-paneled" id="d8b6acc6">update latest reading</span>
                <li><span class="dfn-paneled" id="bb15fee5">virtual sensor metadata</span>
                <li><span class="dfn-paneled" id="4fa114dd">virtual sensor type</span>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a>では以下の用語を定義しています:
            <ul>
                <li><span class="dfn-paneled" id="36858240">boolean</span>
                <li><span class="dfn-paneled" id="8958b003">entry</span>
                <li><span class="dfn-paneled" id="d14a6f26">key</span>
                <li><span class="dfn-paneled" id="3fca5a9e">map</span>
                <li><span class="dfn-paneled" id="802b0fdd">value</span>
            </ul>
        <li>
            <a data-link-type="biblio">[PERMISSIONS]</a>では以下の用語を定義しています:
            <ul>
                <li><span class="dfn-paneled" id="e740d7e5">name</span>
                <li><span class="dfn-paneled" id="409a61ca">permission revocation algorithm</span>
                <li><span class="dfn-paneled" id="6c2d7879">powerful feature</span>
            </ul>
        <li>
            <a data-link-type="biblio">[PERMISSIONS-POLICY-1]</a>では以下の用語を定義しています:
            <ul>
                <li><span class="dfn-paneled" id="1570624a">default allowlist</span>
                <li><span class="dfn-paneled" id="cc890cc1">policy-controlled feature</span>
            </ul>
        <li>
            <a data-link-type="biblio">[WEBIDL]</a>では以下の用語を定義しています:
            <ul>
                <li><span class="dfn-paneled" id="dca2de17">DOMException</span>
                <li><span class="dfn-paneled" id="889e932f">Exposed</span>
                <li><span class="dfn-paneled" id="b75bb3bd">SecureContext</span>
                <li><span class="dfn-paneled" id="c3e881ef">SecurityError</span>
                <li><span class="dfn-paneled" id="8c800cdf">double</span>
                <li><span class="dfn-paneled" id="4013a022">this</span>
                <li><span class="dfn-paneled" id="b4cfa5ce">throw</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">規定参考文献</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-ecmascript">[ECMASCRIPT]
        <dd><a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript 言語仕様</cite></a>。URL: <a
                href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
        <dt id="biblio-generic-sensor">[GENERIC-SENSOR]
        <dd>Rick Waldron。<a href="https://w3c.github.io/sensors/"><cite>Generic Sensor API</cite></a>。URL: <a
                href="https://w3c.github.io/sensors/">https://w3c.github.io/sensors/</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola。<a href="https://infra.spec.whatwg.org/"><cite>Infra
                    Standard</cite></a>。現行標準。URL: <a
                href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-permissions">[PERMISSIONS]
        <dd>Marcos Caceres; Mike Taylor。<a href="https://w3c.github.io/permissions/"><cite>Permissions</cite></a>。URL:
            <a href="https://w3c.github.io/permissions/">https://w3c.github.io/permissions/</a>
        <dt id="biblio-permissions-policy-1">[PERMISSIONS-POLICY-1]
        <dd>Ian Clelland。<a href="https://w3c.github.io/webappsec-permissions-policy/"><cite>Permissions
                    Policy</cite></a>。URL: <a
                href="https://w3c.github.io/webappsec-permissions-policy/">https://w3c.github.io/webappsec-permissions-policy/</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner。<a
                href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>RFCsで要求レベルを示すためのキーワード</cite></a>。1997年3月。現行最良慣行。URL:
            <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-webidl">[WEBIDL]
        <dd>Edgar Chen; Timothy Gu。<a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>。現行標準。URL:
            <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">参考情報文献</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-alsprivacyanalysis">[ALSPRIVACYANALYSIS]
        <dd>Lukasz Olejnik。<a href="https://blog.lukaszolejnik.com/privacy-of-ambient-light-sensors/"><cite>Ambient
                    Light Sensorのプライバシー分析</cite></a>。2016年8月31日。URL: <a
                href="https://blog.lukaszolejnik.com/privacy-of-ambient-light-sensors/">https://blog.lukaszolejnik.com/privacy-of-ambient-light-sensors/</a>
        <dt id="biblio-cssom-view-1">[CSSOM-VIEW-1]
        <dd>Simon Pieters。<a href="https://drafts.csswg.org/cssom-view/"><cite>CSSOM View Module</cite></a>。URL: <a
                href="https://drafts.csswg.org/cssom-view/">https://drafts.csswg.org/cssom-view/</a>
        <dt id="biblio-imagingprivacy">[IMAGINGPRIVACY]
        <dd>Yang Liu; 他。<a href="https://www.science.org/doi/10.1126/sciadv.adj3608"><cite>Ambient Light
                    Sensorによる画像プライバシー脅威</cite></a>。2024年1月10日。URL: <a
                href="https://www.science.org/doi/10.1126/sciadv.adj3608">https://www.science.org/doi/10.1126/sciadv.adj3608</a>
        <dt id="biblio-mediaqueries-5">[MEDIAQUERIES-5]
        <dd>Dean Jackson; 他。<a href="https://drafts.csswg.org/mediaqueries-5/"><cite>Media Queries Level
                    5</cite></a>。URL: <a
                href="https://drafts.csswg.org/mediaqueries-5/">https://drafts.csswg.org/mediaqueries-5/</a>
        <dt id="biblio-pinskimmingviasensor">[PINSKIMMINGVIASENSOR]
        <dd>Raphael Spreitzer。<a href="https://arxiv.org/abs/1405.3760"><cite>PIN Skimming: モバイルデバイスのAmbient-Light
                    Sensorの悪用</cite></a>。2014年5月15日。URL: <a
                href="https://arxiv.org/abs/1405.3760">https://arxiv.org/abs/1405.3760</a>
        <dt id="biblio-si">[SI]
        <dd><a href="http://www.bipm.org/en/publications/si-brochure/"><cite>SIパンフレット:
                    国際単位系（SI）第8版</cite></a>。2014年。第8版。URL: <a
                href="http://www.bipm.org/en/publications/si-brochure/">http://www.bipm.org/en/publications/si-brochure/</a>
        <dt id="biblio-stealingsensitivedata">[STEALINGSENSITIVEDATA]
        <dd>Lukasz Olejnik。<a
                href="https://blog.lukaszolejnik.com/stealing-sensitive-browser-data-with-the-w3c-ambient-light-sensor-api/"><cite>W3C
                    Ambient Light Sensor APIによる機密ブラウザデータの盗難</cite></a>。2017年4月19日。URL: <a
                href="https://blog.lukaszolejnik.com/stealing-sensitive-browser-data-with-the-w3c-ambient-light-sensor-api/">https://blog.lukaszolejnik.com/stealing-sensitive-browser-data-with-the-w3c-ambient-light-sensor-api/</a>
        <dt id="biblio-videorecognitionambientlight">[VIDEORECOGNITIONAMBIENTLIGHT]
        <dd>Raphael Spreitzer。<a href="https://doi.org/10.1109/PERCOM.2016.7456511"><cite>Ambient Light
                    Sensorを用いたビデオ認識</cite></a>。2016年4月21日。URL: <a
                href="https://doi.org/10.1109/PERCOM.2016.7456511">https://doi.org/10.1109/PERCOM.2016.7456511</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL索引</span><a class="self-link"
            href="#idl-index"></a></h2>
    <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#ambientlightsensor"><code><c- g>AmbientLightSensor</c-></code></a> : <a data-link-type="idl-name" href="https://w3c.github.io/sensors/#sensor"><c- n>Sensor</c-></a> {
  <a href="#dom-ambientlightsensor-ambientlightsensor"><code><c- g>constructor</c-></code></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="https://w3c.github.io/sensors/#dictdef-sensoroptions"><c- n>SensorOptions</c-></a> <a href="#dom-ambientlightsensor-ambientlightsensor-sensoroptions-sensoroptions"><code><c- g>sensorOptions</c-></code></a> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double"><c- b>double</c-></a>? <a data-readonly data-type="double?" href="#dom-ambientlightsensor-illuminance"><code><c- g>illuminance</c-></code></a>;
};

</pre>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "0026f53f": { "dfnID": "0026f53f", "dfnText": "initialize a sensor object", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-initialize-a-sensor-object" }], "title": "6.1. Construct an ambient light sensor object" }], "url": "https://w3c.github.io/sensors/#initialize-a-sensor-object" },
                "1570624a": { "dfnID": "1570624a", "dfnText": "default allowlist", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-policy-controlled-feature-default-allowlist" }], "title": "4. Model" }], "url": "https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist" },
                "1b956603": { "dfnID": "1b956603", "dfnText": "Sensor", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sensor" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-sensor\u2460" }], "title": "5.1. The AmbientLightSensor Interface" }], "url": "https://w3c.github.io/sensors/#sensor" },
                "1f45ff31": { "dfnID": "1f45ff31", "dfnText": "reading quantization algorithm", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-reading-quantization-algorithm" }], "title": "3.1. Reducing sensor readings accuracy" }, { "refs": [{ "id": "ref-for-reading-quantization-algorithm\u2460" }], "title": "6.3. Ambient light reading quantization algorithm" }], "url": "https://w3c.github.io/sensors/#reading-quantization-algorithm" },
                "207de9db": { "dfnID": "207de9db", "dfnText": "SensorOptions", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dictdef-sensoroptions" }], "title": "5.1. The AmbientLightSensor Interface" }, { "refs": [{ "id": "ref-for-dictdef-sensoroptions\u2460" }], "title": "6.1. Construct an ambient light sensor object" }], "url": "https://w3c.github.io/sensors/#dictdef-sensoroptions" },
                "214e5c65": { "dfnID": "214e5c65", "dfnText": "reduce accuracy", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-reduce-accuracy" }], "title": "3. Security and Privacy Considerations" }, { "refs": [{ "id": "ref-for-reduce-accuracy\u2460" }], "title": "3.1. Reducing sensor readings accuracy" }], "url": "https://w3c.github.io/sensors/#reduce-accuracy" },
                "2797dd43": { "dfnID": "2797dd43", "dfnText": "default sensor", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-default-sensor" }], "title": "4. Model" }], "url": "https://w3c.github.io/sensors/#default-sensor" },
                "36858240": { "dfnID": "36858240", "dfnText": "boolean", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-boolean" }], "title": "6.2. Ambient light threshold check algorithm" }], "url": "https://infra.spec.whatwg.org/#boolean" },
                "3fca5a9e": { "dfnID": "3fca5a9e", "dfnText": "map", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ordered-map" }], "title": "7. Automation" }], "url": "https://infra.spec.whatwg.org/#ordered-map" },
                "4013a022": { "dfnID": "4013a022", "dfnText": "this", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-this" }], "title": "5.1.1. The illuminance attribute" }], "url": "https://webidl.spec.whatwg.org/#this" },
                "409a61ca": { "dfnID": "409a61ca", "dfnText": "permission revocation algorithm", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dfn-permission-revocation-algorithm" }], "title": "4. Model" }], "url": "https://w3c.github.io/permissions/#dfn-permission-revocation-algorithm" },
                "4fa114dd": { "dfnID": "4fa114dd", "dfnText": "virtual sensor type", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-virtual-sensor-type" }], "title": "4. Model" }], "url": "https://w3c.github.io/sensors/#virtual-sensor-type" },
                "5822d2f3": { "dfnID": "5822d2f3", "dfnText": "check sensor policy-controlled features", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-check-sensor-policy-controlled-features" }], "title": "6.1. Construct an ambient light sensor object" }], "url": "https://w3c.github.io/sensors/#check-sensor-policy-controlled-features" },
                "5afb8cab": { "dfnID": "5afb8cab", "dfnText": "sensor reading", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sensor-reading" }, { "id": "ref-for-sensor-reading\u2460" }, { "id": "ref-for-sensor-reading\u2461" }, { "id": "ref-for-sensor-reading\u2462" }], "title": "2. Examples" }, { "refs": [{ "id": "ref-for-sensor-reading\u2463" }, { "id": "ref-for-sensor-reading\u2464" }], "title": "6.2. Ambient light threshold check algorithm" }, { "refs": [{ "id": "ref-for-sensor-reading\u2465" }, { "id": "ref-for-sensor-reading\u2466" }], "title": "6.3. Ambient light reading quantization algorithm" }], "url": "https://w3c.github.io/sensors/#sensor-reading" },
                "5d47b5a4": { "dfnID": "5d47b5a4", "dfnText": "per-type virtual sensor metadata", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-per-type-virtual-sensor-metadata" }], "title": "7. Automation" }], "url": "https://w3c.github.io/sensors/#per-type-virtual-sensor-metadata" },
                "6048fac5": { "dfnID": "6048fac5", "dfnText": "threshold check algorithm", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-threshold-check-algorithm" }, { "id": "ref-for-threshold-check-algorithm\u2460" }], "title": "3.1. Reducing sensor readings accuracy" }, { "refs": [{ "id": "ref-for-threshold-check-algorithm\u2461" }], "title": "6.2. Ambient light threshold check algorithm" }], "url": "https://w3c.github.io/sensors/#threshold-check-algorithm" },
                "611c5008": { "dfnID": "611c5008", "dfnText": "reading parsing algorithm", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-virtual-sensor-metadata-reading-parsing-algorithm" }], "title": "7. Automation" }], "url": "https://w3c.github.io/sensors/#virtual-sensor-metadata-reading-parsing-algorithm" },
                "6c2d7879": { "dfnID": "6c2d7879", "dfnText": "powerful feature", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dfn-powerful-feature" }], "title": "4. Model" }], "url": "https://w3c.github.io/permissions/#dfn-powerful-feature" },
                "6f3f0749": { "dfnID": "6f3f0749", "dfnText": "sampling frequency", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sampling-frequency" }], "title": "8. Use Cases and Requirements" }], "url": "https://w3c.github.io/sensors/#sampling-frequency" },
                "802b0fdd": { "dfnID": "802b0fdd", "dfnText": "value", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-value" }], "title": "7. Automation" }], "url": "https://infra.spec.whatwg.org/#map-value" },
                "80bf03eb": { "dfnID": "80bf03eb", "dfnText": "sensor permission names", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sensor-permission-names" }], "title": "4. Model" }], "url": "https://w3c.github.io/sensors/#sensor-permission-names" },
                "889e932f": { "dfnID": "889e932f", "dfnText": "Exposed", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-Exposed" }], "title": "5.1. The AmbientLightSensor Interface" }], "url": "https://webidl.spec.whatwg.org/#Exposed" },
                "8958b003": { "dfnID": "8958b003", "dfnText": "entry", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-entry" }], "title": "7. Automation" }], "url": "https://infra.spec.whatwg.org/#map-entry" },
                "8c800cdf": { "dfnID": "8c800cdf", "dfnText": "double", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-idl-double" }], "title": "5.1. The AmbientLightSensor Interface" }], "url": "https://webidl.spec.whatwg.org/#idl-double" },
                "a09cf46b": { "dfnID": "a09cf46b", "dfnText": "Generic Sensor permission revocation algorithm", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-generic-sensor-permission-revocation-algorithm" }], "title": "4. Model" }], "url": "https://w3c.github.io/sensors/#generic-sensor-permission-revocation-algorithm" },
                "a296510f": { "dfnID": "a296510f", "dfnText": "mitigation strategies", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mitigation-strategies" }], "title": "3. Security and Privacy Considerations" }], "url": "https://w3c.github.io/sensors/#mitigation-strategies" },
                "a6e67972": { "dfnID": "a6e67972", "dfnText": "Object", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sec-object-objects" }], "title": "7. Automation" }], "url": "https://tc39.es/ecma262/multipage/fundamental-objects.html#sec-object-objects" },
                "ambient-light-reading-quantization-algorithm": { "dfnID": "ambient-light-reading-quantization-algorithm", "dfnText": "6.3. Ambient light reading quantization algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-ambient-light-reading-quantization-algorithm" }], "title": "3.1. Reducing sensor readings accuracy" }, { "refs": [{ "id": "ref-for-ambient-light-reading-quantization-algorithm\u2460" }, { "id": "ref-for-ambient-light-reading-quantization-algorithm\u2461" }, { "id": "ref-for-ambient-light-reading-quantization-algorithm\u2462" }], "title": "6.2. Ambient light threshold check algorithm" }, { "refs": [{ "id": "ref-for-ambient-light-reading-quantization-algorithm" }], "title": "6.3. Ambient light reading quantization algorithm" }], "url": "#ambient-light-reading-quantization-algorithm" },
                "ambient-light-sensor": { "dfnID": "ambient-light-sensor", "dfnText": "Ambient Light Sensor", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-ambient-light-sensor" }, { "id": "ref-for-ambient-light-sensor\u2460" }, { "id": "ref-for-ambient-light-sensor\u2461" }, { "id": "ref-for-ambient-light-sensor\u2462" }, { "id": "ref-for-ambient-light-sensor\u2463" }, { "id": "ref-for-ambient-light-sensor\u2464" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-ambient-light-sensor\u2465" }], "title": "6.2. Ambient light threshold check algorithm" }, { "refs": [{ "id": "ref-for-ambient-light-sensor\u2466" }], "title": "6.3. Ambient light reading quantization algorithm" }, { "refs": [{ "id": "ref-for-ambient-light-sensor\u2467" }], "title": "7. Automation" }], "url": "#ambient-light-sensor" },
                "ambient-light-threshold-check-algorithm": { "dfnID": "ambient-light-threshold-check-algorithm", "dfnText": "6.2. Ambient light threshold check algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-ambient-light-threshold-check-algorithm" }], "title": "3.1. Reducing sensor readings accuracy" }, { "refs": [{ "id": "ref-for-ambient-light-threshold-check-algorithm\u2460" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-ambient-light-threshold-check-algorithm" }], "title": "6.2. Ambient light threshold check algorithm" }], "url": "#ambient-light-threshold-check-algorithm" },
                "ambient-light-virtual-sensor-type": { "dfnID": "ambient-light-virtual-sensor-type", "dfnText": "ambient-light", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-ambient-light-virtual-sensor-type" }], "title": "7. Automation" }], "url": "#ambient-light-virtual-sensor-type" },
                "ambientlightsensor": { "dfnID": "ambientlightsensor", "dfnText": "AmbientLightSensor", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-ambientlightsensor" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-ambientlightsensor\u2460" }], "title": "5.1. The AmbientLightSensor Interface" }, { "refs": [{ "id": "ref-for-ambientlightsensor\u2461" }, { "id": "ref-for-ambientlightsensor\u2462" }, { "id": "ref-for-ambientlightsensor\u2463" }], "title": "6.1. Construct an ambient light sensor object" }], "url": "#ambientlightsensor" },
                "b01bbc68": { "dfnID": "b01bbc68", "dfnText": "abs", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-eqn-abs" }], "title": "6.2. Ambient light threshold check algorithm" }], "url": "https://tc39.es/ecma262/#eqn-abs" },
                "b4cfa5ce": { "dfnID": "b4cfa5ce", "dfnText": "throw", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dfn-throw" }], "title": "6.1. Construct an ambient light sensor object" }], "url": "https://webidl.spec.whatwg.org/#dfn-throw" },
                "b75bb3bd": { "dfnID": "b75bb3bd", "dfnText": "SecureContext", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-SecureContext" }], "title": "5.1. The AmbientLightSensor Interface" }], "url": "https://webidl.spec.whatwg.org/#SecureContext" },
                "bb15fee5": { "dfnID": "bb15fee5", "dfnText": "virtual sensor metadata", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-virtual-sensor-metadata" }], "title": "7. Automation" }], "url": "https://w3c.github.io/sensors/#virtual-sensor-metadata" },
                "c1bbb186": { "dfnID": "c1bbb186", "dfnText": "parse single-value number reading", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-parse-single-value-number-reading" }], "title": "7. Automation" }], "url": "https://w3c.github.io/sensors/#parse-single-value-number-reading" },
                "c3e881ef": { "dfnID": "c3e881ef", "dfnText": "SecurityError", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-securityerror" }], "title": "6.1. Construct an ambient light sensor object" }], "url": "https://webidl.spec.whatwg.org/#securityerror" },
                "c79c290a": { "dfnID": "c79c290a", "dfnText": "limit maximum sampling frequency", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-limit-max-frequency" }], "title": "3. Security and Privacy Considerations" }], "url": "https://w3c.github.io/sensors/#limit-max-frequency" },
                "cc890cc1": { "dfnID": "cc890cc1", "dfnText": "policy-controlled feature", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-policy-controlled-feature" }], "title": "4. Model" }], "url": "https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" },
                "construct-an-ambient-light-sensor-object": { "dfnID": "construct-an-ambient-light-sensor-object", "dfnText": "6.1. Construct an ambient light sensor object", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-construct-an-ambient-light-sensor-object" }], "title": "5.1. The AmbientLightSensor Interface" }, { "refs": [{ "id": "ref-for-construct-an-ambient-light-sensor-object" }], "title": "6.1. Construct an ambient light sensor object" }], "url": "#construct-an-ambient-light-sensor-object" },
                "current-light-level": { "dfnID": "current-light-level", "dfnText": "current light level", "external": false, "refSections": [], "url": "#current-light-level" },
                "d14a6f26": { "dfnID": "d14a6f26", "dfnText": "key", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-key" }], "title": "7. Automation" }], "url": "https://infra.spec.whatwg.org/#map-key" },
                "d8b6acc6": { "dfnID": "d8b6acc6", "dfnText": "update latest reading", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-update-latest-reading" }], "title": "6.2. Ambient light threshold check algorithm" }], "url": "https://w3c.github.io/sensors/#update-latest-reading" },
                "dca2de17": { "dfnID": "dca2de17", "dfnText": "DOMException", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-idl-DOMException" }], "title": "6.1. Construct an ambient light sensor object" }], "url": "https://webidl.spec.whatwg.org/#idl-DOMException" },
                "dom-ambientlightsensor-ambientlightsensor": { "dfnID": "dom-ambientlightsensor-ambientlightsensor", "dfnText": "constructor", "external": false, "refSections": [], "url": "#dom-ambientlightsensor-ambientlightsensor" },
                "dom-ambientlightsensor-ambientlightsensor-sensoroptions-sensoroptions": { "dfnID": "dom-ambientlightsensor-ambientlightsensor-sensoroptions-sensoroptions", "dfnText": "sensorOptions", "external": false, "refSections": [], "url": "#dom-ambientlightsensor-ambientlightsensor-sensoroptions-sensoroptions" },
                "dom-ambientlightsensor-illuminance": { "dfnID": "dom-ambientlightsensor-illuminance", "dfnText": "illuminance", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dom-ambientlightsensor-illuminance" }], "title": "2. Examples" }, { "refs": [{ "id": "ref-for-dom-ambientlightsensor-illuminance\u2460" }], "title": "5.1.1. The illuminance attribute" }], "url": "#dom-ambientlightsensor-illuminance" },
                "e740d7e5": { "dfnID": "e740d7e5", "dfnText": "name", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dfn-name" }], "title": "4. Model" }], "url": "https://w3c.github.io/permissions/#dfn-name" },
                "f96b75e9": { "dfnID": "f96b75e9", "dfnText": "sensor type", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sensor-type" }], "title": "4. Model" }, { "refs": [{ "id": "ref-for-sensor-type\u2460" }], "title": "6.2. Ambient light threshold check algorithm" }, { "refs": [{ "id": "ref-for-sensor-type\u2461" }], "title": "6.3. Ambient light reading quantization algorithm" }], "url": "https://w3c.github.io/sensors/#sensor-type" },
                "fd4ad34f": { "dfnID": "fd4ad34f", "dfnText": "get value from latest reading", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-get-value-from-latest-reading" }], "title": "5.1.1. The illuminance attribute" }], "url": "https://w3c.github.io/sensors/#get-value-from-latest-reading" },
                "illuminance": { "dfnID": "illuminance", "dfnText": "illuminance", "external": false, "refSections": [], "url": "#illuminance" },
                "illuminance-reading-parsing-algorithm": { "dfnID": "illuminance-reading-parsing-algorithm", "dfnText": "illuminance reading parsing algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-illuminance-reading-parsing-algorithm" }], "title": "7. Automation" }], "url": "#illuminance-reading-parsing-algorithm" },
                "illuminance-rounding-multiple": { "dfnID": "illuminance-rounding-multiple", "dfnText": "illuminance rounding\nmultiple", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-illuminance-rounding-multiple" }, { "id": "ref-for-illuminance-rounding-multiple\u2460" }, { "id": "ref-for-illuminance-rounding-multiple\u2461" }, { "id": "ref-for-illuminance-rounding-multiple\u2462" }, { "id": "ref-for-illuminance-rounding-multiple\u2463" }, { "id": "ref-for-illuminance-rounding-multiple\u2464" }], "title": "3.1. Reducing sensor readings accuracy" }, { "refs": [{ "id": "ref-for-illuminance-rounding-multiple\u2465" }], "title": "6.2. Ambient light threshold check algorithm" }, { "refs": [{ "id": "ref-for-illuminance-rounding-multiple\u2466" }], "title": "6.3. Ambient light reading quantization algorithm" }], "url": "#illuminance-rounding-multiple" },
                "illuminance-threshold-value": { "dfnID": "illuminance-threshold-value", "dfnText": "illuminance threshold value", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-illuminance-threshold-value" }, { "id": "ref-for-illuminance-threshold-value\u2460" }, { "id": "ref-for-illuminance-threshold-value\u2461" }], "title": "3.1. Reducing sensor readings accuracy" }, { "refs": [{ "id": "ref-for-illuminance-threshold-value\u2462" }, { "id": "ref-for-illuminance-threshold-value\u2463" }], "title": "6.2. Ambient light threshold check algorithm" }], "url": "#illuminance-threshold-value" },
                "permissiondef-ambient-light-sensor": { "dfnID": "permissiondef-ambient-light-sensor", "dfnText": "ambient-light-sensor", "external": false, "refSections": [], "url": "#permissiondef-ambient-light-sensor" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#ambient-light-reading-quantization-algorithm": { "displayText": "ambient light reading quantization algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "ambient-light", "spec": "ambient-light", "status": "local", "text": "ambient light reading quantization algorithm", "type": "dfn", "url": "#ambient-light-reading-quantization-algorithm" },
                "#ambient-light-sensor": { "displayText": "ambient light sensor", "export": true, "for_": [], "level": "", "normative": true, "shortname": "ambient-light", "spec": "ambient-light", "status": "local", "text": "ambient light sensor", "type": "dfn", "url": "#ambient-light-sensor" },
                "#ambient-light-threshold-check-algorithm": { "displayText": "ambient light threshold check algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "ambient-light", "spec": "ambient-light", "status": "local", "text": "ambient light threshold check algorithm", "type": "dfn", "url": "#ambient-light-threshold-check-algorithm" },
                "#ambient-light-virtual-sensor-type": { "displayText": "ambient-light virtual sensor type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "ambient-light", "spec": "ambient-light", "status": "local", "text": "ambient-light virtual sensor type", "type": "dfn", "url": "#ambient-light-virtual-sensor-type" },
                "#ambientlightsensor": { "displayText": "AmbientLightSensor", "export": true, "for_": [], "level": "", "normative": true, "shortname": "ambient-light", "spec": "ambient-light", "status": "local", "text": "AmbientLightSensor", "type": "interface", "url": "#ambientlightsensor" },
                "#construct-an-ambient-light-sensor-object": { "displayText": "construct an ambient light sensor object", "export": true, "for_": [], "level": "", "normative": true, "shortname": "ambient-light", "spec": "ambient-light", "status": "local", "text": "construct an ambient light sensor object", "type": "dfn", "url": "#construct-an-ambient-light-sensor-object" },
                "#dom-ambientlightsensor-illuminance": { "displayText": "illuminance", "export": true, "for_": ["AmbientLightSensor"], "level": "", "normative": true, "shortname": "ambient-light", "spec": "ambient-light", "status": "local", "text": "illuminance", "type": "attribute", "url": "#dom-ambientlightsensor-illuminance" },
                "#illuminance-reading-parsing-algorithm": { "displayText": "illuminance reading parsing algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "ambient-light", "spec": "ambient-light", "status": "local", "text": "illuminance reading parsing algorithm", "type": "dfn", "url": "#illuminance-reading-parsing-algorithm" },
                "#illuminance-rounding-multiple": { "displayText": "illuminance rounding multiple", "export": true, "for_": [], "level": "", "normative": true, "shortname": "ambient-light", "spec": "ambient-light", "status": "local", "text": "illuminance rounding multiple", "type": "dfn", "url": "#illuminance-rounding-multiple" },
                "#illuminance-threshold-value": { "displayText": "illuminance threshold value", "export": true, "for_": [], "level": "", "normative": true, "shortname": "ambient-light", "spec": "ambient-light", "status": "local", "text": "illuminance threshold value", "type": "dfn", "url": "#illuminance-threshold-value" },
                "https://infra.spec.whatwg.org/#boolean": { "displayText": "boolean", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "boolean", "type": "dfn", "url": "https://infra.spec.whatwg.org/#boolean" },
                "https://infra.spec.whatwg.org/#map-entry": { "displayText": "entry", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "entry", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-entry" },
                "https://infra.spec.whatwg.org/#map-key": { "displayText": "key", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "key", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-key" },
                "https://infra.spec.whatwg.org/#map-value": { "displayText": "value", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "value", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-value" },
                "https://infra.spec.whatwg.org/#ordered-map": { "displayText": "map", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "map", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ordered-map" },
                "https://tc39.es/ecma262/#eqn-abs": { "displayText": "abs", "export": true, "for_": [], "level": "262", "normative": true, "shortname": "ecma", "spec": "ecma-262", "status": "anchor-block", "text": "abs", "type": "abstract-op", "url": "https://tc39.es/ecma262/#eqn-abs" },
                "https://tc39.es/ecma262/multipage/fundamental-objects.html#sec-object-objects": { "displayText": "Object", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "ecmascript", "spec": "ecmascript", "status": "current", "text": "Object", "type": "interface", "url": "https://tc39.es/ecma262/multipage/fundamental-objects.html#sec-object-objects" },
                "https://w3c.github.io/permissions/#dfn-name": { "displayText": "name", "export": true, "for_": ["powerful feature"], "level": "1", "normative": true, "shortname": "permissions", "spec": "permissions", "status": "current", "text": "name", "type": "dfn", "url": "https://w3c.github.io/permissions/#dfn-name" },
                "https://w3c.github.io/permissions/#dfn-permission-revocation-algorithm": { "displayText": "permission revocation algorithm", "export": true, "for_": ["powerful feature"], "level": "1", "normative": true, "shortname": "permissions", "spec": "permissions", "status": "current", "text": "permission revocation algorithm", "type": "dfn", "url": "https://w3c.github.io/permissions/#dfn-permission-revocation-algorithm" },
                "https://w3c.github.io/permissions/#dfn-powerful-feature": { "displayText": "powerful feature", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "permissions", "spec": "permissions", "status": "current", "text": "powerful feature", "type": "dfn", "url": "https://w3c.github.io/permissions/#dfn-powerful-feature" },
                "https://w3c.github.io/sensors/#check-sensor-policy-controlled-features": { "displayText": "check sensor policy-controlled features", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "check sensor policy-controlled features", "type": "dfn", "url": "https://w3c.github.io/sensors/#check-sensor-policy-controlled-features" },
                "https://w3c.github.io/sensors/#default-sensor": { "displayText": "default sensor", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "default sensor", "type": "dfn", "url": "https://w3c.github.io/sensors/#default-sensor" },
                "https://w3c.github.io/sensors/#dictdef-sensoroptions": { "displayText": "SensorOptions", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "SensorOptions", "type": "dictionary", "url": "https://w3c.github.io/sensors/#dictdef-sensoroptions" },
                "https://w3c.github.io/sensors/#generic-sensor-permission-revocation-algorithm": { "displayText": "Generic Sensor permission revocation algorithm", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "generic sensor permission revocation algorithm", "type": "dfn", "url": "https://w3c.github.io/sensors/#generic-sensor-permission-revocation-algorithm" },
                "https://w3c.github.io/sensors/#get-value-from-latest-reading": { "displayText": "get value from latest reading", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "get value from latest reading", "type": "dfn", "url": "https://w3c.github.io/sensors/#get-value-from-latest-reading" },
                "https://w3c.github.io/sensors/#initialize-a-sensor-object": { "displayText": "initialize a sensor object", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "initialize a sensor object", "type": "dfn", "url": "https://w3c.github.io/sensors/#initialize-a-sensor-object" },
                "https://w3c.github.io/sensors/#limit-max-frequency": { "displayText": "limit maximum sampling frequency", "export": true, "for_": [], "level": "", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "anchor-block", "text": "limit maximum sampling frequency", "type": "dfn", "url": "https://w3c.github.io/sensors/#limit-max-frequency" },
                "https://w3c.github.io/sensors/#mitigation-strategies": { "displayText": "mitigation strategies", "export": true, "for_": [], "level": "", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "anchor-block", "text": "mitigation strategies", "type": "dfn", "url": "https://w3c.github.io/sensors/#mitigation-strategies" },
                "https://w3c.github.io/sensors/#parse-single-value-number-reading": { "displayText": "parse single-value number reading", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "parse single-value number reading", "type": "dfn", "url": "https://w3c.github.io/sensors/#parse-single-value-number-reading" },
                "https://w3c.github.io/sensors/#per-type-virtual-sensor-metadata": { "displayText": "per-type virtual sensor metadata", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "per-type virtual sensor metadata", "type": "dfn", "url": "https://w3c.github.io/sensors/#per-type-virtual-sensor-metadata" },
                "https://w3c.github.io/sensors/#reading-quantization-algorithm": { "displayText": "reading quantization algorithm", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "reading quantization algorithm", "type": "dfn", "url": "https://w3c.github.io/sensors/#reading-quantization-algorithm" },
                "https://w3c.github.io/sensors/#reduce-accuracy": { "displayText": "reduce accuracy", "export": true, "for_": [], "level": "", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "anchor-block", "text": "reduce accuracy", "type": "dfn", "url": "https://w3c.github.io/sensors/#reduce-accuracy" },
                "https://w3c.github.io/sensors/#sampling-frequency": { "displayText": "sampling frequency", "export": true, "for_": [], "level": "", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "anchor-block", "text": "sampling frequency", "type": "dfn", "url": "https://w3c.github.io/sensors/#sampling-frequency" },
                "https://w3c.github.io/sensors/#sensor": { "displayText": "Sensor", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "Sensor", "type": "interface", "url": "https://w3c.github.io/sensors/#sensor" },
                "https://w3c.github.io/sensors/#sensor-permission-names": { "displayText": "sensor permission names", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "sensor permission names", "type": "dfn", "url": "https://w3c.github.io/sensors/#sensor-permission-names" },
                "https://w3c.github.io/sensors/#sensor-reading": { "displayText": "sensor reading", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "sensor reading", "type": "dfn", "url": "https://w3c.github.io/sensors/#sensor-reading" },
                "https://w3c.github.io/sensors/#sensor-type": { "displayText": "sensor type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "anchor-block", "text": "sensor type", "type": "dfn", "url": "https://w3c.github.io/sensors/#sensor-type" },
                "https://w3c.github.io/sensors/#threshold-check-algorithm": { "displayText": "threshold check algorithm", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "threshold check algorithm", "type": "dfn", "url": "https://w3c.github.io/sensors/#threshold-check-algorithm" },
                "https://w3c.github.io/sensors/#update-latest-reading": { "displayText": "update latest reading", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "update latest reading", "type": "dfn", "url": "https://w3c.github.io/sensors/#update-latest-reading" },
                "https://w3c.github.io/sensors/#virtual-sensor-metadata": { "displayText": "virtual sensor metadata", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "virtual sensor metadata", "type": "dfn", "url": "https://w3c.github.io/sensors/#virtual-sensor-metadata" },
                "https://w3c.github.io/sensors/#virtual-sensor-metadata-reading-parsing-algorithm": { "displayText": "reading parsing algorithm", "export": true, "for_": ["virtual sensor metadata"], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "reading parsing algorithm", "type": "dfn", "url": "https://w3c.github.io/sensors/#virtual-sensor-metadata-reading-parsing-algorithm" },
                "https://w3c.github.io/sensors/#virtual-sensor-type": { "displayText": "virtual sensor type", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "generic-sensor", "spec": "generic-sensor", "status": "current", "text": "virtual sensor type", "type": "dfn", "url": "https://w3c.github.io/sensors/#virtual-sensor-type" },
                "https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature": { "displayText": "policy-controlled feature", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "permissions-policy", "spec": "permissions-policy-1", "status": "current", "text": "policy-controlled feature", "type": "dfn", "url": "https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" },
                "https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist": { "displayText": "default allowlist", "export": true, "for_": ["policy-controlled feature"], "level": "1", "normative": true, "shortname": "permissions-policy", "spec": "permissions-policy-1", "status": "current", "text": "default allowlist", "type": "dfn", "url": "https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist" },
                "https://webidl.spec.whatwg.org/#Exposed": { "displayText": "Exposed", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "Exposed", "type": "extended-attribute", "url": "https://webidl.spec.whatwg.org/#Exposed" },
                "https://webidl.spec.whatwg.org/#SecureContext": { "displayText": "SecureContext", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "SecureContext", "type": "extended-attribute", "url": "https://webidl.spec.whatwg.org/#SecureContext" },
                "https://webidl.spec.whatwg.org/#dfn-throw": { "displayText": "throw", "export": true, "for_": ["exception"], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "throw", "type": "dfn", "url": "https://webidl.spec.whatwg.org/#dfn-throw" },
                "https://webidl.spec.whatwg.org/#idl-DOMException": { "displayText": "DOMException", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "DOMException", "type": "interface", "url": "https://webidl.spec.whatwg.org/#idl-DOMException" },
                "https://webidl.spec.whatwg.org/#idl-double": { "displayText": "double", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "double", "type": "interface", "url": "https://webidl.spec.whatwg.org/#idl-double" },
                "https://webidl.spec.whatwg.org/#securityerror": { "displayText": "SecurityError", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "SecurityError", "type": "exception", "url": "https://webidl.spec.whatwg.org/#securityerror" },
                "https://webidl.spec.whatwg.org/#this": { "displayText": "this", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "this", "type": "dfn", "url": "https://webidl.spec.whatwg.org/#this" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
                    // Give the original term if it's being displayed in a different way.
                    // But allow casing differences, they're insignificant.
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.displayText)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const ref = refsData[url];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-var-click-highlighting */
        "use strict";
        {
            /*
            Color-choosing design:
            
            * Colors are ordered by goodness.
            * On clicking a var, give it the earliest color
                with the lowest usage in the algorithm.
            * On re-clicking, re-use the var's most recent color
                if that's not currently being used elsewhere.
            */

            const COLOR_COUNT = 7;

            document.addEventListener("click", e => {
                if (e.target.nodeName == "VAR") {
                    highlightSameAlgoVars(e.target);
                }
            });

            function highlightSameAlgoVars(v) {
                // Find the algorithm container.
                let algoContainer = findAlgoContainer(v);

                // Not highlighting document-global vars,
                // too likely to be unrelated.
                if (algoContainer == null) return;

                const varName = nameFromVar(v);
                if (!v.hasAttribute("data-var-color")) {
                    const newColor = chooseHighlightColor(algoContainer, v);
                    for (const el of algoContainer.querySelectorAll("var")) {
                        if (nameFromVar(el) == varName) {
                            el.setAttribute("data-var-color", newColor);
                            el.setAttribute("data-var-last-color", newColor);
                        }
                    }
                } else {
                    for (const el of algoContainer.querySelectorAll("var")) {
                        if (nameFromVar(el) == varName) {
                            el.removeAttribute("data-var-color");
                        }
                    }
                }
            }
            function findAlgoContainer(el) {
                while (el != document.body) {
                    if (el.hasAttribute("data-algorithm")) return el;
                    el = el.parentNode;
                }
                return null;
            }
            function nameFromVar(el) {
                return el.textContent.replace(/(\s|\xa0)+/g, " ").trim();
            }
            function colorCountsFromContainer(container) {
                const namesFromColor = Array.from({ length: COLOR_COUNT }, x => new Set());
                for (let v of container.querySelectorAll("var[data-var-color]")) {
                    let color = +v.getAttribute("data-var-color");
                    namesFromColor[color].add(nameFromVar(v));
                }

                return namesFromColor.map(x => x.size);
            }
            function leastUsedColor(colors) {
                // Find the earliest color with the lowest count.
                let minCount = Infinity;
                let minColor = null;
                for (var i = 0; i < colors.length; i++) {
                    if (colors[i] < minCount) {
                        minColor = i;
                        minCount = colors[i];
                    }
                }
                return minColor;
            }
            function chooseHighlightColor(container, v) {
                const colorCounts = colorCountsFromContainer(container);
                if (v.hasAttribute("data-var-last-color")) {
                    let color = +v.getAttribute("data-var-last-color");
                    if (colorCounts[color] == 0) return color;
                }
                return leastUsedColor(colorCounts);
            }
        }
    </script>
    <svg style="display:none" viewBox="0 0 46 64">
        <defs>
            <path
                d="M2 23Q17 -16 40 12M1 35Q17 -20 43 20M2 40Q18 -19 44 25M3 43Q19 -16 45 29M5 46Q20 -12 45 32M5 49Q11 40 15 27T27 16T45 37M5 49Q15 38 19 25T34 27T44 41M6 52Q17 40 21 28T32 29T43 44M6 52Q21 42 23 31T30 32T42 47M7 54Q23 47 24 36T28 34T41 50M8 56Q26 50 26 35Q28 48 40 53M10 58Q24 54 27 45Q30 52 38 55M27 50Q28 53 36 57M25 52Q28 56 31 57M22 55L26 57M10 58L37 57M13 60L32 60M16 62L28 63"
                fill="none" id="b732b3fe" stroke="currentcolor" stroke-dasharray="3,2,35,2,20,2" stroke-linecap="round"
                stroke-linejoin="round"></path>
        </defs>
    </svg>
    <script src="https://htmlspecs.com/dropdown.js"></script>
