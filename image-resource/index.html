<!DOCTYPE html>
<html lang="ja-JP" dir="ltr">

<head>
    <meta charset="utf-8">
    <!-- <meta name="generator" content="ReSpec 26.8.9"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
        .issue-label {
            text-transform: initial
        }

        .warning>p:first-child {
            margin-top: 0
        }

        .warning {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid
        }

        span.warning {
            padding: .1em .5em .15em
        }

        .issue.closed span.issue-number {
            text-decoration: line-through
        }

        .warning {
            border-color: #f11;
            border-width: .2em;
            border-style: solid;
            background: #fbe9e9
        }

        .warning-title:before {
            content: "⚠";
            font-size: 1.3em;
            float: left;
            padding-right: .3em;
            margin-top: -.3em
        }

        li.task-list-item {
            list-style: none
        }

        input.task-list-item-checkbox {
            margin: 0 .35em .25em -1.6em;
            vertical-align: middle
        }

        .issue a.respec-gh-label {
            padding: 5px;
            margin: 0 2px 0 2px;
            font-size: 10px;
            text-transform: none;
            text-decoration: none;
            font-weight: 700;
            border-radius: 4px;
            position: relative;
            bottom: 2px;
            border: none;
            display: inline-block
        }
    </style>
    <style>
        pre.idl {
            padding: 1em;
            position: relative
        }

        pre.idl>code {
            color: #000
        }

        @media print {
            pre.idl {
                white-space: pre-wrap
            }
        }

        .idlHeader {
            display: block;
            width: 150px;
            background: #8ccbf2;
            color: #fff;
            font-family: sans-serif;
            font-weight: 700;
            margin: -1em 0 1em -1em;
            height: 28px;
            line-height: 28px
        }

        .idlHeader a.self-link {
            margin-left: .3cm;
            text-decoration: none;
            border-bottom: none
        }

        .idlID {
            font-weight: 700;
            color: #005a9c
        }

        .idlType {
            color: #005a9c
        }

        .idlName {
            color: #ff4500
        }

        .idlName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none
        }

        a.idlEnumItem {
            color: #000;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        .idlSuperclass {
            font-style: italic;
            color: #005a9c
        }

        .idlDefaultValue,
        .idlParamName {
            font-style: italic
        }

        .extAttr {
            color: #666
        }

        .idlSectionComment {
            color: gray
        }

        .idlIncludes a {
            font-weight: 700
        }

        .respec-button-copy-paste:focus {
            text-decoration: none;
            border-color: #51a7e8;
            outline: 0;
            box-shadow: 0 0 5px rgba(81, 167, 232, .5)
        }

        .respec-button-copy-paste.selected:focus,
        .respec-button-copy-paste:focus:hover {
            border-color: #51a7e8
        }

        .respec-button-copy-paste.zeroclipboard-is-active,
        .respec-button-copy-paste.zeroclipboard-is-hover,
        .respec-button-copy-paste:active,
        .respec-button-copy-paste:hover {
            text-decoration: none;
            background-color: #ddd;
            background-image: linear-gradient(#eee, #ddd);
            border-color: #ccc
        }

        .respec-button-copy-paste.selected,
        .respec-button-copy-paste.zeroclipboard-is-active,
        .respec-button-copy-paste:active {
            background-color: #dcdcdc;
            background-image: none;
            border-color: #b5b5b5;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, .15)
        }

        .respec-button-copy-paste.selected:hover {
            background-color: #cfcfcf
        }

        .respec-button-copy-paste.disabled,
        .respec-button-copy-paste.disabled:hover,
        .respec-button-copy-paste:disabled,
        .respec-button-copy-paste:disabled:hover {
            color: rgba(102, 102, 102, .5);
            cursor: default;
            background-color: rgba(229, 229, 229, .5);
            background-image: none;
            border-color: rgba(197, 197, 197, .5);
            box-shadow: none
        }

        @media print {
            .respec-button-copy-paste {
                visibility: hidden
            }
        }
    </style>
    <style>
        dfn {
            cursor: pointer
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            min-width: 300px;
            max-width: 500px;
            padding: .5em .75em;
            margin-top: .6em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #fff;
            color: #000;
            box-shadow: 0 1em 3em -.4em rgba(0, 0, 0, .3), 0 0 1px 1px rgba(0, 0, 0, .05);
            border-radius: 2px
        }

        .dfn-panel:not(.docked)>.caret {
            position: absolute;
            top: -9px
        }

        .dfn-panel:not(.docked)>.caret::after,
        .dfn-panel:not(.docked)>.caret::before {
            content: "";
            position: absolute;
            border: 10px solid transparent;
            border-top: 0;
            border-bottom: 10px solid #fff;
            top: 0
        }

        .dfn-panel:not(.docked)>.caret::before {
            border-bottom: 9px solid #a2a9b1
        }

        .dfn-panel * {
            margin: 0
        }

        .dfn-panel b {
            display: block;
            color: #000;
            margin-top: .25em
        }

        .dfn-panel ul a[href] {
            color: #333
        }

        .dfn-panel>div {
            display: flex
        }

        .dfn-panel a.self-link {
            font-weight: 700;
            margin-right: auto
        }

        .dfn-panel .marker {
            padding: .1em;
            margin-left: .5em;
            border-radius: .2em;
            text-align: center;
            white-space: nowrap;
            font-size: 90%;
            color: #040b1c
        }

        .dfn-panel .marker.dfn-exported {
            background: #d1edfd;
            box-shadow: 0 0 0 .125em #1ca5f940
        }

        .dfn-panel .marker.idl-block {
            background: #8ccbf2;
            box-shadow: 0 0 0 .125em #0670b161
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important
        }

        .dfn-panel a[href]:hover {
            border-bottom-width: 1px
        }

        .dfn-panel ul {
            padding: 0
        }

        .dfn-panel li {
            margin-left: 1em
        }

        .dfn-panel.docked {
            position: fixed;
            left: .5em;
            top: unset;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - .75em * 2 - .5em - .2em * 2);
            max-height: 30vh;
            overflow: auto
        }
    </style>


    <title>画像リソース</title>

    <style id="respec-mainstyle">
        @keyframes pop {
            0% {
                transform: scale(1, 1)
            }

            25% {
                transform: scale(1.25, 1.25);
                opacity: .75
            }

            100% {
                transform: scale(1, 1)
            }
        }

        .hljs {
            background: 0 0 !important
        }

        a abbr,
        h1 abbr,
        h2 abbr,
        h3 abbr,
        h4 abbr,
        h5 abbr,
        h6 abbr {
            border: none
        }

        dfn {
            font-weight: 700
        }

        a.internalDFN {
            color: inherit;
            border-bottom: 1px solid #99c;
            text-decoration: none
        }

        a.externalDFN {
            color: inherit;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        a.bibref {
            text-decoration: none
        }

        .respec-offending-element:target {
            animation: pop .25s ease-in-out 0s 1
        }

        .respec-offending-element,
        a[href].respec-offending-element {
            text-decoration: red wavy underline
        }

        @supports not (text-decoration:red wavy underline) {
            .respec-offending-element:not(pre) {
                display: inline-block
            }

            .respec-offending-element {
                background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x
            }
        }

        #references :target {
            background: #eaf3ff;
            animation: pop .4s ease-in-out 0s 1
        }

        cite .bibref {
            font-style: normal
        }

        code {
            color: #c63501
        }

        th code {
            color: inherit
        }

        a[href].orcid {
            padding-left: 4px;
            padding-right: 4px
        }

        a[href].orcid>svg {
            margin-bottom: -2px
        }

        .toc a,
        .tof a {
            text-decoration: none
        }

        a .figno,
        a .secno {
            color: #000
        }

        ol.tof,
        ul.tof {
            list-style: none outside none
        }

        .caption {
            margin-top: .5em;
            font-style: italic
        }

        table.simple {
            border-spacing: 0;
            border-collapse: collapse;
            border-bottom: 3px solid #005a9c
        }

        .simple th {
            background: #005a9c;
            color: #fff;
            padding: 3px 5px;
            text-align: left
        }

        .simple th a {
            color: #fff;
            padding: 3px 5px;
            text-align: left
        }

        .simple th[scope=row] {
            background: inherit;
            color: inherit;
            border-top: 1px solid #ddd
        }

        .simple td {
            padding: 3px 10px;
            border-top: 1px solid #ddd
        }

        .simple tr:nth-child(even) {
            background: #f0f6ff
        }

        .section dd>p:first-child {
            margin-top: 0
        }

        .section dd>p:last-child {
            margin-bottom: 0
        }

        .section dd {
            margin-bottom: 1em
        }

        .section dl.attrs dd,
        .section dl.eldef dd {
            margin-bottom: 0
        }

        #issue-summary>ul {
            column-count: 2
        }

        #issue-summary li {
            list-style: none;
            display: inline-block
        }

        details.respec-tests-details {
            margin-left: 1em;
            display: inline-block;
            vertical-align: top
        }

        details.respec-tests-details>* {
            padding-right: 2em
        }

        details.respec-tests-details[open] {
            z-index: 999999;
            position: absolute;
            border: thin solid #cad3e2;
            border-radius: .3em;
            background-color: #fff;
            padding-bottom: .5em
        }

        details.respec-tests-details[open]>summary {
            border-bottom: thin solid #cad3e2;
            padding-left: 1em;
            margin-bottom: 1em;
            line-height: 2em
        }

        details.respec-tests-details>ul {
            width: 100%;
            margin-top: -.3em
        }

        details.respec-tests-details>li {
            padding-left: 1em
        }

        a[href].self-link:hover {
            opacity: 1;
            text-decoration: none;
            background-color: transparent
        }

        h2,
        h3,
        h4,
        h5,
        h6 {
            position: relative
        }

        aside.example .marker>a.self-link {
            color: inherit
        }

        h2>a.self-link,
        h3>a.self-link,
        h4>a.self-link,
        h5>a.self-link,
        h6>a.self-link {
            border: none;
            color: inherit;
            font-size: 83%;
            height: 2em;
            left: -1.6em;
            opacity: .5;
            position: absolute;
            text-align: center;
            text-decoration: none;
            top: 0;
            transition: opacity .2s;
            width: 2em
        }

        h2>a.self-link::before,
        h3>a.self-link::before,
        h4>a.self-link::before,
        h5>a.self-link::before,
        h6>a.self-link::before {
            content: "§";
            display: block
        }

        @media (max-width:767px) {
            dd {
                margin-left: 0
            }

            h2>a.self-link,
            h3>a.self-link,
            h4>a.self-link,
            h5>a.self-link,
            h6>a.self-link {
                left: auto;
                top: auto
            }
        }

        @media print {
            .removeOnSave {
                display: none
            }
        }
    </style>


    <meta name="description"
        content="本書では「画像リソース」という概念と、それに対応するWebIDLのImageResource辞書型を定義します。Web APIは、HTMLImageElementが適さない、あるいは利用できない（例：Worker内）場面で画像リソースを表すためにImageResource辞書を使用できます。">
    <link rel="canonical" href="https://www.w3.org/TR/image-resource/">
    <style>
        .hljs {
            display: block;
            overflow-x: auto;
            padding: .5em;
            color: #383a42;
            background: #fafafa
        }

        .hljs-comment,
        .hljs-quote {
            color: #717277;
            font-style: italic
        }

        .hljs-doctag,
        .hljs-formula,
        .hljs-keyword {
            color: #a626a4
        }

        .hljs-deletion,
        .hljs-name,
        .hljs-section,
        .hljs-selector-tag,
        .hljs-subst {
            color: #ca4706;
            font-weight: 700
        }

        .hljs-literal {
            color: #0b76c5
        }

        .hljs-addition,
        .hljs-attribute,
        .hljs-meta-string,
        .hljs-regexp,
        .hljs-string {
            color: #42803c
        }

        .hljs-built_in,
        .hljs-class .hljs-title {
            color: #9a6a01
        }

        .hljs-attr,
        .hljs-number,
        .hljs-selector-attr,
        .hljs-selector-class,
        .hljs-selector-pseudo,
        .hljs-template-variable,
        .hljs-type,
        .hljs-variable {
            color: #986801
        }

        .hljs-bullet,
        .hljs-link,
        .hljs-meta,
        .hljs-selector-id,
        .hljs-symbol,
        .hljs-title {
            color: #336ae3
        }

        .hljs-emphasis {
            font-style: italic
        }

        .hljs-strong {
            font-weight: 700
        }

        .hljs-link {
            text-decoration: underline
        }
    </style>
    <style>
        var {
            position: relative;
            cursor: pointer
        }

        var[data-type]::after,
        var[data-type]::before {
            position: absolute;
            left: 50%;
            top: -6px;
            opacity: 0;
            transition: opacity .4s;
            pointer-events: none
        }

        var[data-type]::before {
            content: "";
            transform: translateX(-50%);
            border-width: 4px 6px 0 6px;
            border-style: solid;
            border-color: transparent;
            border-top-color: #000
        }

        var[data-type]::after {
            content: attr(data-type);
            transform: translateX(-50%) translateY(-100%);
            background: #000;
            text-align: center;
            font-family: "Dank Mono", "Fira Code", monospace;
            font-style: normal;
            padding: 6px;
            border-radius: 3px;
            color: #daca88;
            text-indent: 0;
            font-weight: 400
        }

        var[data-type]:hover::after,
        var[data-type]:hover::before {
            opacity: 1
        }
    </style>
    <script id="initialUserConfig" type="application/json">{
  "mdn": false,
  "specStatus": "WD",
  "group": "webapps",
  "editors": [
    {
      "name": "Aaron Gustafson",
      "company": "Microsoft Corporation",
      "companyURL": "https://microsoft.com/",
      "w3cid": 43672
    },
    {
      "name": "Rayan Kanso",
      "company": "Google Inc.",
      "companyURL": "https://google.com/",
      "w3cid": 115452
    },
    {
      "name": "Marcos Cáceres",
      "company": "W3C",
      "companyURL": "https://w3c.org/",
      "w3cid": 39125
    }
  ],
  "github": {
    "repoURL": "w3c/image-resource/",
    "branch": "main"
  },
  "xref": "web-platform",
  "shortName": "image-resource",
  "publishDate": "2021-06-04",
  "previousMaturity": "WD",
  "previousPublishDate": "2021-04-26",
  "publishISODate": "2021-06-04T00:00:00.000Z",
  "generatedSubtitle": "Working Draft 04 June 2021"
}</script>
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/W3C-WD">
</head>

<body data-cite="WebIDL ENCODING MIMESNIFF APPMANIFEST HTML INFRA URL WEBIDL DOM FETCH" class="h-entry">
    <div class="head">
        <a class="logo" href="https://www.w3.org/"><img alt="W3C" width="72" height="48"
                src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C"></a>
        <h1 id="title" class="title">
            画像リソース
        </h1>

        <h2>
            W3C作業草案
            <time class="dt-published" datetime="2021-06-04">2021年6月4日</time>
        </h2>
        <dl>
            <dt>このバージョン:</dt>
            <dd>
                <a class="u-url"
                    href="https://www.w3.org/TR/2021/WD-image-resource-20210604/">https://www.w3.org/TR/2021/WD-image-resource-20210604/</a>
            </dd>
            <dt>最新公開バージョン:</dt>
            <dd>
                <a href="https://www.w3.org/TR/image-resource/">https://www.w3.org/TR/image-resource/</a>
            </dd>
            <dt>編集者草稿最新版:</dt>
            <dd><a href="https://w3c.github.io/image-resource/">https://w3c.github.io/image-resource/</a></dd>



            <dt>以前のバージョン:</dt>
            <dd><a
                    href="https://www.w3.org/TR/2021/WD-image-resource-20210426/">https://www.w3.org/TR/2021/WD-image-resource-20210426/</a>
            </dd>

            <dt>編集者:</dt>
            <dd class="editor p-author h-card vcard" data-editor-id="43672">
                <span class="p-name fn">Aaron Gustafson</span> (<a class="p-org org h-org"
                    href="https://microsoft.com/">Microsoft Corporation</a>)
            </dd>
            <dd class="editor p-author h-card vcard" data-editor-id="115452">
                <span class="p-name fn">Rayan Kanso</span> (<a class="p-org org h-org" href="https://google.com/">Google
                    Inc.</a>)
            </dd>
            <dd class="editor p-author h-card vcard" data-editor-id="39125">
                <span class="p-name fn">Marcos Cáceres</span> (<a class="p-org org h-org"
                    href="https://w3c.org/">W3C</a>)
            </dd>


            <dt>参加方法:</dt>
            <dd>
                <a href="https://github.com/w3c/image-resource/">GitHub w3c/image-resource</a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/image-resource/issues/">課題を登録</a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/image-resource/commits/main">コミット履歴</a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/image-resource/pulls/">プルリクエスト</a>
            </dd>
        </dl>



        <p class="copyright">
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
            ©
            2021

            <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a
                href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
            <a href="https://www.ercim.eu/"><abbr
                    title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a
                href="https://www.keio.ac.jp/">Keio</a>,
            <a href="https://ev.buaa.edu.cn/">Beihang</a>).
            W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a rel="license"
                href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document">permissive document
                license</a> rules
            apply.
        </p>
        <hr title="Separator for header">
    </div>

    <section id="abstract" class="introductory">
        <h2>概要</h2>
        <p>
            本書は「画像リソース」の概念と、それに対応するWebIDL <a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                id="ref-for-dom-imageresource-1"><code>ImageResource</code></a> 辞書型を定義します。Web APIは
            <a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                id="ref-for-dom-imageresource-2"><code>ImageResource</code></a> 辞書を使うことで、
            <code>HTMLImageElement</code> が適さない、あるいは利用できない（例：Worker内）状況で画像リソースを表現できます。
        </p>
    </section>
    <section id="sotd" class="introductory">
        <h2>この文書のステータス</h2>
        <p><em>このセクションは、公開時点での本書のステータスを説明します。 他の文書が本書に取って代わる場合があります。現在の <abbr
                    title="World Wide Web Consortium">W3C</abbr> 公開文書およびこの技術報告書の最新版は
                <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> 技術報告一覧</a>
                https://www.w3.org/TR/ で確認できます。</em></p>
        <div class="warning" id="issue-container-generatedID">
            <div role="heading" class="warning-title marker" id="h-warning" aria-level="3"><span>警告</span></div>
            <p class="">
                <strong>この仕様は安定していません。</strong> 議論に参加していない実装者は、互換性のない方法で仕様が変わる可能性があります。
            </p>
        </div>
        <p>
            この文書は <a href="https://www.w3.org/2019/webapps/">Web Applications Working Group</a> により作業草案として公開されました。
            この文書は <abbr title="World Wide Web Consortium">W3C</abbr> 勧告を目指しています。
        </p>
        <p>
            この仕様の議論は <a href="https://github.com/w3c/image-resource/issues/">GitHub Issues</a> で行うことを推奨します。
        </p>
        <p>
            作業草案として公開されている文書は <abbr title="World Wide Web Consortium">W3C</abbr> 会員による承認を意味するものではありません。
        </p>
        <p>この文書は草案であり、随時更新・差し替え・廃止される場合があります。進行中の作業以外としてこの文書を引用するべきではありません。
        </p>
        <p></p>
        <p>
            この文書は
            <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr>
                特許ポリシー</a>の下で運営されているグループによって作成されています。

            <abbr title="World Wide Web Consortium">W3C</abbr> は、
            <a rel="disclosure" href="https://www.w3.org/groups/wg/webapps/ipr">パブリックな特許開示リスト</a>
            を管理しています。そのページでは特許の開示方法も案内されています。実際に特許の存在を知り、それが
            <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">必須クレーム</a>
            に該当すると考える場合は、
            <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">特許ポリシー第6節</a>
            に従い開示が必要です。
        </p>
        <p>
            この文書は
            <a id="w3c_process_revision" href="https://www.w3.org/2020/Process-20200915/">2020年9月15日版 <abbr
                    title="World Wide Web Consortium">W3C</abbr> プロセス文書</a> に準拠します。
        </p>
    </section>
    <nav id="toc">
        <h2 class="introductory" id="table-of-contents">目次</h2>
        <ol class="toc">
            <li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>
                    はじめに
                </a></li>
            <li class="tocline"><a class="tocxref" href="#privacy-and-security-considerations"><bdi class="secno">2.
                    </bdi>
                    プライバシーとセキュリティの考慮事項
                </a></li>
            <li class="tocline"><a class="tocxref" href="#image-resource"><bdi class="secno">3. </bdi>
                    画像リソース
                </a></li>
            <li class="tocline"><a class="tocxref" href="#imageresource-dictionary"><bdi class="secno">4. </bdi>
                    <span data-export="" data-dfn-type="dictionary" data-idl="dictionary" data-title="ImageResource"
                        data-dfn-for=""><code>ImageResource</code></span> 辞書型
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#src-member"><bdi class="secno">4.1 </bdi>
                            <span data-export="" data-dfn-type="dict-member" data-idl="field" data-title="src"
                                data-dfn-for="ImageResource" data-type="USVString"><code>src</code></span> メンバー
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#sizes-member"><bdi class="secno">4.2 </bdi>
                            <span data-export="" data-dfn-type="dict-member" data-idl="field" data-title="sizes"
                                data-dfn-for="ImageResource" data-type="DOMString"><code>sizes</code></span> メンバー
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#type-member"><bdi class="secno">4.3 </bdi>
                            <span data-export="" data-dfn-type="dict-member" data-idl="field" data-title="type"
                                data-dfn-for="ImageResource" data-type="DOMString"><code>type</code></span> メンバー
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#label-member"><bdi class="secno">4.4 </bdi>
                            <span data-export="" data-dfn-type="dict-member" data-idl="field" data-title="label"
                                data-dfn-for="ImageResource" data-type="DOMString"><code>label</code></span> メンバー
                        </a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#processing-an-imageresource-from-an-api"><bdi class="secno">5.
                    </bdi>
                    APIからの <code>ImageResource</code> 処理
                </a></li>
            <li class="tocline"><a class="tocxref" href="#processing-an-image-resource-from-json"><bdi class="secno">6.
                    </bdi>
                    JSONからの画像リソースの処理
                </a></li>
            <li class="tocline"><a class="tocxref" href="#fetching-an-image-resource"><bdi class="secno">7. </bdi>
                    画像リソースの取得
                </a></li>
            <li class="tocline"><a class="tocxref" href="#deriving-the-accessible-name"><bdi class="secno">8. </bdi>
                    アクセシブル・ネームの導出
                </a></li>
            <li class="tocline"><a class="tocxref"
                    href="#examples-of-graphics-formats-supporting-embedded-accessible-names"><bdi class="secno">9.
                    </bdi>
                    埋込型アクセシブル・ネーム対応グラフィクスフォーマット例
                </a></li>
            <li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">10. </bdi>適合性</a></li>
            <li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>参考文献</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">A.1
                            </bdi>規範参考文献</a></li>
                </ol>
            </li>
        </ol>
    </nav>
    <section id="introduction">
        <h2 id="x1-introduction"><bdi class="secno">1. </bdi>
            はじめに
            <a class="self-link" aria-label="§" href="#introduction"></a>
        </h2>
        <p>
            ウェブアプリケーションは、HTMLドキュメント外（OSやブラウザーUIなど）で表示される画像リソースを開発者から受け取ることがよくあります。この仕様は、画像を記述し、その画像リソースの取得先を示すWebIDL辞書型を定義します。ユーザーエージェントは、この追加情報を利用することで、エンドユーザーの端末に最適、またはユーザーの嗜好や環境にもっとも近い画像を選択できます。
        </p>
    </section>
    <section id="privacy-and-security-considerations">
        <h2 id="x2-privacy-and-security-considerations"><bdi class="secno">2. </bdi>
            プライバシーとセキュリティの考慮事項
            <a class="self-link" aria-label="§" href="#privacy-and-security-considerations"></a>
        </h2>
        <p>
            <a data-link-type="dfn" href="#dfn-fetching-an-image-resource" class="internalDFN"
                id="ref-for-dfn-fetching-an-image-resource-1">画像リソースの取得</a>時、ユーザーのIPアドレスが判明することがあります。
            ユーザーエージェントは、開発者から提供された<a data-link-type="dfn" href="#dfn-image-resource" class="internalDFN"
                id="ref-for-dfn-image-resource-1">画像リソース</a>を取得し、必要に応じて再利用できるよう保存することが<em class="rfc2119">推奨</em>されます。
            これにより、ユーザーの位置情報の長期的な追跡が制限されます。
        </p>
    </section>
    <section id="image-resource">
        <h2 id="x3-image-resource"><bdi class="secno">3. </bdi>
            画像リソース
            <a class="self-link" aria-label="§" href="#image-resource"></a>
        </h2>
        <p>
            <dfn data-export="" data-plurals="image resources" id="dfn-image-resource" tabindex="0"
                aria-haspopup="dialog">画像リソース</dfn>は次の要素から構成されます:
        </p>
        <dl>
            <dt>
                <dfn data-dfn-for="image resource" id="dfn-src" tabindex="0" aria-haspopup="dialog">src</dfn>
            </dt>
            <dd>
                画像データの取得元となる<a data-link-type="dfn" data-type="dfn"
                    href="https://url.spec.whatwg.org/#concept-url">URL</a>。
            </dd>
            <dt>
                <dfn data-dfn-for="image resource" id="dfn-sizes" tabindex="0" aria-haspopup="dialog">sizes</dfn>
            </dt>
            <dd>
                画像のサイズを表すオプションの<a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#string">文字列</a>であり、
                <code><a data-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element">link</a></code>要素の
                <code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-sizes">sizes</a></code>
                属性と同じ構文を使用します。
            </dd>
            <dt>
                <dfn data-dfn-for="image resource" id="dfn-type" tabindex="0" aria-haspopup="dialog">type</dfn>
            </dt>
            <dd>
                オプションの<a data-link-type="dfn" data-type="dfn"
                    href="https://mimesniff.spec.whatwg.org/#image-mime-type">画像MIMEタイプ</a>。
            </dd>
            <dt>
                <dfn data-dfn-for="image resource" id="dfn-label" tabindex="0" aria-haspopup="dialog">label</dfn>
            </dt>
            <dd>
                画像のアクセシブル・ネームを表す<a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#string">文字列</a>。
            </dd>
        </dl>
        <p>
            APIでは、<a data-link-type="dfn" href="#dfn-image-resource" class="internalDFN"
                id="ref-for-dfn-image-resource-2">画像リソース</a>は<a data-link-type="idl" href="#dom-imageresource"
                class="internalDFN" id="ref-for-dom-imageresource-3"><code>ImageResource</code></a>辞書として表されます。
        </p>
        <p>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-json"
                    title="The JavaScript Object Notation (JSON) Data Interchange Format">JSON</a></cite>]では、<a
                data-link-type="dfn" href="#dfn-image-resource" class="internalDFN"
                id="ref-for-dfn-image-resource-3">画像リソース</a>はオブジェクトとして表現されます。
        </p>
    </section>
    <section data-dfn-for="ImageResource" id="imageresource-dictionary">
        <h2 id="x4-imageresource-dictionary"><bdi class="secno">4. </bdi>
            <dfn data-export="" data-dfn-type="dictionary" id="dom-imageresource" data-idl="dictionary"
                data-title="ImageResource" data-dfn-for="" tabindex="0"
                aria-haspopup="dialog"><code>ImageResource</code></dfn> 辞書型
            <a class="self-link" aria-label="§" href="#imageresource-dictionary"></a>
        </h2>
        <pre class="idl def" id="webidl-1355091221"><span class="idlHeader"><a class="self-link" href="#webidl-1355091221">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-imageresource" data-title="ImageResource">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-imageresource" id="ref-for-dom-imageresource-4"><code>ImageResource</code></a> {<span data-idl="" class="idlMember" id="idl-def-imageresource-src" data-title="src" data-dfn-for="ImageResource">
  required<span class="idlType"> <a data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-imageresource-src" id="ref-for-dom-imageresource-src-1"><code>src</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-imageresource-sizes" data-title="sizes" data-dfn-for="ImageResource"><span class="idlType">
  <a data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-imageresource-sizes" id="ref-for-dom-imageresource-sizes-1"><code>sizes</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-imageresource-type" data-title="type" data-dfn-for="ImageResource"><span class="idlType">
  <a data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-imageresource-type" id="ref-for-dom-imageresource-type-1"><code>type</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-imageresource-label" data-title="label" data-dfn-for="ImageResource"><span class="idlType">
  <a data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-imageresource-label" id="ref-for-dom-imageresource-label-1"><code>label</code></a>;</span>
};</span></code></pre>
        <section id="src-member">
            <h3 id="x4-1-src-member"><bdi class="secno">4.1 </bdi>
                <dfn data-export="" data-dfn-type="dict-member" id="dom-imageresource-src" data-idl="field"
                    data-title="src" data-dfn-for="ImageResource" data-type="USVString" tabindex="0"
                    aria-haspopup="dialog"><code>src</code></dfn> メンバー
                <a class="self-link" aria-label="§" href="#src-member"></a>
            </h3>
            <p>
                <a data-link-type="idl" href="#dom-imageresource-src" class="internalDFN"
                    id="ref-for-dom-imageresource-src-2"><code>src</code></a>は<a data-link-type="idl"
                    href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-5"><code>ImageResource</code></a>の画像データをユーザーエージェントが<a
                    data-link-type="dfn" data-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-fetch">フェッチ</a>できる<a data-link-type="dfn"
                    data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a>です。
            </p>
        </section>
        <section data-cite="html" id="sizes-member">
            <h3 id="x4-2-sizes-member"><bdi class="secno">4.2 </bdi>
                <dfn data-export="" data-dfn-type="dict-member" id="dom-imageresource-sizes" data-idl="field"
                    data-title="sizes" data-dfn-for="ImageResource" data-type="DOMString" tabindex="0"
                    aria-haspopup="dialog"><code>sizes</code></dfn> メンバー
                <a class="self-link" aria-label="§" href="#sizes-member"></a>
            </h3>
            <p>
                <a data-link-type="idl" href="#dom-imageresource-sizes" class="internalDFN"
                    id="ref-for-dom-imageresource-sizes-2"><code>sizes</code></a>メンバーは<code><a data-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element">link</a></code>要素の<code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-sizes">sizes</a></code>属性と同等であり、同じ方法で処理されます。
            </p>
            <p>
                複数の<a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-6"><code>ImageResource</code></a>辞書が利用可能な場合、ユーザーエージェントは<em
                    class="rfc2119">任意で</em> <a data-link-type="idl" href="#dom-imageresource-sizes" class="internalDFN"
                    id="ref-for-dom-imageresource-sizes-3"><code>sizes</code></a>値を使って表示状況に最適な画像を選択（不適切なものは無視）できます。
            </p>
            <div class="note" role="note" id="issue-container-generatedID-0">
                <div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>注</span></div>
                <aside class="">
                    APIが複数の<a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                        id="ref-for-dom-imageresource-7"><code>ImageResource</code></a>辞書（例：WebIDLの<a
                        data-link-type="dfn" data-type="dfn"
                        href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>）を利用する場合、仕様にはそれら辞書の順序が重要かどうか明記すべきです。一般的には順序が重要であり、「最初の合致が優先される」ことが多いです。
                </aside>
            </div>
            <div class="example">
                <a data-link-type="idl" href="#dom-imageresource-sizes" class="internalDFN"
                    id="ref-for-dom-imageresource-sizes-4"><code>sizes</code></a>メンバーは複数のサイズ値をスペース区切りで指定でき、
                さまざまなサイズの画像を格納できる（ICOなどの）フォーマットに対応します。
                <pre aria-busy="false"><code class="hljs js"><span class="hljs-keyword">const</span> image = {
  <span class="hljs-attr">src</span>: <span class="hljs-string">"path/to/image.ico"</span>,
  <span class="hljs-attr">sizes</span>: <span class="hljs-string">"16x16 32x32 64x64"</span>,
  <span class="hljs-attr">type</span>: <span class="hljs-string">"image/vnd.microsoft.icon"</span>,
};
some.api.doSomething(image);</code></pre>
            </div>
        </section>
        <section id="type-member">
            <h3 id="x4-3-type-member"><bdi class="secno">4.3 </bdi>
                <dfn data-export="" data-dfn-type="dict-member" id="dom-imageresource-type" data-idl="field"
                    data-title="type" data-dfn-for="ImageResource" data-type="DOMString" tabindex="0"
                    aria-haspopup="dialog"><code>type</code></dfn> メンバー
                <a class="self-link" aria-label="§" href="#type-member"></a>
            </h3>
            <p>
                <a data-link-type="idl" href="#dom-imageresource-type" class="internalDFN"
                    id="ref-for-dom-imageresource-type-2"><code>type</code></a>メンバーは画像リソースの<a data-link-type="dfn"
                    data-type="dfn"
                    href="https://mimesniff.spec.whatwg.org/#image-mime-type">画像MIMEタイプ</a>を表します。ユーザーエージェントは、未対応メディアタイプを無視しても<em
                    class="rfc2119">よい</em>です。
            </p>
            <p>
                <a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-8"><code>ImageResource</code></a>にデフォルトの<a data-link-type="dfn"
                    data-type="dfn" href="https://mimesniff.spec.whatwg.org/#mime-type">MIMEタイプ</a>はありません。
                <a data-link-type="idl" href="#dom-imageresource-type" class="internalDFN"
                    id="ref-for-dom-imageresource-type-3"><code>type</code></a>はあくまで参考情報です。ユーザーエージェントは<em
                    class="rfc2119">必ず</em>
                <a data-link-type="dfn" data-type="dfn"
                    href="https://mimesniff.spec.whatwg.org/#rules-for-sniffing-images-specifically">画像用のスニッフィング規則</a>で
                <a data-link-type="dfn" data-type="dfn"
                    href="https://mimesniff.spec.whatwg.org/#computed-mime-type">計算済みMIMEタイプ</a>
                を決定しなければなりません。
            </p>
        </section>
        <section data-cite="WAI-ARIA" id="label-member">
            <h3 id="x4-4-label-member"><bdi class="secno">4.4 </bdi>
                <dfn data-export="" data-dfn-type="dict-member" id="dom-imageresource-label" data-idl="field"
                    data-title="label" data-dfn-for="ImageResource" data-type="DOMString" tabindex="0"
                    aria-haspopup="dialog"><code>label</code></dfn> メンバー
                <a class="self-link" aria-label="§" href="#label-member"></a>
            </h3>
            <p>
                <a data-link-type="idl" href="#dom-imageresource-label" class="internalDFN"
                    id="ref-for-dom-imageresource-label-2"><code>label</code></a>は、<a data-link-type="idl"
                    href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-9"><code>ImageResource</code></a>に対応する画像の<a data-link-type="dfn"
                    data-type="dfn" href="https://infra.spec.whatwg.org/#string">文字列</a>
                であり、画像の<a data-link-type="dfn" data-type="dfn" class="respec-offending-element"
                    title="Error: Normative reference to informative term"
                    id="respec-offender-error-normative-reference-to-informative-term"
                    href="https://www.w3.org/TR/wai-aria/#dfn-accessible-name">アクセシブル・ネーム</a>を提供します。
            </p>
            <p>
                実装者は、ユーザーに公開するすべての<a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-10"><code>ImageResource</code></a>に対し、<a data-link-type="dfn"
                    href="#dfn-deriving-the-accessible-name" class="internalDFN"
                    id="ref-for-dfn-deriving-the-accessible-name-1">アクセシブル・ネームの導出</a>を<em
                    class="rfc2119">必須で</em>行わなければなりません。
            </p>
            <p>
                著者は、<a data-link-type="idl" href="#dom-imageresource-label" class="internalDFN"
                    id="ref-for-dom-imageresource-label-3"><code>label</code></a>を明示的に追加することが強く推奨されます。
                ただし、<a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-11"><code>ImageResource</code></a>の<a data-link-type="dfn"
                    data-type="dfn" class="respec-offending-element"
                    title="Error: Normative reference to informative term"
                    id="respec-offender-error-normative-reference-to-informative-term-0"
                    href="https://www.w3.org/TR/wai-aria/#dfn-accessible-name">アクセシブル・ネーム</a>が
                コンテキストから<dfn id="dfn-external-label" tabindex="0" aria-haspopup="dialog">外部ラベル</dfn>として推論できる場合を除きます。例えば、
                <a data-link-type="dfn" data-type="dfn"
                    href="https://www.w3.org/TR/appmanifest/#dfn-application-manifest">マニフェスト</a>文脈では、<a
                    data-link-type="dfn" data-type="dfn"
                    href="https://www.w3.org/TR/appmanifest/#dfn-name"><code>name</code></a>（または
                <a data-link-type="dfn" data-type="dfn"
                    href="https://www.w3.org/TR/appmanifest/#dfn-short_name"><code>short_name</code></a>）が
                <a data-link-type="dfn" href="#dfn-external-label" class="internalDFN"
                    id="ref-for-dfn-external-label-1">外部ラベル</a>として指定され、 <a data-link-type="idl"
                    href="#dom-imageresource-label" class="internalDFN"
                    id="ref-for-dom-imageresource-label-4"><code>label</code></a>を持たない <a data-link-type="dfn"
                    data-type="dfn" href="https://www.w3.org/TR/appmanifest/#dfn-icons"><code>icons</code></a>
                配列のすべての要素のラベルとなります。
            </p>
            <p>
                明示的な<a data-link-type="idl" href="#dom-imageresource-label" class="internalDFN"
                    id="ref-for-dom-imageresource-label-5"><code>label</code></a>も<a data-link-type="dfn"
                    href="#dfn-external-label" class="internalDFN"
                    id="ref-for-dfn-external-label-2">外部ラベル</a>も提供されていないが、<a data-link-type="idl"
                    href="#dom-imageresource-type" class="internalDFN"
                    id="ref-for-dom-imageresource-type-4"><code>type</code></a>が<a data-link-type="dfn"
                    href="#dfn-embedded-accessible-name" class="internalDFN"
                    id="ref-for-dfn-embedded-accessible-name-1">埋込型アクセシブル・ネーム</a>をサポートする場合、実装者は<a data-link-type="idl"
                    href="#dom-imageresource-src" class="internalDFN"
                    id="ref-for-dom-imageresource-src-3"><code>src</code></a>取得・処理まで <a data-link-type="idl"
                    href="#dom-imageresource-label" class="internalDFN"
                    id="ref-for-dom-imageresource-label-6"><code>label</code></a>の割り当てを遅延できる<em
                    class="rfc2119">可能性がある</em>。
                <a data-link-type="idl" href="#dom-imageresource-src" class="internalDFN"
                    id="ref-for-dom-imageresource-src-4"><code>src</code></a>から<a data-link-type="dfn"
                    href="#dfn-embedded-accessible-name" class="internalDFN"
                    id="ref-for-dfn-embedded-accessible-name-2">埋込型アクセシブル・ネーム</a>が取得できた場合、
                実装者は<a data-link-type="idl" href="#dom-imageresource-label" class="internalDFN"
                    id="ref-for-dom-imageresource-label-7"><code>label</code></a>をその値に更新<em class="rfc2119">必須</em>です。
            </p>
        </section>
    </section>
    <section id="processing-an-imageresource-from-an-api">
        <h2 id="x5-processing-an-imageresource-from-an-api"><bdi class="secno">5. </bdi>
            APIからの<code>ImageResource</code>処理
            <a class="self-link" aria-label="§" href="#processing-an-imageresource-from-an-api"></a>
        </h2>
        <p>
            <dfn data-export="" id="dfn-process-an-imageresource-from-an-api" tabindex="0"
                aria-haspopup="dialog">APIからの<code>ImageResource</code>の処理</dfn>は、次のアルゴリズムで示されます。このアルゴリズムは
            <a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                id="ref-for-dom-imageresource-12"><code>ImageResource</code></a> <var
                data-type="ImageResource">input</var>を受け取り、<a data-link-type="dfn" href="#dfn-image-resource"
                class="internalDFN" id="ref-for-dfn-image-resource-5">画像リソース</a>を返します。
        </p>
        <ol>
            <li><var>base URL</var>を、この辞書が使われている<a data-link-type="dfn" data-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">関連する設定オブジェクト</a>の<a
                    data-link-type="dfn" data-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url">APIベースURL</a>とする。
            </li>
            <li><var>image</var> を新しい <a data-link-type="dfn" href="#dfn-image-resource" class="internalDFN"
                    id="ref-for-dfn-image-resource-6">画像リソース</a> とする。
            </li>
            <li><var>image</var> の <a data-link-type="dfn" href="#dfn-src" class="internalDFN"
                    id="ref-for-dfn-src-1">src</a> を、<a data-link-type="dfn" data-lt="URL
        parser" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser">URLパース</a>で <var
                    data-type="ImageResource">input</var>.<a data-link-type="idl" href="#dom-imageresource-src"
                    class="internalDFN" id="ref-for-dom-imageresource-src-5"><code>src</code></a> と<var>base
                    URL</var>を使った結果に設定する。
                パース失敗時は<a data-link-type="idl" data-type="exception"
                    href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>を投げる。
            </li>
            <li><var data-type="ImageResource">input</var> の<a data-link-type="idl" href="#dom-imageresource-sizes"
                    class="internalDFN" id="ref-for-dom-imageresource-sizes-5"><code>sizes</code></a>メンバーが存在する場合:
                <ol>
                    <li data-cite="html"><var>image</var> の<a data-link-type="dfn" href="#dfn-sizes" class="internalDFN"
                            id="ref-for-dfn-sizes-1">sizes</a>を、<var data-type="ImageResource">input</var>.<a
                            data-link-type="idl" href="#dom-imageresource-sizes" class="internalDFN"
                            id="ref-for-dom-imageresource-sizes-6"><code>sizes</code></a>
                        を、<code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-sizes">sizes</a></code>
                        属性のようにパースした結果とする。このパースに失敗した場合は
                        <a data-link-type="idl" data-type="exception"
                            href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>を投げる。
                    </li>
                </ol>
            </li>
            <li><var data-type="ImageResource">input</var> の<a data-link-type="idl" href="#dom-imageresource-type"
                    class="internalDFN" id="ref-for-dom-imageresource-type-5"><code>type</code></a>メンバーが存在し、空文字列でない場合:
                <ol>
                    <li><a data-link-type="idl" href="#dom-imageresource-type" class="internalDFN"
                            id="ref-for-dom-imageresource-type-6"><code>type</code></a>が<a data-link-type="dfn"
                            data-type="dfn"
                            href="https://mimesniff.spec.whatwg.org/#image-mime-type">画像MIMEタイプ</a>でなければ、
                        <a data-link-type="idl" data-type="exception"
                            href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>を投げる。
                    </li>
                    <li><var>image</var> の <a data-link-type="dfn" href="#dfn-type" class="internalDFN"
                            id="ref-for-dfn-type-1">type</a> を
                        <var data-type="ImageResource">input</var>.<a data-link-type="idl"
                            href="#dom-imageresource-type" class="internalDFN"
                            id="ref-for-dom-imageresource-type-7"><code>type</code></a>
                        に設定する。
                    </li>
                </ol>
            </li>
            <li><var>image</var> の<a data-link-type="dfn" href="#dfn-label" class="internalDFN"
                    id="ref-for-dfn-label-1">label</a>に<a data-link-type="dfn" href="#dfn-deriving-the-accessible-name"
                    class="internalDFN" id="ref-for-dfn-deriving-the-accessible-name-2">アクセシブル・ネームの導出</a>の結果を設定する。
            </li>
            <li><var>image</var>を返す。
            </li>
        </ol>
    </section>
    <section id="processing-an-image-resource-from-json">
        <h2 id="x6-processing-an-image-resource-from-json"><bdi class="secno">6. </bdi>
            JSONからの画像リソースの処理
            <a class="self-link" aria-label="§" href="#processing-an-image-resource-from-json"></a>
        </h2>
        <p>
            <dfn data-export="" id="dfn-process-an-image-resource-from-json" tabindex="0"
                aria-haspopup="dialog">JSONから画像リソースを処理する</dfn>には、JSONオブジェクト<var data-type="object">input</var>および<a
                data-link-type="dfn" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a><var
                data-type="URL">base</var>を与える。返り値は<a data-link-type="dfn" data-type="dfn"
                href="https://infra.spec.whatwg.org/#ordered-map">順序付きマップ</a>。
        </p>
        <ol>
            <li><var data-type="object">input</var>が<a data-link-type="dfn" data-type="element"
                    href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element">object</a>型でない場合、失敗を返す。
            </li>
            <li><var data-type="object">input</var>["src"]が<a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#string">文字列</a>型でない場合、失敗を返す。
            </li>
            <li><var data-type="URL">src</var>を、<var data-type="object">input</var>["src"]を<var
                    data-type="URL">base</var>を基準URLとして<a data-link-type="dfn" data-lt="URL parser" data-type="dfn"
                    href="https://url.spec.whatwg.org/#concept-url-parser">パース</a>した結果とする。
            </li>
            <li><var data-type="URL">src</var>が失敗の場合、失敗を返す。
            </li>
            <li><var>image</var>を新しい<a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#ordered-map">順序付きマップ</a>とする。
            </li>
            <li><var>image</var>["src"]に<var data-type="URL">src</var>を設定する。
            </li>
            <li><var data-type="object">input</var>["sizes"]の型が<a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#string">文字列</a>型かつ長さが0より大きい場合:
                <ol>
                    <li><var data-type="string">sizes</var>に、<var data-type="object">input</var>["sizes"]を
                        <code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-sizes">sizes</a></code>
                        属性を持つ
                        <code><a data-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element">link</a></code>
                        要素の属性としてパースした結果を設定する。<code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-rel">rel</a></code>
                        属性が<code>icon</code>を含むとする。
                    </li>
                    <li><var data-type="string">sizes</var>が失敗の場合、失敗を返す。
                    </li>
                    <li><var>image</var>["sizes"]に<var data-type="string">sizes</var>を設定する。
                    </li>
                </ol>
            </li>
            <li><var data-type="object">input</var>["type"]が<a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#string">文字列</a>型で、長さが0より大きい場合:
                <ol>
                    <li><var>mime</var>を、<var data-type="object">input</var>["type"]を
                        <a data-link-type="dfn" data-lt="parse a mime type" data-type="dfn"
                            href="https://mimesniff.spec.whatwg.org/#parse-a-mime-type">MIMEタイプとしてパース</a>
                        した結果とする。
                    </li>
                    <li><var>mime</var>が失敗の場合、失敗を返す。
                    </li>
                    <li><var>image</var>["type"]に<var>mime</var>の<a data-link-type="dfn" data-type="dfn"
                            href="https://mimesniff.spec.whatwg.org/#mime-type-essence">本質部分</a>を設定する。
                    </li>
                </ol>
            </li>
            <li><var>image</var>["label"]に<a data-link-type="dfn" href="#dfn-deriving-the-accessible-name"
                    class="internalDFN" id="ref-for-dfn-deriving-the-accessible-name-3">アクセシブル・ネームの導出</a>の結果を設定する。
            </li>
            <li><var>image</var>を返す。
            </li>
        </ol>
    </section>
    <section id="fetching-an-image-resource">
        <h2 id="x7-fetching-an-image-resource"><bdi class="secno">7. </bdi>
            画像リソースの取得
            <a class="self-link" aria-label="§" href="#fetching-an-image-resource"></a>
        </h2>
        <p>
            <dfn data-export="" id="dfn-fetching-an-image-resource" tabindex="0"
                aria-haspopup="dialog">画像リソースの取得</dfn>の手順は次のアルゴリズムで示される。アルゴリズムは<a data-link-type="dfn"
                href="#dfn-image-resource" class="internalDFN"
                id="ref-for-dfn-image-resource-7">画像リソース</a><var>image</var>と、オプションで<a data-link-type="dfn"
                data-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-request">Request</a><var>request</var>を受け取り、返り値は<a
                data-link-type="dfn" data-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-response">Response</a>。
        </p>
        <ol>
            <li><var>request</var>が<code>undefined</code>の場合:
                <ol>
                    <li><var>request</var>を新規の<a data-link-type="dfn" data-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request">Request</a>とする。
                    </li>
                    <li><a data-link-type="dfn" data-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-url">URL</a>を<var>image</var>の<a
                            data-link-type="dfn" href="#dfn-src" class="internalDFN"
                            id="ref-for-dfn-src-2">src</a>に設定する。
                    </li>
                    <li><a data-link-type="dfn" data-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-destination">Destination</a>を"image"に設定する。
                    </li>
                    <li><a data-link-type="dfn" data-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-client">Client</a>をコンテキストオブジェクトの<a
                            data-link-type="dfn" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">関連設定オブジェクト</a>に設定する。
                    </li>
                </ol>
            </li>
            <li><var>request</var>の<a data-link-type="dfn" data-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-client">Client</a>がnullの場合、<a
                    data-link-type="idl" data-type="exception"
                    href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>を投げる。
            </li>
            <li><var>request</var>で<a data-link-type="dfn" data-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-fetch">fetch</a>を行い、<a data-link-type="dfn"
                    data-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">Response</a>を返す。
            </li>
        </ol>
        <div class="note" role="note" id="issue-container-generatedID-1">
            <div role="heading" class="note-title marker" id="h-note-0" aria-level="3"><span>注</span></div>
            <aside class="">
                <a data-link-type="dfn" data-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-client">Client</a>はここでCSP適用のため必須。
            </aside>
        </div>
    </section>
    <section id="deriving-the-accessible-name">
        <h2 id="x8-deriving-the-accessible-name"><bdi class="secno">8. </bdi>
            アクセシブル・ネームの導出
            <a class="self-link" aria-label="§" href="#deriving-the-accessible-name"></a>
        </h2>
        <p>
            <dfn data-lt="deriving the accessible name|derive the accessible name" id="dfn-deriving-the-accessible-name"
                tabindex="0" aria-haspopup="dialog">アクセシブル・ネームの導出</dfn>は<a data-link-type="dfn"
                href="#dfn-image-resource" class="internalDFN"
                id="ref-for-dfn-image-resource-8">画像リソース</a><var>resource</var>に対し次の手順で行う。返り値は<a data-link-type="dfn"
                data-type="dfn" href="https://infra.spec.whatwg.org/#string">文字列</a>。
        </p>
        <ol>
            <li><var>resource</var>["label"]が<a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#string">文字列</a>の場合、<var>input</var>["label"]を返す。
            </li>
            <li>それ以外で、<var>image</var>が<a data-link-type="dfn" href="#dfn-embedded-accessible-name" class="internalDFN"
                    id="ref-for-dfn-embedded-accessible-name-3">埋込型アクセシブル・ネーム</a>を提供する場合、その<a data-link-type="dfn"
                    href="#dfn-embedded-accessible-name" class="internalDFN"
                    id="ref-for-dfn-embedded-accessible-name-4">埋込型アクセシブル・ネーム</a>を返す。
            </li>
            <li>それ以外で、<a data-link-type="dfn" href="#dfn-external-label" class="internalDFN"
                    id="ref-for-dfn-external-label-3">外部ラベル</a>が代替可能であれば、該当<a data-link-type="dfn"
                    href="#dfn-external-label" class="internalDFN" id="ref-for-dfn-external-label-4">外部ラベル</a>を返す。
            </li>
            <li>""（空文字列）を返す。
            </li>
        </ol>
    </section>
    <section id="examples-of-graphics-formats-supporting-embedded-accessible-names">
        <h2 id="x9-examples-of-graphics-formats-supporting-embedded-accessible-names"><bdi class="secno">9. </bdi>
            埋込型アクセシブル・ネーム対応グラフィクスフォーマット例
            <a class="self-link" aria-label="§"
                href="#examples-of-graphics-formats-supporting-embedded-accessible-names"></a>
        </h2>
        <p>
            画像内容の一部として<dfn id="dfn-embedded-accessible-name" tabindex="0"
                aria-haspopup="dialog">埋込型アクセシブル・ネーム</dfn>を含められるグラフィックス形式もある。たとえば次のようなものがある:
        </p>
        <ul>
            <li data-cite="SVG">
                <a data-type="element" href="https://www.w3.org/TR/SVG/struct.html#elementdef-title">title</a>要素（<a
                    data-link-type="dfn" data-type="element"
                    href="https://www.w3.org/TR/SVG/struct.html#elementdef-svg">SVG</a>内）
            </li>
            <li>ラスター画像のメタデータ（例: tiff:ImageDescription, XMP:Description）
            </li>
        </ul>
    </section>
    <section id="conformance">
        <h2 id="x10-conformance"><bdi class="secno">10. </bdi>適合性<a class="self-link" aria-label="§"
                href="#conformance"></a></h2>
        <p>この仕様の中で非規範的と明示されたセクション、著者ガイドライン、図、例および注記はすべて非規範的です。それ以外は規範的です。</p>
        <p>
            本文書中の <em class="rfc2119">MAY</em>、<em class="rfc2119">MUST</em>、<em class="rfc2119">RECOMMENDED</em>
            というキーワードは、<a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119"
                    title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a
                    class="bibref" data-link-type="biblio" href="#bib-rfc8174"
                    title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
            で説明されたとおり、大文字で現れた場合に限り、規範的な意味を持ちます。
        </p>
    </section>


    <section id="references" class="appendix">
        <h2 id="a-references"><bdi class="secno">A. </bdi>参考文献<a class="self-link" aria-label="§"
                href="#references"></a></h2>
        <section id="normative-references">
            <h3 id="a-1-normative-references"><bdi class="secno">A.1 </bdi>規範参考文献<a class="self-link" aria-label="§"
                    href="#normative-references"></a></h3>
            <dl class="bibliography">
                <dt id="bib-appmanifest">[appmanifest]</dt>
                <dd><a href="https://www.w3.org/TR/appmanifest/"><cite>Web Application Manifest</cite></a>. Marcos
                    Caceres; Kenneth Christiansen; Mounir Lamouri; Anssi Kostiainen; Matt Giuca; Aaron Gustafson. W3C.
                    2021年6月1日. W3C作業草案. URL: <a
                        href="https://www.w3.org/TR/appmanifest/">https://www.w3.org/TR/appmanifest/</a></dd>
                <dt id="bib-fetch">[fetch]</dt>
                <dd><a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Anne van Kesteren. WHATWG.
                    Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-html">[html]</dt>
                <dd><a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren;
                    Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters. WHATWG. Living Standard. URL: <a
                        href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a></dd>
                <dt id="bib-infra">[infra]</dt>
                <dd><a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic
                    Denicola. WHATWG. Living Standard. URL: <a
                        href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a></dd>
                <dt id="bib-json">[JSON]</dt>
                <dd><a href="https://datatracker.ietf.org/doc/html/rfc8259"><cite>The JavaScript Object Notation (JSON)
                            Data Interchange Format</cite></a>. T. Bray, Ed.. IETF. 2017年12月. Internet Standard.
                    URL: <a
                        href="https://datatracker.ietf.org/doc/html/rfc8259">https://datatracker.ietf.org/doc/html/rfc8259</a>
                </dd>
                <dt id="bib-mimesniff">[mimesniff]</dt>
                <dd><a href="https://mimesniff.spec.whatwg.org/"><cite>MIME Sniffing Standard</cite></a>. Gordon P.
                    Hemsley. WHATWG. Living Standard. URL: <a
                        href="https://mimesniff.spec.whatwg.org/">https://mimesniff.spec.whatwg.org/</a></dd>
                <dt id="bib-rfc2119">[RFC2119]</dt>
                <dd><a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate
                            Requirement Levels</cite></a>. S. Bradner. IETF. 1997年3月. Best Current Practice. URL: <a
                        href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
                </dd>
                <dt id="bib-rfc8174">[RFC8174]</dt>
                <dd><a href="https://datatracker.ietf.org/doc/html/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in
                            RFC 2119 Key Words</cite></a>. B. Leiba. IETF. 2017年5月. Best Current Practice. URL: <a
                        href="https://datatracker.ietf.org/doc/html/rfc8174">https://datatracker.ietf.org/doc/html/rfc8174</a>
                </dd>
                <dt id="bib-svg">[svg]</dt>
                <dd><a href="https://www.w3.org/TR/SVG/"><cite>Scalable Vector Graphics (SVG) 1.0
                            Specification</cite></a>. Jon Ferraiolo. W3C. 2001年9月4日. W3C推奨. URL: <a
                        href="https://www.w3.org/TR/SVG/">https://www.w3.org/TR/SVG/</a></dd>
                <dt id="bib-url">[url]</dt>
                <dd><a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Anne van Kesteren. WHATWG.
                    Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a></dd>
                <dt id="bib-webidl">[webidl]</dt>
                <dd><a href="https://heycam.github.io/webidl/"><cite>Web IDL</cite></a>. Boris Zbarsky. W3C.
                    2016年12月15日. W3C Editor's Draft. URL: <a
                        href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a></dd>
            </dl>
        </section>
    </section>
    <p role="navigation" id="back-to-top">
        <a href="#title"><abbr title="Back to Top">↑</abbr></a>
    </p>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-image-resource"
        aria-label="Links in this document to definition: image resource">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-image-resource"
                aria-label="Permalink for definition: image resource. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-image-resource-1" title="§ 2. Privacy and security considerations">§ 2. Privacy
                    and security considerations</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-resource-2" title="§ 3. Image resource">§ 3. Image resource</a> <a
                    href="#ref-for-dfn-image-resource-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-resource-4" title="§ 4.3 type member">§ 4.3 type member</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-resource-5" title="§ 5. Processing an ImageResource from an API">§ 5.
                    Processing an ImageResource from an API</a> <a href="#ref-for-dfn-image-resource-6"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-resource-7" title="§ 7. Fetching an image resource">§ 7. Fetching an image
                    resource</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-resource-8" title="§ 8. Deriving the accessible name">§ 8. Deriving the
                    accessible name</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-src"
        aria-label="Links in this document to definition: src">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-src"
                aria-label="Permalink for definition: src. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-src-1" title="§ 5. Processing an ImageResource from an API">§ 5. Processing an
                    ImageResource from an API</a>
            </li>
            <li>
                <a href="#ref-for-dfn-src-2" title="§ 7. Fetching an image resource">§ 7. Fetching an image resource</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-sizes"
        aria-label="Links in this document to definition: sizes">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-sizes"
                aria-label="Permalink for definition: sizes. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-sizes-1" title="§ 5. Processing an ImageResource from an API">§ 5. Processing an
                    ImageResource from an API</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-type"
        aria-label="Links in this document to definition: type">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-type"
                aria-label="Permalink for definition: type. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-type-1" title="§ 5. Processing an ImageResource from an API">§ 5. Processing an
                    ImageResource from an API</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-label"
        aria-label="Links in this document to definition: label">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-label"
                aria-label="Permalink for definition: label. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-label-1" title="§ 5. Processing an ImageResource from an API">§ 5. Processing an
                    ImageResource from an API</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-imageresource"
        aria-label="Links in this document to definition: ImageResource">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-imageresource"
                aria-label="Permalink for definition: ImageResource. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1355091221">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-imageresource-1" title="§ Abstract">§ Abstract</a> <a
                    href="#ref-for-dom-imageresource-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-3" title="§ 3. Image resource">§ 3. Image resource</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-4" title="§ 4. ImageResource dictionary">§ 4. ImageResource
                    dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-5" title="§ 4.1 src member">§ 4.1 src member</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-6" title="§ 4.2 sizes member">§ 4.2 sizes member</a> <a
                    href="#ref-for-dom-imageresource-7" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-8" title="§ 4.3 type member">§ 4.3 type member</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-9" title="§ 4.4 label member">§ 4.4 label member</a> <a
                    href="#ref-for-dom-imageresource-10" title="Reference 2">(2)</a> <a
                    href="#ref-for-dom-imageresource-11" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-12" title="§ 5. Processing an ImageResource from an API">§ 5.
                    Processing an ImageResource from an API</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-imageresource-src"
        aria-label="Links in this document to definition: src">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-imageresource-src"
                aria-label="Permalink for definition: src. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1355091221">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-imageresource-src-1" title="§ 4. ImageResource dictionary">§ 4. ImageResource
                    dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-src-2" title="§ 4.1 src member">§ 4.1 src member</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-src-3" title="§ 4.4 label member">§ 4.4 label member</a> <a
                    href="#ref-for-dom-imageresource-src-4" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-src-5" title="§ 5. Processing an ImageResource from an API">§ 5.
                    Processing an ImageResource from an API</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-imageresource-sizes"
        aria-label="Links in this document to definition: sizes">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-imageresource-sizes"
                aria-label="Permalink for definition: sizes. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1355091221">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-imageresource-sizes-1" title="§ 4. ImageResource dictionary">§ 4. ImageResource
                    dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-sizes-2" title="§ 4.2 sizes member">§ 4.2 sizes member</a> <a
                    href="#ref-for-dom-imageresource-sizes-3" title="Reference 2">(2)</a> <a
                    href="#ref-for-dom-imageresource-sizes-4" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-sizes-5" title="§ 5. Processing an ImageResource from an API">§ 5.
                    Processing an ImageResource from an API</a> <a href="#ref-for-dom-imageresource-sizes-6"
                    title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-imageresource-type"
        aria-label="Links in this document to definition: type">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-imageresource-type"
                aria-label="Permalink for definition: type. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1355091221">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-imageresource-type-1" title="§ 4. ImageResource dictionary">§ 4. ImageResource
                    dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-type-2" title="§ 4.3 type member">§ 4.3 type member</a> <a
                    href="#ref-for-dom-imageresource-type-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-type-4" title="§ 4.4 label member">§ 4.4 label member</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-type-5" title="§ 5. Processing an ImageResource from an API">§ 5.
                    Processing an ImageResource from an API</a> <a href="#ref-for-dom-imageresource-type-6"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-imageresource-type-7" title="Reference 3">(3)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-imageresource-label"
        aria-label="Links in this document to definition: label">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-imageresource-label"
                aria-label="Permalink for definition: label. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1355091221">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-imageresource-label-1" title="§ 4. ImageResource dictionary">§ 4. ImageResource
                    dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-label-2" title="§ 4.4 label member">§ 4.4 label member</a> <a
                    href="#ref-for-dom-imageresource-label-3" title="Reference 2">(2)</a> <a
                    href="#ref-for-dom-imageresource-label-4" title="Reference 3">(3)</a> <a
                    href="#ref-for-dom-imageresource-label-5" title="Reference 4">(4)</a> <a
                    href="#ref-for-dom-imageresource-label-6" title="Reference 5">(5)</a> <a
                    href="#ref-for-dom-imageresource-label-7" title="Reference 6">(6)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-external-label"
        aria-label="Links in this document to definition: external label">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-external-label"
                aria-label="Permalink for definition: external label. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-external-label-1" title="§ 4.4 label member">§ 4.4 label member</a> <a
                    href="#ref-for-dfn-external-label-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-external-label-3" title="§ 8. Deriving the accessible name">§ 8. Deriving the
                    accessible name</a> <a href="#ref-for-dfn-external-label-4" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-process-an-imageresource-from-an-api"
        aria-label="Links in this document to definition: process an ImageResource from an API">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-process-an-imageresource-from-an-api"
                aria-label="Permalink for definition: process an ImageResource from an API. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-process-an-image-resource-from-json"
        aria-label="Links in this document to definition: process an image resource from JSON">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-process-an-image-resource-from-json"
                aria-label="Permalink for definition: process an image resource from JSON. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-fetching-an-image-resource"
        aria-label="Links in this document to definition: fetching an image resource">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-fetching-an-image-resource"
                aria-label="Permalink for definition: fetching an image resource. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-fetching-an-image-resource-1" title="§ 2. Privacy and security considerations">§
                    2. Privacy and security considerations</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-deriving-the-accessible-name"
        aria-label="Links in this document to definition: derive the accessible name">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-deriving-the-accessible-name"
                aria-label="Permalink for definition: derive the accessible name. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-deriving-the-accessible-name-1" title="§ 4.4 label member">§ 4.4 label member</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deriving-the-accessible-name-2"
                    title="§ 5. Processing an ImageResource from an API">§ 5. Processing an ImageResource from an
                    API</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deriving-the-accessible-name-3"
                    title="§ 6. Processing an image resource from JSON">§ 6. Processing an image resource from JSON</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-embedded-accessible-name"
        aria-label="Links in this document to definition: embedded accessible name">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-embedded-accessible-name"
                aria-label="Permalink for definition: embedded accessible name. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-embedded-accessible-name-1" title="§ 4.4 label member">§ 4.4 label member</a> <a
                    href="#ref-for-dfn-embedded-accessible-name-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-embedded-accessible-name-3" title="§ 8. Deriving the accessible name">§ 8.
                    Deriving the accessible name</a> <a href="#ref-for-dfn-embedded-accessible-name-4"
                    title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <script id="respec-dfn-panel">(() => {
            // @ts-check
            if (document.respec) {
                document.respec.ready.then(setupPanel);
            } else {
                setupPanel();
            }

            function setupPanel() {
                const listener = panelListener();
                document.body.addEventListener("keydown", listener);
                document.body.addEventListener("click", listener);
            }

            function panelListener() {
                /** @type {HTMLElement} */
                let panel = null;
                return event => {
                    const { target, type } = event;

                    if (!(target instanceof HTMLElement)) return;

                    // For keys, we only care about Enter key to activate the panel
                    // otherwise it's activated via a click.
                    if (type === "keydown" && event.key !== "Enter") return;

                    const action = deriveAction(event);

                    switch (action) {
                        case "show": {
                            hidePanel(panel);
                            /** @type {HTMLElement} */
                            const dfn = target.closest("dfn, .index-term");
                            panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
                            const coords = deriveCoordinates(event);
                            displayPanel(dfn, panel, coords);
                            break;
                        }
                        case "dock": {
                            panel.style.left = null;
                            panel.style.top = null;
                            panel.classList.add("docked");
                            break;
                        }
                        case "hide": {
                            hidePanel(panel);
                            panel = null;
                            break;
                        }
                    }
                };
            }

            /**
             * @param {MouseEvent|KeyboardEvent} event
             */
            function deriveCoordinates(event) {
                const target = /** @type HTMLElement */ (event.target);

                // We prevent synthetic AT clicks from putting
                // the dialog in a weird place. The AT events sometimes
                // lack coordinates, so they have clientX/Y = 0
                const rect = target.getBoundingClientRect();
                if (
                    event instanceof MouseEvent &&
                    event.clientX >= rect.left &&
                    event.clientY >= rect.top
                ) {
                    // The event probably happened inside the bounding rect...
                    return { x: event.clientX, y: event.clientY };
                }

                // Offset to the middle of the element
                const x = rect.x + rect.width / 2;
                // Placed at the bottom of the element
                const y = rect.y + rect.height;
                return { x, y };
            }

            /**
             * @param {Event} event
             */
            function deriveAction(event) {
                const target = /** @type {HTMLElement} */ (event.target);
                const hitALink = !!target.closest("a");
                if (target.closest("dfn:not([data-cite]), .index-term")) {
                    return hitALink ? "none" : "show";
                }
                if (target.closest(".dfn-panel")) {
                    if (hitALink) {
                        return target.classList.contains("self-link") ? "hide" : "dock";
                    }
                    const panel = target.closest(".dfn-panel");
                    return panel.classList.contains("docked") ? "hide" : "none";
                }
                if (document.querySelector(".dfn-panel:not([hidden])")) {
                    return "hide";
                }
                return "none";
            }

            /**
             * @param {HTMLElement} dfn
             * @param {HTMLElement} panel
             * @param {{ x: number, y: number }} clickPosition
             */
            function displayPanel(dfn, panel, { x, y }) {
                panel.hidden = false;
                // distance (px) between edge of panel and the pointing triangle (caret)
                const MARGIN = 20;

                const dfnRects = dfn.getClientRects();
                // Find the `top` offset when the `dfn` can be spread across multiple lines
                let closestTop = 0;
                let minDiff = Infinity;
                for (const rect of dfnRects) {
                    const { top, bottom } = rect;
                    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
                    if (diffFromClickY < minDiff) {
                        minDiff = diffFromClickY;
                        closestTop = top;
                    }
                }

                const top = window.scrollY + closestTop + dfnRects[0].height;
                const left = x - MARGIN;
                panel.style.left = `${left}px`;
                panel.style.top = `${top}px`;

                // Find if the panel is flowing out of the window
                const panelRect = panel.getBoundingClientRect();
                const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
                if (panelRect.right > SCREEN_WIDTH) {
                    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
                    const newCaretOffset = left - newLeft;
                    panel.style.left = `${newLeft}px`;
                    /** @type {HTMLElement} */
                    const caret = panel.querySelector(".caret");
                    caret.style.left = `${newCaretOffset}px`;
                }

                // As it's a dialog, we trap focus.
                // TODO: when <dialog> becomes a implemented, we should really
                // use that.
                trapFocus(panel, dfn);
            }

            /**
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function trapFocus(panel, dfn) {
                /** @type NodeListOf<HTMLAnchorElement> elements */
                const anchors = panel.querySelectorAll("a[href]");
                // No need to trap focus
                if (!anchors.length) return;

                // Move focus to first anchor element
                const first = anchors.item(0);
                first.focus();

                const trapListener = createTrapListener(anchors, panel, dfn);
                panel.addEventListener("keydown", trapListener);

                // Hiding the panel releases the trap
                const mo = new MutationObserver(records => {
                    const [record] = records;
                    const target = /** @type HTMLElement */ (record.target);
                    if (target.hidden) {
                        panel.removeEventListener("keydown", trapListener);
                        mo.disconnect();
                    }
                });
                mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
            }

            /**
             *
             * @param {NodeListOf<HTMLAnchorElement>} anchors
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function createTrapListener(anchors, panel, dfn) {
                const lastIndex = anchors.length - 1;
                let currentIndex = 0;
                return event => {
                    switch (event.key) {
                        // Hitting "Tab" traps us in a nice loop around elements.
                        case "Tab": {
                            event.preventDefault();
                            currentIndex += event.shiftKey ? -1 : +1;
                            if (currentIndex < 0) {
                                currentIndex = lastIndex;
                            } else if (currentIndex > lastIndex) {
                                currentIndex = 0;
                            }
                            anchors.item(currentIndex).focus();
                            break;
                        }

                        // Hitting "Enter" on an anchor releases the trap.
                        case "Enter":
                            hidePanel(panel);
                            break;

                        // Hitting "Escape" returns focus to dfn.
                        case "Escape":
                            hidePanel(panel);
                            dfn.focus();
                            return;
                    }
                };
            }

            /** @param {HTMLElement} panel */
            function hidePanel(panel) {
                if (!panel) return;
                panel.hidden = true;
                panel.classList.remove("docked");
            }
        })()</script>
    <script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
    <script src="https://htmlspecs.com/dropdown.js"></script>
</body>

</html>