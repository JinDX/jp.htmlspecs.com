<!DOCTYPE html>
<html lang="ja-JP">

<head>
    <meta charset="utf-8">
    <meta name="generator" content="ReSpec 32.1.6">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
        span.example-title {
            text-transform: none
        }

        :is(aside, div).example,
        div.illegal-example {
            padding: .5em;
            margin: 1em 0;
            position: relative;
            clear: both
        }

        div.illegal-example {
            color: red
        }

        div.illegal-example p {
            color: #000
        }

        :is(aside, div).example {
            border-left-width: .5em;
            border-left-style: solid;
            border-color: #e0cb52;
            background: #fcfaee
        }

        aside.example div.example {
            border-left-width: .1em;
            border-color: #999;
            background: #fff
        }

        .example pre {
            background-color: rgba(0, 0, 0, .03)
        }
    </style>
    <style>
        .issue-label {
            text-transform: initial
        }

        .warning>p:first-child {
            margin-top: 0
        }

        .warning {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid
        }

        span.warning {
            padding: .1em .5em .15em
        }

        .issue.closed span.issue-number {
            text-decoration: line-through
        }

        .warning {
            border-color: #f11;
            border-width: .2em;
            border-style: solid;
            background: #fbe9e9
        }

        .warning-title:before {
            content: "⚠";
            font-size: 1.3em;
            float: left;
            padding-right: .3em;
            margin-top: -.3em
        }

        li.task-list-item {
            list-style: none
        }

        input.task-list-item-checkbox {
            margin: 0 .35em .25em -1.6em;
            vertical-align: middle
        }

        .issue a.respec-gh-label {
            padding: 5px;
            margin: 0 2px 0 2px;
            font-size: 10px;
            text-transform: none;
            text-decoration: none;
            font-weight: 700;
            border-radius: 4px;
            position: relative;
            bottom: 2px;
            border: none;
            display: inline-block
        }
    </style>
    <style>
        pre.idl {
            padding: 1em;
            position: relative
        }

        pre.idl>code {
            color: #000
        }

        @media print {
            pre.idl {
                white-space: pre-wrap
            }
        }

        .idlHeader {
            display: block;
            width: 150px;
            background: #8ccbf2;
            color: #fff;
            font-family: sans-serif;
            font-weight: 700;
            margin: -1em 0 1em -1em;
            height: 28px;
            line-height: 28px
        }

        .idlHeader a.self-link {
            margin-left: .3cm;
            text-decoration: none;
            border-bottom: none
        }

        .idlID {
            font-weight: 700;
            color: #005a9c
        }

        .idlType {
            color: #005a9c
        }

        .idlName {
            color: #ff4500
        }

        .idlName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none
        }

        a.idlEnumItem {
            color: #000;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        .idlSuperclass {
            font-style: italic;
            color: #005a9c
        }

        .idlDefaultValue,
        .idlParamName {
            font-style: italic
        }

        .extAttr {
            color: #666
        }

        .idlSectionComment {
            color: gray
        }

        .idlIncludes a {
            font-weight: 700
        }

        .respec-button-copy-paste:focus {
            text-decoration: none;
            border-color: #51a7e8;
            outline: 0;
            box-shadow: 0 0 5px rgba(81, 167, 232, .5)
        }

        .respec-button-copy-paste:is(:focus:hover, .selected:focus) {
            border-color: #51a7e8
        }

        .respec-button-copy-paste:is(:hover, :active, .zeroclipboard-is-hover, .zeroclipboard-is-active) {
            text-decoration: none;
            background-color: #ddd;
            background-image: linear-gradient(#eee, #ddd);
            border-color: #ccc
        }

        .respec-button-copy-paste:is(:active, .selected, .zeroclipboard-is-active) {
            background-color: #dcdcdc;
            background-image: none;
            border-color: #b5b5b5;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, .15)
        }

        .respec-button-copy-paste.selected:hover {
            background-color: #cfcfcf
        }

        .respec-button-copy-paste:is(:disabled, :disabled:hover, .disabled, .disabled:hover) {
            color: rgba(102, 102, 102, .5);
            cursor: default;
            background-color: rgba(229, 229, 229, .5);
            background-image: none;
            border-color: rgba(197, 197, 197, .5);
            box-shadow: none
        }

        @media print {
            .respec-button-copy-paste {
                visibility: hidden
            }
        }
    </style>
    <style>
        dfn {
            cursor: pointer
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            min-width: 300px;
            max-width: 500px;
            padding: .5em .75em;
            margin-top: .6em;
            font-family: "Helvetica Neue", sans-serif;
            font-size: small;
            background: #fff;
            color: #000;
            box-shadow: 0 1em 3em -.4em rgba(0, 0, 0, .3), 0 0 1px 1px rgba(0, 0, 0, .05);
            border-radius: 2px
        }

        .dfn-panel:not(.docked)>.caret {
            position: absolute;
            top: -9px
        }

        .dfn-panel:not(.docked)>.caret::after,
        .dfn-panel:not(.docked)>.caret::before {
            content: "";
            position: absolute;
            border: 10px solid transparent;
            border-top: 0;
            border-bottom: 10px solid #fff;
            top: 0
        }

        .dfn-panel:not(.docked)>.caret::before {
            border-bottom: 9px solid #a2a9b1
        }

        .dfn-panel * {
            margin: 0
        }

        .dfn-panel b {
            display: block;
            color: #000;
            margin-top: .25em
        }

        .dfn-panel ul a[href] {
            color: #333
        }

        .dfn-panel>div {
            display: flex
        }

        .dfn-panel a.self-link {
            font-weight: 700;
            margin-right: auto
        }

        .dfn-panel .marker {
            padding: .1em;
            margin-left: .5em;
            border-radius: .2em;
            text-align: center;
            white-space: nowrap;
            font-size: 90%;
            color: #040b1c
        }

        .dfn-panel .marker.dfn-exported {
            background: #d1edfd;
            box-shadow: 0 0 0 .125em #1ca5f940
        }

        .dfn-panel .marker.idl-block {
            background: #8ccbf2;
            box-shadow: 0 0 0 .125em #0670b161
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important
        }

        .dfn-panel a[href]:hover {
            border-bottom-width: 1px
        }

        .dfn-panel ul {
            padding: 0
        }

        .dfn-panel li {
            margin-left: 1em
        }

        .dfn-panel.docked {
            position: fixed;
            left: .5em;
            top: unset;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - .75em * 2 - .5em - .2em * 2);
            max-height: 30vh;
            overflow: auto
        }
    </style>


    <title>VirtualKeyboard API</title>



    <style id="respec-mainstyle">
        @keyframes pop {
            0% {
                transform: scale(1, 1)
            }

            25% {
                transform: scale(1.25, 1.25);
                opacity: .75
            }

            100% {
                transform: scale(1, 1)
            }
        }

        :is(h1, h2, h3, h4, h5, h6, a) abbr {
            border: none
        }

        dfn {
            font-weight: 700
        }

        a.internalDFN {
            color: inherit;
            border-bottom: 1px solid #99c;
            text-decoration: none
        }

        a.externalDFN {
            color: inherit;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        a.bibref {
            text-decoration: none
        }

        .respec-offending-element:target {
            animation: pop .25s ease-in-out 0s 1
        }

        .respec-offending-element,
        a[href].respec-offending-element {
            text-decoration: red wavy underline
        }

        @supports not (text-decoration:red wavy underline) {
            .respec-offending-element:not(pre) {
                display: inline-block
            }

            .respec-offending-element {
                background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x
            }
        }

        #references :target {
            background: #eaf3ff;
            animation: pop .4s ease-in-out 0s 1
        }

        cite .bibref {
            font-style: normal
        }

        code {
            color: #c63501
        }

        th code {
            color: inherit
        }

        a[href].orcid {
            padding-left: 4px;
            padding-right: 4px
        }

        a[href].orcid>svg {
            margin-bottom: -2px
        }

        .toc a,
        .tof a {
            text-decoration: none
        }

        a .figno,
        a .secno {
            color: #000
        }

        ol.tof,
        ul.tof {
            list-style: none outside none
        }

        .caption {
            margin-top: .5em;
            font-style: italic
        }

        table.simple {
            border-spacing: 0;
            border-collapse: collapse;
            border-bottom: 3px solid #005a9c
        }

        .simple th {
            background: #005a9c;
            color: #fff;
            padding: 3px 5px;
            text-align: left
        }

        .simple th a {
            color: #fff;
            padding: 3px 5px;
            text-align: left
        }

        .simple th[scope=row] {
            background: inherit;
            color: inherit;
            border-top: 1px solid #ddd
        }

        .simple td {
            padding: 3px 10px;
            border-top: 1px solid #ddd
        }

        .simple tr:nth-child(even) {
            background: #f0f6ff
        }

        .section dd>p:first-child {
            margin-top: 0
        }

        .section dd>p:last-child {
            margin-bottom: 0
        }

        .section dd {
            margin-bottom: 1em
        }

        .section dl.attrs dd,
        .section dl.eldef dd {
            margin-bottom: 0
        }

        #issue-summary>ul {
            column-count: 2
        }

        #issue-summary li {
            list-style: none;
            display: inline-block
        }

        details.respec-tests-details {
            margin-left: 1em;
            display: inline-block;
            vertical-align: top
        }

        details.respec-tests-details>* {
            padding-right: 2em
        }

        details.respec-tests-details[open] {
            z-index: 999999;
            position: absolute;
            border: thin solid #cad3e2;
            border-radius: .3em;
            background-color: #fff;
            padding-bottom: .5em
        }

        details.respec-tests-details[open]>summary {
            border-bottom: thin solid #cad3e2;
            padding-left: 1em;
            margin-bottom: 1em;
            line-height: 2em
        }

        details.respec-tests-details>ul {
            width: 100%;
            margin-top: -.3em
        }

        details.respec-tests-details>li {
            padding-left: 1em
        }

        .self-link:hover {
            opacity: 1;
            text-decoration: none;
            background-color: transparent
        }

        aside.example .marker>a.self-link {
            color: inherit
        }

        .header-wrapper {
            display: flex;
            align-items: baseline
        }

        :is(h2, h3, h4, h5, h6):not(#toc>h2, #abstract>h2, #sotd>h2, .head>h2) {
            position: relative;
            left: -.5em
        }

        :is(h2, h3, h4, h5, h6):not(#toch2)+a.self-link {
            color: inherit;
            order: -1;
            position: relative;
            left: -1.1em;
            font-size: 1rem;
            opacity: .5
        }

        :is(h2, h3, h4, h5, h6)+a.self-link::before {
            content: "§";
            text-decoration: none;
            color: var(--heading-text)
        }

        :is(h2, h3)+a.self-link {
            top: -.2em
        }

        :is(h4, h5, h6)+a.self-link::before {
            color: #000
        }

        @media (max-width:767px) {
            dd {
                margin-left: 0
            }
        }

        @media print {
            .removeOnSave {
                display: none
            }
        }
    </style>
    <meta name="description"
        content="バーチャルキーボード API は、著者にバーチャルキーボード (VK) の可視性をより細かく制御する機能と、VK の表示状態が変化した際にウェブページのレイアウトをより柔軟に適応させる能力を提供します。">
    <link rel="canonical" href="https://www.w3.org/TR/virtual-keyboard/">
    <style>
        .hljs {
            display: block;
            overflow-x: auto;
            padding: .5em;
            color: #383a42;
            background: #fafafa
        }

        .hljs-comment,
        .hljs-quote {
            color: #717277;
            font-style: italic
        }

        .hljs-doctag,
        .hljs-formula,
        .hljs-keyword {
            color: #a626a4
        }

        .hljs-deletion,
        .hljs-name,
        .hljs-section,
        .hljs-selector-tag,
        .hljs-subst {
            color: #ca4706;
            font-weight: 700
        }

        .hljs-literal {
            color: #0b76c5
        }

        .hljs-addition,
        .hljs-attribute,
        .hljs-meta-string,
        .hljs-regexp,
        .hljs-string {
            color: #42803c
        }

        .hljs-built_in,
        .hljs-class .hljs-title {
            color: #9a6a01
        }

        .hljs-attr,
        .hljs-number,
        .hljs-selector-attr,
        .hljs-selector-class,
        .hljs-selector-pseudo,
        .hljs-template-variable,
        .hljs-type,
        .hljs-variable {
            color: #986801
        }

        .hljs-bullet,
        .hljs-link,
        .hljs-meta,
        .hljs-selector-id,
        .hljs-symbol,
        .hljs-title {
            color: #336ae3
        }

        .hljs-emphasis {
            font-style: italic
        }

        .hljs-strong {
            font-weight: 700
        }

        .hljs-link {
            text-decoration: underline
        }
    </style>
    <style>
        var {
            position: relative;
            cursor: pointer
        }

        var[data-type]::after,
        var[data-type]::before {
            position: absolute;
            left: 50%;
            top: -6px;
            opacity: 0;
            transition: opacity .4s;
            pointer-events: none
        }

        var[data-type]::before {
            content: "";
            transform: translateX(-50%);
            border-width: 4px 6px 0 6px;
            border-style: solid;
            border-color: transparent;
            border-top-color: #000
        }

        var[data-type]::after {
            content: attr(data-type);
            transform: translateX(-50%) translateY(-100%);
            background: #000;
            text-align: center;
            font-family: "Dank Mono", "Fira Code", monospace;
            font-style: normal;
            padding: 6px;
            border-radius: 3px;
            color: #daca88;
            text-indent: 0;
            font-weight: 400
        }

        var[data-type]:hover::after,
        var[data-type]:hover::before {
            opacity: 1
        }
    </style>
    <script id="initialUserConfig" type="application/json">{
  "github": {
    "repoURL": "w3c/virtual-keyboard",
    "branch": "main"
  },
  "specStatus": "WD",
  "shortName": "virtual-keyboard",
  "editors": [
    {
      "name": "Anupam Snigdha",
      "mailto": "snianu@microsoft.com",
      "company": "Microsoft Corporation",
      "w3cid": 126950,
      "url": "mailto:snianu@microsoft.com"
    }
  ],
  "formerEditors": [
    {
      "name": "Grisha Lyukshin",
      "mailto": "glyuk@microsoft.com",
      "company": "Microsoft Corporation",
      "w3cid": 78883,
      "url": "mailto:glyuk@microsoft.com"
    }
  ],
  "wgPublicList": "public-editing-tf",
  "group": "webediting",
  "edDraftURI": "https://w3c.github.io/virtual-keyboard/",
  "previousPublishDate": "2021-09-28",
  "previousMaturity": "WD",
  "xref": [
    "WebIDL",
    "DOM",
    "HTML",
    "geometry-1"
  ],
  "publishDate": "2022-05-05",
  "publishISODate": "2022-05-05T00:00:00.000Z",
  "generatedSubtitle": "W3C Working Draft 05 May 2022"
}</script>
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD">
</head>

<body class="h-entry" data-cite="WEBIDL WebIDL DOM HTML geometry-1">
    <div class="head">
        <p class="logos"><a class="logo" href="https://www.w3.org/"><img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
            </a></p>
        <h1 id="title" class="title">VirtualKeyboard API</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types#WD">W3C 作業草案</a> <time class="dt-published"
                datetime="2022-05-05">2022年05月05日</time></p>
        <details open="">
            <summary>この文書についての詳細</summary>
            <dl>
                <dt>このバージョン：</dt>
                <dd>
                    <a class="u-url"
                        href="https://www.w3.org/TR/2022/WD-virtual-keyboard-20220505/">https://www.w3.org/TR/2022/WD-virtual-keyboard-20220505/</a>
                </dd>
                <dt>最新公開バージョン：</dt>
                <dd>
                    <a href="https://www.w3.org/TR/virtual-keyboard/">https://www.w3.org/TR/virtual-keyboard/</a>
                </dd>
                <dt>最新エディタ草案：</dt>
                <dd><a href="https://w3c.github.io/virtual-keyboard/">https://w3c.github.io/virtual-keyboard/</a></dd>
                <dt>履歴：</dt>
                <dd>
                    <a
                        href="https://www.w3.org/standards/history/virtual-keyboard">https://www.w3.org/standards/history/virtual-keyboard</a>
                </dd>
                <dd>
                    <a href="https://github.com/w3c/virtual-keyboard/commits/main">コミット履歴</a>
                </dd>
                <dt>編集者：</dt>
                <dd class="editor p-author h-card vcard" data-editor-id="126950">
                    <a class="ed_mailto u-email email p-name" href="mailto:snianu@microsoft.com">Anupam Snigdha</a>
                    (<span class="p-org org h-org">Microsoft Corporation</span>)
                </dd>
                <dt>
                    前編集者：
                </dt>
                <dd class="editor p-author h-card vcard" data-editor-id="78883">
                    <a class="ed_mailto u-email email p-name" href="mailto:glyuk@microsoft.com">Grisha Lyukshin</a>
                    (<span class="p-org org h-org">Microsoft Corporation</span>)
                </dd>
                <dt>フィードバック：</dt>
                <dd>
                    <a href="https://github.com/w3c/virtual-keyboard/">GitHub w3c/virtual-keyboard</a>
                    (<a href="https://github.com/w3c/virtual-keyboard/pulls/">プルリクエスト</a>,
                    <a href="https://github.com/w3c/virtual-keyboard/issues/new/choose">新規 issue</a>,
                    <a href="https://github.com/w3c/virtual-keyboard/issues/">オープン issue</a>)
                </dd>
                <dd><a
                        href="mailto:public-editing-tf@w3.org?subject=%5Bvirtual-keyboard%5D%20YOUR%20TOPIC%20HERE">public-editing-tf@w3.org</a>
                    件名 <kbd>[virtual-keyboard] <em>… メッセージトピック …</em></kbd> (<a rel="discussion"
                        href="https://lists.w3.org/Archives/Public/public-editing-tf">アーカイブ</a>)</dd>
            </dl>
        </details>


        <p class="copyright">
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
            ©
            2022

            <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a
                href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
            <a href="https://www.ercim.eu/"><abbr
                    title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a
                href="https://www.keio.ac.jp/">Keio</a>,
            <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
            <a rel="license" href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document"
                title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
        </p>
        <hr title="Separator for header">
    </div>
    <section id="abstract" class="introductory">
        <h2>概要</h2>
        <p>
            <a data-link-type="idl" data-lt="VirtualKeyboard" href="#dom-virtualkeyboard" class="internalDFN"
                id="ref-for-dom-virtualkeyboard-1"><code>VirtualKeyboard</code></a>
            APIは、著者にバーチャルキーボード（VK）の表示制御をより柔軟に行う機能と、VKの表示状態が変化した際にウェブページのレイアウトをより適応させる能力を提供します。
        </p>
    </section>
    <section id="sotd" class="introductory">
        <h2>この文書のステータス</h2>
        <p><em>このセクションでは、本書が公開された時点での文書のステータスについて説明します。現行標準の <abbr title="World Wide Web Consortium">W3C</abbr>
                公開文書の一覧と、この技術レポートの最新版は
                <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> 技術レポート一覧</a>
                https://www.w3.org/TR/ で確認できます。</em></p>
        <p>
        </p>
        <p>
            本書は <a href="https://www.w3.org/groups/wg/webediting">Web Editing Working Group</a> により
            <a href="https://www.w3.org/2021/Process-20211102/#recs-and-notes">勧告プロセス</a>に則って
            作業草案として公開されました。
        </p>
        <p>作業草案として公開されたことは、<abbr title="World Wide Web Consortium">W3C</abbr> およびメンバーによる支持を意味するものではありません。</p>
        <p>
            この文書はドラフトであり、今後更新、置換、廃止される可能性があります。他の文書を引用する場合は、進行中の作業としてのみ参照してください。
        </p>
        <p>
            本書は
            <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr>
                特許ポリシー</a>の下で活動するグループにより作成されています。
            <abbr title="World Wide Web Consortium">W3C</abbr> は
            <a rel="disclosure" href="https://www.w3.org/groups/wg/webediting/ipr">グループ関連公開特許情報リスト</a>
            を管理しており、そのページには特許の公開方法も記載されています。特許の実質的な請求項が含まれると考えられる特許を知っている場合は、
            <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">W3C特許ポリシー第6節</a>に従って情報を開示する必要があります。
        </p>
        <p>
            この文書は
            <a id="w3c_process_revision" href="https://www.w3.org/2021/Process-20211102/">2021年11月2日 <abbr
                    title="World Wide Web Consortium">W3C</abbr> プロセス文書</a>によって管理されています。
        </p>
    </section>
    <nav id="toc">
        <h2 class="introductory" id="table-of-contents">目次</h2>
        <ol class="toc">
            <li class="tocline"><a class="tocxref" href="#abstract">概要</a></li>
            <li class="tocline"><a class="tocxref" href="#sotd">この文書のステータス</a></li>
            <li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>はじめに</a>
            </li>
            <li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">2. </bdi>適合性</a></li>
            <li class="tocline"><a class="tocxref" href="#the-virtualkeyboard-interface"><bdi class="secno">3. </bdi>
                    <span data-export="" data-dfn-type="interface" data-idl="interface" data-title="VirtualKeyboard"
                        data-dfn-for=""><code>VirtualKeyboard</code></span> インターフェイス</a></li>
            <li class="tocline"><a class="tocxref" href="#extensions-to-the-elementcontenteditable-mixin"><bdi
                        class="secno">4. </bdi>
                    <span data-idl="interface mixin" data-title="ElementContentEditable"
                        data-dfn-for=""><code>ElementContentEditable</code></span>
                    ミックスインへの拡張</a></li>
            <li class="tocline"><a class="tocxref"
                    href="#virtual-keyboard-visibility-change-css-environment-variables"><bdi class="secno">5. </bdi>
                    バーチャルキーボード表示変更 CSS 環境変数
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#keyboard-inset-variables"><bdi class="secno">5.1
                            </bdi>キーボードインセット変数</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#examples"><bdi class="secno">6. </bdi>例</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#example-with-usage-of-vk-control-apis"><bdi
                                class="secno">6.1 </bdi>VK制御APIの利用例</a></li>
                    <li class="tocline"><a class="tocxref"
                            href="#examples-with-usage-of-overlayscontent-and-geometry-event-as-a-result-of-vk-showing"><bdi
                                class="secno">6.2 </bdi>VK表示による overlaysContent と geometry イベント利用例</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#privacy-and-security-considerations"><bdi class="secno">7.
                    </bdi>プライバシーとセキュリティに関する考慮事項</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#hide-and-show-methods"><bdi class="secno">7.1
                            </bdi><span data-link-type="idl" data-xref-type="method" data-link-for="VirtualKeyboard"
                                data-xref-for="VirtualKeyboard" data-lt="hide()"
                                class="formerLink"><code>hide</code></span><code>()</code> および <span
                                data-link-type="idl" data-xref-type="method" data-link-for="VirtualKeyboard"
                                data-xref-for="VirtualKeyboard" data-lt="show()"
                                class="formerLink"><code>show</code></span><code>()</code> メソッド</a></li>
                    <li class="tocline"><a class="tocxref"
                            href="#boundingrect-overlayscontent-and-ongeometrychange-attributes"><bdi class="secno">7.2
                            </bdi><span data-link-type="idl" data-xref-type="attribute|dict-member|const"
                                data-link-for="VirtualKeyboard" data-xref-for="VirtualKeyboard"
                                class="formerLink"><code>boundingRect</code></span>、<span data-link-type="idl"
                                data-xref-type="attribute|dict-member|const" data-link-for="VirtualKeyboard"
                                data-xref-for="VirtualKeyboard" class="formerLink"><code>overlaysContent</code></span>
                            および <span data-link-type="idl" data-xref-type="attribute|dict-member|const"
                                data-link-for="VirtualKeyboard" data-xref-for="VirtualKeyboard"
                                class="formerLink"><code>ongeometrychange</code></span> 属性</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#idl-index"><bdi class="secno">A. </bdi>IDL索引</a></li>
            <li class="tocline"><a class="tocxref" href="#contributors"><bdi class="secno">B. </bdi>貢献者</a>
            </li>
            <li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">C. </bdi>参考文献</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">C.1
                            </bdi>規範的参考文献</a></li>
                </ol>
            </li>
        </ol>
    </nav>
    <section id="introduction">
        <div class="header-wrapper">
            <h2 id="x1-introduction"><bdi class="secno">1. </bdi>はじめに</h2><a class="self-link" href="#introduction"
                aria-label="Permalink for Section 1."></a>
        </div>

        <p>このセクションは規範的ではありません。</p>
        <p>
            バーチャルキーボード（VK）は、ハードウェアキーボードが利用できない状況で入力のために使用される画面上のキーボードです。
            ユーザーエージェントは、以下の方法でVKの存在に対応しますが、この情報はウェブ開発者には公開されません：
            1. ユーザーエージェントをVKの上に再配置する
            2. VKがレイアウトビューポートを覆わないようにレイアウトビューポートのサイズを縮小する
            3. ビジュアルビューポートのサイズを縮小し、レイアウトビューポートにパディングを追加してVKの上に移動できるようにする

            このAPIは、ユーザーエージェントがレイアウトおよびビジュアルビューポートを変更せず、
            代わりにVKとレイアウトビューポートの交差情報を提供するという第4の選択肢を提供します。
            これにより、著者はJavaScriptやCSS環境変数を使ってウェブページのレイアウトを適応させることができます。

        </p>
        <p>
            デュアルスクリーンデバイス上のバーチャルキーボードの図
            <img style="margin-left:auto; margin-right:auto; display: block;"
                src="https://www.w3.org/TR/virtual-keyboard/images/dual-screen-device.png" width="500" height="200"
                alt="デュアルスクリーンデバイス上のバーチャルキーボードの図">
        </p>

        <p>
            シングルタッチスクリーンデバイス上のバーチャルキーボードの図
            <img style="margin-left:auto; margin-right:auto; display: block;"
                src="https://www.w3.org/TR/virtual-keyboard/images/single-touch-screen-device.png" width="500"
                height="200" alt="シングルタッチスクリーンデバイス上のバーチャルキーボードの図">
        </p>
        <p></p>
    </section>
    <section id="conformance">
        <div class="header-wrapper">
            <h2 id="x2-conformance"><bdi class="secno">2. </bdi>適合性</h2><a class="self-link" href="#conformance"
                aria-label="Permalink for Section 2."></a>
        </div>
        <p>非規範的と記載されているセクションだけでなく、この仕様書のすべての作成ガイドライン、図、例、および注記は非規範的です。それ以外の内容はすべて規範的です。</p>
        <p>
            この文書におけるキーワード <em class="rfc2119">MUST</em> および <em class="rfc2119">MUST NOT</em> は、
            <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119"
                    title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a
                    class="bibref" data-link-type="biblio" href="#bib-rfc8174"
                    title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
            に記載されている通り、すべて大文字で表記されている場合のみ、その意味として解釈してください。
        </p>
        <p>
            この仕様は、1つの製品に適用される適合基準を定義しています。それは、この仕様に含まれるインターフェイスを実装する
            <dfn id="dfn-user-agent" tabindex="0" aria-haspopup="dialog" class="respec-offending-element"
                title="Found definition for &quot;user agent&quot;, but nothing links to it. This is usually a spec bug!"
                data-dfn-type="dfn">ユーザーエージェント</dfn>です。
        </p>
        <p>
            アルゴリズムや特定の手順として記載された適合要件は、最終的な結果が同等である限り、どのような方法で実装しても構いません。
            （特に、この仕様で定義されているアルゴリズムは、分かりやすさを重視しており、高速であることを意図していません。）
        </p>
    </section>
    <section data-dfn-for="VirtualKeyboard" id="the-virtualkeyboard-interface">
        <div class="header-wrapper">
            <h2 id="x3-the-virtualkeyboard-interface"><bdi class="secno">3. </bdi><dfn data-export=""
                    data-dfn-type="interface" id="dom-virtualkeyboard" data-idl="interface" data-title="VirtualKeyboard"
                    data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>VirtualKeyboard</code></dfn> インターフェイス
            </h2><a class="self-link" href="#the-virtualkeyboard-interface" aria-label="Permalink for Section 3."></a>
        </div>

        <pre class="idl def" id="webidl-65390189"><span class="idlHeader"><a class="self-link" href="#webidl-65390189">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-navigator-partial-1" data-title="Navigator">partial interface <a data-idl="partial" data-link-type="interface" data-title="Navigator" class="idlID" data-dfn-for="Navigator" data-type="interface" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator">Navigator</a> {<span data-idl="" class="idlAttribute" id="idl-def-navigator-virtualkeyboard" data-title="virtualKeyboard" data-dfn-for="Navigator">
    [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject">SameObject</a></span>] readonly attribute<span class="idlType"> <a href="#dom-virtualkeyboard" class="internalDFN" data-link-type="idl" id="ref-for-dom-virtualkeyboard-2"><code>VirtualKeyboard</code></a></span> <dfn data-export="" data-dfn-type="attribute" id="dom-navigator-virtualkeyboard" data-idl="attribute" data-title="virtualKeyboard" data-dfn-for="Navigator" data-type="VirtualKeyboard" data-lt="virtualKeyboard" data-local-lt="Navigator.virtualKeyboard" class="idlName" tabindex="0" aria-haspopup="dialog"><code>virtualKeyboard</code></dfn>;</span>
};</span><span data-idl="" class="idlInterface" id="idl-def-virtualkeyboard" data-title="VirtualKeyboard">

[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>, <span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>]
interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-virtualkeyboard" id="ref-for-dom-virtualkeyboard-3"><code>VirtualKeyboard</code></a> : <span class="idlSuperclass"><a data-type="interface" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a></span> {<span data-idl="" class="idlMethod" id="idl-def-virtualkeyboard-show" data-title="show" data-dfn-for="VirtualKeyboard"><span class="idlType">
    <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-virtualkeyboard-show" id="ref-for-dom-virtualkeyboard-show-1"><code>show</code></a>();</span><span data-idl="" class="idlMethod" id="idl-def-virtualkeyboard-hide" data-title="hide" data-dfn-for="VirtualKeyboard"><span class="idlType">
    <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-virtualkeyboard-hide" id="ref-for-dom-virtualkeyboard-hide-1"><code>hide</code></a>();</span><span data-idl="" class="idlAttribute" id="idl-def-virtualkeyboard-boundingrect" data-title="boundingRect" data-dfn-for="VirtualKeyboard">
    readonly attribute<span class="idlType"> <a data-type="interface" href="https://www.w3.org/TR/geometry-1/#domrect">DOMRect</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-virtualkeyboard-boundingrect" id="ref-for-dom-virtualkeyboard-boundingrect-1"><code>boundingRect</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-virtualkeyboard-overlayscontent" data-title="overlaysContent" data-dfn-for="VirtualKeyboard">
    attribute<span class="idlType"> <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-virtualkeyboard-overlayscontent" id="ref-for-dom-virtualkeyboard-overlayscontent-1"><code>overlaysContent</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-virtualkeyboard-ongeometrychange" data-title="ongeometrychange" data-dfn-for="VirtualKeyboard">
    attribute<span class="idlType"> <a data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-virtualkeyboard-ongeometrychange" id="ref-for-dom-virtualkeyboard-ongeometrychange-1"><code>ongeometrychange</code></a>;</span>
};</span></code></pre>
        <p>
            <a data-link-type="idl" data-lt="VirtualKeyboard" href="#dom-virtualkeyboard" class="internalDFN"
                id="ref-for-dom-virtualkeyboard-4"><code>VirtualKeyboard</code></a> オブジェクトには、以下が関連付けられています：
        </p>
        <dfn data-export="" data-dfn-type="attribute" id="dom-virtualkeyboard-boundingrect" data-idl="attribute"
            data-title="boundingRect" data-dfn-for="VirtualKeyboard" data-type="DOMRect" data-lt="boundingRect"
            data-local-lt="VirtualKeyboard.boundingRect" tabindex="0"
            aria-haspopup="dialog"><code>boundingRect</code></dfn>
        <p>
            <a data-link-type="idl" data-lt="DOMRect" data-type="interface"
                href="https://www.w3.org/TR/geometry-1/#domrect"><code>DOMRect</code></a>。初期値は全て 0 です。
        </p>
        <dfn data-export="" data-dfn-type="attribute" id="dom-virtualkeyboard-overlayscontent" data-idl="attribute"
            data-title="overlaysContent" data-dfn-for="VirtualKeyboard" data-type="boolean" data-lt="overlaysContent"
            data-local-lt="VirtualKeyboard.overlaysContent" tabindex="0"
            aria-haspopup="dialog"><code>overlaysContent</code></dfn>
        <p>
            boolean型で、初期値は <code>false</code> です。この属性が <code>true</code> に設定されている場合、ユーザーエージェントは <em class="rfc2119">MUST
                NOT</em> 自身の <a data-link-type="dfn" data-type="dfn"
                href="https://dom.spec.whatwg.org/#concept-document">document</a> の <a
                href="https://drafts.csswg.org/css2/#viewport">viewport</a> または <a
                href="https://wicg.github.io/visual-viewport/#dom-visualviewport">visual viewport</a> をリサイズしてはなりません。
        </p>
        <dl>
            <dt>
                <dfn data-export="" data-dfn-type="method" id="dom-virtualkeyboard-show" data-idl="operation"
                    data-title="show()" data-dfn-for="VirtualKeyboard" data-type="undefined" data-lt="show()"
                    data-local-lt="VirtualKeyboard.show|VirtualKeyboard.show()|show" tabindex="0"
                    aria-haspopup="dialog"><code>show()</code></dfn> メソッド
            </dt>
            <dd>
                <p>
                    このメソッドは以下の手順に従うものとします：
                </p>
                <ol>
                    <li>
                        <var>window</var> を <a data-link-type="dfn" data-type="dfn"
                            href="https://webidl.spec.whatwg.org/#this">this</a> の <a data-link-type="dfn"
                            data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">関連グローバルオブジェクト</a>
                        とします。<var>window</var> が <a data-link-type="idl" data-lt="Window" data-type="interface"
                            href="https://html.spec.whatwg.org/multipage/window-object.html#window"><code>Window</code></a>
                        オブジェクトであることを確認します。
                    </li>
                    <li>
                        <var>window</var> が <a data-link-type="dfn" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/interaction.html#sticky-activation">sticky
                            activation</a> を持たない場合は、この手順を中止します。
                    </li>
                    <li>
                        フォーカスされている要素がフォームコントロール（例えば <a data-link-type="dfn" data-type="element"
                            href="https://html.spec.whatwg.org/multipage/form-elements.html#the-textarea-element">textarea</a>
                        要素の値など）でない場合や、<a data-link-type="dfn" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/interaction.html#editing-host">編集ホスト</a>
                        （例：<a
                            href="https://html.spec.whatwg.org/multipage/interaction.html#attr-contenteditable">contenteditable</a>
                        を使用）
                        でない場合、この手順を中止します。
                    </li>
                    <li>
                        <a data-link-type="idl" href="#dom-elementcontenteditable-virtualkeyboardpolicy"
                            class="internalDFN"
                            id="ref-for-dom-elementcontenteditable-virtualkeyboardpolicy-1"><code>virtualKeyboardPolicy</code></a>
                        が <a data-link-type="idl" data-lt="manual" href="#dfn-manual" class="internalDFN"
                            id="ref-for-dfn-manual-1"><code>manual</code></a> でない場合、または <a
                            href="https://html.spec.whatwg.org/multipage/interaction.html#input-modalities:-the-inputmode-attribute">inputMode</a>
                        属性値が <a
                            href="https://html.spec.whatwg.org/multipage/interaction.html#attr-inputmode-keyword-none">none</a>
                        の場合、この手順を中止します。
                    </li>
                    <li>
                        システムAPIを呼び出してVKを表示します。
                    </li>
                    <li>
                        <a data-link-type="dfn" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">並行して</a>、以下の手順を実行します：
                        <ol>
                            <li>システムによってバーチャルキーボードが表示されるのを待ちます。</li>
                            <li><a data-link-type="idl" href="#dfn-set-the-virtual-keyboard-bounding-rect"
                                    class="internalDFN"
                                    id="ref-for-dfn-set-the-virtual-keyboard-bounding-rect-1"><code>set the virtual keyboard bounding rect</code></a>
                                をキーボードのOSから報告されたバウンディング矩形と <a data-link-type="dfn" data-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-document">document</a> の <a
                                    href="https://drafts.csswg.org/css2/#viewport">viewport</a> 矩形を使って呼び出します。
                            </li>
                            <li><a data-link-type="dfn" data-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-event-fire">"geometrychange" イベント</a>を <a
                                    data-link-type="dfn" data-type="dfn"
                                    href="https://webidl.spec.whatwg.org/#this">this</a> に発火します。</li>
                        </ol>
                    </li>
                </ol>
            </dd>
            <dt>
                <dfn data-export="" data-dfn-type="method" id="dom-virtualkeyboard-hide" data-idl="operation"
                    data-title="hide()" data-dfn-for="VirtualKeyboard" data-type="undefined" data-lt="hide()"
                    data-local-lt="VirtualKeyboard.hide|VirtualKeyboard.hide()|hide" tabindex="0"
                    aria-haspopup="dialog"><code>hide()</code></dfn> メソッド
            </dt>
            <dd>
                <p>
                    このメソッドは以下の手順に従うものとします：
                </p>
                <ol>
                    <li>
                        <var>window</var> を <a data-link-type="dfn" data-type="dfn"
                            href="https://webidl.spec.whatwg.org/#this">this</a> の <a data-link-type="dfn"
                            data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">関連グローバルオブジェクト</a>
                        とします。<var>window</var> が <a data-link-type="idl" data-lt="Window" data-type="interface"
                            href="https://html.spec.whatwg.org/multipage/window-object.html#window"><code>Window</code></a>
                        オブジェクトであることを確認します。
                    </li>
                    <li>
                        <var>window</var> が <a data-link-type="dfn" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/interaction.html#sticky-activation">sticky
                            activation</a> を持たない場合は、この手順を中止します。
                    </li>
                    <li>
                        フォーカスされている要素の <a data-link-type="idl" href="#dom-elementcontenteditable-virtualkeyboardpolicy"
                            class="internalDFN"
                            id="ref-for-dom-elementcontenteditable-virtualkeyboardpolicy-2"><code>virtualKeyboardPolicy</code></a>
                        が <a data-link-type="idl" data-lt="manual" href="#dfn-manual" class="internalDFN"
                            id="ref-for-dfn-manual-2"><code>manual</code></a> でない場合、または <a
                            href="https://html.spec.whatwg.org/multipage/interaction.html#input-modalities:-the-inputmode-attribute">inputMode</a>
                        属性値が <a
                            href="https://html.spec.whatwg.org/multipage/interaction.html#attr-inputmode-keyword-none">none</a>
                        の場合、この手順を中止します。
                    </li>
                    <li>
                        システムAPIを呼び出してVKを非表示にします。
                    </li>
                    <li>
                        <a data-link-type="dfn" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">並行して</a>、以下の手順を実行します：
                        <ol>
                            <li>システムによってバーチャルキーボードが非表示になるのを待ちます。</li>
                            <li><a data-link-type="idl" href="#dfn-set-the-virtual-keyboard-bounding-rect"
                                    class="internalDFN"
                                    id="ref-for-dfn-set-the-virtual-keyboard-bounding-rect-2"><code>set the virtual keyboard bounding rect</code></a>
                                をキーボードのOSから報告されたバウンディング矩形（すべて 0 の値）と <a data-link-type="dfn" data-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-document">document</a> の <a
                                    href="https://drafts.csswg.org/css2/#viewport">viewport</a> 矩形を使って呼び出します。</li>
                            <li><a data-link-type="dfn" data-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-event-fire">"geometrychange" イベント</a>を <a
                                    data-link-type="dfn" data-type="dfn"
                                    href="https://webidl.spec.whatwg.org/#this">this</a> に発火します。</li>
                        </ol>
                    </li>
                </ol>
                <div class="note" role="note" id="issue-container-generatedID">
                    <div role="heading" class="note-title marker" id="h-note" aria-level="3"><span>注記</span></div>
                    <p class="">
                        プラットフォームのヒューリスティクスによって、VKの <a data-link-type="idl" data-lt="show()"
                            href="#dom-virtualkeyboard-show" class="internalDFN"
                            id="ref-for-dom-virtualkeyboard-show-2"><code>show</code></a><code>()</code> および <a
                            data-link-type="idl" data-lt="hide()" href="#dom-virtualkeyboard-hide" class="internalDFN"
                            id="ref-for-dom-virtualkeyboard-hide-2"><code>hide</code></a><code>()</code>
                        に追加の制限が課される場合があります。例：Windowsではポインタタイプがタッチまたはペンである必要があります。
                    </p>
                </div>
                <div class="note" role="note" id="issue-container-generatedID-0">
                    <div role="heading" class="note-title marker" id="h-note-0" aria-level="3"><span>注記</span></div>
                    <p class="">
                        <a href="https://github.com/MicrosoftEdge/MSEdgeExplainers/issues/415">懸念を示す人もいます</a>
                        <a data-link-type="idl" data-lt="show()" href="#dom-virtualkeyboard-show" class="internalDFN"
                            id="ref-for-dom-virtualkeyboard-show-3"><code>show</code></a><code>()</code> および <a
                            data-link-type="idl" data-lt="hide()" href="#dom-virtualkeyboard-hide" class="internalDFN"
                            id="ref-for-dom-virtualkeyboard-hide-3"><code>hide</code></a><code>()</code> メソッドが promise
                        ベースでないことに対してですが、VKの表示状態が変化した際に <a data-link-type="idl"
                            href="#dom-virtualkeyboard-ongeometrychange" class="internalDFN"
                            id="ref-for-dom-virtualkeyboard-ongeometrychange-2"><code>ongeometrychange</code></a>
                        イベントが発火するため、戻り値は不要であり、ウェブ開発者にとってはこの設計の方が望ましいと考えています。
                    </p>
                </div>
            </dd>
            <dt>
                <p><a data-link-type="idl" href="#dom-virtualkeyboard-overlayscontent" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-overlayscontent-2"><code>overlaysContent</code></a></p>
            </dt>
            <dd>
                <p>
                    <a data-link-type="idl" href="#dom-virtualkeyboard-overlayscontent" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-overlayscontent-3"><code>overlaysContent</code></a> の getter
                    手順は、<a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#this">this</a> の
                    <a data-link-type="idl" href="#dom-virtualkeyboard-overlayscontent" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-overlayscontent-4"><code>overlaysContent</code></a> を返します。
                </p>
                <p>
                    <a data-link-type="idl" href="#dom-virtualkeyboard-overlayscontent" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-overlayscontent-5"><code>overlaysContent</code></a> の setter
                    手順は、<a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#this">this</a> の
                    <a data-link-type="idl" href="#dom-virtualkeyboard-overlayscontent" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-overlayscontent-6"><code>overlaysContent</code></a>
                    に与えられた値を設定します。
                </p>
            </dd>
            <dt>
                <p><a data-link-type="idl" href="#dom-virtualkeyboard-boundingrect" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-boundingrect-2"><code>boundingRect</code></a></p>
            </dt>
            <dd>
                <p>
                    この属性は、VKと <a data-link-type="dfn" data-type="dfn"
                        href="https://dom.spec.whatwg.org/#concept-document">document</a> の <a
                        href="https://drafts.csswg.org/css2/#viewport">viewport</a> との交差領域をクライアント座標系で報告します。<a
                        data-link-type="idl" href="#dfn-set-the-virtual-keyboard-bounding-rect" class="internalDFN"
                        id="ref-for-dfn-set-the-virtual-keyboard-bounding-rect-3"><code>set the virtual keyboard bounding rect</code></a>
                    を呼び出してください。
                </p>
                <p>
                </p>
                <p><dfn id="dfn-set-the-virtual-keyboard-bounding-rect" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">set the virtual keyboard bounding rect</dfn></p>
                set the virtual keyboard bounding rect を、<var>osk</var>（オンスクリーンキーボードの矩形を表すDOMRect）と <var>lv</var>（<a
                    data-link-type="dfn" data-type="dfn"
                    href="https://dom.spec.whatwg.org/#concept-document">document</a> の <a
                    href="https://drafts.csswg.org/css2/#viewport">viewport</a> 矩形を表すDOMRect）を入力として実行するには、次の手順を実行します：
                <ol>
                    <li>
                        <var>osk</var> を <a data-link-type="idl" data-lt="show()" href="#dom-virtualkeyboard-show"
                            class="internalDFN"
                            id="ref-for-dom-virtualkeyboard-show-4"><code>show</code></a><code>()</code> または <a
                            data-link-type="idl" data-lt="hide()" href="#dom-virtualkeyboard-hide" class="internalDFN"
                            id="ref-for-dom-virtualkeyboard-hide-4"><code>hide</code></a><code>()</code> を <a
                            data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#this">this</a>
                        で実行した結果のオンスクリーンキーボードの矩形とします。
                    </li>
                    <li>
                        <var>lv</var> を <a data-link-type="dfn" data-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-document">document</a> の <a
                            href="https://drafts.csswg.org/css2/#viewport">viewport</a> で、<a data-link-type="idl"
                            data-lt="show()" href="#dom-virtualkeyboard-show" class="internalDFN"
                            id="ref-for-dom-virtualkeyboard-show-5"><code>show</code></a><code>()</code> または <a
                            data-link-type="idl" data-lt="hide()" href="#dom-virtualkeyboard-hide" class="internalDFN"
                            id="ref-for-dom-virtualkeyboard-hide-5"><code>hide</code></a><code>()</code> を <a
                            data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#this">this</a>
                        で実行した結果とします。
                    </li>
                    <li>
                        <var>osk</var> を <var>lv</var> の座標空間にマッピングします。
                    </li>
                    <li>
                        <var>bounds</var> を <a data-link-type="idl" data-lt="DOMRect" data-type="interface"
                            href="https://www.w3.org/TR/geometry-1/#domrect"><code>DOMRect</code></a> オブジェクトとします。
                    </li>
                    <li>
                        <var>bounds</var> を <var>lv</var> と <var>osk</var> の交差領域で更新します。
                    </li>
                    <li>
                        <var>bounds</var> を <var>lv</var> の座標空間にマッピングします。
                    </li>
                    <li>
                        <var>bounds</var> を返します。
                    </li>
                </ol>
                <p></p>
                <p></p>
                <p>
                    <a data-link-type="idl" href="#dom-virtualkeyboard-boundingrect" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-boundingrect-3"><code>boundingRect</code></a> の getter 手順は、<a
                        data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#this">this</a> の <a
                        data-link-type="idl" href="#dom-virtualkeyboard-boundingrect" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-boundingrect-4"><code>boundingRect</code></a> を返します。
                </p>
            </dd>
            <dt>
                <dfn data-export="" data-dfn-type="attribute" id="dom-virtualkeyboard-ongeometrychange"
                    data-idl="attribute" data-title="ongeometrychange" data-dfn-for="VirtualKeyboard"
                    data-type="EventHandler" data-lt="ongeometrychange" data-local-lt="VirtualKeyboard.ongeometrychange"
                    tabindex="0" aria-haspopup="dialog"><code>ongeometrychange</code></dfn>
            </dt>
            <dd>
                <p>
                    このイベントは、VKと <a data-link-type="dfn" data-type="dfn"
                        href="https://dom.spec.whatwg.org/#concept-document">document</a> の <a
                        href="https://drafts.csswg.org/css2/#viewport">viewport</a>
                    の交差領域が変更されたとき（例：VKが表示・非表示になった時やブラウザーウィンドウが再配置された時など）に発火されます。
                </p>
            </dd>
        </dl>
    </section>
    <section data-dfn-for="ElementContentEditable" id="extensions-to-the-elementcontenteditable-mixin">
        <div class="header-wrapper">
            <h2 id="x4-extensions-to-the-elementcontenteditable-mixin"><bdi class="secno">4. </bdi><dfn
                    id="dom-elementcontenteditable" data-idl="interface mixin" data-title="ElementContentEditable"
                    data-dfn-for="" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn"><code>ElementContentEditable</code></dfn> ミックスインへの拡張
            </h2><a class="self-link" href="#extensions-to-the-elementcontenteditable-mixin"
                aria-label="Permalink for Section 4."></a>
        </div>

        <pre class="idl def" id="webidl-958222361"><span class="idlHeader"><a class="self-link" href="#webidl-958222361">WebIDL</a></span><code><span data-idl="" class="idlInterface mixin" id="idl-def-elementcontenteditable-partial-1" data-title="ElementContentEditable"> partial interface mixin <a class="internalDFN idlID" data-link-type="interface" href="#dom-elementcontenteditable" id="ref-for-dom-elementcontenteditable-1"><code>ElementContentEditable</code></a> {<span data-idl="" class="idlAttribute" id="idl-def-elementcontenteditable-virtualkeyboardpolicy" data-title="virtualKeyboardPolicy" data-dfn-for="ElementContentEditable">
     [<span class="extAttr"><a data-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions">CEReactions</a></span>] attribute<span class="idlType"> <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-elementcontenteditable-virtualkeyboardpolicy" id="ref-for-dom-elementcontenteditable-virtualkeyboardpolicy-3"><code>virtualKeyboardPolicy</code></a>;</span>
};</span></code></pre>
        <div class="issue" id="issue-container-number-1">
            <div role="heading" class="issue-title marker" id="h-issue" aria-level="3"><span>Issue 1</span></div>
            <p class="">
                input と textarea のハンドリングを追加してください。
            </p>
        </div>
        <p>
            <dfn data-export="" data-dfn-type="attribute" id="dom-elementcontenteditable-virtualkeyboardpolicy"
                data-idl="attribute" data-title="virtualKeyboardPolicy" data-dfn-for="ElementContentEditable"
                data-type="DOMString" data-lt="virtualKeyboardPolicy"
                data-local-lt="ElementContentEditable.virtualKeyboardPolicy" tabindex="0"
                aria-haspopup="dialog"><code>virtualKeyboardPolicy</code></dfn> は、<a
                href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#enumerated-attribute">列挙属性</a>であり、キーワードは
            <code>空文字列</code>、<code>auto</code>、<code>manual</code> です。IDL属性は、同名のコンテンツ属性を<a
                href="https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect">反映</a>する必要があります。
            この属性が contenteditable ホストの要素に指定されている場合、<code>auto</code>
            は対応する編集可能要素がフォーカスまたはタップされたときに自動的にVKを表示し、<code>manual</code> は編集可能要素のフォーカスやタップによるVKの状態変化を切り離し、VKはそのままになります。
            <br>
            <a data-link-type="idl" href="#dom-elementcontenteditable-virtualkeyboardpolicy" class="internalDFN"
                id="ref-for-dom-elementcontenteditable-virtualkeyboardpolicy-4"><code>virtualKeyboardPolicy</code></a>
            属性値の設定変更は、現在定義されている動作を打ち消します。ただし、<code>auto</code> から <code>空文字列</code> またはその逆への変更は除きます。
        </p>
        <div class="issue" id="issue-container-number-2">
            <div role="heading" class="issue-title marker" id="h-issue-0" aria-level="3"><span>Issue 2</span></div>
            <p class="">
                フォーカスなどのイベントに対するタイミングを指定してください。
            </p>
        </div>
        <ul>
            <li>
                <dfn id="dfn-auto" tabindex="0" aria-haspopup="dialog" class="respec-offending-element"
                    title="Found definition for &quot;auto&quot;, but nothing links to it. This is usually a spec bug!"
                    data-dfn-type="dfn">auto</dfn> 列挙属性が設定されている場合、VKはブラウザーによって処理されます。
            </li>
            <li>
                <dfn id="dfn-manual" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">manual</dfn>
                列挙属性が設定されている場合、VKのデフォルト処理をブラウザーで行わず、スクリプトでハンドルする必要があります。
            </li>
            <li>
                <dfn id="dfn-empty-string" tabindex="0" aria-haspopup="dialog" class="respec-offending-element"
                    title="Found definition for &quot;empty string&quot;, but nothing links to it. This is usually a spec bug!"
                    data-dfn-type="dfn">空文字列</dfn> 列挙属性が設定されている場合、VKはブラウザーによって処理されます。
            </li>
        </ul>
        <p></p>

    </section>
    <section id="virtual-keyboard-visibility-change-css-environment-variables">
        <div class="header-wrapper">
            <h2 id="x5-virtual-keyboard-visibility-change-css-environment-variables"><bdi class="secno">5. </bdi>
                バーチャルキーボード表示変更 CSS 環境変数
            </h2><a class="self-link" href="#virtual-keyboard-visibility-change-css-environment-variables"
                aria-label="Permalink for Section 5."></a>
        </div>

        <p>
            <a data-link-type="idl" data-lt="VirtualKeyboard" href="#dom-virtualkeyboard" class="internalDFN"
                id="ref-for-dom-virtualkeyboard-5"><code>VirtualKeyboard</code></a> API
            は、ウェブ開発者がバーチャルキーボードのサイズを計算し、レイアウトを宣言的に調整できるように 6 つの新しい <a
                href="https://drafts.csswg.org/css-env-1/#environment">CSS 環境変数</a> を提案しています。
        </p>
        <div class="note" role="note" id="issue-container-generatedID-1">
            <div role="heading" class="note-title marker" id="h-note-1" aria-level="3"><span>注記</span></div>
            <p class="">
                これらの CSS env は <a href="https://drafts.csswg.org/css-env-1/#env-function">CSS env 変数仕様</a> に追加されるべきです。
            </p>
        </div>
        <section id="keyboard-inset-variables">
            <div class="header-wrapper">
                <h3 id="x5-1-keyboard-inset-variables"><bdi class="secno">5.1 </bdi>キーボードインセット変数</h3><a
                    class="self-link" href="#keyboard-inset-variables" aria-label="Permalink for Section 5.1"></a>
            </div>

            <table data-for="env()">
                <tbody>
                    <tr>
                        <th>名前
                        </th>
                        <th>値
                        </th>
                    </tr>
                    <tr>
                        <td><dfn id="dfn-keyboard-inset-top" tabindex="0" aria-haspopup="dialog"
                                class="respec-offending-element"
                                title="Found definition for &quot;keyboard-inset-top&quot;, but nothing links to it. This is usually a spec bug!"
                                data-dfn-type="dfn">keyboard-inset-top</dfn>
                        </td>
                        <td><a href="https://drafts.csswg.org/css-values-3/#length-value"> 長さ</a>
                        </td>
                    </tr>
                    <tr>
                        <td><dfn id="dfn-keyboard-inset-right" tabindex="0" aria-haspopup="dialog"
                                class="respec-offending-element"
                                title="Found definition for &quot;keyboard-inset-right&quot;, but nothing links to it. This is usually a spec bug!"
                                data-dfn-type="dfn">keyboard-inset-right</dfn>
                        </td>
                        <td><a href="https://drafts.csswg.org/css-values-3/#length-value"> 長さ</a>
                        </td>
                    </tr>
                    <tr>
                        <td><dfn id="dfn-keyboard-inset-bottom" tabindex="0" aria-haspopup="dialog"
                                class="respec-offending-element"
                                title="Found definition for &quot;keyboard-inset-bottom&quot;, but nothing links to it. This is usually a spec bug!"
                                data-dfn-type="dfn">keyboard-inset-bottom</dfn>
                        </td>
                        <td><a href="https://drafts.csswg.org/css-values-3/#length-value"> 長さ</a>
                        </td>
                    </tr>
                    <tr>
                        <td><dfn id="dfn-keyboard-inset-left" tabindex="0" aria-haspopup="dialog"
                                class="respec-offending-element"
                                title="Found definition for &quot;keyboard-inset-left&quot;, but nothing links to it. This is usually a spec bug!"
                                data-dfn-type="dfn">keyboard-inset-left</dfn>
                        </td>
                        <td><a href="https://drafts.csswg.org/css-values-3/#length-value"> 長さ</a>
                        </td>
                    </tr>
                    <tr>
                        <td><dfn id="dfn-keyboard-inset-width" tabindex="0" aria-haspopup="dialog"
                                class="respec-offending-element"
                                title="Found definition for &quot;keyboard-inset-width&quot;, but nothing links to it. This is usually a spec bug!"
                                data-dfn-type="dfn">keyboard-inset-width</dfn>
                        </td>
                        <td><a href="https://drafts.csswg.org/css-values-3/#length-value"> 長さ</a>
                        </td>
                    </tr>
                    <tr>
                        <td><dfn id="dfn-keyboard-inset-height" tabindex="0" aria-haspopup="dialog"
                                class="respec-offending-element"
                                title="Found definition for &quot;keyboard-inset-height&quot;, but nothing links to it. This is usually a spec bug!"
                                data-dfn-type="dfn">keyboard-inset-height</dfn>
                        </td>
                        <td><a href="https://drafts.csswg.org/css-values-3/#length-value"> 長さ</a>
                        </td>
                    </tr>
                </tbody>
            </table>

            <p>キーボードインセットは、ビューポート端からの top, right, bottom, left の差分で矩形を定義する 6 つの<a
                    href="https://drafts.csswg.org/css-env-1/#environment">環境変数</a>です。デフォルト値は fallback 値が指定されていなければ
                "0px" となり、<a data-link-type="idl" href="#dom-virtualkeyboard-boundingrect" class="internalDFN"
                    id="ref-for-dom-virtualkeyboard-boundingrect-5"><code>boundingRect</code></a> の値が変更されると更新されます。
                幅と高さのインセットは、他のインセット値から計算され、開発者の利便性のために提供されます。
            </p>
        </section>
    </section>
    <section id="examples">
        <div class="header-wrapper">
            <h2 id="x6-examples"><bdi class="secno">6. </bdi>例</h2><a class="self-link" href="#examples"
                aria-label="Permalink for Section 6."></a>
        </div>

        <section id="example-with-usage-of-vk-control-apis">
            <div class="header-wrapper">
                <h3 id="x6-1-example-with-usage-of-vk-control-apis"><bdi class="secno">6.1 </bdi>VK制御APIの利用例</h3><a
                    class="self-link" href="#example-with-usage-of-vk-control-apis"
                    aria-label="Permalink for Section 6.1"></a>
            </div>

            <aside class="example" id="example-virtualkeyboardpolicy">
                <div class="marker">
                    <a class="self-link" href="#example-virtualkeyboardpolicy">例<bdi> 1</bdi></a><span
                        class="example-title">: VirtualKeyboardPolicy</span>
                </div>
                <pre aria-busy="false"><code class="hljs xml">
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">contenteditable</span> <span class="hljs-attr">virtualkeyboardpolicy</span>=<span class="hljs-string">"manual"</span> <span class="hljs-attr">inputmode</span>=<span class="hljs-string">"text"</span>
<span class="hljs-attr">style</span>=<span class="hljs-string">"height:50px;width:300px;border:1px solid black;"</span><span class="hljs-attr">data-formula</span>=<span class="hljs-string">"12+30"</span>&gt;</span>42<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">let</span> div = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"div"</span>)
    div.addEventListener(<span class="hljs-string">"focusout"</span>, handleFocusOut)
    div.addEventListener(<span class="hljs-string">"dblclick"</span>, handleDblClick)

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleFocusOut</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">let</span> formula = parseIntoFormula(div.firstChild.data)
        div.setAttribute(<span class="hljs-string">"data-formula"</span>, formula)
        div.firstChild.data = evaluateFormula(formula)
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleDblClick</span>(<span class="hljs-params">e</span>) </span>{
        div.firstChild.data = div.getAttribute(<span class="hljs-string">"data-formula"</span>)

        <span class="hljs-keyword">if</span> (e.pointerType == <span class="hljs-string">"touch"</span>) {
            navigator.virtualKeyboard.show()
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseIntoFormula</span>(<span class="hljs-params">text</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"12+30"</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">evaluateFormula</span>(<span class="hljs-params">formula</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"42"</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleSuccessfulShow</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-comment">// VK表示成功時の処理</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleFailedShow</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-comment">// VK表示失敗時の処理</span>
    }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
            </aside>
        </section>
        <section id="examples-with-usage-of-overlayscontent-and-geometry-event-as-a-result-of-vk-showing">
            <div class="header-wrapper">
                <h3 id="x6-2-examples-with-usage-of-overlayscontent-and-geometry-event-as-a-result-of-vk-showing"><bdi
                        class="secno">6.2 </bdi>VK表示による overlaysContent と geometry イベント利用例</h3><a class="self-link"
                    href="#examples-with-usage-of-overlayscontent-and-geometry-event-as-a-result-of-vk-showing"
                    aria-label="Permalink for Section 6.2"></a>
            </div>

            <aside class="example" id="example-repositioning-content-using-css-with-overlayscontent">
                <div class="marker">
                    <a class="self-link" href="#example-repositioning-content-using-css-with-overlayscontent">例<bdi>
                            2</bdi></a><span class="example-title">: overlaysContent を使ったCSSでのコンテンツ再配置</span>
                </div>
                <pre aria-busy="false"><code class="hljs xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">body</span> {
            <span class="hljs-attribute">display</span>: grid;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100vh</span> - <span class="hljs-number">16px</span>);
            grid-template:
            <span class="hljs-string">"messages"</span>  <span class="hljs-number">1</span>fr
            <span class="hljs-string">"input"</span>     auto
            <span class="hljs-string">"keyboard"</span>  <span class="hljs-built_in">env</span>(keyboard-inset-height, <span class="hljs-number">0px</span>);
        }
        <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[type=text]</span><span class="hljs-selector-pseudo">::placeholder</span> {
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#444</span>;
        }
        <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[type=text]</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">4px</span> solid black;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#86DBF6</span>;
            justify-self: center;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"messages"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"type..."</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"virtualKeyboard"</span> <span class="hljs-keyword">in</span> navigator) {
            navigator.virtualKeyboard.overlaysContent = <span class="hljs-literal">true</span>
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
            </aside>
            <p>
                下図およびマークアップは、VKが表示された時にアクティブセルを再配置するキャンバスベースのスプレッドシートの例です。<code>geometrychange</code>イベントがキャンバスの描画リクエストをトリガーします。描画コードは<code>boundingRect</code>プロパティを利用してアクティブセルを適切な位置に描画します。
                <img style="margin-left:auto; margin-right:auto; display: block;"
                    src="https://www.w3.org/TR/virtual-keyboard/images/spreadsheet-example.svg" width="700" height="300"
                    alt="シングルタッチスクリーンデバイス上のバーチャルキーボードの図">
            </p>
            <aside class="example" id="example-repositioning-content-using-javascript-geometrychange">
                <div class="marker">
                    <a class="self-link" href="#example-repositioning-content-using-javascript-geometrychange">例<bdi>
                            3</bdi></a><span class="example-title">: JavaScript geometrychange を使ったコンテンツ再配置</span>
                </div>
                <pre aria-busy="false"><code class="hljs xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">body</span> {
            <span class="hljs-attribute">display</span>: grid;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
            grid-template:
            <span class="hljs-string">"controls"</span> min-content
            <span class="hljs-string">"cells"</span>    <span class="hljs-number">1</span>fr;
        }
        <span class="hljs-selector-id">#controls</span> {
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#139CFF</span>;
        }
        <span class="hljs-selector-tag">canvas</span> {
            justify-self: stretch;
            <span class="hljs-attribute">align-self</span>: stretch;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"controls"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="javascript">
        navigator.virtualKeyboard.overlaysContent = <span class="hljs-literal">true</span>

        navigator.virtualKeyboard.addEventListener(<span class="hljs-string">"geometrychange"</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-comment">// キャンバスの再描画をリクエストし、</span>
            <span class="hljs-comment">// アクティブセルをバーチャルキーボードの上に再配置します。</span>
            requestAnimationFrame(paintCanvas)
        })

        <span class="hljs-function"><span class="hljs-title">paintCanvas</span>(<span class="hljs-params"></span>)</span> {
            <span class="hljs-keyword">let</span> keyboardRect = navigator.virtualKeyboard.boundingRect
            <span class="hljs-comment">// 下記省略コードでキーボード矩形を利用してセルを</span>
            <span class="hljs-comment">// 適切な位置に描画し、ユーザーによるセル領域のパン操作も考慮します。</span>
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
            </aside>
            下図は、地図アプリケーションがマップを一つのウィンドウセグメントに、検索結果をもう一つに表示する例です。
            <a href="https://github.com/MicrosoftEdge/MSEdgeExplainers/blob/main/Foldables/explainer.md">Window
                Segments</a> とメディアクエリの提案を使い、表示された検索ボックスは、バーチャルキーボードがフォルダブルデバイスの左側に現れると、常に見えるよう下マージンを増やします。
            <img style="margin-left:auto; margin-right:auto; display: block;"
                src="https://www.w3.org/TR/virtual-keyboard/images/example.png" width="700" height="300"
                alt="シングルタッチスクリーンデバイス上のバーチャルキーボードの図">
            <aside class="example" id="example-repositioning-content-on-foldable-devices-with-overlayscontent">
                <div class="marker">
                    <a class="self-link"
                        href="#example-repositioning-content-on-foldable-devices-with-overlayscontent">例<bdi>
                            4</bdi></a><span class="example-title">: overlaysContentを使ったフォルダブルデバイス上でのコンテンツ再配置</span>
                </div>
                <pre aria-busy="false"><code class="hljs xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-keyword">@media</span> (<span class="hljs-attribute">spanning</span>: single-fold-vertical) {
            <span class="hljs-selector-tag">body</span> {
                <span class="hljs-attribute">display</span>: grid;
                <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
                <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
                grid-template-<span class="hljs-attribute">columns</span>: <span class="hljs-built_in">env</span>(fold-left) <span class="hljs-built_in">calc</span>(<span class="hljs-number">100vw</span> - <span class="hljs-built_in">env</span>(fold-right));
                grid-<span class="hljs-attribute">column-gap</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-built_in">env</span>(fold-right) - <span class="hljs-built_in">env</span>(fold-left));
            }
            <span class="hljs-selector-class">.map</span> {
                grid-column: <span class="hljs-number">1</span>;
                grid-row: <span class="hljs-number">1</span>;
            }
            <span class="hljs-selector-class">.search-box</span> {
            <span class="hljs-comment">/* マップと同じグリッド列にオーバーレイ */</span>
                grid-column: <span class="hljs-number">1</span>;
                grid-row: <span class="hljs-number">1</span>;

                <span class="hljs-comment">/* 検索ボックスをセルの下部中央に配置 */</span>
                <span class="hljs-attribute">align-self</span>: end;

                <span class="hljs-comment">/* キーボード非表示時の下マージン */</span>
                <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span>;

                <span class="hljs-comment">/* スタイル付与 */</span>
                <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
                <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24px</span>;
                <span class="hljs-attribute">border</span>: <span class="hljs-number">4px</span> solid black;
                <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
                <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#86DBF6</span>;
            }
            <span class="hljs-selector-class">.locations-list</span> {
                grid-column: <span class="hljs-number">2</span>;
                grid-row: <span class="hljs-number">1</span>;
            }

            <span class="hljs-keyword">@media</span> (env(keyboard-inset-right) &lt;= env(fold-left)) {
            <span class="hljs-comment">/* キーボードが左画面に表示された場合、検索ボックスを調整 */</span>
                <span class="hljs-selector-class">.search-box</span> {
                    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">20px</span> + <span class="hljs-built_in">env</span>(keyboard-inset-height));
                }
            }
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"map"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"search-box"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"search"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"search..."</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"locations-list"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="javascript">
        navigator.virtualKeyboard.overlaysContent = <span class="hljs-literal">true</span>
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
            </aside>
        </section>
    </section>
    <section id="privacy-and-security-considerations">
        <div class="header-wrapper">
            <h2 id="x7-privacy-and-security-considerations"><bdi class="secno">7. </bdi>プライバシーとセキュリティに関する考慮事項</h2><a
                class="self-link" href="#privacy-and-security-considerations" aria-label="Permalink for Section 7."></a>
        </div>

        VirtualKeyboard
        APIは、ユーザーのVKレイアウトに関する一部情報を明らかにする可能性があるため、ユーザーエージェントは既存APIを通じてスクリプトがすでに持っている情報以外を追加で公開しないようにしなければなりません。

        潜在的なセキュリティおよびプライバシーリスクを軽減するため、ブラウザは以下に記載されたベストプラクティスに従うことが期待されます。
        <section id="hide-and-show-methods">
            <div class="header-wrapper">
                <h3 id="x7-1-hide-and-show-methods"><bdi class="secno">7.1 </bdi><a data-link-type="idl"
                        data-lt="hide()" href="#dom-virtualkeyboard-hide" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-hide-6"><code>hide</code></a><code>()</code> および <a
                        data-link-type="idl" data-lt="show()" href="#dom-virtualkeyboard-show" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-show-6"><code>show</code></a><code>()</code> メソッド</h3><a
                    class="self-link" href="#hide-and-show-methods" aria-label="Permalink for Section 7.1"></a>
            </div>


            <p>
            </p>
            <ul>
                <li>
                    ユーザーエージェントは、<a data-link-type="idl" data-lt="hide()" href="#dom-virtualkeyboard-hide"
                        class="internalDFN" id="ref-for-dom-virtualkeyboard-hide-7"><code>hide</code></a><code>()</code>
                    および <a data-link-type="idl" data-lt="show()" href="#dom-virtualkeyboard-show" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-show-7"><code>show</code></a><code>()</code> メソッドを <a
                        href="https://w3c.github.io/webappsec-secure-contexts/">セキュアコンテキスト</a> においてのみ呼び出し可能にしなければなりません。
                </li>
                <li>
                    ユーザーエージェントは、<a data-link-type="idl" data-lt="show()" href="#dom-virtualkeyboard-show"
                        class="internalDFN" id="ref-for-dom-virtualkeyboard-show-8"><code>show</code></a><code>()</code>
                    メソッドを <a data-link-type="dfn" data-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/interaction.html#sticky-activation">sticky
                        activation</a> がある場合のみ呼び出し可能にしなければなりません。
                </li>
            </ul>
            <p></p>
        </section>
        <section id="boundingrect-overlayscontent-and-ongeometrychange-attributes">
            <div class="header-wrapper">
                <h3 id="x7-2-boundingrect-overlayscontent-and-ongeometrychange-attributes"><bdi class="secno">7.2
                    </bdi><a data-link-type="idl" href="#dom-virtualkeyboard-boundingrect" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-boundingrect-6"><code>boundingRect</code></a>、<a
                        data-link-type="idl" href="#dom-virtualkeyboard-overlayscontent" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-overlayscontent-7"><code>overlaysContent</code></a> および <a
                        data-link-type="idl" href="#dom-virtualkeyboard-ongeometrychange" class="internalDFN"
                        id="ref-for-dom-virtualkeyboard-ongeometrychange-3"><code>ongeometrychange</code></a> 属性
                </h3><a class="self-link" href="#boundingrect-overlayscontent-and-ongeometrychange-attributes"
                    aria-label="Permalink for Section 7.2"></a>
            </div>

            ユーザーエージェントは、<a data-link-type="idl" href="#dom-virtualkeyboard-overlayscontent" class="internalDFN"
                id="ref-for-dom-virtualkeyboard-overlayscontent-8"><code>overlaysContent</code></a> の設定を <a
                href="https://w3c.github.io/webappsec-secure-contexts/">セキュア</a>な <a data-link-type="dfn"
                data-type="dfn"
                href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">トップレベル閲覧コンテキスト</a>
            でのみ許可しなければなりません。
        </section>
    </section>
    <section id="idl-index" class="appendix">
        <div class="header-wrapper">
            <h2 id="a-idl-index"><bdi class="secno">A. </bdi>IDL索引</h2><a class="self-link" href="#idl-index"
                aria-label="Permalink for Appendix A."></a>
        </div>

        <pre class="idl def" id="actual-idl-index"><span class="idlHeader"><a class="self-link" href="#actual-idl-index">WebIDL</a></span><code><span data-idl="" class="idlInterface" data-title="Navigator">partial interface <a data-idl="partial" data-link-type="interface" data-title="Navigator" class="idlID" data-dfn-for="Navigator" data-type="interface" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator">Navigator</a> {<span data-idl="" class="idlAttribute" data-title="virtualKeyboard" data-dfn-for="Navigator">
    [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject">SameObject</a></span>] readonly attribute<span class="idlType"> <a href="#dom-virtualkeyboard" class="internalDFN" data-link-type="idl" id="ref-for-dom-virtualkeyboard-6"><code>VirtualKeyboard</code></a></span> <dfn data-export="" data-dfn-type="attribute" data-idl="attribute" data-title="virtualKeyboard" data-dfn-for="Navigator" data-type="VirtualKeyboard" data-lt="virtualKeyboard" data-local-lt="Navigator.virtualKeyboard" class="idlName"><code>virtualKeyboard</code></dfn>;</span>
};</span><span data-idl="" class="idlInterface" data-title="VirtualKeyboard">

[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>, <span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>]
interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-virtualkeyboard" id="ref-for-dom-virtualkeyboard-7"><code>VirtualKeyboard</code></a> : <span class="idlSuperclass"><a data-type="interface" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a></span> {<span data-idl="" class="idlMethod" data-title="show" data-dfn-for="VirtualKeyboard"><span class="idlType">
    <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-virtualkeyboard-show" id="ref-for-dom-virtualkeyboard-show-9"><code>show</code></a>();</span><span data-idl="" class="idlMethod" data-title="hide" data-dfn-for="VirtualKeyboard"><span class="idlType">
    <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-virtualkeyboard-hide" id="ref-for-dom-virtualkeyboard-hide-8"><code>hide</code></a>();</span><span data-idl="" class="idlAttribute" data-title="boundingRect" data-dfn-for="VirtualKeyboard">
    readonly attribute<span class="idlType"> <a data-type="interface" href="https://www.w3.org/TR/geometry-1/#domrect">DOMRect</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-virtualkeyboard-boundingrect" id="ref-for-dom-virtualkeyboard-boundingrect-7"><code>boundingRect</code></a>;</span><span data-idl="" class="idlAttribute" data-title="overlaysContent" data-dfn-for="VirtualKeyboard">
    attribute<span class="idlType"> <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-virtualkeyboard-overlayscontent" id="ref-for-dom-virtualkeyboard-overlayscontent-9"><code>overlaysContent</code></a>;</span><span data-idl="" class="idlAttribute" data-title="ongeometrychange" data-dfn-for="VirtualKeyboard">
    attribute<span class="idlType"> <a data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-virtualkeyboard-ongeometrychange" id="ref-for-dom-virtualkeyboard-ongeometrychange-4"><code>ongeometrychange</code></a>;</span>
};</span>

<span data-idl="" class="idlInterface mixin" data-title="ElementContentEditable"> partial interface mixin <a class="internalDFN idlID" data-link-type="interface" href="#dom-elementcontenteditable" id="ref-for-dom-elementcontenteditable-2"><code>ElementContentEditable</code></a> {<span data-idl="" class="idlAttribute" data-title="virtualKeyboardPolicy" data-dfn-for="ElementContentEditable">
     [<span class="extAttr"><a data-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions">CEReactions</a></span>] attribute<span class="idlType"> <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-elementcontenteditable-virtualkeyboardpolicy" id="ref-for-dom-elementcontenteditable-virtualkeyboardpolicy-5"><code>virtualKeyboardPolicy</code></a>;</span>
};</span></code></pre>
    </section>
    <section id="contributors">
        <div class="header-wrapper">
            <h2 id="b-contributors"><bdi class="secno">B. </bdi>貢献者</h2><a class="self-link" href="#contributors"
                aria-label="Permalink for Section B."></a>
        </div>

        <div class="note" id="issue-container-generatedID-2">
            <div role="heading" class="ednote-title marker" id="h-ednote" aria-level="3"><span>編集者注記</span>
            </div>
            <p class="">
                貢献者の追加
            </p>
        </div>
    </section>




    <section id="references" class="appendix">
        <div class="header-wrapper">
            <h2 id="c-references"><bdi class="secno">C. </bdi>参考文献</h2><a class="self-link" href="#references"
                aria-label="Permalink for Appendix C."></a>
        </div>
        <section id="normative-references">
            <div class="header-wrapper">
                <h3 id="c-1-normative-references"><bdi class="secno">C.1 </bdi>規範的参考文献</h3><a class="self-link"
                    href="#normative-references" aria-label="Permalink for Appendix C.1"></a>
            </div>

            <dl class="bibliography">
                <dt id="bib-dom">[dom]</dt>
                <dd>
                    <a href="https://dom.spec.whatwg.org/"><cite>DOM標準</cite></a>. Anne van Kesteren. WHATWG.
                    現行標準. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-geometry-1">[geometry-1]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/geometry-1/"><cite>Geometry Interfaces Module Level 1</cite></a>.
                    Simon Pieters; Chris Harrelson. W3C. 2018年12月4日. W3C勧告候補. URL: <a
                        href="https://www.w3.org/TR/geometry-1/">https://www.w3.org/TR/geometry-1/</a>
                </dd>
                <dt id="bib-html">[html]</dt>
                <dd>
                    <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML標準</cite></a>. Anne van Kesteren;
                    Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters. WHATWG. 現行標準. URL: <a
                        href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
                </dd>
                <dt id="bib-rfc2119">[RFC2119]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>RFCにおける要件レベルを示すキーワード</cite></a>. S. Bradner.
                    IETF. 1997年3月. 現行のベストプラクティス. URL: <a
                        href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
                </dd>
                <dt id="bib-rfc8174">[RFC8174]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>RFC 2119キーワードの大文字・小文字の曖昧さ</cite></a>. B.
                    Leiba. IETF. 2017年5月. 現行のベストプラクティス. URL: <a
                        href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
                </dd>
                <dt id="bib-webidl">[webidl]</dt>
                <dd>
                    <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL標準</cite></a>. Edgar Chen; Timothy Gu.
                    WHATWG. 現行標準. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
                </dd>
            </dl>
        </section>
    </section>
    <p role="navigation" id="back-to-top">
        <a href="#title"><abbr title="トップに戻る">↑</abbr></a>
    </p>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-user-agent"
        aria-label="Links in this document to definition: user agent">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-user-agent"
                aria-label="Permalink for definition: user agent. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-virtualkeyboard"
        aria-label="Links in this document to definition: VirtualKeyboard">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-virtualkeyboard"
                aria-label="Permalink for definition: VirtualKeyboard. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-65390189">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-1" title="§ Abstract">§ Abstract</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-2" title="§ 3. The VirtualKeyboard Interface">§ 3. The
                    VirtualKeyboard Interface</a> <a href="#ref-for-dom-virtualkeyboard-3" title="Reference 2">(2)</a>
                <a href="#ref-for-dom-virtualkeyboard-4" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-5"
                    title="§ 5. Virtual Keyboard Visibility Change CSS environment variables.">§ 5. Virtual Keyboard
                    Visibility Change CSS environment variables.</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-6" title="§ A. IDL Index">§ A. IDL Index</a> <a
                    href="#ref-for-dom-virtualkeyboard-7" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-navigator-virtualkeyboard"
        aria-label="Links in this document to definition: virtualKeyboard">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-navigator-virtualkeyboard"
                aria-label="Permalink for definition: virtualKeyboard. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-virtualkeyboard-boundingrect"
        aria-label="Links in this document to definition: boundingRect">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-virtualkeyboard-boundingrect"
                aria-label="Permalink for definition: boundingRect. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-65390189">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-boundingrect-1" title="§ 3. The VirtualKeyboard Interface">§ 3.
                    The VirtualKeyboard Interface</a> <a href="#ref-for-dom-virtualkeyboard-boundingrect-2"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-virtualkeyboard-boundingrect-3"
                    title="Reference 3">(3)</a> <a href="#ref-for-dom-virtualkeyboard-boundingrect-4"
                    title="Reference 4">(4)</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-boundingrect-5" title="§ 5.1 Keyboard inset variables">§ 5.1
                    Keyboard inset variables</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-boundingrect-6"
                    title="§ 7.2 boundingRect, overlaysContent and ongeometrychange attributes">§ 7.2 boundingRect,
                    overlaysContent and ongeometrychange attributes</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-boundingrect-7" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-virtualkeyboard-overlayscontent"
        aria-label="Links in this document to definition: overlaysContent">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-virtualkeyboard-overlayscontent"
                aria-label="Permalink for definition: overlaysContent. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-65390189">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-overlayscontent-1" title="§ 3. The VirtualKeyboard Interface">§ 3.
                    The VirtualKeyboard Interface</a> <a href="#ref-for-dom-virtualkeyboard-overlayscontent-2"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-virtualkeyboard-overlayscontent-3"
                    title="Reference 3">(3)</a> <a href="#ref-for-dom-virtualkeyboard-overlayscontent-4"
                    title="Reference 4">(4)</a> <a href="#ref-for-dom-virtualkeyboard-overlayscontent-5"
                    title="Reference 5">(5)</a> <a href="#ref-for-dom-virtualkeyboard-overlayscontent-6"
                    title="Reference 6">(6)</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-overlayscontent-7"
                    title="§ 7.2 boundingRect, overlaysContent and ongeometrychange attributes">§ 7.2 boundingRect,
                    overlaysContent and ongeometrychange attributes</a> <a
                    href="#ref-for-dom-virtualkeyboard-overlayscontent-8" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-overlayscontent-9" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-virtualkeyboard-show"
        aria-label="Links in this document to definition: show()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-virtualkeyboard-show"
                aria-label="Permalink for definition: show(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-65390189">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-show-1" title="§ 3. The VirtualKeyboard Interface">§ 3. The
                    VirtualKeyboard Interface</a> <a href="#ref-for-dom-virtualkeyboard-show-2"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-virtualkeyboard-show-3"
                    title="Reference 3">(3)</a> <a href="#ref-for-dom-virtualkeyboard-show-4"
                    title="Reference 4">(4)</a> <a href="#ref-for-dom-virtualkeyboard-show-5"
                    title="Reference 5">(5)</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-show-6" title="§ 7.1 hide() and show() methods">§ 7.1 hide() and
                    show() methods</a> <a href="#ref-for-dom-virtualkeyboard-show-7" title="Reference 2">(2)</a> <a
                    href="#ref-for-dom-virtualkeyboard-show-8" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-show-9" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-virtualkeyboard-hide"
        aria-label="Links in this document to definition: hide()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-virtualkeyboard-hide"
                aria-label="Permalink for definition: hide(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-65390189">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-hide-1" title="§ 3. The VirtualKeyboard Interface">§ 3. The
                    VirtualKeyboard Interface</a> <a href="#ref-for-dom-virtualkeyboard-hide-2"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-virtualkeyboard-hide-3"
                    title="Reference 3">(3)</a> <a href="#ref-for-dom-virtualkeyboard-hide-4"
                    title="Reference 4">(4)</a> <a href="#ref-for-dom-virtualkeyboard-hide-5"
                    title="Reference 5">(5)</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-hide-6" title="§ 7.1 hide() and show() methods">§ 7.1 hide() and
                    show() methods</a> <a href="#ref-for-dom-virtualkeyboard-hide-7" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-hide-8" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-set-the-virtual-keyboard-bounding-rect"
        aria-label="Links in this document to definition: set the virtual keyboard bounding rect">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-set-the-virtual-keyboard-bounding-rect"
                aria-label="Permalink for definition: set the virtual keyboard bounding rect. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-set-the-virtual-keyboard-bounding-rect-1"
                    title="§ 3. The VirtualKeyboard Interface">§ 3. The VirtualKeyboard Interface</a> <a
                    href="#ref-for-dfn-set-the-virtual-keyboard-bounding-rect-2" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-set-the-virtual-keyboard-bounding-rect-3" title="Reference 3">(3)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-virtualkeyboard-ongeometrychange"
        aria-label="Links in this document to definition: ongeometrychange">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-virtualkeyboard-ongeometrychange"
                aria-label="Permalink for definition: ongeometrychange. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-65390189">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-ongeometrychange-1" title="§ 3. The VirtualKeyboard Interface">§
                    3. The VirtualKeyboard Interface</a> <a href="#ref-for-dom-virtualkeyboard-ongeometrychange-2"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-ongeometrychange-3"
                    title="§ 7.2 boundingRect, overlaysContent and ongeometrychange attributes">§ 7.2 boundingRect,
                    overlaysContent and ongeometrychange attributes</a>
            </li>
            <li>
                <a href="#ref-for-dom-virtualkeyboard-ongeometrychange-4" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-elementcontenteditable"
        aria-label="Links in this document to definition: ElementContentEditable">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-elementcontenteditable"
                aria-label="Permalink for definition: ElementContentEditable. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-elementcontenteditable-1"
                    title="§ 4. Extensions to the ElementContentEditable mixin">§ 4. Extensions to the
                    ElementContentEditable mixin</a>
            </li>
            <li>
                <a href="#ref-for-dom-elementcontenteditable-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-elementcontenteditable-virtualkeyboardpolicy"
        aria-label="Links in this document to definition: virtualKeyboardPolicy">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-elementcontenteditable-virtualkeyboardpolicy"
                aria-label="Permalink for definition: virtualKeyboardPolicy. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-958222361">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-elementcontenteditable-virtualkeyboardpolicy-1"
                    title="§ 3. The VirtualKeyboard Interface">§ 3. The VirtualKeyboard Interface</a> <a
                    href="#ref-for-dom-elementcontenteditable-virtualkeyboardpolicy-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-elementcontenteditable-virtualkeyboardpolicy-3"
                    title="§ 4. Extensions to the ElementContentEditable mixin">§ 4. Extensions to the
                    ElementContentEditable mixin</a> <a
                    href="#ref-for-dom-elementcontenteditable-virtualkeyboardpolicy-4" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-elementcontenteditable-virtualkeyboardpolicy-5" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-auto"
        aria-label="Links in this document to definition: auto">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-auto"
                aria-label="Permalink for definition: auto. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-manual"
        aria-label="Links in this document to definition: manual">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-manual"
                aria-label="Permalink for definition: manual. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-manual-1" title="§ 3. The VirtualKeyboard Interface">§ 3. The VirtualKeyboard
                    Interface</a> <a href="#ref-for-dfn-manual-2" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-empty-string"
        aria-label="Links in this document to definition: empty string">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-empty-string"
                aria-label="Permalink for definition: empty string. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-keyboard-inset-top"
        aria-label="Links in this document to definition: keyboard-inset-top">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-keyboard-inset-top"
                aria-label="Permalink for definition: keyboard-inset-top. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-keyboard-inset-right"
        aria-label="Links in this document to definition: keyboard-inset-right">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-keyboard-inset-right"
                aria-label="Permalink for definition: keyboard-inset-right. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-keyboard-inset-bottom"
        aria-label="Links in this document to definition: keyboard-inset-bottom">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-keyboard-inset-bottom"
                aria-label="Permalink for definition: keyboard-inset-bottom. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-keyboard-inset-left"
        aria-label="Links in this document to definition: keyboard-inset-left">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-keyboard-inset-left"
                aria-label="Permalink for definition: keyboard-inset-left. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-keyboard-inset-width"
        aria-label="Links in this document to definition: keyboard-inset-width">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-keyboard-inset-width"
                aria-label="Permalink for definition: keyboard-inset-width. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-keyboard-inset-height"
        aria-label="Links in this document to definition: keyboard-inset-height">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-keyboard-inset-height"
                aria-label="Permalink for definition: keyboard-inset-height. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <script id="respec-dfn-panel">(() => {
            // @ts-check
            if (document.respec) {
                document.respec.ready.then(setupPanel);
            } else {
                setupPanel();
            }

            function setupPanel() {
                const listener = panelListener();
                document.body.addEventListener("keydown", listener);
                document.body.addEventListener("click", listener);
            }

            function panelListener() {
                /** @type {HTMLElement} */
                let panel = null;
                return event => {
                    const { target, type } = event;

                    if (!(target instanceof HTMLElement)) return;

                    // For keys, we only care about Enter key to activate the panel
                    // otherwise it's activated via a click.
                    if (type === "keydown" && event.key !== "Enter") return;

                    const action = deriveAction(event);

                    switch (action) {
                        case "show": {
                            hidePanel(panel);
                            /** @type {HTMLElement} */
                            const dfn = target.closest("dfn, .index-term");
                            panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
                            const coords = deriveCoordinates(event);
                            displayPanel(dfn, panel, coords);
                            break;
                        }
                        case "dock": {
                            panel.style.left = null;
                            panel.style.top = null;
                            panel.classList.add("docked");
                            break;
                        }
                        case "hide": {
                            hidePanel(panel);
                            panel = null;
                            break;
                        }
                    }
                };
            }

            /**
             * @param {MouseEvent|KeyboardEvent} event
             */
            function deriveCoordinates(event) {
                const target = /** @type HTMLElement */ (event.target);

                // We prevent synthetic AT clicks from putting
                // the dialog in a weird place. The AT events sometimes
                // lack coordinates, so they have clientX/Y = 0
                const rect = target.getBoundingClientRect();
                if (
                    event instanceof MouseEvent &&
                    event.clientX >= rect.left &&
                    event.clientY >= rect.top
                ) {
                    // The event probably happened inside the bounding rect...
                    return { x: event.clientX, y: event.clientY };
                }

                // Offset to the middle of the element
                const x = rect.x + rect.width / 2;
                // Placed at the bottom of the element
                const y = rect.y + rect.height;
                return { x, y };
            }

            /**
             * @param {Event} event
             */
            function deriveAction(event) {
                const target = /** @type {HTMLElement} */ (event.target);
                const hitALink = !!target.closest("a");
                if (target.closest("dfn:not([data-cite]), .index-term")) {
                    return hitALink ? "none" : "show";
                }
                if (target.closest(".dfn-panel")) {
                    if (hitALink) {
                        return target.classList.contains("self-link") ? "hide" : "dock";
                    }
                    const panel = target.closest(".dfn-panel");
                    return panel.classList.contains("docked") ? "hide" : "none";
                }
                if (document.querySelector(".dfn-panel:not([hidden])")) {
                    return "hide";
                }
                return "none";
            }

            /**
             * @param {HTMLElement} dfn
             * @param {HTMLElement} panel
             * @param {{ x: number, y: number }} clickPosition
             */
            function displayPanel(dfn, panel, { x, y }) {
                panel.hidden = false;
                // distance (px) between edge of panel and the pointing triangle (caret)
                const MARGIN = 20;

                const dfnRects = dfn.getClientRects();
                // Find the `top` offset when the `dfn` can be spread across multiple lines
                let closestTop = 0;
                let minDiff = Infinity;
                for (const rect of dfnRects) {
                    const { top, bottom } = rect;
                    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
                    if (diffFromClickY < minDiff) {
                        minDiff = diffFromClickY;
                        closestTop = top;
                    }
                }

                const top = window.scrollY + closestTop + dfnRects[0].height;
                const left = x - MARGIN;
                panel.style.left = `${left}px`;
                panel.style.top = `${top}px`;

                // Find if the panel is flowing out of the window
                const panelRect = panel.getBoundingClientRect();
                const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
                if (panelRect.right > SCREEN_WIDTH) {
                    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
                    const newCaretOffset = left - newLeft;
                    panel.style.left = `${newLeft}px`;
                    /** @type {HTMLElement} */
                    const caret = panel.querySelector(".caret");
                    caret.style.left = `${newCaretOffset}px`;
                }

                // As it's a dialog, we trap focus.
                // TODO: when <dialog> becomes a implemented, we should really
                // use that.
                trapFocus(panel, dfn);
            }

            /**
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function trapFocus(panel, dfn) {
                /** @type NodeListOf<HTMLAnchorElement> elements */
                const anchors = panel.querySelectorAll("a[href]");
                // No need to trap focus
                if (!anchors.length) return;

                // Move focus to first anchor element
                const first = anchors.item(0);
                first.focus();

                const trapListener = createTrapListener(anchors, panel, dfn);
                panel.addEventListener("keydown", trapListener);

                // Hiding the panel releases the trap
                const mo = new MutationObserver(records => {
                    const [record] = records;
                    const target = /** @type HTMLElement */ (record.target);
                    if (target.hidden) {
                        panel.removeEventListener("keydown", trapListener);
                        mo.disconnect();
                    }
                });
                mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
            }

            /**
             *
             * @param {NodeListOf<HTMLAnchorElement>} anchors
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function createTrapListener(anchors, panel, dfn) {
                const lastIndex = anchors.length - 1;
                let currentIndex = 0;
                return event => {
                    switch (event.key) {
                        // Hitting "Tab" traps us in a nice loop around elements.
                        case "Tab": {
                            event.preventDefault();
                            currentIndex += event.shiftKey ? -1 : +1;
                            if (currentIndex < 0) {
                                currentIndex = lastIndex;
                            } else if (currentIndex > lastIndex) {
                                currentIndex = 0;
                            }
                            anchors.item(currentIndex).focus();
                            break;
                        }

                        // Hitting "Enter" on an anchor releases the trap.
                        case "Enter":
                            hidePanel(panel);
                            break;

                        // Hitting "Escape" returns focus to dfn.
                        case "Escape":
                            hidePanel(panel);
                            dfn.focus();
                            return;
                    }
                };
            }

            /** @param {HTMLElement} panel */
            function hidePanel(panel) {
                if (!panel) return;
                panel.hidden = true;
                panel.classList.remove("docked");
            }
        })()</script>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <script src="https://htmlspecs.com/dropdown.js"></script>
</body>

</html>