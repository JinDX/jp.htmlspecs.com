<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="ja-JP">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>RFC 9421 - HTTP メッセージ署名</title>
    <script>
        function getMeta(rfcno, container) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://www.rfc-editor.org/rfc/rfc" + rfcno + ".json", true);
            xhr.onload = function (e) {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        var data = JSON.parse(xhr.response);

                        var cont = document.getElementById(container);
                        // empty the container
                        while (cont.firstChild) {
                            cont.removeChild(myNode.firstChild);
                        }

                        var c = data.status;
                        if (c) {
                            var bld = newElementWithText("b", c);
                            cont.appendChild(bld);
                        } else {
                            cont.appendChild(newElementWithText("i", "(document status unknown)"));
                        }

                        c = data.updated_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Updated by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.obsoleted_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Obsoleted by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.errata_url;
                        if (c) {
                            cont.appendChild(newElement("br"));
                            var link = newElementWithText("a", "errata");
                            link.setAttribute("href", c);
                            var errata = newElementWithText("i", "This document has ");
                            errata.appendChild(link);
                            errata.appendChild(newText("."));
                            cont.appendChild(errata);
                        }

                        cont.style.display = "block";
                    } else {
                        console.error(xhr.statusText);
                    }
                }
            };
            xhr.onerror = function (e) {
                console.error(xhr.status + " " + xhr.statusText);
            };
            xhr.send(null);
        }
        function appendRfcLinks(parent, updates) {
            var template = "https://www.rfc-editor.org/rfc/rfc{rfc}.html";
            for (var i = 0; i < updates.length; i++) {
                var rfc = updates[i].trim().toLowerCase();
                if (rfc.substring(0, 3) == "rfc") {
                    var no = parseInt(rfc.substring(3), 10);

                    var link = newElement("a");
                    link.setAttribute("href", template.replace("{rfc}", no));
                    link.appendChild(newText(no));
                    parent.appendChild(link);
                } else {
                    parent.appendChild(newText(rfc));
                }
                if (i != updates.length - 1) {
                    parent.appendChild(newText(", "));
                }
            }
        }

        // DOM helpers
        function newElement(name) {
            return document.createElement(name);
        }
        function newElementWithText(name, txt) {
            var e = document.createElement(name);
            e.appendChild(newText(txt));
            return e;
        }
        function newText(text) {
            return document.createTextNode(text);
        }
    </script>
    <script>
        function anchorRewrite() {
            map = {};
            if (window.location.hash.length >= 1) {
                var fragid = window.location.hash.substr(1);
                if (fragid) {
                    if (!document.getElementById(fragid)) {
                        var prefix = "rfc.";
                        var mapped = map[fragid];
                        if (mapped) {
                            window.location.hash = mapped;
                        } else if (fragid.indexOf("section-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(8).replace("-", ".p.");
                        } else if (fragid.indexOf("appendix-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(9).replace("-", ".p.");
                        } else if (fragid.indexOf("s-") == 0) {
                            var postfix = fragid.substring(2);
                            if (postfix.startsWith("abstract")) {
                                window.location.hash = prefix + postfix;
                            } else if (postfix.startsWith("note-")) {
                                window.location.hash = prefix + "note." + postfix.substring(5).replace("-", ".p.");
                            } else {
                                window.location.hash = prefix + "section." + postfix.replace("-", ".p.");
                            }
                        } else if (fragid.indexOf("p-") == 0) {
                            var r = fragid.substring(2);
                            var p = r.indexOf("-");
                            if (p >= 0) {
                                window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
                            }
                        }
                    }
                }
            }
        }
        window.addEventListener('hashchange', anchorRewrite);
        window.addEventListener('DOMContentLoaded', anchorRewrite);
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:type" content="article">
    <meta property="og:title" content="RFC9421">
    <meta property="og:description" content="HTTP Message Signatures">
    <meta property="og:url" content="https://httpwg.org/specs/rfc9421.html">
    <meta property="og:site_name" content="IETF HTTP Working Group Specifications">
    <meta property="og:image" content="https://httpwg.org/assets/favicon/apple-icon-180x180.png">
    <link rel="stylesheet" type="text/css"
        href="https://httpwg.org/assets/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <style type="text/css">
        body {
            padding-top: 80px;
            padding-bottom: 80px;
            position: relative;
        }

        .table.header th,
        .table.header td {
            border-top: none;
            padding: 0;
        }

        #sidebar {
            margin-top: -10px;
            height: 90%;
            overflow-y: auto;
            font-size: 90%;
        }

        #rfc\.meta {
            width: 40%;
            float: right
        }

        .toc ul {
            list-style: none;
        }

        .filename {
            color: rgb(119, 119, 119);
            font-size: 23px;
            font-weight: normal;
            height: auto;
            line-height: 23px;
        }

        dl {
            margin-left: 1em;
        }

        dl.dl-horizontal {
            margin-left: 0;
        }

        dl>dt {
            float: left;
            margin-right: 1em;
        }

        dl.nohang>dt {
            float: none;
        }

        dl>dd {
            margin-bottom: .5em;
        }

        dl.compact>dd {
            margin-bottom: 0em;
        }

        dl>dd>dl {
            margin-top: 0.5em;
            margin-bottom: 0em;
        }

        ul.empty {
            list-style-type: none;
        }

        ul.empty li {
            margin-top: .5em;
        }

        td.reference {
            padding-right: 1em;
            vertical-align: top;
        }

        .feedback {
            position: fixed;
            bottom: 5px;
            right: 5px;
        }

        .fbbutton {
            margin-left: 5px;
        }

        h1 a,
        h2 a,
        h3 a,
        h4 a,
        h5 a,
        h6 a {
            color: rgb(51, 51, 51);
        }

        span.tt {
            font: 11pt consolas, monospace;
            font-size-adjust: none;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="https://httpwg.org/assets/site.css">
    <link rel="Contents" href="#rfc.toc">
    <link rel="Author" href="#rfc.authors">
    <link rel="License" href="#rfc.copyrightnotice">
    <link rel="Chapter" title="1 Introduction" href="#rfc.section.1">
    <link rel="Chapter" title="2 HTTP Message Components" href="#rfc.section.2">
    <link rel="Chapter" title="3 HTTP Message Signatures" href="#rfc.section.3">
    <link rel="Chapter" title="4 Including a Message Signature in a Message" href="#rfc.section.4">
    <link rel="Chapter" title="5 Requesting Signatures" href="#rfc.section.5">
    <link rel="Chapter" title="6 IANA Considerations" href="#rfc.section.6">
    <link rel="Chapter" title="7 Security Considerations" href="#rfc.section.7">
    <link rel="Chapter" title="8 Privacy Considerations" href="#rfc.section.8">
    <link rel="Chapter" title="9 References" href="#rfc.section.9">
    <link rel="Appendix" title="A Detecting HTTP Message Signatures" href="#rfc.section.A">
    <link rel="Appendix" title="B Examples" href="#rfc.section.B">
    <link rel="Appendix" title="Acknowledgements" href="#rfc.section.unnumbered-4">
    <link href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-message-signatures-19" rel="prev">
    <link href="https://dx.doi.org/10.17487/rfc9421" rel="alternate">
    <link href="urn:issn:2070-1721" rel="alternate">
    <link rel="Alternate" title="Plain Text Version" href="http://www.ietf.org/rfc/rfc9421.txt">
    <link rel="Help" title="RFC-Editor's Status Page" href="https://www.rfc-editor.org/info/rfc9421">
    <meta name="viewport" content="initial-scale=1">
    <meta name="generator"
        content="https://github.com/mnot/RFCBootstrap XSLT vendor: Saxonica http://www.saxonica.com/">
    <meta name="keywords" content="PKI">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.creator" content="Backman, A.">
    <meta name="dcterms.creator" content="Richer, J.">
    <meta name="dcterms.creator" content="Sporny, M.">
    <meta name="dcterms.identifier" content="urn:ietf:rfc:9421">
    <meta name="dcterms.issued" content="2024-02">
    <meta name="dcterms.abstract"
        content="This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over components of an HTTP message. This mechanism supports use cases where the full HTTP message may not be known to the signer and where the message may be transformed (e.g., by intermediaries) before reaching the verifier. This document also describes a means for requesting that a signature be applied to a subsequent HTTP message in an ongoing HTTP exchange.">
    <meta name="dcterms.isPartOf" content="urn:issn:2070-1721">
    <meta name="description"
        content="This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over components of an HTTP message. This mechanism supports use cases where the full HTTP message may not be known to the signer and where the message may be transformed (e.g., by intermediaries) before reaching the verifier. This document also describes a means for requesting that a signature be applied to a subsequent HTTP message in an ongoing HTTP exchange.">
</head>

<body onload="getMeta(9421,'rfc.meta');">
    <nav class="navbar navbar-dark bg-dark d-print-none navbar-expand-lg fixed-top ps-3 pe-3" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse"
                aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <a class="navbar-brand" href="https://httpwg.org/"><img src="https://httpwg.org/assets/http.svg"
                    height="23"></a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse">

            <div class="navbar-nav me-auto">

                <a class="nav-item ms-1 text-white" href="https://httpwg.org/specs/">📄 Documentation</a>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Work in
                        Progress</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/http-extensions/">HTTP Extensions</a></li>
                        <li class="dropdown-item"><a
                                href="https://github.com/httpwg/admin/issues?q=is%3Aissue+is%3Aopen+label%3Aadoption">Future
                                Work</a></li>
                    </ul>
                </div>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Participate</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/about/">About the HTTP Working Group</a>
                        </li>
                        <li class="divider"></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/CONTRIBUTING.html">Contribution Policy</a>
                        </li>
                        <li class="dropdown-item"><a href="http://datatracker.ietf.org/wg/httpbis/charter/">WG
                                Charter</a></li>
                        <li class="dropdown-item"><a href="http://lists.w3.org/Archives/Public/ietf-http-wg/">Group
                                Mailing List 📨</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/wg-materials/">Meeting Materials</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/admin/editors/">Document Editor
                                Resources</a></li>
                    </ul>
                </div>
            </div>

        </div>
    </nav>
    <div class="container" id="top">
        <div class="row">
            <div class="col-lg-4 order-last d-none d-lg-block" id="sidebar" role="navigation">
                <div class="navbar">
                    <div class="navbar-brand"><a href="#top"><strong>RFC </strong>9421</a></div><br clear="all">
                    <div class="">
                        <div class="toc ">
                            <ul>
                                <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#intro">導入</a>
                                    <ul>
                                        <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#definitions">慣習と用語</a></li>
                                        <li><a href="#rfc.section.1.2">1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#requirements">要件</a></li>
                                        <li><a href="#rfc.section.1.3">1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#transforms">HTTP メッセージ変換</a></li>
                                        <li><a href="#rfc.section.1.4">1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#application">HTTP メッセージ署名の適用</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#covered-components">HTTP
                                        メッセージ構成要素</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-fields">HTTP フィールド</a>
                                            <ul>
                                                <li><a href="#rfc.section.2.1.1">2.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#http-field-structured">HTTP 構造化フィールドの厳密な直列化</a></li>
                                                <li><a href="#rfc.section.2.1.2">2.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#http-field-dictionary">辞書型構造化フィールドのメンバー</a></li>
                                                <li><a href="#rfc.section.2.1.3">2.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#http-field-byte-sequence">バイナリでラップされた HTTP フィールド</a>
                                                </li>
                                                <li><a href="#rfc.section.2.1.4">2.1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#http-trailer">トレーラーフィールド</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#derived-components">導出コンポーネント</a>
                                            <ul>
                                                <li><a href="#rfc.section.2.2.1">2.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-method">メソッド</a></li>
                                                <li><a href="#rfc.section.2.2.2">2.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-target-uri">ターゲット URI</a></li>
                                                <li><a href="#rfc.section.2.2.3">2.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-authority">オーソリティ</a></li>
                                                <li><a href="#rfc.section.2.2.4">2.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-scheme">スキーム</a></li>
                                                <li><a href="#rfc.section.2.2.5">2.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-target">リクエストターゲット</a></li>
                                                <li><a href="#rfc.section.2.2.6">2.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-path">パス</a></li>
                                                <li><a href="#rfc.section.2.2.7">2.2.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-query">クエリ</a></li>
                                                <li><a href="#rfc.section.2.2.8">2.2.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-query-param">クエリパラメータ</a></li>
                                                <li><a href="#rfc.section.2.2.9">2.2.9.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-status-code">ステータスコード</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.2.3">2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signature-params">署名パラメータ</a></li>
                                        <li><a href="#rfc.section.2.4">2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-response">レスポンスメッセージ内でのリクエスト構成要素の署名</a></li>
                                        <li><a href="#rfc.section.2.5">2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#create-sig-input">署名ベースの作成</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#message-signatures">HTTP
                                        メッセージ署名</a>
                                    <ul>
                                        <li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#sign">署名の作成</a></li>
                                        <li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#verify">署名の検証</a>
                                            <ul>
                                                <li><a href="#rfc.section.3.2.1">3.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#verify-requirements">アプリケーション要件の強制</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.3.3">3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signature-methods">署名アルゴリズム</a>
                                            <ul>
                                                <li><a href="#rfc.section.3.3.1">3.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-rsa-pss-sha512">RSASSA-PSS（SHA-512 使用）</a></li>
                                                <li><a href="#rfc.section.3.3.2">3.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-rsa-v1_5-sha256">RSASSA-PKCS1-v1_5（SHA-256 使用）</a>
                                                </li>
                                                <li><a href="#rfc.section.3.3.3">3.3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-hmac-sha256">HMAC（SHA-256 使用）</a></li>
                                                <li><a href="#rfc.section.3.3.4">3.3.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-ecdsa-p256-sha256">ECDSA（Curve P-256 と SHA-256
                                                        使用）</a></li>
                                                <li><a href="#rfc.section.3.3.5">3.3.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-ecdsa-p384-sha384">ECDSA（Curve P-384 と SHA-384
                                                        使用）</a></li>
                                                <li><a href="#rfc.section.3.3.6">3.3.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-ed25519">EdDSA（edwards25519）</a></li>
                                                <li><a href="#rfc.section.3.3.7">3.3.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-jose">JSON Web Signature (JWS) アルゴリズム</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#attach-signature">メッセージへの署名の付与</a>
                                    <ul>
                                        <li><a href="#rfc.section.4.1">4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signature-input-header">Signature-Input HTTP フィールド</a></li>
                                        <li><a href="#rfc.section.4.2">4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signature-header">Signature HTTP フィールド</a></li>
                                        <li><a href="#rfc.section.4.3">4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signature-multiple">複数署名</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#request-signature">署名の要求</a>
                                    <ul>
                                        <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#accept-signature-header">Accept-Signature フィールド</a></li>
                                        <li><a href="#rfc.section.5.2">5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#processing-an-accept-signature">Accept-Signature の処理</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#iana">IANA
                                        考慮事項</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-field-name-registration">HTTP フィールド名登録</a>
                                        </li>
                                        <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#hsa-registry">HTTP 署名アルゴリズム登録</a>
                                            <ul>
                                                <li><a href="#rfc.section.6.2.1">6.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-hsa-template">登録テンプレート</a></li>
                                                <li><a href="#rfc.section.6.2.2">6.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-hsa-contents">初期内容</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.6.3">6.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#param-registry">HTTP 署名メタデータパラメータ登録</a>
                                            <ul>
                                                <li><a href="#rfc.section.6.3.1">6.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-param-template">登録テンプレート</a></li>
                                                <li><a href="#rfc.section.6.3.2">6.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-param-contents">初期内容</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.6.4">6.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-registry">HTTP 署名導出コンポーネント名登録</a>
                                            <ul>
                                                <li><a href="#rfc.section.6.4.1">6.4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-content-template">登録テンプレート</a></li>
                                                <li><a href="#rfc.section.6.4.2">6.4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-content-contents">初期内容</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.6.5">6.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#component-param-registry">HTTP 署名コンポーネントパラメータ登録</a>
                                            <ul>
                                                <li><a href="#rfc.section.6.5.1">6.5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-component-param-template">登録テンプレート</a>
                                                </li>
                                                <li><a href="#rfc.section.6.5.2">6.5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-component-param-contents">初期内容</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#security">セキュリティ上の考慮事項</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.1">7.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#general-considerations">一般的な考慮事項</a>
                                            <ul>
                                                <li><a href="#rfc.section.7.1.1">7.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-ignore">署名検証のスキップ</a></li>
                                                <li><a href="#rfc.section.7.1.2">7.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-tls">TLS の使用</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.7.2">7.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#message-processing-and-selection">メッセージ処理と選択</a>
                                            <ul>
                                                <li><a href="#rfc.section.7.2.1">7.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-coverage">不十分なカバレッジ</a></li>
                                                <li><a href="#rfc.section.7.2.2">7.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-replay">署名のリプレイ</a></li>
                                                <li><a href="#rfc.section.7.2.3">7.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-components">メッセージコンポーネントの選択</a></li>
                                                <li><a href="#rfc.section.7.2.4">7.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-not-fields">HTTP
                                                        フィールドではなく署名パラメータや導出コンポーネントを選ぶこと</a></li>
                                                <li><a href="#rfc.section.7.2.5">7.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-labels">署名ラベル</a></li>
                                                <li><a href="#rfc.section.7.2.6">7.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-multiple">複数署名による混乱</a></li>
                                                <li><a href="#rfc.section.7.2.7">7.2.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-signature-tag">アプリケーション固有署名タグの衝突</a></li>
                                                <li><a href="#rfc.section.7.2.8">7.2.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-message-content">メッセージ内容</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.7.3">7.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#cryptographic-considerations">暗号学的考慮事項</a>
                                            <ul>
                                                <li><a href="#rfc.section.7.3.1">7.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-collision">暗号と署名衝突</a></li>
                                                <li><a href="#rfc.section.7.3.2">7.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-keys">鍵の窃取</a></li>
                                                <li><a href="#rfc.section.7.3.3">7.3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-symmetric">対称暗号</a></li>
                                                <li><a href="#rfc.section.7.3.4">7.3.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-keymixup">鍵仕様の取り違え</a></li>
                                                <li><a href="#rfc.section.7.3.5">7.3.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-nondeterministic">非決定論的署名プリミティブ</a></li>
                                                <li><a href="#rfc.section.7.3.6">7.3.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-keydowngrade">鍵・アルゴリズム仕様のダウングレード</a></li>
                                                <li><a href="#rfc.section.7.3.7">7.3.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-sign-signature">署名値の二重署名</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.7.4">7.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#matching-covered-components-to-message">署名パラメータと対象メッセージの照合</a>
                                            <ul>
                                                <li><a href="#rfc.section.7.4.1">7.4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-modify">必要なメッセージパラメータの変更</a></li>
                                                <li><a href="#rfc.section.7.4.2">7.4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-mismatch">カバーされたコンポーネントの値と対象メッセージ内の値の一致</a></li>
                                                <li><a href="#rfc.section.7.4.3">7.4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-message-component-context">メッセージコンポーネントの出所と文脈</a>
                                                </li>
                                                <li><a href="#rfc.section.7.4.4">7.4.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-context-multiple-signatures">複数のメッセージコンポーネント文脈</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.7.5">7.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-processing">HTTP 処理</a>
                                            <ul>
                                                <li><a href="#rfc.section.7.5.1">7.5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-lazy-header-parser">派生コンポーネント名としての無効な HTTP
                                                        フィールド名の処理</a></li>
                                                <li><a href="#rfc.section.7.5.2">7.5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-field-values">意味的に等価なフィールド値</a></li>
                                                <li><a href="#rfc.section.7.5.3">7.5.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-structured">構造化フィールド値の解析</a>
                                                </li>
                                                <li><a href="#rfc.section.7.5.4">7.5.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-versions">HTTP バージョンとコンポーネントの曖昧性</a></li>
                                                <li><a href="#rfc.section.7.5.5">7.5.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-canonicalization">正規化攻撃</a>
                                                </li>
                                                <li><a href="#rfc.section.7.5.6">7.5.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-non-list">非リスト型フィールド値</a></li>
                                                <li><a href="#rfc.section.7.5.7">7.5.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-multiple-fields">複数フィールド値によるパディング攻撃</a></li>
                                                <li><a href="#rfc.section.7.5.8">7.5.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-query-elements">クエリ要素の曖昧な処理</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#privacy">プライバシーに関する考慮事項</a>
                                    <ul>
                                        <li><a href="#rfc.section.8.1">8.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#privacy-identify-keys">鍵による識別</a></li>
                                        <li><a href="#rfc.section.8.2">8.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#privacy-confidentiality">署名は機密性を提供しない</a></li>
                                        <li><a href="#rfc.section.8.3">8.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#privacy-oracle">オラクル</a></li>
                                        <li><a href="#rfc.section.8.4">8.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#privacy-required">必要なコンテンツ</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.9">9.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">参考文献</a>
                                    <ul>
                                        <li><a href="#rfc.section.9.1">9.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.2">ノルマティブ参考文献</a></li>
                                        <li><a href="#rfc.section.9.2">9.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.3">インフォマティブ参考文献</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.A">Appendix A.</a>&nbsp;&nbsp;&nbsp;<a href="#detection">HTTP
                                        メッセージ署名の検出</a></li>
                                <li><a href="#rfc.section.B">Appendix B.</a>&nbsp;&nbsp;&nbsp;<a href="#examples">例</a>
                                    <ul>
                                        <li><a href="#rfc.section.B.1">B.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-keys">サンプル鍵</a>
                                            <ul>
                                                <li><a href="#rfc.section.B.1.1">B.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#example-key-rsa-test">サンプル RSA 鍵</a></li>
                                                <li><a href="#rfc.section.B.1.2">B.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#example-key-rsa-pss-test">サンプル RSA-PSS 鍵</a></li>
                                                <li><a href="#rfc.section.B.1.3">B.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#example-key-ecc-p256">サンプル ECC P-256 テスト鍵</a></li>
                                                <li><a href="#rfc.section.B.1.4">B.1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#example-key-ed25519">サンプル Ed25519 テスト鍵</a></li>
                                                <li><a href="#rfc.section.B.1.5">B.1.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#example-shared-secret">サンプル共有秘密</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.B.2">B.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#test-cases">テストケース</a>
                                            <ul>
                                                <li><a href="#rfc.section.B.2.1">B.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#minimal-signature-using-rsa-pss-sha512">rsa-pss-sha512
                                                        を使用した最小署名</a></li>
                                                <li><a href="#rfc.section.B.2.2">B.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#selective-covered-components-using-rsa-pss-sha512">rsa-pss-sha512
                                                        を使用した選択的カバーコンポーネント</a></li>
                                                <li><a href="#rfc.section.B.2.3">B.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#full-coverage-using-rsa-pss-sha512">rsa-pss-sha512
                                                        を使用した完全カバレッジ</a></li>
                                                <li><a href="#rfc.section.B.2.4">B.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#signing-a-response-using-ecdsa-p256-sha256">ecdsa-p256-sha256
                                                        を使ったレスポンスの署名</a></li>
                                                <li><a href="#rfc.section.B.2.5">B.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#signing-a-request-using-hmac-sha256">hmac-sha256
                                                        を使ったリクエストの署名</a></li>
                                                <li><a href="#rfc.section.B.2.6">B.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#signing-a-request-using-ed25519">ed25519 を使ったリクエストの署名</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.B.3">B.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#tls-terminating-proxies">TLS 終端プロキシ</a></li>
                                        <li><a href="#rfc.section.B.4">B.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-transform">HTTP メッセージ変換の例</a></li>
                                    </ul>
                                </li>
                                <li><a href="#acknowledgements">謝辞</a></li>
                                <li><a href="#rfc.authors">著者の連絡先</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8 order-first main" role="main">
                <header>
                    <table class="table table-condensed header" id="rfc.headerblock">
                        <tbody>
                            <tr>
                                <td class="text-left">インターネット技術タスクフォース (IETF)</td>
                                <td class="text-right">A. Backman, Editor</td>
                            </tr>
                            <tr>
                                <td class="text-left">Request for Comments: 9421</td>
                                <td class="text-right">Amazon</td>
                            </tr>
                            <tr>
                                <td class="text-left">カテゴリ: Standards Track</td>
                                <td class="text-right">J. Richer, Editor</td>
                            </tr>
                            <tr>
                                <td class="text-left">ISSN: 2070-1721</td>
                                <td class="text-right">Bespoke Engineering</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">M. Sporny</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">Digital Bazaar</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">2024年2月</td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="rfc.title">
                        <h1>HTTP メッセージ署名</h1>
                    </div>
                </header>
                <hr>
                <h2 id="rfc.abstract"><a href="#rfc.abstract">概要</a></h2>
                <div class="lead">
                    <div id="rfc.abstract.p.1">
                        <p>本書は、HTTP メッセージの構成要素に対してデジタル署名またはメッセージ認証コードを作成、エンコード、および検証するためのメカニズムを説明します。本メカニズムは、署名者が完全な
                            HTTP メッセージを知らない場合や、メッセージが検証者に届く前に（中継者によって例えば変換されるなど）変換される可能性があるユースケースをサポートします。また、本書は進行中の
                            HTTP 交換において、後続の HTTP メッセージに署名を適用するよう要求する手段についても説明します。</p>
                    </div>
                </div>
                <aside id="rfc.meta" class="alert alert-info"></aside>
                <section id="rfc.status">
                    <h2><a href="#rfc.status">このメモの状態</a></h2>
                    <div id="rfc.boilerplate.1.p.1">
                        <p>これはインターネット標準トラック文書です。</p>
                    </div>
                    <div id="rfc.boilerplate.1.p.2">
                        <p>本書はインターネット技術タスクフォース (IETF) の成果物です。IETF コミュニティの合意を示すものであり、公開審査を受け、Internet Engineering
                            Steering Group (IESG) によって公開が承認されています。インターネット標準に関する詳細は <a
                                href="https://www.rfc-editor.org/rfc/rfc7841.html#section-2">RFC 7841 のセクション 2</a>
                            を参照してください。
                        </p>
                    </div>
                    <div id="rfc.boilerplate.1.p.3">
                        <p>本書の現行の状態、訂正情報（errata）、およびフィードバックの方法については <a
                                href="https://www.rfc-editor.org/info/rfc9421">https://www.rfc-editor.org/info/rfc9421</a>
                            を参照してください。</p>
                    </div>
                </section>
                <section id="rfc.copyrightnotice">
                    <h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2>
                    <div id="rfc.boilerplate.2.p.1">
                        <p>Copyright (c) 2024 IETF Trust and the persons identified as the document authors. All rights
                            reserved.</p>
                    </div>
                    <div id="rfc.boilerplate.2.p.2">
                        <p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF
                            Documents (<a
                                href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>)
                            in effect on the date of publication of this document. Please review these documents
                            carefully, as they describe your rights and restrictions with respect to this document. Code
                            Components extracted from this document must include Revised BSD License text as described
                            in Section 4.e of the Trust Legal Provisions and are provided without warranty as described
                            in the Revised BSD License.</p>
                    </div>
                </section>
                <div class="toc d-lg-none">
                    <ul>
                        <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#intro">導入</a>
                            <ul>
                                <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#definitions">慣習と用語</a></li>
                                <li><a href="#rfc.section.1.2">1.2.</a>&nbsp;&nbsp;&nbsp;<a href="#requirements">要件</a>
                                </li>
                                <li><a href="#rfc.section.1.3">1.3.</a>&nbsp;&nbsp;&nbsp;<a href="#transforms">HTTP
                                        メッセージの変換</a></li>
                                <li><a href="#rfc.section.1.4">1.4.</a>&nbsp;&nbsp;&nbsp;<a href="#application">HTTP
                                        メッセージ署名の適用</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#covered-components">HTTP メッセージ
                                構成要素</a>
                            <ul>
                                <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a href="#http-fields">HTTP
                                        フィールド</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.1.1">2.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-field-structured">HTTP 構造化フィールドの厳密な直列化</a></li>
                                        <li><a href="#rfc.section.2.1.2">2.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-field-dictionary">辞書型構造化フィールドのメンバー</a>
                                        </li>
                                        <li><a href="#rfc.section.2.1.3">2.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-field-byte-sequence">バイナリでラップされた HTTP フィールド</a></li>
                                        <li><a href="#rfc.section.2.1.4">2.1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-trailer">トレーラー フィールド</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#derived-components">導出コンポーネント</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.2.1">2.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-method">メソッド</a></li>
                                        <li><a href="#rfc.section.2.2.2">2.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-target-uri">ターゲット URI</a></li>
                                        <li><a href="#rfc.section.2.2.3">2.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-authority">オーソリティ</a></li>
                                        <li><a href="#rfc.section.2.2.4">2.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-scheme">スキーム</a></li>
                                        <li><a href="#rfc.section.2.2.5">2.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-target">リクエストターゲット</a></li>
                                        <li><a href="#rfc.section.2.2.6">2.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-path">パス</a></li>
                                        <li><a href="#rfc.section.2.2.7">2.2.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-query">クエリ</a></li>
                                        <li><a href="#rfc.section.2.2.8">2.2.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-query-param">クエリパラメータ</a></li>
                                        <li><a href="#rfc.section.2.2.9">2.2.9.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-status-code">ステータスコード</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2.3">2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#signature-params">署名パラメータ</a></li>
                                <li><a href="#rfc.section.2.4">2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#content-request-response">レスポンスメッセージ内でのリクエスト構成要素の署名</a></li>
                                <li><a href="#rfc.section.2.5">2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#create-sig-input">署名ベースの作成</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#message-signatures">HTTP
                                メッセージ署名</a>
                            <ul>
                                <li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a href="#sign">署名の作成</a></li>
                                <li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a href="#verify">署名の検証</a>
                                    <ul>
                                        <li><a href="#rfc.section.3.2.1">3.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#verify-requirements">アプリケーション要件の強制</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.3.3">3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#signature-methods">署名アルゴリズム</a>
                                    <ul>
                                        <li><a href="#rfc.section.3.3.1">3.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-rsa-pss-sha512">RSASSA-PSS（SHA-512 使用）</a></li>
                                        <li><a href="#rfc.section.3.3.2">3.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-rsa-v1_5-sha256">RSASSA-PKCS1-v1_5（SHA-256 使用）</a></li>
                                        <li><a href="#rfc.section.3.3.3">3.3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-hmac-sha256">HMAC（SHA-256 使用）</a></li>
                                        <li><a href="#rfc.section.3.3.4">3.3.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-ecdsa-p256-sha256">ECDSA（Curve P-256 と SHA-256）</a></li>
                                        <li><a href="#rfc.section.3.3.5">3.3.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-ecdsa-p384-sha384">ECDSA（Curve P-384 と SHA-384）</a></li>
                                        <li><a href="#rfc.section.3.3.6">3.3.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-ed25519">EdDSA（edwards25519）</a></li>
                                        <li><a href="#rfc.section.3.3.7">3.3.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-jose">JSON Web Signature (JWS) アルゴリズム</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#attach-signature">メッセージに署名を付加する方法</a>
                            <ul>
                                <li><a href="#rfc.section.4.1">4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#signature-input-header">Signature-Input HTTP フィールド</a></li>
                                <li><a href="#rfc.section.4.2">4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#signature-header">Signature HTTP フィールド</a></li>
                                <li><a href="#rfc.section.4.3">4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#signature-multiple">複数の署名</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#request-signature">署名の要求</a>
                            <ul>
                                <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#accept-signature-header">Accept-Signature フィールド</a></li>
                                <li><a href="#rfc.section.5.2">5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#processing-an-accept-signature">Accept-Signature の処理</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#iana">IANA に関する考慮事項</a>
                            <ul>
                                <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#http-field-name-registration">HTTP フィールド名の登録</a></li>
                                <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a href="#hsa-registry">HTTP
                                        署名アルゴリズム登録</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.2.1">6.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-hsa-template">登録テンプレート</a></li>
                                        <li><a href="#rfc.section.6.2.2">6.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-hsa-contents">初期内容</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6.3">6.3.</a>&nbsp;&nbsp;&nbsp;<a href="#param-registry">HTTP
                                        署名メタデータパラメータ登録</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.3.1">6.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-param-template">登録テンプレート</a></li>
                                        <li><a href="#rfc.section.6.3.2">6.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-param-contents">初期内容</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6.4">6.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#content-registry">HTTP 署名導出コンポーネント名登録</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.4.1">6.4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-content-template">登録テンプレート</a></li>
                                        <li><a href="#rfc.section.6.4.2">6.4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-content-contents">初期内容</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6.5">6.5.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#component-param-registry">HTTP 署名コンポーネントパラメータ登録</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.5.1">6.5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-component-param-template">登録テンプレート</a></li>
                                        <li><a href="#rfc.section.6.5.2">6.5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-component-param-contents">初期内容</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#security">セキュリティに関する考慮事項</a>
                            <ul>
                                <li><a href="#rfc.section.7.1">7.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#general-considerations">一般的な考慮事項</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.1.1">7.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-ignore">署名検証をスキップすること</a></li>
                                        <li><a href="#rfc.section.7.1.2">7.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-tls">TLS の使用</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7.2">7.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#message-processing-and-selection">メッセージ処理と選択</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.2.1">7.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-coverage">不十分なカバレッジ</a></li>
                                        <li><a href="#rfc.section.7.2.2">7.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-replay">署名のリプレイ</a></li>
                                        <li><a href="#rfc.section.7.2.3">7.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-components">メッセージコンポーネントの選択</a></li>
                                        <li><a href="#rfc.section.7.2.4">7.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-not-fields">HTTP フィールドではなく署名パラメータや導出コンポーネントを選ぶこと</a>
                                        </li>
                                        <li><a href="#rfc.section.7.2.5">7.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-labels">署名ラベル</a></li>
                                        <li><a href="#rfc.section.7.2.6">7.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-multiple">複数署名による混乱</a></li>
                                        <li><a href="#rfc.section.7.2.7">7.2.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-signature-tag">アプリケーション固有署名タグの衝突</a></li>
                                        <li><a href="#rfc.section.7.2.8">7.2.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-message-content">メッセージ内容</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7.3">7.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#cryptographic-considerations">暗号学的考慮事項</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.3.1">7.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-collision">暗号と署名衝突</a></li>
                                        <li><a href="#rfc.section.7.3.2">7.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-keys">鍵の窃取</a></li>
                                        <li><a href="#rfc.section.7.3.3">7.3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-symmetric">対称暗号</a></li>
                                        <li><a href="#rfc.section.7.3.4">7.3.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-keymixup">鍵仕様の取り違え</a></li>
                                        <li><a href="#rfc.section.7.3.5">7.3.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-nondeterministic">非決定論的署名プリミティブ</a></li>
                                        <li><a href="#rfc.section.7.3.6">7.3.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-keydowngrade">鍵・アルゴリズム仕様のダウングレード</a></li>
                                        <li><a href="#rfc.section.7.3.7">7.3.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-sign-signature">署名値の二重署名</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7.4">7.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#matching-covered-components-to-message">署名パラメータと対象メッセージの照合</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.4.1">7.4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-modify">必要なメッセージパラメータの変更</a></li>
                                        <li><a href="#rfc.section.7.4.2">7.4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-mismatch">カバーされたコンポーネントの値と対象メッセージ内の値の一致</a></li>
                                        <li><a href="#rfc.section.7.4.3">7.4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-message-component-context">メッセージコンポーネントの出所と文脈</a></li>
                                        <li><a href="#rfc.section.7.4.4">7.4.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-context-multiple-signatures">複数のメッセージコンポーネント文脈</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7.5">7.5.</a>&nbsp;&nbsp;&nbsp;<a href="#http-processing">HTTP
                                        処理</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.5.1">7.5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-lazy-header-parser">派生コンポーネント名としての無効な HTTP フィールド名の処理</a>
                                        </li>
                                        <li><a href="#rfc.section.7.5.2">7.5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-field-values">意味的に等価なフィールド値</a></li>
                                        <li><a href="#rfc.section.7.5.3">7.5.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-structured">構造化フィールド値の解析</a></li>
                                        <li><a href="#rfc.section.7.5.4">7.5.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-versions">HTTP バージョンとコンポーネントの曖昧性</a></li>
                                        <li><a href="#rfc.section.7.5.5">7.5.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-canonicalization">正規化に関する攻撃</a></li>
                                        <li><a href="#rfc.section.7.5.6">7.5.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-non-list">非リスト型フィールド値</a></li>
                                        <li><a href="#rfc.section.7.5.7">7.5.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-multiple-fields">複数フィールド値によるパディング攻撃</a></li>
                                        <li><a href="#rfc.section.7.5.8">7.5.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-query-elements">クエリ要素の曖昧な処理</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#privacy">プライバシーに関する考慮事項</a>
                            <ul>
                                <li><a href="#rfc.section.8.1">8.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#privacy-identify-keys">鍵による識別</a></li>
                                <li><a href="#rfc.section.8.2">8.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#privacy-confidentiality">署名は機密性を提供しない</a></li>
                                <li><a href="#rfc.section.8.3">8.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#privacy-oracle">オラクル</a></li>
                                <li><a href="#rfc.section.8.4">8.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#privacy-required">必要なコンテンツ</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.9">9.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">参考文献</a>
                            <ul>
                                <li><a href="#rfc.section.9.1">9.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.2">ノルマティブ参考文献</a></li>
                                <li><a href="#rfc.section.9.2">9.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.3">インフォマティブ参考文献</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.A">付録 A.</a>&nbsp;&nbsp;&nbsp;<a href="#detection">HTTP メッセージ署名の検出</a>
                        </li>
                        <li><a href="#rfc.section.B">付録 B.</a>&nbsp;&nbsp;&nbsp;<a href="#examples">例</a>
                            <ul>
                                <li><a href="#rfc.section.B.1">B.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#example-keys">サンプル鍵</a>
                                    <ul>
                                        <li><a href="#rfc.section.B.1.1">B.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-key-rsa-test">サンプル RSA 鍵</a></li>
                                        <li><a href="#rfc.section.B.1.2">B.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-key-rsa-pss-test">サンプル RSA-PSS 鍵</a></li>
                                        <li><a href="#rfc.section.B.1.3">B.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-key-ecc-p256">サンプル ECC P-256 テスト鍵</a></li>
                                        <li><a href="#rfc.section.B.1.4">B.1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-key-ed25519">サンプル Ed25519 テスト鍵</a></li>
                                        <li><a href="#rfc.section.B.1.5">B.1.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-shared-secret">サンプル共有秘密</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.B.2">B.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#test-cases">テストケース</a>
                                    <ul>
                                        <li><a href="#rfc.section.B.2.1">B.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#minimal-signature-using-rsa-pss-sha512">rsa-pss-sha512
                                                を使用した最小署名</a></li>
                                        <li><a href="#rfc.section.B.2.2">B.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#selective-covered-components-using-rsa-pss-sha512">rsa-pss-sha512
                                                を使用した選択的カバードコンポーネント</a></li>
                                        <li><a href="#rfc.section.B.2.3">B.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#full-coverage-using-rsa-pss-sha512">rsa-pss-sha512
                                                を使用したフルカバレッジ</a></li>
                                        <li><a href="#rfc.section.B.2.4">B.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signing-a-response-using-ecdsa-p256-sha256">ecdsa-p256-sha256
                                                を使ったレスポンスの署名</a></li>
                                        <li><a href="#rfc.section.B.2.5">B.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signing-a-request-using-hmac-sha256">hmac-sha256 を使ったリクエストの署名</a>
                                        </li>
                                        <li><a href="#rfc.section.B.2.6">B.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signing-a-request-using-ed25519">ed25519 を使ったリクエストの署名</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.B.3">B.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#tls-terminating-proxies">TLS 終端プロキシ</a></li>
                                <li><a href="#rfc.section.B.4">B.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#example-transform">HTTP メッセージ変換の例</a></li>
                            </ul>
                        </li>
                        <li><a href="#acknowledgements">謝辞</a></li>
                        <li><a href="#rfc.authors">著者の連絡先</a></li>
                    </ul>
                </div>
                <hr class="hidden-print">
                <section id="intro">
                    <h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a href="#intro">導入</a></h2>
                    <div id="rfc.section.1.p.1">
                        <p>メッセージの完全性および真正性は、多くの HTTP アプリケーションの安全な運用にとって重要なセキュリティ特性です。アプリケーション開発者は通常、TLS
                            上でアプリケーションを運用することでトランスポート層にこれらの特性を担保させます（<a href="#RFC8446"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>）。しかしながら、TLS
                            は単一の TLS 接続に対してのみこれらを保証するため、クライアントとアプリケーション間の経路が複数の独立した TLS 接続で構成される場合（たとえばアプリケーションが TLS
                            終端ゲートウェイの背後にホストされている場合や、クライアントが TLS インスペクション装置の背後にいる場合など）には、TLS
                            はクライアントとアプリケーション間のエンドツーエンドのメッセージ完全性や真正性を保証できません。また、一部の環境では TLS
                            の利用が非現実的である（例えばブラウザが提示するクライアント証明書の扱いなど）か、メッセージ真正性を提供するために必要な機能が使えないことがあります。さらに、アプリケーションによっては、HTTP
                            メッセージに対して TLS 証明書とは別のアプリケーション固有の上位レベル鍵を結び付ける必要がある場合があります。そのため、TLS は多くの HTTP
                            ベースのアプリケーションの要件を満たせる一方で、普遍的な解決策ではありません。</p>
                    </div>
                    <div id="rfc.section.1.p.2">
                        <p>加えて、多くのアプリケーションは、ライブラリ、プロキシ、アプリケーションフレームワークが署名時や検証時にメッセージの一部を変更または隠すため、ワイヤ上で見える HTTP
                            メッセージの完全な情報を持たないまま署名の生成や検証を行う必要があります。こうしたアプリケーションは、レイヤリングや抽象化を侵害せずに、アプリケーションにとって最も重要なメッセージ部分を保護する手段を必要とします。
                        </p>
                    </div>
                    <div id="rfc.section.1.p.3">
                        <p>最後に、JSON Web Signature のようなオブジェクトベースの署名メカニズム <a href="#RFC7515"><cite
                                    title="JSON Web Signature (JWS)">[JWS]</cite></a>
                            は、署名された正確な情報が完全な形で伝達されることを要求します。これらを HTTP メッセージに適用する際、HTTP
                            メッセージの要素はオブジェクトのペイロード内に直接複製されるか、ハッシュを介して含まれる必要があり、この実践は検証時に繰り返された情報の整合性を慎重にチェックする必要があるため複雑さを導入します。
                        </p>
                    </div>
                    <div id="rfc.section.1.p.4">
                        <p>本書は、HTTP メッセージの一部構成要素に対して分離署名（detached
                            signature）を用いることで、エンドツーエンドの完全性と真正性を提供するメカニズムを定義します。このメカニズムにより、アプリケーションはメッセージのうち意味があり適切なコンポーネントだけに対してデジタル署名または
                            MAC を作成できます。厳密な正規化ルールにより、HTTP によって許容される多くの方法でメッセージが変換された場合でも検証者が署名を検証できるようにします。</p>
                    </div>
                    <div id="rfc.section.1.p.5" class="avoidbreakafter">
                        <p>本書で説明する署名メカニズムは三つの部分から成ります：</p>
                    </div>
                    <div id="rfc.section.1.p.6">
                        <ul>
                            <li>署名ベースを作成するために使用される、さまざまなプロトコル要素やその他の HTTP メッセージコンポーネントに対する共通の命名法と正規化ルール群（<a
                                    href="#covered-components" title="HTTP Message Components">Section 2</a>）。</li>
                            <li>この署名ベースを用いて HTTP メッセージコンポーネントに対して署名を生成・検証するための暗号的プリミティブを適用するアルゴリズム（<a
                                    href="#message-signatures" title="HTTP Message Signatures">Section 3</a>）。</li>
                            <li>署名および関連メタデータを HTTP メッセージに付与し、付与済みの署名やメタデータを HTTP メッセージから解析するためのメカニズム。これを容易にするために、本書は
                                "Signature-Input" および "Signature" フィールドを定義します（<a href="#attach-signature"
                                    title="Including a Message Signature in a Message">Section 4</a>）。</li>
                        </ul>
                    </div>
                    <div id="rfc.section.1.p.7">
                        <p>本書はまた、"Accept-Signature" フィールドを介して、続く一つ以上のメッセージで署名の使用を交渉するメカニズムを提供します（<a
                                href="#request-signature" title="Requesting Signatures">Section
                                5</a>）。この任意の交渉メカニズムは、機会的またはアプリケーション主導のメッセージ署名とともにどちらの当事者でも使用できます。</p>
                    </div>
                    <div id="rfc.section.1.p.8">
                        <p>本書で定義されるメカニズムは、アプリケーション向けの総合的なセキュリティ機構を構築するための重要なツールです。このツールキットは強力な機能を提供しますが、完全なセキュリティストーリーを構築する上で十分ではありません。特に、<a
                                href="#application" title="Application of HTTP Message Signatures">Section 1.4</a>
                            に列挙された要件や、<a href="#security" title="Security Considerations">Section 7</a>
                            で論じられるセキュリティ考慮事項は、本仕様の実装者にとって非常に重要です。例えば、本仕様は HTTP メッセージ内容（<a
                                href="https://www.rfc-editor.org/rfc/rfc9110.html#section-6.4">RFC9110 Section 6.4</a>
                            で定義）を直接カバーする手段を定義しません。代わりに、Digest 仕様 <a href="#RFC9530"><cite
                                    title="Digest Fields">[DIGEST]</cite></a> によるメッセージ内容のハッシュを利用することに依存しており、これは <a
                                href="#security-message-content" title="Message Content">Section 7.2.8</a> で議論されています。
                        </p>
                    </div>
                    <section id="definitions">
                        <h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a>&nbsp;<a
                                href="#definitions">慣習と用語</a></h3>
                        <div id="rfc.section.1.1.p.1">
                            <p>本書で使用されるキーワード "<em class="bcp14">MUST</em>", "<em class="bcp14">MUST NOT</em>", "<em
                                    class="bcp14">REQUIRED</em>", "<em class="bcp14">SHALL</em>", "<em
                                    class="bcp14">SHALL NOT</em>", "<em class="bcp14">SHOULD</em>", "<em
                                    class="bcp14">SHOULD NOT</em>", "<em class="bcp14">RECOMMENDED</em>", "<em
                                    class="bcp14">NOT RECOMMENDED</em>", "<em class="bcp14">MAY</em>", および "<em
                                    class="bcp14">OPTIONAL</em>" は、<span class="nobr">BCP 14</span>（<a
                                    href="#RFC2119"><cite
                                        title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>、
                                <a href="#RFC8174"><cite
                                        title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</cite></a>）に記載されたとおり、大文字で現れる場合に限り解釈されます。
                            </p>
                        </div>
                        <div id="rfc.section.1.1.p.2">
                            <p>"HTTP message", "HTTP request", "HTTP response", "target URI", "gateway", "header field",
                                "intermediary", "request target", "trailer field", "sender", "method", および "recipient"
                                といった用語は、<a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>
                                で定義されているものとして使用します。</p>
                        </div>
                        <div id="rfc.section.1.1.p.3">
                            <p>便宜上、本書では「署名」という語を、デジタル署名（公開鍵暗号を用いるもの）と鍵付き MAC（対称暗号を用いるもの）の両方を指すために使用します。同様に、動詞 "sign"
                                はデジタル署名または鍵付き MAC の生成のいずれかを指します。特に公開鍵暗号による署名操作の出力を指す場合は「デジタル署名」と明示します。</p>
                        </div>
                        <div id="rfc.section.1.1.p.4">
                            <p>本書は、データ型を指定するために <a href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3">RFC8941
                                    Section 3</a> の用語（List, Inner List, Dictionary, Item, String, Integer, Byte
                                Sequence, Boolean）を使用します。</p>
                        </div>
                        <div id="rfc.section.1.1.p.5">
                            <p>本書は ABNF を用いていくつかの文字列構築を定義し、次の ABNF ルールを使用します：<span class="tt">VCHAR</span>, <span
                                    class="tt">SP</span>, <span class="tt">DQUOTE</span>, および <span
                                    class="tt">LF</span>。また、<a href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> のルール
                                <span class="tt">sf-string</span>, <span class="tt">inner-list</span>, <span
                                    class="tt">parameters</span>、および <a href="#RFC9110"><cite
                                        title="HTTP Semantics">[HTTP]</cite></a> と <a href="#RFC9112"><cite
                                        title="HTTP/1.1">[HTTP/1.1]</cite></a> のルール <span
                                    class="tt">field-content</span>, <span class="tt">obs-fold</span>, <span
                                    class="tt">obs-text</span> を使用します。
                            </p>
                        </div>
                        <div id="rfc.section.1.1.p.6" class="avoidbreakafter">
                            <p>前述に加えて、本書では以下の用語を使用します：</p>
                        </div>
                        <div id="rfc.section.1.1.p.7">
                            <dl class="nohang">
                                <dt>HTTP Message Signature:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>HTTP メッセージの一部または複数部分をカバーするデジタル署名または鍵付き MAC。単一の HTTP メッセージに複数の HTTP
                                        メッセージ署名が含まれることがあります。</div>
                                </dd>
                                <dt>Signer:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>HTTP
                                        メッセージ署名を生成している、または生成したエンティティ。複数のエンティティが署名者として振る舞い、同一メッセージに別個の署名を付与することがあります。
                                    </div>
                                </dd>
                                <dt>Verifier:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>HTTP メッセージに対する署名を検証している、または検証したエンティティ。HTTP
                                        メッセージ署名は複数回、潜在的に異なるエンティティによって検証され得ます。</div>
                                </dd>
                                <dt>HTTP Message Component:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>HTTP メッセージの一部で、HTTP メッセージ署名によってカバー可能なもの。</div>
                                </dd>
                                <dt>Derived Component:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>指定されたアルゴリズムや処理を用いて HTTP メッセージから導出される HTTP メッセージコンポーネント。詳細は <a
                                            href="#derived-components" title="Derived Components">Section 2.2</a> を参照。
                                    </div>
                                </dd>
                                <dt>HTTP Message Component Name:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>フィールド名や導出コンポーネント名のように、HTTP メッセージコンポーネントの出所を識別する文字列。</div>
                                </dd>
                                <dt>HTTP Message Component Identifier:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>HTTP メッセージコンポーネント名と任意のパラメータの組み合わせ。これは、特定の HTTP メッセージ署名およびそれが適用される HTTP
                                        メッセージに関して特定の HTTP メッセージコンポーネントを一意に識別します。</div>
                                </dd>
                                <dt>HTTP Message Component Value:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>特定の HTTP メッセージにおける特定のコンポーネント識別子に関連付けられた値。コンポーネント値は HTTP
                                        メッセージから導出され、通常は正規化プロセスの対象となります。</div>
                                </dd>
                                <dt>Covered Components:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>フィールド（<a href="#http-fields" title="HTTP Fields">Section
                                            2.1</a>）および導出コンポーネント（<a href="#derived-components"
                                            title="Derived Components">Section
                                            2.2</a>）に対する順序付けられた識別子の集合で、署名によってカバーされるメッセージコンポーネントの集合を示します。<span
                                            class="tt">@signature-params</span>
                                        識別子自体は含まれません。この集合の順序は保存され、署名者と検証者の間で署名ベースの再構築を容易にするために伝達されます。</div>
                                </dd>
                                <dt>Signature Base:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>署名者と検証者がカバーされたコンポーネント集合と HTTP
                                        メッセージを用いて生成するバイト列のシーケンス。署名ベースは暗号アルゴリズムによって処理され、HTTP メッセージ署名の生成または検証に用いられます。
                                    </div>
                                </dd>
                                <dt>HTTP Message Signature Algorithm:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>署名と検証のプロセスを記述する暗号アルゴリズムで、<span class="tt">HTTP_SIGN</span> および <span
                                            class="tt">HTTP_VERIFY</span> プリミティブとして Section 3.3 で説明される方法で定義されます。</div>
                                </dd>
                                <dt>Key Material:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>署名の生成または検証に必要な鍵素材。鍵素材は明示的な key identifier で識別されることが多く、署名者は使用した鍵を検証者に示すことができます。
                                    </div>
                                </dd>
                                <dt>Creation Time:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>署名が生成された時点を署名者が主張するタイムスタンプ。</div>
                                </dd>
                                <dt>Expiration Time:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>署名が検証者によってもはや受け入れられるべきでない時点を署名者が主張するタイムスタンプ。</div>
                                </dd>
                                <dt>Target Message:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>HTTP メッセージ署名が適用される対象の HTTP メッセージ。</div>
                                </dd>
                                <dt>Signature Context:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>HTTP
                                        メッセージコンポーネント値が取り出されるデータソース。コンテキストは対象メッセージおよび署名者または検証者が持つ追加情報（例：リクエストの完全なターゲット
                                        URI やレスポンスに関連するリクエストメッセージなど）を含み得ます。</div>
                                </dd>
                            </dl>
                        </div>
                        <div id="rfc.section.1.1.p.8">
                            <p>"UNIX timestamp" という用語は、<a href="#POSIX"><cite
                                        title="The Open Group Base Specifications Issue 7, 2018 edition">[POSIX.1]</cite></a>
                                の Section 4.16 が呼ぶところの "seconds since the Epoch" を指します。</p>
                        </div>
                        <div id="rfc.section.1.1.p.9">
                            <p>本書には部分的および完全な HTTP メッセージの非規範的な例が含まれます。いくつかの例では長い値の折り返しを示すために単一のトレーリングバックスラッシュ（<span
                                    class="tt">\</span>）を使用しています（<a href="#RFC8792"><cite
                                        title="Handling Long Lines in Content of Internet-Drafts and RFCs">[RFC8792]</cite></a>）。折り返しの行にある
                                <span class="tt">\</span> 文字および先頭の空白は値の一部ではありません。
                            </p>
                        </div>
                    </section>
                    <section id="requirements">
                        <h3 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a>&nbsp;<a href="#requirements">要件</a>
                        </h3>
                        <div id="rfc.section.1.2.p.1">
                            <p>HTTP
                                は中継者によるメッセージ変換を許容し、場合によっては要求します。これは受信側が送信側のメッセージとビット単位で同一でないメッセージを受け取る結果をもたらす可能性があります。このような場合、受信者は送信者の生データのバイト列に対して完全性保護を検証することができません。なぜならデジタル署名や
                                MAC
                                の検証は、署名者と検証者がまったく同一の署名ベースを持っていることを必要とするからです。したがってメッセージの生バイト列を署名ベースの信頼できる出所として頼ることができない場合、署名者と検証者は各自のバージョンのメッセージから署名ベースを独立に作成する必要があり、そのためにはメッセージの意味を変えない安全な変更に対して回復力のあるメカニズムが必要です。
                            </p>
                        </div>
                        <div id="rfc.section.1.2.p.2">
                            <p>何が安全な変更であり何が安全でない変更かを厳密に定義するのは様々な理由で実用的でありません。アプリケーションは多様な方法で HTTP
                                を使用し、特定のメッセージ内のある情報（例えばメッセージ内容、メソッド、あるいは特定のヘッダーフィールド）が重要かどうかで意見が分かれ得ます。したがって、汎用的な解決策は署名者が署名するメッセージコンポーネントをある程度制御できることを提供する必要があります。
                            </p>
                        </div>
                        <div id="rfc.section.1.2.p.3">
                            <p>HTTP アプリケーションは、完全な HTTP メッセージへのアクセスや制御が提供されない環境（例えばブラウザの JavaScript
                                環境）で動作しているか、あるいはプロトコルの詳細を抽象化するライブラリ（例：Java HTTP Client
                                (HttpClient)）を使用していることがあります。これらのアプリケーションは、HTTP メッセージの完全な情報を持たない場合でも署名の生成と検証ができる必要があります。
                            </p>
                        </div>
                    </section>
                    <section id="transforms">
                        <h3 id="rfc.section.1.3"><a href="#rfc.section.1.3">1.3.</a>&nbsp;<a href="#transforms">HTTP
                                メッセージの変換</a></h3>
                        <div id="rfc.section.1.3.p.1" class="avoidbreakafter">
                            <p>前述のとおり、HTTP
                                は実装がさまざまな方法でメッセージを変換することを明示的に許可し、場合によっては要求します。実装はこれらの変換の多くに耐性を持つことが要求されます。以下は文脈を示すために提供する非規範的かつ網羅的でない変換の一覧です：
                            </p>
                        </div>
                        <div id="rfc.section.1.3.p.2">
                            <ul>
                                <li>異なるフィールド名を持つフィールドの順序入れ替え（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.3">RFC9110 Section
                                        5.3</a>）。</li>
                                <li>同一フィールド名のフィールドの結合（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.2">RFC9110 Section
                                        5.2</a>）。</li>
                                <li>Connection ヘッダーに列挙されたフィールドの削除（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.6.1">RFC9110 Section
                                        7.6.1</a>）。</li>
                                <li>制御オプションを示すフィールドの追加（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.6.1">RFC9110 Section
                                        7.6.1</a>）。</li>
                                <li>トランスファーコーディングの追加または削除（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.7">RFC9110 Section
                                        7.7</a>）。</li>
                                <li>Via（<a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.6.3">RFC9110
                                        Section 7.6.3</a>）や Forwarded（<a
                                        href="https://www.rfc-editor.org/rfc/rfc7239.html#section-4">RFC7239 Section
                                        4</a>）のようなフィールドの追加。</li>
                                <li>HTTP バージョン間の変換（例：HTTP/1.x と HTTP/2 間の変換）。</li>
                                <li>フィールド名、リクエスト URI スキーム、ホストなどの大文字小文字の変化（大文字小文字非区別の要素）。</li>
                                <li>リクエストターゲットとオーソリティの変更であって、それらを合わせて適用してもメッセージのターゲット URI が変わらない場合の変更（RFC9110 Section
                                    7.1 の定義に従う）。</li>
                            </ul>
                        </div>
                        <div id="rfc.section.1.3.p.3" class="avoidbreakafter">
                            <p>さらに、非推奨または本来許されない変換であっても野生ではまだ発生することがあるものがあります。これらの変換は署名を破壊することなく処理可能であり、例えば次のような操作が含まれます：
                            </p>
                        </div>
                        <div id="rfc.section.1.3.p.4">
                            <ul>
                                <li>フィールド値の先頭や末尾の空白の使用、追加、または削除。</li>
                                <li>フィールド値における <span class="tt">obs-fold</span> の使用、追加、または削除（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9112.html#section-5.2">RFC9112 Section
                                        5.2</a>）。</li>
                            </ul>
                        </div>
                        <div id="rfc.section.1.3.p.5">
                            <p>こうした種類の変換は、署名でカバーされたコンポーネントに対して行われても署名検証を妨げるべきではない変換として識別できます。さらに、署名でカバーされていないコンポーネントへのすべての変更は署名検証を妨げるべきではありません。
                            </p>
                        </div>
                        <div id="rfc.section.1.3.p.6">
                            <p>この種の変換の例とそれらがメッセージ署名に与える影響については、<a href="#example-transform"
                                    title="HTTP Message Transformations">付録 B.4</a> を参照してください。</p>
                        </div>
                        <div id="rfc.section.1.3.p.7">
                            <p>一方、カバーされたコンポーネントのフィールド値を解析して再直列化することや導出コンポーネントの値を変更するような変換は、署名がターゲットメッセージに対して有効でなくなる原因となり得ます。本仕様を適用するアプリケーションは、期待される変換がカバーコンポーネントの選択によって十分に扱われることを確保する必要があります。
                            </p>
                        </div>
                    </section>
                    <section id="application">
                        <h3 id="rfc.section.1.4"><a href="#rfc.section.1.4">1.4.</a>&nbsp;<a href="#application">HTTP
                                メッセージ署名の適用</a></h3>
                        <div id="rfc.section.1.4.p.1" class="avoidbreakafter">
                            <p>HTTP メッセージ署名は多様な状況やアプリケーションに適用できる汎用ツールとして設計されています。安全かつ適切に HTTP
                                メッセージ署名を適用するために、あるアプリケーションまたは本仕様のプロファイルは、少なくとも次の項目を指定しなければなりません（<em
                                    class="bcp14">MUST</em>）：</p>
                        </div>
                        <div id="rfc.section.1.4.p.2">
                            <ul>
                                <li>期待され、かつカバーコンポーネントリストに含めることが要求されるコンポーネント識別子の集合（<a href="#covered-components"
                                        title="HTTP Message Components">Section 2</a>）および署名パラメータ（<a
                                        href="#signature-params" title="Signature Parameters">Section
                                        2.3</a>）。例えば、認可プロトコルは Authorization フィールドをカバーして認可資格情報を保護し、署名パラメータに <span
                                        class="tt">created</span> パラメータを含めることを要求するかもしれません。一方で、セマンティックに意味のある HTTP
                                    メッセージ内容を期待する API は、Content-Digest フィールド（<a href="#RFC9530"><cite
                                            title="Digest Fields">[DIGEST]</cite></a>）の存在とカバーを要求し、さらに API 固有の値を持つ <span
                                        class="tt">tag</span> パラメータ（<a href="#signature-params"
                                        title="Signature Parameters">Section 2.3</a>）を要求することがあります。</li>
                                <li>必須または期待されるカバーコンポーネントフィールドやパラメータの Structured Field タイプ（<a href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>）。
                                </li>
                                <li>署名を検証するために使用する鍵素材を取得する手段。アプリケーションは通常、署名パラメータの <span class="tt">keyid</span>
                                    を使用して鍵を解決する規則を定義しますが、事前登録された署名者鍵など他の手段で適切な鍵が既知であることもあり得ます。</li>
                                <li>署名者が使用することを期待する署名アルゴリズムの集合と、検証者が受け付けるアルゴリズムの集合。</li>
                                <li>署名検証に用いる署名アルゴリズムが鍵素材とメッセージコンテキストに対して適切かどうか判定する手段。例えば、署名パラメータの <span
                                        class="tt">alg</span>
                                    によりアルゴリズムを明示する、鍵素材からアルゴリズムを導出する、あるいは事前設定されたアルゴリズムを使用する方式などが考えられます。</li>
                                <li>署名に用いられた鍵とアルゴリズムがメッセージの文脈に適切であることを判定する手段。例えば ECDSA のみを期待するサーバーは RSA
                                    署名を拒否すべきですし、公開鍵暗号を期待するサーバーは対称暗号を拒否すべきです。</li>
                                <li>HTTP メッセージおよびそのアプリケーション文脈からメッセージコンポーネントを導出する際の文脈を決定する手段。通常これは対象の HTTP
                                    メッセージ自体ですが、外部ホスト名など設定によって知られる追加情報を含むこともあります。</li>
                                <li>Section 2.4
                                    のメカニズムを用いてリクエストとレスポンスの結び付けが必要な場合、その結び付けのプロパティを提供するために必要となるリクエストメッセージとレスポンスメッセージのすべての要素。
                                </li>
                                <li>署名が無効である、鍵素材が不適切である、有効期間が仕様外である、コンポーネント値が計算できない、または検証中にその他のエラーが発生した場合に、検証者が署名者に返すエラーメッセージとコード。例えば、署名が認証メカニズムとして用いられる場合、401（Unauthorized）や
                                    403（Forbidden）といった HTTP ステータスコードが適切なことがあります。HTTP API の応答であれば、400（Bad
                                    Request）などのステータスコードに詳細を含めることができ、RFC7807/RFC9457
                                    に従った問題詳細を用いて誤った鍵素材が使用されたことを示すこともできます。</li>
                            </ul>
                        </div>
                        <div id="rfc.section.1.4.p.3">
                            <p>これらのパラメータを選択する際、検証者が署名ベースを再現するために必要なすべての情報にアクセスできることを保証する必要があります。例えば、リバースプロキシの背後にあるサーバーは、導出コンポーネント
                                <span class="tt">@target-uri</span> を利用するには元のリクエスト URI を知る必要があります（見かけ上のターゲット URI
                                はリバースプロキシによって変更されるため）。また、レスポンスで署名を使用するアプリケーションは、クライアントが署名された部分（サーバーが <span
                                    class="tt">req</span> パラメータを使って署名したリクエストの部分を含む）にアクセスできることを確保する必要があります（<a
                                    href="#content-request-response"
                                    title="Signing Request Components in a Response Message">Section 2.4</a>参照）。
                            </p>
                        </div>
                        <div id="rfc.section.1.4.p.4">
                            <p>この種のプロファイリングの詳細はアプリケーションの範疇であり本仕様の範囲外ですが、いくつかの追加考慮事項は<a href="#security"
                                    title="Security Considerations">Section
                                    7</a>で議論されています。特に、必要なコンポーネント識別子の集合を選択する際には、カバレッジがアプリケーションに対して十分であることに注意する必要があります（<a
                                    href="#security-coverage" title="Insufficient Coverage">Section 7.2.1</a> および <a
                                    href="#security-message-content" title="Message Content">Section 7.2.8</a>
                                を参照）。本仕様はアプリケーション向けの完全なセキュリティシステムの一部のみを定義します。完全なシステムを構築する際にはセキュリティ分析を行うことが重要です。AWS
                                Signature Version 4 <a href="#AWS-SIGv4"><cite
                                        title="Authenticating Requests (AWS Signature Version 4)">[AWS-SIGv4]</cite></a>
                                のような歴史的システムは適用例として参考になりますが、それらを参照したからといって HTTP
                                メッセージ署名を用いるアプリケーションに対するセキュリティ分析の必要性が無くなるわけではありません。</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="covered-components">
                    <h2 id="rfc.section.2" class="np"><a href="#rfc.section.2">2.</a>&nbsp;<a
                            href="#covered-components">HTTP メッセージ構成要素</a></h2>
                    <div id="rfc.section.2.p.1">
                        <p>署名者と検証者がどのコンポーネントが署名に含まれているかを確定できるようにするために、本書は HTTP
                            メッセージ署名でカバーされるコンポーネントのためのコンポーネント識別子、これらの識別子に関連付けられた値を HTTP
                            メッセージから導出し正規化する一連の規則、およびこれらの正規化済み値を署名ベースに組み合わせる手段を定義します。</p>
                    </div>
                    <div id="rfc.section.2.p.2">
                        <p>これらの値を導出するための署名コンテキストは、署名者と検証者の両方がアクセス可能であることが<em
                                class="bcp14">MUST</em>です。コンテキストは特定の署名内のすべてのコンポーネントで同一であることが<em
                                class="bcp14">MUST</em>です。例えば、<span class="tt">@query</span>
                            導出コンポーネントに生のクエリ文字列を用い、同じ署名内の <span class="tt">@query-param</span>
                            導出コンポーネントに結合済みのクエリとフォームパラメータを用いるのは誤りになります。メッセージコンポーネントコンテキストに関するさらなる考慮事項は <a
                                href="#security-message-component-context"
                                title="Message Component Source and Context">Section 7.4.3</a> を参照してください。</p>
                    </div>
                    <div id="rfc.section.2.p.3">
                        <p>コンポーネント識別子はコンポーネント名とその名前に関連付けられた任意のパラメータで構成されます。各コンポーネント名は HTTP フィールド名（<a href="#http-fields"
                                title="HTTP Fields">Section 2.1</a>）か、登録された導出コンポーネント名（<a href="#derived-components"
                                title="Derived Components">Section
                                2.2</a>）のいずれかです。コンポーネント識別子に対する可能なパラメータは識別子に依存します。すべての可能なパラメータを一覧する "HTTP Signature
                            Component Parameters" レジストリは <a href="#component-param-registry"
                                title="HTTP Signature Component Parameters Registry">Section 6.5</a> で定義されています。</p>
                    </div>
                    <div id="rfc.section.2.p.4">
                        <p>単一のカバーされたコンポーネントリスト内では、各コンポーネント識別子は一度しか出現してはならないことが<em
                                class="bcp14">MUST</em>です。コンポーネント識別子は、コンポーネント名が異なるか、同じコンポーネント名に対してパラメータが異なれば別個と見なされます。同じコンポーネント名を持ちつつ、<span
                                class="tt">"foo";bar</span> と <span class="tt">"foo";baz</span>
                            のように区別可能なパラメータで異なる識別子を含めることは<em
                                class="bcp14">MAY</em>です。コンポーネント識別子を処理する際（検証中のパースなど）、パラメータの順序は保存されることが<em
                                class="bcp14">MUST</em>ですが、2つのコンポーネント識別子を等価性チェックする際にはパラメータの順序は重要ではありません。つまり、<span
                                class="tt">"foo";bar;baz</span> と <span class="tt">"foo";baz;bar</span>
                            は同じメッセージには存在できません（これらは同等であるため）が、システムが一方の形式を他方の形式に変換してはならないということです。</p>
                    </div>
                    <div id="rfc.section.2.p.5">
                        <p>コンポーネント識別子に関連付けられたコンポーネント値は、その識別子自体によって定義されます。コンポーネント値は改行文字（<span
                                class="tt">\n</span>）を含んではならないことが<em class="bcp14">MUST NOT</em>です。一部の HTTP
                            メッセージコンポーネントはビット単位の値が変わっても意味が変わらない変換（例えばフィールド値の結合）が行われ得ます。したがって、メッセージコンポーネント値は署名される前に正規化される必要があり、中継者によるそのような変換があっても署名が検証できるようにします。本書は各コンポーネント識別子に対して、その関連コンポーネント値をそのような正規化形式に変換する規則を定義します。
                        </p>
                    </div>
                    <div id="rfc.section.2.p.6">
                        <p>以下の節では、コンポーネント識別子名、そのパラメータ、関連する値、および値の正規化規則を定義します。メッセージコンポーネントを署名ベースに結合する方法は <a
                                href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a> で定義されています。
                        </p>
                    </div>
                    <section id="http-fields">
                        <h3 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a>&nbsp;<a href="#http-fields">HTTP
                                フィールド</a></h3>
                        <div id="rfc.section.2.1.p.1">
                            <p>HTTP フィールドのコンポーネント名は、そのフィールド名の小文字化した形式です（<a
                                    href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.1">Section 5.1</a> of <a
                                    href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a> に定義）。HTTP
                                フィールド名は大文字小文字を区別しませんが、実装はコンポーネント名として小文字化したフィールド名（例：<span class="tt">content-type</span>,
                                <span class="tt">date</span>, <span class="tt">etag</span>）を使用しなければなりません（<em
                                    class="bcp14">MUST</em>）。
                            </p>
                        </div>
                        <div id="rfc.section.2.1.p.2">
                            <p>HTTP フィールドのコンポーネント値は、対象メッセージの指定されたヘッダーフィールドから取られるフィールド値です（<a
                                    href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.5">Section 5.5</a> of <a
                                    href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>）。この振る舞いは、以下に示す <span
                                    class="tt">req</span> や <span class="tt">tr</span>
                                フラグ等の追加パラメータと規則によって上書きされない限り適用されます。多くのフィールドについて、フィールド値は <a href="#RFC9110"><cite
                                        title="HTTP Semantics">[HTTP]</cite></a> が推奨するように ASCII
                                文字列であり、コンポーネント値はまさにその文字列です。実装によっては他のエンコーディングが存在し得るため、すべての非 ASCII フィールド値は署名ベースに追加される前に
                                ASCII にエンコードされなければなりません（<em class="bcp14">MUST</em>）。問題のあるフィールド値をラップする手段としては、<a
                                    href="#http-field-byte-sequence" title="Binary-Wrapped HTTP Fields">Section
                                    2.1.3</a> で説明される <span class="tt">bs</span> パラメータがあります。</p>
                        </div>
                        <div id="rfc.section.2.1.p.3">
                            <p>追加のパラメータや規則で上書きされない限り、HTTP フィールド値は <a
                                    href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.2">Section 5.2</a> of <a
                                    href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>
                                に定義されたとおり単一の値に結合されなければなりません（<em
                                    class="bcp14">MUST</em>）。具体的には、同一フィールド名が複数回送信された場合、フィールド値は単一のカンマと単一の空白（"," + "
                                "）で連結して結合する必要があります。中継者はカンマ間で任意の量の空白を使って値を結合することが許されるため、検証者がこの点を考慮していないと署名は失敗する可能性があります。堅牢性を高めるため、署名されたメッセージはカバーされたフィールドについて可能な限り単一インスタンスのみを含めることが<em
                                    class="bcp14">RECOMMENDED</em>です。特にリストベースのフィールドは下述の厳密アルゴリズムに従って直列化された値を単一インスタンスとして含めると、中継者による変化を避けやすくなります。単一インスタンスで送れない場合は、署名者と検証者が下記の厳密アルゴリズムに基づいてすべての個別フィールド値を取り扱い結合することが<em
                                    class="bcp14">RECOMMENDED</em>です。フィールドが Structured Field の List または Dictionary
                                型である場合、この効果は <a href="#http-field-structured"
                                    title="Strict Serialization of HTTP Structured Fields">Section 2.1.1</a> に記述される厳密な
                                Structured Field シリアライゼーションを要求することでより直接的に達成できます。</p>
                        </div>
                        <div id="rfc.section.2.1.p.4">
                            <p>Set-Cookie のように（<a href="#RFC6265"><cite
                                        title="HTTP State Management Mechanism">[COOKIE]</cite></a>）値の結合をこの方法で行えないフィールドもある点に注意してください（複数の入力から結合した出力が一意に解釈できない場合）。コンポーネント値は署名プロセスにより解析されることはなく、署名ベースの一部としてのみ使用されますが、結合値が曖昧になり得るため、こうしたフィールドを署名に含める際は注意が必要です。問題のあるフィールドをラップする手段としては
                                <a href="#http-field-byte-sequence" title="Binary-Wrapped HTTP Fields">Section 2.1.3</a>
                                の <span class="tt">bs</span> パラメータがあります。この問題に関する詳細は <a href="#security-non-list"
                                    title="Non-List Field Values">Section 7.5.6</a> を参照してください。
                            </p>
                        </div>
                        <div id="rfc.section.2.1.p.5" class="avoidbreakafter">
                            <p>特定の実装で正しく結合された値が直接利用できない場合、次のアルゴリズムによってリストベースのフィールドに対する正規化結果を生成できます：</p>
                        </div>
                        <div id="rfc.section.2.1.p.6">
                            <ol type="1">
                                <li>メッセージ内の各インスタンスのフィールド値を、そのメッセージで出現する順序（または出現するであろう順序）で順序付きリストとして作成する。</li>
                                <li>リスト内の各アイテムの先頭および末尾の空白を取り除く。HTTP フィールド値は先頭および末尾の空白を含めてはならないため、準拠実装ではこの操作は無効操作になります。
                                </li>
                                <li>行内の obsolete line folding を取り除き、単一のスペース（" "）で置き換える（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9112.html#section-5.2">Section 5.2</a>
                                    of <a href="#RFC9112"><cite title="HTTP/1.1">[HTTP/1.1]</cite></a> を参照）。この挙動は
                                    HTTP/1.1 固有であり、他の HTTP 版では内部折り返しを許容しない点に注意。</li>
                                <li>各アイテムの間を単一のカンマ（","）と単一のスペース（" "）で連結する。</li>
                            </ol>
                        </div>
                        <div id="rfc.section.2.1.p.7">
                            <p>得られた文字列がそのフィールドのコンポーネント値になります。</p>
                        </div>
                        <div id="rfc.section.2.1.p.8">
                            <p>中継者が変える可能性のある大文字小文字の違いなど、同等の意味を持つ複数の正当な直列化が存在する HTTP
                                フィールドがある点に注意してください。そのようなフィールドを署名および処理するアプリケーションは、署名者と検証者が同一の値を導出できるように値の扱い方を検討しなければならないことが<em
                                    class="bcp14">MUST</em>です（詳しくは <a href="#security-field-values"
                                    title="Semantically Equivalent Field Values">Section 7.5.2</a> を参照）。</p>
                        </div>
                        <div id="rfc.section.2.1.p.9" class="avoidbreakafter">
                            <p>以下は、次の例示的な HTTP メッセージ断片に対するヘッダーフィールドのコンポーネント値の非規範的な例です：</p>
                        </div>
                        <div id="rfc.section.2.1.p.10">
                            <pre class="text">
Host: www.example.com
Date: Tue, 20 Apr 2021 02:07:56 GMT
X-OWS-Header:   Leading and trailing whitespace.
X-Obs-Fold-Header: Obsolete
    line folding.
Cache-Control: max-age=60
Cache-Control:    must-revalidate
Example-Dict:  a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre>
                        </div>
                        <div id="rfc.section.2.1.p.11" class="avoidbreakafter">
                            <p>次の例は、これらの例示ヘッダーフィールドのコンポーネント値を <a href="#create-sig-input"
                                    title="Creating the Signature Base">Section 2.5</a> で定義された署名ベース形式で示したものです：</p>
                        </div>
                        <div id="rfc.section.2.1.p.12">
                            <pre>
"host": www.example.com
"date": Tue, 20 Apr 2021 02:07:56 GMT
"x-ows-header": Leading and trailing whitespace.
"x-obs-fold-header": Obsolete line folding.
"cache-control": max-age=60, must-revalidate
"example-dict": a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre>
                        </div>
                        <div id="rfc.section.2.1.p.13" class="avoidbreakafter">
                            <p>空の HTTP フィールドもメッセージ内に存在する場合に署名できます。正規化された値は空文字列です。例えば次の空ヘッダーフィールド（(SP)
                                は空のフィールド値の前に来る単一のトレーリングスペースを示す）は：</p>
                        </div>
                        <div id="rfc.section.2.1.p.14">
                            <pre>
X-Empty-Header:(SP)
</pre>
                        </div>
                        <div id="rfc.section.2.1.p.15">
                            <p>署名ベース生成アルゴリズム（<a href="#create-sig-input" title="Creating the Signature Base">Section
                                    2.5</a>）によって、コロンとコンポーネント識別子の後に追加されるコロンと空白の後には空文字列値が直列化されます。</p>
                        </div>
                        <div id="rfc.section.2.1.p.16">
                            <pre>
"x-empty-header":(SP)
</pre>
                        </div>
                        <div id="rfc.section.2.1.p.17" class="avoidbreakafter">
                            <p>任意の HTTP フィールドコンポーネント識別子は、特定の状況で以下のパラメータを持つことが<em
                                    class="bcp14">MAY</em>あり、各々はその詳細が別節で説明されています：</p>
                        </div>
                        <div id="rfc.section.2.1.p.18">
                            <dl>
                                <dt><span class="tt">sf</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>Structured Field 値の厳密なエンコードでコンポーネント値が直列化されることを示すブールフラグ（<a
                                            href="#http-field-structured"
                                            title="Strict Serialization of HTTP Structured Fields">Section 2.1.1</a>）。
                                    </div>
                                </dd>
                                <dt><span class="tt">key</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>辞書型 Structured Field から単一のメンバ値を選択するために使われる文字列パラメータ（<a
                                            href="#http-field-dictionary"
                                            title="Dictionary Structured Field Members">Section 2.1.2</a>）。</div>
                                </dd>
                                <dt><span class="tt">bs</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>個々のフィールド値が Byte Sequence データ構造でエンコードされてからコンポーネント値に結合されることを示すブールフラグ（<a
                                            href="#http-field-byte-sequence" title="Binary-Wrapped HTTP Fields">Section
                                            2.1.3</a>）。</div>
                                </dd>
                                <dt><span class="tt">req</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>
                                        署名されたレスポンスに対して、コンポーネント値がレスポンス自体ではなくこのレスポンスを引き起こしたリクエストから導出されることを示すブールフラグ。なお、このパラメータはリクエストをターゲットとする導出コンポーネント識別子にも適用できます（<a
                                            href="#content-request-response"
                                            title="Signing Request Components in a Response Message">Section 2.4</a>）。
                                    </div>
                                </dd>
                                <dt><span class="tt">tr</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>メッセージのトレーラから値が取られることを示すブールフラグ（<a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html#section-6.5">Section
                                            6.5</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>
                                        に定義）。このフラグがない場合、フィールド値はヘッダーフィールドから取られます（<a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html#section-6.3">Section
                                            6.3</a> of <a href="#RFC9110"><cite
                                                title="HTTP Semantics">[HTTP]</cite></a>、および <a href="#http-trailer"
                                            title="Trailer Fields">Section 2.1.4</a> を参照）。</div>
                                </dd>
                            </dl>
                        </div>
                        <div id="rfc.section.2.1.p.19">
                            <p>複数のパラメータを同時に指定することは<em class="bcp14">MAY</em>ですが、冗長または互換性のない組み合わせもあります。例えば、<span
                                    class="tt">key</span> パラメータは Dictionary アイテムに対して厳密な直列化を要求するため、<span
                                    class="tt">sf</span> の機能は <span class="tt">key</span> によって既にカバーされます。生のバイトを必要とする
                                <span class="tt">bs</span> パラメータは、結合後の解析されたデータ構造を必要とする <span class="tt">sf</span> や
                                <span class="tt">key</span> と互換性がありません。
                            </p>
                        </div>
                        <div id="rfc.section.2.1.p.20">
                            <p>追加のパラメータは <a href="#component-param-registry"
                                    title="HTTP Signature Component Parameters Registry">Section 6.5</a> で設立された "HTTP
                                Signature Component Parameters" レジストリで定義できます。</p>
                        </div>
                        <section id="http-field-structured">
                            <h4 id="rfc.section.2.1.1"><a href="#rfc.section.2.1.1">2.1.1.</a>&nbsp;<a
                                    href="#http-field-structured">HTTP 構造化フィールドの厳密な直列化</a>
                            </h4>
                            <div id="rfc.section.2.1.1.p.1">
                                <p>HTTP フィールドの値がアプリケーション側で Structured Field 型（<a href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>）であると判っており、その期待される型が明らかである場合、署名者はコンポーネント識別子に
                                    <span class="tt">sf</span> パラメータを含めることが<em
                                        class="bcp14">MAY</em>です。このパラメータが含まれる場合、HTTP フィールド値はその型に適用される <a
                                        href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4">Section 4</a>
                                    に規定された正式なシリアライゼーション規則（または拡張・更新の該当セクション）を用いて直列化されなければならないことが<em
                                        class="bcp14">MUST</em>です。注意点として、この処理により内部の任意の空白が単一のスペース文字に置き換わる等、値に対する変換が行われます。
                                </p>
                            </div>
                            <div id="rfc.section.2.1.1.p.2">
                                <p>メッセージ内に複数のフィールド値が存在する場合、これらは直列化前に単一の List または Dictionary 構造に結合されなければなりません（<em
                                        class="bcp14">MUST</em>）。</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.3">
                                <p>アプリケーションがフィールドの型を知らない、あるいは型の直列化方法を知らない場合、このフラグを使うとエラーになります。したがって、署名者は検証者のシステムも型を知っている場合にのみこのフラグを使ってフィールドに確実に署名できます。
                                </p>
                            </div>
                            <div id="rfc.section.2.1.1.p.4" class="avoidbreakafter">
                                <p>例えば、次の Dictionary フィールドは有効な直列化の例です：</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.5">
                                <pre class="text">
Example-Dict:  a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre>
                            </div>
                            <div id="rfc.section.2.1.1.p.6" class="avoidbreakafter">
                                <p>パラメータなしで署名ベースに含めた場合、その値は次のようになります：</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.7">
                                <pre>
"example-dict": a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre>
                            </div>
                            <div id="rfc.section.2.1.1.p.8" class="avoidbreakafter">
                                <p>しかし、<span class="tt">sf</span> パラメータが追加されると、値は次のように再直列化されます：</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.9">
                                <pre>
"example-dict";sf: a=1, b=2;x=1;y=2, c=(a b c)
</pre>
                            </div>
                            <div id="rfc.section.2.1.1.p.10">
                                <p>結果の文字列がコンポーネント値として使用されます（<a href="#http-fields" title="HTTP Fields">Section 2.1</a>
                                    を参照）。</p>
                            </div>
                        </section>
                        <section id="http-field-dictionary">
                            <h4 id="rfc.section.2.1.2"><a href="#rfc.section.2.1.2">2.1.2.</a>&nbsp;<a
                                    href="#http-field-dictionary">辞書型構造化フィールドのメンバー</a></h4>
                            <div id="rfc.section.2.1.2.p.1">
                                <p>あるフィールドがアプリケーション側で Dictionary Structured Field であると判っている場合、その Dictionary の値内の個別メンバーは
                                    <span class="tt">key</span> パラメータと Dictionary メンバーキーを String 値として用いることで識別できます。
                                </p>
                            </div>
                            <div id="rfc.section.2.1.2.p.2">
                                <p>メッセージ内に複数のフィールド値が存在する場合、これらは正規化の前に単一の Dictionary 構造に結合されなければなりません（<em
                                        class="bcp14">MUST</em>）。</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.3">
                                <p>Dictionary Structured Field の個別メンバー値は、<a
                                        href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4.1.2">Section
                                        4.1.2</a> の直列化アルゴリズムを <span class="tt">member_value</span>
                                    とそのパラメータに対して適用することで正規化されます。具体的には、値は Item または Inner List
                                    として直列化され、すべてのパラメータと可能なサブフィールドは <a
                                        href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4">Section 4</a>
                                    で定義された厳密な直列化ルールに従って直列化されます。</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.4">
                                <p>あるフィールドに対してパラメータ化された各キーは、署名ベース内で複数回出現してはならないことが<em class="bcp14">MUST
                                        NOT</em>です。パラメータ化されたキーは、ソース Dictionary 内での順序に関係なく、署名ベース内では任意の順序で現れてもよい（<em
                                        class="bcp14">MAY</em>）です。</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.5">
                                <p>もしカバー対象として指定された Dictionary キーが Dictionary
                                    内に存在しない場合、それは署名ベース生成時にエラーを引き起こさなければなりません（<em class="bcp14">MUST</em>）。</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.6" class="avoidbreakafter">
                                <p>以下は、次の例のような Dictionary であることがアプリケーションにより判っているヘッダーフィールドに対する、Dictionary
                                    メンバーの正規化済み値の非規範的な例です：</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.7">
                                <pre class="text">
Example-Dict:  a=1, b=2;x=1;y=2, c=(a   b    c), d
</pre>
                            </div>
                            <div id="rfc.section.2.1.2.p.8" class="avoidbreakafter">
                                <p>次の例は、このフィールドの異なるコンポーネント識別子に対する正規化済み値を、<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a> で述べる署名ベース形式で示したものです：</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.9">
                                <pre>
"example-dict";key="a": 1
"example-dict";key="d": ?1
"example-dict";key="b": 2;x=1;y=2
"example-dict";key="c": (a b c)
</pre>
                            </div>
                            <div id="rfc.section.2.1.2.p.10">
                                <p><span class="tt">key="c"</span> の値は厳密な <span class="tt">member_value</span>
                                    アルゴリズムに従って再直列化され、<span class="tt">key="d"</span> の値はブール値として直列化されている点に注意してください。</p>
                            </div>
                        </section>
                        <section id="http-field-byte-sequence">
                            <h4 id="rfc.section.2.1.3"><a href="#rfc.section.2.1.3">2.1.3.</a>&nbsp;<a
                                    href="#http-field-byte-sequence">バイナリでラップされた HTTP フィールド</a></h4>
                            <div id="rfc.section.2.1.3.p.1">
                                <p>対象の HTTP フィールドの値が直列化に関して問題を引き起こすことがアプリケーションにより判っている場合、特に複数値を単一行に結合することで問題が生じるような場合（<a
                                        href="#security-non-list" title="Non-List Field Values">Section 7.5.6</a>
                                    参照）、署名者はコンポーネント識別子に <span class="tt">bs</span>
                                    パラメータを含めて、フィールド値を結合する前にバイナリ構造としてラップする必要があることを示すべきです（<em class="bcp14">SHOULD</em>）。
                                </p>
                            </div>
                            <div id="rfc.section.2.1.3.p.2" class="avoidbreakafter">
                                <p>このパラメータがコンポーネント識別子に含まれる場合、コンポーネント値は次のアルゴリズムに従って計算されなければなりません（<em
                                        class="bcp14">MUST</em>）：</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.3">
                                <ol type="1">
                                    <li>入力を、メッセージ内で出現する順序のフィールド値の順序集合とする。</li>
                                    <li>処理済みのフィールド値を蓄積するための空の List を作成する。</li>
                                    <li>
                                        <div class="avoidbreakafter">
                                            <p>集合内の各フィールド値について：</p>
                                        </div>
                                        <div>
                                            <dl>
                                                <dt>11.</dt>
                                                <dd>フィールド値の先頭および末尾の空白を取り除く（準拠実装ではこれは無効操作）。</dd>
                                                <dt>12.</dt>
                                                <dd>行内の obsolete line folding を取り除き、単一のスペース（" "）に置き換える（<a
                                                        href="https://www.rfc-editor.org/rfc/rfc9112.html#section-5.2">Section
                                                        5.2</a> of <a href="#RFC9112"><cite
                                                            title="HTTP/1.1">[HTTP/1.1]</cite></a> を参照）。この挙動は HTTP/1.1
                                                    固有です。</dd>
                                                <dt>13.</dt>
                                                <dd>得られたフィールド値のバイトを Byte Sequence としてエンコードする。ほとんどのフィールドは ASCII
                                                    に制限されますが、一部の実装では他のオクテットが含まれる場合があります。</dd>
                                                <dt>14.</dt>
                                                <dd>Byte Sequence を List 蓄積器に追加する。</dd>
                                            </dl>
                                        </div>
                                    </li>
                                    <li>中間結果は Byte Sequence 値の List になります。</li>
                                    <li><a href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4.1.1">Section
                                            4.1.1</a> の厳密な List の直列化に従い、この出力を返す。</li>
                                </ol>
                            </div>
                            <div id="rfc.section.2.1.3.p.4" class="avoidbreakafter">
                                <p>例えば、内部にカンマを含む次のフィールドは別々のフィールド値を安全に結合できません：</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.5">
                                <pre class="text">
Example-Header: value, with, lots
Example-Header: of, commas
</pre>
                            </div>
                            <div id="rfc.section.2.1.3.p.6" class="avoidbreakafter">
                                <p>この例では、同じフィールドを意味的に異なる単一の値として送ることもできます：</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.7">
                                <pre class="text">
Example-Header: value, with, lots, of, commas
</pre>
                            </div>
                            <div id="rfc.section.2.1.3.p.8" class="avoidbreakafter">
                                <p>アプリケーションはこれら両方を異なったものとして扱います。しかし、パラメータなしで署名ベースに含めると両者のコンポーネント値は同一になります：</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.9">
                                <pre>
"example-header": value, with, lots, of, commas
</pre>
                            </div>
                            <div id="rfc.section.2.1.3.p.10" class="avoidbreakafter">
                                <p>しかし、<span class="tt">bs</span> パラメータが追加されると、2つの別々のインスタンスは次のようにエンコードおよび直列化されます：</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.11">
                                <pre>
"example-header";bs: :dmFsdWUsIHdpdGgsIGxvdHM=:, :b2YsIGNvbW1hcw==:
</pre>
                            </div>
                            <div id="rfc.section.2.1.3.p.12" class="avoidbreakafter">
                                <p>単一インスタンスのフィールドに対する <span class="tt">bs</span> パラメータ付きのエンコードは次の通りです：</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.13">
                                <pre>
"example-header";bs: :dmFsdWUsIHdpdGgsIGxvdHMsIG9mLCBjb21tYXM=:
</pre>
                            </div>
                            <div id="rfc.section.2.1.3.p.14">
                                <p>このコンポーネント値は複数インスタンスのものと異なり、潜在的に悪用されうる衝突を防止します。</p>
                            </div>
                        </section>
                        <section id="http-trailer">
                            <h4 id="rfc.section.2.1.4"><a href="#rfc.section.2.1.4">2.1.4.</a>&nbsp;<a
                                    href="#http-trailer">トレーラーフィールド</a></h4>
                            <div id="rfc.section.2.1.4.p.1">
                                <p>署名者がトレーラフィールドを署名に含めたい場合、署名者は値がヘッダーではなくトレーラから取られることを示すために <span class="tt">tr</span>
                                    ブールパラメータを含めなければなりません（<em class="bcp14">MUST</em>）。</p>
                            </div>
                            <div id="rfc.section.2.1.4.p.2" class="avoidbreakafter">
                                <p>例えば、次のメッセージがあったとします：</p>
                            </div>
                            <div id="rfc.section.2.1.4.p.3">
                                <pre class="text">
HTTP/1.1 200 OK
Content-Type: text/plain
Transfer-Encoding: chunked
Trailer: Expires

4
HTTP
7
Message
a
Signatures
0
Expires: Wed, 9 Nov 2022 07:28:00 GMT
</pre>
                            </div>
                            <div id="rfc.section.2.1.4.p.4" class="avoidbreakafter">
                                <p>署名者は、Trailer ヘッダーフィールドと Expires トレーラーフィールドをステータスコード導出コンポーネントとともに署名ベースに追加することに決めます：
                                </p>
                            </div>
                            <div id="rfc.section.2.1.4.p.5">
                                <pre>
"@status": 200
"trailer": Expires
"expires";tr: Wed, 9 Nov 2022 07:28:00 GMT
</pre>
                            </div>
                            <div id="rfc.section.2.1.4.p.6">
                                <p>フィールドがヘッダーおよびトレーラの両方で利用可能な場合、両方の値を署名することは<em
                                        class="bcp14">MAY</em>ですが、それらは別々に署名されなければなりません（<em
                                        class="bcp14">MUST</em>）。同じ名前のヘッダー値とトレーラ値を署名の目的で結合してはなりません（<em
                                        class="bcp14">MUST NOT</em>）。</p>
                            </div>
                            <div id="rfc.section.2.1.4.p.7">
                                <p>トレーラは中継者によってヘッダーにマージされたり完全に削除される可能性があるため（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-6.5.1">Section
                                        6.5.1</a> of <a href="#RFC9110"><cite
                                            title="HTTP Semantics">[HTTP]</cite></a>）、署名にトレーラを含めるのは署名者が検証者もトレーラ値にアクセスできることを知っている場合を除き<em
                                        class="bcp14">NOT RECOMMENDED</em>です。</p>
                            </div>
                        </section>
                    </section>
                    <section id="derived-components">
                        <h3 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a>&nbsp;<a
                                href="#derived-components">導出コンポーネント</a></h3>
                        <div id="rfc.section.2.2.p.1">
                            <p>HTTP フィールドに加えて、制御データ、署名コンテキスト、または署名される HTTP
                                メッセージのその他の側面から導出できるさまざまなコンポーネントがあります。そのような導出コンポーネントは、コンポーネント名、可能なパラメータ、メッセージターゲット、およびそのコンポーネント値の導出方法を定義することで署名ベースに含められます。
                            </p>
                        </div>
                        <div id="rfc.section.2.2.p.2">
                            <p>導出コンポーネント名は <span class="tt">@</span> 文字で始まらなければならないことが<em
                                    class="bcp14">MUST</em>です。これにより導出コンポーネント名は HTTP フィールド名（<a
                                    href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.1">Section 5.1</a> に従い
                                <span class="tt">@</span> を含められない）と区別されます。HTTP
                                メッセージ署名のプロセッサは導出コンポーネント名をフィールド名とは別に扱わなければなりません（<a href="#security-lazy-header-parser"
                                    title="Processing Invalid HTTP Field Names as Derived Component Names">Section
                                    7.5.1</a> を参照）。
                            </p>
                        </div>
                        <div id="rfc.section.2.2.p.3" class="avoidbreakafter">
                            <p>本仕様は次の導出コンポーネントを定義します：</p>
                        </div>
                        <div id="rfc.section.2.2.p.4">
                            <dl>
                                <dt>@method</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>リクエストで使用されたメソッド（<a href="#content-request-method" title="Method">Section
                                            2.2.1</a>）。</div>
                                </dd>
                                <dt>@target-uri</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>リクエストの完全なターゲット URI（<a href="#content-target-uri" title="Target URI">Section
                                            2.2.2</a>）。</div>
                                </dd>
                                <dt>@authority</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>リクエストのターゲット URI のオーソリティ（<a href="#content-request-authority"
                                            title="Authority">Section 2.2.3</a>）。</div>
                                </dd>
                                <dt>@scheme</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>リクエストのターゲット URI のスキーム（<a href="#content-request-scheme" title="Scheme">Section
                                            2.2.4</a>）。</div>
                                </dd>
                                <dt>@request-target</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>リクエストターゲット（<a href="#content-request-target" title="Request Target">Section
                                            2.2.5</a>）。</div>
                                </dd>
                                <dt>@path</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>リクエストのターゲット URI の絶対パス部分（<a href="#content-request-path" title="Path">Section
                                            2.2.6</a>）。</div>
                                </dd>
                                <dt>@query</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>リクエストのターゲット URI のクエリ部分（<a href="#content-request-query" title="Query">Section
                                            2.2.7</a>）。</div>
                                </dd>
                                <dt>@query-param</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>リクエストのターゲット URI の解析およびエンコードされたクエリパラメータ（<a href="#content-request-query-param"
                                            title="Query Parameters">Section 2.2.8</a>）。</div>
                                </dd>
                                <dt>@status</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>レスポンスのステータスコード（<a href="#content-status-code" title="Status Code">Section
                                            2.2.9</a>）。</div>
                                </dd>
                            </dl>
                        </div>
                        <div id="rfc.section.2.2.p.5">
                            <p>追加の導出コンポーネント名は "HTTP Signature Derived Component Names" レジストリ（<a href="#content-registry"
                                    title="HTTP Signature Derived Component Names Registry">Section 6.4</a>）で定義されます。</p>
                        </div>
                        <div id="rfc.section.2.2.p.6">
                            <p>導出コンポーネント値は署名の対象メッセージのコンテキストから取られます。このコンテキストにはメッセージ自体に関する情報（制御データなど）や、署名者や検証者が保持する追加の状態やコンテキストが含まれます。特に、レスポンスに署名する際には、署名者は
                                <span class="tt">req</span> パラメータを使用して元のリクエストから導出された任意の導出コンポーネントを含めることができます（<a
                                    href="#content-request-response"
                                    title="Signing Request Components in a Response Message">Section 2.4</a>）。
                            </p>
                        </div>
                        <div id="rfc.section.2.2.p.7">
                            <dl>
                                <dt>request:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>HTTP リクエストメッセージから導出された値およびその結果。<a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html#section-3.4">Section
                                            3.4</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>
                                        を参照。ターゲットメッセージがレスポンスである場合、<a href="#content-request-response"
                                            title="Signing Request Components in a Response Message">Section 2.4</a>
                                        で定義された <span class="tt">req</span> パラメータを用いることでリクエストをターゲットとする導出コンポーネントを含められる。
                                    </div>
                                </dd>
                                <dt>response:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>HTTP レスポンスメッセージから導出された値およびその結果（<a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html#section-3.4">Section
                                            3.4</a> を参照）。</div>
                                </dd>
                                <dt>request, response:</dt>
                                <dd style="margin-left: 1.5em">リクエストメッセージまたはレスポンスメッセージのいずれから導出された値。</dd>
                            </dl>
                        </div>
                        <div id="rfc.section.2.2.p.8">
                            <p>導出コンポーネント定義は適用可能なすべてのターゲットメッセージ型を定義しなければなりません（<em class="bcp14">MUST</em>）。</p>
                        </div>
                        <div id="rfc.section.2.2.p.9">
                            <p>導出コンポーネント値は印刷可能文字とスペースに限定され、改行文字を含んではならないことが<em
                                    class="bcp14">MUST</em>です。導出コンポーネント値は先頭または末尾に空白文字を持ってはなりません（<em class="bcp14">MUST
                                    NOT</em>）。</p>
                        </div>
                        <section id="content-request-method">
                            <h4 id="rfc.section.2.2.1"><a href="#rfc.section.2.2.1">2.2.1.</a>&nbsp;<a
                                    href="#content-request-method">メソッド</a></h4>
                            <div id="rfc.section.2.2.1.p.1">
                                <p><span class="tt">@method</span> 導出コンポーネントはリクエストメッセージの HTTP
                                    メソッドを指します。コンポーネント値はメソッドの文字列値をそのまま取り正規化します。メソッド名は <a href="#RFC9110"><cite
                                            title="HTTP Semantics">[HTTP]</cite></a> の規定に従って大文字小文字を区別することに注意してください（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-9.1">Section
                                        9.1</a>）。慣習的に標準化されたメソッド名は大文字ですが（<a href="#RFC0020"><cite
                                            title="ASCII format for network interchange">[ASCII]</cite></a>）、入力メソッド値のケースを変換してはなりません。
                                </p>
                            </div>
                            <div id="rfc.section.2.2.1.p.2" class="avoidbreakafter">
                                <p>例えば、次のようなリクエストメッセージ：</p>
                            </div>
                            <div id="rfc.section.2.2.1.p.3">
                                <pre class="text">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.1.p.4" class="avoidbreakafter">
                                <p>は次の <span class="tt">@method</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.1.p.5">
                                <pre>
POST
</pre>
                            </div>
                            <div id="rfc.section.2.2.1.p.6" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.1.p.7">
                                <pre>
"@method": POST
</pre>
                            </div>
                        </section>
                        <section id="content-target-uri">
                            <h4 id="rfc.section.2.2.2"><a href="#rfc.section.2.2.2">2.2.2.</a>&nbsp;<a
                                    href="#content-target-uri">ターゲット URI</a></h4>
                            <div id="rfc.section.2.2.2.p.1">
                                <p><span class="tt">@target-uri</span> 導出コンポーネントはリクエストメッセージのターゲット URI
                                    を指します。コンポーネント値はリクエストのターゲット URI（<a href="#RFC9110"><cite
                                            title="HTTP Semantics">[HTTP]</cite></a>、<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.1">Section
                                        7.1</a>）であり、オーソリティを含む利用可能なすべての URI コンポーネントから組み立てられます。</p>
                            </div>
                            <div id="rfc.section.2.2.2.p.2" class="avoidbreakafter">
                                <p>例えば、HTTPS 経由で送られた次のメッセージ：</p>
                            </div>
                            <div id="rfc.section.2.2.2.p.3">
                                <pre class="text">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.2.p.4" class="avoidbreakafter">
                                <p>は次の <span class="tt">@target-uri</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.2.p.5">
                                <pre>
https://www.example.com/path?param=value
</pre>
                            </div>
                            <div id="rfc.section.2.2.2.p.6" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.2.p.7">
                                <pre>
"@target-uri": https://www.example.com/path?param=value
</pre>
                            </div>
                        </section>
                        <section id="content-request-authority">
                            <h4 id="rfc.section.2.2.3"><a href="#rfc.section.2.2.3">2.2.3.</a>&nbsp;<a
                                    href="#content-request-authority">オーソリティ</a></h4>
                            <div id="rfc.section.2.2.3.p.1">
                                <p><span class="tt">@authority</span> 導出コンポーネントは HTTP リクエストのターゲット URI のオーソリティ部分を指します（<a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>、<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.2">Section
                                        7.2</a>）。HTTP/1.1 では通常 Host ヘッダーフィールドで伝えられ、HTTP/2 と HTTP/3 では :authority
                                    擬似ヘッダで伝えられます。値はホストと（オプションで）ポートからなる完全修飾のオーソリティコンポーネントで文字列として表されます。コンポーネント値は <a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a> の規則（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-4.2.3">Section
                                        4.2.3</a>）に従って正規化されなければなりません（<em
                                        class="bcp14">MUST</em>）。すなわち、ホスト名は小文字に正規化され、デフォルトポートは省略されます。</p>
                            </div>
                            <div id="rfc.section.2.2.3.p.2" class="avoidbreakafter">
                                <p>例えば、次のリクエストメッセージ：</p>
                            </div>
                            <div id="rfc.section.2.2.3.p.3">
                                <pre class="text">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.3.p.4" class="avoidbreakafter">
                                <p>は次の <span class="tt">@authority</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.3.p.5">
                                <pre>
www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.3.p.6" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.3.p.7">
                                <pre>
"@authority": www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.3.p.8">
                                <p><span class="tt">@authority</span> 導出コンポーネントは Host ヘッダーフィールドを直接署名する代わりに用いることが<em
                                        class="bcp14">SHOULD</em>推奨されます。詳細は <a href="#security-not-fields"
                                        title="Choosing Signature Parameters and Derived Components over HTTP Fields">Section
                                        7.2.4</a> を参照してください。</p>
                            </div>
                        </section>
                        <section id="content-request-scheme">
                            <h4 id="rfc.section.2.2.4"><a href="#rfc.section.2.2.4">2.2.4.</a>&nbsp;<a
                                    href="#content-request-scheme">スキーム</a></h4>
                            <div id="rfc.section.2.2.4.p.1">
                                <p><span class="tt">@scheme</span> 導出コンポーネントはリクエストのターゲット URL のスキームを指します。コンポーネント値は <a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>
                                    の定義に従って小文字化された文字列として表されなければなりません（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-4.2">Section
                                        4.2</a>）。スキーム自体は大文字小文字を区別しませんが、署名ベースに含める際は小文字に正規化することが<em
                                        class="bcp14">MUST</em>です。</p>
                            </div>
                            <div id="rfc.section.2.2.4.p.2" class="avoidbreakafter">
                                <p>例えば、平文 HTTP で送られた次のリクエストメッセージ：</p>
                            </div>
                            <div id="rfc.section.2.2.4.p.3">
                                <pre class="text">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.4.p.4" class="avoidbreakafter">
                                <p>は次の <span class="tt">@scheme</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.4.p.5">
                                <pre>
http
</pre>
                            </div>
                            <div id="rfc.section.2.2.4.p.6" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.4.p.7">
                                <pre>
"@scheme": http
</pre>
                            </div>
                        </section>
                        <section id="content-request-target">
                            <h4 id="rfc.section.2.2.5"><a href="#rfc.section.2.2.5">2.2.5.</a>&nbsp;<a
                                    href="#content-request-target">リクエストターゲット</a></h4>
                            <div id="rfc.section.2.2.5.p.1">
                                <p><span class="tt">@request-target</span> 導出コンポーネントは HTTP
                                    リクエストメッセージの完全なリクエストターゲットを指します（<a href="#RFC9110"><cite
                                            title="HTTP Semantics">[HTTP]</cite></a>、<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.1">Section
                                        7.1</a>）。リクエストターゲットのコンポーネント値は、リクエストの種類に応じて異なる形式を取ることがあります。</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.2">
                                <p>HTTP/1.1 ではコンポーネント値はリクエスト行のリクエストターゲット部分と同等です。しかし、この値は他の HTTP
                                    バージョンでは確実に構築するのが難しいため、HTTP/1.1 以外のバージョンが使用され得る場合はこのコンポーネントの使用は<em class="bcp14">NOT
                                        RECOMMENDED</em>です。</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.3">
                                <p>origin form の値は絶対パスとクエリの結合です。</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.4" class="avoidbreakafter">
                                <p>例えば、次のリクエストメッセージ：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.5">
                                <pre class="text">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.6" class="avoidbreakafter">
                                <p>は次の <span class="tt">@request-target</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.7">
                                <pre>
/path?param=value
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.8" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.9">
                                <pre>
"@request-target": /path?param=value
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.10" class="avoidbreakafter">
                                <p>絶対形式を用いる HTTP プロキシへの次のリクエスト（完全修飾ターゲット URI を含む）：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.11">
                                <pre class="text">
GET https://www.example.com/path?param=value HTTP/1.1
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.12" class="avoidbreakafter">
                                <p>は次の <span class="tt">@request-target</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.13">
                                <pre>
https://www.example.com/path?param=value
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.14" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.15">
                                <pre>
"@request-target": https://www.example.com/path?param=value
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.16" class="avoidbreakafter">
                                <p>ホストとポートを含む authority-form 値を持つ次の CONNECT リクエスト：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.17">
                                <pre class="text">
CONNECT www.example.com:80 HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.18" class="avoidbreakafter">
                                <p>は次の <span class="tt">@request-target</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.19">
                                <pre>
www.example.com:80
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.20" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.21">
                                <pre>
"@request-target": www.example.com:80
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.22" class="avoidbreakafter">
                                <p>次に、単一のアスタリスク（<span class="tt">*</span>）文字を含む asterisk-form 値を持つ OPTIONS リクエスト：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.23">
                                <pre class="text">
OPTIONS * HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.24" class="avoidbreakafter">
                                <p>は次の <span class="tt">@request-target</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.25">
                                <pre>
*
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.26" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.27">
                                <pre>
"@request-target": *
</pre>
                            </div>
                        </section>
                        <section id="content-request-path">
                            <h4 id="rfc.section.2.2.6"><a href="#rfc.section.2.2.6">2.2.6.</a>&nbsp;<a
                                    href="#content-request-path">パス</a></h4>
                            <div id="rfc.section.2.2.6.p.1">
                                <p><span class="tt">@path</span> 導出コンポーネントは HTTP リクエストのターゲットパスを指します。コンポーネント値は <a
                                        href="#RFC3986"><cite
                                            title="Uniform Resource Identifier (URI): Generic Syntax">[URI]</cite></a>
                                    によって定義されるリクエストターゲットの絶対パスであり、クエリ成分や末尾の疑問符（<span class="tt">?</span>）を含みません。値は <a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a> の規則（<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-4.2.3">Section
                                        4.2.3</a>）に従って正規化されます。空のパス文字列はスラッシュ（<span
                                        class="tt">/</span>）ひとつに正規化されます。パス成分はパーセントエンコードされたオクテットをデコードする前の値で表され、<a
                                        href="https://www.rfc-editor.org/rfc/rfc3986.html#section-6.2.1">Section
                                        6.2.1</a> の単純文字列比較規則に従います。</p>
                            </div>
                            <div id="rfc.section.2.2.6.p.2" class="avoidbreakafter">
                                <p>例えば、次のリクエストメッセージ：</p>
                            </div>
                            <div id="rfc.section.2.2.6.p.3">
                                <pre class="text">
GET /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.6.p.4" class="avoidbreakafter">
                                <p>は次の <span class="tt">@path</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.6.p.5">
                                <pre>
/path
</pre>
                            </div>
                            <div id="rfc.section.2.2.6.p.6" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.6.p.7">
                                <pre>
"@path": /path
</pre>
                            </div>
                        </section>
                        <section id="content-request-query">
                            <h4 id="rfc.section.2.2.7"><a href="#rfc.section.2.2.7">2.2.7.</a>&nbsp;<a
                                    href="#content-request-query">クエリ</a></h4>
                            <div id="rfc.section.2.2.7.p.1">
                                <p><span class="tt">@query</span> 導出コンポーネントは HTTP リクエストのクエリ成分を指します。コンポーネント値は先頭の疑問符（<span
                                        class="tt">?</span>）を含む正規化されたクエリ文字列であり、<a href="#RFC3986"><cite
                                            title="Uniform Resource Identifier (URI): Generic Syntax">[URI]</cite></a>
                                    によって定義されます。値は <a
                                        href="https://www.rfc-editor.org/rfc/rfc3986.html#section-6.2.1">Section
                                        6.2.1</a> の単純文字列比較規則に従って読み取られ、パーセントエンコードされたオクテットはデコードされません。</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.2" class="avoidbreakafter">
                                <p>例えば、次のリクエストメッセージ：</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.3">
                                <pre class="text">
GET /path?param=value&amp;foo=bar&amp;baz=bat%2Dman HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.4" class="avoidbreakafter">
                                <p>は次の <span class="tt">@query</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.5">
                                <pre>
?param=value&amp;foo=bar&amp;baz=bat%2Dman
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.6" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.7">
                                <pre>
"@query": ?param=value&amp;foo=bar&amp;baz=bat%2Dman
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.8" class="avoidbreakafter">
                                <p>次のリクエストメッセージ：</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.9">
                                <pre class="text">
POST /path?queryString HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.10" class="avoidbreakafter">
                                <p>は次の <span class="tt">@query</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.11">
                                <pre>
?queryString
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.12" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.13">
                                <pre>
"@query": ?queryString
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.14" class="avoidbreakafter">
                                <p>空のパス成分を含めるのと同様に、署名者はこのコンポーネントを空のクエリ成分（クエリ文字列がリクエストメッセージに存在しない場合、先頭の疑問符のみ）として含めることで、このコンポーネントがメッセージで使用されていないことを示せます：
                                </p>
                            </div>
                            <div id="rfc.section.2.2.7.p.15">
                                <pre>
?
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.16" class="avoidbreakafter">
                                <p>結果として次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.17">
                                <pre>
"@query": ?
</pre>
                            </div>
                        </section>
                        <section id="content-request-query-param">
                            <h4 id="rfc.section.2.2.8"><a href="#rfc.section.2.2.8">2.2.8.</a>&nbsp;<a
                                    href="#content-request-query-param">クエリパラメータ</a></h4>
                            <div id="rfc.section.2.2.8.p.1">
                                <p>リクエストターゲット URI のクエリ部分が HTML フォームパラメータ形式（<a href="#HTMLURL"><cite
                                            title="URL (Living Standard)">[HTMLURL]</cite></a> の該当セクション）を使用している場合、<span
                                        class="tt">@query-param</span> 導出コンポーネントは個々のクエリパラメータを参照できます。クエリパラメータは <a
                                        href="#HTMLURL"><cite title="URL (Living Standard)">[HTMLURL]</cite></a>
                                    の該当節に従ってパースされ、(<span class="tt">nameString</span>, <span
                                        class="tt">valueString</span>) のタプルのリストが得られます。各コンポーネント識別子の必須の <span
                                        class="tt">name</span> パラメータは単一のクエリパラメータのエンコード済みの <span
                                        class="tt">nameString</span> を String
                                    値として含みます。単一の指定パラメータのコンポーネント値は、その単一のクエリパラメータのエンコード済み <span
                                        class="tt">valueString</span> です。複数の名前付きクエリパラメータをカバーに含めることは<em
                                        class="bcp14">MAY</em>です。単一の名前付きパラメータはクエリ文字列内の順序に関係なくカバーリスト内で任意の順序で出現してもよい（<em
                                        class="bcp14">MAY</em>）。</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.2" class="avoidbreakafter">
                                <p><span class="tt">name</span> パラメータの値および単一の名前付きパラメータのコンポーネント値は次の手順で計算されます：</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.3">
                                <ol type="1">
                                    <li>
                                        <p><span class="tt">nameString</span> または <span class="tt">valueString</span> を
                                            <a href="#HTMLURL"><cite title="URL (Living Standard)">[HTMLURL]</cite></a>
                                            の該当節に従ってパースする（パーセントエンコードされたオクテットをデコードした後の値）。
                                        </p>
                                    </li>
                                    <li>
                                        <p>得られた <span class="tt">nameString</span> または <span
                                                class="tt">valueString</span> を <a href="#HTMLURL"><cite
                                                    title="URL (Living Standard)">[HTMLURL]</cite></a> の「percent-encode
                                            after encoding」プロセスに従ってエンコードし、ASCII 文字列にする（該当節参照）。</p>
                                    </li>
                                    <li>
                                        <p>その ASCII 文字列を出力する。</p>
                                    </li>
                                </ol>
                            </div>
                            <div id="rfc.section.2.2.8.p.4">
                                <p>コンポーネント値は先頭の疑問符（<span class="tt">?</span>）、等号（<span
                                        class="tt">=</span>）、または区切りのアンパサンド（<span class="tt">&amp;</span>）を含みません。値が空の
                                    <span class="tt">valueString</span>
                                    を持つ名前付きパラメータは空文字列をコンポーネント値として持ちます。実装の不一致により、空の値を廃棄するライブラリがある点に注意してください。
                                </p>
                            </div>
                            <div id="rfc.section.2.2.8.p.5">
                                <p>もしカバー対象として指定された名前付きクエリパラメータがクエリ内に存在しない場合、それは署名ベース生成時にエラーを引き起こさなければなりません（<em
                                        class="bcp14">MUST</em>）。</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.6" class="avoidbreakafter">
                                <p>例えば、次のリクエストに対して：</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.7">
                                <pre class="text">
GET /path?param=value&amp;foo=bar&amp;baz=batman&amp;qux= HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.8.p.8" class="avoidbreakafter">
                                <p>このリクエストの <span class="tt">baz</span>, <span class="tt">qux</span>, <span
                                        class="tt">param</span> を指定すると、次の <span class="tt">@query-param</span>
                                    コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.9">
                                <p><em>baz</em>: <span class="tt">batman</span></p>
                            </div>
                            <div id="rfc.section.2.2.8.p.10">
                                <p><em>qux</em>: 空文字列</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.11">
                                <p><em>param</em>: <span class="tt">value</span></p>
                            </div>
                            <div id="rfc.section.2.2.8.p.12" class="avoidbreakafter">
                                <p>そして、(SP) が空のコンポーネント値の前の単一のトレーリングスペースを示すとして、次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.13">
                                <pre>
"@query-param";name="baz": batman
"@query-param";name="qux":(SP)
"@query-param";name="param": value
</pre>
                            </div>
                            <div id="rfc.section.2.2.8.p.14">
                                <p>この導出コンポーネントにはいくつかの制限があります。具体的には、<a href="#HTMLURL"><cite
                                            title="URL (Living Standard)">[HTMLURL]</cite></a> の該当節で提供されるアルゴリズムは
                                    percent-escaped UTF-8
                                    を用いるクエリパラメータのみをサポートします。その他のエンコーディングはサポートされません。さらに、同一名前のパラメータが複数回現れるケースはワイルドでは確実にサポートされていません。もしパラメータ名がリクエスト内で複数回出現する場合、その名前付きクエリパラメータは含めてはならない（<em
                                        class="bcp14">MUST NOT</em>）ことになっています。アプリケーション内で複数パラメータが一般的である場合は、<a
                                        href="#content-request-query" title="Query">Section 2.2.7</a> に定義された <span
                                        class="tt">@query</span> コンポーネントでクエリ全体を署名することが<em
                                        class="bcp14">RECOMMENDED</em>です。</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.15" class="avoidbreakafter">
                                <p>エンコードプロセスは、値に改行やその他の問題のある文字を含むクエリパラメータや、スペースをプラス（+）で表すような代替エンコーディングを含むクエリパラメータを許容します。次のメッセージ中のクエリパラメータについて：
                                </p>
                            </div>
                            <div id="rfc.section.2.2.8.p.16">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /parameters?var=this%20is%20a%20big%0Amultiline%20value&amp;\
  bar=with+plus+whitespace&amp;fa%C3%A7ade%22%3A%20=something HTTP/1.1
Host: www.example.com
Date: Tue, 20 Apr 2021 02:07:56 GMT
</pre>
                            </div>
                            <div id="rfc.section.2.2.8.p.17" class="avoidbreakafter">
                                <p>得られる値は次のようにエンコードされます：</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.18">
                                <pre>
"@query-param";name="var": this%20is%20a%20big%0Amultiline%20value
"@query-param";name="bar": with%20plus%20whitespace
"@query-param";name="fa%C3%A7ade%22%3A%20": something
</pre>
                            </div>
                            <div id="rfc.section.2.2.8.p.19" class="avoidbreakafter">
                                <p>もしエンコードが適用されなければ、得られる値は次のようになります：</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.20">
                                <pre>
"@query-param";name="var": this is a big
multiline value
"@query-param";name="bar": with plus whitespace
"@query-param";name="façade\": ": something
</pre>
                            </div>
                            <div id="rfc.section.2.2.8.p.21">
                                <p>このベース文字列はコンポーネント名と値に対する制約に違反する文字を含んでいるため無効です。</p>
                            </div>
                        </section>
                        <section id="content-status-code">
                            <h4 id="rfc.section.2.2.9"><a href="#rfc.section.2.2.9">2.2.9.</a>&nbsp;<a
                                    href="#content-status-code">ステータスコード</a></h4>
                            <div id="rfc.section.2.2.9.p.1">
                                <p><span class="tt">@status</span> 導出コンポーネントはレスポンスメッセージの 3 桁の数値 HTTP ステータスコードを指します（<a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>、<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-15">Section
                                        15</a>）。コンポーネント値は説明テキストを含まない 3 桁の整数の直列化です。</p>
                            </div>
                            <div id="rfc.section.2.2.9.p.2" class="avoidbreakafter">
                                <p>例えば、次のレスポンスメッセージ：</p>
                            </div>
                            <div id="rfc.section.2.2.9.p.3">
                                <pre class="text">
HTTP/1.1 200 OK
Date: Fri, 26 Mar 2010 00:05:00 GMT
</pre>
                            </div>
                            <div id="rfc.section.2.2.9.p.4" class="avoidbreakafter">
                                <p>は次の <span class="tt">@status</span> コンポーネント値になります：</p>
                            </div>
                            <div id="rfc.section.2.2.9.p.5">
                                <pre>
200
</pre>
                            </div>
                            <div id="rfc.section.2.2.9.p.6" class="avoidbreakafter">
                                <p>および次の署名ベース行になります：</p>
                            </div>
                            <div id="rfc.section.2.2.9.p.7">
                                <pre>
"@status": 200
</pre>
                            </div>
                            <div id="rfc.section.2.2.9.p.8">
                                <p><span class="tt">@status</span> コンポーネント識別子はリクエストメッセージで使用してはなりません（<em
                                        class="bcp14">MUST NOT</em>）。</p>
                            </div>
                        </section>
                    </section>
                    <section id="signature-params">
                        <h3 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3.</a>&nbsp;<a
                                href="#signature-params">署名パラメータ</a></h3>
                        <div id="rfc.section.2.3.p.1">
                            <p>HTTP
                                メッセージ署名には、カバーされたコンポーネントの順序付けられた集合や、署名作成のタイムスタンプ、検証鍵素材の識別子、およびその他のユーティリティを含む順序付けられたパラメータ集合など、署名の生成と検証に関するメタデータプロパティがあります。このメタデータは署名ベース内の特別なメッセージコンポーネントによって表され、他のメッセージコンポーネントとは若干異なる扱いを受けます。具体的には、署名パラメータのメッセージコンポーネントは署名ベースの最後の行として含めることが<em
                                    class="bcp14">REQUIRED</em>であり（<a href="#create-sig-input"
                                    title="Creating the Signature Base">Section
                                    2.5</a>）、このコンポーネント識別子自体を含めてどの署名でもカバーコンポーネントの集合内で列挙してはなりません（<em class="bcp14">MUST
                                    NOT</em>）。</p>
                        </div>
                        <div id="rfc.section.2.3.p.2">
                            <p>署名パラメータのコンポーネント名は <span class="tt">@signature-params</span> です。</p>
                        </div>
                        <div id="rfc.section.2.3.p.3" class="avoidbreakafter">
                            <p>署名パラメータのコンポーネント値は、この署名のための署名パラメータの直列化であり、カバーされたコンポーネントの順序付けられた集合とすべての関連パラメータを含みます。これらのパラメータには次のものが含まれ得ます：
                            </p>
                        </div>
                        <div id="rfc.section.2.3.p.4">
                            <dl>
                                <dt><span class="tt">created</span>:</dt>
                                <dd style="margin-left: 1.5em">作成時刻を UNIX タイムスタンプの Integer
                                    型で示します。小数秒精度はサポートされません。このパラメータの包含は<em class="bcp14">RECOMMENDED</em>です。</dd>
                                <dt><span class="tt">expires</span>:</dt>
                                <dd style="margin-left: 1.5em">有効期限時刻を UNIX タイムスタンプの Integer 型で示します。小数秒精度はサポートされません。
                                </dd>
                                <dt><span class="tt">nonce</span>:</dt>
                                <dd style="margin-left: 1.5em">この署名のために生成されたランダムで一意な文字列値。</dd>
                                <dt><span class="tt">alg</span>:</dt>
                                <dd style="margin-left: 1.5em">"HTTP Signature Algorithms" レジストリからの HTTP メッセージ署名アルゴリズムを
                                    String 値として示します。</dd>
                                <dt><span class="tt">keyid</span>:</dt>
                                <dd style="margin-left: 1.5em">鍵素材の識別子を String 値として示します。</dd>
                                <dt><span class="tt">tag</span>:</dt>
                                <dd style="margin-left: 1.5em">アプリケーション固有の署名タグを String
                                    値として示します。これは特定のアプリケーションやプロトコルに関連する署名を識別するのに用いられます。</dd>
                            </dl>
                        </div>
                        <div id="rfc.section.2.3.p.5">
                            <p>追加のパラメータは "HTTP Signature Metadata Parameters" レジストリ（<a href="#param-registry"
                                    title="HTTP Signature Metadata Parameters Registry">Section
                                    6.3</a>）で定義できます。パラメータ群には一般的な順序はありませんが、一度特定のパラメータ集合に順序を選択するとその順序は署名パラメータ値を変更せずには変えられません。
                            </p>
                        </div>
                        <div id="rfc.section.2.3.p.6" class="avoidbreakafter">
                            <p>署名パラメータコンポーネント値は <a href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4">Section
                                    4</a> of <a href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> に従う
                                parameterized Inner List として次のように直列化されます：</p>
                        </div>
                        <div id="rfc.section.2.3.p.7">
                            <ol type="1">
                                <li>出力を空文字列とする。</li>
                                <li><span class="tt">@signature-params</span>
                                    コンポーネント識別子自体を除いた、カバーされたコンポーネントのコンポーネント識別子の順序を決定する。いったん選択された順序は変更できません。この順序は署名ベースの作成に使用した順序と同一でなければなりません（<em
                                        class="bcp14">MUST</em>）。</li>
                                <li>カバーされたコンポーネントのコンポーネント識別子（すべてのパラメータを含む）を、String 値の順序付き Inner List として <a
                                        href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4.1.1.1">Section
                                        4.1.1.1</a>
                                    の規則に従って直列化し、これを出力に追加する。コンポーネント識別子は自身のパラメータを含むことができ、これらのパラメータは順序付けられた集合である。あるコンポーネントのパラメータの順序が一度選択されると、その順序は変更できない。
                                </li>
                                <li>署名パラメータの順序を決定する。一度選択された順序は変更できない。</li>
                                <li>利用可能な、またはこのメッセージ署名に使用されるパラメータを <a
                                        href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4.1.1.2">Section
                                        4.1.1.2</a> の規則に従って Inner List に順序付けて追加する。</li>
                                <li>出力が署名パラメータコンポーネント値を含む。</li>
                            </ol>
                        </div>
                        <div id="rfc.section.2.3.p.8">
                            <p>ここで <a href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4.1.1.1">Section
                                    4.1.1.1</a> の Inner List の直列化をカバーコンポーネント値に使用するのは、<a href="#signature-input-header"
                                    title="The Signature-Input HTTP Field">Section 4.1</a> で議論される Signature-Input
                                フィールドへの並列性を促進するためです。</p>
                        </div>
                        <div id="rfc.section.2.3.p.9" class="avoidbreakafter">
                            <p>次の例は、例示的なメッセージ署名のパラメータに対する直列化されたコンポーネント値を示します：</p>
                        </div>
                        <div id="rfc.section.2.3.p.10">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

("@target-uri" "@authority" "date" "cache-control")\
  ;keyid="test-key-rsa-pss";alg="rsa-pss-sha512";\
  created=1618884475;expires=1618884775
</pre>
                        </div>
                        <div id="rfc.section.2.3.p.11">
                            <p>HTTP メッセージは複数の署名を含み得ます（<a href="#signature-multiple" title="Multiple Signatures">Section
                                    4.3</a> を参照）が、単一の署名に使われる署名パラメータのみが各署名パラメータエントリに含まれる点に注意してください。</p>
                        </div>
                    </section>
                    <section id="content-request-response">
                        <h3 id="rfc.section.2.4"><a href="#rfc.section.2.4">2.4.</a>&nbsp;<a
                                href="#content-request-response">レスポンスメッセージ内でのリクエスト構成要素の署名</a>
                        </h3>
                        <div id="rfc.section.2.4.p.1">
                            <p>リクエストメッセージが署名されたレスポンスメッセージを生じさせる場合、署名者はコンポーネント識別子に <span class="tt">req</span>
                                パラメータを追加することでリクエストメッセージの一部を署名ベースに含めることができます。</p>
                        </div>
                        <div id="rfc.section.2.4.p.2">
                            <dl>
                                <dt><span class="tt">req</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>このコンポーネント値が署名対象のレスポンスメッセージではなく、このレスポンスを引き起こしたリクエストから導出されることを示すブールフラグ。</div>
                                </dd>
                            </dl>
                        </div>
                        <div id="rfc.section.2.4.p.3">
                            <p>このパラメータは HTTP
                                フィールドとリクエストをターゲットとする導出コンポーネントの両方に適用でき、同じ意味を持ちます。このパラメータを用いるメッセージコンポーネントのコンポーネント値は通常どおり計算されますが、データは署名が適用される対象のレスポンスメッセージの代わりにリクエストメッセージから引き出されます。
                            </p>
                        </div>
                        <div id="rfc.section.2.4.p.4">
                            <p>同じコンポーネント名は <span class="tt">req</span> パラメータの有無にかかわらず同一署名ベース内に含められてもよく（<em
                                    class="bcp14">MAY</em>）、それはリクエストメッセージとレスポンスメッセージの同名コンポーネントをそれぞれ示すことになります。</p>
                        </div>
                        <div id="rfc.section.2.4.p.5">
                            <p><span class="tt">req</span> パラメータはコンポーネント識別子に対して他のパラメータと組み合わせて用いることが<em
                                    class="bcp14">MAY</em>です（例えば Dictionary フィールドの <span class="tt">key</span> パラメータなど）。
                            </p>
                        </div>
                        <div id="rfc.section.2.4.p.6" class="avoidbreakafter">
                            <p>例えば、次のリクエストに対するレスポンスを返す場合：</p>
                        </div>
                        <div id="rfc.section.2.4.p.7">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Type: application/json
Content-Length: 18

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.8" class="avoidbreakafter">
                            <p>これに対する次のような未署名のレスポンスが生成されるとします：</p>
                        </div>
                        <div id="rfc.section.2.4.p.9">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 503 Service Unavailable
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 62
Content-Digest: sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObfwn\
  HJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:

{"busy": true, "message": "Your call is very important to us"}
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.10">
                            <p>サーバーはレスポンスに対して自身の鍵で署名し、このアプリケーションにとって妥当な量のレスポンスをカバーするためにステータスコードやいくつかのヘッダーフィールドをカバーコンポーネントに含めます。加えて、サーバーはこのレスポンスを引き起こした元のリクエストメッセージから導出されたいくつかのコンポーネントをレスポンスのカバーコンポーネントに含めます。この例ではサーバーはリクエストのメソッド、オーソリティ、パス、および
                                Content-Digest をレスポンス署名に含めています。リクエストとレスポンスの両方の Content-Digest
                                がレスポンス署名に含まれています。この例のアプリケーションではクエリはレスポンスに関連がないと見なされ、カバーには含められていません。アプリケーションに応じて別の判断が行われるでしょう（<a
                                    href="#application" title="Application of HTTP Message Signatures">Section 1.4</a>
                                を参照）。</p>
                        </div>
                        <div id="rfc.section.2.4.p.11" class="avoidbreakafter">
                            <p>この例の署名ベースは次のとおりです：</p>
                        </div>
                        <div id="rfc.section.2.4.p.12">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

"@status": 503
"content-digest": sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObf\
  wnHJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
"content-type": application/json
"@authority";req: example.com
"@method";req: POST
"@path";req: /foo
"content-digest";req: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A\
  2svX+TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"@signature-params": ("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "content-digest";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.13" class="avoidbreakafter">
                            <p>署名されたレスポンスメッセージは次のようになります：</p>
                        </div>
                        <div id="rfc.section.2.4.p.14">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 503 Service Unavailable
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 62
Content-Digest: sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObfwn\
  HJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
Signature-Input: reqres=("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "content-digest";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
Signature: reqres=:dMT/A/76ehrdBTD/2Xx8QuKV6FoyzEP/I9hdzKN8LQJLNgzU\
  4W767HK05rx1i8meNQQgQPgQp8wq2ive3tV5Ag==:

{"busy": true, "message": "Your call is very important to us"}
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.15">
                            <p>ここで使われている ECDSA
                                署名アルゴリズムは非決定論的であり、アルゴリズムを実行するたびに異なる署名値が生成されることに注意してください。提示された署名値は与えられた鍵に対して検証可能ですが、新たに生成された署名値が例と一致することは期待されません。詳細は
                                <a href="#security-nondeterministic"
                                    title="Non-deterministic Signature Primitives">Section 7.3.5</a> を参照してください。
                            </p>
                        </div>
                        <div id="rfc.section.2.4.p.16">
                            <p>リクエストからのコンポーネント値がレスポンスに繰り返されない場合、要求者はレスポンスがこれらのコンポーネント識別子パラメータを使って署名されている場合に検証できるよう、元のメッセージコンポーネント値を十分な期間保持しておくことが<em
                                    class="bcp14">MUST</em>です。多くの場合、署名者がリクエストの任意の部分をレスポンスに含める可能性があるため、要求者は元のリクエストメッセージ自体を保持する必要があります。中継者がリクエストをサーバー処理前に変更できる可能性があるため、アプリケーションはそのように変更された値に署名してはならず、クライアントが結果の署名を検証できないようなことがないよう注意する必要があります。
                            </p>
                        </div>
                        <div id="rfc.section.2.4.p.17" class="avoidbreakafter">
                            <p>署名済みリクエストに対してサーバーが署名付きレスポンスを作成することも可能です。この署名済みリクエストの例：</p>
                        </div>
                        <div id="rfc.section.2.4.p.18">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Type: application/json
Content-Length: 18
Signature-Input: sig1=("@method" "@authority" "@path" "@query" \
  "content-digest" "content-type" "content-length")\
  ;created=1618884475;keyid="test-key-rsa-pss"
Signature: sig1=:e8UJ5wMiRaonlth5ERtE8GIiEH7Akcr493nQ07VPNo6y3qvjdK\
  t0fo8VHO8xXDjmtYoatGYBGJVlMfIp06eVMEyNW2I4vN7XDAz7m5v1108vGzaDljr\
  d0H8+SJ28g7bzn6h2xeL/8q+qUwahWA/JmC8aOC9iVnwbOKCc0WSrLgWQwTY6VLp4\
  2Qt7jjhYT5W7/wCvfK9A1VmHH1lJXsV873Z6hpxesd50PSmO+xaNeYvDLvVdZlhtw\
  5PCtUYzKjHqwmaQ6DEuM8udRjYsoNqp2xZKcuCO1nKc0V3RjpqMZLuuyVbHDAbCzr\
  0pg2d2VM/OC33JAU7meEjjaNz+d7LWPg==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.19" class="avoidbreakafter">
                            <p>サーバーはこのレスポンスのいくつかの部分（およびリクエストの複数部分）に署名することを選び、結果として次の署名ベースを作成するかもしれません：</p>
                        </div>
                        <div id="rfc.section.2.4.p.20">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

"@status": 503
"content-digest": sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObf\
  wnHJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
"content-type": application/json
"@authority";req: example.com
"@method";req: POST
"@path";req: /foo
"@query";req: ?param=Value&amp;Pet=dog
"content-digest";req: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A\
  2svX+TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-type";req: application/json
"content-length";req: 18
"@signature-params": ("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "@query";req \
  "content-digest";req "content-type";req "content-length";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.21" class="avoidbreakafter">
                            <p>そして次の署名付きレスポンスになります：</p>
                        </div>
                        <div id="rfc.section.2.4.p.22">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 503 Service Unavailable
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 62
Content-Digest: sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObfwn\
  HJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
Signature-Input: reqres=("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "@query";req \
  "content-digest";req "content-type";req "content-length";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
Signature: reqres=:C73J41GVKc+TYXbSobvZf0CmNcptRiWN+NY1Or0A36ISg6ym\
  dRN6ZgR2QfrtopFNzqAyv+CeWrMsNbcV2Ojsgg==:

{"busy": true, "message": "Your call is very important to us"}
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.23">
                            <p>ここでも ECDSA
                                署名アルゴリズムは非決定論的であるため、アルゴリズムを実行するたびに異なる署名値が生成されます。提示された署名値は与えられた鍵で検証できますが、新しく生成された署名値が例と一致することは期待されません。詳細は
                                <a href="#security-nondeterministic"
                                    title="Non-deterministic Signature Primitives">Section 7.3.5</a> を参照してください。
                            </p>
                        </div>
                        <div id="rfc.section.2.4.p.24">
                            <p>署名済みリクエストに対してレスポンスを署名するアプリケーションは、署名がカバーするコンポーネントのすべてを署名することにより、衝突攻撃の一部に対する十分なカバレッジと保護を提供することが<em
                                    class="bcp14">SHOULD</em>推奨されます（<a href="#security-sign-signature"
                                    title="Signing Signature Values">Section 7.3.7</a> を参照）。この例のサーバーはクライアントのリクエスト署名の
                                Signature-Input フィールドに列挙されたすべてのコンポーネントをレスポンス署名に含めています。</p>
                        </div>
                        <div id="rfc.section.2.4.p.25">
                            <p>リクエストメッセージの Signature と Signature-Input フィールドをレスポンスの署名コンポーネントに含めることは構文的には可能ですが、この慣行は<em
                                    class="bcp14">NOT RECOMMENDED</em>です。署名の署名は期待されるような覆い下の遷移的カバレッジを提供せず、<a
                                    href="#security-sign-signature" title="Signing Signature Values">Section 7.3.7</a>
                                で議論されるいくつかの攻撃に対して脆弱だからです。署名の処理成功や受領を安全に示す必要があるアプリケーションは、そのような信号を安全に送るための代替メカニズムを慎重に指定する必要があります。
                            </p>
                        </div>
                        <div id="rfc.section.2.4.p.26">
                            <p>このフラグを用いる場合、レスポンス署名はリクエストメッセージに含まれるものだけをカバーできることに注意してください。したがって、アプリケーションがリクエストのメッセージ内容をレスポンスの署名に含める必要がある場合、クライアントは
                                Content-Digest フィールドのようなコンテンツをカバーする手段を含める必要があります。詳細は <a href="#security-message-content"
                                    title="Message Content">Section 7.2.8</a> を参照してください。</p>
                        </div>
                        <div id="rfc.section.2.4.p.27">
                            <p><span class="tt">req</span> パラメータはリクエストをターゲットとする署名に対しては使用してはなりません（<em class="bcp14">MUST
                                    NOT</em>）。</p>
                        </div>
                    </section>
                    <section id="create-sig-input">
                        <h3 id="rfc.section.2.5"><a href="#rfc.section.2.5">2.5.</a>&nbsp;<a
                                href="#create-sig-input">署名ベースの作成</a></h3>
                        <div id="rfc.section.2.5.p.1">
                            <p>署名ベースは、署名でカバーされる正規化された HTTP メッセージコンポーネントを含む ASCII 文字列 <a href="#RFC0020"><cite
                                        title="ASCII format for network interchange">[ASCII]</cite></a>
                                です。署名ベース作成アルゴリズムへの入力は、順序付けられたカバーされたコンポーネント識別子の集合とそれらに関連付けられた値、および <a
                                    href="#signature-params" title="Signature Parameters">Section 2.3</a>
                                で述べる追加の署名パラメータです。
                            </p>
                        </div>
                        <div id="rfc.section.2.5.p.2">
                            <p>コンポーネント識別子は、<a href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> の <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4">Section 4</a>
                                で定義された厳密な直列化規則を用いて直列化されます。コンポーネント識別子はコンポーネント名を持ち、これは <span class="tt">sf-string</span>
                                ABNF ルールで直列化された String Item 値です。コンポーネント識別子は定義されたパラメータを含むことが<em
                                    class="bcp14">MAY</em>あり、これらは <span class="tt">parameters</span> ABNF ルールで直列化されます。<a
                                    href="#signature-params" title="Signature Parameters">Section 2.3</a>
                                で定義された署名パラメータ行も同様のパターンに従いますが、コンポーネント識別子は固定値の String Item
                                でパラメータを持たず、コンポーネント値は常にオプションのパラメータを持つ Inner List になります。
                            </p>
                        </div>
                        <div id="rfc.section.2.5.p.3">
                            <p>つまり、コンポーネント名自体の直列化は二重引用符で囲まれ、その後にセミコロンで区切られたパラメータリストが続く形になることに注意してください。例: <span
                                    class="tt">"cache-control"</span>、<span class="tt">"@authority"</span>、<span
                                    class="tt">"@signature-params"</span>、または <span
                                    class="tt">"example-dictionary";key="foo"</span> のようになります。</p>
                        </div>
                        <div id="rfc.section.2.5.p.4" class="avoidbreakafter">
                            <p>出力は署名ベースを構成するバイトの順序付けられた集合であり、次の ABNF に準拠します：</p>
                        </div>
                        <div id="rfc.section.2.5.p.5">
                            <pre class="inline">
signature-base = *( signature-base-line LF ) signature-params-line
signature-base-line = component-identifier ":" SP
    ( derived-component-value / *field-content )
    ; no obs-fold nor obs-text
component-identifier = component-name parameters
component-name = sf-string
derived-component-value = *( VCHAR / SP )
signature-params-line = DQUOTE "@signature-params" DQUOTE
     ":" SP inner-list
</pre>
                        </div>
                        <div id="rfc.section.2.5.p.6">
                            <p>署名ベースを作成するために、署名者または検証者は署名のカバーされたコンポーネントそれぞれのコンポーネント識別子（およびそのパラメータ）に対するエントリを次のアルゴリズムに従って連結します。ここで説明されるすべてのエラーは、署名ベースを出力することなくただちにアルゴリズムを失敗させることが<em
                                    class="bcp14">MUST</em>です。</p>
                        </div>
                        <div id="rfc.section.2.5.p.7">
                            <ol type="1">
                                <li>出力を空の文字列とする。</li>
                                <li>
                                    <div class="avoidbreakafter">
                                        <p>カバーされたコンポーネント集合内の各メッセージコンポーネント項目について（順に）:</p>
                                    </div>
                                    <div>
                                        <dl>
                                            <dt>11.</dt>
                                            <dd>コンポーネント識別子（そのパラメータを含む）が既に署名ベースに追加されている場合、エラーを出す。</dd>
                                            <dt>12.</dt>
                                            <dd>該当するカバーコンポーネントのコンポーネント識別子を <span class="tt">component-identifier</span>
                                                ABNF ルールに従って直列化して追加する。注: この直列化はコンポーネント名を二重引用符で囲み、パラメータは引用符の外に追加する。</dd>
                                            <dt>13.</dt>
                                            <dd>単一のコロン（<span class="tt">:</span>）を追加する。</dd>
                                            <dt>14.</dt>
                                            <dd>単一の空白（" "）を追加する。</dd>
                                            <dt>15.</dt>
                                            <dd>
                                                <div>
                                                    <p>コンポーネント識別子のためのコンポーネント値を決定する。</p>
                                                </div>
                                                <div>
                                                    <ul>
                                                        <li>コンポーネント識別子に理解されないパラメータがある場合、エラーを出す。</li>
                                                        <li><span class="tt">bs</span> と <span class="tt">sf</span>
                                                            のように互いに矛盾するパラメータを含む場合、エラーを出す。</li>
                                                        <li>コンポーネント識別子に <span class="tt">req</span>
                                                            パラメータが含まれ、かつターゲットメッセージがリクエストである場合、エラーを出す。</li>
                                                        <li>コンポーネント識別子に <span class="tt">req</span>
                                                            パラメータが含まれ、かつターゲットメッセージがレスポンスである場合、コンポーネント値のコンテキストはそのレスポンスメッセージに関連するリクエストメッセージである。さもなければ、コンポーネント値のコンテキストはターゲットメッセージである。
                                                        </li>
                                                        <li>コンポーネント名が "at" (<span class="tt">@</span>)
                                                            で始まる場合、導出コンポーネントとして定義された特定の規則に従ってメッセージから値を導出する（<a
                                                                href="#derived-components"
                                                                title="Derived Components">Section 2.2</a>
                                                            を参照）。既知の有効なパラメータがあればそれらを処理する。導出コンポーネント名が不明であるか、値が導出できない場合、エラーを出す。
                                                        </li>
                                                        <li>コンポーネント名が "at" (<span class="tt">@</span>) で始まらない場合、<a
                                                                href="#http-fields" title="HTTP Fields">Section 2.1</a>
                                                            に記述されたとおり HTTP
                                                            フィールド値を正規化し、既知の有効なパラメータを処理する。フィールドがメッセージ内で見つからない、またはコンテキスト内で値が取得できない場合、エラーを出す。
                                                        </li>
                                                    </ul>
                                                </div>
                                            </dd>
                                            <dt>16.</dt>
                                            <dd>カバーされたコンポーネントの正規化済みコンポーネント値を追加する。</dd>
                                            <dt>17.</dt>
                                            <dd>単一の改行（<span class="tt">\n</span>）を追加する。</dd>
                                        </dl>
                                    </div>
                                </li>
                                <li>
                                    <div class="avoidbreakafter">
                                        <p>次に、<a href="#signature-params" title="Signature Parameters">Section 2.3</a>
                                            に従って署名パラメータコンポーネントを <span class="tt">signature-params-line</span>
                                            ルールに従って追加する:</p>
                                    </div>
                                    <div>
                                        <dl>
                                            <dt>11.</dt>
                                            <dd>署名パラメータのコンポーネント識別子を <span class="tt">component-identifier</span>
                                                ルールに従って直列化して追加する。すなわち正確な値 <span
                                                    class="tt">"@signature-params"</span>（二重引用符を含む）を追加する。</dd>
                                            <dt>12.</dt>
                                            <dd>単一のコロン（<span class="tt">:</span>）を追加する。</dd>
                                            <dt>13.</dt>
                                            <dd>単一の空白（" "）を追加する。</dd>
                                            <dt>14.</dt>
                                            <dd><a href="#signature-params" title="Signature Parameters">Section 2.3</a>
                                                で定義されたとおり、署名パラメータの正規化済みコンポーネント値（パラメータを持つ Inner List Structured Field
                                                値）を追加する。</dd>
                                        </dl>
                                    </div>
                                </li>
                                <li>出力文字列に非 ASCII 文字が含まれている場合、エラーを出す <a href="#RFC0020"><cite
                                            title="ASCII format for network interchange">[ASCII]</cite></a>。</li>
                                <li>出力文字列を返す。</li>
                            </ol>
                        </div>
                        <div id="rfc.section.2.5.p.8" class="avoidbreakafter">
                            <p>カバーされたコンポーネントがメッセージ内でコンポーネント値に解決できないコンポーネント識別子を参照している場合、実装はエラーを発生させ署名ベースを作成してはならないことが<em
                                    class="bcp14">MUST</em>です。そのような状況には、以下が含まれますがこれらに限定されません：</p>
                        </div>
                        <div id="rfc.section.2.5.p.9">
                            <ul>
                                <li>署名者または検証者が導出コンポーネント名を理解していない。</li>
                                <li>コンポーネント名がメッセージに存在しないフィールドを指している、またはその値が不正である。</li>
                                <li>コンポーネント識別子に不明なパラメータが含まれている、またはその識別子に適用できないパラメータが含まれている。</li>
                                <li>コンポーネント識別子が Structured Field の直列化を示す（<span class="tt">sf</span>
                                    パラメータ経由）にもかかわらず、そのフィールドが Structured Field でない、または Structured Field の型が実装で不明である。</li>
                                <li>コンポーネント識別子が Dictionary メンバー識別子であり、そのフィールドがメッセージに存在しない、Dictionary Structured Field
                                    でない、またはその値が不正である。</li>
                                <li>コンポーネント識別子が Dictionary
                                    メンバー識別子や名前付きクエリパラメータ識別子であって、参照されるメンバーがコンポーネント値に存在しないか、その値が不正である。例えば識別子が <span
                                        class="tt">"example-dict";key="c"</span> であり、Example-Dict ヘッダの値が <span
                                        class="tt">a=1, b=2</span> で <span class="tt">c</span> が存在しない場合など。</li>
                            </ul>
                        </div>
                        <div id="rfc.section.2.5.p.10" class="avoidbreakafter">
                            <p>次の非規範的な例では、署名対象の HTTP メッセージは次のリクエストです：</p>
                        </div>
                        <div id="rfc.section.2.5.p.11">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.2.5.p.12" class="avoidbreakafter">
                            <p>カバーされたコンポーネントは、<span class="tt">@method</span>、<span class="tt">@authority</span>、および
                                <span class="tt">@path</span> の導出コンポーネントに続き、順に <span
                                    class="tt">Content-Digest</span>、<span class="tt">Content-Length</span>、および <span
                                    class="tt">Content-Type</span> HTTP ヘッダーフィールドを含みます。署名パラメータは作成時刻 <span
                                    class="tt">1618884473</span> と鍵識別子 <span class="tt">test-key-rsa-pss</span>
                                です。ここでは明示的な <span class="tt">alg</span> パラメータは与えられていませんが、アプリケーションにより識別された鍵に基づいて検証者が
                                RSA-PSS アルゴリズムを使用することが既知である点に注意してください。このメッセージとこれらのパラメータに対する署名ベースは次のとおりです：
                            </p>
                        </div>
                        <div id="example-sig-input"></div>
                        <div id="rfc.figure.1">
                            <div>
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

"@method": POST
"@authority": example.com
"@path": /foo
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-length": 18
"content-type": application/json
"@signature-params": ("@method" "@authority" "@path" \
  "content-digest" "content-length" "content-type")\
  ;created=1618884473;keyid="test-key-rsa-pss"
</pre>
                            </div>
                        </div>
                        <p class="figure">図 1: 非規範的な例の署名ベース</p>
                        <div id="rfc.section.2.5.p.13">
                            <p>上の例の署名ベースには表示を終えるための最後の改行は含まれておらず、本仕様の他の例の署名ベースにも同様である点に注意してください。</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="message-signatures">
                    <h2 id="rfc.section.3" class="np"><a href="#rfc.section.3">3.</a>&nbsp;<a
                            href="#message-signatures">HTTP メッセージ署名</a></h2>
                    <div id="rfc.section.3.p.1">
                        <p>HTTP メッセージ署名は、HTTP メッセージのコンポーネントのサブセットから生成された文字列に対する署名と、署名自体に関するメタデータの両方に対する署名です。HTTP
                            メッセージに対して正常に検証された場合、HTTP
                            メッセージ署名は、署名が作成されたメッセージと検証対象のメッセージが、署名されたメッセージコンポーネントのサブセットに関して意味的に同等であるという暗号学的証拠を提供します。</p>
                    </div>
                    <section id="sign">
                        <h3 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a>&nbsp;<a href="#sign">署名の作成</a></h3>
                        <div id="rfc.section.3.1.p.1">
                            <p>HTTP
                                メッセージ署名の作成は、署名コンテキスト（ターゲットメッセージを含む）とアプリケーションの要件を入力として取り、出力として署名値と署名パラメータの集合を生成し、それらをメッセージに追加して検証者に伝達できるようにするプロセスです。
                            </p>
                        </div>
                        <div id="rfc.section.3.1.p.2" class="avoidbreakafter">
                            <p>署名を作成するために、署名者は次のアルゴリズムを適用することが<em class="bcp14">MUST</em>です：</p>
                        </div>
                        <div id="rfc.section.3.1.p.3">
                            <ol type="1">
                                <li>署名者は、利用可能な署名アルゴリズムの集合から HTTP
                                    署名アルゴリズムと鍵素材を選択する。利用可能なアルゴリズムの集合はアプリケーションにより決定され、本書の対象外である。署名者はアルゴリズムに適した鍵素材を選び、鍵サイズや形式などアルゴリズムで定義される要件に従わなければならない（<em
                                        class="bcp14">MUST</em>）。鍵とアルゴリズムの選択機構は本書の範囲外である。</li>
                                <li>署名者は署名の作成時刻を現在時刻に設定する。</li>
                                <li>該当する場合、署名者は署名の有効期限プロパティを署名が失効する時刻に設定する。期限は検証者へのヒントであり、署名者がその時刻以降署名に対する保証を行わないことを表す。適切な有効期限の長さやこのパラメータの処理要件はアプリケーション固有である。
                                </li>
                                <li>
                                    <div>
                                        <p>署名者は、署名でカバーするメッセージコンポーネントを表すコンポーネント識別子の順序付けられた集合を作成し、この集合に署名メタデータパラメータを付与する。この集合の直列化された値は、後に
                                            <a href="#signature-input-header"
                                                title="The Signature-Input HTTP Field">Section 4.1</a> で説明される
                                            Signature-Input フィールドの値として使用される。
                                        </p>
                                    </div>
                                    <div>
                                        <ul>
                                            <li>一度カバーコンポーネントの順序が決定されたら、その順序は署名の寿命の間変更してはならない（<em class="bcp14">MUST
                                                    NOT</em>）。</li>
                                            <li>各カバーコンポーネント識別子は、署名コンテキスト内で（1）HTTP フィールド（<a href="#http-fields"
                                                    title="HTTP Fields">Section 2.1</a>）であるか、（2）<a
                                                    href="#derived-components" title="Derived Components">Section
                                                    2.2</a> または "HTTP Signature Derived Component Names"
                                                レジストリに列挙された導出コンポーネントでなければならない（<em class="bcp14">MUST</em>）。</li>
                                            <li>リクエストの署名者は、<span class="tt">@method</span>、<span
                                                    class="tt">@authority</span>、<span class="tt">@target-uri</span>
                                                などのメッセージ制御データをカバーコンポーネントに含めることを <em class="bcp14">SHOULD</em> する。</li>
                                            <li>署名者は署名作成時刻を示すために <span class="tt">created</span> 署名メタデータパラメータを含めることを <em
                                                    class="bcp14">SHOULD</em> する。</li>
                                            <li><span class="tt">@signature-params</span>
                                                導出コンポーネント識別子はカバーコンポーネント識別子の一覧に存在してはならない（<em class="bcp14">MUST
                                                    NOT</em>）。この導出コンポーネントは常に署名ベースの最後の行である必要があり、署名が常に自身のメタデータをカバーし、メタデータを置換できないことを保証する。
                                            </li>
                                            <li>この集合に何を含め、どの順序にするかについての追加の指針は本書の範囲外である。</li>
                                        </ul>
                                    </div>
                                </li>
                                <li>署名者はこれらのパラメータと署名ベース作成アルゴリズム（<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>）を用いて署名ベースを作成する。</li>
                                <li>署名者は選択した署名アルゴリズムと選択した鍵素材を用いて <span class="tt">HTTP_SIGN</span>
                                    プリミティブ関数で署名ベースに署名する。<span class="tt">HTTP_SIGN</span> プリミティブおよび署名アルゴリズムの具体的な適用は <a
                                        href="#signature-methods" title="Signature Algorithms">Section 3.3</a> で定義される。
                                </li>
                                <li>署名関数のバイト配列出力が、<a href="#signature-header" title="The Signature HTTP Field">Section
                                        4.2</a> で定義される Signature フィールドに含める HTTP メッセージ署名出力値となる。</li>
                            </ol>
                        </div>
                        <div id="rfc.section.3.1.p.4" class="avoidbreakafter">
                            <p>例えば、<a href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a> の例の
                                HTTP メッセージと署名パラメータに対して、署名ベースは <span class="tt">test-key-rsa-pss</span> 鍵（<a
                                    href="#example-key-rsa-pss-test" title="Example RSA-PSS Key">Appendix B.1.2</a>
                                を参照）と <a href="#method-rsa-pss-sha512" title="RSASSA-PSS Using SHA-512">Section
                                    3.3.1</a> で説明される RSASSA-PSS アルゴリズムで署名され、Base64 でエンコードされた以下のメッセージ署名出力値を与えます：</p>
                        </div>
                        <div id="example-sig-value"></div>
                        <div id="rfc.figure.2">
                            <div>
                                <pre>
NOTE: '\' line wrapping per RFC 8792

HIbjHC5rS0BYaa9v4QfD4193TORw7u9edguPh0AW3dMq9WImrlFrCGUDih47vAxi4L2\
YRZ3XMJc1uOKk/J0ZmZ+wcta4nKIgBkKq0rM9hs3CQyxXGxHLMCy8uqK488o+9jrptQ\
+xFPHK7a9sRL1IXNaagCNN3ZxJsYapFj+JXbmaI5rtAdSfSvzPuBCh+ARHBmWuNo1Uz\
VVdHXrl8ePL4cccqlazIJdC4QEjrF+Sn4IxBQzTZsL9y9TP5FsZYzHvDqbInkTNigBc\
E9cKOYNFCn4D/WM7F6TNuZO9EgtzepLWcjTymlHzK7aXq6Am6sfOrpIC49yXjj3ae6H\
RalVc/g==
</pre>
                            </div>
                        </div>
                        <p class="figure">図 2: 非規範的な例の署名値</p>
                        <div id="rfc.section.3.1.p.5">
                            <p>ここで使用されている RSA-PSS
                                アルゴリズムは非決定論的であり、アルゴリズムを実行するたびに異なる署名値が生成されることに注意してください。提示された署名値は与えられた鍵に対して検証可能ですが、新たに生成された署名値が例と一致することは期待されません。詳細は
                                <a href="#security-nondeterministic"
                                    title="Non-deterministic Signature Primitives">Section 7.3.5</a> を参照してください。
                            </p>
                        </div>
                    </section>
                    <section id="verify">
                        <h3 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a>&nbsp;<a href="#verify">署名の検証</a>
                        </h3>
                        <div id="rfc.section.3.2.p.1">
                            <p>HTTP メッセージ署名の検証は、署名コンテキスト（ターゲットメッセージ、特にその Signature および Signature-Input
                                フィールドを含む）とアプリケーションの要件を入力として取り、出力として正の検証結果またはエラーを返すプロセスです。</p>
                        </div>
                        <div id="rfc.section.3.2.p.2" class="avoidbreakafter">
                            <p>署名を検証するために、検証者は次のアルゴリズムを適用することが<em class="bcp14">MUST</em>です：</p>
                        </div>
                        <div id="rfc.section.3.2.p.3">
                            <ol type="1">
                                <li>
                                    <div>
                                        <p>Signature および Signature-Input フィールドを <span class="nobr">Sections </span><a
                                                href="#signature-input-header"
                                                title="The Signature-Input HTTP Field">4.1</a> および <a
                                                href="#signature-header" title="The Signature HTTP Field">4.2</a>
                                            に従って解析し、検証すべき署名とそのラベルを抽出する。</p>
                                    </div>
                                    <div>
                                        <dl>
                                            <dt>11.</dt>
                                            <dd>複数の署名値が存在する場合、このメッセージに対してどの署名を処理すべきかを検証者のポリシーと構成に基づいて決定する。適用可能な署名が見つからない場合、エラーを出す。
                                            </dd>
                                            <dt>12.</dt>
                                            <dd>選択した Signature フィールド値に対応する Signature-Input
                                                フィールド値（同じラベルを持つもの）がない場合、エラーを出す。</dd>
                                        </dl>
                                    </div>
                                </li>
                                <li>選択した Signature-Input フィールドの値を parameterized Inner List
                                    として解析し、カバーされたコンポーネントの順序付けられたリストと署名パラメータを取得する。</li>
                                <li>対応する Signature フィールドの値を解析して、検証すべき署名のバイト配列値を取得する。</li>
                                <li>署名パラメータを調べ、本書およびアプリケーションが定義する追加要件（例えばどのメッセージコンポーネントが署名されるべきか）を満たしているか確認する（<a
                                        href="#verify-requirements" title="Enforcing Application Requirements">Section
                                        3.2.1</a>）。</li>
                                <li>この署名に対する検証鍵素材を決定する。鍵素材が静的設定や外部プロトコル交渉などの外部手段で既知である場合、検証者はその外部知識から鍵素材を取得する手法を用いる。もし署名パラメータで鍵が識別されている場合、検証者は鍵識別子を参照して適切な鍵素材を取得する。検証者は、そのコンテキストで鍵素材が信頼に足るかどうか判断しなければならない。検証者が知らないか信頼できない鍵、またはこの要求に対して一致しない鍵が識別された場合、検証は<em
                                        class="bcp14">MUST</em>失敗する。</li>
                                <li>
                                    <div class="avoidbreakafter">
                                        <p>検証に適用するアルゴリズムを決定する:</p>
                                    </div>
                                    <div>
                                        <dl>
                                            <dt>11.</dt>
                                            <dd>アプリケーションが既知とする許容アルゴリズムの集合から開始する。以下のいずれかの手順で選択されたアルゴリズムがこの集合に含まれない場合、署名検証は失敗する。
                                            </dd>
                                            <dt>12.</dt>
                                            <dd>アルゴリズムが静的設定や外部プロトコル交渉など外部手段で既知である場合、検証者はそのアルゴリズムを使用する。</dd>
                                            <dt>13.</dt>
                                            <dd>鍵素材からアルゴリズムが決定できる場合（例えば鍵値自体にアルゴリズムフィールドがある場合）、検証者はそのアルゴリズムを使用する。</dd>
                                            <dt>14.</dt>
                                            <dd>署名パラメータで "HTTP Signature Algorithms"
                                                レジストリの値を用いてアルゴリズムが明示されている場合、検証者は参照されたアルゴリズムを使用する。</dd>
                                            <dt>15.</dt>
                                            <dd>アルゴリズムが複数の場所で指定されている場合（例えば静的設定、署名パラメータの
                                                alg、鍵素材自身の組合せ）、解決されたアルゴリズムは同一でなければならない（<em
                                                    class="bcp14">MUST</em>）。一致しない場合、検証者は検証を失敗させる（<em
                                                    class="bcp14">MUST</em>）。</dd>
                                        </dl>
                                    </div>
                                </li>
                                <li>受信した HTTP メッセージと解析した署名パラメータを用いて、<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>
                                    に定義されたアルゴリズムを使用して署名ベースを再作成する。<span class="tt">@signature-params</span>
                                    の入力値は、この署名のための Signature-Input フィールドの値を <a href="#signature-params"
                                        title="Signature Parameters">Section 2.3</a>
                                    に記述された規則に従って直列化したものになることに注意する。なお、これは Signature-Input フィールドのラベルを含まない。</li>
                                <li>鍵素材がアルゴリズムに適切であれば、再計算した署名ベース、鍵素材、および署名値に対して適切な <span class="tt">HTTP_VERIFY</span>
                                    暗号検証アルゴリズムを適用する。<span class="tt">HTTP_VERIFY</span> プリミティブおよびいくつかの具体的アルゴリズムは <a
                                        href="#signature-methods" title="Signature Algorithms">Section 3.3</a> に定義される。
                                </li>
                                <li>検証アルゴリズム関数の結果が暗号検証の最終結果となる。</li>
                            </ol>
                        </div>
                        <div id="rfc.section.3.2.p.4">
                            <p>上記のいずれかのステップが失敗またはエラーを出した場合、署名検証は失敗する。</p>
                        </div>
                        <div id="rfc.section.3.2.p.5" class="avoidbreakafter">
                            <p>例えば、次のメッセージのラベル <span class="tt">sig1</span> の署名を <span
                                    class="tt">test-key-rsa-pss</span> 鍵（<a href="#example-key-rsa-pss-test"
                                    title="Example RSA-PSS Key">Appendix B.1.2</a>）と RSASSA-PSS アルゴリズム（<a
                                    href="#method-rsa-pss-sha512" title="RSASSA-PSS Using SHA-512">Section
                                    3.3.1</a>）で検証する場合：</p>
                        </div>
                        <div id="rfc.section.3.2.p.6">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-length" "content-type")\
  ;created=1618884473;keyid="test-key-rsa-pss"
Signature: sig1=:HIbjHC5rS0BYaa9v4QfD4193TORw7u9edguPh0AW3dMq9WImrl\
  FrCGUDih47vAxi4L2YRZ3XMJc1uOKk/J0ZmZ+wcta4nKIgBkKq0rM9hs3CQyxXGxH\
  LMCy8uqK488o+9jrptQ+xFPHK7a9sRL1IXNaagCNN3ZxJsYapFj+JXbmaI5rtAdSf\
  SvzPuBCh+ARHBmWuNo1UzVVdHXrl8ePL4cccqlazIJdC4QEjrF+Sn4IxBQzTZsL9y\
  9TP5FsZYzHvDqbInkTNigBcE9cKOYNFCn4D/WM7F6TNuZO9EgtzepLWcjTymlHzK7\
  aXq6Am6sfOrpIC49yXjj3ae6HRalVc/g==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.3.2.p.7">
                            <p>さらに、少なくとも method、authority、path、content-digest、content-length、および content-type
                                のエントリが署名されていること、並びに署名作成タイムスタンプが検証時に十分に新しいことという追加要件があると、検証は成功する。</p>
                        </div>
                        <section id="verify-requirements">
                            <h4 id="rfc.section.3.2.1"><a href="#rfc.section.3.2.1">3.2.1.</a>&nbsp;<a
                                    href="#verify-requirements">アプリケーション要件の適用</a></h4>
                            <div id="rfc.section.3.2.1.p.1">
                                <p>本書で指定された検証要件は、一般的にすべてのユースケースに適用可能な基準的制限群として意図されています。HTTP
                                    メッセージ署名を使用するアプリケーションは、そのユースケースに応じて本書で規定されたものを上回る要件を課すことが<em
                                        class="bcp14">MAY</em>です。</p>
                            </div>
                            <div id="rfc.section.3.2.1.p.2" class="avoidbreakafter">
                                <p>アプリケーションが定義し得る追加要件の非規範的な例は次のとおりです：</p>
                            </div>
                            <div id="rfc.section.3.2.1.p.3">
                                <ul>
                                    <li>特定のヘッダーフィールドが署名されていることを要求する（例: Authorization、Content-Digest）。</li>
                                    <li><span class="tt">created</span> タイムスタンプからの最大署名年齢を強制する。</li>
                                    <li><span class="tt">expires</span> タイムスタンプの有効期限を過ぎた署名を拒否する。expires
                                        は署名者からのヒントであり、検証者は常に有効期限前に署名を拒否できることに注意する。</li>
                                    <li>署名メタデータパラメータの中で、例えば鍵情報からアルゴリズムが決定される場合の <span class="tt">alg</span>
                                        によるランタイムアルゴリズムシグナリングを禁止する。</li>
                                    <li><span class="tt">keyid</span> パラメータのデリファレンスが有効で適切な鍵素材に成功することを保証する。</li>
                                    <li>特定のアルゴリズムの使用を禁止する、または特定のアルゴリズムの使用を義務付ける。</li>
                                    <li>鍵のサイズを要件とする（例: 2048 ビット vs 1024 ビット）。</li>
                                    <li><span class="tt">nonce</span> パラメータの一意性を強制する。</li>
                                    <li><span class="tt">tag</span> パラメータにアプリケーション固有の値を要求する。</li>
                                </ul>
                            </div>
                            <div id="rfc.section.3.2.1.p.4">
                                <p>アプリケーション固有の要件は期待され推奨されます。アプリケーションが追加要件を定義する場合、それらを署名検証プロセス中に強制し、署名がアプリケーション要件に適合しない場合は署名検証を失敗させることが<em
                                        class="bcp14">MUST</em>です。</p>
                            </div>
                            <div id="rfc.section.3.2.1.p.5">
                                <p>アプリケーションは本書で定義された要件を強制することが<em
                                        class="bcp14">MUST</em>です。ユースケースにかかわらず、これらの要件に適合しない署名を受け入れてはなりません（<em
                                        class="bcp14">MUST NOT</em>）。</p>
                            </div>
                        </section>
                    </section>
                    <section id="signature-methods">
                        <h3 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3.</a>&nbsp;<a
                                href="#signature-methods">署名アルゴリズム</a></h3>
                        <div id="rfc.section.3.3.p.1">
                            <p>HTTP メッセージ署名は、鍵素材、環境、および署名者と検証者のニーズに適した暗号デジタル署名または MAC 方法を使用しなければなりません（<em
                                    class="bcp14">MUST</em>）。本仕様は利用可能な署名アルゴリズムを厳密に制限するものではなく、これらの基本要件を満たす任意の署名アルゴリズムは
                                HTTP メッセージ署名のアプリケーションで使用できる（<em class="bcp14">MAY</em>）ことに注意してください。</p>
                        </div>
                        <div id="rfc.section.3.3.p.2" class="avoidbreakafter">
                            <p>各署名方式について、<span class="tt">HTTP_SIGN</span> は署名ベース（<a href="#create-sig-input"
                                    title="Creating the Signature Base">Section 2.5</a>）をバイト配列として（<span
                                    class="tt">M</span>）と署名鍵素材（<span class="tt">Ks</span>）を入力とし、出力として署名のバイト配列（<span
                                    class="tt">S</span>）を生成します:</p>
                        </div>
                        <div id="rfc.section.3.3.p.3">
                            <pre>
HTTP_SIGN (M, Ks)  -&gt;  S
</pre>
                        </div>
                        <div id="rfc.section.3.3.p.4" class="avoidbreakafter">
                            <p>各検証方式について、<span class="tt">HTTP_VERIFY</span> は再生成された署名ベース（バイト配列、<span
                                    class="tt">M</span>）、検証鍵素材（<span class="tt">Kv</span>）、および検証対象の提示された署名（バイト配列、<span
                                    class="tt">S</span>）を入力とし、検証結果（ブール値、<span class="tt">V</span>）を出力します：</p>
                        </div>
                        <div id="rfc.section.3.3.p.5">
                            <pre>
HTTP_VERIFY (M, Kv, S) -&gt; V
</pre>
                        </div>
                        <div id="rfc.section.3.3.p.6">
                            <p>以下の節では、いくつかの一般的な署名アルゴリズムを示し、これらの暗号プリミティブが上記の <span class="tt">HTTP_SIGN</span> および <span
                                    class="tt">HTTP_VERIFY</span> 定義にどのように対応するかを説明します。使用する方法は、明示的なアルゴリズム（<span
                                    class="tt">alg</span>）署名パラメータ（<a href="#signature-params"
                                    title="Signature Parameters">Section
                                    2.3</a>）で伝えるか、鍵素材への参照、または署名者と検証者の間の合意によって決定できます。<span class="tt">alg</span>
                                パラメータで選択された署名アルゴリズムは、"HTTP Signature Algorithms" レジストリ（<a href="#hsa-registry"
                                    title="HTTP Signature Algorithms Registry">Section 6.2</a>）の値を使用しなければなりません（<em
                                    class="bcp14">MUST</em>）。</p>
                        </div>
                        <section id="method-rsa-pss-sha512">
                            <h4 id="rfc.section.3.3.1"><a href="#rfc.section.3.3.1">3.3.1.</a>&nbsp;<a
                                    href="#method-rsa-pss-sha512">RSASSA-PSS（SHA-512 使用）</a></h4>
                            <div id="rfc.section.3.3.1.p.1">
                                <p>このアルゴリズムで署名するには、署名者は署名者の秘密鍵（<span class="tt">K</span>）と署名ベース（<span
                                        class="tt">M</span>）を用いて、<a href="#RFC8017"><cite
                                            title="PKCS #1: RSA Cryptography Specifications Version 2.2">[RFC8017]</cite></a>
                                    で定義された <span class="tt">RSASSA-PSS-SIGN (K, M)</span> 関数を適用します（<a
                                        href="#create-sig-input" title="Creating the Signature Base">Section
                                        2.5</a>）。マスク生成関数は <span class="tt">MGF1</span> でハッシュ関数は SHA-512（<a
                                        href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>）です。ソルト長（<span
                                        class="tt">sLen</span>）は 64 バイトです。ハッシュ関数 SHA-512
                                    は署名ベースに適用され、デジストコンテンツが作成され、それにデジタル署名が適用されます。得られた署名済みバイト配列（<span
                                        class="tt">S</span>）が HTTP メッセージ署名出力です（<a href="#sign"
                                        title="Creating a Signature">Section 3.1</a> 参照）。</p>
                            </div>
                            <div id="rfc.section.3.3.1.p.2">
                                <p>このアルゴリズムで検証するには、検証者は検証鍵素材の公開鍵部分（<span class="tt">n, e</span>）と再作成した署名ベース（<span
                                        class="tt">M</span>）を用いて、<a href="#RFC8017"><cite
                                            title="PKCS #1: RSA Cryptography Specifications Version 2.2">[RFC8017]</cite></a>
                                    の <span class="tt">RSASSA-PSS-VERIFY ((n, e), M, S)</span> 関数を適用します。マスク生成関数は <span
                                        class="tt">MGF1</span>、ハッシュ関数は SHA-512、ソルト長は 64 バイトです。ハッシュ関数 SHA-512
                                    は署名ベースに適用され、検証関数に与えられるダイジェストが作成されます。検証者は検証すべき HTTP メッセージ署名（<span
                                        class="tt">S</span>）を <a href="#verify" title="Verifying a Signature">Section
                                        3.2</a> に従って抽出します。検証関数の結果は提示された署名が有効か否かを示します。</p>
                            </div>
                            <div id="rfc.section.3.3.1.p.3">
                                <p>RSASSA-PSS
                                    の出力は非決定論的であるため、署名ベースに対して新たに署名を計算し既存の署名と比較するのは正しくありません。代わりにここで定義された検証アルゴリズムを使用する必要があります。詳しくは
                                    <a href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">Section 7.3.5</a> を参照してください。
                                </p>
                            </div>
                            <div id="rfc.section.3.3.1.p.4">
                                <p>このアルゴリズムの使用は、署名パラメータ <span class="tt">alg</span> に <span
                                        class="tt">rsa-pss-sha512</span> を指定することでランタイムに示すことができます。</p>
                            </div>
                        </section>
                        <section id="method-rsa-v1_5-sha256">
                            <h4 id="rfc.section.3.3.2"><a href="#rfc.section.3.3.2">3.3.2.</a>&nbsp;<a
                                    href="#method-rsa-v1_5-sha256">RSASSA-PKCS1-v1_5（SHA-256 使用）</a></h4>
                            <div id="rfc.section.3.3.2.p.1">
                                <p>このアルゴリズムで署名するには、署名者は秘密鍵（<span class="tt">K</span>）と署名ベース（<span
                                        class="tt">M</span>）を用いて、<a href="#RFC8017"><cite
                                            title="PKCS #1: RSA Cryptography Specifications Version 2.2">[RFC8017]</cite></a>
                                    で定義された <span class="tt">RSASSA-PKCS1-V1_5-SIGN (K, M)</span> 関数を適用します（<a
                                        href="#create-sig-input" title="Creating the Signature Base">Section
                                        2.5</a>）。ハッシュ関数 SHA-256（<a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>）が署名ベースに適用され、デジストコンテンツに対してデジタル署名が行われます。得られた署名バイト配列（<span
                                        class="tt">S</span>）が HTTP メッセージ署名出力として使用されます（<a href="#sign"
                                        title="Creating a Signature">Section 3.1</a>）。</p>
                            </div>
                            <div id="rfc.section.3.3.2.p.2">
                                <p>このアルゴリズムで検証するには、検証者は公開鍵部分（<span class="tt">n, e</span>）と再作成した署名ベース（<span
                                        class="tt">M</span>）を用いて、<a href="#RFC8017"><cite
                                            title="PKCS #1: RSA Cryptography Specifications Version 2.2">[RFC8017]</cite></a>
                                    の <span class="tt">RSASSA-PKCS1-V1_5-VERIFY ((n, e), M, S)</span> 関数を適用します。ハッシュ関数は
                                    SHA-256 です。検証者は検証すべき署名（<span class="tt">S</span>）を <a href="#verify"
                                        title="Verifying a Signature">Section 3.2</a> に従って抽出し、検証関数の結果が署名が有効かどうかを示します。
                                </p>
                            </div>
                            <div id="rfc.section.3.3.2.p.3">
                                <p>このアルゴリズムの使用は、署名パラメータ <span class="tt">alg</span> に <span
                                        class="tt">rsa-v1_5-sha256</span> を指定することで示すことができます。</p>
                            </div>
                        </section>
                        <section id="method-hmac-sha256">
                            <h4 id="rfc.section.3.3.3"><a href="#rfc.section.3.3.3">3.3.3.</a>&nbsp;<a
                                    href="#method-hmac-sha256">HMAC Using SHA-256</a></h4>
                            <div id="rfc.section.3.3.3.p.1">
                                <p>このアルゴリズムで署名および検証を行うには、署名者は共有署名鍵（<span class="tt">K</span>）と署名ベース（<span
                                        class="tt">text</span>）（<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>）を用いて <span
                                        class="tt">HMAC</span> 関数（<a href="#RFC2104"><cite
                                            title="HMAC: Keyed-Hashing for Message Authentication">[RFC2104]</cite></a>）を適用します。ハッシュ関数
                                    SHA-256（<a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>）が署名ベースに対して適用され、そのダイジェストに対して
                                    HMAC が計算され、署名結果が得られます。</p>
                            </div>
                            <div id="rfc.section.3.3.3.p.2">
                                <p>署名の際、得られた値は <a href="#sign" title="Creating a Signature">Section 3.1</a> で使用される HTTP
                                    メッセージ署名出力になります。</p>
                            </div>
                            <div id="rfc.section.3.3.3.p.3">
                                <p>検証の際、検証者は検証対象の HTTP メッセージ署名（<span class="tt">S</span>）を <a href="#verify"
                                        title="Verifying a Signature">Section 3.2</a> に従って抽出します。HMAC 関数の出力はバイト単位で提示された
                                    HTTP メッセージ署名の値と比較され、その比較結果によって提示された署名の妥当性が判断されます。</p>
                            </div>
                            <div id="rfc.section.3.3.3.p.4">
                                <p>このアルゴリズムの使用は、署名パラメータ <span class="tt">alg</span> に <span
                                        class="tt">hmac-sha256</span> の値を指定することでランタイムに示すことができます。</p>
                            </div>
                        </section>
                        <section id="method-ecdsa-p256-sha256">
                            <h4 id="rfc.section.3.3.4"><a href="#rfc.section.3.3.4">3.3.4.</a>&nbsp;<a
                                    href="#method-ecdsa-p256-sha256">ECDSA Using Curve P-256 DSS and SHA-256</a></h4>
                            <div id="rfc.section.3.3.4.p.1">
                                <p>このアルゴリズムで署名するには、署名者は曲線 P-256 を用いた <span class="tt">ECDSA</span> 署名アルゴリズム（<a
                                        href="#FIPS186-5"><cite
                                            title="Digital Signature Standard (DSS)">[FIPS186-5]</cite></a>）を、署名者の秘密署名鍵と署名ベース（<a
                                        href="#create-sig-input" title="Creating the Signature Base">Section
                                        2.5</a>）に対して適用します。ハッシュ SHA-256（<a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>）が署名ベースに適用され、そのダイジェストにデジタル署名が適用されます（<span
                                        class="tt">M</span>）。署名アルゴリズムは 2 つの整数値、すなわち <span class="tt">r</span> と <span
                                        class="tt">s</span> を返します。これらはどちらもビッグエンディアンの符号なし整数としてエンコードされ、それぞれ 32
                                    オクテットにゼロパディングされます。エンコードされた値は順に連結され、<span class="tt">r</span> のエンコード値に続いて <span
                                        class="tt">s</span> のエンコード値が続く単一の 64 オクテット配列になります。得られた <span class="tt">(r,
                                        s)</span> の連結は、<a href="#sign" title="Creating a Signature">Section 3.1</a>
                                    で使用される HTTP メッセージ署名出力のバイト配列です。</p>
                            </div>
                            <div id="rfc.section.3.3.4.p.2">
                                <p>このアルゴリズムで検証するには、検証者は検証鍵素材の公開鍵部分と、<a href="#verify"
                                        title="Verifying a Signature">Section 3.2</a> に従って再生成した署名ベースを用いて <span
                                        class="tt">ECDSA</span> 署名アルゴリズム（<a href="#FIPS186-5"><cite
                                            title="Digital Signature Standard (DSS)">[FIPS186-5]</cite></a>）を適用します。ハッシュ関数
                                    SHA-256（<a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>）が署名ベースに適用され、そのダイジェストに対して検証関数が適用されます（<span
                                        class="tt">M</span>）。検証者は検証対象の HTTP メッセージ署名（<span class="tt">S</span>）を <a
                                        href="#verify" title="Verifying a Signature">Section 3.2</a> に従って抽出します。この値は
                                    <span class="tt">r</span> と <span class="tt">s</span> のエンコード値が順に連結された 64
                                    オクテット配列です。これらはどちらもビッグエンディアンの符号なし整数として 32 オクテットにゼロパディングされています。得られた署名値 <span
                                        class="tt">(r, s)</span> が検証関数への入力として使用され、検証関数の結果が提示された署名の有効性を示します。
                                </p>
                            </div>
                            <div id="rfc.section.3.3.4.p.3">
                                <p>ECDSA
                                    署名アルゴリズムの出力は非決定論的であるため、署名ベースに対して新たに署名を計算し既存の署名と比較することは正しくありません。代わりにここで定義された検証アルゴリズムを使用する必要があります。詳細は
                                    <a href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">Section 7.3.5</a> を参照してください。
                                </p>
                            </div>
                            <div id="rfc.section.3.3.4.p.4">
                                <p>このアルゴリズムの使用は、署名パラメータ <span class="tt">alg</span> に <span
                                        class="tt">ecdsa-p256-sha256</span> の値を指定することでランタイムに示すことができます。</p>
                            </div>
                        </section>
                        <section id="method-ecdsa-p384-sha384">
                            <h4 id="rfc.section.3.3.5"><a href="#rfc.section.3.3.5">3.3.5.</a>&nbsp;<a
                                    href="#method-ecdsa-p384-sha384">ECDSA Using Curve P-384 DSS and SHA-384</a></h4>
                            <div id="rfc.section.3.3.5.p.1">
                                <p>このアルゴリズムで署名するには、署名者は曲線 P-384 を用いた <span class="tt">ECDSA</span> 署名アルゴリズム（<a
                                        href="#FIPS186-5"><cite
                                            title="Digital Signature Standard (DSS)">[FIPS186-5]</cite></a>）を、署名者の秘密署名鍵と署名ベース（<a
                                        href="#create-sig-input" title="Creating the Signature Base">Section
                                        2.5</a>）に対して適用します。ハッシュ SHA-384（<a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>）が署名ベースに適用され、そのダイジェストにデジタル署名が適用されます（<span
                                        class="tt">M</span>）。署名アルゴリズムは 2 つの整数値、すなわち <span class="tt">r</span> と <span
                                        class="tt">s</span> を返します。これらはどちらもビッグエンディアンの符号なし整数としてエンコードされ、それぞれ 48
                                    オクテットにゼロパディングされます。エンコードされた値は順に連結され、<span class="tt">r</span> のエンコード値に続いて <span
                                        class="tt">s</span> のエンコード値が続く単一の 96 オクテット配列になります。得られた <span class="tt">(r,
                                        s)</span> の連結は、<a href="#sign" title="Creating a Signature">Section 3.1</a>
                                    で使用される HTTP メッセージ署名出力のバイト配列です。</p>
                            </div>
                            <div id="rfc.section.3.3.5.p.2">
                                <p>このアルゴリズムで検証するには、検証者は検証鍵素材の公開鍵部分と再生成した署名ベース（<a href="#verify"
                                        title="Verifying a Signature">Section 3.2</a> に従って）を用いて <span
                                        class="tt">ECDSA</span> 署名アルゴリズム（<a href="#FIPS186-5"><cite
                                            title="Digital Signature Standard (DSS)">[FIPS186-5]</cite></a>）を適用します。ハッシュ関数
                                    SHA-384（<a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>）が署名ベースに適用され、そのダイジェストに対して検証関数が適用されます（<span
                                        class="tt">M</span>）。検証者は検証対象の HTTP メッセージ署名（<span class="tt">S</span>）を <a
                                        href="#verify" title="Verifying a Signature">Section 3.2</a> に従って抽出します。この値は
                                    <span class="tt">r</span> と <span class="tt">s</span> のエンコード値が順に連結された 96
                                    オクテット配列です。これらはどちらもビッグエンディアンの符号なし整数として 48 オクテットにゼロパディングされています。得られた署名値 <span
                                        class="tt">(r, s)</span> が検証関数への入力として使用され、検証関数の結果が提示された署名の有効性を示します。
                                </p>
                            </div>
                            <div id="rfc.section.3.3.5.p.3">
                                <p>ECDSA
                                    署名アルゴリズムの出力は非決定論的であるため、署名ベースに対して新たに署名を計算し既存の署名と比較することは正しくありません。代わりにここで定義された検証アルゴリズムを使用する必要があります。詳細は
                                    <a href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">Section 7.3.5</a> を参照してください。
                                </p>
                            </div>
                            <div id="rfc.section.3.3.5.p.4">
                                <p>このアルゴリズムの使用は、署名パラメータ <span class="tt">alg</span> に <span
                                        class="tt">ecdsa-p384-sha384</span> の値を指定することでランタイムに示すことができます。</p>
                            </div>
                        </section>
                        <section id="method-ed25519">
                            <h4 id="rfc.section.3.3.6"><a href="#rfc.section.3.3.6">3.3.6.</a>&nbsp;<a
                                    href="#method-ed25519">EdDSA Using Curve edwards25519</a></h4>
                            <div id="rfc.section.3.3.6.p.1">
                                <p>このアルゴリズムで署名するには、署名者は署名者の秘密署名鍵と署名ベース（<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>）を用いて <span
                                        class="tt">Ed25519</span> アルゴリズム（<a href="#RFC8032"><cite
                                            title="Edwards-Curve Digital Signature Algorithm (EdDSA)">[RFC8032]</cite></a>
                                    の該当節）を適用します。署名ベースはプレハッシュ関数を用いずそのまま入力メッセージ（<span class="tt">M</span>）として扱われます。署名は
                                    <span class="tt">R</span> と <span class="tt">S</span> の 64 オクテット連結であり（<a
                                        href="#RFC8032"><cite
                                            title="Edwards-Curve Digital Signature Algorithm (EdDSA)">[RFC8032]</cite></a>
                                    の規定に従う）、これが <a href="#sign" title="Creating a Signature">Section 3.1</a> で使用される HTTP
                                    メッセージ署名出力のバイト配列になります。
                                </p>
                            </div>
                            <div id="rfc.section.3.3.6.p.2">
                                <p>このアルゴリズムで検証するには、検証者は検証鍵素材の公開鍵部分（<span class="tt">A</span>）と、<a href="#verify"
                                        title="Verifying a Signature">Section 3.2</a> に従って再生成した署名ベースを用いて <span
                                        class="tt">Ed25519</span> 検証アルゴリズム（<a href="#RFC8032"><cite
                                            title="Edwards-Curve Digital Signature Algorithm (EdDSA)">[RFC8032]</cite></a>
                                    の該当節）を適用します。署名ベースはプレハッシュ関数を用いずそのまま入力メッセージ（<span
                                        class="tt">M</span>）として扱われます。検証対象の署名は <span class="tt">R</span> と <span
                                        class="tt">S</span> の 64 オクテット連結として扱われ、検証関数の結果が提示された署名の有効性を示します。</p>
                            </div>
                            <div id="rfc.section.3.3.6.p.3">
                                <p>このアルゴリズムの使用は、署名パラメータ <span class="tt">alg</span> に <span class="tt">ed25519</span>
                                    の値を指定することでランタイムに示すことができます。</p>
                            </div>
                        </section>
                        <section id="method-jose">
                            <h4 id="rfc.section.3.3.7"><a href="#rfc.section.3.3.7">3.3.7.</a>&nbsp;<a
                                    href="#method-jose">JSON Web Signature (JWS) Algorithms</a></h4>
                            <div id="rfc.section.3.3.7.p.1">
                                <p>署名アルゴリズムが JOSE の署名アルゴリズム（"JSON Web Signature and Encryption Algorithms"
                                    レジストリにあるもの）である場合、JWS のアルゴリズム定義が署名とハッシュの方法を決定します（<a href="#RFC7518"><cite
                                            title="JSON Web Algorithms (JWA)">[RFC7518]</cite></a>）。</p>
                            </div>
                            <div id="rfc.section.3.3.7.p.2">
                                <p>署名と検証の両方で、HTTP メッセージの署名ベース（<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>）がそのまま「JWS Signing
                                    Input」として使用されます。JOSE ヘッダ（<a href="#RFC7515"><cite
                                            title="JSON Web Signature (JWS)">[JWS]</cite></a>、<a href="#RFC7517"><cite
                                            title="JSON Web Key (JWK)">[RFC7517]</cite></a>）は使用されず、署名ベースは JOSE のようにまず
                                    Base64url エンコードされてからアルゴリズムを適用することはありません。JWS 署名の出力は、JOSE で使用される Base64url
                                    エンコード前のバイト配列として扱われます。</p>
                            </div>
                            <div id="rfc.section.3.3.7.p.3">
                                <p>JWS アルゴリズムは "<span class="tt">none</span>" であってはならず（<em class="bcp14">MUST
                                        NOT</em>）、また JOSE 実装要件が "<span class="tt">Prohibited</span>"
                                    とされるアルゴリズムであってはなりません（<em class="bcp14">MUST NOT</em>）。</p>
                            </div>
                            <div id="rfc.section.3.3.7.p.4">
                                <p>"JSON Web Algorithm (JWA)" の値は "HTTP Signature Algorithms" レジストリには含まれません。通常、JWS
                                    のアルゴリズムは JWK など JOSE 実装で一般的な仕組みによって伝達されます。実際、JWA 値は "HTTP Signature Algorithms"
                                    レジストリに登録されていないため、JOSE の署名アルゴリズムを使用する場合は明示的な署名パラメータ <span class="tt">alg</span>
                                    は用いられません。</p>
                            </div>
                        </section>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="attach-signature">
                    <h2 id="rfc.section.4" class="np"><a href="#rfc.section.4">4.</a>&nbsp;<a
                            href="#attach-signature">Including a Message Signature in a Message</a></h2>
                    <div id="rfc.section.4.p.1">
                        <p>HTTP メッセージ署名は、本仕様で定義された Signature-Input および Signature フィールドを通じて HTTP メッセージ内に含めることができます。</p>
                    </div>
                    <div id="rfc.section.4.p.2">
                        <p>Signature-Input フィールドは署名がどのように生成されたかを記述するカバーされたコンポーネントとパラメータを識別し、Signature
                            フィールドは署名値を含みます。各フィールドは複数のラベル付き値を含めることが<em class="bcp14">MAY</em>あります。</p>
                    </div>
                    <div id="rfc.section.4.p.3">
                        <p>HTTP メッセージ署名は HTTP メッセージ内のラベルによって識別されます。このラベルは特定の HTTP メッセージ内で一意でなければならず（<em
                                class="bcp14">MUST</em>）、Signature-Input フィールドと Signature
                            フィールドの両方で使用されなければなりません。ラベルは通常署名者が選択しますが、<a href="#request-signature"
                                title="Requesting Signatures">Section 5</a> のようなプロトコル交渉で特定のラベルが指示される場合もあります。</p>
                    </div>
                    <div id="rfc.section.4.p.4">
                        <p>HTTP メッセージ署名は Signature-Input フィールドと Signature フィールドの両方を使用しなければならず（<em
                                class="bcp14">MUST</em>）、各フィールドは同じラベルを含む必要があります。一方のフィールドにラベルが存在して他方に存在しないことはエラーです。</p>
                    </div>
                    <section id="signature-input-header">
                        <h3 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a>&nbsp;<a
                                href="#signature-input-header">The Signature-Input HTTP Field</a></h3>
                        <div id="rfc.section.4.1.p.1" class="avoidbreakafter">
                            <p>Signature-Input フィールドは Dictionary Structured Field（<a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.2">Section 3.2</a> of <a
                                    href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>）であり、HTTP
                                メッセージ内のコンポーネントから生成された 1 つ以上のメッセージ署名のメタデータを含みます。各メンバーは単一のメッセージ署名を記述します。メンバーのキーは HTTP
                                メッセージ内でメッセージ署名を一意に識別するラベルです。メンバーの値は Inner List
                                として直列化されたカバーされたコンポーネントの順序付けられた集合であり、ラベルで識別されるすべての署名メタデータパラメータを含みます：</p>
                        </div>
                        <div id="rfc.section.4.1.p.2">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig1=("@method" "@target-uri" "@authority" \
  "content-digest" "cache-control");\
  created=1618884475;keyid="test-key-rsa-pss"
</pre>
                        </div>
                        <div id="rfc.section.4.1.p.3">
                            <p>署名検証を容易にするため、Signature-Input フィールド値は署名ベースの <span class="tt">@signature-params</span>
                                値を生成する際に使用された直列化済みの値と同一であることが<em class="bcp14">MUST</em>です（<a href="#signature-params"
                                    title="Signature Parameters">Section 2.3</a> を参照）。Structured Field
                                値ではリストの順序およびパラメータの順序が保持される必要があることに注意してください。</p>
                        </div>
                        <div id="rfc.section.4.1.p.4">
                            <p>署名者は署名処理が完了した後にメッセージのコンテンツを署名するために Signature-Input フィールドをトレーラとして含めることが<em
                                    class="bcp14">MAY</em>です。しかし中継者はトレーラを削除することが許されるため（<a href="#RFC9110"><cite
                                        title="HTTP Semantics">[HTTP]</cite></a>）、署名がメッセージから意図せず取り除かれるのを避けるために、Signature-Input
                                フィールドはヘッダーフィールドとしてのみ含めることが<em class="bcp14">RECOMMENDED</em>されます。</p>
                        </div>
                        <div id="rfc.section.4.1.p.5">
                            <p>単一の HTTP メッセージに複数の Signature-Input フィールドを含めることが<em
                                    class="bcp14">MAY</em>です。署名ラベルはすべてのフィールド値にわたって一意でなければなりません（<em
                                    class="bcp14">MUST</em>）。</p>
                        </div>
                    </section>
                    <section id="signature-header">
                        <h3 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a>&nbsp;<a
                                href="#signature-header">The Signature HTTP Field</a></h3>
                        <div id="rfc.section.4.2.p.1" class="avoidbreakafter">
                            <p>Signature フィールドは Dictionary Structured Field（<a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.2">Section 3.2</a> of <a
                                    href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>）であり、ターゲットメッセージの署名コンテキストから生成された
                                1 つ以上のメッセージ署名を含みます。メンバーのキーは HTTP
                                メッセージ内でメッセージ署名を一意に識別するラベルです。メンバーの値はそのラベルで識別されるメッセージ署名の署名値を含む Byte Sequence です：</p>
                        </div>
                        <div id="rfc.section.4.2.p.2">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature: sig1=:P0wLUszWQjoi54udOtydf9IWTfNhy+r53jGFj9XZuP4uKwxyJo\
  1RSHi+oEF1FuX6O29d+lbxwwBao1BAgadijW+7O/PyezlTnqAOVPWx9GlyntiCiHz\
  C87qmSQjvu1CFyFuWSjdGa3qLYYlNm7pVaJFalQiKWnUaqfT4LyttaXyoyZW84jS8\
  gyarxAiWI97mPXU+OVM64+HVBHmnEsS+lTeIsEQo36T3NFf2CujWARPQg53r58Rmp\
  Z+J9eKR2CD6IJQvacn5A4Ix5BUAVGqlyp8JYm+S/CWJi31PNUjRRCusCVRj05NrxA\
  BNFv3r5S9IXf2fYJK+eyW4AiGVMvMcOg==:
</pre>
                        </div>
                        <div id="rfc.section.4.2.p.3">
                            <p>署名者は署名処理が完了した後に Signature フィールドをトレーラとして含めることが<em
                                    class="bcp14">MAY</em>です。しかし中継者はトレーラを削除することが許されるため（<a href="#RFC9110"><cite
                                        title="HTTP Semantics">[HTTP]</cite></a>）、署名がメッセージから意図せず取り除かれるのを避けるために、Signature
                                フィールドはヘッダーフィールドとしてのみ含めることが<em class="bcp14">RECOMMENDED</em>されます。</p>
                        </div>
                        <div id="rfc.section.4.2.p.4">
                            <p>単一の HTTP メッセージに複数の Signature フィールドを含めることが<em
                                    class="bcp14">MAY</em>です。署名ラベルはすべてのフィールド値にわたって一意でなければなりません（<em
                                    class="bcp14">MUST</em>）。</p>
                        </div>
                    </section>
                    <section id="signature-multiple">
                        <h3 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a>&nbsp;<a
                                href="#signature-multiple">Multiple Signatures</a></h3>
                        <div id="rfc.section.4.3.p.1">
                            <p>複数の異なる署名を単一のメッセージに含めることが<em class="bcp14">MAY</em>です。各異なる署名は一意のラベルを持たなければなりません（<em
                                    class="bcp14">MUST</em>）。これらの複数署名は同一の署名者によって追加されることも、複数の異なる署名者から来ることもあります。例えば、異なる検証者の能力をサポートするために同じメッセージコンポーネントに対して異なる鍵やアルゴリズムで複数署名を含めることや、リバースプロキシがクライアントの元の署名値に関する情報を転送時にフィールドに含める（クライアントの署名値に対する署名を含める）などが考えられます。
                            </p>
                        </div>
                        <div id="rfc.section.4.3.p.2" class="avoidbreakafter">
                            <p>次の非規範的な例は、クライアントからの署名済みリクエストで始まります。リバースプロキシはこのリクエストを受け取りクライアントの署名を検証します：</p>
                        </div>
                        <div id="rfc.section.4.3.p.3">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-type" "content-length")\
  ;created=1618884475;keyid="test-key-ecc-p256"
Signature: sig1=:X5spyd6CFnAG5QnDyHfqoSNICd+BUP4LYMz2Q0JXlb//4Ijpzp\
  +kve2w4NIyqeAuM7jTDX+sNalzA8ESSaHD3A==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.4.3.p.4" class="avoidbreakafter">
                            <p>プロキシはその後、転送先のオリジンサーバーへ送る前にメッセージを変更し、ターゲットホストを変更して <a href="#RFC7239"><cite
                                        title="Forwarded HTTP Extension">[RFC7239]</cite></a> で定義された Forwarded
                                ヘッダーフィールドを追加します：</p>
                        </div>
                        <div id="rfc.section.4.3.p.5">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: origin.host.internal.example
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 18
Forwarded: for=192.0.2.123;host=example.com;proto=https
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-type" "content-length")\
  ;created=1618884475;keyid="test-key-ecc-p256"
Signature: sig1=:X5spyd6CFnAG5QnDyHfqoSNICd+BUP4LYMz2Q0JXlb//4Ijpzp\
  +kve2w4NIyqeAuM7jTDX+sNalzA8ESSaHD3A==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.4.3.p.6" class="avoidbreakafter">
                            <p>プロキシは受信したクライアントの署名を検証し、新しいメッセージに対して自身の署名を付加することでオリジンサーバーに対して転送するリクエストの性質についての自身の主張を行えます。プロキシはまたオリジンサーバーの処理に関連する元のメッセージの要素をすべて含めます。多くの場合、プロキシはクライアントの署名がカバーしていたのと同じコンポーネントをすべてカバーしたいと考え、そのようにすることがあります。以下の例ではプロキシが変更した新しい
                                authority 値に対して署名を行い、さらに自分の署名値に Forwarded
                                ヘッダーフィールドを追加しています。プロキシは自身の鍵とアルゴリズムを識別し、この例では署名に有効期限を含めて下流のシステムに対して短い時間窓を超えてプロキシがこの署名付きメッセージを保証しないことを示しています。これにより署名ベースは次のようになります：
                            </p>
                        </div>
                        <div id="rfc.section.4.3.p.7">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

"@method": POST
"@authority": origin.host.internal.example
"@path": /foo
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-type": application/json
"content-length": 18
"forwarded": for=192.0.2.123;host=example.com;proto=https
"@signature-params": ("@method" "@authority" "@path" \
  "content-digest" "content-type" "content-length" "forwarded")\
  ;created=1618884480;keyid="test-key-rsa";alg="rsa-v1_5-sha256"\
  ;expires=1618884540
</pre>
                        </div>
                        <div id="rfc.section.4.3.p.8" class="avoidbreakafter">
                            <p>そして署名出力値は次のとおりです：</p>
                        </div>
                        <div id="rfc.section.4.3.p.9">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

S6ZzPXSdAMOPjN/6KXfXWNO/f7V6cHm7BXYUh3YD/fRad4BCaRZxP+JH+8XY1I6+8Cy\
+CM5g92iHgxtRPz+MjniOaYmdkDcnL9cCpXJleXsOckpURl49GwiyUpZ10KHgOEe11s\
x3G2gxI8S0jnxQB+Pu68U9vVcasqOWAEObtNKKZd8tSFu7LB5YAv0RAGhB8tmpv7sFn\
Im9y+7X5kXQfi8NMaZaA8i2ZHwpBdg7a6CMfwnnrtflzvZdXAsD3LH2TwevU+/PBPv0\
B6NMNk93wUs/vfJvye+YuI87HU38lZHowtznbLVdp770I6VHR6WfgS9ddzirrswsE1w\
5o0LV/g==
</pre>
                        </div>
                        <div id="rfc.section.4.3.p.10" class="avoidbreakafter">
                            <p>これらの値はプロキシによって HTTP リクエストメッセージに追加されます。元の署名はラベル <span class="tt">sig1</span>
                                の下に含まれ、リバースプロキシ自身の署名はラベル <span class="tt">proxy_sig</span> の下に含まれます。プロキシは <span
                                    class="tt">test-key-rsa</span> 鍵を使用して <span class="tt">rsa-v1_5-sha256</span>
                                署名アルゴリズムで署名を作成し、クライアントの元の署名は <span class="tt">test-key-rsa-pss</span> 鍵と RSA-PSS
                                署名アルゴリズムで作成されていました：</p>
                        </div>
                        <div id="rfc.section.4.3.p.11">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: origin.host.internal.example
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 18
Forwarded: for=192.0.2.123;host=example.com;proto=https
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Signature-Input: sig1=("@method" "@authority" "@path" \
    "content-digest" "content-type" "content-length")\
    ;created=1618884475;keyid="test-key-ecc-p256", \
  proxy_sig=("@method" "@authority" "@path" "content-digest" \
    "content-type" "content-length" "forwarded")\
    ;created=1618884480;keyid="test-key-rsa";alg="rsa-v1_5-sha256"\
    ;expires=1618884540
Signature: sig1=:X5spyd6CFnAG5QnDyHfqoSNICd+BUP4LYMz2Q0JXlb//4Ijpzp\
    +kve2w4NIyqeAuM7jTDX+sNalzA8ESSaHD3A==:, \
  proxy_sig=:S6ZzPXSdAMOPjN/6KXfXWNO/f7V6cHm7BXYUh3YD/fRad4BCaRZxP+\
    JH+8XY1I6+8Cy+CM5g92iHgxtRPz+MjniOaYmdkDcnL9cCpXJleXsOckpURl49G\
    wiyUpZ10KHgOEe11sx3G2gxI8S0jnxQB+Pu68U9vVcasqOWAEObtNKKZd8tSFu7\
    LB5YAv0RAGhB8tmpv7sFnIm9y+7X5kXQfi8NMaZaA8i2ZHwpBdg7a6CMfwnnrtf\
    lzvZdXAsD3LH2TwevU+/PBPv0B6NMNk93wUs/vfJvye+YuI87HU38lZHowtznbL\
    Vdp770I6VHR6WfgS9ddzirrswsE1w5o0LV/g==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.4.3.p.12">
                            <p>プロキシが元のメッセージからクライアントの Signature フィールド値や Signature-Input
                                フィールドを新しい署名のカバーコンポーネントに含めることは可能ですが、署名値を署名することには既知の弱点があるためこれは<em class="bcp14">NOT
                                    RECOMMENDED</em>です（詳しくは <a href="#security-sign-signature"
                                    title="Signing Signature Values">Section 7.3.7</a>
                                を参照）。プロキシはクライアントの署名を検証できる立場にあり、プロキシが行うメッセージ変更はオリジンサーバーが見ると既存の署名を無効にします。この例では、オリジンサーバーが権限の変更を考慮するための追加情報を署名コンテキストに持っている可能性がありますが、この慣行には追加の設定と注意が必要です（<a
                                    href="#security-context-multiple-signatures"
                                    title="Multiple Message Component Contexts">Section 7.4.4</a>
                                を参照）。別のアプリケーションでは、オリジンサーバーは元の署名自体を検証できないかもしれませんが、それでもプロキシがクライアントの署名を適切に検証したことを確認したい場合があります。署名の処理成功や受領を示す必要があるアプリケーションは、そのような信号を安全に送るための代替メカニズムを慎重に指定する必要があります。
                            </p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="request-signature">
                    <h2 id="rfc.section.5" class="np"><a href="#rfc.section.5">5.</a>&nbsp;<a
                            href="#request-signature">署名の要求</a></h2>
                    <div id="rfc.section.5.p.1">
                        <p>署名者は要求や応答に対して自由に署名を付与できますが、検証者となる可能性のある主体が署名を期待していることを示すために、Accept-Signature
                            フィールドを使用して署名者にシグナルを送ることが望ましい場合がよくあります。</p>
                    </div>
                    <div id="rfc.section.5.p.2">
                        <p>Accept-Signature フィールドが HTTP
                            リクエストメッセージで送信される場合、そのフィールドはクライアントがサーバーに対し、識別されたパラメータを使用してレスポンスに署名することを望んでいることを示し、ターゲットメッセージはこのリクエストに対するレスポンスです。そのような署名交渉をサポートするリソースからのすべてのレスポンスは、キャッシュが別のリクエスト向けに作成された署名付きレスポンスを返さないように、非キャッシュ可能であるか
                            Accept-Signature を列挙する Vary ヘッダーフィールドを含むことが<em class="bcp14">SHOULD</em>推奨されます。</p>
                    </div>
                    <div id="rfc.section.5.p.3">
                        <p>Accept-Signature フィールドが HTTP
                            レスポンスメッセージで使用される場合、そのフィールドはサーバーがクライアントに対し次回サーバーへのリクエストに識別されたパラメータを用いて署名することを望んでいることを示し、ターゲットメッセージはクライアントの次のリクエストです。クライアントは同様の方法で将来の同一サーバーへのリクエストに対しても署名を継続することを選択できます。
                        </p>
                    </div>
                    <div id="rfc.section.5.p.4">
                        <p>Accept-Signature フィールドのターゲットメッセージは、Accept-Signature フィールドで示されたすべてのラベル付き署名を含め、それぞれが
                            Accept-Signature フィールドで識別された同一のコンポーネントをカバーしていることが<em class="bcp14">MUST</em>です。</p>
                    </div>
                    <div id="rfc.section.5.p.5">
                        <p>Accept-Signature フィールドの送信者は、ターゲットメッセージの種類に適した識別子のみを含めることが<em
                                class="bcp14">MUST</em>です。例えば、ターゲットメッセージがリクエストである場合、カバーされるコンポーネントに <span
                                class="tt">@status</span> コンポーネント識別子を含めることはできません。</p>
                    </div>
                    <section id="accept-signature-header">
                        <h3 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a>&nbsp;<a
                                href="#accept-signature-header">Accept-Signature フィールド</a></h3>
                        <div id="rfc.section.5.1.p.1">
                            <p>Accept-Signature フィールドは Dictionary Structured Field（<a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.2">Section 3.2</a> of <a
                                    href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>）であり、ターゲット
                                HTTP メッセージのメッセージコンポーネントから生成される 1
                                つ以上の要求されたメッセージ署名のメタデータを含みます。各メンバーは単一のメッセージ署名を記述します。メンバーのキーは、ターゲット HTTP
                                メッセージのコンテキスト内で要求されたメッセージ署名を一意に識別するラベルです。</p>
                        </div>
                        <div id="rfc.section.5.1.p.2" class="avoidbreakafter">
                            <p>メンバーの値は、<a href="#signature-params" title="Signature Parameters">Section 2.3</a>
                                に定義された直列化プロセスを使用して、ターゲットメッセージの所望のカバーされたコンポーネント（および許可されるコンポーネントメタデータパラメータ）を直列化したものです：</p>
                        </div>
                        <div id="rfc.section.5.1.p.3">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Accept-Signature: sig1=("@method" "@target-uri" "@authority" \
  "content-digest" "cache-control");\
  keyid="test-key-rsa-pss";created;tag="app-123"
</pre>
                        </div>
                        <div id="rfc.section.5.1.p.4">
                            <p>コンポーネント識別子のリストは、要求された署名に含まれるコンポーネント識別子の正確な集合（適用されるすべてのコンポーネントパラメータを含む）を示します。</p>
                        </div>
                        <div id="rfc.section.5.1.p.5" class="avoidbreakafter">
                            <p>署名要求は、署名者に望ましい振る舞いを指示する署名メタデータパラメータを含めることが<em
                                    class="bcp14">MAY</em>です。本仕様で定義される次の振る舞いは以下のとおりです：</p>
                        </div>
                        <div id="rfc.section.5.1.p.6">
                            <dl>
                                <dt><span class="tt">created</span>:</dt>
                                <dd style="margin-left: 1.5em">署名者に作成時刻を生成して含めることを要求します。このパラメータは署名要求として送信されるときは値を伴いません。
                                </dd>
                                <dt><span class="tt">expires</span>:</dt>
                                <dd style="margin-left: 1.5em">
                                    署名者に有効期限時刻を生成して含めることを要求します。このパラメータは署名要求として送信されるときは値を伴いません。</dd>
                                <dt><span class="tt">nonce</span>:</dt>
                                <dd style="margin-left: 1.5em">署名者に、このパラメータの値をターゲット署名の <span class="tt">nonce</span>
                                    として含めることを要求します。</dd>
                                <dt><span class="tt">alg</span>:</dt>
                                <dd style="margin-left: 1.5em">署名者に "HTTP Signature Algorithms"
                                    レジストリから示された署名アルゴリズムを使用してターゲット署名を作成することを要求します。</dd>
                                <dt><span class="tt">keyid</span>:</dt>
                                <dd style="margin-left: 1.5em">署名者に示された鍵素材を使用してターゲット署名を作成することを要求します。</dd>
                                <dt><span class="tt">tag</span>:</dt>
                                <dd style="margin-left: 1.5em">署名者にこのパラメータの値をターゲット署名の <span class="tt">tag</span>
                                    として含めることを要求します。</dd>
                            </dl>
                        </div>
                    </section>
                    <section id="processing-an-accept-signature">
                        <h3 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a>&nbsp;<a
                                href="#processing-an-accept-signature">Accept-Signature の処理</a></h3>
                        <div id="rfc.section.5.2.p.1" class="avoidbreakafter">
                            <p>Accept-Signature フィールドの受信者は、次の手順でそのヘッダーを履行します：</p>
                        </div>
                        <div id="rfc.section.5.2.p.2">
                            <ol type="1">
                                <li>フィールド値を Dictionary として解析する。</li>
                                <li>
                                    <div class="avoidbreakafter">
                                        <p>Dictionary の各メンバーについて：</p>
                                    </div>
                                    <div>
                                        <dl>
                                            <dt>11.</dt>
                                            <dd>キーは <a href="#signature-input-header"
                                                    title="The Signature-Input HTTP Field">Section 4.1</a>
                                                に指定されているように、出力署名のラベルとして扱われます。</dd>
                                            <dt>12.</dt>
                                            <dd>メンバーの値を解析して、カバーされたコンポーネント識別子の集合を取得する。</dd>
                                            <dt>13.</dt>
                                            <dd>カバーされたコンポーネントがターゲットメッセージに適用可能であることを判定する。適用できない場合、処理は失敗しエラーを返す。</dd>
                                            <dt>14.</dt>
                                            <dd>要求されたパラメータ（署名アルゴリズムや鍵素材など）を処理する。要求されたパラメータが満たせないか、ターゲットメッセージに適切であると見なされるものと矛盾する場合、処理は失敗しエラーを返す。
                                            </dd>
                                            <dt>15.</dt>
                                            <dd>署名を完了するために必要な追加のパラメータを選択および生成する。</dd>
                                            <dt>16.</dt>
                                            <dd>ターゲットメッセージに対して HTTP メッセージ署名を作成する。</dd>
                                            <dt>17.</dt>
                                            <dd>Signature-Input および Signature フィールド値を作成し、それらをラベルに関連付ける。</dd>
                                        </dl>
                                    </div>
                                </li>
                                <li>必要に応じて、Accept-Signature フィールドに見つからない一意のラベルを持つ追加の Signature-Input および Signature
                                    フィールド値を作成することができる。</li>
                                <li>すべてのラベル付き Signature-Input および Signature フィールド値を結合し、両方のフィールドをターゲットメッセージに付加する。</li>
                            </ol>
                        </div>
                        <div id="rfc.section.5.2.p.3">
                            <p>このプロセスにより、ターゲットメッセージに適用された署名は同一のラベルを持ち、同一のカバーコンポーネント集合を含み、要求されたすべてのパラメータを処理し、追加のパラメータを持つことが<em
                                    class="bcp14">MAY</em>あり得ます（ただし必須ではありません）。</p>
                        </div>
                        <div id="rfc.section.5.2.p.4">
                            <p>Accept-Signature フィールドの受信者は、アプリケーションのパラメータに合致しない署名要求を無視してもよいことが<em
                                    class="bcp14">MAY</em>です。</p>
                        </div>
                        <div id="rfc.section.5.2.p.5">
                            <p>ターゲットメッセージは、Accept-Signature フィールドで指定されていない追加の署名を含めることが<em
                                    class="bcp14">MAY</em>です。例えば、追加のメッセージコンポーネントをカバーするために、署名者は要求された署名の出力を含む追加コンポーネントを含む二番目の署名を作成することができます。
                            </p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="iana">
                    <h2 id="rfc.section.6" class="np"><a href="#rfc.section.6">6.</a>&nbsp;<a href="#iana">IANA
                            に関する考慮事項</a></h2>
                    <div id="rfc.section.6.p.1">
                        <p>IANA は 1 つのレジストリを更新し、4 つの新しいレジストリを作成しました。詳細は以下の節に従います。</p>
                    </div>
                    <section id="http-field-name-registration">
                        <h3 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a>&nbsp;<a
                                href="#http-field-name-registration">HTTP フィールド名登録</a></h3>
                        <div id="rfc.section.6.1.p.1" class="avoidbreakafter">
                            <p>IANA は "Hypertext Transfer Protocol (HTTP) Field Name Registry" のエントリを次のように更新しました：</p>
                        </div>
                        <div class="table table-condensed table-striped">
                            <table class="v3 text-center">
                                <caption>Table 1: Updates to the Hypertext Transfer Protocol (HTTP) Field Name Registry
                                </caption>
                                <thead>
                                    <tr>
                                        <th class="text-left" colspan="1" rowspan="1">Field Name</th>
                                        <th class="text-left" colspan="1" rowspan="1">Status</th>
                                        <th class="text-left" colspan="1" rowspan="1">Reference</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">Signature-Input</td>
                                        <td class="text-left" colspan="1" rowspan="1">permanent</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#signature-input-header"
                                                title="The Signature-Input HTTP Field">Section 4.1</a> of RFC 9421</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">Signature</td>
                                        <td class="text-left" colspan="1" rowspan="1">permanent</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#signature-header"
                                                title="The Signature HTTP Field">Section 4.2</a> of RFC 9421</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">Accept-Signature</td>
                                        <td class="text-left" colspan="1" rowspan="1">permanent</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#accept-signature-header"
                                                title="The Accept-Signature Field">Section 5.1</a> of RFC 9421</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                    <section id="hsa-registry">
                        <h3 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a>&nbsp;<a href="#hsa-registry">HTTP
                                Signature Algorithms Registry</a></h3>
                        <div id="rfc.section.6.2.p.1">
                            <p>本書は HTTP 署名アルゴリズムを定義しており、IANA は "HTTP Signature Algorithms" という新しいレジストリを作成し管理します。初期値は <a
                                    href="#iana-hsa-contents" title="Initial Contents">Section 6.2.2</a>
                                に示されています。将来の割り当てや既存割り当ての変更は Specification Required 登録ポリシー (<a href="#RFC8126"><cite
                                        title="Guidelines for Writing an IANA Considerations Section in RFCs">[RFC8126]</cite></a>)
                                を通じて行われます。</p>
                        </div>
                        <div id="rfc.section.6.2.p.2">
                            <p>このレジストリに記載されたアルゴリズムは、この仕様のアプリケーションで使用可能な暗号アルゴリズムの一部を識別しますが、可能なアルゴリズムの網羅的リストを示すものでも、特定の用途に対する適合性を示すものでもありません。アプリケーションは、署名者と検証者が安全かつ決定論的にアルゴリズムのパラメータに合意できる限り、自分たちのニーズに合う任意のアルゴリズムを実装できます。アプリケーションがランタイムで特定のアルゴリズムを
                                <span class="tt">alg</span>
                                署名パラメータで指示する必要がある場合、このレジストリはそのパラメータ値と特定のアルゴリズムとの対応を提供します。ただし、アルゴリズムの混同や置換攻撃を避けるために <span
                                    class="tt">alg</span> パラメータの使用には注意が必要です（<a href="#security"
                                    title="Security Considerations">Section 7</a> を参照）。
                            </p>
                        </div>
                        <div id="rfc.section.6.2.p.3">
                            <p>Status 値は標準化状況および IETF
                                やセキュリティ関連の標準化団体（SDO）などの関連利害関係者の広い意見を反映すべきです。アルゴリズムが初めて登録される際、Designated Expert (DE)
                                はアルゴリズムが一般的に安全であるとのコンセンサスがある場合に Status フィールドを "Active"
                                に設定し、コンセンサスが得られていない実験的アルゴリズムなどの場合は "Provisional"
                                に設定すべきです。将来登録されたアルゴリズムに欠陥が見つかった場合、レジストリ項目は更新され "Deprecated" とされることがあります。DE は登録に対する
                                Status 値の説明と参照を含めることができ、特に非推奨となったアルゴリズムに対して重要です。</p>
                        </div>
                        <div id="rfc.section.6.2.p.4" class="avoidbreakafter">
                            <p>DE は次のことを実行することが期待されます：</p>
                        </div>
                        <div id="rfc.section.6.2.p.5">
                            <ul>
                                <li>登録されたアルゴリズムが参照するアルゴリズムについて、すべてのパラメータ（例: ソルト、ハッシュ、必要な鍵長）が定義文書で固定されていることを確認する。</li>
                                <li>アルゴリズム定義が <span class="tt">HTTP_SIGN</span> および <span class="tt">HTTP_VERIFY</span>
                                    プリミティブ関数を完全に特定し、すべての入力と出力が基礎となる暗号アルゴリズムにどのようにマッピングされるかを明確にすることを確認する。</li>
                                <li>既存の登録のエイリアスである登録は拒否する。</li>
                                <li>すべての登録が <a href="#iana-hsa-template" title="Registration Template">Section 6.2.1</a>
                                    に示されたテンプレートに従うことを確認する。これには名前の長さが過度でないことを確認しつつ、固有で認識可能であることを含む。</li>
                            </ul>
                        </div>
                        <div id="rfc.section.6.2.p.6">
                            <p>本仕様は、アルゴリズム名に主要なパラメータを含めることで開発者にとって識別しやすくする識別子を作成します。しかし、このレジストリ内のアルゴリズム識別子は文字列全体として解釈され、部分ごとに分解してパラメータを決定するものではありません。例えば
                                <span class="tt">rsa-pss-sha512</span>
                                を、ハッシュやマスク、ソルト値が定義文書で定められた特定のアルゴリズムを指すものとして理解することが期待されています。
                            </p>
                        </div>
                        <section id="iana-hsa-template">
                            <h4 id="rfc.section.6.2.1"><a href="#rfc.section.6.2.1">6.2.1.</a>&nbsp;<a
                                    href="#iana-hsa-template">登録テンプレート</a></h4>
                            <div id="rfc.section.6.2.1.p.1">
                                <dl class="nohang">
                                    <dt>Algorithm Name:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>HTTP 署名アルゴリズムの識別子。名前は <em class="bcp14">MUST</em> ASCII 文字列であり、<span
                                                class="tt">sf-string</span> ABNF ルールに準拠し（<a
                                                href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.3.3">Section
                                                3.3.3</a>）、長さは 20 文字を超えないことが<em class="bcp14">SHOULD
                                                NOT</em>望ましい。識別子はレジストリ内で一意でなければなりません。</div>
                                    </dd>
                                    <dt>Description:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>署名ベースに署名するために使用されるアルゴリズムの簡潔な説明。</div>
                                    </dd>
                                    <dt>Status:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>アルゴリズムのステータス。<em class="bcp14">MUST</em>
                                            以下の値のいずれかで始まり、追加の説明を含めることができます。選択肢は "Active", "Provisional", "Deprecated"
                                            です。</div>
                                    </dd>
                                    <dt>Reference:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>アルゴリズムを特定する文書への参照（可能であれば URI を含む）。関連する節の指示も含め得ますが必須ではありません。</div>
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section id="iana-hsa-contents">
                            <h4 id="rfc.section.6.2.2"><a href="#rfc.section.6.2.2">6.2.2.</a>&nbsp;<a
                                    href="#iana-hsa-contents">初期内容</a></h4>
                            <div id="rfc.section.6.2.2.p.1">
                                <p>下表は "HTTP Signature Algorithms" レジストリの初期内容を示します。</p>
                            </div>
                            <div class="table table-condensed table-striped">
                                <table class="v3 text-center">
                                    <caption>Table 2: Initial Contents of the HTTP Signature Algorithms Registry
                                    </caption>
                                    <thead>
                                        <tr>
                                            <th class="text-left" colspan="1" rowspan="1">Algorithm Name</th>
                                            <th class="text-left" colspan="1" rowspan="1">Description</th>
                                            <th class="text-left" colspan="1" rowspan="1">Status</th>
                                            <th class="text-left" colspan="1" rowspan="1">Reference</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">rsa-pss-sha512</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">RSASSA-PSS using SHA-512</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#method-rsa-pss-sha512"
                                                    title="RSASSA-PSS Using SHA-512">Section 3.3.1</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">rsa-v1_5-sha256</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">RSASSA-PKCS1-v1_5 using
                                                SHA-256</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#method-rsa-v1_5-sha256"
                                                    title="RSASSA-PKCS1-v1_5 Using SHA-256">Section 3.3.2</a> of RFC
                                                9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">hmac-sha256</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">HMAC using SHA-256</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#method-hmac-sha256"
                                                    title="HMAC Using SHA-256">Section 3.3.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">ecdsa-p256-sha256</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">ECDSA using curve P-256 DSS
                                                and SHA-256</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#method-ecdsa-p256-sha256"
                                                    title="ECDSA Using Curve P-256 DSS and SHA-256">Section 3.3.4</a> of
                                                RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">ecdsa-p384-sha384</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">ECDSA using curve P-384 DSS
                                                and SHA-384</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#method-ecdsa-p384-sha384"
                                                    title="ECDSA Using Curve P-384 DSS and SHA-384">Section 3.3.5</a> of
                                                RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">ed25519</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">EdDSA using curve edwards25519
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#method-ed25519"
                                                    title="EdDSA Using Curve edwards25519">Section 3.3.6</a> of RFC 9421
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                    </section>
                    <section id="param-registry">
                        <h3 id="rfc.section.6.3"><a href="#rfc.section.6.3">6.3.</a>&nbsp;<a href="#param-registry">HTTP
                                Signature Metadata Parameters Registry</a></h3>
                        <div id="rfc.section.6.3.p.1">
                            <p>本書は署名パラメータ構造（<a href="#signature-params" title="Signature Parameters">Section
                                    2.3</a>）を定義します。IANA は "HTTP Signature Metadata Parameters"
                                という新しいレジストリを作成し、署名パラメータ構造のメンバー値で使用されるパラメータを記録・管理します。初期値は <a href="#iana-param-contents"
                                    title="Initial Contents">Section 6.3.2</a> に示されています。将来の割り当てや変更は Expert Review 登録ポリシー
                                (<a href="#RFC8126"><cite
                                        title="Guidelines for Writing an IANA Considerations Section in RFCs">[RFC8126]</cite></a>)
                                を通じて行われます。</p>
                        </div>
                        <div id="rfc.section.6.3.p.2" class="avoidbreakafter">
                            <p>DE は次のことを行うことが期待されます：</p>
                        </div>
                        <div id="rfc.section.6.3.p.3">
                            <ul>
                                <li>名前が <a href="#iana-param-template" title="Registration Template">Section 6.3.1</a>
                                    に示されたテンプレートに従うことを確認する（長さが過度でないこと、一意かつ認識可能であることを含む）。</li>
                                <li>定義された機能が明確であり他の登録済みパラメータと矛盾しないことを確認する。</li>
                                <li>メタデータパラメータの定義が、通常の署名プロセスで使用される場合と Accept-Signature
                                    フィールドで使用される場合の両方における振る舞いを含むことを確認する。</li>
                            </ul>
                        </div>
                        <section id="iana-param-template">
                            <h4 id="rfc.section.6.3.1"><a href="#rfc.section.6.3.1">6.3.1.</a>&nbsp;<a
                                    href="#iana-param-template">登録テンプレート</a></h4>
                            <div id="rfc.section.6.3.1.p.1">
                                <dl class="nohang">
                                    <dt>Name:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>HTTP 署名メタデータパラメータの識別子。名前は <em class="bcp14">MUST</em> ASCII 文字列であり、<span
                                                class="tt">key</span> ABNF ルールに準拠し（<a
                                                href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.1.2">Section
                                                3.1.2</a>）、長さは 20 文字を超えないことが<em class="bcp14">SHOULD
                                                NOT</em>望ましい。識別子はレジストリ内で一意でなければなりません。</div>
                                    </dd>
                                    <dt>Description:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>メタデータパラメータが何を表すかの簡潔な説明。</div>
                                    </dd>
                                    <dt>Reference:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>パラメータを特定する文書への参照（可能であれば URI を含む）。関連節の指示も含め得ますが必須ではありません。</div>
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section id="iana-param-contents">
                            <h4 id="rfc.section.6.3.2"><a href="#rfc.section.6.3.2">6.3.2.</a>&nbsp;<a
                                    href="#iana-param-contents">初期内容</a></h4>
                            <div id="rfc.section.6.3.2.p.1">
                                <p>下表は "HTTP Signature Metadata Parameters" レジストリの初期内容を提示します。各行はレジストリ内の個別のエントリを表します。</p>
                            </div>
                            <div class="table table-condensed table-striped">
                                <table class="v3 text-center">
                                    <caption>Table 3: Initial Contents of the HTTP Signature Metadata Parameters
                                        Registry</caption>
                                    <thead>
                                        <tr>
                                            <th class="text-left" colspan="1" rowspan="1">Name</th>
                                            <th class="text-left" colspan="1" rowspan="1">Description</th>
                                            <th class="text-left" colspan="1" rowspan="1">Reference</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">alg</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">明示的に宣言された署名アルゴリズム</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">created</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">署名作成のタイムスタンプ</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">expires</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">提案された署名の有効期限タイムスタンプ</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">keyid</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">この署名を作成するために使用される署名および検証鍵の鍵識別子
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">nonce</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">使い捨ての nonce 値</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">tag</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">署名のアプリケーション固有タグ</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                    </section>
                    <section id="content-registry">
                        <h3 id="rfc.section.6.4"><a href="#rfc.section.6.4">6.4.</a>&nbsp;<a
                                href="#content-registry">HTTP Signature Derived Component Names Registry</a></h3>
                        <div id="rfc.section.6.4.p.1">
                            <p>本書は HTTP メッセージコンポーネントを正規化する方法を定義しており、HTTP
                                フィールド外のコンテキストから導出できるコンポーネントも含みます。これらの導出コンポーネントはコンポーネント名という一意の文字列で識別されます。導出コンポーネント名は常に
                                "at"（@）記号で始まり、HTTP フィールド名と区別されます。IANA は "HTTP Signature Derived Component Names"
                                という新しいレジストリを作成し、非フィールドのコンポーネント名とそれらに関連するコンポーネント値を生成する方法を記録・管理します。初期値は <a
                                    href="#iana-content-contents" title="Initial Contents">Section 6.4.2</a>
                                に示されています。将来の割り当てや変更は Expert Review 登録ポリシー (<a href="#RFC8126"><cite
                                        title="Guidelines for Writing an IANA Considerations Section in RFCs">[RFC8126]</cite></a>)
                                を通じて行われます。</p>
                        </div>
                        <div id="rfc.section.6.4.p.2" class="avoidbreakafter">
                            <p>DE は次のことを行うことが期待されます：</p>
                        </div>
                        <div id="rfc.section.6.4.p.3">
                            <ul>
                                <li><a href="#iana-content-template" title="Registration Template">Section 6.4.1</a>
                                    に示されたテンプレートに従うことを確認する（長さが過度でないこと、一意かつ認識可能であることを含む）。</li>
                                <li>登録要求が示すコンポーネント値がターゲット HTTP メッセージから決定論的に導出可能であることを確認する。</li>
                                <li>登録要求のために定義されたパラメータがそれらのコンポーネント値に与える影響を明確に文書化することを確認する。</li>
                            </ul>
                        </div>
                        <div id="rfc.section.6.4.p.4">
                            <p>DE は、登録が既存の導出コンポーネント定義と十分に区別されていることを確認すべきです。</p>
                        </div>
                        <div id="rfc.section.6.4.p.5">
                            <p>登録項目のステータスを "Deprecated" に設定する際、DE は非推奨の理由と非推奨機能から移行するための指示を文書化するべきです。</p>
                        </div>
                        <section id="iana-content-template">
                            <h4 id="rfc.section.6.4.1"><a href="#rfc.section.6.4.1">6.4.1.</a>&nbsp;<a
                                    href="#iana-content-template">登録テンプレート</a></h4>
                            <div id="rfc.section.6.4.1.p.1">
                                <dl class="nohang">
                                    <dt>Name:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>HTTP 導出コンポーネントの名前。名前は <em class="bcp14">MUST</em> "at" (<span
                                                class="tt">@</span>) 文字で始まり、その後に小文字の ASCII 文字（<span
                                                class="tt">"a"</span>-<span class="tt">"z"</span>）、数字（<span
                                                class="tt">"0"</span>-<span class="tt">"9"</span>）、およびハイフン（<span
                                                class="tt">"-"</span>）のみを含む ASCII 文字列でなければなりません。長さは 20 文字を超えないことが<em
                                                class="bcp14">SHOULD NOT</em>望ましい。名前はレジストリ内で一意でなければなりません。</div>
                                    </dd>
                                    <dt>Description:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>導出コンポーネントの説明。</div>
                                    </dd>
                                    <dt>Status:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>アルゴリズムのステータスに関する簡潔な説明。説明は "Active" または "Deprecated"
                                            のいずれかで始まらなければならず、必要に応じて理由を追加できます。"Deprecated" は導出コンポーネント名がもはや推奨されないことを示します。
                                        </div>
                                    </dd>
                                    <dt>Target:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>導出パラメータの有効なメッセージターゲット。"Request"、"Response"、または "Request, Response"
                                            のいずれかでなければなりません。これらの意味は <a href="#derived-components"
                                                title="Derived Components">Section 2.2</a> に定義されています。</div>
                                    </dd>
                                    <dt>Reference:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>導出コンポーネントを特定する文書への参照（可能であれば URI を含む）。関連節の指示も含め得ますが必須ではありません。</div>
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section id="iana-content-contents">
                            <h4 id="rfc.section.6.4.2"><a href="#rfc.section.6.4.2">6.4.2.</a>&nbsp;<a
                                    href="#iana-content-contents">初期内容</a></h4>
                            <div id="rfc.section.6.4.2.p.1">
                                <p>下表は "HTTP Signature Derived Component Names" レジストリの初期内容を示します。</p>
                            </div>
                            <div class="table table-condensed table-striped">
                                <table class="v3 text-center">
                                    <caption>Table 4: Initial Contents of the HTTP Signature Derived Component Names
                                        Registry</caption>
                                    <thead>
                                        <tr>
                                            <th class="text-left" colspan="1" rowspan="1">Name</th>
                                            <th class="text-left" colspan="1" rowspan="1">Description</th>
                                            <th class="text-left" colspan="1" rowspan="1">Status</th>
                                            <th class="text-left" colspan="1" rowspan="1">Target</th>
                                            <th class="text-left" colspan="1" rowspan="1">Reference</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@signature-params</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">署名ベース内の署名パラメータ行のために予約</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request, Response</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@method</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">HTTP リクエストのメソッド</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-method" title="Method">Section 2.2.1</a> of
                                                RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@authority</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">HTTP のオーソリティ（ターゲットホスト）</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-authority" title="Authority">Section
                                                    2.2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@scheme</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">リクエスト URI のスキーム</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-scheme" title="Scheme">Section 2.2.4</a> of
                                                RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@target-uri</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">リクエストの完全なターゲット URI</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#content-target-uri"
                                                    title="Target URI">Section 2.2.2</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@request-target</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">リクエストのリクエストターゲット</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-target" title="Request Target">Section
                                                    2.2.5</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">@path</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">リクエスト URI の完全なパス</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-path" title="Path">Section 2.2.6</a> of RFC
                                                9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">@query</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">リクエスト URI の完全なクエリ</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-query" title="Query">Section 2.2.7</a> of RFC
                                                9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@query-param</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">単一の名前付きクエリパラメータ</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-query-param" title="Query Parameters">Section
                                                    2.2.8</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@status</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">レスポンスのステータスコード</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Response</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#content-status-code"
                                                    title="Status Code">Section 2.2.9</a> of RFC 9421</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                    </section>
                    <section id="component-param-registry">
                        <h3 id="rfc.section.6.5"><a href="#rfc.section.6.5">6.5.</a>&nbsp;<a
                                href="#component-param-registry">HTTP Signature Component Parameters Registry</a></h3>
                        <div id="rfc.section.6.5.p.1">
                            <p>本書は複数の種類のコンポーネント識別子を定義しており、そのうちいくつかは特定の状況でパラメータ化され、固有の修正された振る舞いを提供することができます。IANA は "HTTP
                                Signature Component Parameters"
                                という新しいレジストリを作成し、現在これを維持しており、パラメータ名、それらが関連付けられるコンポーネント識別子、およびこれらのパラメータがコンポーネント値に対して行う変更を記録・管理します。パラメータの定義は、適用対象（特定のフィールド型、導出コンポーネント、またはコンテキストなど）を定義しなければなりません（<em
                                    class="bcp14">MUST</em>）。このレジストリの初期値は <a href="#iana-component-param-contents"
                                    title="Initial Contents">Section 6.5.2</a> に示されています。将来の割り当ておよび既存の割り当ての修正は Expert
                                Review 登録ポリシーに従って行われます（<a href="#RFC8126"><cite
                                        title="Guidelines for Writing an IANA Considerations Section in RFCs">[RFC8126]</cite></a>）。
                            </p>
                        </div>
                        <div id="rfc.section.6.5.p.2" class="avoidbreakafter">
                            <p>Designated Expert (DE) は次のことを行うことが期待されます：</p>
                        </div>
                        <div id="rfc.section.6.5.p.3">
                            <ul>
                                <li>名前が <a href="#iana-component-param-template" title="Registration Template">Section
                                        6.5.1</a>
                                    に示されたテンプレートに従っていることを確認する。これは、名前の長さが過度にならない一方で、その定義された機能に対して一意で認識可能であることを確保することを含みます。
                                </li>
                                <li>登録要求時に既知の他のパラメータとの相互作用や非互換性を定義が十分に規定していることを確認する。</li>
                                <li>パラメータがコンポーネント値を変更する場合、そのパラメータを適用したコンポーネント識別子によって定義されるコンポーネント値が、ターゲットの HTTP
                                    メッセージから決定論的に導出可能であることを確認する。</li>
                            </ul>
                        </div>
                        <section id="iana-component-param-template">
                            <h4 id="rfc.section.6.5.1"><a href="#rfc.section.6.5.1">6.5.1.</a>&nbsp;<a
                                    href="#iana-component-param-template">Registration Template</a></h4>
                            <div id="rfc.section.6.5.1.p.1">
                                <dl class="nohang">
                                    <dt>Name:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>パラメータの名前。名前は <em class="bcp14">MUST</em> <a
                                                href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.1.2">Section
                                                3.1.2</a> に定義された <span class="tt">key</span> ABNF ルールに準拠する ASCII
                                            文字列であり、長さは 20 文字を超えないことが<em class="bcp14">SHOULD
                                                NOT</em>です。名前はレジストリ内で一意でなければなりません（<em class="bcp14">MUST</em>）。</div>
                                    </dd>
                                    <dt>Description:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>パラメータの機能の説明。</div>
                                    </dd>
                                    <dt>Reference:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>導出コンポーネントを規定する文書への参照。可能であればその文書を取得するための URI
                                            を含めることが望ましい。関連する節の示唆を含めることもできるが必須ではない。</div>
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section id="iana-component-param-contents">
                            <h4 id="rfc.section.6.5.2"><a href="#rfc.section.6.5.2">6.5.2.</a>&nbsp;<a
                                    href="#iana-component-param-contents">Initial Contents</a></h4>
                            <div id="rfc.section.6.5.2.p.1">
                                <p>下表は "HTTP Signature Component Parameters" レジストリの初期内容を示します。</p>
                            </div>
                            <div class="table table-condensed table-striped">
                                <table class="v3 text-center">
                                    <caption>Table 5: Initial Contents of the HTTP Signature Component Parameters
                                        Registry</caption>
                                    <thead>
                                        <tr>
                                            <th class="text-left" colspan="1" rowspan="1">Name</th>
                                            <th class="text-left" colspan="1" rowspan="1">Description</th>
                                            <th class="text-left" colspan="1" rowspan="1">Reference</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">sf</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Structured Field の厳密な直列化</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#http-field-structured"
                                                    title="Strict Serialization of HTTP Structured Fields">Section
                                                    2.1.1</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">key</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Dictionary Structured Field
                                                の単一キー値選択</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#http-field-dictionary"
                                                    title="Dictionary Structured Field Members">Section 2.1.2</a> of RFC
                                                9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">bs</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Byte Sequence ラップ指示子</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#http-field-byte-sequence"
                                                    title="Binary-Wrapped HTTP Fields">Section 2.1.3</a> of RFC 9421
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">tr</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">トレーラ</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#http-trailer"
                                                    title="Trailer Fields">Section 2.1.4</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">req</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">関連するリクエストを示す指示子</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-response"
                                                    title="Signing Request Components in a Response Message">Section
                                                    2.4</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">name</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">単一の名前付きクエリパラメータ</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-query-param" title="Query Parameters">Section
                                                    2.2.8</a> of RFC 9421</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="security">
                    <h2 id="rfc.section.7" class="np"><a href="#rfc.section.7">7.</a>&nbsp;<a href="#security">Security
                            Considerations</a></h2>
                    <div id="rfc.section.7.p.1" class="avoidbreakafter">
                        <p>HTTP メッセージが署名によって「カバーされている」とみなされるためには、次のすべての条件が満たされている必要があります：</p>
                    </div>
                    <div id="rfc.section.7.p.2">
                        <ul>
                            <li>検証者によってそのメッセージに署名が期待または許可されていること。</li>
                            <li>メッセージに署名が存在すること。</li>
                            <li>署名が識別された鍵素材とアルゴリズムに対して検証されていること。</li>
                            <li>鍵素材とアルゴリズムがそのメッセージのコンテキストに適切であること。</li>
                            <li>署名が期待される時間範囲内にあること。</li>
                            <li>署名が期待されるコンテンツ（重要なコンポーネントを含む）をカバーしていること。</li>
                            <li>カバーされたコンポーネントの一覧がメッセージのコンテキストに適用可能であること。</li>
                        </ul>
                    </div>
                    <div id="rfc.section.7.p.3">
                        <p><a href="#application" title="Application of HTTP Message Signatures">Section 1.4</a>
                            に記載されたアプリケーション要件定義に加えて、以下のセキュリティ考慮事項は、HTTP メッセージに対する署名の作成と検証の要件に関して議論と文脈を提供します。</p>
                    </div>
                    <section id="general-considerations">
                        <h3 id="rfc.section.7.1"><a href="#rfc.section.7.1">7.1.</a>&nbsp;<a
                                href="#general-considerations">一般的な考慮事項</a></h3>
                        <section id="security-ignore">
                            <h4 id="rfc.section.7.1.1"><a href="#rfc.section.7.1.1">7.1.1.</a>&nbsp;<a
                                    href="#security-ignore">署名検証のスキップ</a></h4>
                            <div id="rfc.section.7.1.1.p.1">
                                <p>HTTP メッセージ署名は、検証者が署名を検証する場合にのみセキュリティを提供します。署名や Signature-Input
                                    フィールドがなくても署名が添付されたメッセージは有効な HTTP
                                    メッセージのままであるため、検証者が検証関数の出力を無視してメッセージを処理することが可能です。これには、開発環境での要件の緩和や、システム全体のデバッグ中に検証の強制を一時停止することなど、一般的な理由が考えられます。この種の一時的な停止は、良い署名であれば検査されなくても常に有効な応答を引き起こすため、ポジティブな例によるテストでは検出が難しいことがあります。
                                </p>
                            </div>
                            <div id="rfc.section.7.1.1.p.2">
                                <p>これを検出するために、検証者は有効な署名と無効な署名の両方を用いたテストを行い、無効な署名が期待どおり失敗することを確認すべきです。</p>
                            </div>
                        </section>
                        <section id="security-tls">
                            <h4 id="rfc.section.7.1.2"><a href="#rfc.section.7.1.2">7.1.2.</a>&nbsp;<a
                                    href="#security-tls">TLS の使用</a></h4>
                            <div id="rfc.section.7.1.2.p.1">
                                <p>HTTP メッセージ署名の使用は、通信路上の情報を保護するために TLS
                                    や同等のものが不要になることを意味しません。メッセージ署名はカバーされたメッセージコンポーネントに対する整合性を提供しますが、当事者間の通信の機密性は提供しません。
                                </p>
                            </div>
                            <div id="rfc.section.7.1.2.p.2">
                                <p>TLS は TLS エンドポイント間の機密性を提供します。これにより署名データ自体が攻撃者によって取得されることを防ぎ、署名リプレイ（<a
                                        href="#security-replay" title="Signature Replay">Section 7.2.2</a>）を防ぐうえで重要です。
                                </p>
                            </div>
                            <div id="rfc.section.7.1.2.p.3">
                                <p>TLS を使用する場合は、<a href="#BCP195">[BCP195]</a> に示された推奨に従って展開する必要があります。</p>
                            </div>
                        </section>
                    </section>
                    <section id="message-processing-and-selection">
                        <h3 id="rfc.section.7.2"><a href="#rfc.section.7.2">7.2.</a>&nbsp;<a
                                href="#message-processing-and-selection">メッセージ処理と選択</a></h3>
                        <section id="security-coverage">
                            <h4 id="rfc.section.7.2.1"><a href="#rfc.section.7.2.1">7.2.1.</a>&nbsp;<a
                                    href="#security-coverage">不十分なカバレッジ</a></h4>
                            <div id="rfc.section.7.2.1.p.1">
                                <p>署名でカバーされていないメッセージの任意の部分は、攻撃者によって変更され得て、署名に影響を与えずに済んでしまいます。攻撃者はヘッダーフィールドやその他のメッセージコンポーネントを挿入または変更して、署名の範囲外でメッセージの処理を変更することができます。このように改変されたメッセージは署名検証に合格するかもしれませんが、検証者がメッセージ全体を処理するときに、署名されていない部分によって署名の信頼性が覆され、処理結果が変更されてしまいます。
                                </p>
                            </div>
                            <div id="rfc.section.7.2.1.p.2">
                                <p>これに対抗するために、本仕様を適用するアプリケーションは、アプリケーションと展開の制約内で可能な限り多くのメッセージ部分に署名することを要求すべきです。検証者は署名されたメッセージコンポーネントのみを信頼するべきであり、検証者はメッセージ処理を続ける前に署名されていない機微な部分を取り除くことも検討できます。
                                </p>
                            </div>
                        </section>
                        <section id="security-replay">
                            <h4 id="rfc.section.7.2.2"><a href="#rfc.section.7.2.2">7.2.2.</a>&nbsp;<a
                                    href="#security-replay">署名のリプレイ</a></h4>
                            <div id="rfc.section.7.2.2.p.1">
                                <p>HTTP メッセージ署名はメッセージの部分集合に署名することを許すため、異なる 2 つの HTTP
                                    メッセージが同じ署名で検証される可能性があります。最も極端な例は、いかなるメッセージコンポーネントにも署名していない署名です。そのような署名が傍受されれば、攻撃者は任意の
                                    HTTP メッセージにそれを付けて自由にリプレイできます。十分なコンポーネントカバレッジがあっても、ある署名が 2 つの類似した HTTP
                                    メッセージに適用されると、署名が保持されたままメッセージがリプレイされる可能性があります。</p>
                            </div>
                            <div id="rfc.section.7.2.2.p.2">
                                <p>このような攻撃に対抗するために、まず署名者は他のメッセージと区別できるように十分なメッセージ部分をカバーするべきです。さらに、署名は <span
                                        class="tt">nonce</span> 署名パラメータを用いてメッセージごとの一意な値を提供し、検証者が同じ nonce
                                    値の繰り返しを検出して署名のリプレイを見つけられるようにできます。さらに署名者は署名の作成時刻と署名が失効する時刻を提供して、捕獲された署名値の有用性を制限できます。
                                </p>
                            </div>
                            <div id="rfc.section.7.2.2.p.3">
                                <p>もし検証者が署名者から新しい署名を発行させたい場合、Accept-Signature ヘッダーフィールドを新しい <span
                                        class="tt">nonce</span> パラメータと共に送信できます。単に署名をリプレイしている攻撃者は、選択された nonce
                                    値で新しい署名を生成することはできません。</p>
                            </div>
                        </section>
                        <section id="security-components">
                            <h4 id="rfc.section.7.2.3"><a href="#rfc.section.7.2.3">7.2.3.</a>&nbsp;<a
                                    href="#security-components">署名するメッセージコンポーネントの選択</a></h4>
                            <div id="rfc.section.7.2.3.p.1">
                                <p>HTTP
                                    メッセージ署名を適用する際、どのメッセージコンポーネントを署名の対象とするかを決定する必要があります。アプリケーションによっては、中継者によって検証前に変更されることが想定されるコンポーネントがあります。これらのコンポーネントをカバーすると、その変更によって意図的に署名が破られることになります。
                                </p>
                            </div>
                            <div id="rfc.section.7.2.3.p.2">
                                <p>しかしながら、本書はどのコンポーネントに署名するかを柔軟に決められるようにしており、各アプリケーションは問題のあるコンポーネントを避けつつ適切な部分に署名することができます。例えば、クエリパラメータをリライトする
                                    Web アプリケーションフレームワークは、<span class="tt">@query</span> 導出コンポーネントを使う代わりに <span
                                        class="tt">@query-param</span> 導出コンポーネントでクエリ値を部分的に参照することを選ぶかもしれません。</p>
                            </div>
                            <div id="rfc.section.7.2.3.p.3">
                                <p>一部のコンポーネントは中継者によって変更されることが期待されるため、通常は署名すべきではありません。例として Via や Forwarded
                                    ヘッダーはプロキシやその他のミドルボックスによって操作され、既存の値を置き換えたり完全に削除したりすることが予想されます。これらのフィールドは非常に限定的で緊密に連携されたシナリオを除いて署名の対象とすべきではありません。
                                </p>
                            </div>
                            <div id="rfc.section.7.2.3.p.4">
                                <p>署名の側面を選択するための追加の考慮事項は <a href="#application"
                                        title="Application of HTTP Message Signatures">Section 1.4</a> に記述されています。</p>
                            </div>
                        </section>
                        <section id="security-not-fields">
                            <h4 id="rfc.section.7.2.4"><a href="#rfc.section.7.2.4">7.2.4.</a>&nbsp;<a
                                    href="#security-not-fields">HTTP フィールドではなく署名パラメータや導出コンポーネントを選ぶこと</a></h4>
                            <div id="rfc.section.7.2.4.p.1" class="avoidbreakafter">
                                <p>いくつかの HTTP フィールドには、HTTP
                                    署名パラメータや導出コンポーネントと類似した値や解釈があります。多くの場合、フィールドではない代替手段に署名する方が望ましいです。特に次のフィールドは、アプリケーションが明確に必要としない限り通常署名に含めるべきではありません：
                                </p>
                            </div>
                            <div id="rfc.section.7.2.4.p.2">
                                <dl>
                                    <dt>"date"</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>Date ヘッダーフィールドの値は HTTP メッセージのタイムスタンプを表しますが、署名自身の作成時刻は <span
                                                class="tt">created</span> 署名パラメータにエンコードされます。これら 2 つの値は、署名および HTTP
                                            メッセージの作成・直列化方法に応じて異なる場合があります。署名の有効時間ウィンドウを処理するアプリケーションは、その計算に <span
                                                class="tt">created</span> 署名パラメータを使用すべきです。アプリケーションは Date フィールドと <span
                                                class="tt">created</span> パラメータ間の許容できるずれの限界を設定することもできます。詳しくは <a
                                                href="#security-replay" title="Signature Replay">7.2.2</a> および <a
                                                href="#security-coverage" title="Insufficient Coverage">7.2.1</a>
                                            を参照してください。</div>
                                    </dd>
                                    <dt>"host"</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>Host ヘッダーフィールドは HTTP/1.1 固有のもので、その機能は <span class="tt">@authority</span>
                                            導出コンポーネント（<a href="#content-request-authority" title="Authority">Section
                                                2.2.3</a>）に包含されています。異なる HTTP バージョン間で値を保持するために、アプリケーションは常に <span
                                                class="tt">@authority</span> 導出コンポーネントを使用すべきです。詳細は <a
                                                href="#security-versions"
                                                title="HTTP Versions and Component Ambiguity">Section 7.5.4</a>
                                            を参照してください。</div>
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section id="security-labels">
                            <h4 id="rfc.section.7.2.5"><a href="#rfc.section.7.2.5">7.2.5.</a>&nbsp;<a
                                    href="#security-labels">署名ラベル</a></h4>
                            <div id="rfc.section.7.2.5.p.1">
                                <p>HTTP メッセージ署名値は、Signature および Signature-Input
                                    フィールド値内の一意のラベルによって識別されます。これらのラベルは署名値をメッセージに添付する際に選択されるものであり、署名処理そのものには考慮されません。仲介者はメッセージ処理中に既存の署名をリラベルしても構いません。
                                </p>
                            </div>
                            <div id="rfc.section.7.2.5.p.2">
                                <p>したがって、アプリケーションは特定のラベルの存在に依存すべきではなく、ラベル自体に意味論的な意味を持たせるべきではありません。必要な追加の意味は追加の署名パラメータを用いて、署名に付与しカバーすることができます。特に
                                    <span class="tt">tag</span> パラメータは <a href="#security-signature-tag"
                                        title="Collision of Application-Specific Signature Tag">Section 7.2.7</a>
                                    に記載されるようなアプリケーション固有の値を定義するために用いることができます。
                                </p>
                            </div>
                        </section>
                        <section id="security-multiple">
                            <h4 id="rfc.section.7.2.6"><a href="#rfc.section.7.2.6">7.2.6.</a>&nbsp;<a
                                    href="#security-multiple">複数署名による混乱</a></h4>
                            <div id="rfc.section.7.2.6.p.1">
                                <p>複数の署名を 1 つのメッセージに適用できるため（<a href="#signature-multiple"
                                        title="Multiple Signatures">Section
                                        4.3</a>）、攻撃者がキャプチャしたメッセージに自分の署名を追加して既存の署名を変更せずに済ませることが可能です。この新しい署名は攻撃者の鍵に基づいて完全に有効であるか、あるいは何らかの理由で無効な署名であるかもしれません。これらの各状況に対して対処が必要です。
                                </p>
                            </div>
                            <div id="rfc.section.7.2.6.p.2">
                                <p>一連の有効な署名を処理する検証者は、署名者（署名鍵によって識別される）をすべて考慮する必要があります。期待される署名者からの署名のみを、署名の暗号的妥当性にかかわらず受け入れるべきです。
                                </p>
                            </div>
                            <div id="rfc.section.7.2.6.p.3">
                                <p>メッセージ上の一連の署名を処理する検証者は、どのように扱うかを決定する必要があります。もし少なくとも一つの署名が有効であればメッセージを受け入れる設計であれば、検証者は有効な署名の前に無効な署名を削除して処理を続けることができます。逆に、単一の無効な署名によりメッセージを拒否する設計だと、攻撃者は有効な署名に無効な署名を注入してサービス拒否を引き起こすことができます。
                                </p>
                            </div>
                        </section>
                        <section id="security-signature-tag">
                            <h4 id="rfc.section.7.2.7"><a href="#rfc.section.7.2.7">7.2.7.</a>&nbsp;<a
                                    href="#security-signature-tag">アプリケーション固有署名タグの衝突</a>
                            </h4>
                            <div id="rfc.section.7.2.7.p.1">
                                <p>複数のアプリケーションやプロトコルが同じメッセージに同時に HTTP 署名を適用することがあります。実際、これは多くの状況で望ましい機能です（<a
                                        href="#signature-multiple" title="Multiple Signatures">Section 4.3</a>
                                    を参照）。単純な検証者は複数署名の処理中に混乱し、関連のないまたは無関係な署名に基づいてメッセージを受け入れたり拒否したりする可能性があります。アプリケーションが自分の処理に適用される署名を選択するのを助けるために、アプリケーションは
                                    <span class="tt">tag</span> 署名パラメータの特定値を宣言することができます（<a href="#signature-params"
                                        title="Signature Parameters">Section 2.3</a>
                                    を参照）。例えば、アプリケーションゲートウェイを対象とする署名は、そのアプリケーションの署名パラメータとして <span
                                        class="tt">tag="app-gateway"</span> を要求することができます。
                                </p>
                            </div>
                            <div id="rfc.section.7.2.7.p.2">
                                <p><span class="tt">tag</span>
                                    パラメータの使用は、攻撃者が同じ値をターゲットアプリケーションとしても使用するのを妨げるものではありません。パラメータ値は公開され制限がないためです。その結果、検証者はどの署名をチェックするかを限定するために
                                    <span class="tt">tag</span>
                                    パラメータの値のみを用いるべきです。各署名は十分なカバレッジが提供されているかどうかを確認するために検証者によって個別に検査される必要があります（<a
                                        href="#security-coverage" title="Insufficient Coverage">Section 7.2.1</a> を参照）。
                                </p>
                            </div>
                        </section>
                        <section id="security-message-content">
                            <h4 id="rfc.section.7.2.8"><a href="#rfc.section.7.2.8">7.2.8.</a>&nbsp;<a
                                    href="#security-message-content">メッセージコンテンツ</a></h4>
                            <div id="rfc.section.7.2.8.p.1">
                                <p>本仕様単体では、リクエストまたはレスポンスのいずれに対しても、署名の下で HTTP メッセージのコンテンツを直接カバーするものではありません。ただし、<a
                                        href="#RFC9530"><cite title="Digest Fields">[DIGEST]</cite></a>
                                    はコンテンツの暗号学的ダイジェストをフィールドに表現するための一連のフィールドを定義しています。一度このフィールドが作成されれば、それは <a
                                        href="#http-fields" title="HTTP Fields">Section 2.1</a>
                                    に定義された他のフィールドと同様に署名ベースに含めることができます。</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.2" class="avoidbreakafter">
                                <p>例えば、次のレスポンスメッセージにおいて：</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.3">
                                <pre class="text">
HTTP/1.1 200 OK
Content-Type: application/json

{"hello": "world"}
</pre>
                            </div>
                            <div id="rfc.section.7.2.8.p.4" class="avoidbreakafter">
                                <p>コンテンツのダイジェストは Content-Digest フィールドに次のように追加できます：</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 200 OK
Content-Type: application/json
Content-Digest: \
  sha-256=:X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=:

{"hello": "world"}
</pre>
                            </div>
                            <div id="rfc.section.7.2.8.p.6" class="avoidbreakafter">
                                <p>このフィールドは他のフィールドと同様に署名ベースに含めることができ、基本的な署名パラメータと共に扱われます：</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.7">
                                <pre>
"@status": 200
"content-digest": \
  sha-256=:X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=:
"@signature-input": ("@status" "content-digest")
</pre>
                            </div>
                            <div id="rfc.section.7.2.8.p.8">
                                <p>ここから署名プロセスは通常どおり進行します。</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.9">
                                <p>検証時には、検証者が署名だけでなく実際に受信したコンテンツに対して Content-Digest
                                    フィールドの値を検証することが重要です。検証者がこの手順を実行しない場合、攻撃者はメッセージコンテンツを差し替えながら Content-Digest
                                    フィールド値をそのままにして署名を通過させることが可能になります。署名が直接カバーしているのはフィールド値のみであるため、署名だけを検査するのはこの種の差し替え攻撃に対する十分な防護ではありません。
                                </p>
                            </div>
                            <div id="rfc.section.7.2.8.p.10">
                                <p><a href="#RFC9530"><cite title="Digest Fields">[DIGEST]</cite></a>
                                    で議論されているように、Content-Digest
                                    フィールドの値はメッセージのコンテンツエンコーディングに依存します。中継者がコンテンツエンコーディングを変更すると、結果として Content-Digest
                                    値は変わります。これは署名を無効にします。そのような処理を行う中継者は、更新された Content-Digest 値で新しい署名を適用する必要があります。これは <a
                                        href="#signature-multiple" title="Multiple Signatures">Section 4.3</a>
                                    のリバースプロキシ使用例に類似しています。</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.11">
                                <p><span class="tt">req</span> パラメータ（<a href="#content-request-response"
                                        title="Signing Request Components in a Response Message">Section
                                        2.4</a>）を使用するアプリケーションは、この機能の制限を認識する必要があります。具体的には、クライアントがリクエストに Content-Digest
                                    ヘッダーフィールドのようなものを含めない場合、サーバーはそのリクエストのコンテンツをカバーする署名を含めることができません。</p>
                            </div>
                        </section>
                    </section>
                    <section id="cryptographic-considerations">
                        <h3 id="rfc.section.7.3"><a href="#rfc.section.7.3">7.3.</a>&nbsp;<a
                                href="#cryptographic-considerations">暗号に関する考慮事項</a></h3>
                        <section id="security-collision">
                            <h4 id="rfc.section.7.3.1"><a href="#rfc.section.7.3.1">7.3.1.</a>&nbsp;<a
                                    href="#security-collision">暗号と署名衝突</a></h4>
                            <div id="rfc.section.7.3.1.p.1">
                                <p>本書は独自の暗号プリミティブを定義せず、代わりに他の仕様に依拠してこれらの要素を定義します。もし署名アルゴリズムや署名ベースの処理に使用される鍵が攻撃に対して脆弱である場合、生成される署名も同じ攻撃に対して脆弱になります。
                                </p>
                            </div>
                            <div id="rfc.section.7.3.1.p.2">
                                <p>署名システムに対する一般的な攻撃は署名衝突を強いることであり、同じ署名値が複数の異なる入力に対して成功裏に検証される状況です。本仕様は HTTP
                                    メッセージから署名ベースを再構築し、署名対象のコンポーネント一覧が署名内で固定されるため、衝突を効果的に行うのは難しいですが不可能ではありません。攻撃者は衝突を有効にするために
                                    HTTP メッセージとそのカバーされたコンポーネントを操作する必要があります。</p>
                            </div>
                            <div id="rfc.section.7.3.1.p.3">
                                <p>これに対抗するために、HTTP メッセージに署名する際は検証済みの鍵と署名アルゴリズムのみを使用するべきです。"HTTP Signature Algorithms"
                                    レジストリは、アプリケーションがメッセージに適用するための信頼できる署名アルゴリズムの一つの情報源となります。</p>
                            </div>
                            <div id="rfc.section.7.3.1.p.4">
                                <p>署名パラメータ値や署名値自体を個別に置換することは可能ですが、署名ベース生成アルゴリズム（<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section
                                        2.5</a>）は常に署名パラメータを署名ベースの最後の値として決定論的な直列化方法でカバーします。このステップにより署名パラメータと署名値が強く結び付けられ、攻撃者が署名ベースの一部を部分的に置換することを困難にします。
                                </p>
                            </div>
                        </section>
                        <section id="security-keys">
                            <h4 id="rfc.section.7.3.2"><a href="#rfc.section.7.3.2">7.3.2.</a>&nbsp;<a
                                    href="#security-keys">鍵の窃取</a></h4>
                            <div id="rfc.section.7.3.2.p.1">
                                <p>署名ベースの暗号システムの基本的な前提は、署名鍵が攻撃者によって漏洩していないことです。もしメッセージの署名に使用される鍵が外部に持ち出されたり盗まれたりすると、攻撃者はその鍵を用いて自身の署名を生成できるようになります。したがって署名者は署名鍵素材を漏洩、取得および攻撃者の使用から保護しなければなりません。
                                </p>
                            </div>
                            <div id="rfc.section.7.3.2.p.2">
                                <p>これに対抗するために、署名者は鍵を時間とともにローテーションして盗まれた鍵が有効である時間を制限することができます。署名者は鍵エスクローや安全な鍵保管システムを使用して鍵に対する攻撃面を制限することもできます。さらに、非対称署名アルゴリズムを使用すると対称アルゴリズムよりも鍵素材の露出が少なくなります（<a
                                        href="#security-symmetric" title="Symmetric Cryptography">Section 7.3.3</a>
                                    を参照）。</p>
                            </div>
                        </section>
                        <section id="security-symmetric">
                            <h4 id="rfc.section.7.3.3"><a href="#rfc.section.7.3.3">7.3.3.</a>&nbsp;<a
                                    href="#security-symmetric">対称暗号</a></h4>
                            <div id="rfc.section.7.3.3.p.1">
                                <p>本書は非対称および対称の両方の暗号を HTTP
                                    メッセージに適用することを許容します。性質上、対称暗号方式は署名者と検証者が同一の鍵素材を知っていることを要求します。これは、検証者が有効な署名を生成できることを意味します。もし検証者が侵害されれば、攻撃者は署名者になりすますことが可能になります。
                                </p>
                            </div>
                            <div id="rfc.section.7.3.3.p.2">
                                <p>可能な場合は非対称方式や安全な鍵合意メカニズムを使用してこの種の攻撃を回避するべきです。対称方式を使用する場合、鍵素材の配布はシステム全体で保護する必要があります。一つの手法は検証プロセス（および鍵素材）を他のコードから分離する別個の暗号モジュールを使用して攻撃面を最小化することです。別の手法は、署名者と検証者が直接鍵値を共有せずに各メッセージのための一意の鍵を合意するための鍵導出関数を使用することです。
                                </p>
                            </div>
                            <div id="rfc.section.7.3.3.p.3">
                                <p>さらに、システム内で対称アルゴリズムが許容される場合は、鍵仕様ダウングレード攻撃を回避するために特別な注意が必要です（<a
                                        href="#security-keydowngrade"
                                        title="Key and Algorithm Specification Downgrades">Section 7.3.6</a> を参照）。</p>
                            </div>
                        </section>
                        <section id="security-keymixup">
                            <h4 id="rfc.section.7.3.4"><a href="#rfc.section.7.3.4">7.3.4.</a>&nbsp;<a
                                    href="#security-keymixup">鍵仕様の混同</a></h4>
                            <div id="rfc.section.7.3.4.p.1">
                                <p>HTTP
                                    メッセージ上に有効な署名があるという事実だけでは、そのメッセージが適切な当事者によって署名されたことを証明するには不十分です。検証者がある鍵とアルゴリズムがそのメッセージに対して適切であることを確認するのは検証者の責任です。検証者がこの検査を行わない場合、攻撃者は自分自身の鍵を用いて署名を置換し、検証者にそれを受け入れさせることが可能になります。これに対処するために、検証者は署名がメッセージに対して検証可能であるだけでなく、使用された鍵とアルゴリズムがその利用に適切であることを確認する必要があります。
                                </p>
                            </div>
                        </section>
                        <section id="security-nondeterministic">
                            <h4 id="rfc.section.7.3.5"><a href="#rfc.section.7.3.5">7.3.5.</a>&nbsp;<a
                                    href="#security-nondeterministic">非決定的な署名プリミティブ</a></h4>
                            <div id="rfc.section.7.3.5.p.1">
                                <p>RSA-PSS や ECDSA
                                    のような一部の暗号プリミティブは出力が非決定的であり、アルゴリズム内にある程度のエントロピーを含みます。そのようなアルゴリズムでは、連続して生成された複数の署名は一致しません。検証者の怠慢な実装がこの違いを無視して、署名ベースを再署名して同じ値が生成されるかを単にチェックすると、決定論的なアルゴリズム（HMAC
                                    や EdDSA
                                    など）では動作しますが、非決定論的なアルゴリズムで生成された有効な署名の検証には失敗します。したがって検証者は常に当該アルゴリズムの正しく定義された検証関数を使用し、単純な比較を行ってはなりません。
                                </p>
                            </div>
                        </section>
                        <section id="security-keydowngrade">
                            <h4 id="rfc.section.7.3.6"><a href="#rfc.section.7.3.6">7.3.6.</a>&nbsp;<a
                                    href="#security-keydowngrade">鍵およびアルゴリズム仕様のダウングレード</a></h4>
                            <div id="rfc.section.7.3.6.p.1">
                                <p>本仕様を適用するアプリケーションは鍵仕様ダウングレード攻撃から保護する必要があります。例えば同じ RSA 鍵が RSA-PSS と RSA v1.5
                                    の両方に使用可能な場合、アプリケーションが鍵を RSA-PSS のみで使用することを期待するのであれば、より弱い RSA 1.5
                                    仕様を用いた署名を拒否する必要があります。</p>
                            </div>
                            <div id="rfc.section.7.3.6.p.2">
                                <p>別のダウングレード攻撃の例として、非対称アルゴリズム（RSA-PSS 等）が期待される場合に、攻撃者が対称アルゴリズム（HMAC
                                    等）を代わりに用いるケースがあります。単純な検証者実装は公開 RSA 鍵の値を HMAC
                                    検証関数の入力として使う可能性があり、公開鍵が攻撃者に知られているため攻撃者はこの既知の鍵に対する有効な HMAC
                                    署名を生成できてしまいます。これを防ぐために、検証者は鍵素材とアルゴリズムの両方が当該用途に適切であることを確認する必要があります。さらに本仕様は署名パラメータ
                                    <span class="tt">alg</span>
                                    を用いたランタイムでのアルゴリズム指定を許容していますが、アプリケーションはアルゴリズムの置換を防ぐために静的設定や上位プロトコルレベルでのアルゴリズム指定を使用することを推奨します。
                                </p>
                            </div>
                        </section>
                        <section id="security-sign-signature">
                            <h4 id="rfc.section.7.3.7"><a href="#rfc.section.7.3.7">7.3.7.</a>&nbsp;<a
                                    href="#security-sign-signature">署名値の署名</a></h4>
                            <div id="rfc.section.7.3.7.p.1">
                                <p><span class="tt">req</span> パラメータ（<a href="#content-request-response"
                                        title="Signing Request Components in a Response Message">Section
                                        2.4</a>）や複数署名（<a href="#signature-multiple" title="Multiple Signatures">Section
                                        4.3</a>）をメッセージに適用する際、既存の Signature
                                    フィールドの値を署名することで、既存署名のバイトを新しい署名の値に含めることが可能です。一見するとこの慣行は元の署名の下のコンポーネントを可検証に帰属的にカバーするように見えますが、<a
                                        href="#JACKSON2019"><cite
                                            title="Seems Legit: Automated Analysis of Subtle Attacks on Protocols that Use Signatures">[JACKSON2019]</cite></a>
                                    で説明される攻撃を用いて、無関係なメッセージ上で署名出力値を偽装することが可能です。</p>
                            </div>
                            <div id="rfc.section.7.3.7.p.2">
                                <p>以下の例では、Alice が Bob に署名付きリクエストを送信し、Bob は Alice の受信メッセージに応答していることを証明する署名付きレスポンスを Alice
                                    に返したいとします。Mallory はこのトラフィックを傍受して Alice のメッセージを自分のものに差し替え、Alice が傍受に気付かないようにしたいと考えます。
                                </p>
                            </div>
                            <div id="rfc.section.7.3.7.p.3">
                                <ol type="1">
                                    <li>Alice はメッセージ <span class="tt">Req_A</span> を作成し、自分の秘密鍵 <span
                                            class="tt">Key_A_Sign</span> を用いて署名 <span class="tt">Sig_A</span> を適用する。
                                    </li>
                                    <li>Alice は <span class="tt">Req_A</span> を Bob に送るつもりであると信じている。</li>
                                    <li>Mallory は <span class="tt">Req_A</span> を傍受し、このメッセージから値 <span
                                            class="tt">Sig_A</span> を読み取る。</li>
                                    <li>Mallory は Bob に送る別のメッセージ <span class="tt">Req_M</span> を生成する。</li>
                                    <li>Mallory は自分のリクエスト <span class="tt">Req_M</span> に対して、かつその署名のバイト値が元の <span
                                            class="tt">Sig_A</span> と完全に一致するような署名キー <span class="tt">Key_M_Sign</span>
                                        を作成し、有効な署名 <span class="tt">Sig_M</span> を生成できるようにする。</li>
                                    <li>Mallory は <span class="tt">Req_M</span> を <span class="tt">Sig_M</span> と共に Bob
                                        に送信する。</li>
                                    <li>Bob は Mallory の検証鍵 <span class="tt">Key_M_Verify</span> に対して <span
                                            class="tt">Sig_M</span> を検証する。Bob は自分が Alice に応答しているとは全く考えていない。</li>
                                    <li>Bob は <span class="tt">Req_M</span> に対するレスポンス <span class="tt">Res_B</span>
                                        を作成し、自分の鍵 <span class="tt">Key_B_Sign</span> を用いてこのメッセージに対する署名 <span
                                            class="tt">Sig_B</span> を作成する。Bob は <span class="tt">Sig_B</span>
                                        のカバーされたコンポーネントに <span class="tt">Sig_M</span> の値を含めるが、リクエストメッセージから他の部分を含めない。
                                    </li>
                                    <li>Mallory は Bob からのレスポンス <span class="tt">Res_B</span>（<span
                                            class="tt">Sig_B</span> を含む）を受け取り、これを Alice にリプレイする。</li>
                                    <li>Alice は Mallory から <span class="tt">Res_B</span> を受け取り、Bob の検証鍵 <span
                                            class="tt">Key_B_Verify</span> を用いて <span class="tt">Sig_B</span>
                                        を検証する。Alice は自分の元の署名 <span class="tt">Sig_A</span> のバイトを署名ベースに含め、署名が検証される。</li>
                                    <li>Alice は Bob が自分のメッセージに応答したと信じ、これが起こったという暗号学的証拠を得たと誤認するが、実際には Bob は Mallory
                                        の悪意あるリクエストに応答しており、Alice はそれに気付かない。</li>
                                </ol>
                            </div>
                            <div id="rfc.section.7.3.7.p.4">
                                <p>これを軽減するために、Bob はリクエストメッセージの署名フィールドだけでなくより多くの部分に署名することができ、Alice のメッセージと Mallory
                                    のメッセージをより明確に区別できるようにします。特に非否認目的でこの機能を使用するアプリケーションは、元の署名で必要とされている任意のコンポーネントも二次署名で別途カバーすることを規定することができます。署名されたメッセージに対しては、第一署名の対応する
                                    Signature-Input フィールドのカバレッジを要求することにより、nonce
                                    やタイムスタンプのような一意の項目も第二の署名で十分にカバーされることを保証できます。</p>
                            </div>
                        </section>
                    </section>
                    <section id="matching-covered-components-to-message">
                        <h3 id="rfc.section.7.4"><a href="#rfc.section.7.4">7.4.</a>&nbsp;<a
                                href="#matching-covered-components-to-message">署名パラメータを対象メッセージに一致させる</a></h3>
                        <section id="security-modify">
                            <h4 id="rfc.section.7.4.1"><a href="#rfc.section.7.4.1">7.4.1.</a>&nbsp;<a
                                    href="#security-modify">必須メッセージパラメータの変更</a></h4>
                            <div id="rfc.section.7.4.1.p.1">
                                <p>攻撃者は、本来無害な署名パラメータや署名済みメッセージコンポーネントを変更することで、実質的にサービス拒否を引き起こすことができます。変更されたメッセージを拒否することが望ましい挙動ではありますが、署名検証が継続的に失敗すると、(1)
                                    システムを再稼働させるために検証者が署名チェックを無効にしてしまう（<a href="#security-ignore"
                                        title="Skipping Signature Verification">Section 7.1.1</a> を参照）か、または (2)
                                    アプリケーションが署名対象コンポーネントに関する要件を最小化してしまう可能性があります。</p>
                            </div>
                            <div id="rfc.section.7.4.1.p.2">
                                <p>アプリケーション内でそのような失敗が頻繁に発生する場合、署名者と検証者はお互いに生成した署名ベースを比較して、メッセージのどの部分が変更されているかを特定するべきです。想定される変更が見つかった場合、署名者と検証者は合格するための代替要件に合意することができます。ただし、攻撃者によるコンポーネント改変が疑われる場合に、その変更されたコンポーネントの署名要件を削除すべきではありません。
                                </p>
                            </div>
                        </section>
                        <section id="security-mismatch">
                            <h4 id="rfc.section.7.4.2"><a href="#rfc.section.7.4.2">7.4.2.</a>&nbsp;<a
                                    href="#security-mismatch">カバーされたコンポーネントの値と対象メッセージ内の値の一致</a></h4>
                            <div id="rfc.section.7.4.2.p.1">
                                <p>検証者は、署名されたメッセージコンポーネントがメッセージ自体の値と一致していることを確認する必要があります。例えば、<span
                                        class="tt">@method</span> 導出コンポーネントは、署名ベース内の値がこのメッセージを提示する際に使用された HTTP
                                    メソッドと同じであることを要求します。本仕様は、検証者がメッセージから署名ベースを導出することを義務付けることでこれを促進しますが、怠惰なキャッシュや生の署名ベースを処理サブシステムに渡すような運用により、提示された署名と一致しないメッセージを下流の検証者が受け入れてしまう可能性があります。
                                </p>
                            </div>
                            <div id="rfc.section.7.4.2.p.2">
                                <p>これに対処するために、署名ベースを生成するコンポーネントは、システム内の署名者と検証者の両方から信頼される必要があります。</p>
                            </div>
                        </section>
                        <section id="security-message-component-context">
                            <h4 id="rfc.section.7.4.3"><a href="#rfc.section.7.4.3">7.4.3.</a>&nbsp;<a
                                    href="#security-message-component-context">メッセージコンポーネントのソースとコンテキスト</a>
                            </h4>
                            <div id="rfc.section.7.4.3.p.1">
                                <p>メッセージコンポーネント値を導出するための署名コンテキストには、対象の HTTP
                                    メッセージ自体、関連するメッセージ（例えばレスポンスを引き起こしたリクエスト）、および署名者または検証者がアクセスできる追加情報が含まれます。署名者と検証者の双方が署名ベース用のコンポーネント値を作成するときに、すべての情報の出所を慎重に検討し、信頼できないソースから情報を取得しないよう注意する必要があります。そうでないと、攻撃者はこのように緩く定義されたメッセージコンテキストを利用して、署名ベース文字列に自らの値を注入し、意図した値を上書きまたは破損させる可能性があります。
                                </p>
                            </div>
                            <div id="rfc.section.7.4.3.p.2">
                                <p>例えばほとんどの状況では、メッセージの対象 URI は <a href="#RFC9110"><cite
                                            title="HTTP Semantics">[HTTP]</cite></a> の <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.1">Section 7.1</a>
                                    に定義されているようなものです。ただし、あるアプリケーションが受信リクエストの <span class="tt">@authority</span>
                                    を署名することを要求する一方で、その処理を行うアプリケーションがリバースプロキシの背後にあるとしましょう。そのようなアプリケーションは <span
                                        class="tt">@authority</span> 値の変化を想定し、プロキシの向こう側にいるクライアントから見た外部のターゲット URI
                                    を知るように構成されているかもしれません。このアプリケーションは、その構成済みの値を <span class="tt">@authority</span>
                                    のようなメッセージコンポーネント値を導出する際のターゲット URI として使用することができます。</p>
                            </div>
                            <div id="rfc.section.7.4.3.p.3">
                                <p>このアプローチは問題がないわけではなく、誤設定されたシステムが別のシステムコンポーネント向けに意図された署名付きリクエストを受け入れてしまう可能性があります。このシナリオでは、仲介者が代わりに自らの署名を追加してアプリケーションが直接検証できるようにすることができます（<a
                                        href="#signature-multiple" title="Multiple Signatures">Section 4.3</a>
                                    に示すとおり）。この代替アプローチはより積極的な仲介者を必要としますが、ターゲットアプリケーションが外部の構成値を知ることに頼る度合いを減らします。</p>
                            </div>
                            <div id="rfc.section.7.4.3.p.4">
                                <p>別の例として、<a href="#content-request-response"
                                        title="Signing Request Components in a Response Message">Section 2.4</a>
                                    は、レスポンスメッセージを署名すると同時にレスポンスを引き起こしたリクエストメッセージの一部を含める方法を定義しています。この場合、コンポーネント値計算のコンテキストは、署名が適用される単一のメッセージだけではなく、レスポンスとリクエストの組合せです。この機能のために、<span
                                        class="tt">req</span>
                                    フラグは、署名者がコンポーネント識別子の値のためにどのコンテキスト部分がソースになっているかを明示的に示すことを可能にします。実装は、各コンポーネントについて意図されたメッセージのみが参照されていることを確実にする必要があります。さもないと、攻撃者が一方または他方を操作して署名を破壊しようとする可能性があります。
                                </p>
                            </div>
                        </section>
                        <section id="security-context-multiple-signatures">
                            <h4 id="rfc.section.7.4.4"><a href="#rfc.section.7.4.4">7.4.4.</a>&nbsp;<a
                                    href="#security-context-multiple-signatures">複数のメッセージコンポーネントコンテキスト</a>
                            </h4>
                            <div id="rfc.section.7.4.4.p.1">
                                <p>署名済みメッセージ内でメッセージコンポーネント値を導出するためのコンテキストが、それぞれの署名ごとに異なることはあり得ます。これは特に、プロキシがメッセージを変更して変更後の値に対して署名を追加する場合に当てはまります。例えば、リバースプロキシがリクエスト中の公開ホスト名を、転送先の各サービスホスト用のホスト名に置き換えることができます。クライアントとリバースプロキシの両方が
                                    <span class="tt">@authority</span> をカバーする署名を追加する場合、サービスホストはリクエスト上で 2 つの署名を目にし、それぞれが
                                    <span class="tt">@authority</span>
                                    コンポーネントに対して異なる値を署名していることになります。これはメッセージがクライアントからサービスホストへ移動する過程でそのコンポーネントが変化したことを反映しています。
                                </p>
                            </div>
                            <div id="rfc.section.7.4.4.p.2">
                                <p>そのような場合、内部サービスが署名のうちどちらか一方のみを検証するか、あるいは <a href="#security-message-component-context"
                                        title="Message Component Source and Context">Section 7.4.3</a>
                                    で述べた外部構成情報を使用するのが一般的です。しかしながら、両方の署名を処理する検証者は、それぞれの署名に対して異なるメッセージコンポーネントコンテキストを使用する必要があります。なぜなら
                                    <span class="tt">@authority</span>
                                    コンポーネントの値は署名ごとに異なるからです。そのような検証者は、受信メッセージに対するリバースプロキシのコンテキストと、リバースプロキシから来るメッセージに対するターゲットサービスのコンテキストの両方を認識している必要があります。検証者は適切なコンテキストを適切な署名に適用するよう特に注意を払う必要があります。さもないと攻撃者はこの複雑な構成の知識を利用して検証者への入力を混乱させる可能性があります。
                                </p>
                            </div>
                            <div id="rfc.section.7.4.4.p.3">
                                <p>そのような検証者はまた、署名間のメッセージコンポーネントコンテキストの差異が予期され許容されるものであることを確認する必要があります。例えば前述のシナリオでは、リバースプロキシが元のホスト名を
                                    Forwarded ヘッダーフィールドに含め、<span class="tt">@authority</span>、forwarded、およびクライアントのエントリを
                                    Signature フィールドで署名することができます。検証者は Forwarded
                                    ヘッダのホスト名を使用して、そのホスト名が期待どおりに変換されていることを確認できます。</p>
                            </div>
                        </section>
                    </section>
                    <section id="http-processing">
                        <h3 id="rfc.section.7.5"><a href="#rfc.section.7.5">7.5.</a>&nbsp;<a
                                href="#http-processing">HTTP 処理</a></h3>
                        <section id="security-lazy-header-parser">
                            <h4 id="rfc.section.7.5.1"><a href="#rfc.section.7.5.1">7.5.1.</a>&nbsp;<a
                                    href="#security-lazy-header-parser">無効な HTTP フィールド名を導出コンポーネント名として処理すること</a></h4>
                            <div id="rfc.section.7.5.1.p.1">
                                <p>HTTP フィールド名の定義では、名前のどの位置でも <span class="tt">@</span>
                                    文字の使用は許可されていません。したがって、すべての導出コンポーネント名は <span class="tt">@</span>
                                    文字で始まるため、これらの名前空間は完全に分離されるべきです。しかし、一部の HTTP
                                    実装はフィールド名で許容される文字に十分厳密ではないことがあります。そのような実装では、送信者（または攻撃者）が <span class="tt">@</span>
                                    文字で始まるヘッダーフィールドを注入し、それがアプリケーションコードに渡される可能性があります。これらの無効なヘッダは導出メッセージ内容の一部を上書きして任意の値を差し替えるのに使われ得るため、攻撃者に署名衝突（<a
                                        href="#security-collision" title="Cryptography and Signature Collision">Section
                                        7.3.1</a>）攻撃やその他の機能的置換攻撃（例えば GET リクエストの署名を細工した POST
                                    リクエストで使用するなど）を仕掛ける余地を与える可能性があります。</p>
                            </div>
                            <div id="rfc.section.7.5.1.p.2">
                                <p>これに対抗するため、メッセージコンポーネントの値を選択する際、コンポーネント名が <span class="tt">@</span>
                                    文字で始まる場合は、それを導出コンポーネントとして処理し、決して HTTP フィールドとして処理してはなりません。コンポーネント名が <span
                                        class="tt">@</span> 文字で始まらない場合にのみ、メッセージのフィールドから値を取得できます。<a
                                        href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a>
                                    で述べられるアルゴリズムは安全な処理順序を提供します。</p>
                            </div>
                        </section>
                        <section id="security-field-values">
                            <h4 id="rfc.section.7.5.2"><a href="#rfc.section.7.5.2">7.5.2.</a>&nbsp;<a
                                    href="#security-field-values">意味的に等価なフィールド値</a></h4>
                            <div id="rfc.section.7.5.2.p.1">
                                <p>署名ベース生成アルゴリズム（<a href="#create-sig-input" title="Creating the Signature Base">Section
                                        2.5</a>）は、HTTP
                                    フィールドの値をそのコンポーネント値として使用します。通常は、これは署名者と検証者の両方でフィールド値の実際のバイト列をコンポーネント値として取ることを意味します。しかし、一部のフィールド値は、その値自体のバイト列を変更する意味的に等価な変換を許容する場合があります。例えば、フィールド定義は値の一部またはすべてを大文字小文字を区別しないと宣言したり、内部の空白文字の特別な扱いを持たせたりできます。また、Via
                                    ヘッダのコメント削除のように中継者による想定される変換を持つフィールドもあります。そのような場合、検証者は署名者が使用したバイト列と異なる等価に変換されたフィールド値を使用してしまい、検証が失敗する可能性があります。検証者にとってはこの種のエラーの検出は困難です。なぜならフィールド値はアプリケーション上は許容されるままだからです。
                                </p>
                            </div>
                            <div id="rfc.section.7.5.2.p.2">
                                <p>そのようなフィールドを処理する際、署名者と検証者は変換をどのように扱うかを合意する必要があります。ひとつの選択肢は問題のあるフィールドに署名しないことですが、その場合でもアプリケーションに対して十分な署名カバレッジが残るよう注意する必要があります（<a
                                        href="#security-coverage" title="Insufficient Coverage">Section 7.2.1</a>
                                    を参照）。もう一つの選択肢は、フィールドを HTTP
                                    メッセージに追加する前にフィールドのアプリケーション固有の正規化値を定義することです（例えば内部コメントを常に削除してから署名する、あるいは常に小文字に変換するなど）。これらの変換はフィールドが署名ベース生成アルゴリズムへの入力として使用される前に適用されるので、署名ベースはメッセージ内に表示されるバイト値をそのまま含むことになります。もし変換がメッセージから値を抽出した後に署名ベースに追加する前に適用されると、値置換攻撃のような別の攻撃面が生じ得ます。すべてのアプリケーション固有の追加規則は本仕様の範囲外であり、その性質上、これらの変換はその特定アプリケーション外での相互運用性を損なう可能性があります。可能な限りこうした追加規則の使用は避けることが推奨されます。
                                </p>
                            </div>
                        </section>
                        <section id="security-structured">
                            <h4 id="rfc.section.7.5.3"><a href="#rfc.section.7.5.3">7.5.3.</a>&nbsp;<a
                                    href="#security-structured">構造化フィールド値の解析</a></h4>
                            <div id="rfc.section.7.5.3.p.1">
                                <p>本仕様のいくつかの部分は、Structured Field 値の解析（<a href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>）に依存しています。特に、HTTP
                                    Structured Field 値の厳密な直列化（<a href="#http-field-structured"
                                        title="Strict Serialization of HTTP Structured Fields">Section
                                        2.1.1</a>）、Dictionary Structured Field のメンバー参照（<a href="#http-field-dictionary"
                                        title="Dictionary Structured Field Members">Section 2.1.2</a>）、および署名検証時の <span
                                        class="tt">@signature-input</span> 値の処理（<a href="#verify"
                                        title="Verifying a Signature">Section 3.2</a>）。Structured Field
                                    値は比較的解析が容易に設計されていますが、そのようなパーサの単純または壊れた実装は、実装に微妙な攻撃面を露呈させる可能性があります。</p>
                            </div>
                            <div id="rfc.section.7.5.3.p.2">
                                <p>例えば、もし <span class="tt">@signature-input</span>
                                    値のバグのあるパーサがリスト内の文字列値の引用符の正しい閉じを強制しない場合、攻撃者はこれを悪用してメッセージの Signature-Input
                                    値を操作し、署名ベースに追加の内容を注入する可能性があります。</p>
                            </div>
                            <div id="rfc.section.7.5.3.p.3">
                                <p>これに対抗するため、実装は署名側および検証側の両方で、すべての Structured Field 処理に対して完全準拠で信頼できるパーサを使用するべきです。</p>
                            </div>
                        </section>
                        <section id="security-versions">
                            <h4 id="rfc.section.7.5.4"><a href="#rfc.section.7.5.4">7.5.4.</a>&nbsp;<a
                                    href="#security-versions">HTTP バージョンとコンポーネントの曖昧性</a></h4>
                            <div id="rfc.section.7.5.4.p.1">
                                <p>一部のメッセージコンポーネントは HTTP のバージョンによって異なる方法で表現されます。例えば、リクエストターゲットのオーソリティは HTTP/1.1 では Host
                                    ヘッダーフィールドで送信されますが、HTTP/2 では <span class="tt">:authority</span> 疑似ヘッダで送信されます。署名者が
                                    HTTP/1.1 メッセージを送り Host ヘッダフィールドに署名したが、メッセージが検証者に届く前に HTTP/2 に変換された場合、Host
                                    ヘッダが削除される可能性があり、署名は検証されなくなります。</p>
                            </div>
                            <div id="rfc.section.7.5.4.p.2">
                                <p>このため、HTTP メッセージ署名は特定の値を取得する単一の方法を定義する導出コンポーネント群を定義しています。例えば Host ヘッダの代わりに <span
                                        class="tt">@authority</span> 導出コンポーネント（<a href="#content-request-authority"
                                        title="Authority">Section 2.2.3</a>）などです。可能な限りこのような選択肢には導出コンポーネントを優先して使用するべきです。
                                </p>
                            </div>
                        </section>
                        <section id="security-canonicalization">
                            <h4 id="rfc.section.7.5.5"><a href="#rfc.section.7.5.5">7.5.5.</a>&nbsp;<a
                                    href="#security-canonicalization">正規化に関する攻撃</a></h4>
                            <div id="rfc.section.7.5.5.p.1">
                                <p>署名ベースの生成に曖昧さがあると、攻撃者に署名を置換または破壊する手段を与える可能性があります。特に HTTP
                                    フィールド値は、壊れた実装により予期せぬ挙動を引き起こす可能性があります。本仕様の単純な実装は、フィールドの単一の値をそのまま直接コンポーネント値として使用するような処理をしてしまいがちです。
                                </p>
                            </div>
                            <div id="rfc.section.7.5.5.p.2">
                                <p>例えば <span class="tt">obs-fold</span>
                                    フィールド値の扱いで内部の行折返しや空白を除去しないと、署名ベースに余分な改行が署名者によって導入され、署名衝突（<a
                                        href="#security-collision" title="Cryptography and Signature Collision">Section
                                        7.3.1</a>）攻撃の足掛かりになる可能性があります。あるいは、複数回現れるヘッダーフィールドが本仕様で要求されるように単一の文字列値に結合されない場合、署名されたコンポーネント値が署名ベースに複数回現れ、それを置換または攻撃される可能性があります。
                                </p>
                            </div>
                            <div id="rfc.section.7.5.5.p.3">
                                <p>これに対処するため、フィールド値処理アルゴリズム全体を署名者および検証者のすべての実装で実装する必要があります。</p>
                            </div>
                        </section>
                        <section id="security-non-list">
                            <h4 id="rfc.section.7.5.6"><a href="#rfc.section.7.5.6">7.5.6.</a>&nbsp;<a
                                    href="#security-non-list">リストでないフィールド値</a></h4>
                            <div id="rfc.section.7.5.6.p.1">
                                <p>単一のメッセージで HTTP フィールドが複数回現れる場合、これらの値は署名ベースに含めるために単一の一行文字列値に結合する必要があります（<a
                                        href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a>
                                    を参照）。ただし、すべての HTTP
                                    フィールドがこの方法で結合されても有効なフィールド値であり続けるわけではありません。署名ベース生成の目的上、メッセージコンポーネント値は署名ベース文字列から読み戻されたりアプリケーションで使用されたりすることを意図していません。したがって、特にこの性質を持つフィールドについては、署名ベース生成アルゴリズムをアプリケーションによるフィールド値処理から分離して扱うのが最良の慣行と考えられます。署名されるフィールド値が検証に合格しない場合、署名されたメッセージも拒否されるべきです。
                                </p>
                            </div>
                            <div id="rfc.section.7.5.6.p.2" class="avoidbreakafter">
                                <p>もし HTTP
                                    フィールドがその値の中で引用符無しのコンマを許容するならば、複数のフィールド値を結合することにより、意味的に異なる二つのメッセージが署名ベース内で同じ行を生成してしまう状況が生じ得ます。例えば次の仮想的なヘッダフィールドを考えてみます。内部にコンマを含む構文を持ち、ここでは二つの別々の値リストを定義するために使用されています：
                                </p>
                            </div>
                            <div id="rfc.section.7.5.6.p.3">
                                <pre class="text">
Example-Header: value, with, lots
Example-Header: of, commas
</pre>
                            </div>
                            <div id="rfc.section.7.5.6.p.4" class="avoidbreakafter">
                                <p>このヘッダフィールドについて、すべての値を単一のフィールド値として送信すると単一の値リストになります：</p>
                            </div>
                            <div id="rfc.section.7.5.6.p.5">
                                <pre class="text">
Example-Header: value, with, lots, of, commas
</pre>
                            </div>
                            <div id="rfc.section.7.5.6.p.6" class="avoidbreakafter">
                                <p>これら両方のメッセージは署名ベース内で次の行を生成します：</p>
                            </div>
                            <div id="rfc.section.7.5.6.p.7">
                                <pre>
"example-header": value, with, lots, of, commas
</pre>
                            </div>
                            <div id="rfc.section.7.5.6.p.8">
                                <p>意味的に異なる二つの入力が署名ベースで同じ出力を生成し得るため、このような値を扱う際には特別な注意が必要です。</p>
                            </div>
                            <div id="rfc.section.7.5.6.p.9">
                                <p>具体的には、Set-Cookie フィールド（<a href="#RFC6265"><cite
                                            title="HTTP State Management Mechanism">[COOKIE]</cite></a>）は、<a
                                        href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>
                                    によるリスト構文に準拠しない内部構文を定義しています。特に一部の部分は引用符無しのコンマを許容し、複数のクッキーを送信する場合は通常複数の個別のフィールド行として送信されます。同じメッセージで複数の
                                    Set-Cookie フィールドが送信される場合、それらを単一行に結合して解析・使用できるようにすることは一般に不可能です（<a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a> の <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.3">Section 5.3</a>
                                    を参照）。したがって、すべてのクッキーは別々のフィールド値から処理する必要があり、署名ベースはこの目的専用に生成された特別な結合値から処理されるべきです。もしクッキー値が無効であれば、署名されたメッセージは拒否されるべきです。これは
                                    <a href="#security-multiple-fields"
                                        title="Padding Attacks with Multiple Field Values">Section 7.5.7</a>
                                    にあるパディング攻撃の可能性と関連します。
                                </p>
                            </div>
                            <div id="rfc.section.7.5.6.p.10">
                                <p>これに対処するため、アプリケーションは Set-Cookie
                                    のような問題のあるフィールドの署名を制限することを選択できます。例えば単一のフィールド値が存在し、その結果が曖昧でない場合にのみフィールドを署名に含めるといった方法です。署名者はまた
                                    <span class="tt">bs</span> パラメータを使用してそのようなフィールドを保護することもできます（<a
                                        href="#http-field-byte-sequence" title="Binary-Wrapped HTTP Fields">Section
                                        2.1.3</a> を参照）。
                                </p>
                            </div>
                        </section>
                        <section id="security-multiple-fields">
                            <h4 id="rfc.section.7.5.7"><a href="#rfc.section.7.5.7">7.5.7.</a>&nbsp;<a
                                    href="#security-multiple-fields">複数フィールド値を用いたパディング攻撃</a></h4>
                            <div id="rfc.section.7.5.7.p.1">
                                <p>HTTP フィールド値は HTTP 署名ベースに含めるために単一の文字列値に結合する必要があるため（<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>
                                    を参照）、攻撃者が特定のフィールドに追加の値を注入して検証者の署名ベースにこれを加える可能性があります。</p>
                            </div>
                            <div id="rfc.section.7.5.7.p.2">
                                <p>ほとんどの状況では、これは新しい署名ベース値が署名者の生成したものと一致しないために期待どおり署名検証が失敗します。しかし理論的には、攻撃者があるフィールドにゴミ値を注入し、別のフィールドに所望の値を注入して特定の入力を強制する可能性があります。これは攻撃者が既存のフィールド値に付け加えることで変更を達成するという点で、<a
                                        href="#security-collision" title="Cryptography and Signature Collision">Section
                                        7.3.1</a> に記述された衝突攻撃の変形です。</p>
                            </div>
                            <div id="rfc.section.7.5.7.p.3">
                                <p>これに対抗するため、アプリケーションは署名でカバーされたフィールドの内容を検証するとともに署名自体が検証されることを保証する必要があります。そのような保護により、攻撃者のパディング攻撃は、攻撃者が署名衝突を強制できた場合でもフィールド値プロセッサによって拒否されます。
                                </p>
                            </div>
                        </section>
                        <section id="security-query-elements">
                            <h4 id="rfc.section.7.5.8"><a href="#rfc.section.7.5.8">7.5.8.</a>&nbsp;<a
                                    href="#security-query-elements">クエリ要素の曖昧な扱い</a></h4>
                            <div id="rfc.section.7.5.8.p.1">
                                <p><span class="nobr">Section </span><a
                                        href="https://url.spec.whatwg.org/https://url.spec.whatwg.org/#application/x-www-form-urlencoded">5</a>
                                    の HTML フォームパラメータ形式（<a href="#HTMLURL"><cite
                                            title="URL (Living Standard)">[HTMLURL]</cite></a>）は広く展開され、多くのアプリケーションフレームワークによってサポートされています。便宜上、これらのフレームワークのいくつかは、HTTP
                                    クエリ内で見つかったクエリパラメータと、特に Content-Type が "application/x-www-form-urlencoded" の POST
                                    メッセージのメッセージ本文内で見つかるものを結合することがあります。<span class="tt">@query-param</span>
                                    導出コンポーネント識別子（<a href="#content-request-query-param" title="Query Parameters">Section
                                        2.2.8</a> 参照）は、リクエストのターゲット URI
                                    のクエリ部分からのみ値を抽出します。したがって、攻撃者が署名済みクエリパラメータを未署名のフォームパラメータで上書きする、またはその逆により署名済みクエリパラメータを覆い隠すことが可能となり得ます。
                                </p>
                            </div>
                            <div id="rfc.section.7.5.8.p.2">
                                <p>これに対処するため、アプリケーションは署名ベースおよびアプリケーションで使用される値が一貫したコンテキスト（この場合はターゲット URI
                                    のクエリ成分）から取得されることを確認する必要があります。さらに、HTTP リクエストにコンテンツがある場合は、<a
                                        href="#security-message-content" title="Message Content">Section 7.2.8</a>
                                    で述べたようにメッセージコンテンツ自体にも署名することを検討すべきです。</p>
                            </div>
                        </section>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="privacy">
                    <h2 id="rfc.section.8" class="np"><a href="#rfc.section.8">8.</a>&nbsp;<a
                            href="#privacy">プライバシーに関する考慮事項</a></h2>
                    <section id="privacy-identify-keys">
                        <h3 id="rfc.section.8.1"><a href="#rfc.section.8.1">8.1.</a>&nbsp;<a
                                href="#privacy-identify-keys">鍵による識別</a></h3>
                        <div id="rfc.section.8.1.p.1">
                            <p>もし署名者が複数の検証者に対して同じ鍵を使用するか、単一の検証者に対して時間を通じて同じ鍵を使用する場合、その鍵の継続的な使用によって署名者は検証者の集合全体にわたって追跡され得ます。暗号鍵は機能的に一意であることが意図されているため、同じ鍵を長期間使用することは複数のメッセージに同一の当事者が署名している強い指標になります。
                            </p>
                        </div>
                        <div id="rfc.section.8.1.p.2">
                            <p>多くのアプリケーションではこれは望ましい特性であり、HTTP
                                メッセージ署名を署名者を検証者に対して認証する一部として使用できることを可能にします。しかしながら、署名者が気付かない意図しない追跡につながる可能性もあります。この種の追跡に対抗するため、署名者は通信している各検証者ごとに異なる鍵を使用するか、あるいは与えられた検証者にメッセージを送る際に鍵をローテーションすることができます。これらの方法は他の反トラッキング技術の必要性を否定するものではありません。
                            </p>
                        </div>
                    </section>
                    <section id="privacy-confidentiality">
                        <h3 id="rfc.section.8.2"><a href="#rfc.section.8.2">8.2.</a>&nbsp;<a
                                href="#privacy-confidentiality">署名は機密性を提供しない</a></h3>
                        <div id="rfc.section.8.2.p.1">
                            <p>HTTP メッセージ署名は、署名によって保護される情報に対して機密性を提供しません。HTTP
                                メッセージの内容、すべてのフィールドの値、および署名値自体は、メッセージにアクセスできる任意の当事者に平文で提示されます。</p>
                        </div>
                        <div id="rfc.section.8.2.p.2">
                            <p>輸送レベルでの機密性を提供するためには、<a href="#security-tls" title="Use of TLS">Section 7.1.2</a>
                                で述べられているように TLS または同等の手段を使用できます。</p>
                        </div>
                    </section>
                    <section id="privacy-oracle">
                        <h3 id="rfc.section.8.3"><a href="#rfc.section.8.3">8.3.</a>&nbsp;<a
                                href="#privacy-oracle">オラクル（情報漏洩の危険）</a></h3>
                        <div id="rfc.section.8.3.p.1">
                            <p>エラー条件に関して開発者に有用なフィードバックを提供する必要性と、攻撃者に追加情報を与えないようにする必要性のバランスを取ることが重要です。例えば、無邪気で役立つサーバ実装がリソース要求に必要な鍵識別子を示そうとするかもしれません。もし誰かがその鍵を誰が管理しているかを知れば、リソースの存在と鍵で識別される当事者の間に相関関係を作ることができます。そのような情報へのアクセスは攻撃者が正当なリソース所有者をさらなる攻撃の標的にするために利用することができます。
                            </p>
                        </div>
                    </section>
                    <section id="privacy-required">
                        <h3 id="rfc.section.8.4"><a href="#rfc.section.8.4">8.4.</a>&nbsp;<a
                                href="#privacy-required">必須のコンテンツ</a></h3>
                        <div id="rfc.section.8.4.p.1">
                            <p>本仕様の中核的設計理念は、署名でカバーされるすべてのメッセージコンポーネントが、検証者が署名ベースを再作成し署名を検証するために利用可能である必要があるということです。その結果、本仕様の適用が特定のフィールドの署名を要求する場合、検証者はそのフィールドの値にアクセスする必要があります。
                            </p>
                        </div>
                        <div id="rfc.section.8.4.p.2">
                            <p>例えば、仲介プロセッサを含む複雑なシステムでは、署名を壊すことを恐れて仲介者がプライバシーに敏感な情報をメッセージから削除できなくなるような驚くべき挙動を引き起こす可能性があります。この特定の状況を緩和する一つの方法は、仲介者自身が署名を検証し、その後メッセージを変更してプライバシーに敏感な情報を削除することです。仲介者はこの時点で自身の署名を追加して、次の宛先に対して受信した署名が検証されたことを示すことができます。これは
                                <a href="#signature-multiple" title="Multiple Signatures">Section 4.3</a> の例に示されています。
                            </p>
                        </div>
                    </section>
                </section>
                <section class="np">
                    <div id="rfc.references">
                        <h2 id="rfc.section.9"><a href="#rfc.section.9">9.</a> References</h2>
                        <section>
                            <div id="rfc.references.2">
                                <h3 id="rfc.section.9.1"><a href="#rfc.section.9.1">9.1.</a> Normative References</h3>
                                <dl class="dl-horizontal">
                                    <dt id="RFC5234">[<a href="#RFC5234" class="smpl">ABNF</a>]</dt>
                                    <dd>Crocker, D., Ed. and P. Overell, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc5234.html">Augmented BNF for Syntax
                                            Specifications: ABNF</a>”, <a
                                            href="https://www.rfc-editor.org/info/std68">STD 68</a>, RFC 5234, <a
                                            href="https://dx.doi.org/10.17487/RFC5234">DOI 10.17487/RFC5234</a>, January
                                        2008, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;.
                                    </dd>
                                    <dt id="RFC0020">[<a href="#RFC0020" class="smpl">ASCII</a>]</dt>
                                    <dd>Cerf, V., “<a href="https://www.rfc-editor.org/rfc/rfc20.html">ASCII format for
                                            network interchange</a>”, <a
                                            href="https://www.rfc-editor.org/info/std80">STD 80</a>, RFC 20, <a
                                            href="https://dx.doi.org/10.17487/RFC0020">DOI 10.17487/RFC0020</a>, October
                                        1969, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc20">https://www.rfc-editor.org/info/rfc20</a>&gt;.
                                    </dd>
                                    <dt id="FIPS186-5">[<a href="#FIPS186-5" class="smpl">FIPS186-5</a>]</dt>
                                    <dd>NIST, “<a href="https://doi.org/10.6028/NIST.FIPS.186-5">Digital Signature
                                            Standard (DSS)</a>”, <a
                                            href="https://dx.doi.org/10.6028/NIST.FIPS.186-5">DOI
                                            10.6028/NIST.FIPS.186-5</a>, February 2023, &lt;<a
                                            href="https://doi.org/10.6028/NIST.FIPS.186-5">https://doi.org/10.6028/NIST.FIPS.186-5</a>&gt;.
                                    </dd>
                                    <dt id="HTMLURL">[<a href="#HTMLURL" class="smpl">HTMLURL</a>]</dt>
                                    <dd>WHATWG, “<a href="https://url.spec.whatwg.org/">URL (Living Standard)</a>”,
                                        January 2024, &lt;<a
                                            href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>&gt;.
                                    </dd>
                                    <dt id="RFC9112">[<a href="#RFC9112" class="smpl">HTTP/1.1</a>]</dt>
                                    <dd>Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9112.html">HTTP/1.1</a>”, <a
                                            href="https://www.rfc-editor.org/info/std99">STD 99</a>, RFC 9112, <a
                                            href="https://dx.doi.org/10.17487/RFC9112">DOI 10.17487/RFC9112</a>, June
                                        2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9112">https://www.rfc-editor.org/info/rfc9112</a>&gt;.
                                    </dd>
                                    <dt id="RFC9110">[<a href="#RFC9110" class="smpl">HTTP</a>]</dt>
                                    <dd>Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html">HTTP Semantics</a>”, <a
                                            href="https://www.rfc-editor.org/info/std97">STD 97</a>, RFC 9110, <a
                                            href="https://dx.doi.org/10.17487/RFC9110">DOI 10.17487/RFC9110</a>, June
                                        2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;.
                                    </dd>
                                    <dt id="POSIX">[<a href="#POSIX" class="smpl">POSIX.1</a>]</dt>
                                    <dd>IEEE, “<a href="https://pubs.opengroup.org/onlinepubs/9699919799/">The Open
                                            Group Base Specifications Issue 7, 2018 edition</a>”, 2018, &lt;<a
                                            href="https://pubs.opengroup.org/onlinepubs/9699919799/">https://pubs.opengroup.org/onlinepubs/9699919799/</a>&gt;.
                                    </dd>
                                    <dt id="RFC2104">[<a href="#RFC2104" class="smpl">RFC2104</a>]</dt>
                                    <dd>Krawczyk, H., Bellare, M., and R. Canetti, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc2104.html">HMAC: Keyed-Hashing for
                                            Message Authentication</a>”, RFC 2104, <a
                                            href="https://dx.doi.org/10.17487/RFC2104">DOI 10.17487/RFC2104</a>,
                                        February 1997, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;.
                                    </dd>
                                    <dt id="RFC2119">[<a href="#RFC2119" class="smpl">RFC2119</a>]</dt>
                                    <dd>Bradner, S., “<a href="https://www.rfc-editor.org/rfc/rfc2119.html">Key words
                                            for use in RFCs to Indicate Requirement Levels</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 2119, <a
                                            href="https://dx.doi.org/10.17487/RFC2119">DOI 10.17487/RFC2119</a>, March
                                        1997, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.
                                    </dd>
                                    <dt id="RFC6234">[<a href="#RFC6234" class="smpl">RFC6234</a>]</dt>
                                    <dd>Eastlake 3rd, D. and T. Hansen, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc6234.html">US Secure Hash Algorithms
                                            (SHA and SHA-based HMAC and HKDF)</a>”, RFC 6234, <a
                                            href="https://dx.doi.org/10.17487/RFC6234">DOI 10.17487/RFC6234</a>, May
                                        2011, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;.
                                    </dd>
                                    <dt id="RFC7517">[<a href="#RFC7517" class="smpl">RFC7517</a>]</dt>
                                    <dd>Jones, M., “<a href="https://www.rfc-editor.org/rfc/rfc7517.html">JSON Web Key
                                            (JWK)</a>”, RFC 7517, <a href="https://dx.doi.org/10.17487/RFC7517">DOI
                                            10.17487/RFC7517</a>, May 2015, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7517">https://www.rfc-editor.org/info/rfc7517</a>&gt;.
                                    </dd>
                                    <dt id="RFC7518">[<a href="#RFC7518" class="smpl">RFC7518</a>]</dt>
                                    <dd>Jones, M., “<a href="https://www.rfc-editor.org/rfc/rfc7518.html">JSON Web
                                            Algorithms (JWA)</a>”, RFC 7518, <a
                                            href="https://dx.doi.org/10.17487/RFC7518">DOI 10.17487/RFC7518</a>, May
                                        2015, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;.
                                    </dd>
                                    <dt id="RFC8017">[<a href="#RFC8017" class="smpl">RFC8017</a>]</dt>
                                    <dd>Moriarty, K., Ed., Kaliski, B., Jonsson, J., and A. Rusch, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8017.html">PKCS #1: RSA Cryptography
                                            Specifications Version 2.2</a>”, RFC 8017, <a
                                            href="https://dx.doi.org/10.17487/RFC8017">DOI 10.17487/RFC8017</a>,
                                        November 2016, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;.
                                    </dd>
                                    <dt id="RFC8032">[<a href="#RFC8032" class="smpl">RFC8032</a>]</dt>
                                    <dd>Josefsson, S. and I. Liusvaara, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8032.html">Edwards-Curve Digital
                                            Signature Algorithm (EdDSA)</a>”, RFC 8032, <a
                                            href="https://dx.doi.org/10.17487/RFC8032">DOI 10.17487/RFC8032</a>, January
                                        2017, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;.
                                    </dd>
                                    <dt id="RFC8174">[<a href="#RFC8174" class="smpl">RFC8174</a>]</dt>
                                    <dd>Leiba, B., “<a href="https://www.rfc-editor.org/rfc/rfc8174.html">Ambiguity of
                                            Uppercase vs Lowercase in RFC 2119 Key Words</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 8174, <a
                                            href="https://dx.doi.org/10.17487/RFC8174">DOI 10.17487/RFC8174</a>, May
                                        2017, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.
                                    </dd>
                                    <dt id="RFC8941">[<a href="#RFC8941" class="smpl">STRUCTURED-FIELDS</a>]</dt>
                                    <dd>Nottingham, M. and P-H. Kamp, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8941.html">Structured Field Values
                                            for HTTP</a>”, RFC 8941, <a href="https://dx.doi.org/10.17487/RFC8941">DOI
                                            10.17487/RFC8941</a>, February 2021, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8941">https://www.rfc-editor.org/info/rfc8941</a>&gt;.
                                    </dd>
                                    <dt id="RFC3986">[<a href="#RFC3986" class="smpl">URI</a>]</dt>
                                    <dd>Berners-Lee, T., Fielding, R., and L. Masinter, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc3986.html">Uniform Resource
                                            Identifier (URI): Generic Syntax</a>”, <a
                                            href="https://www.rfc-editor.org/info/std66">STD 66</a>, RFC 3986, <a
                                            href="https://dx.doi.org/10.17487/RFC3986">DOI 10.17487/RFC3986</a>, January
                                        2005, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;.
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section>
                            <div id="rfc.references.3">
                                <h3 id="rfc.section.9.2"><a href="#rfc.section.9.2">9.2.</a> 参考資料（Informative
                                    References）</h3>
                                <dl class="dl-horizontal">
                                    <dt id="AWS-SIGv4">[<a href="#AWS-SIGv4" class="smpl">AWS-SIGv4</a>]</dt>
                                    <dd>Amazon Simple Storage Service、「<a
                                            href="https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html">Authenticating
                                            Requests (AWS Signature Version 4)</a>」、2006年3月、&lt;<a
                                            href="https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html">https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html</a>&gt;。
                                    </dd>
                                    <dt id="BCP195">[BCP195]</dt>
                                    <dd id="RFC8996">Moriarty, K. and S. Farrell、「<a
                                            href="https://www.rfc-editor.org/rfc/rfc8996.html">Deprecating TLS 1.0 and
                                            TLS 1.1</a>」、<a href="https://www.rfc-editor.org/info/bcp195">BCP 195</a>、
                                        RFC 8996、<a href="https://dx.doi.org/10.17487/RFC8996">DOI
                                            10.17487/RFC8996</a>、2021年3月。</dd>
                                    <dd id="RFC9325">Sheffer, Y., Saint-Andre, P., and T. Fossati、「<a
                                            href="https://www.rfc-editor.org/rfc/rfc9325.html">Recommendations for
                                            Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer
                                            Security (DTLS)</a>」、<a href="https://www.rfc-editor.org/info/bcp195">BCP
                                            195</a>、RFC 9325、<a href="https://dx.doi.org/10.17487/RFC9325">DOI
                                            10.17487/RFC9325</a>、2022年11月。</dd>
                                    <dd>&lt;<a
                                            href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;
                                    </dd>
                                    <dt id="RFC9440">[<a href="#RFC9440" class="smpl">CLIENT-CERT</a>]</dt>
                                    <dd>Campbell, B. and M. Bishop、「<a
                                            href="https://www.rfc-editor.org/rfc/rfc9440.html">Client-Cert HTTP Header
                                            Field</a>」、RFC 9440、<a href="https://dx.doi.org/10.17487/RFC9440">DOI
                                            10.17487/RFC9440</a>、2023年7月、&lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9440">https://www.rfc-editor.org/info/rfc9440</a>&gt;。
                                    </dd>
                                    <dt id="RFC6265">[<a href="#RFC6265" class="smpl">COOKIE</a>]</dt>
                                    <dd>Barth, A.、「<a href="https://www.rfc-editor.org/rfc/rfc6265.html">HTTP State
                                            Management Mechanism</a>」、RFC 6265、<a
                                            href="https://dx.doi.org/10.17487/RFC6265">DOI
                                            10.17487/RFC6265</a>、2011年4月、&lt;<a
                                            href="https://www.rfc-editor.org/info/rfc6265">https://www.rfc-editor.org/info/rfc6265</a>&gt;。
                                    </dd>
                                    <dt id="RFC9530">[<a href="#RFC9530" class="smpl">DIGEST</a>]</dt>
                                    <dd>Polli, R. and L. Pardue、「<a
                                            href="https://www.rfc-editor.org/rfc/rfc9530.html">Digest Fields</a>」、RFC
                                        9530、<a href="https://dx.doi.org/10.17487/RFC9530">DOI 10.17487/RFC9530</a>、
                                        2024年2月、&lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9530">https://www.rfc-editor.org/info/rfc9530</a>&gt;。
                                    </dd>
                                    <dt id="JACKSON2019">[<a href="#JACKSON2019" class="smpl">JACKSON2019</a>]</dt>
                                    <dd>Jackson, D., Cremers, C., Cohn-Gordon, K., and R. Sasse、「<a
                                            href="https://dl.acm.org/doi/10.1145/3319535.3339813">Seems Legit: Automated
                                            Analysis of Subtle Attacks on Protocols that Use Signatures</a>」、<a
                                            href="https://dx.doi.org/10.1145/3319535.3339813">DOI
                                            10.1145/3319535.3339813</a>、CCS '19: Proceedings of the 2019 ACM SIGSAC
                                        Conference on Computer and Communications Security、pp. 2165-2180、2019年11月、&lt;<a
                                            href="https://dl.acm.org/doi/10.1145/3319535.3339813">https://dl.acm.org/doi/10.1145/3319535.3339813</a>&gt;。
                                    </dd>
                                    <dt id="RFC7515">[<a href="#RFC7515" class="smpl">JWS</a>]</dt>
                                    <dd>Jones, M., Bradley, J., and N. Sakimura、「<a
                                            href="https://www.rfc-editor.org/rfc/rfc7515.html">JSON Web Signature
                                            (JWS)</a>」、RFC 7515、<a href="https://dx.doi.org/10.17487/RFC7515">DOI
                                            10.17487/RFC7515</a>、2015年5月、&lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;。
                                    </dd>
                                    <dt id="RFC7239">[<a href="#RFC7239" class="smpl">RFC7239</a>]</dt>
                                    <dd>Petersson, A. and M. Nilsson、「<a
                                            href="https://www.rfc-editor.org/rfc/rfc7239.html">Forwarded HTTP
                                            Extension</a>」、RFC 7239、<a href="https://dx.doi.org/10.17487/RFC7239">DOI
                                            10.17487/RFC7239</a>、2014年6月、&lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7239">https://www.rfc-editor.org/info/rfc7239</a>&gt;。
                                    </dd>
                                    <dt id="RFC7468">[<a href="#RFC7468" class="smpl">RFC7468</a>]</dt>
                                    <dd>Josefsson, S. and S. Leonard、「<a
                                            href="https://www.rfc-editor.org/rfc/rfc7468.html">Textual Encodings of
                                            PKIX, PKCS, and CMS Structures</a>」、RFC 7468、<a
                                            href="https://dx.doi.org/10.17487/RFC7468">DOI
                                            10.17487/RFC7468</a>、2015年4月、&lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7468">https://www.rfc-editor.org/info/rfc7468</a>&gt;。
                                    </dd>
                                    <dt id="RFC7807">[<a href="#RFC7807" class="smpl">RFC7807</a>]</dt>
                                    <dd>Nottingham, M. and E. Wilde、「<a
                                            href="https://www.rfc-editor.org/rfc/rfc7807.html">Problem Details for HTTP
                                            APIs</a>」、RFC 7807、<a href="https://dx.doi.org/10.17487/RFC7807">DOI
                                            10.17487/RFC7807</a>、2016年3月、&lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7807">https://www.rfc-editor.org/info/rfc7807</a>&gt;。
                                    </dd>
                                    <dt id="RFC8126">[<a href="#RFC8126" class="smpl">RFC8126</a>]</dt>
                                    <dd>Cotton, M., Leiba, B., and T. Narten、「<a
                                            href="https://www.rfc-editor.org/rfc/rfc8126.html">Guidelines for Writing an
                                            IANA Considerations Section in RFCs</a>」、<a
                                            href="https://www.rfc-editor.org/info/bcp26">BCP 26</a>、RFC 8126、<a
                                            href="https://dx.doi.org/10.17487/RFC8126">DOI
                                            10.17487/RFC8126</a>、2017年6月、&lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;。
                                    </dd>
                                    <dt id="RFC8792">[<a href="#RFC8792" class="smpl">RFC8792</a>]</dt>
                                    <dd>Watsen, K., Auerswald, E., Farrel, A., and Q. Wu、「<a
                                            href="https://www.rfc-editor.org/rfc/rfc8792.html">Handling Long Lines in
                                            Content of Internet-Drafts and RFCs</a>」、RFC 8792、<a
                                            href="https://dx.doi.org/10.17487/RFC8792">DOI
                                            10.17487/RFC8792</a>、2020年6月、&lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8792">https://www.rfc-editor.org/info/rfc8792</a>&gt;。
                                    </dd>
                                    <dt id="RFC9457">[<a href="#RFC9457" class="smpl">RFC9457</a>]</dt>
                                    <dd>Nottingham, M., Wilde, E., and S. Dalal、「<a
                                            href="https://www.rfc-editor.org/rfc/rfc9457.html">Problem Details for HTTP
                                            APIs</a>」、RFC 9457、<a href="https://dx.doi.org/10.17487/RFC9457">DOI
                                            10.17487/RFC9457</a>、2023年7月、&lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9457">https://www.rfc-editor.org/info/rfc9457</a>&gt;。
                                    </dd>
                                    <dt id="I-D.cavage-http-signatures">[<a href="#I-D.cavage-http-signatures"
                                            class="smpl">SIGNING-HTTP-MESSAGES</a>]</dt>
                                    <dd>Cavage, M. and M. Sporny、「<a
                                            href="https://datatracker.ietf.org/doc/html/draft-cavage-http-signatures-12">Signing
                                            HTTP Messages</a>」、<a
                                            href="https://datatracker.ietf.org/doc/draft-cavage-http-signatures">作業中の文書</a>、draft-cavage-http-signatures-12、作業中の文書、2019年10月、&lt;<a
                                            href="https://datatracker.ietf.org/doc/html/draft-cavage-http-signatures-12">https://datatracker.ietf.org/doc/html/draft-cavage-http-signatures-12</a>&gt;。
                                    </dd>
                                    <dt id="SIGNING-HTTP-REQS-OAUTH">[<a href="#SIGNING-HTTP-REQS-OAUTH"
                                            class="smpl">SIGNING-HTTP-REQS-OAUTH</a>]</dt>
                                    <dd>Richer, J., Ed., Bradley, J., and H. Tschofenig、「<a
                                            href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-signed-http-request-03">A
                                            Method for Signing HTTP Requests for OAuth</a>」、<a
                                            href="https://datatracker.ietf.org/doc/draft-ietf-oauth-signed-http-request">作業中の文書</a>、draft-ietf-oauth-signed-http-request-03、作業中の文書、2016年8月、&lt;<a
                                            href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-signed-http-request-03">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-signed-http-request-03</a>&gt;。
                                    </dd>
                                    <dt id="RFC8446">[<a href="#RFC8446" class="smpl">TLS</a>]</dt>
                                    <dd>Rescorla, E.、「<a href="https://www.rfc-editor.org/rfc/rfc8446.html">The
                                            Transport Layer Security (TLS) Protocol Version 1.3</a>」、RFC 8446、<a
                                            href="https://dx.doi.org/10.17487/RFC8446">DOI
                                            10.17487/RFC8446</a>、2018年8月、&lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;。
                                    </dd>
                                </dl>
                            </div>
                        </section>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="detection">
                    <h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">Appendix A.</a>&nbsp;<a
                            href="#detection">HTTP メッセージ署名の検出</a></h2>
                    <div id="rfc.section.A.p.1">
                        <p>過去に非標準的な署名付き HTTP メッセージ（この仕様で使用される Signature
                            フィールドの他の定義を含む）を作ろうとする試みが多数ありました。本仕様や他の公開文書、あるいは過去のドラフト版をサポートしたい開発者は、互換性の問題が予期しない問題を引き起こす可能性があるため、慎重かつ意図的に対応することが推奨されます。
                        </p>
                    </div>
                    <div id="rfc.section.A.p.2">
                        <p>実装者はまずこの仕様で定義される Signature-Input
                            フィールドを検出・検証して、本ドキュメントで記述された仕組みが使用されているか、それとも代替の仕組みであるかを判別することを推奨します。Signature-Input
                            フィールドが存在する場合は、すべての Signature フィールドを解析し、本仕様の文脈で解釈できます。</p>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="examples">
                    <h2 id="rfc.section.B" class="np"><a href="#rfc.section.B">Appendix B.</a>&nbsp;<a
                            href="#examples">例（Examples）</a></h2>
                    <div id="rfc.section.B.p.1">
                        <p>以下の非規範的な例は、HTTP
                            メッセージ署名の実装をテストするために提供されます。示された署名付きメッセージは、記載されたパラメータで署名ベースを作成し、示されたアルゴリズムと鍵を使用して署名を生成するために使用できます。
                        </p>
                    </div>
                    <div id="rfc.section.B.p.2">
                        <p>示された秘密鍵は署名の生成に使用できますが、示されたアルゴリズムのいくつかは非決定論的であるため、署名の結果は例のバイト列と異なることが期待されます。公開鍵はすべての署名例の検証に使用できます。
                        </p>
                    </div>
                    <section id="example-keys">
                        <h3 id="rfc.section.B.1"><a href="#rfc.section.B.1">B.1.</a>&nbsp;<a
                                href="#example-keys">例示鍵（Example Keys）</a></h3>
                        <div id="rfc.section.B.1.p.1">
                            <p>この節では、文書内の例示署名で参照される暗号鍵を示します。これらの鍵はテスト以外の目的で使用してはなりません（<em class="bcp14">MUST NOT</em>）。
                            </p>
                        </div>
                        <div id="rfc.section.B.1.p.2">
                            <p>各鍵の鍵識別子は本仕様の例全体で使用されます。これらの例において、署名者と検証者はここで使用されるすべての鍵識別子を一意に参照でき、使用される鍵とアルゴリズムが署名が提示される文脈に適していることが前提とされています。
                            </p>
                        </div>
                        <div id="rfc.section.B.1.p.3" class="avoidbreakafter">
                            <p>各秘密鍵の構成要素は PEM 形式で示されます（<a href="#RFC7468"><cite
                                        title="Textual Encodings of PKIX, PKCS, and CMS Structures">[RFC7468]</cite></a>）。表示するには次の
                                OpenSSL コマンドを実行します：</p>
                        </div>
                        <div id="rfc.section.B.1.p.4">
                            <pre>
openssl pkey -text
</pre>
                        </div>
                        <div id="rfc.section.B.1.p.5">
                            <p>このコマンドは OpenSSL バージョン 1.1.1m
                                ですべての例示鍵でテストされました。いくつかのシステムではこれらの鍵を直接生成または使用できない場合があり、追加の処理が必要になることがあります。すべての鍵は JWK
                                形式でも利用可能です。</p>
                        </div>
                        <section id="example-key-rsa-test">
                            <h4 id="rfc.section.B.1.1"><a href="#rfc.section.B.1.1">B.1.1.</a>&nbsp;<a
                                    href="#example-key-rsa-test">RSA 例示鍵（Example RSA Key）</a></h4>
                            <div id="rfc.section.B.1.1.p.1">
                                <p>以下の鍵は 2048 ビットの RSA 公開鍵と秘密鍵のペアで、本書では <span class="tt">test-key-rsa</span>
                                    として参照されます。この鍵は PEM 形式でエンコードされ、暗号化されていません。</p>
                            </div>
                            <div id="rfc.section.B.1.1.p.2">
                                <pre>
-----BEGIN RSA PUBLIC KEY-----
MIIBCgKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsPBRrw
WEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsdJKFq
MGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75jfZg
kne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKIlE0P
uKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZSFlQ
PSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQAB
-----END RSA PUBLIC KEY-----

-----BEGIN RSA PRIVATE KEY-----
MIIEqAIBAAKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsP
BRrwWEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsd
JKFqMGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75
jfZgkne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKI
lE0PuKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZ
SFlQPSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQABAoIBAG/JZuSWdoVHbi56
vjgCgkjg3lkO1KrO3nrdm6nrgA9P9qaPjxuKoWaKO1cBQlE1pSWp/cKncYgD5WxE
CpAnRUXG2pG4zdkzCYzAh1i+c34L6oZoHsirK6oNcEnHveydfzJL5934egm6p8DW
+m1RQ70yUt4uRc0YSor+q1LGJvGQHReF0WmJBZHrhz5e63Pq7lE0gIwuBqL8SMaA
yRXtK+JGxZpImTq+NHvEWWCu09SCq0r838ceQI55SvzmTkwqtC+8AT2zFviMZkKR
Qo6SPsrqItxZWRty2izawTF0Bf5S2VAx7O+6t3wBsQ1sLptoSgX3QblELY5asI0J
YFz7LJECgYkAsqeUJmqXE3LP8tYoIjMIAKiTm9o6psPlc8CrLI9CH0UbuaA2JCOM
cCNq8SyYbTqgnWlB9ZfcAm/cFpA8tYci9m5vYK8HNxQr+8FS3Qo8N9RJ8d0U5Csw
DzMYfRghAfUGwmlWj5hp1pQzAuhwbOXFtxKHVsMPhz1IBtF9Y8jvgqgYHLbmyiu1
mwJ5AL0pYF0G7x81prlARURwHo0Yf52kEw1dxpx+JXER7hQRWQki5/NsUEtv+8RT
qn2m6qte5DXLyn83b1qRscSdnCCwKtKWUug5q2ZbwVOCJCtmRwmnP131lWRYfj67
B/xJ1ZA6X3GEf4sNReNAtaucPEelgR2nsN0gKQKBiGoqHWbK1qYvBxX2X3kbPDkv
9C+celgZd2PW7aGYLCHq7nPbmfDV0yHcWjOhXZ8jRMjmANVR/eLQ2EfsRLdW69bn
f3ZD7JS1fwGnO3exGmHO3HZG+6AvberKYVYNHahNFEw5TsAcQWDLRpkGybBcxqZo
81YCqlqidwfeO5YtlO7etx1xLyqa2NsCeG9A86UjG+aeNnXEIDk1PDK+EuiThIUa
/2IxKzJKWl1BKr2d4xAfR0ZnEYuRrbeDQYgTImOlfW6/GuYIxKYgEKCFHFqJATAG
IxHrq1PDOiSwXd2GmVVYyEmhZnbcp8CxaEMQoevxAta0ssMK3w6UsDtvUvYvF22m
qQKBiD5GwESzsFPy3Ga0MvZpn3D6EJQLgsnrtUPZx+z2Ep2x0xc5orneB5fGyF1P
WtP+fG5Q6Dpdz3LRfm+KwBCWFKQjg7uTxcjerhBWEYPmEMKYwTJF5PBG9/ddvHLQ
EQeNC8fHGg4UXU8mhHnSBt3EA10qQJfRDs15M38eG2cYwB1PZpDHScDnDA0=
-----END RSA PRIVATE KEY-----
</pre>
                            </div>
                            <div id="rfc.section.B.1.1.p.3" class="avoidbreakafter">
                                <p>同じ公開鍵と秘密鍵のペアの JWK 形式：</p>
                            </div>
                            <div id="rfc.section.B.1.1.p.4">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

{
  "kty": "RSA",
  "kid": "test-key-rsa",
  "p": "sqeUJmqXE3LP8tYoIjMIAKiTm9o6psPlc8CrLI9CH0UbuaA2JCOMcCNq8Sy\
  YbTqgnWlB9ZfcAm_cFpA8tYci9m5vYK8HNxQr-8FS3Qo8N9RJ8d0U5CswDzMYfRgh\
  AfUGwmlWj5hp1pQzAuhwbOXFtxKHVsMPhz1IBtF9Y8jvgqgYHLbmyiu1mw",
  "q": "vSlgXQbvHzWmuUBFRHAejRh_naQTDV3GnH4lcRHuFBFZCSLn82xQS2_7xFO\
  qfabqq17kNcvKfzdvWpGxxJ2cILAq0pZS6DmrZlvBU4IkK2ZHCac_XfWVZFh-PrsH\
  _EnVkDpfcYR_iw1F40C1q5w8R6WBHaew3SAp",
  "d": "b8lm5JZ2hUduLnq-OAKCSODeWQ7Uqs7eet2bqeuAD0_2po-PG4qhZoo7VwF\
  CUTWlJan9wqdxiAPlbEQKkCdFRcbakbjN2TMJjMCHWL5zfgvqhmgeyKsrqg1wSce9\
  7J1_Mkvn3fh6CbqnwNb6bVFDvTJS3i5FzRhKiv6rUsYm8ZAdF4XRaYkFkeuHPl7rc\
  -ruUTSAjC4GovxIxoDJFe0r4kbFmkiZOr40e8RZYK7T1IKrSvzfxx5AjnlK_OZOTC\
  q0L7wBPbMW-IxmQpFCjpI-yuoi3FlZG3LaLNrBMXQF_lLZUDHs77q3fAGxDWwum2h\
  KBfdBuUQtjlqwjQlgXPsskQ",
  "e": "AQAB",
  "qi": "PkbARLOwU_LcZrQy9mmfcPoQlAuCyeu1Q9nH7PYSnbHTFzmiud4Hl8bIXU\
  9a0_58blDoOl3PctF-b4rAEJYUpCODu5PFyN6uEFYRg-YQwpjBMkXk8Eb39128ctA\
  RB40Lx8caDhRdTyaEedIG3cQDXSpAl9EOzXkzfx4bZxjAHU9mkMdJwOcMDQ",
  "dp": "aiodZsrWpi8HFfZfeRs8OS_0L5x6WBl3Y9btoZgsIeruc9uZ8NXTIdxaM6\
  FdnyNEyOYA1VH94tDYR-xEt1br1ud_dkPslLV_Aac7d7EaYc7cdkb7oC9t6sphVg0\
  dqE0UTDlOwBxBYMtGmQbJsFzGpmjzVgKqWqJ3B947li2U7t63HXEvKprY2w",
  "dq": "b0DzpSMb5p42dcQgOTU8Mr4S6JOEhRr_YjErMkpaXUEqvZ3jEB9HRmcRi5\
  Gtt4NBiBMiY6V9br8a5gjEpiAQoIUcWokBMAYjEeurU8M6JLBd3YaZVVjISaFmdty\
  nwLFoQxCh6_EC1rSywwrfDpSwO29S9i8Xbaap",
  "n": "hAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsPBRrwWEBnez6\
  d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsdJKFqMGmXCQvE\
  G7YemcxDTRPxAleIAgYYRjTSd_QBwVW9OwNFhekro3RtlinV0a75jfZgkne_YiktS\
  vLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKIlE0PuKxI4T-HIa\
  Fpv8-rdV6eUgOrB2xeI1dSFFn_nnv5OoZJEIB-VmuKn3DCUcCZSFlQPSXSfBDiUGh\
  wOw76WuSSsf1D4b_vLoJ10w"
}
</pre>
                            </div>
                        </section>
                        <section id="example-key-rsa-pss-test">
                            <h4 id="rfc.section.B.1.2"><a href="#rfc.section.B.1.2">B.1.2.</a>&nbsp;<a
                                    href="#example-key-rsa-pss-test">RSA-PSS 例示鍵（Example RSA-PSS Key）</a></h4>
                            <div id="rfc.section.B.1.2.p.1">
                                <p>以下の鍵は 2048 ビットの RSA 公開鍵と秘密鍵のペアで、本書では <span class="tt">test-key-rsa-pss</span>
                                    として参照されます。この鍵は PKCS #8 で PEM 形式にエンコードされ、暗号化されていません。</p>
                            </div>
                            <div id="rfc.section.B.1.2.p.2">
                                <pre>
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAr4tmm3r20Wd/PbqvP1s2
+QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvMs8ct+Lh1GH45x28Rw3Ry53mm+
oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95AndTrifbIFPNU8PPMO7OyrFAHq
gDsznjPFmTOtCEcN2Z1FpWgchwuYLPL+Wokqltd11nqqzi+bJ9cvSKADYdUAAN5W
Utzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSyZYoA485mqcO0GVAdVw9lq4
aOT9v6d+nb4bnNkQVklLQ3fVAvJm+xdDOp9LCNCN48V2pnDOkFV6+U9nV5oyc6XI
2wIDAQAB
-----END PUBLIC KEY-----

-----BEGIN PRIVATE KEY-----
MIIEvgIBADALBgkqhkiG9w0BAQoEggSqMIIEpgIBAAKCAQEAr4tmm3r20Wd/Pbqv
P1s2+QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvMs8ct+Lh1GH45x28Rw3Ry5
3mm+oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95AndTrifbIFPNU8PPMO7Oyr
FAHqgDsznjPFmTOtCEcN2Z1FpWgchwuYLPL+Wokqltd11nqqzi+bJ9cvSKADYdUA
AN5WUtzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSyZYoA485mqcO0GVAdVw
9lq4aOT9v6d+nb4bnNkQVklLQ3fVAvJm+xdDOp9LCNCN48V2pnDOkFV6+U9nV5oy
c6XI2wIDAQABAoIBAQCUB8ip+kJiiZVKF8AqfB/aUP0jTAqOQewK1kKJ/iQCXBCq
pbo360gvdt05H5VZ/RDVkEgO2k73VSsbulqezKs8RFs2tEmU+JgTI9MeQJPWcP6X
aKy6LIYs0E2cWgp8GADgoBs8llBq0UhX0KffglIeek3n7Z6Gt4YFge2TAcW2WbN4
XfK7lupFyo6HHyWRiYHMMARQXLJeOSdTn5aMBP0PO4bQyk5ORxTUSeOciPJUFktQ
HkvGbym7KryEfwH8Tks0L7WhzyP60PL3xS9FNOJi9m+zztwYIXGDQuKM2GDsITeD
2mI2oHoPMyAD0wdI7BwSVW18p1h+jgfc4dlexKYRAoGBAOVfuiEiOchGghV5vn5N
RDNscAFnpHj1QgMr6/UG05RTgmcLfVsI1I4bSkbrIuVKviGGf7atlkROALOG/xRx
DLadgBEeNyHL5lz6ihQaFJLVQ0u3U4SB67J0YtVO3R6lXcIjBDHuY8SjYJ7Ci6Z6
vuDcoaEujnlrtUhaMxvSfcUJAoGBAMPsCHXte1uWNAqYad2WdLjPDlKtQJK1diCm
rqmB2g8QE99hDOHItjDBEdpyFBKOIP+NpVtM2KLhRajjcL9Ph8jrID6XUqikQuVi
4J9FV2m42jXMuioTT13idAILanYg8D3idvy/3isDVkON0X3UAVKrgMEne0hJpkPL
FYqgetvDAoGBAKLQ6JZMbSe0pPIJkSamQhsehgL5Rs51iX4m1z7+sYFAJfhvN3Q/
OGIHDRp6HjMUcxHpHw7U+S1TETxePwKLnLKj6hw8jnX2/nZRgWHzgVcY+sPsReRx
NJVf+Cfh6yOtznfX00p+JWOXdSY8glSSHJwRAMog+hFGW1AYdt7w80XBAoGBAImR
NUugqapgaEA8TrFxkJmngXYaAqpA0iYRA7kv3S4QavPBUGtFJHBNULzitydkNtVZ
3w6hgce0h9YThTo/nKc+OZDZbgfN9s7cQ75x0PQCAO4fx2P91Q+mDzDUVTeG30mE
t2m3S0dGe47JiJxifV9P3wNBNrZGSIF3mrORBVNDAoGBAI0QKn2Iv7Sgo4T/XjND
dl2kZTXqGAk8dOhpUiw/HdM3OGWbhHj2NdCzBliOmPyQtAr770GITWvbAI+IRYyF
S7Fnk6ZVVVHsxjtaHy1uJGFlaZzKR4AGNaUTOJMs6NadzCmGPAxNQQOCqoUjn4XR
rOjr9w349JooGXhOxbu8nOxX
-----END PRIVATE KEY-----
</pre>
                            </div>
                            <div id="rfc.section.B.1.2.p.3" class="avoidbreakafter">
                                <p>同じ公開鍵と秘密鍵のペアの JWK 形式：</p>
                            </div>
                            <div id="rfc.section.B.1.2.p.4">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

{
  "kty": "RSA",
  "kid": "test-key-rsa-pss",
  "p": "5V-6ISI5yEaCFXm-fk1EM2xwAWekePVCAyvr9QbTlFOCZwt9WwjUjhtKRus\
  i5Uq-IYZ_tq2WRE4As4b_FHEMtp2AER43IcvmXPqKFBoUktVDS7dThIHrsnRi1U7d\
  HqVdwiMEMe5jxKNgnsKLpnq-4NyhoS6OeWu1SFozG9J9xQk",
  "q": "w-wIde17W5Y0Cphp3ZZ0uM8OUq1AkrV2IKauqYHaDxAT32EM4ci2MMER2nI\
  UEo4g_42lW0zYouFFqONwv0-HyOsgPpdSqKRC5WLgn0VXabjaNcy6KhNPXeJ0Agtq\
  diDwPeJ2_L_eKwNWQ43RfdQBUquAwSd7SEmmQ8sViqB628M",
  "d": "lAfIqfpCYomVShfAKnwf2lD9I0wKjkHsCtZCif4kAlwQqqW6N-tIL3bdOR-\
  VWf0Q1ZBIDtpO91UrG7pansyrPERbNrRJlPiYEyPTHkCT1nD-l2isuiyGLNBNnFoK\
  fBgA4KAbPJZQatFIV9Cn34JSHnpN5-2ehreGBYHtkwHFtlmzeF3yu5bqRcqOhx8lk\
  YmBzDAEUFyyXjknU5-WjAT9DzuG0MpOTkcU1EnjnIjyVBZLUB5Lxm8puyq8hH8B_E\
  5LNC-1oc8j-tDy98UvRTTiYvZvs87cGCFxg0LijNhg7CE3g9piNqB6DzMgA9MHSOw\
  cElVtfKdYfo4H3OHZXsSmEQ",
  "e": "AQAB",
  "qi": "jRAqfYi_tKCjhP9eM0N2XaRlNeoYCTx06GlSLD8d0zc4ZZuEePY10LMGWI\
  6Y_JC0CvvvQYhNa9sAj4hFjIVLsWeTplVVUezGO1ofLW4kYWVpnMpHgAY1pRM4kyz\
  o1p3MKYY8DE1BA4KqhSOfhdGs6Ov3Dfj0migZeE7Fu7yc7Fc",
  "dp": "otDolkxtJ7Sk8gmRJqZCGx6GAvlGznWJfibXPv6xgUAl-G83dD84YgcNGn\
  oeMxRzEekfDtT5LVMRPF4_AoucsqPqHDyOdfb-dlGBYfOBVxj6w-xF5HE0lV_4J-H\
  rI63Od9fTSn4lY5d1JjyCVJIcnBEAyiD6EUZbUBh23vDzRcE",
  "dq": "iZE1S6CpqmBoQDxOsXGQmaeBdhoCqkDSJhEDuS_dLhBq88FQa0UkcE1QvO\
  K3J2Q21VnfDqGBx7SH1hOFOj-cpz45kNluB832ztxDvnHQ9AIA7h_HY_3VD6YPMNR\
  VN4bfSYS3abdLR0Z7jsmInGJ9X0_fA0E2tkZIgXeas5EFU0M",
  "n": "r4tmm3r20Wd_PbqvP1s2-QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvM\
  s8ct-Lh1GH45x28Rw3Ry53mm-oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95An\
  dTrifbIFPNU8PPMO7OyrFAHqgDsznjPFmTOtCEcN2Z1FpWgchwuYLPL-Wokqltd11\
  nqqzi-bJ9cvSKADYdUAAN5WUtzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSy\
  ZYoA485mqcO0GVAdVw9lq4aOT9v6d-nb4bnNkQVklLQ3fVAvJm-xdDOp9LCNCN48V\
  2pnDOkFV6-U9nV5oyc6XI2w"
}
</pre>
                            </div>
                        </section>
                        <section id="example-key-ecc-p256">
                            <h4 id="rfc.section.B.1.3"><a href="#rfc.section.B.1.3">B.1.3.</a>&nbsp;<a
                                    href="#example-key-ecc-p256">ECC P-256 例示鍵（Example ECC P-256 Test Key）</a></h4>
                            <div id="rfc.section.B.1.3.p.1">
                                <p>以下の鍵は曲線 P-256 に基づく公開鍵と秘密鍵のペアで、本書では <span class="tt">test-key-ecc-p256</span>
                                    として参照されます。この鍵は PEM 形式でエンコードされ、暗号化されていません。</p>
                            </div>
                            <div id="rfc.section.B.1.3.p.2">
                                <pre>
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqIVYZVLCrPZHGHjP17CTW0/+D9Lf
w0EkjqF7xB4FivAxzic30tMM4GF+hR6Dxh71Z50VGGdldkkDXZCnTNnoXQ==
-----END PUBLIC KEY-----

-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFKbhfNZfpDsW43+0+JjUr9K+bTeuxopu653+hBaXGA7oAoGCCqGSM49
AwEHoUQDQgAEqIVYZVLCrPZHGHjP17CTW0/+D9Lfw0EkjqF7xB4FivAxzic30tMM
4GF+hR6Dxh71Z50VGGdldkkDXZCnTNnoXQ==
-----END EC PRIVATE KEY-----
</pre>
                            </div>
                            <div id="rfc.section.B.1.3.p.3" class="avoidbreakafter">
                                <p>同じ公開鍵と秘密鍵のペアの JWK 形式：</p>
                            </div>
                            <div id="rfc.section.B.1.3.p.4">
                                <pre class="text">
{
  "kty": "EC",
  "crv": "P-256",
  "kid": "test-key-ecc-p256",
  "d": "UpuF81l-kOxbjf7T4mNSv0r5tN67Gim7rnf6EFpcYDs",
  "x": "qIVYZVLCrPZHGHjP17CTW0_-D9Lfw0EkjqF7xB4FivA",
  "y": "Mc4nN9LTDOBhfoUeg8Ye9WedFRhnZXZJA12Qp0zZ6F0"
}
</pre>
                            </div>
                        </section>
                        <section id="example-key-ed25519">
                            <h4 id="rfc.section.B.1.4"><a href="#rfc.section.B.1.4">B.1.4.</a>&nbsp;<a
                                    href="#example-key-ed25519">Ed25519 例示鍵（Example Ed25519 Test Key）</a></h4>
                            <div id="rfc.section.B.1.4.p.1">
                                <p>以下の鍵は Edwards 曲線 ed25519 に基づく鍵で、本書では <span class="tt">test-key-ed25519</span>
                                    として参照されます。この鍵は PKCS #8 で PEM 形式にエンコードされ、暗号化されていません。</p>
                            </div>
                            <div id="rfc.section.B.1.4.p.2">
                                <pre>
-----BEGIN PUBLIC KEY-----
MCowBQYDK2VwAyEAJrQLj5P/89iXES9+vFgrIy29clF9CC/oPPsw3c5D0bs=
-----END PUBLIC KEY-----

-----BEGIN PRIVATE KEY-----
MC4CAQAwBQYDK2VwBCIEIJ+DYvh6SEqVTm50DFtMDoQikTmiCqirVv9mWG9qfSnF
-----END PRIVATE KEY-----
</pre>
                            </div>
                            <div id="rfc.section.B.1.4.p.3" class="avoidbreakafter">
                                <p>同じ公開鍵と秘密鍵のペアの JWK 形式：</p>
                            </div>
                            <div id="rfc.section.B.1.4.p.4">
                                <pre class="text">
{
  "kty": "OKP",
  "crv": "Ed25519",
  "kid": "test-key-ed25519",
  "d": "n4Ni-HpISpVObnQMW0wOhCKROaIKqKtW_2ZYb2p9KcU",
  "x": "JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"
}
</pre>
                            </div>
                        </section>
                        <section id="example-shared-secret">
                            <h4 id="rfc.section.B.1.5"><a href="#rfc.section.B.1.5">B.1.5.</a>&nbsp;<a
                                    href="#example-shared-secret">共有シークレットの例（Example Shared Secret）</a></h4>
                            <div id="rfc.section.B.1.5.p.1" class="avoidbreakafter">
                                <p>以下の共有シークレットはランダムに生成された 64 バイトを Base64 エンコードしたもので、本書では <span
                                        class="tt">test-shared-secret</span> として参照されます：</p>
                            </div>
                            <div id="rfc.section.B.1.5.p.2">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

uzvJfB4u3N0Jy4T7NZ75MDVcr8zSTInedJtkgcu46YW4XByzNJjxBdtjUkdJPBt\
  bmHhIDi6pcl8jsasjlTMtDQ==
</pre>
                            </div>
                        </section>
                    </section>
                    <section id="test-cases">
                        <h3 id="rfc.section.B.2"><a href="#rfc.section.B.2">B.2.</a>&nbsp;<a
                                href="#test-cases">テストケース</a></h3>
                        <div id="rfc.section.B.2.p.1" class="avoidbreakafter">
                            <p>この節では、実装の正しさを検証するためのテストケースとして使用できる非規範的な例を示します。これらの例は以下の HTTP メッセージに基づいています：</p>
                        </div>
                        <div id="rfc.section.B.2.p.2" class="avoidbreakafter">
                            <p>リクエストについては、この <span class="tt">test-request</span> メッセージを使用します：</p>
                        </div>
                        <div id="rfc.section.B.2.p.3">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.B.2.p.4" class="avoidbreakafter">
                            <p>レスポンスについては、この <span class="tt">test-response</span> メッセージを使用します：</p>
                        </div>
                        <div id="rfc.section.B.2.p.5">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 200 OK
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Digest: sha-512=:mEWXIS7MaLRuGgxOBdODa3xqM1XdEvxoYhvlCFJ41Q\
  JgJc4GTsPp29l5oGX69wWdXymyU0rjJuahq4l5aGgfLQ==:
Content-Length: 23

{"message": "good dog"}
</pre>
                        </div>
                        <section id="minimal-signature-using-rsa-pss-sha512">
                            <h4 id="rfc.section.B.2.1"><a href="#rfc.section.B.2.1">B.2.1.</a>&nbsp;<a
                                    href="#minimal-signature-using-rsa-pss-sha512">rsa-pss-sha512 を使用した最小限の署名</a></h4>
                            <div id="rfc.section.B.2.1.p.1">
                                <p>この例は、<span class="tt">test-request</span> に対して <span class="tt">rsa-pss-sha512</span>
                                    アルゴリズムを用いた最小限の署名を示します。HTTP メッセージのいかなるコンポーネントもカバーしていませんが、署名者が提供した nonce
                                    とともに鍵の所持を示すタイムスタンプ付きの署名を提供します。</p>
                            </div>
                            <div id="rfc.section.B.2.1.p.2" class="avoidbreakafter">
                                <p>対応する署名ベースは次のとおりです：</p>
                            </div>
                            <div id="rfc.section.B.2.1.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"@signature-params": ();created=1618884473;keyid="test-key-rsa-pss"\
  ;nonce="b3k2pp5k7z-50gnwp.yemd"
</pre>
                            </div>
                            <div id="rfc.section.B.2.1.p.4" class="avoidbreakafter">
                                <p>これにより、署名ラベル <span class="tt">sig-b21</span> の下で次の Signature-Input および Signature
                                    ヘッダーフィールドがメッセージに追加されます：</p>
                            </div>
                            <div id="rfc.section.B.2.1.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b21=();created=1618884473\
  ;keyid="test-key-rsa-pss";nonce="b3k2pp5k7z-50gnwp.yemd"
Signature: sig-b21=:d2pmTvmbncD3xQm8E9ZV2828BjQWGgiwAaw5bAkgibUopem\
  LJcWDy/lkbbHAve4cRAtx31Iq786U7it++wgGxbtRxf8Udx7zFZsckzXaJMkA7ChG\
  52eSkFxykJeNqsrWH5S+oxNFlD4dzVuwe8DhTSja8xxbR/Z2cOGdCbzR72rgFWhzx\
  2VjBqJzsPLMIQKhO4DGezXehhWwE56YCE+O6c0mKZsfxVrogUvA4HELjVKWmAvtl6\
  UnCh8jYzuVG5WSb/QEVPnP5TmcAnLH1g+s++v6d4s8m0gCw1fV5/SITLq9mhho8K3\
  +7EPYTU8IU1bLhdxO5Nyt8C8ssinQ98Xw9Q==:
</pre>
                            </div>
                            <div id="rfc.section.B.2.1.p.6">
                                <p>カバーされたコンポーネントの一覧が空であるため、この署名は攻撃者によって無関係な HTTP
                                    メッセージに適用される可能性がある点に注意してください。この例では同一の署名が複数回リプレイされるのを防ぐために <span
                                        class="tt">nonce</span>
                                    パラメータが含まれていますが、攻撃者が署名を傍受して検証者への配信を妨げた場合、攻撃者はこの署名を別のメッセージに適用することができます。したがって、カバーされるコンポーネントの集合を空にすることは推奨されません。詳細は
                                    <a href="#security-coverage" title="Insufficient Coverage">セクション 7.2.1</a>
                                    を参照してください。
                                </p>
                            </div>
                            <div id="rfc.section.B.2.1.p.7">
                                <p>ここで使用されている RSA-PSS
                                    アルゴリズムは非決定論的であるため、アルゴリズムを実行するたびに異なる署名値が生成される点に注意してください。ここに示された署名値は与えられた鍵に対して検証可能ですが、新たに生成された署名値がこの例と一致することは期待されません。詳しくは
                                    <a href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">セクション 7.3.5</a> を参照してください。
                                </p>
                            </div>
                        </section>
                        <section id="selective-covered-components-using-rsa-pss-sha512">
                            <h4 id="rfc.section.B.2.2"><a href="#rfc.section.B.2.2">B.2.2.</a>&nbsp;<a
                                    href="#selective-covered-components-using-rsa-pss-sha512">rsa-pss-sha512
                                    を使用した選択的カバレッジ</a></h4>
                            <div id="rfc.section.B.2.2.p.1">
                                <p>この例では、<span class="tt">test-request</span> のいくつかの追加コンポーネント（オーソリティ、Content-Digest
                                    ヘッダーフィールド、および単一の名前付きクエリパラメータ）を <span class="tt">rsa-pss-sha512</span>
                                    アルゴリズムでカバーします。また、アプリケーション固有の値 <span class="tt">header-example</span> を持つ <span
                                        class="tt">tag</span> パラメータも追加しています。</p>
                            </div>
                            <div id="rfc.section.B.2.2.p.2" class="avoidbreakafter">
                                <p>対応する署名ベースは次のとおりです：</p>
                            </div>
                            <div id="rfc.section.B.2.2.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"@authority": example.com
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"@query-param";name="Pet": dog
"@signature-params": ("@authority" "content-digest" \
  "@query-param";name="Pet")\
  ;created=1618884473;keyid="test-key-rsa-pss"\
  ;tag="header-example"
</pre>
                            </div>
                            <div id="rfc.section.B.2.2.p.4" class="avoidbreakafter">
                                <p>これにより、署名ラベル <span class="tt">sig-b22</span> の下で次の Signature-Input および Signature
                                    ヘッダーフィールドがメッセージに追加されます：</p>
                            </div>
                            <div id="rfc.section.B.2.2.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b22=("@authority" "content-digest" \
  "@query-param";name="Pet");created=1618884473\
  ;keyid="test-key-rsa-pss";tag="header-example"
Signature: sig-b22=:LjbtqUbfmvjj5C5kr1Ugj4PmLYvx9wVjZvD9GsTT4F7GrcQ\
  EdJzgI9qHxICagShLRiLMlAJjtq6N4CDfKtjvuJyE5qH7KT8UCMkSowOB4+ECxCmT\
  8rtAmj/0PIXxi0A0nxKyB09RNrCQibbUjsLS/2YyFYXEu4TRJQzRw1rLEuEfY17SA\
  RYhpTlaqwZVtR8NV7+4UKkjqpcAoFqWFQh62s7Cl+H2fjBSpqfZUJcsIk4N6wiKYd\
  4je2U/lankenQ99PZfB4jY3I5rSV2DSBVkSFsURIjYErOs0tFTQosMTAoxk//0RoK\
  UqiYY8Bh0aaUEb0rQl3/XaVe4bXTugEjHSw==:
</pre>
                            </div>
                            <div id="rfc.section.B.2.2.p.6">
                                <p>ここで使用されている RSA-PSS
                                    アルゴリズムは非決定論的であるため、アルゴリズムを実行するたびに異なる署名値が生成される点に注意してください。ここに示された署名値は与えられた鍵に対して検証可能ですが、新たに生成された署名値がこの例と一致することは期待されません。詳しくは
                                    <a href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">セクション 7.3.5</a> を参照してください。
                                </p>
                            </div>
                        </section>
                        <section id="full-coverage-using-rsa-pss-sha512">
                            <h4 id="rfc.section.B.2.3"><a href="#rfc.section.B.2.3">B.2.3.</a>&nbsp;<a
                                    href="#full-coverage-using-rsa-pss-sha512">rsa-pss-sha512 を使用した完全カバレッジ</a>
                            </h4>
                            <div id="rfc.section.B.2.3.p.1">
                                <p>この例では、<span class="tt">test-request</span> の適用可能なすべてのメッセージコンポーネント（content-type と
                                    length を含む）および多くの導出コンポーネントをカバーします。ここでも <span class="tt">rsa-pss-sha512</span>
                                    アルゴリズムを使用しています。Host ヘッダーフィールドは含まれていません。代わりに <span class="tt">@authority</span>
                                    導出コンポーネントが含まれています。</p>
                            </div>
                            <div id="rfc.section.B.2.3.p.2" class="avoidbreakafter">
                                <p>対応する署名ベースは次のとおりです：</p>
                            </div>
                            <div id="rfc.section.B.2.3.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@method": POST
"@path": /foo
"@query": ?param=Value&amp;Pet=dog
"@authority": example.com
"content-type": application/json
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-length": 18
"@signature-params": ("date" "@method" "@path" "@query" \
  "@authority" "content-type" "content-digest" "content-length")\
  ;created=1618884473;keyid="test-key-rsa-pss"
</pre>
                            </div>
                            <div id="rfc.section.B.2.3.p.4" class="avoidbreakafter">
                                <p>これにより、署名ラベル <span class="tt">sig-b23</span> の下で次の Signature-Input および Signature
                                    ヘッダーフィールドがメッセージに追加されます：</p>
                            </div>
                            <div id="rfc.section.B.2.3.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b23=("date" "@method" "@path" "@query" \
  "@authority" "content-type" "content-digest" "content-length")\
  ;created=1618884473;keyid="test-key-rsa-pss"
Signature: sig-b23=:bbN8oArOxYoyylQQUU6QYwrTuaxLwjAC9fbY2F6SVWvh0yB\
  iMIRGOnMYwZ/5MR6fb0Kh1rIRASVxFkeGt683+qRpRRU5p2voTp768ZrCUb38K0fU\
  xN0O0iC59DzYx8DFll5GmydPxSmme9v6ULbMFkl+V5B1TP/yPViV7KsLNmvKiLJH1\
  pFkh/aYA2HXXZzNBXmIkoQoLd7YfW91kE9o/CCoC1xMy7JA1ipwvKvfrs65ldmlu9\
  bpG6A9BmzhuzF8Eim5f8ui9eH8LZH896+QIF61ka39VBrohr9iyMUJpvRX2Zbhl5Z\
  JzSRxpJyoEZAFL2FUo5fTIztsDZKEgM4cUA==:
</pre>
                            </div>
                            <div id="rfc.section.B.2.3.p.6">
                                <p>この例では、Date ヘッダーフィールドの値と署名パラメータ <span class="tt">created</span>
                                    の値は一致する必要がないことに注意してください。これは、Date ヘッダーフィールドが HTTP メッセージを作成する際に追加され、<span
                                        class="tt">created</span>
                                    パラメータはそのメッセージ上に署名を作成する際に設定されるためで、両者の時刻が異なる可能性があるためです。Date
                                    ヘッダーフィールドが署名でカバーされている場合、その値が <span class="tt">created</span>
                                    パラメータと一致しなければならないかどうかは検証者の判断に委ねられます。詳しくは <a href="#security-not-fields"
                                        title="Choosing Signature Parameters and Derived Components over HTTP Fields">セクション
                                        7.2.4</a> を参照してください。</p>
                            </div>
                            <div id="rfc.section.B.2.3.p.7">
                                <p>ここで使用されている RSA-PSS
                                    アルゴリズムは非決定論的であるため、アルゴリズムを実行するたびに異なる署名値が生成される点に注意してください。ここに示された署名値は与えられた鍵に対して検証可能ですが、新たに生成された署名値がこの例と一致することは期待されません。詳しくは
                                    <a href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">セクション 7.3.5</a> を参照してください。
                                </p>
                            </div>
                        </section>
                        <section id="signing-a-response-using-ecdsa-p256-sha256">
                            <h4 id="rfc.section.B.2.4"><a href="#rfc.section.B.2.4">B.2.4.</a>&nbsp;<a
                                    href="#signing-a-response-using-ecdsa-p256-sha256">ecdsa-p256-sha256
                                    を使用したレスポンスの署名</a></h4>
                            <div id="rfc.section.B.2.4.p.1">
                                <p>この例では、<span class="tt">test-response</span> の一部を <span
                                        class="tt">ecdsa-p256-sha256</span> アルゴリズムと鍵 <span
                                        class="tt">test-key-ecc-p256</span> を用いてカバーします。</p>
                            </div>
                            <div id="rfc.section.B.2.4.p.2" class="avoidbreakafter">
                                <p>対応する署名ベースは次のとおりです：</p>
                            </div>
                            <div id="rfc.section.B.2.4.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"@status": 200
"content-type": application/json
"content-digest": sha-512=:mEWXIS7MaLRuGgxOBdODa3xqM1XdEvxoYhvlCFJ4\
  1QJgJc4GTsPp29l5oGX69wWdXymyU0rjJuahq4l5aGgfLQ==:
"content-length": 23
"@signature-params": ("@status" "content-type" "content-digest" \
  "content-length");created=1618884473;keyid="test-key-ecc-p256"
</pre>
                            </div>
                            <div id="rfc.section.B.2.4.p.4" class="avoidbreakafter">
                                <p>これにより、署名ラベル <span class="tt">sig-b24</span> の下で次の Signature-Input および Signature
                                    ヘッダーフィールドがメッセージに追加されます：</p>
                            </div>
                            <div id="rfc.section.B.2.4.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b24=("@status" "content-type" \
  "content-digest" "content-length");created=1618884473\
  ;keyid="test-key-ecc-p256"
Signature: sig-b24=:wNmSUAhwb5LxtOtOpNa6W5xj067m5hFrj0XQ4fvpaCLx0NK\
  ocgPquLgyahnzDnDAUy5eCdlYUEkLIj+32oiasw==:
</pre>
                            </div>
                            <div id="rfc.section.B.2.4.p.6">
                                <p>ここで使用されている ECDSA
                                    署名アルゴリズムは非決定論的であるため、アルゴリズムを実行するたびに異なる署名値が生成される点に注意してください。ここに示された署名値は与えられた鍵に対して検証可能ですが、新たに生成された署名値がこの例と一致することは期待されません。詳しくは
                                    <a href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">セクション 7.3.5</a> を参照してください。
                                </p>
                            </div>
                        </section>
                        <section id="signing-a-request-using-hmac-sha256">
                            <h4 id="rfc.section.B.2.5"><a href="#rfc.section.B.2.5">B.2.5.</a>&nbsp;<a
                                    href="#signing-a-request-using-hmac-sha256">hmac-sha256 を使用したリクエストの署名</a>
                            </h4>
                            <div id="rfc.section.B.2.5.p.1">
                                <p>この例では、<span class="tt">test-request</span> の一部を <span class="tt">hmac-sha256</span>
                                    アルゴリズムと共有シークレット <span class="tt">test-shared-secret</span> を用いてカバーします。</p>
                            </div>
                            <div id="rfc.section.B.2.5.p.2" class="avoidbreakafter">
                                <p>対応する署名ベースは次のとおりです：</p>
                            </div>
                            <div id="rfc.section.B.2.5.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@authority": example.com
"content-type": application/json
"@signature-params": ("date" "@authority" "content-type")\
  ;created=1618884473;keyid="test-shared-secret"
</pre>
                            </div>
                            <div id="rfc.section.B.2.5.p.4" class="avoidbreakafter">
                                <p>これにより、署名ラベル <span class="tt">sig-b25</span> の下で次の Signature-Input および Signature
                                    ヘッダーフィールドがメッセージに追加されます：</p>
                            </div>
                            <div id="rfc.section.B.2.5.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b25=("date" "@authority" "content-type")\
  ;created=1618884473;keyid="test-shared-secret"
Signature: sig-b25=:pxcQw6G3AjtMBQjwo8XzkZf/bws5LelbaMk5rGIGtE8=:
</pre>
                            </div>
                            <div id="rfc.section.B.2.5.p.6">
                                <p>対称署名を実運用で使用する前に、セキュリティトレードオフに関する議論（<a href="#security-symmetric"
                                        title="Symmetric Cryptography">セクション 7.3.3</a>）を参照してください。</p>
                            </div>
                        </section>
                        <section id="signing-a-request-using-ed25519">
                            <h4 id="rfc.section.B.2.6"><a href="#rfc.section.B.2.6">B.2.6.</a>&nbsp;<a
                                    href="#signing-a-request-using-ed25519">ed25519 を使用したリクエストの署名</a></h4>
                            <div id="rfc.section.B.2.6.p.1">
                                <p>この例では、<span class="tt">test-request</span> の一部を <span class="tt">Ed25519</span>
                                    アルゴリズムと鍵 <span class="tt">test-key-ed25519</span> を用いてカバーします。</p>
                            </div>
                            <div id="rfc.section.B.2.6.p.2" class="avoidbreakafter">
                                <p>対応する署名ベースは次のとおりです：</p>
                            </div>
                            <div id="rfc.section.B.2.6.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@method": POST
"@path": /foo
"@authority": example.com
"content-type": application/json
"content-length": 18
"@signature-params": ("date" "@method" "@path" "@authority" \
  "content-type" "content-length");created=1618884473\
  ;keyid="test-key-ed25519"
</pre>
                            </div>
                            <div id="rfc.section.B.2.6.p.4" class="avoidbreakafter">
                                <p>これにより、署名ラベル <span class="tt">sig-b26</span> の下で次の Signature-Input および Signature
                                    ヘッダーフィールドがメッセージに追加されます：</p>
                            </div>
                            <div id="rfc.section.B.2.6.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b26=("date" "@method" "@path" "@authority" \
  "content-type" "content-length");created=1618884473\
  ;keyid="test-key-ed25519"
Signature: sig-b26=:wqcAqbmYJ2ji2glfAMaRy4gruYYnx2nEFN2HN6jrnDnQCK1\
  u02Gb04v9EDgwUPiu4A0w6vuQv5lIp5WPpBKRCw==:
</pre>
                            </div>
                        </section>
                    </section>
                    <section id="tls-terminating-proxies">
                        <h3 id="rfc.section.B.3"><a href="#rfc.section.B.3">B.3.</a>&nbsp;<a
                                href="#tls-terminating-proxies">TLS 終端プロキシ</a></h3>
                        <div id="rfc.section.B.3.p.1">
                            <p>この例では、リソースの前に TLS 終端を持つリバースプロキシが存在します。クライアントはリクエストに署名せず、代わりに相互 TLS を使って呼び出します。終端プロキシは TLS
                                ストリームを検証し、<a href="#RFC9440"><cite
                                        title="Client-Cert HTTP Header Field">[CLIENT-CERT]</cite></a> に従って Client-Cert
                                ヘッダーフィールドを注入し、その後このフィールドに署名を適用します。このヘッダーフィールドに署名することで、リバースプロキシは初期リクエストの TLS
                                パラメータを自ら検証したことを示すだけでなく、クライアントの動作とは独立してバックエンドシステムに対して自身を認証することができます。</p>
                        </div>
                        <div id="rfc.section.B.3.p.2" class="avoidbreakafter">
                            <p>クライアントは相互 TLS を用いて TLS 終端プロキシに次のリクエストを行います：</p>
                        </div>
                        <div id="rfc.section.B.3.p.3">
                            <pre class="text">
POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.B.3.p.4" class="avoidbreakafter">
                            <p>プロキシは TLS 接続を処理し、クライアントの TLS 証明書を Client-Cert ヘッダーフィールドに抽出して、service.internal.example
                                にホストされている内部サービスに渡します。これにより次のような署名されていないリクエストが生成されます：</p>
                        </div>
                        <div id="rfc.section.B.3.p.5">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: service.internal.example
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Client-Cert: :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKD\
  BJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQT\
  AeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFk\
  wEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmck\
  C8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDV\
  R0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf\
  8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV\
  4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6\
  bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.B.3.p.6" class="avoidbreakafter">
                            <p>署名がない場合、内部サービスは受信接続が正しい情報を持っていると信頼する必要があります。Client-Cert
                                ヘッダーフィールドや内部リクエストの他の部分に署名することで、内部サービスは信頼されたプロキシがリクエストを正しく処理し、正しいサービスに提示したことを確認できます。プロキシの署名ベースは次のとおりです：
                            </p>
                        </div>
                        <div id="rfc.section.B.3.p.7">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

"@path": /foo
"@query": ?param=Value&amp;Pet=dog
"@method": POST
"@authority": service.internal.example
"client-cert": :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQ\
  KDBJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBD\
  QTAeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDM\
  FkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXm\
  ckC8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQY\
  DVR0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8B\
  Af8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQ\
  GV4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0\
  Q6bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:
"@signature-params": ("@path" "@query" "@method" "@authority" \
  "client-cert");created=1618884473;keyid="test-key-ecc-p256"
</pre>
                        </div>
                        <div id="rfc.section.B.3.p.8" class="avoidbreakafter">
                            <p>これにより、次の署名が生成されます：</p>
                        </div>
                        <div id="rfc.section.B.3.p.9">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

xVMHVpawaAC/0SbHrKRs9i8I3eOs5RtTMGCWXm/9nvZzoHsIg6Mce9315T6xoklyy0y\
zhD9ah4JHRwMLOgmizw==
</pre>
                        </div>
                        <div id="rfc.section.B.3.p.10" class="avoidbreakafter">
                            <p>これにより、プロキシから内部サービスに送信される署名付きリクエストが生成され、プロキシの署名はラベル <span class="tt">ttrp</span> の下に含まれます：
                            </p>
                        </div>
                        <div id="rfc.section.B.3.p.11">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: service.internal.example
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Client-Cert: :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKD\
  BJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQT\
  AeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFk\
  wEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmck\
  C8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDV\
  R0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf\
  8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV\
  4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6\
  bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:
Signature-Input: ttrp=("@path" "@query" "@method" "@authority" \
  "client-cert");created=1618884473;keyid="test-key-ecc-p256"
Signature: ttrp=:xVMHVpawaAC/0SbHrKRs9i8I3eOs5RtTMGCWXm/9nvZzoHsIg6\
  Mce9315T6xoklyy0yzhD9ah4JHRwMLOgmizw==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.B.3.p.12">
                            <p>内部サービスはプロキシの署名を検証できるため、クライアントの証明書が適切に処理されたことを信頼できます。</p>
                        </div>
                    </section>
                    <section id="example-transform">
                        <h3 id="rfc.section.B.4"><a href="#rfc.section.B.4">B.4.</a>&nbsp;<a
                                href="#example-transform">HTTP メッセージの変換例</a></h3>
                        <div id="rfc.section.B.4.p.1">
                            <p>HTTP は仲介者やアプリケーションがメッセージの意味を変えずに HTTP メッセージを変換することを許容します。HTTP
                                メッセージ署名は、さまざまな状況でこれらの変換に対して堅牢になるよう設計されています。</p>
                        </div>
                        <div id="rfc.section.B.4.p.2" class="avoidbreakafter">
                            <p>例えば、次の HTTP リクエストメッセージは <span class="tt">Ed25519</span> アルゴリズムと鍵 <span
                                    class="tt">test-key-ed25519</span> を用いて署名されています：</p>
                        </div>
                        <div id="rfc.section.B.4.p.3">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.org
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: application/json
Accept: */*
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.4" class="avoidbreakafter">
                            <p>このメッセージの署名ベース文字列は次のとおりです：</p>
                        </div>
                        <div id="rfc.section.B.4.p.5">
                            <pre>
"@method": GET
"@path": /demo
"@authority": example.org
"accept": application/json, */*
"@signature-params": ("@method" "@path" "@authority" "accept")\
  ;created=1618884473;keyid="test-key-ed25519"
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.6" class="avoidbreakafter">
                            <p>次のメッセージは Accept-Language ヘッダーフィールドの追加およびクエリパラメータの追加によって変更されています。しかし、Accept-Language
                                ヘッダーフィールドもクエリも署名でカバーされていないため、同じ署名は依然として有効です：</p>
                        </div>
                        <div id="rfc.section.B.4.p.7">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2&amp;param=added HTTP/1.1
Host: example.org
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: application/json
Accept: */*
Accept-Language: en-US,en;q=0.5
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.8" class="avoidbreakafter">
                            <p>次のメッセージは Date ヘッダーフィールドを削除し、Referer ヘッダーフィールドを追加し、Accept ヘッダーフィールドを単一行に折り畳んでいます。Date と
                                Referer のヘッダーフィールドは署名でカバーされておらず、Accept ヘッダーフィールドの折り畳みは HTTP
                                フィールド値の正規化アルゴリズムで既に考慮されている許容される変換です。したがって、同じ署名は依然として有効です：</p>
                        </div>
                        <div id="rfc.section.B.4.p.9">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.org
Referer: https://developer.example.org/demo
Accept: application/json, */*
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.10" class="avoidbreakafter">
                            <p>次のメッセージは元のメッセージのフィールド値の順序を入れ替えています（個々の Accept ヘッダーフィールドの順序は変えていません）。同じ署名は依然として有効です：</p>
                        </div>
                        <div id="rfc.section.B.4.p.11">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Accept: application/json
Accept: */*
Date: Fri, 15 Jul 2022 14:24:55 GMT
Host: example.org
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.12" class="avoidbreakafter">
                            <p>次のメッセージはメソッドを POST に変更し、オーソリティを "example.com"（Host
                                ヘッダ内）に変更しています。メソッドとオーソリティの両方が署名でカバーされているため、同じ署名はもはや有効ではありません：</p>
                        </div>
                        <div id="rfc.section.B.4.p.13">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.com
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: application/json
Accept: */*
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.14" class="avoidbreakafter">
                            <p>次のメッセージは Accept ヘッダーフィールドの 2 つのインスタンスの順序を入れ替えています。同じ名前のフィールドの順序は HTTP
                                において意味を持つため、署名ベースで使用される値が変わり、同じ署名はもはや有効ではありません：</p>
                        </div>
                        <div id="rfc.section.B.4.p.15">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.org
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: */*
Accept: application/json
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="acknowledgements">
                    <h2 id="rfc.section.unnumbered-4" class="np"><a href="#acknowledgements">謝辞</a></h2>
                    <div id="rfc.section.unnumbered-4.p.1">
                        <p>本仕様は当初 <a href="#I-D.cavage-http-signatures"><cite
                                    title="Signing HTTP Messages">[SIGNING-HTTP-MESSAGES]</cite></a> に基づいています。編集者は、その
                            Internet-Draft の著者である Mark Cavage および Manu Sporny に対して、その作業および継続的な貢献に感謝します。本仕様には <a
                                href="#SIGNING-HTTP-REQS-OAUTH"><cite
                                    title="A Method for Signing HTTP Requests for OAuth">[SIGNING-HTTP-REQS-OAUTH]</cite></a>
                            およびその他類似の取り組みからの寄与も含まれます。</p>
                    </div>
                    <div id="rfc.section.unnumbered-4.p.2">
                        <p>編集者はまた、次の個人（アルファベット順に記載）に対して、フィードバック、洞察、および本書およびその前身の実装に関する貢献について感謝します：Mark Adamcin、Mark
                            Allen、Paul Annesley、Karl Böhlmark、Stéphane Bortzmeyer、Sarven Capadisli、Liam Dennehy、Stephen
                            Farrell、Phillip Hallam-Baker、Tyler Ham、Eric Holmes、Andrey Kislyuk、Adam Knight、Dave
                            Lehn、Ilari Liusvaara、Dave Longley、James H. Manger、Kathleen Moriarty、Yoav Nir、Mark
                            Nottingham、Adrian Palmer、Lucas Pardue、Roberto Polli、Julian Reschke、Michael
                            Richardson、Wojciech Rygielski、Rich Salz、Adam Scarr、Cory J. Slep、Dirk Stein、Henry
                            Story、Lukasz Szewc、Chris Webber、および Jeffrey Yasskin。</p>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="rfc.authors" class="np">
                    <h2><a href="#rfc.authors">著者の連絡先</a></h2>
                    <address><b>Annabelle Backman</b> (編集者)<br>Amazon<br>P.O. Box 81226<br>Seattle, WA
                        98108-1226<br>アメリカ合衆国<br>電子メール: <a
                            href="mailto:richanna@amazon.com">richanna@amazon.com</a><br>URI: <a
                            href="https://www.amazon.com/">https://www.amazon.com/</a></address>
                    <address><b>Justin Richer</b> (編集者)<br>Bespoke Engineering<br>電子メール: <a
                            href="mailto:ietf@justin.richer.org">ietf@justin.richer.org</a><br>URI: <a
                            href="https://bspk.io/">https://bspk.io/</a></address>
                    <address><b>Manu Sporny</b><br>Digital Bazaar<br>203 Roanoke Street W.<br>Blacksburg, VA
                        24060<br>アメリカ合衆国<br>電子メール: <a
                            href="mailto:msporny@digitalbazaar.com">msporny@digitalbazaar.com</a></address>
                </section>
            </div>
        </div>
    </div>
    <script src="https://httpwg.org/assets/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="https://httpwg.org/assets/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="https://htmlspecs.com/dropdown.js"></script>
</body>

</html>