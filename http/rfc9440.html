<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="ja-JP">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>RFC 9440 - Client-Cert HTTP ヘッダーフィールド</title>
    <script>
        function getMeta(rfcno, container) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://www.rfc-editor.org/rfc/rfc" + rfcno + ".json", true);
            xhr.onload = function (e) {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        var data = JSON.parse(xhr.response);

                        var cont = document.getElementById(container);
                        // empty the container
                        while (cont.firstChild) {
                            cont.removeChild(myNode.firstChild);
                        }

                        var c = data.status;
                        if (c) {
                            var bld = newElementWithText("b", c);
                            cont.appendChild(bld);
                        } else {
                            cont.appendChild(newElementWithText("i", "(document status unknown)"));
                        }

                        c = data.updated_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Updated by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.obsoleted_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Obsoleted by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.errata_url;
                        if (c) {
                            cont.appendChild(newElement("br"));
                            var link = newElementWithText("a", "errata");
                            link.setAttribute("href", c);
                            var errata = newElementWithText("i", "This document has ");
                            errata.appendChild(link);
                            errata.appendChild(newText("."));
                            cont.appendChild(errata);
                        }

                        cont.style.display = "block";
                    } else {
                        console.error(xhr.statusText);
                    }
                }
            };
            xhr.onerror = function (e) {
                console.error(xhr.status + " " + xhr.statusText);
            };
            xhr.send(null);
        }
        function appendRfcLinks(parent, updates) {
            var template = "https://www.rfc-editor.org/rfc/rfc{rfc}.html";
            for (var i = 0; i < updates.length; i++) {
                var rfc = updates[i].trim().toLowerCase();
                if (rfc.substring(0, 3) == "rfc") {
                    var no = parseInt(rfc.substring(3), 10);

                    var link = newElement("a");
                    link.setAttribute("href", template.replace("{rfc}", no));
                    link.appendChild(newText(no));
                    parent.appendChild(link);
                } else {
                    parent.appendChild(newText(rfc));
                }
                if (i != updates.length - 1) {
                    parent.appendChild(newText(", "));
                }
            }
        }

        // DOM helpers
        function newElement(name) {
            return document.createElement(name);
        }
        function newElementWithText(name, txt) {
            var e = document.createElement(name);
            e.appendChild(newText(txt));
            return e;
        }
        function newText(text) {
            return document.createTextNode(text);
        }
    </script>
    <script>
        function anchorRewrite() {
            map = {};
            if (window.location.hash.length >= 1) {
                var fragid = window.location.hash.substr(1);
                if (fragid) {
                    if (!document.getElementById(fragid)) {
                        var prefix = "rfc.";
                        var mapped = map[fragid];
                        if (mapped) {
                            window.location.hash = mapped;
                        } else if (fragid.indexOf("section-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(8).replace("-", ".p.");
                        } else if (fragid.indexOf("appendix-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(9).replace("-", ".p.");
                        } else if (fragid.indexOf("s-") == 0) {
                            var postfix = fragid.substring(2);
                            if (postfix.startsWith("abstract")) {
                                window.location.hash = prefix + postfix;
                            } else if (postfix.startsWith("note-")) {
                                window.location.hash = prefix + "note." + postfix.substring(5).replace("-", ".p.");
                            } else {
                                window.location.hash = prefix + "section." + postfix.replace("-", ".p.");
                            }
                        } else if (fragid.indexOf("p-") == 0) {
                            var r = fragid.substring(2);
                            var p = r.indexOf("-");
                            if (p >= 0) {
                                window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
                            }
                        }
                    }
                }
            }
        }
        window.addEventListener('hashchange', anchorRewrite);
        window.addEventListener('DOMContentLoaded', anchorRewrite);
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:type" content="article">
    <meta property="og:title" content="RFC9440">
    <meta property="og:description" content="Client-Cert HTTP Header Field">
    <meta property="og:url" content="https://httpwg.org/specs/rfc9440.html">
    <meta property="og:site_name" content="IETF HTTP Working Group Specifications">
    <meta property="og:image" content="https://httpwg.org/assets/favicon/apple-icon-180x180.png">
    <link rel="stylesheet" type="text/css"
        href="https://httpwg.org/assets/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <style type="text/css">
        body {
            padding-top: 80px;
            padding-bottom: 80px;
            position: relative;
        }

        .table.header th,
        .table.header td {
            border-top: none;
            padding: 0;
        }

        #sidebar {
            margin-top: -10px;
            height: 90%;
            overflow-y: auto;
            font-size: 90%;
        }

        #rfc\.meta {
            width: 40%;
            float: right
        }

        .toc ul {
            list-style: none;
        }

        .filename {
            color: rgb(119, 119, 119);
            font-size: 23px;
            font-weight: normal;
            height: auto;
            line-height: 23px;
        }

        dl {
            margin-left: 1em;
        }

        dl.dl-horizontal {
            margin-left: 0;
        }

        dl>dt {
            float: left;
            margin-right: 1em;
        }

        dl.nohang>dt {
            float: none;
        }

        dl>dd {
            margin-bottom: .5em;
        }

        dl.compact>dd {
            margin-bottom: 0em;
        }

        dl>dd>dl {
            margin-top: 0.5em;
            margin-bottom: 0em;
        }

        ul.empty {
            list-style-type: none;
        }

        ul.empty li {
            margin-top: .5em;
        }

        td.reference {
            padding-right: 1em;
            vertical-align: top;
        }

        .feedback {
            position: fixed;
            bottom: 5px;
            right: 5px;
        }

        .fbbutton {
            margin-left: 5px;
        }

        h1 a,
        h2 a,
        h3 a,
        h4 a,
        h5 a,
        h6 a {
            color: rgb(51, 51, 51);
        }

        span.tt {
            font: 11pt consolas, monospace;
            font-size-adjust: none;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="https://httpwg.org/assets/site.css">
    <link rel="Contents" href="#rfc.toc">
    <link rel="Author" href="#rfc.authors">
    <link rel="License" href="#rfc.copyrightnotice">
    <link rel="Chapter" title="1 Introduction" href="#rfc.section.1">
    <link rel="Chapter" title="2 HTTP Header Fields and Processing Rules" href="#rfc.section.2">
    <link rel="Chapter" title="3 Deployment Considerations" href="#rfc.section.3">
    <link rel="Chapter" title="4 Security Considerations" href="#rfc.section.4">
    <link rel="Chapter" title="5 IANA Considerations" href="#rfc.section.5">
    <link rel="Chapter" title="6 References" href="#rfc.section.6">
    <link rel="Appendix" title="A Example" href="#rfc.section.A">
    <link rel="Appendix" title="B Select Design Considerations" href="#rfc.section.B">
    <link rel="Appendix" title="Acknowledgements" href="#rfc.section.unnumbered-4">
    <link href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-client-cert-field-06" rel="prev">
    <link href="https://dx.doi.org/10.17487/rfc9440" rel="alternate">
    <link href="urn:issn:2070-1721" rel="alternate">
    <link rel="Alternate" title="Plain Text Version" href="http://www.ietf.org/rfc/rfc9440.txt">
    <link rel="Help" title="RFC-Editor's Status Page" href="https://www.rfc-editor.org/info/rfc9440">
    <meta name="viewport" content="initial-scale=1">
    <meta name="generator"
        content="https://github.com/mnot/RFCBootstrap XSLT vendor: Saxonica http://www.saxonica.com/">
    <meta name="keywords" content="http, client certificate">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.creator" content="Campbell, B.">
    <meta name="dcterms.creator" content="Bishop, M.">
    <meta name="dcterms.identifier" content="urn:ietf:rfc:9440">
    <meta name="dcterms.issued" content="2023-07">
    <meta name="dcterms.abstract"
        content="This document describes HTTP extension header fields that allow a TLS terminating reverse proxy (TTRP) to convey the client certificate information of a mutually authenticated TLS connection to the origin server in a common and predictable manner.">
    <meta name="dcterms.isPartOf" content="urn:issn:2070-1721">
    <meta name="description"
        content="This document describes HTTP extension header fields that allow a TLS terminating reverse proxy (TTRP) to convey the client certificate information of a mutually authenticated TLS connection to the origin server in a common and predictable manner.">
</head>

<body onload="getMeta(9440,'rfc.meta');">
    <nav class="navbar navbar-dark bg-dark d-print-none navbar-expand-lg fixed-top ps-3 pe-3" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse"
                aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <a class="navbar-brand" href="https://httpwg.org/"><img src="https://httpwg.org/assets/http.svg"
                    height="23"></a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse">

            <div class="navbar-nav me-auto">

                <a class="nav-item ms-1 text-white" href="https://httpwg.org/specs/">📄 Documentation</a>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Work in
                        Progress</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/http-extensions/">HTTP Extensions</a></li>
                        <li class="dropdown-item"><a
                                href="https://github.com/httpwg/admin/issues?q=is%3Aissue+is%3Aopen+label%3Aadoption">Future
                                Work</a></li>
                    </ul>
                </div>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Participate</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/about/">About the HTTP Working Group</a>
                        </li>
                        <li class="divider"></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/CONTRIBUTING.html">Contribution Policy</a>
                        </li>
                        <li class="dropdown-item"><a href="http://datatracker.ietf.org/wg/httpbis/charter/">WG
                                Charter</a></li>
                        <li class="dropdown-item"><a href="http://lists.w3.org/Archives/Public/ietf-http-wg/">Group
                                Mailing List 📨</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/wg-materials/">Meeting Materials</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/admin/editors/">Document Editor
                                Resources</a></li>
                    </ul>
                </div>
            </div>

        </div>
    </nav>
    <div class="container" id="top">
        <div class="row">
            <div class="col-lg-4 order-last d-none d-lg-block" id="sidebar" role="navigation">
                <div class="navbar">
                    <div class="navbar-brand"><a href="#top"><strong>RFC </strong>9440</a></div><br clear="all">
                    <div class="">
                        <div class="toc ">
                            <ul>
                                <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#Introduction">はじめに</a>
                                    <ul>
                                        <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#requirements-notation-and-conventions">要件の表記と規約</a></li>
                                        <li><a href="#rfc.section.1.2">1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#terminology-and-applicability">用語と適用性</a>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#headers">HTTP
                                        ヘッダーフィールドと処理ルール</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#encoding">エンコーディング</a></li>
                                        <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#header">Client-Cert HTTP ヘッダーフィールド</a></li>
                                        <li><a href="#rfc.section.2.3">2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#chain-header">Client-Cert-Chain HTTP ヘッダーフィールド</a></li>
                                        <li><a href="#rfc.section.2.4">2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#processing-rules">処理ルール</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#deployment">導入上の考慮事項</a>
                                    <ul>
                                        <li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#header-field-compression">ヘッダーフィールドの圧縮</a></li>
                                        <li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#message-header-size">メッセージヘッダのサイズ</a></li>
                                        <li><a href="#rfc.section.3.3">3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#tls-session-resumption">TLS セッション再開</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#sec">セキュリティに関する考慮事項</a>
                                </li>
                                <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-considerations">IANA
                                        に関する考慮事項</a>
                                    <ul>
                                        <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-field-name-registrations">HTTP フィールド名の登録</a>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">参考文献</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.2">ノルマティブ参考文献</a></li>
                                        <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.3">インフォマティブ参考文献</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.A">付録 A.</a>&nbsp;&nbsp;&nbsp;<a href="#example">例</a></li>
                                <li><a href="#rfc.section.B">付録 B.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#select-design-considerations">選択された設計上の考慮事項</a>
                                    <ul>
                                        <li><a href="#rfc.section.B.1">B.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#field-injection">フィールド注入</a></li>
                                        <li><a href="#rfc.section.B.2">B.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#the-forwarded-http-extension">Forwarded HTTP 拡張</a>
                                        </li>
                                        <li><a href="#rfc.section.B.3">B.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#the-whole-certificate-and-certificate-chain">証明書本体と証明書チェーン</a>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#acknowledgements">謝辞</a></li>
                                <li><a href="#rfc.authors">著者の連絡先</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8 order-first main" role="main">
                <header>
                    <table class="table table-condensed header" id="rfc.headerblock">
                        <tbody>
                            <tr>
                                <td class="text-left">インターネット技術タスクフォース (IETF)</td>
                                <td class="text-right">B. Campbell</td>
                            </tr>
                            <tr>
                                <td class="text-left">Request for Comments: 9440</td>
                                <td class="text-right">Ping Identity</td>
                            </tr>
                            <tr>
                                <td class="text-left">カテゴリ: 情報</td>
                                <td class="text-right">M. Bishop, Editor</td>
                            </tr>
                            <tr>
                                <td class="text-left">ISSN: 2070-1721</td>
                                <td class="text-right">Akamai</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">2023年7月</td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="rfc.title">
                        <h1>Client-Cert HTTP ヘッダーフィールド</h1>
                    </div>
                </header>
                <hr>
                <h2 id="rfc.abstract"><a href="#rfc.abstract">概要</a></h2>
                <div class="lead">
                    <div id="rfc.abstract.p.1">
                        <p>本書は、TLS 終端リバースプロキシ（TTRP）が、相互認証された TLS 接続のクライアント証明書情報をオリジンサーバーに対して共通かつ予測可能な方法で伝達することを可能にする
                            HTTP 拡張ヘッダーフィールドについて説明します。</p>
                    </div>
                </div>
                <aside id="rfc.meta" class="alert alert-info"></aside>
                <section id="rfc.status">
                    <h2><a href="#rfc.status">このメモの状態</a></h2>
                    <div id="rfc.boilerplate.1.p.1">
                        <p>本書はインターネット標準トラックの仕様ではなく、情報提供目的で公開されています。</p>
                    </div>
                    <div id="rfc.boilerplate.1.p.2">
                        <p>本書はインターネット技術タスクフォース (IETF) の成果物です。IETF コミュニティのコンセンサスを示すものであり、公開レビューを受け、Internet Engineering
                            Steering Group (IESG) によって公開が承認されています。IESG
                            によって承認されたすべての文書がいかなるレベルのインターネット標準の候補となるわけではありません。詳細は <a
                                href="https://www.rfc-editor.org/rfc/rfc7841.html#section-2">RFC 7841 のセクション 2</a>
                            を参照してください。</p>
                    </div>
                    <div id="rfc.boilerplate.1.p.3">
                        <p>本書の現行の状態、訂正情報（errata）、およびフィードバックの方法については <a
                                href="https://www.rfc-editor.org/info/rfc9440">https://www.rfc-editor.org/info/rfc9440</a>
                            を参照してください。</p>
                    </div>
                </section>
                <section id="rfc.copyrightnotice">
                    <h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2>
                    <div id="rfc.boilerplate.2.p.1">
                        <p>Copyright (c) 2023 IETF Trust and the persons identified as the document authors. All rights
                            reserved.</p>
                    </div>
                    <div id="rfc.boilerplate.2.p.2">
                        <p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF
                            Documents (<a
                                href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>)
                            in effect on the date of publication of this document. Please review these documents
                            carefully, as they describe your rights and restrictions with respect to this document. Code
                            Components extracted from this document must include Revised BSD License text as described
                            in Section 4.e of the Trust Legal Provisions and are provided without warranty as described
                            in the Revised BSD License.</p>
                    </div>
                </section>
                <div class="toc d-lg-none">
                    <ul>
                        <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#Introduction">はじめに</a>
                            <ul>
                                <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#requirements-notation-and-conventions">要件表記と規約</a></li>
                                <li><a href="#rfc.section.1.2">1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#terminology-and-applicability">用語と適用範囲</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#headers">HTTP ヘッダーフィールドと
                                処理ルール</a>
                            <ul>
                                <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#encoding">エンコーディング</a></li>
                                <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a href="#header">Client-Cert
                                        HTTP ヘッダーフィールド</a></li>
                                <li><a href="#rfc.section.2.3">2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#chain-header">Client-Cert-Chain HTTP ヘッダーフィールド</a></li>
                                <li><a href="#rfc.section.2.4">2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#processing-rules">処理ルール</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#deployment">導入上の考慮事項</a>
                            <ul>
                                <li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#header-field-compression">ヘッダーフィールド圧縮</a></li>
                                <li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#message-header-size">メッセージヘッダのサイズ</a></li>
                                <li><a href="#rfc.section.3.3">3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#tls-session-resumption">TLS セッション再開</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#sec">セキュリティに関する考慮事項</a>
                        </li>
                        <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-considerations">IANA
                                に関する考慮事項</a>
                            <ul>
                                <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#http-field-name-registrations">HTTP フィールド名の登録</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">参考文献</a>
                            <ul>
                                <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.2">ノルマティブ参考文献</a></li>
                                <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.3">インフォマティブ参考文献</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.A">付録 A.</a>&nbsp;&nbsp;&nbsp;<a href="#example">例</a>
                        </li>
                        <li><a href="#rfc.section.B">付録 B.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#select-design-considerations">選択された設計上の考慮事項</a>
                            <ul>
                                <li><a href="#rfc.section.B.1">B.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#field-injection">フィールド注入</a></li>
                                <li><a href="#rfc.section.B.2">B.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#the-forwarded-http-extension">Forwarded HTTP 拡張</a></li>
                                <li><a href="#rfc.section.B.3">B.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#the-whole-certificate-and-certificate-chain">証明書本体と証明書チェーン</a></li>
                            </ul>
                        </li>
                        <li><a href="#acknowledgements">謝辞</a></li>
                        <li><a href="#rfc.authors">著者の連絡先</a></li>
                    </ul>
                </div>
                <hr class="hidden-print">
                <section id="Introduction">
                    <h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a
                            href="#Introduction">はじめに</a></h2>
                    <div id="rfc.section.1.p.1">
                        <p>HTTPS アプリケーションの比較的一般的な導入パターンとして、オリジンの HTTP アプリケーションサーバーがクライアントからの TLS
                            接続を終端するリバースプロキシの背後に配置されることがあります。プロキシはインターネットからアクセス可能で、クライアントのリクエストをプライベートまたは保護されたネットワーク内の適切なオリジンサーバーに振り分けます。オリジンサーバーはクライアントから直接アクセスできず、リバースプロキシを介してのみ到達可能です。この種の導入のバックエンドの詳細は、プロキシサーバーに対してリクエストを行い、プロキシから発信されたかのようにレスポンスを受け取るクライアントにとって通常は不透明です。プロキシとオリジンサーバー間でも通常
                            HTTPS が使用されますが、クライアントが確立する HTTPS の TLS 接続はクライアント自身とリバースプロキシ間のものに限られます。</p>
                    </div>
                    <div id="rfc.section.1.p.2">
                        <p>この導入パターンは、n 層アーキテクチャ、コンテンツ配信ネットワーク、アプリケーションロードバランサ、イングレスコントローラなど、様々なバリエーションで見られます。</p>
                    </div>
                    <div id="rfc.section.1.p.3">
                        <p>頻繁ではないものの、TLS
                            クライアント証明書による認証が使われることがあり、その場合オリジンサーバーはアプリケーションロジックのためにクライアント証明書の情報を必要とすることが多いです。そのようなロジックにはアクセス制御判断、監査ログ、発行されたトークンやクッキーを証明書に紐付ける処理（およびその検証）などが含まれます。必要とされる証明書からの詳細もアプリケーション要件によって異なります。これらの種類のアプリケーション導入を実際に機能させるためには、リバースプロキシがクライアント証明書に関する情報をオリジンアプリケーションサーバーに伝達する必要があります。執筆時点では、一般的な方法としては非標準フィールドに（あるエンコーディングで）証明書全体またはその一部を含めてオリジンサーバーに渡す方法が用いられています。この解決策は動作しますが、独立して開発されたコンポーネント間の相互運用性は、使用されるフィールド名や設定可能性、公開される証明書の部分、証明書のエンコード方法などの実装選択によっては面倒であるか、場合によっては不可能になることがあります。この一般的に発生する機能に対して、よく知られた予測可能なアプローチがあれば、独立実装間の相互運用性を改善・簡素化できるでしょう。
                        </p>
                    </div>
                    <div id="rfc.section.1.p.4">
                        <p>本書の範囲は、既存の実践を記述しつつ、より良く低労力な相互運用性を促進するために十分な具体的な詳細を規定することです。したがって、本書では TLS
                            終端リバースプロキシ（TTRP）がバックエンドのオリジンサーバーに追加する 2 つの HTTP ヘッダーフィールド "Client-Cert" と
                            "Client-Cert-Chain" を記述します。Client-Cert フィールド値は、発端のクライアントと TTRP 間の相互認証された TLS
                            接続で使用されたエンドエンティティのクライアント証明書を含みます。オプションとして、Client-Cert-Chain
                            フィールド値はエンドエンティティ証明書の検証に使用された証明書チェーンを含むことがあります。これによりバックエンドのオリジンサーバーはアプリケーションロジックでクライアント証明書情報を利用できます。TTRP
                            とオリジンサーバー間に追加のプロキシやホップ（それらの間で相互認証された TLS 接続がある可能性も含む）が存在する場合があっても、Client-Cert
                            ヘッダーフィールドの範囲は意図的に、発端のクライアントが TTRP との接続で提示した証明書をオリジンサーバーに公開することに限定されています。</p>
                    </div>
                    <section id="requirements-notation-and-conventions">
                        <h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a>&nbsp;<a
                                href="#requirements-notation-and-conventions">要件表記と規約</a>
                        </h3>
                        <div id="rfc.section.1.1.p.1">
                            <p>本書におけるキーワード "<em class="bcp14">MUST</em>", "<em class="bcp14">MUST NOT</em>", "<em
                                    class="bcp14">REQUIRED</em>", "<em class="bcp14">SHALL</em>", "<em
                                    class="bcp14">SHALL NOT</em>", "<em class="bcp14">SHOULD</em>", "<em
                                    class="bcp14">SHOULD NOT</em>", "<em class="bcp14">RECOMMENDED</em>", "<em
                                    class="bcp14">NOT RECOMMENDED</em>", "<em class="bcp14">MAY</em>", および "<em
                                    class="bcp14">OPTIONAL</em>" は、ここに示すとおり全て大文字で現れる場合に限り、<span class="nobr">BCP
                                    14</span> の <a href="#RFC2119"><cite
                                        title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>
                                および <a href="#RFC8174"><cite
                                        title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</cite></a>
                                に記載されたとおりに解釈されます。
                            </p>
                        </div>
                    </section>
                    <section id="terminology-and-applicability">
                        <h3 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a>&nbsp;<a
                                href="#terminology-and-applicability">用語と適用範囲</a></h3>
                        <div id="rfc.section.1.2.p.1">
                            <p>本書では構文と解析を指定するために <a href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3">RFC
                                    8941 のセクション 3</a> からの用語 List と Byte Sequence を使用します。</p>
                        </div>
                        <div id="rfc.section.1.2.p.2">
                            <p>"TLS クライアント証明書認証" や "相互認証された TLS" といった表現は、本書全体で、通常の TLS サーバー認証に加えてクライアントが X.509
                                証明書を提示し（<a href="#RFC5280"><cite
                                        title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">[RFC5280]</cite></a>
                                を参照）、TLS 接続のネゴシエーションまたはその再開時に対応する秘密鍵の所持をサーバーに証明するプロセスを指します。現代の TLS 版（<a
                                    href="#RFC8446"><cite
                                        title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>
                                や <a href="#RFC5246"><cite
                                        title="The Transport Layer Security (TLS) Protocol Version 1.2">[TLS1.2]</cite></a>）では、相互認証はクライアントがハンドシェイク中に
                                Certificate と CertificateVerify メッセージを送信し、サーバーが CertificateVerify と Finished
                                メッセージを検証することを必要とします。</p>
                        </div>
                        <div id="rfc.section.1.2.p.3">
                            <p>HTTP/2 は TLS 1.2 の再ネゴシエーションを制限し（<a
                                    href="https://www.rfc-editor.org/rfc/rfc9113.html#section-9.2.1">RFC 9113 セクション
                                    9.2.1</a>）、TLS 1.3 のポストハンドシェイク認証を禁止します（<a
                                    href="https://www.rfc-editor.org/rfc/rfc9113.html#section-9.2.3">RFC 9113 セクション
                                    9.2.3</a>）。しかし、これらはサーバーが HTTP/1.1
                                のリクエストに基づいてクライアント証明書を要求するかどうかを決定するリアクティブなクライアント証明書認証を実装するために使われることがあります。このような接続上でクライアント証明書の受領と検証の後に送信される
                                HTTP
                                アプリケーションデータも相互認証されており、本書で説明するメカニズムに適しています。ポストハンドシェイク認証の場合、実務上稀ではあるものの、接続上でクライアントから複数の証明書や証明書チェーンが提示される可能性があります。この場合、本書で説明するヘッダーフィールドに利用されるのは最後に行われたポストハンドシェイク認証の証明書とチェーンのみです。
                            </p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="headers">
                    <h2 id="rfc.section.2" class="np"><a href="#rfc.section.2">2.</a>&nbsp;<a href="#headers">HTTP
                            ヘッダーフィールドと処理ルール</a></h2>
                    <div id="rfc.section.2.p.1">
                        <p>本書は、相互認証された TLS 接続のクライアント証明書情報を伝達するために、以下に示すヘッダー（それぞれセクション <a href="#header"
                                title="Client-Cert HTTP Header Field">2.2</a> と <a href="#chain-header"
                                title="Client-Cert-Chain HTTP Header Field">2.3</a>
                            でさらに定義されます）を指定します。これらのヘッダーはリバースプロキシからオリジンサーバーへの情報伝達を行います。</p>
                    </div>
                    <div id="rfc.section.2.p.2">
                        <dl class="nohang">
                            <dt>Client-Cert:</dt>
                            <dd style="margin-left: 1.5em">リバースプロキシとの TLS ハンドシェイクでクライアントが使用したエンドエンティティ証明書。</dd>
                            <dt>Client-Cert-Chain:</dt>
                            <dd style="margin-left: 1.5em">リバースプロキシとの TLS
                                ハンドシェイクでクライアントが提供したエンドエンティティ証明書の検証に使用された証明書チェーン。</dd>
                        </dl>
                    </div>
                    <section id="encoding">
                        <h3 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a>&nbsp;<a
                                href="#encoding">エンコーディング</a></h3>
                        <div id="rfc.section.2.1.p.1">
                            <p>本書のヘッダーは、バイトシーケンス（RFC 8941 の <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.3.5">セクション
                                    3.3.5</a>）として証明書をエンコードします。ここでのバイナリデータの値は DER エンコードされた <a href="#ITU.X690"><cite
                                        title="Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)">[ITU.X690]</cite></a>
                                による X.509 証明書 (<a href="#RFC5280"><cite
                                        title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">[RFC5280]</cite></a>)
                                です。実質的には、バイナリ DER 証明書を base64（改行や空白、base64 アルファベット外の文字を含めない）でエンコードし、両端をコロンで囲むことを意味します。
                            </p>
                        </div>
                        <div id="rfc.section.2.1.p.2">
                            <p>証明書はしばしば、RFC 7468 の <a
                                    href="https://www.rfc-editor.org/rfc/rfc7468.html#section-5.1">セクション 5.1</a>
                                に記述されるようなテキスト形式で保存されることがあり、これはバイトシーケンスとほぼ互換性があります。そのような形式で証明書がエンコードされている場合、"---(BEGIN|END)
                                CERTIFICATE---" を ":" に置き換え、改行を削除するだけで適切なアイテムを生成できます。</p>
                        </div>
                    </section>
                    <section id="header">
                        <h3 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a>&nbsp;<a href="#header">Client-Cert
                                HTTP ヘッダーフィールド</a></h3>
                        <div id="rfc.section.2.2.p.1">
                            <p>TLS 終端リバースプロキシ導入の文脈では、プロキシは Client-Cert HTTP ヘッダーフィールドを用いてバックエンドアプリケーションに TLS
                                クライアント証明書を提供します。このフィールドはクライアントが TLS ハンドシェイクで使用したエンドエンティティ証明書を含みます。</p>
                        </div>
                        <div id="rfc.section.2.2.p.2">
                            <p>Client-Cert はセクション <a href="#encoding" title="Encoding">2.1</a>
                                に記述された通りにエンコードされた値を持つバイトシーケンスです。</p>
                        </div>
                        <div id="rfc.section.2.2.p.3">
                            <p>Client-Cert ヘッダーフィールドは HTTP リクエストでのみ使用され、HTTP レスポンスでは使用してはなりません（<em class="bcp14">MUST
                                    NOT</em>）。これは RFC 9110 の <a
                                    href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.5">セクション 5.5</a>
                                に定義される単一ヘッダーフィールド値（リスト値を持たない、または複数回現れない）として扱われます。</p>
                        </div>
                        <div id="rfc.section.2.2.p.4">
                            <p><a href="#example-header" title="Header Field in HTTP Request to Origin Server">付録 A の図
                                    2</a> に Client-Cert ヘッダーフィールドの例があります。</p>
                        </div>
                    </section>
                    <section id="chain-header">
                        <h3 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3.</a>&nbsp;<a
                                href="#chain-header">Client-Cert-Chain HTTP ヘッダーフィールド</a></h3>
                        <div id="rfc.section.2.3.p.1">
                            <p>TLS 終端リバースプロキシ導入の文脈では、プロキシは <em class="bcp14">MAY</em> Client-Cert-Chain HTTP
                                ヘッダーフィールドを用いて証明書チェーンをバックエンドアプリケーションに提供できます。</p>
                        </div>
                        <div id="rfc.section.2.3.p.2">
                            <p>Client-Cert-Chain は RFC 8941 の <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.1">セクション 3.1</a> に記される
                                List です。リスト内の各アイテムは <a href="#encoding" title="Encoding">セクション 2.1</a>
                                に記述された通りにエンコードされたバイトシーケンスでなければなりません。順序は TLS の順序（<a
                                    href="https://www.rfc-editor.org/rfc/rfc8446.html#section-4.4.2">RFC 8446 セクション
                                    4.4.2</a> に記載）と同じです。</p>
                        </div>
                        <div id="rfc.section.2.3.p.3">
                            <p>Client-Cert-Chain は Client-Cert が存在する場合にのみ現れることができ、Client-Cert
                                に既に含まれているエンドエンティティ証明書を再び含んではなりません（<em class="bcp14">MUST
                                    NOT</em>）。ルート証明書はターゲットのオリジンサーバーが省略された信頼アンカーを所持していることが知られている場合、Client-Cert-Chain
                                から省略してもよい（<em class="bcp14">MAY</em>）です。</p>
                        </div>
                        <div id="rfc.section.2.3.p.4">
                            <p>Client-Cert-Chain ヘッダーフィールドは HTTP リクエストでのみ使用され、HTTP レスポンスでは使用してはなりません（<em
                                    class="bcp14">MUST NOT</em>）。このヘッダーはリクエスト内でリスト値を持つことや複数回出現することが許容されます（<em
                                    class="bcp14">MAY</em>）。ヘッダー圧縮の目的でリストを複数のインスタンスに分割することが有利な場合があります。</p>
                        </div>
                        <div id="rfc.section.2.3.p.5">
                            <p><a href="#example-chain-header"
                                    title="Certificate Chain in HTTP Request to Origin Server">付録 A の図 3</a> に
                                Client-Cert-Chain ヘッダーフィールドの例があります。</p>
                        </div>
                    </section>
                    <section id="processing-rules">
                        <h3 id="rfc.section.2.4"><a href="#rfc.section.2.4">2.4.</a>&nbsp;<a
                                href="#processing-rules">処理ルール</a></h3>
                        <div id="rfc.section.2.4.p.1">
                            <p>この節では、相互認証された TLS 接続をネゴシエートした TTRP
                                が、その接続のクライアント証明書をバックエンドのオリジンサーバーに伝達するための適用可能な処理ルールを概説します。この手法は設定または導入オプションとして使用されるものであり、以下に記述する処理ルールはそのオプションが有効になっているサーバーに対するものです。
                            </p>
                        </div>
                        <div id="rfc.section.2.4.p.2" class="avoidbreakafter">
                            <p>TTRP はクライアントとの相互認証 TLS 接続の使用をネゴシエートし（例えば <a href="#RFC8446"><cite
                                        title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>
                                や <a href="#RFC5246"><cite
                                        title="The Transport Layer Security (TLS) Protocol Version 1.2">[TLS1.2]</cite></a>
                                に記述されるもの）、ポリシーと信頼する認証局に従ってクライアント証明書を検証します。基盤となる TLS 接続上の各 HTTP
                                リクエストは以下の修正を加えてオリジンサーバーに転送されます：</p>
                        </div>
                        <div id="rfc.section.2.4.p.3">
                            <ol type="1">
                                <li>クライアント証明書は転送されるリクエストの Client-Cert ヘッダーフィールドに配置されます（<a href="#header"
                                        title="Client-Cert HTTP Header Field">セクション 2.2</a> を参照）。</li>
                                <li>設定されている場合、クライアント証明書の検証チェーンはリクエストの Client-Cert-Chain ヘッダーフィールドに配置されます（<a
                                        href="#chain-header" title="Client-Cert-Chain HTTP Header Field">セクション 2.3</a>
                                    を参照）。</li>
                                <li>元の受信リクエストに Client-Cert または Client-Cert-Chain
                                    ヘッダーフィールドが存在する場合、それらは転送前に削除または上書きされなければなりません（<em class="bcp14">MUST</em>）。元の受信リクエストに
                                    Client-Cert または Client-Cert-Chain ヘッダーフィールドが含まれている場合、そのリクエストは HTTP 400
                                    応答で拒否されることがあります（<em class="bcp14">MAY</em>）。</li>
                            </ol>
                        </div>
                        <div id="rfc.section.2.4.p.4">
                            <p>クライアント証明書認証の使用がネゴシエートされなかった TLS 接続を介して TTRP に送られたリクエストは、バックエンドに転送する前に Client-Cert および
                                Client-Cert-Chain ヘッダーフィールドのいかなる出現も削除してサニタイズしなければなりません（<em class="bcp14">MUST</em>）。</p>
                        </div>
                        <div id="rfc.section.2.4.p.5">
                            <p>バックエンドのオリジンサーバーは、Client-Cert リクエストヘッダーフィールドを使用して、クライアントから TTRP
                                への接続が相互認証であったかどうかを判定し、相互認証であればクライアントが提示した証明書を特定できます。クライアント証明書（またはその欠如）に基づくアクセス制御判断は、適切なレスポンスコンテンツを選択するか、証明書がその文脈で受け入れられない場合は
                                HTTP 403 応答で伝えることができます。TLS 層でのエラー表示に依存するクライアントは、そのような TLS
                                レイヤでの不許容な証明書に関する信号を受け取れないことに注意してください。</p>
                        </div>
                        <div id="rfc.section.2.4.p.6">
                            <p>Client-Cert リクエストヘッダーフィールド値を用いてレスポンスを選択する場合（例：レスポンスコンテンツがアクセス制御される場合）、レスポンスは <em
                                    class="bcp14">MUST</em> キャッシュ不可能にする（例：Cache-Control: no-store を送る）か、同一の Client-Cert
                                ヘッダーフィールド値を持つ後続リクエストのみで再利用可能とするために "Vary: Client-Cert" を送る必要があります。TTRP が Vary ヘッダーフィールドに
                                Client-Cert または Client-Cert-Chain を含むレスポンスに遭遇した場合（RFC 9110 の <a
                                    href="https://www.rfc-editor.org/rfc/rfc9110.html#section-12.5.5">セクション 12.5.5</a>
                                参照）、TTRP は Vary レスポンスヘッダーフィールドの値を "*" に変換してユーザエージェントがレスポンスをキャッシュするのを防止することが <em
                                    class="bcp14">SHOULD</em> 推奨されます。</p>
                        </div>
                        <div id="rfc.section.2.4.p.7">
                            <p>フォワードプロキシやその他の中継は、Client-Cert または Client-Cert-Chain ヘッダーフィールドをリクエストに追加したり、既存の Client-Cert
                                または Client-Cert-Chain ヘッダーフィールドを変更してはなりません（<em class="bcp14">MUST
                                    NOT</em>）。同様に、クライアントはリクエストで Client-Cert または Client-Cert-Chain
                                ヘッダーフィールドを使用してはなりません（<em class="bcp14">MUST NOT</em>）。</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="deployment">
                    <h2 id="rfc.section.3" class="np"><a href="#rfc.section.3">3.</a>&nbsp;<a
                            href="#deployment">導入上の考慮事項</a></h2>
                    <section id="header-field-compression">
                        <h3 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a>&nbsp;<a
                                href="#header-field-compression">ヘッダーフィールド圧縮</a></h3>
                        <div id="rfc.section.3.1.p.1">
                            <p>もし TTRP とオリジン間の接続がヘッダーフィールド圧縮（例：HPACK <a href="#RFC7541"><cite
                                        title="HPACK: Header Compression for HTTP/2">[HPACK]</cite></a> や QPACK <a
                                    href="#RFC9204"><cite
                                        title="QPACK: Field Compression for HTTP/3">[QPACK]</cite></a>）に対応しており、かつ TTRP
                                が複数のクライアントのリクエストをその接続に多重化している場合、Client-Cert および Client-Cert-Chain
                                フィールド値のサイズと変動は圧縮効率を著しく低下させる可能性があります。オリジンは動的テーブルのサイズを増やすことで効率低下を緩和できるかもしれません。TTRP
                                がオリジンの動的テーブルが十分に大きくないと判断した場合、フィールド値を常にリテラルとして送信し、テーブルに入れない方が有益な場合があります。</p>
                        </div>
                    </section>
                    <section id="message-header-size">
                        <h3 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a>&nbsp;<a
                                href="#message-header-size">メッセージヘッダのサイズ</a></h3>
                        <div id="rfc.section.3.2.p.1">
                            <p>サーバーが処理可能なより大きなメッセージヘッダを受信した場合、HTTP 431 (Request Header Fields Too Large)
                                ステータスコードを送信できます（RFC 6585 の <a
                                    href="https://www.rfc-editor.org/rfc/rfc6585.html#section-5">セクション 5</a>
                                参照）。証明書データを含むフィールド値の典型的なサイズのため、受信者はより大きな最大ヘッダサイズを許容するように設定する必要があるかもしれません。クライアントに広告可能な最大許容ヘッダサイズを持つ接続（例：HTTP/2
                                や
                                HTTP/3）上でクライアント証明書ヘッダーフィールドを生成する中継は、送信するリクエストのヘッダの追加サイズを考慮して、クライアントに広告する値を受信するリクエストよりも十分小さくする必要があります。
                            </p>
                        </div>
                    </section>
                    <section id="tls-session-resumption">
                        <h3 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3.</a>&nbsp;<a
                                href="#tls-session-resumption">TLS セッション再開</a></h3>
                        <div id="rfc.section.3.3.p.1">
                            <p>一部の TLS 実装はセッション再開時にクライアント証明書情報を保持しないことがあります。再開時に Client-Cert および Client-Cert-Chain
                                の不整合な値を提供するとエラーにつながる可能性があるため、これらの値を提供できない実装は、クライアント証明書付き接続に対しては再開を無効にするか、あるいは再開後に利用できない可能性がある場合は初めに
                                Client-Cert および Client-Cert-Chain フィールドを省略することを <em class="bcp14">SHOULD</em> 推奨します。</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="sec">
                    <h2 id="rfc.section.4" class="np"><a href="#rfc.section.4">4.</a>&nbsp;<a
                            href="#sec">セキュリティに関する考慮事項</a></h2>
                    <div id="rfc.section.4.p.1">
                        <p>ここで説明するヘッダーフィールドは、TTRP とバックエンドまたはオリジンサーバーが、クライアントの視点からは相互認証された TLS 接続上の単一の論理的なサーバーサイド HTTPS
                            展開として機能することを可能にします。しかし、想定外の使用ケースでこれらのヘッダーフィールドを使うと、TLS
                            クライアント証明書認証によって提供される保護を損なう可能性があります。したがって、ヘッダーフィールドの送信およびその値に依存する際には、以下に述べるような措置を講じて意図しない利用を防止する必要があります。
                        </p>
                    </div>
                    <div id="rfc.section.4.p.2">
                        <p>Client-Cert および Client-Cert-Chain ヘッダーフィールドの生成と消費は、それぞれ TTRP
                            とバックエンドサーバー（あるいはそのサーバー内の個々のアプリケーション）で設定可能なオプションであるべきです。両者のデフォルト設定はヘッダーフィールドを使用しないこととし、機能を利用するには「オプトイン」が必要であるべきです（<em
                                class="bcp14">SHOULD</em>）。</p>
                    </div>
                    <div id="rfc.section.4.p.3">
                        <p>フィールド注入を防ぐために、バックエンドサーバーは信頼された TTRP（または TTRP からの信頼されたパス上の他のプロキシ）からのみ Client-Cert および
                            Client-Cert-Chain ヘッダーフィールドを受け入れるべきです（<em class="bcp14">MUST</em>）。TTRP
                            は受信リクエストを転送する前に既存のフィールドを削除または上書きしてサニタイズしなければなりません（<em
                                class="bcp14">MUST</em>）。そうしないと、任意のクライアントがバックエンドに対して TTRP
                            からのものであるかのように見えるフィールド値を制御できてしまいます。フィールド注入を防止する他の多くの方法（フィールド名や値に一意の秘密値を含める、署名・HMAC・AEAD
                            を適用する等）が可能ですが、一般的な共通メカニズムは存在しないため、本書で一時的な個別対策を定義するのは不適切です。ジェネリックな共通解が現在存在しないため、フィールドの削除とサニタイズが実務上の事実上の保護手段となっています。適切に実装されたサニタイズは十分であり、これはセキュリティ考慮（<a
                                href="#sec" title="Security Considerations">セクション 4</a>）の規範的要件です。</p>
                    </div>
                    <div id="rfc.section.4.p.4">
                        <p>TTRP とバックエンドサーバー間の通信は、盗聴や改ざんから保護されている必要があります。</p>
                    </div>
                    <div id="rfc.section.4.p.5">
                        <p>設定オプションとリクエストのサニタイズはそれぞれのサーバーの必要な機能です。他の要件は導入により異なる方法で満たされ得ます。例えば、TTRP
                            とバックエンド間の通信が何らかの方法で認証され、Client-Cert および Client-Cert-Chain
                            ヘッダーフィールドの挿入と消費がその接続上でのみ行われるようにすることが考えられます。付録 B.3 の HTTP Message Signatures
                            の適用例はその一例です。あるいはネットワークトポロジーによりバックエンドアプリケーションが TTRP
                            からのリクエストのみを受け付け、プロキシがそのサーバーにのみリクエストを行えるようなプライベートネットワーク構成が取られることもあります。本書で定めた要件を満たす他の導入もあり得ます。
                        </p>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="iana-considerations">
                    <h2 id="rfc.section.5" class="np"><a href="#rfc.section.5">5.</a>&nbsp;<a
                            href="#iana-considerations">IANA に関する考慮事項</a></h2>
                    <section id="http-field-name-registrations">
                        <h3 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a>&nbsp;<a
                                href="#http-field-name-registrations">HTTP フィールド名の登録</a></h3>
                        <div id="rfc.section.5.1.p.1" class="avoidbreakafter">
                            <p>IANA は "HTTP Semantics" によって定義された "Hypertext Transfer Protocol (HTTP) Field Name
                                Registry" に以下のエントリを登録しました：</p>
                        </div>
                        <div class="table table-condensed table-striped" id="table_1">
                            <table class="v3 text-center">
                                <caption>表 1: Hypertext Transfer Protocol (HTTP) Field Name Registry</caption>
                                <thead>
                                    <tr>
                                        <th class="text-left" colspan="1" rowspan="1">フィールド名</th>
                                        <th class="text-left" colspan="1" rowspan="1">ステータス</th>
                                        <th class="text-left" colspan="1" rowspan="1">参照</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">Client-Cert</td>
                                        <td class="text-left" colspan="1" rowspan="1">permanent</td>
                                        <td class="text-left" colspan="1" rowspan="1">RFC 9440, <a href="#headers"
                                                title="HTTP Header Fields and Processing Rules">セクション 2</a></td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">Client-Cert-Chain</td>
                                        <td class="text-left" colspan="1" rowspan="1">permanent</td>
                                        <td class="text-left" colspan="1" rowspan="1">RFC 9440, <a href="#headers"
                                                title="HTTP Header Fields and Processing Rules">セクション 2</a></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                </section>
                <section class="np">
                    <div id="rfc.references">
                        <h2 id="rfc.section.6"><a href="#rfc.section.6">6.</a> 参考文献</h2>
                        <section>
                            <div id="rfc.references.2">
                                <h3 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a> ノルマティブ参考文献</h3>
                                <dl class="dl-horizontal">
                                    <dt id="RFC9110">[<a href="#RFC9110" class="smpl">HTTP</a>]</dt>
                                    <dd>Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html">HTTP Semantics</a>”, <a
                                            href="https://www.rfc-editor.org/info/std97">STD 97</a>, RFC 9110, <a
                                            href="https://dx.doi.org/10.17487/RFC9110">DOI 10.17487/RFC9110</a>,
                                        2022年6月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;。
                                    </dd>
                                    <dt id="ITU.X690">[<a href="#ITU.X690" class="smpl">ITU.X690</a>]</dt>
                                    <dd>ITU-T, “<a href="https://www.itu.int/rec/T-REC-X.690/en">Information technology
                                            - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER),
                                            Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)</a>”,
                                        ITU-T Recommendation X.690, 2021年2月, &lt;<a
                                            href="https://www.itu.int/rec/T-REC-X.690/en">https://www.itu.int/rec/T-REC-X.690/en</a>&gt;。
                                    </dd>
                                    <dt id="RFC2119">[<a href="#RFC2119" class="smpl">RFC2119</a>]</dt>
                                    <dd>Bradner, S., “<a href="https://www.rfc-editor.org/rfc/rfc2119.html">Key words
                                            for use in RFCs to Indicate Requirement Levels</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 2119, 1997年3月,
                                        &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;。
                                    </dd>
                                    <dt id="RFC5280">[<a href="#RFC5280" class="smpl">RFC5280</a>]</dt>
                                    <dd>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk,
                                        “<a href="https://www.rfc-editor.org/rfc/rfc5280.html">Internet X.509 Public Key
                                            Infrastructure Certificate and Certificate Revocation List (CRL)
                                            Profile</a>”, RFC 5280, 2008年5月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;。
                                    </dd>
                                    <dt id="RFC8174">[<a href="#RFC8174" class="smpl">RFC8174</a>]</dt>
                                    <dd>Leiba, B., “<a href="https://www.rfc-editor.org/rfc/rfc8174.html">Ambiguity of
                                            Uppercase vs Lowercase in RFC 2119 Key Words</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 8174, 2017年5月,
                                        &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;。
                                    </dd>
                                    <dt id="RFC8941">[<a href="#RFC8941" class="smpl">STRUCTURED-FIELDS</a>]</dt>
                                    <dd>Nottingham, M. and P-H. Kamp, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8941.html">Structured Field Values
                                            for HTTP</a>”, RFC 8941, 2021年2月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8941">https://www.rfc-editor.org/info/rfc8941</a>&gt;。
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section>
                            <div id="rfc.references.3">
                                <h3 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a> インフォマティブ参考文献</h3>
                                <dl class="dl-horizontal">
                                    <dt id="RFC7541">[<a href="#RFC7541" class="smpl">HPACK</a>]</dt>
                                    <dd>Peon, R. and H. Ruellan, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc7541.html">HPACK: Header Compression
                                            for HTTP/2</a>”, RFC 7541, 2015年5月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7541">https://www.rfc-editor.org/info/rfc7541</a>&gt;。
                                    </dd>
                                    <dt id="RFC9112">[<a href="#RFC9112" class="smpl">HTTP/1.1</a>]</dt>
                                    <dd>Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9112.html">HTTP/1.1</a>”, RFC 9112,
                                        2022年6月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9112">https://www.rfc-editor.org/info/rfc9112</a>&gt;。
                                    </dd>
                                    <dt id="RFC9113">[<a href="#RFC9113" class="smpl">HTTP/2</a>]</dt>
                                    <dd>Thomson, M., Ed. and C. Benfield, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9113.html">HTTP/2</a>”, RFC 9113,
                                        2022年6月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9113">https://www.rfc-editor.org/info/rfc9113</a>&gt;。
                                    </dd>
                                    <dt id="RFC9114">[<a href="#RFC9114" class="smpl">HTTP/3</a>]</dt>
                                    <dd>Bishop, M., Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9114.html">HTTP/3</a>”, RFC 9114,
                                        2022年6月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9114">https://www.rfc-editor.org/info/rfc9114</a>&gt;。
                                    </dd>
                                    <dt id="I-D.ietf-httpbis-message-signatures">[<a
                                            href="#I-D.ietf-httpbis-message-signatures" class="smpl">HTTPSIG</a>]</dt>
                                    <dd>Backman, A., Ed., Richer, J., Ed., and M. Sporny, “<a
                                            href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-message-signatures-17">HTTP
                                            Message Signatures</a>”, draft-ietf-httpbis-message-signatures-17,
                                        2023年5月（作業中）、&lt;<a
                                            href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-message-signatures-17">https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-message-signatures-17</a>&gt;。
                                    </dd>
                                    <dt id="RFC9204">[<a href="#RFC9204" class="smpl">QPACK</a>]</dt>
                                    <dd>Krasic, C., Bishop, M., and A. Frindell, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9204.html">QPACK: Field Compression
                                            for HTTP/3</a>”, RFC 9204, 2022年6月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9204">https://www.rfc-editor.org/info/rfc9204</a>&gt;。
                                    </dd>
                                    <dt id="RFC6585">[<a href="#RFC6585" class="smpl">RFC6585</a>]</dt>
                                    <dd>Nottingham, M. and R. Fielding, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc6585.html">Additional HTTP Status
                                            Codes</a>”, RFC 6585, 2012年4月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc6585">https://www.rfc-editor.org/info/rfc6585</a>&gt;。
                                    </dd>
                                    <dt id="RFC7239">[<a href="#RFC7239" class="smpl">RFC7239</a>]</dt>
                                    <dd>Petersson, A. and M. Nilsson, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc7239.html">Forwarded HTTP
                                            Extension</a>”, RFC 7239, 2014年6月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7239">https://www.rfc-editor.org/info/rfc7239</a>&gt;。
                                    </dd>
                                    <dt id="RFC7468">[<a href="#RFC7468" class="smpl">RFC7468</a>]</dt>
                                    <dd>Josefsson, S. and S. Leonard, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc7468.html">Textual Encodings of
                                            PKIX, PKCS, and CMS Structures</a>”, RFC 7468, 2015年4月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7468">https://www.rfc-editor.org/info/rfc7468</a>&gt;。
                                    </dd>
                                    <dt id="RFC8705">[<a href="#RFC8705" class="smpl">RFC8705</a>]</dt>
                                    <dd>Campbell, B., Bradley, J., Sakimura, N., and T. Lodderstedt, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8705.html">OAuth 2.0 Mutual-TLS
                                            Client Authentication and Certificate-Bound Access Tokens</a>”, RFC 8705,
                                        2020年2月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8705">https://www.rfc-editor.org/info/rfc8705</a>&gt;。
                                    </dd>
                                    <dt id="RFC5246">[<a href="#RFC5246" class="smpl">TLS1.2</a>]</dt>
                                    <dd>Dierks, T. and E. Rescorla, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc5246.html">The Transport Layer
                                            Security (TLS) Protocol Version 1.2</a>”, RFC 5246, 2008年8月, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;。
                                    </dd>
                                    <dt id="RFC8446">[<a href="#RFC8446" class="smpl">TLS</a>]</dt>
                                    <dd>Rescorla, E., “<a href="https://www.rfc-editor.org/rfc/rfc8446.html">The
                                            Transport Layer Security (TLS) Protocol Version 1.3</a>”, RFC 8446, 2018年8月,
                                        &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;。
                                    </dd>
                                </dl>
                            </div>
                        </section>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="example">
                    <h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">付録 A.</a>&nbsp;<a href="#example">例</a>
                    </h2>
                    <div id="rfc.section.A.p.1">
                        <p>仮の例として、TLS クライアントが相互認証された TLS 接続を TTRP と確立する際に <a href="#example-chain"
                                title="Certificate Chain (with Client Certificate First)">図 1</a>
                            からクライアント証明書と中間証明書を提示する場合、プロキシはバックエンドに図 2 に示す Client-Cert フィールドを送信します。図 2 と図 3
                            のフィールド値には表示と整形の便宜のために改行や余分な空白が追加されている点に注意してください。</p>
                    </div>
                    <div id="example-chain"></div>
                    <div id="rfc.figure.1">
                        <div>
                            <pre class="text">
-----BEGIN CERTIFICATE-----
MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKDBJMZXQncyBB
dXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQTAeFw0yMDAx
MTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFkwEwYHKoZI
zj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmckC8vdgJ1p
5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDVR0TBAIw
ADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf8EBAMC
BsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV4YW1w
bGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6bMje
SkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIB5jCCAYugAwIBAgIBFjAKBggqhkjOPQQDAjBWMQswCQYDVQQGEwJVUzEbMBkG
A1UECgwSTGV0J3MgQXV0aGVudGljYXRlMSowKAYDVQQDDCFMZXQncyBBdXRoZW50
aWNhdGUgUm9vdCBBdXRob3JpdHkwHhcNMjAwMTE0MjEzMjMwWhcNMzAwMTExMjEz
MjMwWjA6MRswGQYDVQQKDBJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxB
IEludGVybWVkaWF0ZSBDQTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJf+aA54
RC5pyLAR5yfXVYmNpgd+CGUTDp2KOGhc0gK91zxhHesEYkdXkpS2UN8Kati+yHtW
CV3kkhCngGyv7RqjZjBkMB0GA1UdDgQWBBRm3WjLa38lbEYCuiCPct0ZaSED2DAf
BgNVHSMEGDAWgBTEA2Q6eecKu9g9yb5glbkhhVINGDASBgNVHRMBAf8ECDAGAQH/
AgEAMA4GA1UdDwEB/wQEAwIBhjAKBggqhkjOPQQDAgNJADBGAiEA5pLvaFwRRkxo
mIAtDIwg9D7gC1xzxBl4r28EzmSO1pcCIQCJUShpSXO9HDIQMUgH69fNDEMHXD3R
RX5gP7kuu2KGMg==
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIICBjCCAaygAwIBAgIJAKS0yiqKtlhoMAoGCCqGSM49BAMCMFYxCzAJBgNVBAYT
AlVTMRswGQYDVQQKDBJMZXQncyBBdXRoZW50aWNhdGUxKjAoBgNVBAMMIUxldCdz
IEF1dGhlbnRpY2F0ZSBSb290IEF1dGhvcml0eTAeFw0yMDAxMTQyMTI1NDVaFw00
MDAxMDkyMTI1NDVaMFYxCzAJBgNVBAYTAlVTMRswGQYDVQQKDBJMZXQncyBBdXRo
ZW50aWNhdGUxKjAoBgNVBAMMIUxldCdzIEF1dGhlbnRpY2F0ZSBSb290IEF1dGhvc
ml0eTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABFoaHU+Z5bPKmGzlYXtCf+E6
HYj62fORaHDOrt+yyh3H/rTcs7ynFfGn+gyFsrSP3Ez88rajv+U2NfD0o0uZ4Pmj
YzBhMB0GA1UdDgQWBBTEA2Q6eecKu9g9yb5glbkhhVINGDAfBgNVHSMEGDAWgBTE
A2Q6eecKu9g9yb5glbkhhVINGDAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQE
AwIBhjAKBggqhkjOPQQDAgNIADBFAiEAmAeg1ycKHriqHnaD4M/UDBpQRpkmdcRF
YGMg1Qyrkx4CIB4ivz3wQcQkGhcsUZ1SOImd/lq1Q0FLf09rGfLQPWDc
-----END CERTIFICATE-----
</pre>
                        </div>
                    </div>
                    <p class="figure">図 1: 証明書チェーン（クライアント証明書が先）</p>
                    <div id="example-header"></div>
                    <div id="rfc.figure.2">
                        <div>
                            <pre class="text">
Client-Cert: :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKDBJ
 MZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQTAeFw0
 yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFkwEwYHKoZ
 Izj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmckC8vdgJ1p5Be
 5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDVR0TBAIwADAfBgN
 VHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf8EBAMCBsAwEwYDVR0
 lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV4YW1wbGUuY29tMAoGCCq
 GSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6bMjeSkC3dFCOOB8TAiEAx/k
 HSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:
</pre>
                        </div>
                    </div>
                    <p class="figure">図 2: オリジンサーバーへの HTTP リクエスト内のヘッダーフィールド</p>
                    <div id="rfc.section.A.p.2">
                        <p>プロキシが証明書チェーンも含めるよう構成されている場合、Client-Cert-Chain ヘッダーフィールドも含めます。以下の例は TTRP
                            がルート証明書を挿入する例を示しますが、多くの導入では信頼アンカーを省略する選択をすることに注意してください。</p>
                    </div>
                    <div id="example-chain-header"></div>
                    <div id="rfc.figure.3">
                        <div>
                            <pre class="text">
Client-Cert-Chain: :MIIB5jCCAYugAwIBAgIBFjAKBggqhkjOPQQDAjBWMQsw
 CQYDVQQGEwJVUzEbMBkGA1UECgwSTGV0J3MgQXV0aGVudGljYXRlMSowKAYDVQQ
 DDCFMZXQncyBBdXRoZW50aWNhdGUgUm9vdCBBdXRob3JpdHkwHhcNMjAwMTE0Mj
 EzMjMwWhcNMzAwMTExMjEzMjMwWjA6MRswGQYDVQQKDBJMZXQncyBBdXRoZW50a
 WNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQTBZMBMGByqGSM49AgEG
 CCqGSM49AwEHA0IABJf+aA54RC5pyLAR5yfXVYmNpgd+CGUTDp2KOGhc0gK91zx
 hHesEYkdXkpS2UN8Kati+yHtWCV3kkhCngGyv7RqjZjBkMB0GA1UdDgQWBBRm3W
 jLa38lbEYCuiCPct0ZaSED2DAfBgNVHSMEGDAWgBTEA2Q6eecKu9g9yb5glbkhh
 VINGDASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjAKBggqhkjO
 PQQDAgNJADBGAiEA5pLvaFwRRkxomIAtDIwg9D7gC1xzxBl4r28EzmSO1pcCIQC
 JUShpSXO9HDIQMUgH69fNDEMHXD3RRX5gP7kuu2KGMg==:, :MIICBjCCAaygAw
 IBAgIJAKS0yiqKtlhoMAoGCCqGSM49BAMCMFYxCzAJBgNVBAYTAlVTMRswGQYDV
 QQKDBJMZXQncyBBdXRoZW50aWNhdGUxKjAoBgNVBAMMIUxldCdzIEF1dGhlbnRp
 Y2F0ZSBSb290IEF1dGhvcml0eTAeFw0yMDAxMTQyMTI1NDVaFw00MDAxMDkyMTI
 1NDVaMFYxCzAJBgNVBAYTAlVTMRswGQYDVQQKDBJMZXQncyBBdXRoZW50aWNhdG
 UxKjAoBgNVBAMMIUxldCdzIEF1dGhlbnRpY2F0ZSBSb290IEF1dGhvcml0eTBZM
 BMGByqGSM49AgEGCCqGSM49AwEHA0IABFoaHU+Z5bPKmGzlYXtCf+E6HYj62fOR
 aHDOrt+yyh3H/rTcs7ynFfGn+gyFsrSP3Ez88rajv+U2NfD0o0uZ4PmjYzBhMB0
 GA1UdDgQWBBTEA2Q6eecKu9g9yb5glbkhhVINGDAfBgNVHSMEGDAWgBTEA2Q6ee
 cKu9g9yb5glbkhhVINGDAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQEAwIBh
 jAKBggqhkjOPQQDAgNIADBFAiEAmAeg1ycKHriqHnaD4M/UDBpQRpkmdcRFYGMg
 1Qyrkx4CIB4ivz3wQcQkGhcsUZ1SOImd/lq1Q0FLf09rGfLQPWDc:
</pre>
                        </div>
                    </div>
                    <p class="figure">図 3: オリジンサーバーへの HTTP リクエスト内の証明書チェーン</p>
                </section>
                <hr class="hidden-print">
                <section id="select-design-considerations">
                    <h2 id="rfc.section.B" class="np"><a href="#rfc.section.B">付録 B.</a>&nbsp;<a
                            href="#select-design-considerations">選択された設計上の考慮事項</a></h2>
                    <section id="field-injection">
                        <h3 id="rfc.section.B.1"><a href="#rfc.section.B.1">B.1.</a>&nbsp;<a
                                href="#field-injection">フィールド注入</a></h3>
                        <div id="rfc.section.B.1.p.1">
                            <p>本書は、TTRP が受信リクエストのフィールドをサニタイズし、Client-Cert および Client-Cert-Chain
                                ヘッダーフィールドの既存のインスタンスを削除または上書きしてからそのリクエストをバックエンドアプリケーションに転送することを要求します。そうしないと、クライアントが自身で値を注入し、それがバックエンドからは
                                TTRP 由来であるかのように見えてしまいます。フィールド注入の検出と防止には、一意の秘密値をフィールド名や値の一部として使用することや署名、HMAC、AEAD
                                の適用など多数の方法が考えられますが、共通の一般的なメカニズムは存在しません。クライアントによるフィールド注入の問題は本書の機能に特有のものではないため、本書で一時的な個別の解決策を定義することは不適切です。一般的な共通解が現在存在しないため、フィールドの削除とサニタイズが実務上の事実上の防護手段となっています。フィールドのサニタイズは適切に実装されれば十分であり、これは
                                <a href="#sec" title="Security Considerations">セクション 4</a> の規範的要件です。
                            </p>
                        </div>
                    </section>
                    <section id="the-forwarded-http-extension">
                        <h3 id="rfc.section.B.2"><a href="#rfc.section.B.2">B.2.</a>&nbsp;<a
                                href="#the-forwarded-http-extension">Forwarded HTTP 拡張</a></h3>
                        <div id="rfc.section.B.2.p.1">
                            <p>RFC 7239 で定義された Forwarded HTTP ヘッダーフィールドは、プロキシ処理で失われた情報を開示することをプロキシコンポーネントに許します。本書で問題とする
                                TLS クライアント証明書情報は Forwarded
                                フィールドの拡張パラメータとして伝達できたかもしれませんが、その場合避けたいいくつかの不利点がありました。Forwarded フィールドの構文はプロキシされる HTTP
                                リクエストのフルチェーンに関する情報を許容しますが、本書の Client-Cert および Client-Cert-Chain ヘッダーは、発端のクライアントが TTRP
                                と確立した TLS 接続で提示した証明書に関する情報だけをバックエンドアプリケーションに伝えることに関心があります。Forwarded
                                のマルチホップ構文は表現力がありますが処理が複雑であり、より重要な点として、フィールド注入を防止するためにセクション 4
                                で要求されるようにその内容を適切にサニタイズすることがはるかに困難でエラーを生みやすくなります。したがって、本書はより平坦で簡潔な構造を選択しました。</p>
                        </div>
                    </section>
                    <section id="the-whole-certificate-and-certificate-chain">
                        <h3 id="rfc.section.B.3"><a href="#rfc.section.B.3">B.3.</a>&nbsp;<a
                                href="#the-whole-certificate-and-certificate-chain">証明書本体と証明書チェーン</a></h3>
                        <div id="rfc.section.B.3.p.1">
                            <p>アプリケーションによって、クライアント証明書から必要とする情報は様々です。例えばサブジェクトや発行者の識別名、サブジェクト代替名、シリアル番号、サブジェクト公開鍵情報、フィンガープリントなどが挙げられます。さらに、RFC
                                8705 に記載されたような一部のアプリケーションは証明書全体を利用します。そのような要件を収容し、特定の証明書情報を選り好みしないことで広い適用性を確保するため、本書は
                                Client-Cert フィールドの値としてフルにエンコードされた証明書を渡すことを選択しました。</p>
                        </div>
                        <div id="rfc.section.B.3.p.2">
                            <p>相互認証された TLS 接続のクライアント証明書とチェーンの検証は通常ハンドシェイク中に TTRP によって行われます。証明書検証の責任が TTRP
                                にあるため、エンドエンティティ証明書だけでオリジンサーバーのニーズに十分であることが多いです。追加情報が必要なオリジンサーバー導入の場合は、別個の
                                Client-Cert-Chain フィールドで証明書チェーンを伝達できます。</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="acknowledgements">
                    <h2 id="rfc.section.unnumbered-4" class="np"><a href="#acknowledgements">謝辞</a></h2>
                    <div id="rfc.section.unnumbered-4.p.1" class="avoidbreakafter">
                        <p>著者は、本書に様々な形で貢献してくれた以下の個人に感謝します。貢献は、文書作成の一般的な支援から具体的なフィードバックや内容提供まで多岐にわたります：</p>
                    </div>
                    <div id="rfc.section.unnumbered-4.p.2">
                        <ul>
                            <li>
                                <div>
                                    <p>Evan Anderson</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Annabelle Backman</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Alan Frindell</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Rory Hewitt</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Fredrik Jeansson</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Benjamin Kaduk</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Torsten Lodderstedt</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Kathleen Moriarty</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Mark Nottingham</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Erik Nygren</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Mike Ounsworth</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Lucas Pardue</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Matt Peterson</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Eric Rescorla</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Justin Richer</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Michael Richardson</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Joe Salowey</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Rich Salz</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Mohit Sethi</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Rifaat Shekh-Yusef</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Travis Spencer</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Nick Sullivan</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Willy Tarreau</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Martin Thomson</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Peter Wu</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Hans Zandbelt</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="rfc.authors" class="np">
                    <h2><a href="#rfc.authors">著者の連絡先</a></h2>
                    <address><b>Brian Campbell</b><br>Ping Identity<br>EMail: <a
                            href="mailto:bcampbell@pingidentity.com">bcampbell@pingidentity.com</a></address>
                    <address><b>Mike Bishop</b> (editor)<br>Akamai<br>EMail: <a
                            href="mailto:mbishop@evequefou.be">mbishop@evequefou.be</a></address>
                </section>
            </div>
        </div>
    </div>
    <script src="https://httpwg.org/assets/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="https://httpwg.org/assets/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="https://htmlspecs.com/dropdown.js"></script>
</body>

</html>