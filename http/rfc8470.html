<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="ja-JP">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>RFC 8470 - HTTP における早期データの使用</title>
    <script>
        var buttonsAdded = false;

        function initFeedback() {
            var fb = document.createElement("div");
            fb.className = "btn btn-primary feedback hidden-print";
            fb.setAttribute("onclick", "feedback();");
            fb.appendChild(document.createTextNode("feedback"));

            document.body.appendChild(fb);
        }

        function feedback() {
            toggleButtonsToElementsByName("h2");
            toggleButtonsToElementsByName("h3");
            toggleButtonsToElementsByName("h4");
            toggleButtonsToElementsByName("h5");

            buttonsAdded = !buttonsAdded;
        }

        function toggleButtonsToElementsByName(name) {
            var list = document.getElementsByTagName(name);
            for (var i = 0; i < list.length; i++) {
                toggleButton(list.item(i));
            }
        }

        function toggleButton(node) {
            if (!buttonsAdded) {

                // docname
                var template = "mailto:ietf-http-wg@w3.org?subject={docname},%20%22{section}%22\&amp;body=%3c{ref}%3e:";

                var id = node.getAttribute("id");
                // try also parent
                if (id == null || id == "") {
                    var id = node.parentNode.getAttribute("id");
                }
                // better id available?
                var titlelinks = node.getElementsByTagName("a");
                for (var i = 0; i < titlelinks.length; i++) {
                    var tl = titlelinks.item(i);
                    if (tl.getAttribute("id")) {
                        id = tl.getAttribute("id");
                    }
                }

                // ref
                var ref = window.location.toString();
                var hash = ref.indexOf("#");
                if (hash != -1) {
                    ref = ref.substring(0, hash);
                }
                if (id != null && id != "") {
                    ref += "#" + id;
                }

                // docname
                var docname = "";

                // section
                var section = node.textContent;
                section = section.replace("\u00a0", " ").trim();

                // build URI from template
                var uri = template.replace("{docname}", encodeURIComponent(docname));
                uri = uri.replace("{section}", encodeURIComponent(section));
                uri = uri.replace("{ref}", encodeURIComponent(ref));

                var button = document.createElement("a");
                button.className = "btn btn-primary fbbutton hidden-print";
                button.setAttribute("href", uri);
                button.appendChild(document.createTextNode("send feedback"));
                node.appendChild(button);
            }
            else {
                var buttons = node.getElementsByTagName("a");
                for (var i = 0; i < buttons.length; i++) {
                    var b = buttons.item(i);
                    if (b.className == "btn btn-primary fbbutton hidden-print") {
                        node.removeChild(b);
                    }
                }
            }
        }</script>
    <script>
        function getMeta(rfcno, container) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://www.rfc-editor.org/rfc/rfc" + rfcno + ".json", true);
            xhr.onload = function (e) {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        var data = JSON.parse(xhr.response);

                        var cont = document.getElementById(container);
                        // empty the container
                        while (cont.firstChild) {
                            cont.removeChild(myNode.firstChild);
                        }

                        var c = data.status;
                        if (c) {
                            var bld = newElementWithText("b", c);
                            cont.appendChild(bld);
                        } else {
                            cont.appendChild(newElementWithText("i", "(document status unknown)"));
                        }

                        c = data.updated_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Updated by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.obsoleted_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Obsoleted by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.errata_url;
                        if (c) {
                            cont.appendChild(newElement("br"));
                            var link = newElementWithText("a", "errata");
                            link.setAttribute("href", c);
                            var errata = newElementWithText("i", "This document has ");
                            errata.appendChild(link);
                            errata.appendChild(newText("."));
                            cont.appendChild(errata);
                        }

                        cont.style.display = "block";
                    } else {
                        console.error(xhr.statusText);
                    }
                }
            };
            xhr.onerror = function (e) {
                console.error(xhr.status + " " + xhr.statusText);
            };
            xhr.send(null);
        }
        function appendRfcLinks(parent, updates) {
            var template = "https://www.rfc-editor.org/rfc/rfc{rfc}.html";
            for (var i = 0; i < updates.length; i++) {
                var rfc = updates[i].trim().toLowerCase();
                if (rfc.substring(0, 3) == "rfc") {
                    var no = parseInt(rfc.substring(3), 10);

                    var link = newElement("a");
                    link.setAttribute("href", template.replace("{rfc}", no));
                    link.appendChild(newText(no));
                    parent.appendChild(link);
                } else {
                    parent.appendChild(newText(rfc));
                }
                if (i != updates.length - 1) {
                    parent.appendChild(newText(", "));
                }
            }
        }

        // DOM helpers
        function newElement(name) {
            return document.createElement(name);
        }
        function newElementWithText(name, txt) {
            var e = document.createElement(name);
            e.appendChild(newText(txt));
            return e;
        }
        function newText(text) {
            return document.createTextNode(text);
        }
    </script>
    <script>
        function anchorRewrite() {
            map = {};
            if (window.location.hash.length >= 1) {
                var fragid = window.location.hash.substr(1);
                if (fragid) {
                    if (!document.getElementById(fragid)) {
                        var prefix = "rfc.";
                        var mapped = map[fragid];
                        if (mapped) {
                            window.location.hash = mapped;
                        } else if (fragid.indexOf("section-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(8).replace("-", ".p.");
                        } else if (fragid.indexOf("appendix-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(9).replace("-", ".p.");
                        } else if (fragid.indexOf("s-") == 0) {
                            var postfix = fragid.substring(2);
                            if (postfix.startsWith("abstract")) {
                                window.location.hash = prefix + postfix;
                            } else if (postfix.startsWith("note-")) {
                                window.location.hash = prefix + "note." + postfix.substring(5).replace("-", ".p.");
                            } else {
                                window.location.hash = prefix + "section." + postfix.replace("-", ".p.");
                            }
                        } else if (fragid.indexOf("p-") == 0) {
                            var r = fragid.substring(2);
                            var p = r.indexOf("-");
                            if (p >= 0) {
                                window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
                            }
                        }
                    }
                }
            }
        }
        window.addEventListener('hashchange', anchorRewrite);
        window.addEventListener('DOMContentLoaded', anchorRewrite);
    </script>
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script>try {
            PR['registerLangHandler'](
                PR['createSimpleLexer'](
                    [
                        // comment
                        [PR['PR_COMMENT'], /^;[^\x00-\x1f]*/, null, ";"],
                    ],
                    [
                        // string literals
                        [PR['PR_STRING'], /^(\%s|\%i)?"[^"\x00-\x1f]*"/, null],
                        // binary literals
                        [PR['PR_LITERAL'], /^\%b[01]+((-[01]+)|(\.[01]+)*)/, null],
                        // decimal literals
                        [PR['PR_LITERAL'], /^\%d[0-9]+((-[0-9]+)|(\.[0-9]+)*)/, null],
                        // hex literals
                        [PR['PR_LITERAL'], /^(\%x[A-Za-z0-9]+((-[A-Za-z0-9]+)|(\.[A-Za-z0-9]+)*))/, null],
                        // prose rule
                        [PR['PR_NOCODE'], /^<[^>\x00-\x1f]*>/, null],
                        // rule name
                        [PR['PR_TYPE'], /^([A-Za-z][A-Za-z0-9-]*)/, null],
                        [PR['PR_PUNCTUATION'], /^[=\(\)\*\/\[\]#]/, null],
                    ]),
                ['ietf_abnf']);
        } catch (e) { }
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:type" content="article">
    <meta property="og:title" content="RFC8470">
    <meta property="og:description" content="Using Early Data in HTTP">
    <meta property="og:url" content="https://httpwg.org/specs/rfc8470.html">
    <meta property="og:site_name" content="IETF HTTP Working Group Specifications">
    <meta property="og:image" content="https://httpwg.org/assets/favicon/apple-icon-180x180.png">
    <link rel="stylesheet" type="text/css"
        href="https://httpwg.org/assets/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <style type="text/css">
        body {
            padding-top: 80px;
            padding-bottom: 80px;
            position: relative;
        }

        .table.header th,
        .table.header td {
            border-top: none;
            padding: 0;
        }

        #sidebar {
            margin-top: -10px;
            height: 90%;
            overflow-y: auto;
            font-size: 90%;
        }

        #rfc\.meta {
            width: 40%;
            float: right
        }

        .toc ul {
            list-style: none;
        }

        .filename {
            color: rgb(119, 119, 119);
            font-size: 23px;
            font-weight: normal;
            height: auto;
            line-height: 23px;
        }

        dl {
            margin-left: 1em;
        }

        dl.dl-horizontal {
            margin-left: 0;
        }

        dl>dt {
            float: left;
            margin-right: 1em;
        }

        dl.nohang>dt {
            float: none;
        }

        dl>dd {
            margin-bottom: .5em;
        }

        dl.compact>dd {
            margin-bottom: 0em;
        }

        dl>dd>dl {
            margin-top: 0.5em;
            margin-bottom: 0em;
        }

        ul.empty {
            list-style-type: none;
        }

        ul.empty li {
            margin-top: .5em;
        }

        td.reference {
            padding-right: 1em;
            vertical-align: top;
        }

        .feedback {
            position: fixed;
            bottom: 5px;
            right: 5px;
        }

        .fbbutton {
            margin-left: 5px;
        }

        h1 a,
        h2 a,
        h3 a,
        h4 a,
        h5 a,
        h6 a {
            color: rgb(51, 51, 51);
        }

        span.tt {
            font: 11pt consolas, monospace;
            font-size-adjust: none;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="https://httpwg.org/assets/site.css">
    <link rel="Contents" href="#rfc.toc">
    <link rel="Author" href="#rfc.authors">
    <link rel="License" href="#rfc.copyrightnotice">
    <link rel="Chapter" title="1 Introduction" href="#rfc.section.1">
    <link rel="Chapter" title="2 Early Data in HTTP" href="#rfc.section.2">
    <link rel="Chapter" title="3 Supporting Early Data in HTTP Servers" href="#rfc.section.3">
    <link rel="Chapter" title="4 Using Early Data in HTTP Clients" href="#rfc.section.4">
    <link rel="Chapter" title="5 Extensions for Early Data in HTTP" href="#rfc.section.5">
    <link rel="Chapter" title="6 Security Considerations" href="#rfc.section.6">
    <link rel="Chapter" title="7 IANA Considerations" href="#rfc.section.7">
    <link rel="Chapter" title="8 References" href="#rfc.section.8">
    <link rel="Appendix" title="Acknowledgments" href="#rfc.section.unnumbered-1">
    <link rel="Alternate" title="Plain Text Version" href="http://www.ietf.org/rfc/rfc8470.txt">
    <link rel="Help" title="RFC-Editor's Status Page" href="https://www.rfc-editor.org/info/rfc8470">
    <meta name="viewport" content="initial-scale=1">
    <meta name="generator"
        content="https://github.com/mnot/RFCBootstrap XSLT vendor: Saxonica http://www.saxonica.com/">
    <meta name="keywords" content="Internet-Draft">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.creator" content="Thomson, M.">
    <meta name="dcterms.creator" content="Nottingham, M.">
    <meta name="dcterms.creator" content="Tarreau, W.">
    <meta name="dcterms.identifier" content="urn:ietf:rfc:8470">
    <meta name="dcterms.issued" content="2018-09">
    <meta name="dcterms.abstract"
        content="Using TLS early data creates an exposure to the possibility of a replay attack. This document defines mechanisms that allow clients to communicate with servers about HTTP requests that are sent in early data. Techniques are described that use these mechanisms to mitigate the risk of replay.">
    <meta name="dcterms.isPartOf" content="urn:issn:2070-1721">
    <meta name="description"
        content="Using TLS early data creates an exposure to the possibility of a replay attack. This document defines mechanisms that allow clients to communicate with servers about HTTP requests that are sent in early data. Techniques are described that use these mechanisms to mitigate the risk of replay.">
</head>

<body onload="getMeta(8470,'rfc.meta');initFeedback();">
    <nav class="navbar navbar-dark bg-dark d-print-none navbar-expand-lg fixed-top ps-3 pe-3" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse"
                aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <a class="navbar-brand" href="https://httpwg.org/"><img src="https://httpwg.org/assets/http.svg"
                    height="23"></a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse">

            <div class="navbar-nav me-auto">

                <a class="nav-item ms-1 text-white" href="https://httpwg.org/specs/">📄 Documentation</a>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Work in
                        Progress</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/http-extensions/">HTTP Extensions</a></li>
                        <li class="dropdown-item"><a
                                href="https://github.com/httpwg/admin/issues?q=is%3Aissue+is%3Aopen+label%3Aadoption">Future
                                Work</a></li>
                    </ul>
                </div>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Participate</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/about/">About the HTTP Working Group</a>
                        </li>
                        <li class="divider"></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/CONTRIBUTING.html">Contribution Policy</a>
                        </li>
                        <li class="dropdown-item"><a href="http://datatracker.ietf.org/wg/httpbis/charter/">WG
                                Charter</a></li>
                        <li class="dropdown-item"><a href="http://lists.w3.org/Archives/Public/ietf-http-wg/">Group
                                Mailing List 📨</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/wg-materials/">Meeting Materials</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/admin/editors/">Document Editor
                                Resources</a></li>
                    </ul>
                </div>
            </div>

        </div>
    </nav>
    <div class="container" id="top">
        <div class="row">
            <div class="col-lg-4 order-last d-none d-lg-block" id="sidebar" role="navigation">
                <div class="navbar">
                    <div class="navbar-brand"><a href="#top"><strong>RFC </strong>8470</a></div><br clear="all">
                    <div class="">
                        <div class="toc ">
                            <ul>
                                <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#introduction">導入</a>
                                    <ul>
                                        <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#conventions-and-definitions">慣習と定義</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#early-data-in-http">HTTP
                                        における早期データ</a></li>
                                <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#supporting-early-data-in-http-servers">HTTP サーバーでの早期データのサポート</a></li>
                                <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#using-early-data-in-http-clients">HTTP クライアントでの早期データの使用</a>
                                </li>
                                <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#extensions-for-early-data-in-http">HTTP における早期データの拡張</a>
                                    <ul>
                                        <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#header">Early-Data ヘッダーフィールド</a></li>
                                        <li><a href="#rfc.section.5.2">5.2.</a>&nbsp;&nbsp;&nbsp;<a href="#status">425
                                                (Too Early) ステータスコード</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#security-considerations">セキュリティの考慮事項</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#gateways-and-early-data">ゲートウェイと早期データ</a></li>
                                        <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#be-consistent">早期データの一貫した処理</a></li>
                                        <li><a href="#rfc.section.6.3">6.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#denial-of-service">サービス拒否</a></li>
                                        <li><a href="#rfc.section.6.4">6.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#out-of-order-delivery">順序外配信</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-considerations">IANA
                                        に関する考慮事項</a></li>
                                <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">参考文献</a>
                                    <ul>
                                        <li><a href="#rfc.section.8.1">8.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.1">ノルマティブ参考文献</a></li>
                                        <li><a href="#rfc.section.8.2">8.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.2">インフォマティブ参考文献</a></li>
                                    </ul>
                                </li>
                                <li><a href="#acknowledgments">謝辞</a></li>
                                <li><a href="#rfc.authors">著者の連絡先</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8 order-first main" role="main">
                <header>
                    <table class="table table-condensed header" id="rfc.headerblock">
                        <tbody>
                            <tr>
                                <td class="text-left">インターネット技術タスクフォース (IETF)</td>
                                <td class="text-right">M. Thomson</td>
                            </tr>
                            <tr>
                                <td class="text-left">Request for Comments: 8470</td>
                                <td class="text-right">Mozilla</td>
                            </tr>
                            <tr>
                                <td class="text-left">カテゴリ: Standards Track</td>
                                <td class="text-right">M. Nottingham</td>
                            </tr>
                            <tr>
                                <td class="text-left">ISSN: 2070-1721</td>
                                <td class="text-right">Fastly</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">W. Tarreau</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">HAProxy Technologies</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">September 2018</td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="rfc.title">
                        <h1>HTTP における早期データの使用</h1>
                    </div>
                </header>
                <hr>
                <h2 id="rfc.abstract"><a href="#rfc.abstract">概要</a></h2>
                <div class="lead">
                    <div id="rfc.abstract.p.1">
                        <p>TLS の early data を使用すると、リプレイ攻撃の可能性に晒されることになります。本書は、クライアントが early data で送信された HTTP
                            リクエストについてサーバーとやり取りするための仕組みを定義します。これらの仕組みを用いてリプレイのリスクを軽減するための技術について説明します。</p>
                    </div>
                </div>
                <aside id="rfc.meta" class="alert alert-info"></aside>
                <section id="rfc.status">
                    <h2><a href="#rfc.status">このメモの状態</a></h2>
                    <div id="rfc.boilerplate.1.p.1">
                        <p>これはインターネット標準トラック文書です。</p>
                    </div>
                    <div id="rfc.boilerplate.1.p.2">
                        <p>本書はインターネット技術タスクフォース (IETF) の成果物です。IETF コミュニティの合意を示すものであり、公開審査を受け、Internet Engineering
                            Steering Group (IESG) によって公開が承認されています。インターネット標準に関するさらなる情報は <a
                                href="https://www.rfc-editor.org/rfc/rfc7841.html#section-2">RFC 7841 のセクション 2</a>
                            を参照してください。</p>
                    </div>
                    <div id="rfc.boilerplate.1.p.3">
                        <p>本書の現行の状態、訂正情報（errata）、およびフィードバックの方法については <a
                                href="https://www.rfc-editor.org/info/rfc8470">https://www.rfc-editor.org/info/rfc8470</a>
                            を参照してください。</p>
                    </div>
                </section>
                <section id="rfc.copyrightnotice">
                    <h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2>
                    <div id="rfc.boilerplate.2.p.1">
                        <p>Copyright (c) 2018 IETF Trust and the persons identified as the document authors. All rights
                            reserved.</p>
                    </div>
                    <div id="rfc.boilerplate.2.p.2">
                        <p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF
                            Documents (<a
                                href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>)
                            in effect on the date of publication of this document. Please review these documents
                            carefully, as they describe your rights and restrictions with respect to this document. Code
                            Components extracted from this document must include Simplified BSD License text as
                            described in Section 4.e of the Trust Legal Provisions and are provided without warranty as
                            described in the Simplified BSD License.</p>
                    </div>
                </section>
                <div class="toc d-lg-none">
                    <ul>
                        <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#introduction">導入</a>
                            <ul>
                                <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#conventions-and-definitions">慣習と定義</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#early-data-in-http">HTTP
                                における早期データ</a></li>
                        <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#supporting-early-data-in-http-servers">HTTP サーバーでの早期データのサポート</a>
                        </li>
                        <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#using-early-data-in-http-clients">HTTP クライアントでの早期データの使用</a></li>
                        <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#extensions-for-early-data-in-http">HTTP における早期データの拡張</a>
                            <ul>
                                <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a href="#header">Early-Data
                                        ヘッダーフィールド</a></li>
                                <li><a href="#rfc.section.5.2">5.2.</a>&nbsp;&nbsp;&nbsp;<a href="#status">425 (Too
                                        Early) ステータスコード</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#security-considerations">セキュリティに関する考慮事項</a>
                            <ul>
                                <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#gateways-and-early-data">ゲートウェイと早期データ</a></li>
                                <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#be-consistent">早期データの一貫した処理</a></li>
                                <li><a href="#rfc.section.6.3">6.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#denial-of-service">サービス拒否</a></li>
                                <li><a href="#rfc.section.6.4">6.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#out-of-order-delivery">順序外配信</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-considerations">IANA
                                に関する考慮事項</a></li>
                        <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">参考文献</a>
                            <ul>
                                <li><a href="#rfc.section.8.1">8.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.1">ノルマティブ参考文献</a></li>
                                <li><a href="#rfc.section.8.2">8.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.2">インフォマティブ参考文献</a></li>
                            </ul>
                        </li>
                        <li><a href="#acknowledgments">謝辞</a></li>
                        <li><a href="#rfc.authors">著者の連絡先</a></li>
                    </ul>
                </div>
                <section id="introduction">
                    <h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a
                            href="#introduction">導入</a></h2>
                    <div id="rfc.section.1.p.1">
                        <p>TLS 1.3 <a href="#TLS13"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS13]</cite></a>
                            は early data（ゼロラウンドトリップ（0-RTT）データとも呼ばれる）の概念を導入します。クライアントが同一のサーバーと最近やり取りしている場合、early data
                            によってクライアントは TLS ハンドシェイクの完了を待たずに接続の最初の往復でサーバーにデータを送信できます。</p>
                    </div>
                    <div id="rfc.section.1.p.2">
                        <p>HTTP と組み合わせて使用する場合 <a href="#HTTP"><cite
                                    title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">[HTTP]</cite></a>、
                            early data はクライアントがリクエストを直ちに送信できるようにし、TLS ハンドシェイクに必要な 1 回または 2
                            回の往復遅延を回避します。これは大きな性能向上ですが、重大な制約も伴います。</p>
                    </div>
                    <div id="rfc.section.1.p.3">
                        <p>early data を使用する主なリスクは、攻撃者がそれを取得して再生（replay）する可能性があることです。TLS <a href="#TLS13"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS13]</cite></a>
                            は攻撃者がリクエストの再生に成功する可能性を下げるための技術を示していますが、これらの技術は展開が難しく、依然として成功する可能性が残ることがあります。</p>
                    </div>
                    <div id="rfc.section.1.p.4">
                        <p>これは自動的またはユーザーによる再試行とは異なることに注意してください；リプレイはクライアントの知らないところで攻撃者によって開始されます。</p>
                    </div>
                    <div id="rfc.section.1.p.5">
                        <p>HTTP におけるリプレイのリスクを軽減するために、本書はサーバー側のリスク制御手法の概観を示し、クライアントが early data でリクエストを送信する際の要件を定義します。
                        </p>
                    </div>
                    <div id="rfc.section.1.p.6">
                        <p>本書の助言は、HTTP over QUIC における 0-RTT の使用（<a href="#HQ"><cite
                                    title="Hypertext Transfer Protocol (HTTP) over QUIC">[HQ]</cite></a>）にも適用されます。</p>
                    </div>
                    <section id="conventions-and-definitions">
                        <h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a>&nbsp;<a
                                href="#conventions-and-definitions">慣習と定義</a></h3>
                        <div id="rfc.section.1.1.p.1">
                            <p>本書で使われるキーワード “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD
                                NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, および “OPTIONAL” は、BCP 14 (<a
                                    href="#RFC2119"><cite
                                        title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>、
                                <a href="#RFC8174"><cite
                                        title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</cite></a>)
                                に従って、かつ示されるとおり大文字で現れる場合に限り解釈されます。
                            </p>
                        </div>
                    </section>
                </section>
                <section id="early-data-in-http">
                    <h2 id="rfc.section.2"><a href="#rfc.section.2">2.</a>&nbsp;<a href="#early-data-in-http">HTTP
                            における早期データ</a></h2>
                    <div id="rfc.section.2.p.1">
                        <p>概念的には、early data は他のアプリケーションデータと連結されて単一のストリームを形成します。これにより、リクエスト全体が early data
                            に含まれる場合もあれば、リクエストの一部だけが early data である場合もあります。HTTP/2 <a href="#RFC7540"><cite
                                    title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a> や
                            HTTP/QUIC <a href="#HQ"><cite
                                    title="Hypertext Transfer Protocol (HTTP) over QUIC">[HQ]</cite></a>
                            のような多重化プロトコルでは、複数のリクエストが部分的に early data で配信されることがありえます。</p>
                    </div>
                    <div id="rfc.section.2.p.2">
                        <p>本書が想定するモデルでは、TLS ハンドシェイクが完了した後、その TLS 接続で受信された early data
                            はその接続上で再生されたコピーではないことが分かる、という扱いです。しかし、これは early data が別の接続で再生されないことを意味するものではない点に注意が必要です。</p>
                    </div>
                </section>
                <section id="supporting-early-data-in-http-servers">
                    <h2 id="rfc.section.3"><a href="#rfc.section.3">3.</a>&nbsp;<a
                            href="#supporting-early-data-in-http-servers">HTTP サーバーでの早期データのサポート</a></h2>
                    <div id="rfc.section.3.p.1">
                        <p>サーバーは TLS セッションチケットを送る際に、将来の接続でクライアントが early data を送信できるようにするかどうかを決定します。</p>
                    </div>
                    <div id="rfc.section.3.p.2">
                        <p>TLS <a href="#TLS13"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS13]</cite></a>
                            は、攻撃者が early data
                            を再生して成功させる能力を低減する再生検出戦略の使用を義務付けています。これらの対再生技術はリプレイの可能性を減らしますが完全には排除せず、かつ再生回数に上限を設けます。</p>
                    </div>
                    <div id="rfc.section.3.p.3" class="avoidbreakafter">
                        <p>サーバーが early data を有効にする場合、リプレイのリスクを軽減するために利用できるいくつかの技術があります：</p>
                    </div>
                    <div id="rfc.section.3.p.4">
                        <ol>
                            <li>サーバーは TLS レイヤーで early data を拒否することができます。サーバーは early data を選択的に拒否できないため、これを行うと early data
                                で送信されたすべてのリクエストが破棄されます。</li>
                            <li>サーバーは early data の処理を TLS
                                ハンドシェイク完了まで遅延させる選択ができます。処理を遅らせることで、接続が正常に完了した場合にのみその接続上のリクエストを使用するという保証を得られます。複数のリクエストが
                                early data に含まれる場合、サーバーはリクエストごとに HTTP 処理を遅らせるかどうかを決められます。</li>
                            <li>サーバーはリプレイのリスクが高いと判断した場合、個々のリクエストに対して 425 (Too Early) ステータスコード（<a href="#status"
                                    title="The 425 (Too Early) Status Code">Section 5.2</a>）でクライアントに再試行させ、early data
                                を使わせないようにすることができます。</li>
                        </ol>
                    </div>
                    <div id="rfc.section.3.p.5">
                        <p>これらの技術はいずれも同等に有効であり、サーバーは自分に最も適した方法を用いることができます。</p>
                    </div>
                    <div id="rfc.section.3.p.6">
                        <p>特定のリクエストに対するリプレイリスクへの許容度は、そのリクエストが操作するリソースに依存し（したがって起源サーバーだけが知り得る）、複製されたリクエストの処理が重複した効果や副作用をもたらす点が主たるリスクです。<a
                                href="https://www.rfc-editor.org/rfc/rfc8446.html#appendix-E.5">Appendix E.5</a>（<a
                                href="#TLS13"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS13]</cite></a>）も、複製リクエストの処理で生じる他の影響を記述しています。
                        </p>
                    </div>
                    <div id="rfc.section.3.p.7">
                        <p>リクエストメソッドの安全性（<a href="#RFC7231"><cite
                                    title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a>,
                            <a href="https://www.rfc-editor.org/rfc/rfc7231.html#section-4.2.1">Section
                                4.2.1</a>）は、判断の一助となります。ただし、安全と見なされるメソッドでも一部のリソースは副作用を生むため、これだけに全面的に依存できるわけではありません。
                        </p>
                    </div>
                    <div id="rfc.section.3.p.8">
                        <p>起源サーバーは、リソースがリクエストにおける early data の使用に適するかどうかを明示的に設定できるようにすることが推奨されます。こうした明示的情報がない場合、起源サーバーは
                            early data を拒否するか、本書で述べる TLS ハンドシェイク完了前のリクエスト処理を防ぐ技術を実装しなければなりません。</p>
                    </div>
                    <div id="rfc.section.3.p.9">
                        <p>リクエストの一部が early data
                            で送信され、残りがハンドシェイク完了後に送信されることがあります。これは必ずしもそのリクエストの扱いに影響しません；重要なのはサーバーがいつリクエストの内容に基づいて動作を開始するかです。いかなる時点でも、任意のサーバーインスタンスがハンドシェイク完了前に処理を開始する可能性がある場合、すべてのサーバーインスタンスは
                            early data の再生が処理にどのように影響するかを考慮する必要があります（<a href="#be-consistent"
                                title="Consistent Handling of Early Data">Section 6.2</a> も参照）。</p>
                    </div>
                    <div id="rfc.section.3.p.10">
                        <p>不完全なリクエストをサーバーが部分的に処理することは可能です。ヘッダーフィールドの解析（値に基づいて行動することなく）やリクエストのルーティング決定は副作用のない比較的安全な処理ですが、その他の動作はそうではないかもしれません。
                        </p>
                    </div>
                    <div id="rfc.section.3.p.11">
                        <p>中継サーバー（インターミディアリ）は early data を処理できるかどうかを決めるための十分な情報を持たないことが多いため、<a href="#status"
                                title="The 425 (Too Early) Status Code">Section 5.2</a> は起源からのシグナリング方法を記述しています。early
                            data を受け入れる中継サーバーはそのメカニズムを実装しなければなりません。</p>
                    </div>
                    <div id="rfc.section.3.p.12">
                        <p>サーバーは TLS レイヤーで early data を選択的に拒否できないことに注意してください。TLS はサーバーに対して early data
                            をすべて受け入れるか全く受け入れないかのどちらかしか許しません。サーバーが early data の受け入れを決めた場合、たとえサーバーがリクエストを 425 (Too Early)
                            で拒否したとしても、early data 内のすべてのリクエストは受信扱いとなります。</p>
                    </div>
                    <div id="rfc.section.3.p.13">
                        <p>サーバーは TLS 拡張の <span class="tt">early_data</span> の <span
                                class="tt">max_early_data_size</span> フィールドで early data
                            の量を制限できます。これはハンドシェイク完了まで延期する可能性のあるリクエストのために任意の量のメモリを確保するのを避けるために役立ちます。</p>
                    </div>
                </section>
                <section id="using-early-data-in-http-clients">
                    <h2 id="rfc.section.4"><a href="#rfc.section.4">4.</a>&nbsp;<a
                            href="#using-early-data-in-http-clients">HTTP クライアントでの早期データの使用</a></h2>
                    <div id="rfc.section.4.p.1">
                        <p>early data を使用したいクライアントは、TLS ClientHello を送信した直後に HTTP リクエストを送ることから開始します。</p>
                    </div>
                    <div id="rfc.section.4.p.2">
                        <p>本質的に、クライアントは特定のリクエストを early data で送るかどうかを制御できるため、リプレイリスクの管理をクライアント側で行えます。追加情報がない場合、クライアントは
                            early data が利用可能な場合に安全な HTTP メソッド（<a href="#RFC7231"><cite
                                    title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a>,
                            <a href="https://www.rfc-editor.org/rfc/rfc7231.html#section-4.2.1">Section
                                4.2.1</a>）のリクエストを early data で送信してもよい（MAY）ですが、安全でないメソッド（または安全性が不明なメソッド）は early data
                            で送信してはなりません（MUST NOT）。
                        </p>
                    </div>
                    <div id="rfc.section.4.p.3">
                        <p>サーバーが TLS レイヤーで early data を拒否した場合、クライアントは接続が新規であるかのように再送を開始しなければなりません。これは、early data
                            に楽観的に使用したプロトコル（例えば ALPN によるネゴシエーションで選んだもの）とは異なるプロトコルを用いることを含む可能性があります。early data
                            で送ったリクエストは、クライアントが放棄しない限り再度送信する必要があります。</p>
                    </div>
                    <div id="rfc.section.4.p.4">
                        <p>自動再試行はリプレイ攻撃の可能性を生みます。攻撃者が early data を使う接続を傍受して early data を別のサーバーインスタンスにコピーすると、第二のインスタンスは
                            early data を受け入れて処理しうる一方で TLS ハンドシェイクは完了しません。その後攻撃者が元の接続を完了させると、元の接続のインスタンスが early data
                            を重複として検出して拒否したとしても、クライアントが early data 内で送ったリクエストを再送するとリクエストは二重に処理されることになります。</p>
                    </div>
                    <div id="rfc.section.4.p.5">
                        <p>複数のサーバーインスタンスが early data を受け入れる場合や、同じサーバーが複数回 early data を受け入れる場合にもリプレイは発生し得ます（後者は <a
                                href="https://www.rfc-editor.org/rfc/rfc8446.html#section-8">TLS13 Section 8</a>
                            の要件に反する行為です）。</p>
                    </div>
                    <div id="rfc.section.4.p.6">
                        <p>early data を使用するクライアントは 425 (Too Early) ステータスコードを受け取った場合、リクエストを再試行しなければなりません（MUST）；詳細は <a
                                href="#status" title="The 425 (Too Early) Status Code">Section 5.2</a> を参照してください。</p>
                    </div>
                    <div id="rfc.section.4.p.7">
                        <p>中継サーバーは、前のホップで early data
                            が使われた場合、またはリクエストを安全に再試行できることが確実に分かっている（通常はアウトオブバンド設定を用いる場合）場合を除き、リクエストの転送に early data
                            を使用してはなりません。十分な情報がない場合、中継サーバーはリクエストが early data で到着したか、あるいは Early-Data ヘッダーフィールドが “1”
                            に設定されている場合にのみ early data を使用できます（<a href="#header"
                                title="The Early-Data Header Field">Section 5.1</a> 参照）。</p>
                    </div>
                </section>
                <section id="extensions-for-early-data-in-http">
                    <h2 id="rfc.section.5"><a href="#rfc.section.5">5.</a>&nbsp;<a
                            href="#extensions-for-early-data-in-http">HTTP における早期データの拡張</a></h2>
                    <div id="rfc.section.5.p.1">
                        <p>HTTP リクエストは複数の「ホップ」に渡ることがあるため、あるリクエストが前のホップで early data として送信されたかどうかを明示的に伝える必要があります。同様に、early
                            data が望ましくない場合に明示的に再試行を引き起こす手段も必要です。最後に、クライアントが実際に再試行を行うかどうかを知る手段も必要です。</p>
                    </div>
                    <div id="rfc.section.5.p.2" class="avoidbreakafter">
                        <p>これらの要件を満たすために、二つのシグナリング機構を定義します：</p>
                    </div>
                    <div id="rfc.section.5.p.3">
                        <ul>
                            <li>Early-Data ヘッダーフィールドは、中継がクライアントとの TLS ハンドシェイク完了前にリクエストを転送した可能性があることを示すためにリクエストに含められます。
                            </li>
                            <li>425 (Too Early) ステータスコードは、サーバーが再生の結果として発生しうる影響のためリクエストを処理できないことを示すために定義されます。</li>
                        </ul>
                    </div>
                    <div id="rfc.section.5.p.4">
                        <p>これらはユーザーエージェントと起源サーバー、さらにゲートウェイ（リバースプロキシ、CDN、サロゲート等）が存在する場合の早期データ利用の調整を可能にするよう設計されています。</p>
                    </div>
                    <div id="rfc.section.5.p.5">
                        <p>ゲートウェイは一般に、特定のリクエストが early data
                            で安全に処理できるかどうかについての具体的な情報を持ちません。多くの場合、リプレイの許容性を判断できるのは起源サーバーだけです。これらの拡張は、ゲートウェイと起源サーバー間の調整を可能にします。
                        </p>
                    </div>
                    <section id="header">
                        <h3 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a>&nbsp;<a href="#header">Early-Data
                                ヘッダーフィールド</a></h3>
                        <div id="rfc.section.5.1.p.1">
                            <p>Early-Data リクエストヘッダーフィールドは、そのリクエストが early data で伝えられたことおよびクライアントが 425 (Too Early)
                                ステータスコードを理解していることを示します。</p>
                        </div>
                        <div id="rfc.section.5.1.p.2" class="avoidbreakafter">
                            <p>許容される値は “1” のみです。構文は次の ABNF により定義されます <a href="#ABNF"><cite
                                        title="Augmented BNF for Syntax Specifications: ABNF">[ABNF]</cite></a>：</p>
                        </div>
                        <div id="rfc.figure.u.1">
                            <div>
                                <pre class="inline prettyprint lang-ietf_abnf">
Early-Data = "1"
</pre>
                            </div>
                        </div>
                        <div id="rfc.section.5.1.p.3" class="avoidbreakafter">
                            <p>例えば：</p>
                        </div>
                        <div id="rfc.figure.u.2">
                            <div>
                                <pre class="text">
GET /resource HTTP/1.0
Host: example.com
Early-Data: 1

</pre>
                            </div>
                        </div>
                        <div id="rfc.section.5.1.p.4">
                            <p>クライアントとの TLS ハンドシェイク完了前にリクエストを転送する中継は、そのリクエストを Early-Data ヘッダーフィールドを “1”
                                に設定して送信しなければなりません（リクエストに存在しない場合は追加する）。中継は、リクエストが再生に晒され得て、それが自インスタンスあるいは他のインスタンスによって既に転送されている可能性がある場合に
                                Early-Data ヘッダーフィールドを使用しなければなりません（<a href="#be-consistent"
                                    title="Consistent Handling of Early Data">Section 6.2</a> を参照）。</p>
                        </div>
                        <div id="rfc.section.5.1.p.5">
                            <p>中継はリクエストにこのヘッダーフィールドが存在する場合にそれを削除してはなりません。Early-Data は Connection ヘッダーフィールドに現れてはなりません。
                            </p>
                        </div>
                        <div id="rfc.section.5.1.p.6">
                            <p>Early-Data ヘッダーフィールドはユーザーエージェント（リクエストの元の起動者）による使用を意図したものではありません。リクエストを early data
                                で送ることはクライアントが本仕様を理解し、425 を受けた場合に再試行する用意があることを意味します。early data でリクエストを送るユーザーエージェントは
                                Early-Data ヘッダーフィールドを含める必要はありません。</p>
                        </div>
                        <div id="rfc.section.5.1.p.7">
                            <p>サーバーは Early-Data
                                ヘッダーフィールドを含むリクエストを、ハンドシェイク完了を待って安全に処理できるようにしても、そのリクエストを安全に処理できるとは言えません。Early-Data
                                でマークされたリクエストは前のホップで early data として送信されたものです。Early-Data を含み安全に処理できないリクエストは 425 (Too
                                Early) で拒否しなければなりません。</p>
                        </div>
                        <div id="rfc.section.5.1.p.8">
                            <p>Early-Data ヘッダーフィールドは 1 ビットの情報のみを運ぶため、クライアントは最大でも一つだけ含める必要があります。複数または無効なインスタンスは、サーバーによって値
                                1 の単一インスタンスと同等として扱われなければなりません。</p>
                        </div>
                        <div id="rfc.section.5.1.p.9">
                            <p>Early-Data ヘッダーフィールドはレスポンスやリクエストトレーラーに含めてはなりません。</p>
                        </div>
                    </section>
                    <section id="status">
                        <h3 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a>&nbsp;<a href="#status">425 (Too
                                Early) ステータスコード</a></h3>
                        <div id="rfc.section.5.2.p.1">
                            <p>425 (Too Early) は、サーバーが再生される可能性のあるリクエストを処理するリスクを避けるために処理を拒否することを示します。</p>
                        </div>
                        <div id="rfc.section.5.2.p.2">
                            <p>early data でリクエストを送ったユーザーエージェントは、425 (Too Early)
                                の応答ステータスを受け取った場合にそのリクエストを再試行することが期待されます。ユーザーエージェントは自動で再試行することが望ましい（SHOULD）ですが、再試行は early
                                data では送信してはなりません（MUST NOT）。</p>
                        </div>
                        <div id="rfc.section.5.2.p.3">
                            <p>あらゆる場合において、中継サーバーは 425 を転送できます。中継は、受け取って転送したリクエストに Early-Data ヘッダーフィールドが含まれていた場合、425
                                を転送しなければなりません。その他の場合で中継が early data で受け取ったリクエストに対して 425
                                を受け取った場合、中継はそのリクエストを自動的に再試行してもよい（MAY）ですが、受信した接続上で TLS ハンドシェイクの完了を待たなければなりません（MUST）。</p>
                        </div>
                        <div id="rfc.section.5.2.p.4">
                            <p>サーバーは、クライアントが再試行可能であると仮定できるのはそのリクエストが early data で受け取られた場合か Early-Data ヘッダーフィールドが “1”
                                に設定されている場合に限られます。これらの条件が満たされない限り、サーバーは 425 を発行すべきではありません（SHOULD NOT）。</p>
                        </div>
                        <div id="rfc.section.5.2.p.5">
                            <p>425 (Too Early) はデフォルトでキャッシュ可能ではありません。そのペイロードは特定されたリソースの表現ではありません。</p>
                        </div>
                    </section>
                </section>
                <section id="security-considerations">
                    <h2 id="rfc.section.6"><a href="#rfc.section.6">6.</a>&nbsp;<a
                            href="#security-considerations">セキュリティに関する考慮事項</a></h2>
                    <div id="rfc.section.6.p.1">
                        <p>early data
                            を使用すると、クライアントはリクエストが再生されるリスクに晒されます。再試行または再生されたリクエストはサーバー上で異なる副作用を生むことがあります。これらの副作用に加え、リプレイや再試行はトラフィック解析によりリクエストやその対象リソースに関する情報を回復するために利用される可能性があります。特に、再生されたリクエストが異なるレスポンスを生み、その長さから保護されたデータの長さが観測されうる点に注意が必要です。
                        </p>
                    </div>
                    <section id="gateways-and-early-data">
                        <h3 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a>&nbsp;<a
                                href="#gateways-and-early-data">ゲートウェイと早期データ</a></h3>
                        <div id="rfc.section.6.1.p.1">
                            <p>ゲートウェイは、起源サーバーが Early-Data ヘッダーフィールドを理解し正しく 425 を生成することが分かっている場合に限り、early data
                                で受け取ったリクエストを転送してよい（MUST NOT であるべき）。起源サーバーのサポートが不確かな場合、ゲートウェイはクライアントとの TLS
                                ハンドシェイク完了まで転送を遅延するか、425 を返すべきです（SHOULD）。</p>
                        </div>
                        <div id="rfc.section.6.1.p.2">
                            <p>少なくとも一つの起源サーバーが Early-Data をサポートしていない場合、ゲートウェイが early data を有効にしても得られる性能上の利益は限定的であり、early
                                data を完全に無効にする方が効率的です。</p>
                        </div>
                    </section>
                    <section id="be-consistent">
                        <h3 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a>&nbsp;<a
                                href="#be-consistent">早期データの一貫した処理</a></h3>
                        <div id="rfc.section.6.2.p.1">
                            <p>early data で到着した、あるいは部分的に early data で到着したリクエストを一貫して扱うことは、再生されたリクエストの不適切な処理を避ける上で重要です。TLS
                                ハンドシェイク完了前に安全に処理できないリクエストであれば、すべてのサーバーインスタンス（ゲートウェイを含む）が合意して処理を遅延するか拒否する必要があります。</p>
                        </div>
                        <div id="rfc.section.6.2.p.2">
                            <p>early data を無効化する、リクエストを遅延させる、あるいは 425
                                で拒否することはいずれもリプレイ攻撃を緩和するための有効な措置です。サーバーインスタンスは異なる手段を実装しても一貫した対策と見なされ得ます。重要なのは、サーバー負荷などの条件に応じて異なる緩和策を採用できる点です。
                            </p>
                        </div>
                        <div id="rfc.section.6.2.p.3">
                            <p>サーバーは、もし自身および他のサーバーインスタンスが同一のデータに対して異なる扱いをする可能性があるならば、ハンドシェイクが完了する前に early data
                                に基づいて行動してはなりません（MUST NOT）。</p>
                        </div>
                    </section>
                    <section id="denial-of-service">
                        <h3 id="rfc.section.6.3"><a href="#rfc.section.6.3">6.3.</a>&nbsp;<a
                                href="#denial-of-service">サービス拒否</a></h3>
                        <div id="rfc.section.6.3.p.1">
                            <p>early data を受け入れることは、処理コストの高いリクエストの再生によるサービス拒否攻撃のリスクをサーバーに課します。サーバーが負荷状態にある場合は、early data
                                全体の拒否を優先する（早期データを受け入れず TLS early data を拒否する）べきです。503（Service Unavailable）や 425
                                を生成するとクライアントが再試行するため、負荷が増す可能性がある点にも注意が必要です。</p>
                        </div>
                    </section>
                    <section id="out-of-order-delivery">
                        <h3 id="rfc.section.6.4"><a href="#rfc.section.6.4">6.4.</a>&nbsp;<a
                                href="#out-of-order-delivery">順序外配信</a></h3>
                        <div id="rfc.section.6.4.p.1">
                            <p>QUIC のような順序外配信を行うプロトコルでは、early data
                                がハンドシェイク完了後に到着することがあります。サーバーは、他のインスタンスが同じリクエストの再生を正しく扱うことを信頼できる場合に限り、ハンドシェイク完了後に early
                                data で受け取ったリクエストを処理してもよい（MAY）です。</p>
                        </div>
                    </section>
                </section>
                <section id="iana-considerations">
                    <h2 id="rfc.section.7"><a href="#rfc.section.7">7.</a>&nbsp;<a href="#iana-considerations">IANA
                            に関する考慮事項</a></h2>
                    <div id="rfc.section.7.p.1">
                        <p>本書は Early-Data ヘッダーフィールドを “Permanent Message Header Field Names” レジストリ（&lt;<a
                                href="https://www.iana.org/assignments/message-headers">https://www.iana.org/assignments/message-headers</a>&gt;）に登録します。
                        </p>
                    </div>
                    <div id="rfc.section.7.p.2">
                        <dl class="compact">
                            <dt>Header field name:</dt>
                            <dd>Early-Data</dd>
                            <dt>Applicable protocol:</dt>
                            <dd>http</dd>
                            <dt>Status:</dt>
                            <dd>standard</dd>
                            <dt>Author/Change controller:</dt>
                            <dd>IETF</dd>
                            <dt>Specification document(s):</dt>
                            <dd>This document</dd>
                            <dt>Related information:</dt>
                            <dd>(empty)</dd>
                        </dl>
                    </div>
                    <div id="rfc.section.7.p.3">
                        <p>本書は 425 (Too Early) ステータスコードを “HTTP Status Codes” レジストリ（&lt;<a
                                href="https://www.iana.org/assignments/http-status-codes">https://www.iana.org/assignments/http-status-codes</a>&gt;）に登録します。
                        </p>
                    </div>
                    <div id="rfc.section.7.p.4">
                        <dl class="compact">
                            <dt>Value:</dt>
                            <dd>425</dd>
                            <dt>Description:</dt>
                            <dd>Too Early</dd>
                            <dt>Reference:</dt>
                            <dd>This document</dd>
                        </dl>
                    </div>
                </section>
                <section id="rfc.references">
                    <h2 id="rfc.section.8"><a href="#rfc.section.8">8.</a> 参考文献</h2>
                    <section>
                        <div id="rfc.references.1">
                            <h3 id="rfc.section.8.1"><a href="#rfc.section.8.1">8.1.</a> ノルマティブ参考文献</h3>
                            <dl class="dl-horizontal">
                                <dt id="ABNF">[<a href="#ABNF" class="smpl">ABNF</a>]</dt>
                                <dd>Crocker, D., Ed. and P. Overell, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc5234.html">Augmented BNF for Syntax
                                        Specifications: ABNF</a>”, <a href="https://www.rfc-editor.org/info/std68">STD
                                        68</a>, RFC 5234, <a href="https://dx.doi.org/10.17487/RFC5234">DOI
                                        10.17487/RFC5234</a>, January 2008, &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;.
                                </dd>
                                <dt id="HTTP">[<a href="#HTTP" class="smpl">HTTP</a>]</dt>
                                <dd>Fielding, R., Ed. and J. Reschke, Ed., “<a
                                        href="https://www.rfc-editor.org/rfc/rfc7230.html">Hypertext Transfer Protocol
                                        (HTTP/1.1): Message Syntax and Routing</a>”, RFC 7230, <a
                                        href="https://dx.doi.org/10.17487/RFC7230">DOI 10.17487/RFC7230</a>, June 2014,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;.
                                </dd>
                                <dt id="RFC2119">[<a href="#RFC2119" class="smpl">RFC2119</a>]</dt>
                                <dd>Bradner, S., “<a href="https://www.rfc-editor.org/rfc/rfc2119.html">Key words for
                                        use in RFCs to Indicate Requirement Levels</a>”, <a
                                        href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 2119, <a
                                        href="https://dx.doi.org/10.17487/RFC2119">DOI 10.17487/RFC2119</a>, March 1997,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.
                                </dd>
                                <dt id="RFC7231">[<a href="#RFC7231" class="smpl">RFC7231</a>]</dt>
                                <dd>Fielding, R., Ed. and J. Reschke, Ed., “<a
                                        href="https://www.rfc-editor.org/rfc/rfc7231.html">Hypertext Transfer Protocol
                                        (HTTP/1.1): Semantics and Content</a>”, RFC 7231, <a
                                        href="https://dx.doi.org/10.17487/RFC7231">DOI 10.17487/RFC7231</a>, June 2014,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;.
                                </dd>
                                <dt id="RFC8174">[<a href="#RFC8174" class="smpl">RFC8174</a>]</dt>
                                <dd>Leiba, B., “<a href="https://www.rfc-editor.org/rfc/rfc8174.html">Ambiguity of
                                        Uppercase vs Lowercase in RFC 2119 Key Words</a>”, <a
                                        href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 8174, <a
                                        href="https://dx.doi.org/10.17487/RFC8174">DOI 10.17487/RFC8174</a>, May 2017,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.
                                </dd>
                                <dt id="TLS13">[<a href="#TLS13" class="smpl">TLS13</a>]</dt>
                                <dd>Rescorla, E., “<a href="https://www.rfc-editor.org/rfc/rfc8446.html">The Transport
                                        Layer Security (TLS) Protocol Version 1.3</a>”, RFC 8446, <a
                                        href="https://dx.doi.org/10.17487/RFC8446">DOI 10.17487/RFC8446</a>, August
                                    2018, &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;.
                                </dd>
                            </dl>
                        </div>
                    </section>
                    <section>
                        <div id="rfc.references.2">
                            <h3 id="rfc.section.8.2"><a href="#rfc.section.8.2">8.2.</a> インフォマティブ参考文献</h3>
                            <dl class="dl-horizontal">
                                <dt id="ALPN">[<a href="#ALPN" class="smpl">ALPN</a>]</dt>
                                <dd>Friedl, S., Popov, A., Langley, A., and E. Stephan, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc7301.html">Transport Layer Security
                                        (TLS) Application-Layer Protocol Negotiation Extension</a>”, RFC 7301, <a
                                        href="https://dx.doi.org/10.17487/RFC7301">DOI 10.17487/RFC7301</a>, July 2014,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc7301">https://www.rfc-editor.org/info/rfc7301</a>&gt;.
                                </dd>
                                <dt id="HQ">[<a href="#HQ" class="smpl">HQ</a>]</dt>
                                <dd>Bishop, M., “<a
                                        href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-http-14">Hypertext
                                        Transfer Protocol (HTTP) over QUIC</a>”, <a
                                        href="https://datatracker.ietf.org/doc/draft-ietf-quic-http">Work in
                                        Progress</a>, draft-ietf-quic-http-14, August 2018.</dd>
                                <dt id="RFC7540">[<a href="#RFC7540" class="smpl">RFC7540</a>]</dt>
                                <dd>Belshe, M., Peon, R., and M. Thomson, Ed., “<a
                                        href="https://www.rfc-editor.org/rfc/rfc7540.html">Hypertext Transfer Protocol
                                        Version 2 (HTTP/2)</a>”, RFC 7540, <a
                                        href="https://dx.doi.org/10.17487/RFC7540">DOI 10.17487/RFC7540</a>, May 2015,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;.
                                </dd>
                            </dl>
                        </div>
                    </section>
                </section>
                <section id="acknowledgments">
                    <h2 id="rfc.section.unnumbered-1"><a href="#acknowledgments">謝辞</a></h2>
                    <div id="rfc.section.unnumbered-1.p.1">
                        <p>本書の作成は容易ではありませんでした。以下の人々は文書の品質と完全性に多大な貢献をしました：David Benjamin, Subodh Iyengar, Benjamin Kaduk,
                            Ilari Liusavaara, Kazuho Oku, Eric Rescorla, Kyle Rose, Victor Vasiliev。</p>
                    </div>
                </section>
                <section id="rfc.authors" class="avoidbreakinside">
                    <h2><a href="#rfc.authors">著者の連絡先</a></h2>
                    <address><b>Martin Thomson</b><br>Mozilla<br>EMail: <a
                            href="mailto:martin.thomson@gmail.com">martin.thomson@gmail.com</a></address>
                    <address><b>Mark Nottingham</b><br>Fastly<br>EMail: <a href="mailto:mnot@mnot.net">mnot@mnot.net</a>
                    </address>
                    <address><b>Willy Tarreau</b><br>HAProxy Technologies<br>EMail: <a
                            href="mailto:willy@haproxy.org">willy@haproxy.org</a></address>
                </section>
            </div>
        </div>
    </div>
    <script src="https://httpwg.org/assets/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="https://httpwg.org/assets/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="https://htmlspecs.com/dropdown.js"></script>
</body>

</html>