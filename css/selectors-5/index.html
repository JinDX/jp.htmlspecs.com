<!doctype html>
<html lang="ja-JP">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>セレクター レベル 5</title>
    <meta content="FPWD" name="w3c-status">
    <!-- <meta content="Bikeshed version b25686b9f, updated Fri Mar 14 14:15:20 2025 -0700" name="generator"> -->
    <link href="https://www.w3.org/TR/selectors-5/" rel="canonical">
    <!-- <meta content="aeb01368e528fad2cd6f708300ab31cb7eacf434" name="revision"> -->
    <meta content="dark light" name="color-scheme">
    <style>
        /* Boilerplate: style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-colors */
        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* Boilerplate: style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-selflinks */
        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* Boilerplate: style-wpt */
        :root {
            --wpt-border: hsl(0, 0%, 60%);
            --wpt-bg: hsl(0, 0%, 95%);
            --wpt-text: var(--text);
            --wptheading-text: hsl(0, 0%, 30%);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --wpt-border: hsl(0, 0%, 30%);
                --wpt-bg: var(--borderedblock-bg);
                --wpt-text: var(--text);
                --wptheading-text: hsl(0, 0%, 60%);
            }
        }

        .wpt-tests-block {
            list-style: none;
            border-left: .5em solid var(--wpt-border);
            background: var(--wpt-bg);
            color: var(--wpt-text);
            margin: 1em auto;
            padding: .5em;
        }

        .wpt-tests-block summary {
            color: var(--wptheading-text);
            font-weight: normal;
            text-transform: uppercase;
        }

        .wpt-tests-block summary::marker {
            color: var(--wpt-border);
        }

        .wpt-tests-block summary:hover::marker {
            color: var(--wpt-text);
        }

        /*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
        .wpt-tests-block:not([open]) {
            padding: 0;
            border: none;
            background: none;
            font-size: 0.75em;
            line-height: 1;
            position: relative;
            margin: 1em 0 0;
        }

        .wpt-tests-block:not([open]) summary {
            position: absolute;
            right: 0;
            bottom: 0;
        }

        /*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
        .wpt-tests-block:not([open]):last-child {
            padding-bottom: 1px;
            margin-bottom: -1px;
        }

        /*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
        li:not(:last-child)>.wpt-tests-block:not([open]):last-child,
        dd:not(:last-child)>.wpt-tests-block:not([open]):last-child {
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .wpt-tests-block:not([open]):not(:hover) {
            opacity: 0.5;
        }

        .wpt-tests-list {
            list-style: none;
            display: grid;
            margin: 0;
            padding: 0;
            grid-template-columns: 1fr max-content auto auto;
            grid-column-gap: .5em;
        }

        .wpt-tests-block hr:last-child {
            display: none;
        }

        .wpt-test {
            display: contents;
        }

        .wpt-test>a {
            text-decoration: underline;
            border: none;
        }

        .wpt-test>.wpt-name {
            grid-column: 1;
        }

        .wpt-test>.wpt-results {
            grid-column: 2;
        }

        .wpt-test>.wpt-live {
            grid-column: 3;
        }

        .wpt-test>.wpt-source {
            grid-column: 4;
        }

        .wpt-test>.wpt-results {
            display: flex;
            gap: .1em;
        }

        .wpt-test .wpt-result {
            display: inline-block;
            height: 1em;
            width: 1em;
            border-radius: 50%;
            position: relative;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">
    <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet"
        type="text/css">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">セレクター レベル 5</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types/#FPWD">W3C 最初の公開ワーキングドラフト</a>, <time
                class="dt-updated" datetime="2026-02-17">2026年2月17日</time></p>
        <details open>
            <summary>この文書の詳細</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>このバージョン:
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2026/WD-selectors-5-20260217/">https://www.w3.org/TR/2026/WD-selectors-5-20260217/</a>
                    <dt>最新の公開版:
                    <dd><a href="https://www.w3.org/TR/selectors-5/">https://www.w3.org/TR/selectors-5/</a>
                    <dt>編集者草案:
                    <dd><a href="https://drafts.csswg.org/selectors-5/">https://drafts.csswg.org/selectors-5/</a>
                    <dt>履歴:
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/selectors-5/">https://www.w3.org/standards/history/selectors-5/</a>
                    <dt>フィードバック:
                    <dd><a href="https://github.com/w3c/csswg-drafts/labels/selectors-5">CSSWG 課題リポジトリ</a>
                    <dd><a href="#issues-index">仕様内（インライン）</a>
                    <dt class="editor">編集者:
                    <dd class="editor p-author h-card vcard" data-editor-id="35400"><a class="p-name fn u-url url"
                            href="http://fantasai.inkedblade.net/contact">Elika J. Etemad / fantasai</a>（<span
                            class="p-org org">Apple</span>）
                    <dd class="editor p-author h-card vcard" data-editor-id="42199"><a class="p-name fn u-url url"
                            href="http://xanthir.com/contact/">Tab Atkins Jr.</a>（<span class="p-org org">Google</span>）
                    <dt>本仕様の編集提案:
                    <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/selectors-5/Overview.bs">GitHub
                            Editor</a>
                    <dt>差分仕様:
                    <dd>はい
                    <dt>テストスイート:
                    <dd class="wpt-overview"><a
                            href="https://wpt.fyi/results/css/selectors/">https://wpt.fyi/results/css/selectors/</a>
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> ©
            2026 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr
                title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a
                href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/copyright/software-license/" rel="license"
                title="W3C Software and Document License">permissive document license</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">概要</span></h2>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#selector"
                id="ref-for-selector">セレクター</a>は、ツリー内の要素に対して照合するパターンであり、そのため文書内のノードを選択するために使用できる複数の技術の一つを構成します。セレクターは
            HTML と XML での利用に最適化されており、性能が重要となるコード内でも利用可能であるよう設計されています。セレクターは <abbr
                title="Cascading Style Sheets">CSS</abbr>（Cascading Style
            Sheets）の中核的な構成要素であり、文書内の要素にスタイルプロパティを結び付けるためにセレクターを用います。
            セレクター レベル 5 は、<a data-link-type="biblio" href="#biblio-selectors-4"
                title="Selectors Level 4">[selectors-4]</a> に既に存在するセレクターを記述し、さらに CSS
            およびそれを必要とする可能性のある他の言語のための新しいセレクターを導入します。</p>
        <a href="https://www.w3.org/TR/CSS/">CSS</a> は、構造化文書（HTML や XML など）のレンダリングを記述するための言語であり、
        画面上、紙面上などで表示するために用いられます。
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">この文書のステータス</span></h2>
    <div data-fill-with="status">
        <p><em>この節では、この文書が公開された時点での状態について説明します。
                現在の W3C 公開文書の一覧と
                この技術報告書の最新改訂版は、
                <a href="https://www.w3.org/TR/">W3C standards and drafts index.</a> にて参照できます。</em> </p>
        <p> この文書は
            <a href="https://www.w3.org/groups/wg/css">CSS Working Group</a> により、
            <a href="https://www.w3.org/policies/process/20250818/#recs-and-notes">勧告トラック</a>
            を用いた <strong>最初の公開ワーキングドラフト</strong> として公開されました。
            最初の公開ワーキングドラフトとしての公開は、
            <abbr title="World Wide Web Consortium">W3C</abbr> およびその会員による承認を意味するものではありません。
        </p>
        <p> これは草案文書であり、
            いつでも更新、置換、
            または他の文書により廃止される可能性があります。
            進行中の作業以外のものとしてこの文書を引用することは不適切です。 </p>
        <p>フィードバックは、
            （推奨）<a href="https://github.com/w3c/csswg-drafts/issues">GitHub で issue を提出</a>してお送りください。
            タイトルには仕様コード “selectors” を含め、次のようにしてください:
            “[selectors] <i>…コメントの要約…</i>”。
            すべての issue とコメントは <a href="https://lists.w3.org/Archives/Public/public-css-archive/">保存</a> されます。
            代替として、（<a href="https://lists.w3.org/Archives/Public/www-style/">保存</a>されている）公開メーリングリスト <a
                href="mailto:www-style@w3.org?Subject=%5Bselectors%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>
            にフィードバックを送ることもできます。 </p>
        <p>この文書は、<a href="https://www.w3.org/policies/process/20250818/" id="w3c_process_revision">2025年8月18日 W3C
                Process Document</a> により管理されます。 </p>
        <p>この文書は、<a href="https://www.w3.org/policies/patent-policy/20200915/">W3C 特許ポリシー</a>の下で運用されるグループにより作成されました。
            W3C は、このグループの成果物に関連して行われた特許開示の <a href="https://www.w3.org/groups/wg/css/ipr" rel="disclosure">公開一覧</a>
            を管理しています。
            このページには、特許を開示するための手順も含まれています。
            特許について実際の知識を有し、その特許が
            <a href="https://www.w3.org/policies/patent-policy/20200915/#def-essential">必須クレーム</a>
            を含むと当該個人が考える場合、
            <a href="https://www.w3.org/policies/patent-policy/20200915/#sec-Disclosure">W3C 特許ポリシー第6節</a>
            に従って情報を開示しなければなりません。
        </p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目次</h2>
        <ol class="toc" role="directory">
            <li>
                <a href="#intro"><span class="secno">1</span> <span class="content"> 序論</span></a>
                <ol class="toc">
                    <li><a href="#placement"><span class="secno">1.1</span> <span class="content">
                                モジュール間の相互作用</span></a>
                </ol>
            <li>
                <a href="#location"><span class="secno">2</span> <span class="content"> 位置疑似クラス</span></a>
                <ol class="toc">
                    <li><a href="#local-pseudo"><span class="secno">2.1</span> <span class="content"> ローカルリンク疑似クラス <span
                                    class="css">:local-link</span></span></a>
                </ol>
            <li>
                <a href="#useraction-pseudos"><span class="secno">3</span> <span class="content"> ユーザー操作疑似クラス</span></a>
                <ol class="toc">
                    <li><a href="#interest-pseudos"><span class="secno">3.1</span> <span class="content"> 関心疑似クラス: <span
                                    class="css">:interest-source</span> および <span
                                    class="css">:interest-target</span></span></a>
                </ol>
            <li>
                <a href="#input-pseudos"><span class="secno">4</span> <span class="content"> 入力疑似クラス</span></a>
                <ol class="toc">
                    <li>
                        <a href="#ui-validity"><span class="secno">4.1</span> <span class="content"> 入力値の検証</span></a>
                        <ol class="toc">
                            <li><a href="#blank"><span class="secno">4.1.1</span> <span class="content"> 空値疑似クラス: <span
                                            class="css">:blank</span></span></a>
                        </ol>
                </ol>
            <li>
                <a href="#time-pseudos"><span class="secno">5</span> <span class="content"> 時間次元疑似クラス</span></a>
                <ol class="toc">
                    <li><a href="#the-current-pseudo"><span class="secno">5.1</span> <span class="content"> 現在要素疑似クラス:
                                <span class="css">:current</span></span></a>
                    <li><a href="#the-past-pseudo"><span class="secno">5.2</span> <span class="content"> 過去要素疑似クラス:
                                <span class="css">:past</span></span></a>
                    <li><a href="#the-future-pseudo"><span class="secno">5.3</span> <span class="content"> 未来要素疑似クラス:
                                <span class="css">:future</span></span></a>
                </ol>
            <li><a href="#custom-state"><span class="secno">6</span> <span class="content"> カスタム状態の公開: <span
                            class="css">:state()</span> 疑似クラス</span></a>
            <li><a href="#headings"><span class="secno">7</span> <span class="content"> 見出し構造: 見出し疑似クラス <span
                            class="css">:heading</span> および <span class="css">:heading()</span></span></a>
            <li>
                <a href="#grid-structural-selectors"><span class="secno">8</span> <span class="content">
                        グリッド構造セレクター</span></a>
                <ol class="toc">
                    <li><a href="#the-column-combinator"><span class="secno">8.1</span> <span class="content">
                                列結合子（<code>||</code>）</span></a>
                    <li><a href="#the-nth-col-pseudo"><span class="secno">8.2</span> <span class="content"> <span
                                    class="css">:nth-col()</span> 疑似クラス</span></a>
                    <li><a href="#the-nth-last-col-pseudo"><span class="secno">8.3</span> <span class="content"> <span
                                    class="css">:nth-last-col()</span> 疑似クラス</span></a>
                </ol>
            <li>
                <a href="#combinators"><span class="secno">9</span> <span class="content"> 結合子</span></a>
                <ol class="toc">
                    <li><a href="#idref-combinators"><span class="secno">9.1</span> <span class="content"> 参照結合子
                                <code>/ref/</code></span></a>
                </ol>
            <li>
                <a href="#changes"><span class="secno">10</span> <span class="content"> 変更点</span></a>
                <ol class="toc">
                    <li><a href="#changes-level-4"><span class="secno">10.1</span> <span class="content"> レベル 4
                                以降の変更点</span></a>
                </ol>
            <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">
                        謝辞</span></a>
            <li><a href="#privacy"><span class="secno"></span> <span class="content">プライバシーに関する考慮事項</span></a>
            <li><a href="#security"><span class="secno"></span> <span class="content">セキュリティに関する考慮事項</span></a>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content"> 適合性</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content"> 文書の表記規約</span></a>
                    <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span class="content">
                                適合クラス</span></a>
                    <li>
                        <a href="#w3c-partial"><span class="secno"></span> <span class="content"> 部分的な実装</span></a>
                        <ol class="toc">
                            <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span
                                        class="content">不安定および独自機能の実装</span></a>
                        </ol>
                    <li><a href="#w3c-testing"><span class="secno"></span> <span class="content"> 非実験的な実装</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本仕様で定義される用語</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">参照により定義される用語</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参照</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">規定参照</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">参考参照</span></a>
                </ol>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issue 索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">
                序論</span><a class="self-link" href="#intro"></a></h2>
        <p class="issue" id="issue-edc8dd61"><a class="self-link" href="#issue-edc8dd61"></a> <strong>これは <a
                    href="https://www.w3.org/TR/selectors-4/">Selectors Level 4</a> に対する差分仕様です。</strong></p>
        <h3 class="heading settled" data-level="1.1" id="placement"><span class="secno">1.1. </span><span
                class="content"> モジュール間の相互作用</span><a class="self-link" href="#placement"></a></h3>
        <p>このモジュールは、
            <a data-link-type="biblio" href="#biblio-selectors-4" title="Selectors Level 4">[selectors-4]</a> において CSS
            向けに定義されたセレクターの集合を拡張します。
        </p>
        <h2 class="heading settled" data-level="2" id="location"><span class="secno">2. </span><span class="content">
                位置疑似クラス</span><a class="self-link" href="#location"></a></h2>
        <h3 class="heading settled" data-level="2.1" id="local-pseudo"><span class="secno">2.1. </span><span
                class="content"> ローカルリンク疑似クラス <a class="css" data-link-type="maybe" href="#local-link-pseudo"
                    id="ref-for-local-link-pseudo">:local-link</a></span><a class="self-link" href="#local-pseudo"></a>
        </h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="local-link-pseudo">:local-link</dfn>
            疑似クラスは、
            サイト内におけるユーザーの現在位置に基づいて <a href="https://www.w3.org/TR/selectors-4/#the-any-link-pseudo">ハイパーリンク</a>
            をスタイル付けし、
            サイト内部リンクとサイト外部リンクを区別できるようにします。</p>
        <p>（非関数形の）<a class="css" data-link-type="maybe" href="#local-link-pseudo"
                id="ref-for-local-link-pseudo①">:local-link</a> 疑似クラスは、
            対象の絶対 URL が要素自身の文書 URL と一致するハイパーリンクにおける、
            リンク元アンカーである要素を表します。
            文書 URL とリンク URL を照合する前に、フラグメント識別子は取り除かれます;
            それ以外の URL の部分はすべて考慮されます。</p>
        <div class="example" id="example-d2555a3c">
            <a class="self-link" href="#example-d2555a3c"></a> 例えば、次の規則は、
            ナビゲーションリストの一部である場合に、現在のページを対象とするリンクへ下線が付かないようにします:
            <pre>nav :local-link { text-decoration: none; } </pre>
        </div>
        <p>関数形疑似クラスとして、<span class="css">:local-link()</span> は単一の引数として非負整数も受け付けることができます。
            文書の URL が階層的スキームに属する場合、
            それは一致させるパス階層のレベル数を示します:</p>
        <ul>
            <li><span class="css">:local-link(0)</span> は、ターゲットが文書 URL と同一オリジンにあるリンク要素を表します
            <li><span class="css">:local-link(1)</span> は、ターゲットが同一オリジンで、かつ最初のパスセグメントも同じであるリンク要素を表します
            <li><span class="css">:local-link(2)</span> は、ターゲットが同一オリジンで、かつ最初および 2 番目のパスセグメントも同じであるリンク要素を表します
            <li>など。
        </ul>
        <div class="example" id="example-a43b38c7">
            <a class="self-link" href="#example-a43b38c7"></a> 次の例は、サイト外部リンクすべてを破線の下線でスタイル付けします。
            <pre>:not(:local-link(0)) { text-decoration-style: dashed; } </pre>
        </div>
        <p>パスセグメントとは、URL のパスにおいてスラッシュ（/）で区切られた部分です。
            文書 URL にセグメントが欠けている場合、
            そのセグメントの一致を要求する疑似クラスは何にも一致しません。</p>
        <div class="example" id="example-c9a76ca6">
            <a class="self-link" href="#example-c9a76ca6"></a> したがって、次のリンクがあり:
            <ol>
                <li><code>&lt;a href="http://www.example.com">Home&lt;/a></code>
                <li><code>&lt;a href="http://www.example.com/2011">2011&lt;/a></code>
                <li><code>&lt;a href="http://www.example.com/2011/03">March&lt;/a></code>
                <li><code>&lt;a href="http://www.example.com/2011/03/">March&lt;/a></code>
                <li><code>&lt;a href="http://www.example.com/2011/03/21">21 March&lt;/a></code>
                <li><code>&lt;a href="https://www.example.com/2011/03/">March&lt;/a></code>
                <li><code>&lt;a href="http://example.com/2011/03/">March&lt;/a></code>
            </ol>
            <p>そして次のスタイルがあるとします:</p>
            <ol type="A">
                <li><code>a:local-link {...}</code>
                <li><code>a:local-link(0) {...}</code>
                <li><code>a:local-link(1) {...}</code>
                <li><code>a:local-link(2) {...}</code>
                <li><code>a:local-link(3) {...}</code>
                <li><code>a:local-link(4) {...}</code>
            </ol>
            <p>文書 URL が <code>http://www.example.com/2011/03/</code> の場合:</p>
            <ol>
                <li>リンク 1 はスタイル B を受けます
                <li>リンク 2 はスタイル B と C を受けます
                <li>リンク 3 はスタイル B、C、D を受けます
                <li>リンク 4 もスタイル A、B、C、D、E を受けます
                <li>リンク 5 はスタイル B、C、D を受けます
                <li>リンク 6 はスタイルが適用されません
                <li>リンク 7 はスタイルが適用されません
                <li>スタイル F は何にも適用されません
            </ol>
        </div>
        <p>URL の「オリジン」は <a href="http://tools.ietf.org/html/rfc6454#section-4">RFC 6454 の第 4 節</a>で定義されます。
            <span class="css">:local-link(<var>n</var>)</span> に対する照合において、
            URL のユーザー名、パスワード、クエリ文字列、およびフラグメントの各部分は考慮されません。
            文書 URL が階層的スキームに属さない場合、
            関数形疑似クラスは何にも一致しません。
        </p>
        <p class="issue" id="issue-dd3371ba"><a class="self-link" href="#issue-dd3371ba"></a> 文書 URL が少なくとも N
            個のセグメントを持つ場合、
            <span class="css">:local-link(N)</span> が少なくとも N 個のセグメントを持つリンク URL にのみ一致することは明確です。
            （これにより :local-link に一貫した意味論を割り当てられ、たとえば :local-link(2) が GitHub における「リポジトリ内」リンクを意味する、といったことができます。）
            では、文書 URL が N 未満のセグメントしか持たず、
            リンクが同一ページである場合はどうでしょうか？
            「null セグメント」は一致として数えるべきでしょうか、それとも数えないべきでしょうか？
        </p>
        <h2 class="heading settled" data-level="3" id="useraction-pseudos"><span class="secno">3. </span><span
                class="content"> ユーザー操作疑似クラス</span><a class="self-link" href="#useraction-pseudos"></a>
        </h2>
        <h3 class="heading settled" data-level="3.1" id="interest-pseudos"><span class="secno">3.1. </span><span
                class="content"> 関心疑似クラス: <a class="css" data-link-type="maybe" href="#selectordef-interest-source"
                    id="ref-for-selectordef-interest-source">:interest-source</a>
                および <a class="css" data-link-type="maybe" href="#selectordef-interest-target"
                    id="ref-for-selectordef-interest-target">:interest-target</a></span><a class="self-link"
                href="#interest-pseudos"></a></h3>
        <p>一般的な UI 機能として、ユーザーが特定の要素に「関心を示す」ことができ（<dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="interest-source">関心ソース</dfn>）、
            UI がその関心に反応して、別の要素に追加情報を表示する（<dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="interest-target">関心ターゲット</dfn>）ことがあります。
            典型的にはポップアップです。
            例えば、ページ上のユーザー名にホバーすると、そのユーザーの情報カードが表示されるかもしれません;
            またはリンクを長押しすると、リンク先のプレビューが表示されるかもしれません。
            こうしたことが起きるとき、最初の要素は</p>
        <p class="note" role="note"><span class="marker">注:</span> どの要素が正確に <a data-link-type="dfn"
                href="#interest-source" id="ref-for-interest-source">関心ソース</a> になり得るのか、
            それらがどのように <a data-link-type="dfn" href="#interest-target" id="ref-for-interest-target">関心ターゲット</a>
            と結び付けられるのか、
            そして「関心」がどのように示されるのかはすべて、
            <a data-link-type="dfn" href="https://w3c.github.io/aria/#dfn-host-language"
                id="ref-for-dfn-host-language">ホスト言語</a> によって定義されます。
            例えば HTML では、
            これは <code><a data-link-type="element-sub">interestfor</a></code> 属性によって行われ、
            「関心を示す」ことができる要素（<span id="ref-for-interest-source①">関心ソース</span>）を示します。
            そしてその属性は、追加情報を表示する意図を持つ別の要素（関連付けられた <span id="ref-for-interest-target①">関心ターゲット</span>）を指します
            （通常は
            <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/popover.html#attr-popover" id="ref-for-attr-popover">popover</a></code>
            要素です）。
        </p>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export
                id="selectordef-interest-source">:interest-source</dfn> 疑似クラスは、
            ユーザーが現在「関心を示している」 <a data-link-type="dfn" href="#interest-source" id="ref-for-interest-source②">関心ソース</a>
            要素に適用され、
            <dfn class="dfn-paneled css" data-dfn-type="selector" data-export
                id="selectordef-interest-target">:interest-target</dfn> 疑似クラスは、
            <a class="css" data-link-type="maybe" href="#selectordef-interest-source"
                id="ref-for-selectordef-interest-source①">:interest-source</a> に一致する要素に関連付けられた <a data-link-type="dfn"
                href="#interest-target" id="ref-for-interest-target②">関心ターゲット</a> に適用されます。
        </p>
        <p class="note" role="note"><span class="marker">注:</span> <a class="css" data-link-type="maybe"
                href="#selectordef-interest-source" id="ref-for-selectordef-interest-source②">:interest-source</a> は、
            ユーザーが <em>現在</em> 関心を示している <a data-link-type="dfn" href="#interest-source"
                id="ref-for-interest-source③">関心ソース</a> にのみ一致し、
            関心が <em>潜在的に</em> 示され得る要素すべてに一致するわけではありません。
            例えば HTML では、
            単に <code><a data-link-type="element-sub">interestfor</a></code> 属性を持つだけでは、この疑似クラスに一致しません;
            ユーザーが実際にそれへ関心を示す必要もあります。
            同様に、<a class="css" data-link-type="maybe" href="#selectordef-interest-target"
                id="ref-for-selectordef-interest-target①">:interest-target</a> も、
            ユーザーが <em>現在</em> 関心を示している要素と結び付けられた <a data-link-type="dfn" href="#interest-target"
                id="ref-for-interest-target③">関心ターゲット</a> にのみ一致し、
            <code><a data-link-type="element-sub">interestfor</a></code> 属性が指し示す任意の要素に一致するわけではありません。
        </p>
        <h2 class="heading settled" data-level="4" id="input-pseudos"><span class="secno">4. </span><span
                class="content"> 入力疑似クラス</span><a class="self-link" href="#input-pseudos"></a></h2>
        <h3 class="heading settled" data-level="4.1" id="ui-validity"><span class="secno">4.1. </span><span
                class="content"> 入力値の検証</span><a class="self-link" href="#ui-validity"></a></h3>
        <h4 class="heading settled" data-level="4.1.1" id="blank"><span class="secno">4.1.1. </span><span
                class="content"> 空値疑似クラス: <a class="css" data-link-type="maybe" href="#blank-pseudo"
                    id="ref-for-blank-pseudo">:blank</a></span><a class="self-link" href="#blank"></a></h4>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="blank-pseudo">:blank</dfn>
            疑似クラスは、
            入力値が空である（空文字列、またはそれ以外の null 入力から成る）ユーザー入力要素に適用されます。</p>
        <div class="note" role="note">
            大まかに言えば、人間がフォームの印刷物を見て
            空欄だと言うであろうなら、
            <a class="css" data-link-type="maybe" href="#blank-pseudo" id="ref-for-blank-pseudo①">:blank</a> に一致します。
            <p>フォームコントロールに対する <a class="css" data-link-type="maybe" href="#blank-pseudo"
                    id="ref-for-blank-pseudo②">:blank</a> を解釈するための経験則は次のとおりです:</p>
            <ul>
                <li data-md>
                    <p>コントロールが常に送信され、
                        かつ空文字列で送信される場合、<a class="css" data-link-type="maybe" href="#blank-pseudo"
                            id="ref-for-blank-pseudo③">:blank</a> に一致します。
                        （例えば、値が空のときの HTML の <code>&lt;input type=text></code> など。）</p>
                <li data-md>
                    <p>送信されることもあり、送信されないこともあり、
                        送信されない状態に設定されている場合、<a class="css" data-link-type="maybe" href="#blank-pseudo"
                            id="ref-for-blank-pseudo④">:blank</a> に一致します。
                        （例えば、チェックされていないときの HTML の <code>&lt;input type=checkbox></code> など。）</p>
                <li data-md>
                    <p>それが「アクションボタン」
                        （状態を表す「トグルボタン」ではなく）
                        であり、<code>&lt;button></code>、<code>&lt;input type=submit></code> などの場合、
                        <a class="css" data-link-type="maybe" href="#blank-pseudo" id="ref-for-blank-pseudo⑤">:blank</a>
                        に一致することはありません。
                    </p>
            </ul>
            <p>ホスト言語は、
                フォームコントロールがいつ <a class="css" data-link-type="maybe" href="#blank-pseudo"
                    id="ref-for-blank-pseudo⑥">:blank</a> に一致するかについて、
                より正確な規則を指定できます。</p>
        </div>
        <h2 class="heading settled" data-level="5" id="time-pseudos"><span class="secno">5. </span><span
                class="content"> 時間次元疑似クラス</span><a class="self-link" href="#time-pseudos"></a>
        </h2>
        <p>これらの疑似クラスは、あるタイムラインにおける現在表示中またはアクティブな位置に対して、
            要素を分類します。例えば、文書の音声レンダリング中や、
            WebVTT を用いて字幕を描画する動画表示中などです。</p>
        <p>CSS はこのタイムラインを定義しません;
            ホスト言語が定義しなければなりません。
            要素に対してタイムラインが定義されていない場合、
            これらの疑似クラスはその要素に一致してはなりません。</p>
        <p class="note" role="note"><span class="marker">注:</span> <a class="css" data-link-type="maybe"
                href="#current-pseudo" id="ref-for-current-pseudo">:current</a> 要素の祖先もまた
            <span class="css" id="ref-for-current-pseudo①">:current</span> ですが、
            <a class="css" data-link-type="maybe" href="#past-pseudo" id="ref-for-past-pseudo">:past</a> または <a
                class="css" data-link-type="maybe" href="#future-pseudo" id="ref-for-future-pseudo">:future</a>
            要素の祖先は、必ずしも <span class="css" id="ref-for-past-pseudo①">:past</span> または <span class="css"
                id="ref-for-future-pseudo①">:future</span> でもありません。
            ある要素が一致するのは、<span class="css" id="ref-for-current-pseudo②">:current</span>、<span class="css"
                id="ref-for-past-pseudo②">:past</span>、または <span class="css" id="ref-for-future-pseudo②">:future</span>
            のうち最大で 1 つです。
        </p>
        <h3 class="heading settled" data-level="5.1" id="the-current-pseudo"><span class="secno">5.1. </span><span
                class="content"> 現在要素疑似クラス: <a class="css" data-link-type="maybe" href="#current-pseudo"
                    id="ref-for-current-pseudo③">:current</a></span><a class="self-link" href="#the-current-pseudo"></a>
        </h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="current-pseudo">:current</dfn>
            疑似クラスは、現在表示されている要素、またはその要素の祖先を表します。</p>
        <p>その別形式である <dfn class="dfn-paneled css" data-dfn-type="selector" data-export
                id="selectordef-current">:current()</dfn> は、
            引数として <a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#compound"
                id="ref-for-compound">複合セレクター</a> のリストを取ります:
            それは、引数に一致する <a class="css" data-link-type="maybe" href="#current-pseudo"
                id="ref-for-current-pseudo④">:current</a> 要素、またはそれが一致しない場合には、
            一致する <span class="css" id="ref-for-current-pseudo⑤">:current</span> 要素の最も内側の祖先を表します。
            （<span class="css" id="ref-for-current-pseudo⑥">:current</span> 要素もその祖先も引数に一致しない場合、
            セレクターは何も表しません。）</p>
        <div class="example" id="example-34db2617">
            <a class="self-link" href="#example-34db2617"></a> 例えば、次の規則は、
            文書の音声レンダリングにおいて読み上げられている段落またはリスト項目をハイライトします:
            <pre>:current(p, li, dt, dd) {
  background: yellow;
}
</pre>
        </div>
        <h3 class="heading settled" data-level="5.2" id="the-past-pseudo"><span class="secno">5.2. </span><span
                class="content"> 過去要素疑似クラス: <a class="css" data-link-type="maybe" href="#past-pseudo"
                    id="ref-for-past-pseudo③">:past</a></span><a class="self-link" href="#the-past-pseudo"></a></h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="past-pseudo">:past</dfn>
            疑似クラスは、
            <a class="css" data-link-type="maybe" href="#current-pseudo" id="ref-for-current-pseudo⑦">:current</a>
            要素より前に完全に起きると定義されている任意の要素を表します。
            例えば、WebVTT 仕様は <a class="css" data-link-type="maybe" href="#past-pseudo" id="ref-for-past-pseudo④">:past</a>
            疑似クラスを、
            <a href="https://w3c.github.io/webvtt/#the-past-and-future-pseudo-classes">メディア要素の現在の再生位置に対して相対的</a>に定義します。
            文書言語が要素の時間に基づく順序を定義しない場合、
            これは <span class="css" id="ref-for-current-pseudo⑧">:current</span> 要素の（間接的であり得る）前の兄弟である任意の要素を表します。
        </p>
        <h3 class="heading settled" data-level="5.3" id="the-future-pseudo"><span class="secno">5.3. </span><span
                class="content"> 未来要素疑似クラス: <a class="css" data-link-type="maybe" href="#future-pseudo"
                    id="ref-for-future-pseudo③">:future</a></span><a class="self-link" href="#the-future-pseudo"></a>
        </h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="future-pseudo">:future</dfn>
            疑似クラスは、
            <a class="css" data-link-type="maybe" href="#current-pseudo" id="ref-for-current-pseudo⑨">:current</a>
            要素より後に完全に起きると定義されている任意の要素を表します。
            例えば、WebVTT 仕様は <a class="css" data-link-type="maybe" href="#future-pseudo"
                id="ref-for-future-pseudo④">:future</a> 疑似クラスを、
            <a href="https://w3c.github.io/webvtt/#the-past-and-future-pseudo-classes">メディア要素の現在の再生位置に対して相対的</a>に定義します。
            文書言語が要素の時間に基づく順序を定義しない場合、
            これは <span class="css" id="ref-for-current-pseudo①⓪">:current</span> 要素の（間接的であり得る）次の兄弟である任意の要素を表します。
        </p>
        <h2 class="heading settled" data-level="6" id="custom-state"><span class="secno">6. </span><span
                class="content"> カスタム状態の公開: <a class="css" data-link-type="maybe" href="#state-pseudo"
                    id="ref-for-state-pseudo">:state()</a> 疑似クラス</span><a class="self-link" href="#custom-state"></a>
        </h2>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="state-pseudo">:state( <a
                    class="production css" data-link-type="type"
                    href="https://www.w3.org/TR/css-values-4/#typedef-ident" id="ref-for-typedef-ident">&lt;ident></a>
                )</dfn> 疑似クラスは、
            <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/custom-elements.html#custom-element"
                id="ref-for-custom-element">カスタム要素</a> のうち、
            その <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/custom-elements.html#states-set"
                id="ref-for-states-set">states set</a> が、
            セレクター引数の値と <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is"
                id="ref-for-string-is">同一である</a>
            文字列を含むものに一致します。
        </p>
        <details class="wpt-tests-block" dir="ltr" lang="en">
            <summary>Tests</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/selectors/parsing/parse-state.html"
                        title="css/selectors/parsing/parse-state.html">parse-state.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/selectors/parsing/parse-state.html"><small>(live test)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/selectors/parsing/parse-state.html"><small>(source)</small></a>
            </ul>
        </details>
        <p class="note" role="note"><span class="marker">注:</span> 「<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#string-is"
                id="ref-for-string-is①">同一である</a>」による照合の挙動は、コードポイントごとに文字列を比較します;
            特に、大文字小文字を区別します。
            したがって、<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/custom-elements.html#states-set"
                id="ref-for-states-set①">states set</a> に "foo" が含まれている場合、<span class="css">:state(FOO)</span>
            は一致<em>しません</em>。
        </p>
        <p><a class="css" data-link-type="maybe" href="#state-pseudo" id="ref-for-state-pseudo①">:state()</a>
            疑似クラスの正確な一致挙動は、
            ホスト言語によって定義されます。
            明確化のため、この疑似クラスを説明する概念は HTML の定義へリンクしています;
            詳細については <a href="https://html.spec.whatwg.org/multipage/custom-elements.html#custom-state-pseudo-class">HTML
                定義</a> を参照してください。
            他のホスト言語は、この疑似クラスがどのように一致するかを定義しなければなりません。</p>
        <h2 class="heading settled" data-level="7" id="headings"><span class="secno">7. </span><span class="content">
                見出し構造: 見出し疑似クラス <a class="css" data-link-type="maybe" href="#heading-pseudo"
                    id="ref-for-heading-pseudo">:heading</a> および <a class="css" data-link-type="maybe"
                    href="#heading-functional-pseudo" id="ref-for-heading-functional-pseudo">:heading()</a></span><a
                class="self-link" href="#headings"></a></h2>
        <p>（非関数形の）<dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="heading-pseudo">:heading</dfn>
            疑似クラスは、
            文書言語が定義する意味論（例えば <a data-link-type="biblio" href="#biblio-html5" title="HTML5">[HTML5]</a>）において、
            <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/sections.html#heading-level"
                id="ref-for-heading-level">見出しレベル</a>を持つ要素に一致します。
        </p>
        <p><a class="css" data-link-type="maybe" href="#heading-pseudo" id="ref-for-heading-pseudo①">:heading</a> の <a
                data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#specificity"
                id="ref-for-specificity">詳細度</a> はクラスと同じです。</p>
        <div class="example" id="example-640da181">
            <a class="self-link" href="#example-640da181"></a> 例えば、次のスタイルシートには、
            現在のページ内のすべての見出し要素に適用される規則が含まれています:
            <pre>:heading { text-decoration: underline; }</pre>
        </div>
        <p>関数形疑似クラスとして、<dfn class="dfn-paneled css" data-dfn-type="selector" data-export
                id="heading-functional-pseudo">:heading()</dfn> 記法は、
            提供された <var>integer</var> 値のいずれかに一致する <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/sections.html#heading-level"
                id="ref-for-heading-level①">見出しレベル</a>を持つ要素を表します。
            構文は次のとおりです:</p>
        <pre class="prod">:heading() = :heading( <a class="production" data-link-type="type" href="#typedef-level" id="ref-for-typedef-level">&lt;level></a><a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-comma" id="ref-for-mult-comma">#</a> )
</pre>
        <p>ここで <dfn class="dfn-paneled css" data-dfn-type="type" data-export
                id="typedef-level"><code>&lt;level></code></dfn> は、
            型フラグが "integer" に設定された <a class="production css" data-link-type="type"
                href="https://www.w3.org/TR/css-syntax-3/#typedef-number-token"
                id="ref-for-typedef-number-token">&lt;number-token></a> です。</p>
        <p><a class="css" data-link-type="maybe" href="#heading-functional-pseudo"
                id="ref-for-heading-functional-pseudo①">:heading()</a> の <a data-link-type="dfn"
                href="https://www.w3.org/TR/selectors-4/#specificity" id="ref-for-specificity①">詳細度</a> はクラスと同じです。</p>
        <div class="example" id="example-8a5e281d">
            <a class="self-link" href="#example-8a5e281d"></a> 次の例は、
            レベル 1 から 3 の見出しを font-weight 900 でスタイル付けし、
            レベル 6 以降の見出しを font-weight 500 でスタイル付けします。
            さらに、見出しレベル 1 と 2 には下線を付け、レベル 3 以降には text-decoration を付けません:
            <pre>:heading(1, 2, 3) { font-weight: 900; }</pre>
            <pre>:heading(6, 7, 8, 9) { font-weight: 500; }</pre>
            <pre>:heading(1, 2) { text-decoration: underline; }</pre>
            <pre>:heading(3, 4, 5, 6, 7, 8, 9) { text-decoration: none; }</pre>
        </div>
        <p class="note" role="note"><span class="marker">注:</span> <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/sections.html#heading-level"
                id="ref-for-heading-level②">見出しレベル</a> は、要素の <a data-link-type="dfn"
                href="https://www.w3.org/TR/CSS2/selector.html#x11" id="ref-for-x11">型セレクター</a> と異なる可能性があります。したがって、
            セレクター <span class="css">h1:heading(3)</span> は、
            公開された見出しレベルが 3 である任意の <span class="css">h1</span> タグに一致します。</p>
        <details class="wpt-tests-block" dir="ltr" lang="en">
            <summary>Tests</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/selectors/heading.html"
                        title="css/selectors/heading.html">heading.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/selectors/heading.html"><small>(live test)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/selectors/heading.html"><small>(source)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/selectors/parsing/parse-heading.html"
                        title="css/selectors/parsing/parse-heading.html">parse-heading.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/selectors/parsing/parse-heading.html"><small>(live test)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/selectors/parsing/parse-heading.html"><small>(source)</small></a>
            </ul>
        </details>
        <h2 class="heading settled" data-level="8" id="grid-structural-selectors"><span class="secno">8. </span><span
                class="bs-old-id" id="table-pseudos"></span><span class="content"> グリッド構造セレクター</span><a
                class="self-link" href="#grid-structural-selectors"></a></h2>
        <p>2 次元グリッドにおけるセルの二重の関連付け（行と列への関連付け）は、
            階層的マークアップ言語における親子関係では表現できません。
            これらの関連付けのうち、階層的に表現できるのは一方のみです:
            もう一方は、文書言語の意味論の中で明示的または暗黙的に定義されなければなりません。
            最も一般的な階層的マークアップ言語である HTML と DocBook のいずれでも、
            マークアップは行優先（すなわち、行の関連が階層的に表現される）であり、列は暗黙になります。
            このような暗黙の列ベースの関係を表現できるようにするため、
            <a data-link-type="dfn" href="#column-combinator" id="ref-for-column-combinator">列結合子</a> と、
            <a class="css" data-link-type="maybe" href="#nth-col-pseudo" id="ref-for-nth-col-pseudo">:nth-col()</a> および
            <a class="css" data-link-type="maybe" href="#nth-last-col-pseudo"
                id="ref-for-nth-last-col-pseudo">:nth-last-col()</a> 疑似クラスが定義されます。
            列優先形式では、これらの疑似クラスは代わりに行の関連付けに対して照合します。
        </p>
        <h3 class="heading settled" data-level="8.1" id="the-column-combinator"><span class="secno">8.1. </span><span
                class="content"> 列結合子（<code>||</code>）</span><a class="self-link" href="#the-column-combinator"></a>
        </h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="column-combinator">列結合子</dfn>は、
            2 本のパイプから成り（<dfn class="dfn-paneled css" data-dfn-type="selector" data-export
                id="selectordef-column">||</dfn>）、
            列要素が表す列に属するセル要素との関係を表します。
            列への所属は、文書言語の意味論のみに基づいて決定されます:
            要素が提示されるかどうか、またどのように提示されるかは考慮されません。
            セル要素が複数の列に属する場合、
            それはそれらの列のいずれかへの所属を示すセレクターによって表されます。</p>
        <div class="example" id="example-60f47339">
            <a class="self-link" href="#example-60f47339"></a> 次の例はセル C、E、G を灰色にします。
            <pre>col.selected || td {
  background: gray;
  color: white;
  font-weight: bold;
}
</pre>
            <pre>&lt;table>
  &lt;col span="2">
  &lt;col class="selected">
  &lt;tr>&lt;td>A &lt;td>B &lt;td>C
  &lt;tr>&lt;td colspan="2">D &lt;td>E
  &lt;tr>&lt;td>F &lt;td colspan="2">G
&lt;/table>
</pre>
        </div>
        <h3 class="heading settled" data-level="8.2" id="the-nth-col-pseudo"><span class="secno">8.2. </span><span
                class="content"> <a class="css" data-link-type="maybe" href="#nth-col-pseudo"
                    id="ref-for-nth-col-pseudo①">:nth-col()</a> 疑似クラス</span><a class="self-link"
                href="#the-nth-col-pseudo"></a></h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export data-lt=":nth-col()"
                id="nth-col-pseudo">:nth-col(<var>An+B</var>)</dfn> 疑似クラス記法は、
            <code>n</code> の任意の正整数またはゼロ値に対して、
            その列の<strong>前</strong>に <var>An+B</var>-1 列がある列に属するセル要素を表します。
            列への所属は、文書言語の意味論のみに基づいて決定されます: 要素が提示されるかどうか、またどのように提示されるかは考慮されません。
            セル要素が複数の列に属する場合、
            それはそれらの列のいずれかを示すセレクターによって表されます。
        </p>
        <p>CSS Syntax Module <a data-link-type="biblio" href="#biblio-css3syn"
                title="CSS Syntax Module Level 3">[CSS3SYN]</a> は、<a
                href="https://drafts.csswg.org/css-syntax/#anb"><var>An+B</var> 記法</a>を定義します。</p>
        <h3 class="heading settled" data-level="8.3" id="the-nth-last-col-pseudo"><span class="secno">8.3. </span><span
                class="content"> <a class="css" data-link-type="maybe" href="#nth-last-col-pseudo"
                    id="ref-for-nth-last-col-pseudo①">:nth-last-col()</a> 疑似クラス</span><a class="self-link"
                href="#the-nth-last-col-pseudo"></a></h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export data-lt=":nth-last-col()"
                id="nth-last-col-pseudo">:nth-last-col(<var>An+B</var>)</dfn> 疑似クラス記法は、
            <code>n</code> の任意の正整数またはゼロ値に対して、
            その列の<strong>後</strong>に <var>An+B</var>-1 列がある列に属するセル要素を表します。
            列への所属は、文書言語の意味論のみに基づいて決定されます: 要素が提示されるかどうか、またどのように提示されるかは考慮されません。
            セル要素が複数の列に属する場合、
            それはそれらの列のいずれかを示すセレクターによって表されます。
        </p>
        <p>CSS Syntax Module <a data-link-type="biblio" href="#biblio-css3syn"
                title="CSS Syntax Module Level 3">[CSS3SYN]</a> は、<a
                href="https://drafts.csswg.org/css-syntax/#anb"><var>An+B</var> 記法</a>を定義します。</p>
        <h2 class="heading settled" data-level="9" id="combinators"><span class="secno">9. </span><span class="content">
                結合子</span><a class="self-link" href="#combinators"></a></h2>
        <h3 class="heading settled" data-level="9.1" id="idref-combinators"><span class="secno">9.1. </span><span
                class="content"> 参照結合子 <code>/ref/</code></span><a class="self-link" href="#idref-combinators"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="reference-combinator">参照結合子</dfn>は、
            間に <a href="https://www.w3.org/TR/css3-namespace/#css-qnames">CSS 修飾名</a> を挟んだ 2 本のスラッシュから成り、
            2 つの <a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#compound"
                id="ref-for-compound①">複合セレクター</a>（例: <span class="css">A /attr/ B</span>）を分離します。
            第 1 の <span id="ref-for-compound②">複合セレクター</span>が表す要素は、
            第 2 の <span id="ref-for-compound③">複合セレクター</span>が表す要素を明示的に参照します。
            ホスト言語がこの関係を表現する別の構文を定義しない限り、
            この関係は、第 1 の要素上で指定された属性の値が IDREF であるか、
            第 2 の要素を参照する <a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#id-selector"
                id="ref-for-id-selector">ID セレクター</a> である場合に存在すると見なされます。</p>
        <p>参照結合子における属性照合は、<a href="https://www.w3.org/TR/css3-selectors/#attribute-selectors">属性セレクター</a> と同じ規則に従います。
        </p>
        <div class="example" id="example-69e878ec">
            <a class="self-link" href="#example-69e878ec"></a> 次の例は、
            <a data-link-type="element" href="https://html.spec.whatwg.org/multipage/input.html#the-input-element"
                id="ref-for-the-input-element">input</a> 要素を、
            その <a href="https://www.w3.org/TR/html40/interact/forms.html#h-17.9"><code>&lt;label></code></a>
            がフォーカスされているかホバーされているときにハイライトします:
            <pre>label:is(:hover, :focus) /for/ input,       /* "for" 属性による関連付け */
label:is(:hover, :focus):not([for]) input { /* 包含による関連付け */
  box-shadow: yellow 0 0 10px;
}
</pre>
        </div>
        <h2 class="heading settled" data-level="10" id="changes"><span class="secno">10. </span><span class="content">
                変更点</span><a class="self-link" href="#changes"></a></h2>
        <h3 class="heading settled" data-level="10.1" id="changes-level-4"><span class="secno">10.1. </span><span
                class="content"> レベル 4 以降の変更点</span><a class="self-link" href="#changes-level-4"></a></h3>
        <p><a href="https://www.w3.org/TR/selectors-4/">レベル 4</a> 以降の追加点:</p>
        <ul>
            <li>参照結合子
                （Selectors 4 の<a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/">以前の草案</a>から延期）
            <li><a class="css" data-link-type="maybe" href="#local-link-pseudo"
                    id="ref-for-local-link-pseudo②">:local-link</a> 疑似クラスの関数形
                （Selectors 4 の<a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/">以前の草案</a>から延期）
            <li><a class="css" data-link-type="maybe" href="#state-pseudo" id="ref-for-state-pseudo②">:state()</a>
                疑似クラス
            <li><a class="css" data-link-type="maybe" href="#heading-pseudo" id="ref-for-heading-pseudo②">:heading</a>
                および <a class="css" data-link-type="maybe" href="#heading-functional-pseudo"
                    id="ref-for-heading-functional-pseudo②">:heading()</a>
                疑似クラス
            <li><a class="css" data-link-type="maybe" href="#local-link-pseudo"
                    id="ref-for-local-link-pseudo③">:local-link</a> 疑似クラス
                （Selectors 4 の<a href="https://www.w3.org/TR/2022/WD-selectors-4-20221111/">以前の草案</a>から延期）
            <li><a class="css" data-link-type="maybe" href="#selectordef-interest-source"
                    id="ref-for-selectordef-interest-source③">:interest-source</a> および <a class="css"
                    data-link-type="maybe" href="#selectordef-interest-target"
                    id="ref-for-selectordef-interest-target②">:interest-target</a> 疑似クラス
            <li><a class="css" data-link-type="maybe" href="#blank-pseudo" id="ref-for-blank-pseudo⑦">:blank</a>
                疑似クラス
                （Selectors 4 の<a href="https://www.w3.org/TR/2022/WD-selectors-4-20221111/">以前の草案</a>から延期）
            <li><a href="#grid-structural-selectors">グリッド構造（列）セレクター</a>（Selectors 4 の<a
                    href="https://www.w3.org/TR/2022/WD-selectors-4-20221111/">以前の草案</a>から延期）
            <li><a href="#time-pseudos">時間次元疑似クラス</a>（Selectors 4 の<a
                    href="https://www.w3.org/TR/2022/WD-selectors-4-20221111/">以前の草案</a>から延期）
        </ul>
        <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span
                class="content">謝辞</span><a class="self-link" href="#acknowledgements"></a></h2>
        <p>CSS working group は、
            長年にわたって <a href="https://www.w3.org/TR/selectors-4">以前の Selectors</a> 仕様に貢献してくださった皆様に感謝します。
            それらの仕様が本仕様の基礎となったためです。
            特に working group は、Selectors Level 5 への具体的な貢献として、
            次の方へ特別な感謝を申し上げます:
            Joey Arhar。</p>
        <h2 class="no-num heading settled" id="privacy"><span class="content">プライバシーに関する考慮事項</span><a class="self-link"
                href="#privacy"></a></h2>
        <p>適切な場合、レベル 4 からコピーされるべきです。</p>
        <h2 class="no-num heading settled" id="security"><span class="content">セキュリティに関する考慮事項</span><a class="self-link"
                href="#security"></a></h2>
        <p>適切な場合、レベル 4 からコピーされるべきです。</p>
    </main>
    <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content"> 適合性</span><a class="self-link"
            href="#w3c-conformance"></a></h2>
    <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content"> 文書の表記規約</span><a class="self-link"
            href="#w3c-conventions"></a></h3>
    <p>適合要件は、
        記述的な断定と RFC 2119 の用語の組み合わせによって表現されます。規定部分におけるキーワード “MUST”、
        “MUST NOT”、“REQUIRED”、“SHALL”、“SHALL NOT”、“SHOULD”、“SHOULD NOT”、
        “RECOMMENDED”、“MAY”、および “OPTIONAL” は、RFC 2119 に記述されているとおりに解釈されます。
        ただし、可読性のため、本仕様ではこれらの語をすべて大文字で表記していません。 </p>
    <p>本仕様の本文は、明示的に非規定であると示された節、例、および注記を除き、すべて規定です。 <a data-link-type="biblio" href="#biblio-rfc2119"
            title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
    <p>本仕様における例は、“for example” という語で導入されるか、
        規定の本文から <code>class="example"</code> によって次のように区別されます: </p>
    <div class="example" id="w3c-example">
        <a class="self-link" href="#w3c-example"></a>
        <p>これは参考（非規定）となる例の一例です。</p>
    </div>
    <p>参考（非規定）注記は “Note” という語で始まり、
        規定の本文から <code>class="note"</code> によって次のように区別されます: </p>
    <p class="note" role="note">注: これは参考（非規定）注記です。</p>
    <p>注意喚起（advisement）は、特別な注意を喚起するようにスタイル付けされた規定の節であり、
        <code>&lt;strong class="advisement"></code> によって他の規定テキストから次のように区別されます:
        <strong class="advisement"> UAs は、アクセス可能な代替手段を提供しなければなりません。 </strong>
    </p>
    <details class="wpt-tests-block" dir="ltr" lang="en" open>
        <summary>テスト</summary>
        <p>本仕様の内容に関連するテストは、
            このような “Tests” ブロックに記載される場合があります。
            そのようなブロックはいずれも非規定です。</p>
        <ul class="wpt-tests-list"></ul>
        <hr>
    </details>
    <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content"> 適合クラス</span><a
            class="self-link" href="#w3c-conformance-classes"></a></h3>
    <p>本仕様への適合は、次の 3 つの適合クラスについて定義されます: </p>
    <dl>
        <dt>スタイルシート
        <dd><a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
                スタイルシート</a>。
        <dt>レンダラー
        <dd>スタイルシートの意味論を解釈し、それを用いる文書をレンダリングする <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>。
        <dt>オーサリングツール
        <dd>スタイルシートを作成する <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>。
    </dl>
    <p>スタイルシートが本仕様に適合するのは、
        本モジュールで定義される構文を使用するその宣言がすべて、
        一般的な CSS 文法および本モジュールで定義される各機能の個別文法に従って有効である場合です。 </p>
    <p>レンダラーが本仕様に適合するのは、
        適切な仕様によって定義されるとおりにスタイルシートを解釈することに加え、
        本仕様で定義されるすべての機能を、正しく解析し、
        それに従って文書をレンダリングすることによりサポートする場合です。
        ただし、デバイスの制限によって UA が文書を正しくレンダリングできないことは、
        UA を不適合とするものではありません。
        （例えば、UA はモノクロモニター上で色をレンダリングすることを要求されません。） </p>
    <p>オーサリングツールが本仕様に適合するのは、
        一般的な CSS 文法および本モジュールの各機能の個別文法に従って構文的に正しいスタイルシートを書き、
        かつ、本モジュールで記述されるスタイルシートに関する他のすべての適合要件を満たす場合です。 </p>
    <h3 class="no-ref heading settled" id="w3c-partial"><span class="content"> 部分的な実装</span><a class="self-link"
            href="#w3c-partial"></a></h3>
    <p>著者が前方互換の解析規則を利用してフォールバック値を割り当てられるようにするため、
        CSS レンダラーは、利用可能なレベルのサポートを持たないあらゆる at-rule、プロパティ、プロパティ値、キーワード、
        およびその他の構文的構成物を無効として扱わなければならず（そして <a href="https://www.w3.org/TR/CSS21/conform.html#ignore">適切に無視</a>
        しなければなりません）。
        特にユーザーエージェントは、単一の複数値プロパティ宣言の中で、
        未サポートのコンポーネント値だけを選択的に無視し、サポートされる値を尊重してはなりません:
        いずれかの値が無効と見なされる場合（未サポート値はそうでなければなりません）、
        CSS は宣言全体を無視することを要求します。</p>
    <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content"> 不安定および独自機能の実装</span><a
            class="self-link" href="#w3c-conform-future-proofing"></a></h4>
    <p>将来の安定した CSS 機能との衝突を避けるため、
        CSSWG は、<a href="https://www.w3.org/TR/CSS/#unstable">不安定</a>な機能および CSS への <a
            href="https://www.w3.org/TR/CSS/#proprietary-extension">独自拡張</a> の実装について、
        <a href="https://www.w3.org/TR/CSS/#future-proofing">ベストプラクティスに従うこと</a> を推奨します。
    </p>
    <h3 class="no-ref heading settled" id="w3c-testing"><span class="content"> 非実験的な実装</span><a class="self-link"
            href="#w3c-testing"></a></h3>
    <p>仕様が Candidate Recommendation 段階に達すると、
        非実験的な実装が可能になり、
        実装者は、仕様に従って正しく実装されていることを示せるあらゆる CR レベルの機能について、
        プレフィックスなしの実装をリリースするべきです。 </p>
    <p>実装間での CSS の相互運用性を確立し維持するため、
        CSS Working Group は、非実験的な CSS レンダラーが、
        あらゆる CSS 機能についてプレフィックスなしの実装をリリースする前に、
        実装報告書（必要なら、その実装報告書で使用されたテストケース）を
        W3C に提出することを要請します。
        W3C に提出されたテストケースは、
        CSS Working Group によるレビューと修正の対象となります。 </p>
    <p>テストケースおよび実装報告書の提出に関する追加情報は、
        CSS Working Group のウェブサイト <a href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a>
        にて参照できます。
        質問は、メーリングリスト <a href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
        宛に送るべきです。</p>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本仕様で定義される用語</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#selectordef-column">||</a><span>, § 8.1</span>
        <li><a href="#blank-pseudo">:blank</a><span>, § 4.1.1</span>
        <li><a href="#column-combinator">列結合子</a><span>, § 8.1</span>
        <li><a href="#current-pseudo">:current</a><span>, § 5.1</span>
        <li><a href="#selectordef-current">:current()</a><span>, § 5.1</span>
        <li><a href="#future-pseudo">:future</a><span>, § 5.3</span>
        <li><a href="#heading-pseudo">:heading</a><span>, § 7</span>
        <li><a href="#heading-functional-pseudo">:heading()</a><span>, § 7</span>
        <li><a href="#selectordef-interest-source">:interest-source</a><span>, § 3.1</span>
        <li><a href="#interest-source">関心ソース</a><span>, § 3.1</span>
        <li><a href="#selectordef-interest-target">:interest-target</a><span>, § 3.1</span>
        <li><a href="#interest-target">関心ターゲット</a><span>, § 3.1</span>
        <li><a href="#typedef-level">&lt;level></a><span>, § 7</span>
        <li><a href="#local-link-pseudo">:local-link</a><span>, § 2.1</span>
        <li><a href="#nth-col-pseudo">:nth-col()</a><span>, § 8.2</span>
        <li><a href="#nth-last-col-pseudo">:nth-last-col()</a><span>, § 8.3</span>
        <li><a href="#past-pseudo">:past</a><span>, § 5.2</span>
        <li><a href="#reference-combinator">参照結合子</a><span>, § 9.1</span>
        <li><a href="#state-pseudo">:state( &lt;ident> )</a><span>, § 6</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">参照により定義される用語</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSS-VALUES-4]</a> は次の用語を定義します:
            <ul>
                <li><span class="dfn-paneled" id="c297b070">#</span>
                <li><span class="dfn-paneled" id="dcecfc13">&lt;ident></span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS2]</a> は次の用語を定義します:
            <ul>
                <li><span class="dfn-paneled" id="05a372b0">型セレクター</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS3SYN]</a> は次の用語を定義します:
            <ul>
                <li><span class="dfn-paneled" id="eebbfe3d">&lt;number-token></span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a> は次の用語を定義します:
            <ul>
                <li><span class="dfn-paneled" id="b6fb7a51">カスタム要素</span>
                <li><span class="dfn-paneled" id="b87923a3">見出しレベル</span>
                <li><span class="dfn-paneled" id="d7d642a2">input</span>
                <li><span class="dfn-paneled" id="f4da6587">popover</span>
                <li><span class="dfn-paneled" id="141caf46">states set</span>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a> は次の用語を定義します:
            <ul>
                <li><span class="dfn-paneled" id="7a87d819">is</span>
            </ul>
        <li>
            <a data-link-type="biblio">[SELECTORS-4]</a> は次の用語を定義します:
            <ul>
                <li><span class="dfn-paneled" id="31c47bc6">複合セレクター</span>
                <li><span class="dfn-paneled" id="41bf002c">ID セレクター</span>
                <li><span class="dfn-paneled" id="388bc3fc">セレクター</span>
                <li><span class="dfn-paneled" id="ba72ce8f">詳細度</span>
            </ul>
        <li>
            <a data-link-type="biblio">[WAI-ARIA-1.2]</a> は次の用語を定義します:
            <ul>
                <li><span class="dfn-paneled" id="f00338b8">ホスト言語</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参照</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">規定参照</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-css-values-4">[CSS-VALUES-4]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-4/"><cite>CSS Values and Units
                    Module Level 4</cite></a>. 2024年3月12日. WD. URL: <a
                href="https://www.w3.org/TR/css-values-4/">https://www.w3.org/TR/css-values-4/</a>
        <dt id="biblio-css3syn">[CSS3SYN]
        <dd>Tab Atkins Jr.; Simon Sapin. <a href="https://www.w3.org/TR/css-syntax-3/"><cite>CSS Syntax Module Level
                    3</cite></a>. 2021年12月24日. CRD. URL: <a
                href="https://www.w3.org/TR/css-syntax-3/">https://www.w3.org/TR/css-syntax-3/</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>.
            Living Standard. URL: <a
                href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra
                    Standard</cite></a>. Living Standard. URL: <a
                href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to
                    Indicate Requirement Levels</cite></a>. 1997年3月. Best Current Practice. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-selectors-4">[SELECTORS-4]
        <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://www.w3.org/TR/selectors-4/"><cite>Selectors Level
                    4</cite></a>. 2026年1月22日. WD. URL: <a
                href="https://www.w3.org/TR/selectors-4/">https://www.w3.org/TR/selectors-4/</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">参考参照</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-css2">[CSS2]
        <dd>Bert Bos; et al. <a href="https://www.w3.org/TR/CSS2/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS
                    2.1) Specification</cite></a>. 2011年6月7日. REC. URL: <a
                href="https://www.w3.org/TR/CSS2/">https://www.w3.org/TR/CSS2/</a>
        <dt id="biblio-html5">[HTML5]
        <dd>Ian Hickson; et al. <a href="https://www.w3.org/TR/html5/"><cite>HTML5</cite></a>. 2018年3月27日. REC. URL:
            <a href="https://www.w3.org/TR/html5/">https://www.w3.org/TR/html5/</a>
        <dt id="biblio-wai-aria-12">[WAI-ARIA-1.2]
        <dd>Joanmarie Diggs; et al. <a href="https://www.w3.org/TR/wai-aria-1.2/"><cite>Accessible Rich Internet
                    Applications (WAI-ARIA) 1.2</cite></a>. 2023年6月6日. REC. URL: <a
                href="https://www.w3.org/TR/wai-aria-1.2/">https://www.w3.org/TR/wai-aria-1.2/</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issue 索引</span><a
            class="self-link" href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue"> <strong>これは <a href="https://www.w3.org/TR/selectors-4/">Selectors
                    Level 4</a> に対する差分仕様です。</strong> <a class="issue-return" href="#issue-edc8dd61"
                title="Jump to section">↵</a>
        </div>
        <div class="issue"> 文書 URL が少なくとも N 個のセグメントを持つ場合、
            <span class="css">:local-link(N)</span> が少なくとも N 個のセグメントを持つリンク URL にのみ一致することは明確です。
            （これにより :local-link に一貫した意味論を割り当てられ、たとえば :local-link(2) が GitHub における「リポジトリ内」リンクを意味する、といったことができます。）
            では、文書 URL が N 未満のセグメントしか持たず、
            リンクが同一ページである場合はどうでしょうか？
            「null セグメント」は一致として数えるべきでしょうか、それとも数えないべきでしょうか？ <a class="issue-return" href="#issue-dd3371ba"
                title="Jump to section">↵</a>
        </div>
    </div>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "05a372b0": { "dfnID": "05a372b0", "dfnText": "type selector", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-x11" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "https://www.w3.org/TR/CSS2/selector.html#x11" },
                "141caf46": { "dfnID": "141caf46", "dfnText": "states set", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-states-set" }, { "id": "ref-for-states-set\u2460" }], "title": "6. \nExposing custom state: the :state() pseudo-class" }], "url": "https://html.spec.whatwg.org/multipage/custom-elements.html#states-set" },
                "31c47bc6": { "dfnID": "31c47bc6", "dfnText": "compound selector", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-compound" }], "title": "5.1. \nThe Current-element Pseudo-class: :current" }, { "refs": [{ "id": "ref-for-compound\u2460" }, { "id": "ref-for-compound\u2461" }, { "id": "ref-for-compound\u2462" }], "title": "9.1. \nReference combinators /ref/" }], "url": "https://www.w3.org/TR/selectors-4/#compound" },
                "388bc3fc": { "dfnID": "388bc3fc", "dfnText": "selector", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-selector" }], "title": "Unnumbered Section" }], "url": "https://www.w3.org/TR/selectors-4/#selector" },
                "41bf002c": { "dfnID": "41bf002c", "dfnText": "ID selector", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-id-selector" }], "title": "9.1. \nReference combinators /ref/" }], "url": "https://www.w3.org/TR/selectors-4/#id-selector" },
                "7a87d819": { "dfnID": "7a87d819", "dfnText": "is", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-string-is" }, { "id": "ref-for-string-is\u2460" }], "title": "6. \nExposing custom state: the :state() pseudo-class" }], "url": "https://infra.spec.whatwg.org/#string-is" },
                "b6fb7a51": { "dfnID": "b6fb7a51", "dfnText": "custom element", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-custom-element" }], "title": "6. \nExposing custom state: the :state() pseudo-class" }], "url": "https://html.spec.whatwg.org/multipage/custom-elements.html#custom-element" },
                "b87923a3": { "dfnID": "b87923a3", "dfnText": "heading level", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-heading-level" }, { "id": "ref-for-heading-level\u2460" }, { "id": "ref-for-heading-level\u2461" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "https://html.spec.whatwg.org/multipage/sections.html#heading-level" },
                "ba72ce8f": { "dfnID": "ba72ce8f", "dfnText": "specificity", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-specificity" }, { "id": "ref-for-specificity\u2460" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "https://www.w3.org/TR/selectors-4/#specificity" },
                "blank-pseudo": { "dfnID": "blank-pseudo", "dfnText": ":blank", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-blank-pseudo" }, { "id": "ref-for-blank-pseudo\u2460" }, { "id": "ref-for-blank-pseudo\u2461" }, { "id": "ref-for-blank-pseudo\u2462" }, { "id": "ref-for-blank-pseudo\u2463" }, { "id": "ref-for-blank-pseudo\u2464" }, { "id": "ref-for-blank-pseudo\u2465" }], "title": "4.1.1. \nThe Empty-Value Pseudo-class: :blank" }, { "refs": [{ "id": "ref-for-blank-pseudo\u2466" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#blank-pseudo" },
                "c297b070": { "dfnID": "c297b070", "dfnText": "#", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-comma" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "column-combinator": { "dfnID": "column-combinator", "dfnText": "column combinator", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-column-combinator" }], "title": "8. \nGrid-Structural Selectors" }], "url": "#column-combinator" },
                "current-pseudo": { "dfnID": "current-pseudo", "dfnText": ":current", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-current-pseudo" }, { "id": "ref-for-current-pseudo\u2460" }, { "id": "ref-for-current-pseudo\u2461" }], "title": "5. \nTime-dimensional Pseudo-classes" }, { "refs": [{ "id": "ref-for-current-pseudo\u2462" }, { "id": "ref-for-current-pseudo\u2463" }, { "id": "ref-for-current-pseudo\u2464" }, { "id": "ref-for-current-pseudo\u2465" }], "title": "5.1. \nThe Current-element Pseudo-class: :current" }, { "refs": [{ "id": "ref-for-current-pseudo\u2466" }, { "id": "ref-for-current-pseudo\u2467" }], "title": "5.2. \nThe Past-element Pseudo-class: :past" }, { "refs": [{ "id": "ref-for-current-pseudo\u2468" }, { "id": "ref-for-current-pseudo\u2460\u24ea" }], "title": "5.3. \nThe Future-element Pseudo-class: :future" }], "url": "#current-pseudo" },
                "d7d642a2": { "dfnID": "d7d642a2", "dfnText": "input", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-the-input-element" }], "title": "9.1. \nReference combinators /ref/" }], "url": "https://html.spec.whatwg.org/multipage/input.html#the-input-element" },
                "dcecfc13": { "dfnID": "dcecfc13", "dfnText": "<ident>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-ident" }], "title": "6. \nExposing custom state: the :state() pseudo-class" }], "url": "https://www.w3.org/TR/css-values-4/#typedef-ident" },
                "eebbfe3d": { "dfnID": "eebbfe3d", "dfnText": "<number-token>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-number-token" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "https://www.w3.org/TR/css-syntax-3/#typedef-number-token" },
                "f00338b8": { "dfnID": "f00338b8", "dfnText": "host language", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dfn-host-language" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }], "url": "https://w3c.github.io/aria/#dfn-host-language" },
                "f4da6587": { "dfnID": "f4da6587", "dfnText": "popover", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-attr-popover" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }], "url": "https://html.spec.whatwg.org/multipage/popover.html#attr-popover" },
                "future-pseudo": { "dfnID": "future-pseudo", "dfnText": ":future", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-future-pseudo" }, { "id": "ref-for-future-pseudo\u2460" }, { "id": "ref-for-future-pseudo\u2461" }], "title": "5. \nTime-dimensional Pseudo-classes" }, { "refs": [{ "id": "ref-for-future-pseudo\u2462" }, { "id": "ref-for-future-pseudo\u2463" }], "title": "5.3. \nThe Future-element Pseudo-class: :future" }], "url": "#future-pseudo" },
                "heading-functional-pseudo": { "dfnID": "heading-functional-pseudo", "dfnText": ":heading()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-heading-functional-pseudo" }, { "id": "ref-for-heading-functional-pseudo\u2460" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }, { "refs": [{ "id": "ref-for-heading-functional-pseudo\u2461" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#heading-functional-pseudo" },
                "heading-pseudo": { "dfnID": "heading-pseudo", "dfnText": ":heading", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-heading-pseudo" }, { "id": "ref-for-heading-pseudo\u2460" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }, { "refs": [{ "id": "ref-for-heading-pseudo\u2461" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#heading-pseudo" },
                "interest-source": { "dfnID": "interest-source", "dfnText": "interest source", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-interest-source" }, { "id": "ref-for-interest-source\u2460" }, { "id": "ref-for-interest-source\u2461" }, { "id": "ref-for-interest-source\u2462" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }], "url": "#interest-source" },
                "interest-target": { "dfnID": "interest-target", "dfnText": "interest target", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-interest-target" }, { "id": "ref-for-interest-target\u2460" }, { "id": "ref-for-interest-target\u2461" }, { "id": "ref-for-interest-target\u2462" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }], "url": "#interest-target" },
                "local-link-pseudo": { "dfnID": "local-link-pseudo", "dfnText": ":local-link", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-local-link-pseudo" }, { "id": "ref-for-local-link-pseudo\u2460" }], "title": "2.1. \nThe Local Link Pseudo-class :local-link" }, { "refs": [{ "id": "ref-for-local-link-pseudo\u2461" }, { "id": "ref-for-local-link-pseudo\u2462" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#local-link-pseudo" },
                "nth-col-pseudo": { "dfnID": "nth-col-pseudo", "dfnText": ":nth-col(An+B)", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-nth-col-pseudo" }], "title": "8. \nGrid-Structural Selectors" }, { "refs": [{ "id": "ref-for-nth-col-pseudo\u2460" }], "title": "8.2. \n:nth-col() pseudo-class" }], "url": "#nth-col-pseudo" },
                "nth-last-col-pseudo": { "dfnID": "nth-last-col-pseudo", "dfnText": ":nth-last-col(An+B)", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-nth-last-col-pseudo" }], "title": "8. \nGrid-Structural Selectors" }, { "refs": [{ "id": "ref-for-nth-last-col-pseudo\u2460" }], "title": "8.3. \n:nth-last-col() pseudo-class" }], "url": "#nth-last-col-pseudo" },
                "past-pseudo": { "dfnID": "past-pseudo", "dfnText": ":past", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-past-pseudo" }, { "id": "ref-for-past-pseudo\u2460" }, { "id": "ref-for-past-pseudo\u2461" }], "title": "5. \nTime-dimensional Pseudo-classes" }, { "refs": [{ "id": "ref-for-past-pseudo\u2462" }, { "id": "ref-for-past-pseudo\u2463" }], "title": "5.2. \nThe Past-element Pseudo-class: :past" }], "url": "#past-pseudo" },
                "reference-combinator": { "dfnID": "reference-combinator", "dfnText": "reference combinator", "external": false, "refSections": [], "url": "#reference-combinator" },
                "selectordef-column": { "dfnID": "selectordef-column", "dfnText": "||", "external": false, "refSections": [], "url": "#selectordef-column" },
                "selectordef-current": { "dfnID": "selectordef-current", "dfnText": ":current()", "external": false, "refSections": [], "url": "#selectordef-current" },
                "selectordef-interest-source": { "dfnID": "selectordef-interest-source", "dfnText": ":interest-source", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-selectordef-interest-source" }, { "id": "ref-for-selectordef-interest-source\u2460" }, { "id": "ref-for-selectordef-interest-source\u2461" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }, { "refs": [{ "id": "ref-for-selectordef-interest-source\u2462" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#selectordef-interest-source" },
                "selectordef-interest-target": { "dfnID": "selectordef-interest-target", "dfnText": ":interest-target", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-selectordef-interest-target" }, { "id": "ref-for-selectordef-interest-target\u2460" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }, { "refs": [{ "id": "ref-for-selectordef-interest-target\u2461" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#selectordef-interest-target" },
                "state-pseudo": { "dfnID": "state-pseudo", "dfnText": ":state( <ident> )", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-state-pseudo" }, { "id": "ref-for-state-pseudo\u2460" }], "title": "6. \nExposing custom state: the :state() pseudo-class" }, { "refs": [{ "id": "ref-for-state-pseudo\u2461" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#state-pseudo" },
                "typedef-level": { "dfnID": "typedef-level", "dfnText": "<level>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-level" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "#typedef-level" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#blank-pseudo": { "displayText": ":blank", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":blank", "type": "selector", "url": "#blank-pseudo" },
                "#column-combinator": { "displayText": "column combinator", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": "column combinator", "type": "dfn", "url": "#column-combinator" },
                "#current-pseudo": { "displayText": ":current", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":current", "type": "selector", "url": "#current-pseudo" },
                "#future-pseudo": { "displayText": ":future", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":future", "type": "selector", "url": "#future-pseudo" },
                "#heading-functional-pseudo": { "displayText": ":heading()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":heading()", "type": "selector", "url": "#heading-functional-pseudo" },
                "#heading-pseudo": { "displayText": ":heading", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":heading", "type": "selector", "url": "#heading-pseudo" },
                "#interest-source": { "displayText": "interest source", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": "interest source", "type": "dfn", "url": "#interest-source" },
                "#interest-target": { "displayText": "interest target", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": "interest target", "type": "dfn", "url": "#interest-target" },
                "#local-link-pseudo": { "displayText": ":local-link", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":local-link", "type": "selector", "url": "#local-link-pseudo" },
                "#nth-col-pseudo": { "displayText": ":nth-col()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":nth-col()", "type": "selector", "url": "#nth-col-pseudo" },
                "#nth-last-col-pseudo": { "displayText": ":nth-last-col()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":nth-last-col()", "type": "selector", "url": "#nth-last-col-pseudo" },
                "#past-pseudo": { "displayText": ":past", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":past", "type": "selector", "url": "#past-pseudo" },
                "#selectordef-interest-source": { "displayText": ":interest-source", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":interest-source", "type": "selector", "url": "#selectordef-interest-source" },
                "#selectordef-interest-target": { "displayText": ":interest-target", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":interest-target", "type": "selector", "url": "#selectordef-interest-target" },
                "#state-pseudo": { "displayText": ":state( <ident> )", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":state( <ident> )", "type": "selector", "url": "#state-pseudo" },
                "#typedef-level": { "displayText": "<level>", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": "<level>", "type": "type", "url": "#typedef-level" },
                "https://html.spec.whatwg.org/multipage/custom-elements.html#custom-element": { "displayText": "custom element", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "custom element", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/custom-elements.html#custom-element" },
                "https://html.spec.whatwg.org/multipage/custom-elements.html#states-set": { "displayText": "states set", "export": false, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "states set", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/custom-elements.html#states-set" },
                "https://html.spec.whatwg.org/multipage/input.html#the-input-element": { "displayText": "input", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "input", "type": "element", "url": "https://html.spec.whatwg.org/multipage/input.html#the-input-element" },
                "https://html.spec.whatwg.org/multipage/popover.html#attr-popover": { "displayText": "popover", "export": true, "for_": ["html-global"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "popover", "type": "element-attr", "url": "https://html.spec.whatwg.org/multipage/popover.html#attr-popover" },
                "https://html.spec.whatwg.org/multipage/sections.html#heading-level": { "displayText": "heading level", "export": false, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "heading level", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/sections.html#heading-level" },
                "https://infra.spec.whatwg.org/#string-is": { "displayText": "is", "export": true, "for_": ["string"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "is", "type": "dfn", "url": "https://infra.spec.whatwg.org/#string-is" },
                "https://w3c.github.io/aria/#dfn-host-language": { "displayText": "host language", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "wai-aria", "spec": "wai-aria-1.2", "status": "current", "text": "host language", "type": "dfn", "url": "https://w3c.github.io/aria/#dfn-host-language" },
                "https://www.w3.org/TR/CSS2/selector.html#x11": { "displayText": "type selector", "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css", "spec": "css2", "status": "snapshot", "text": "type selector", "type": "dfn", "url": "https://www.w3.org/TR/CSS2/selector.html#x11" },
                "https://www.w3.org/TR/css-syntax-3/#typedef-number-token": { "displayText": "<number-token>", "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-syntax", "spec": "css-syntax-3", "status": "snapshot", "text": "<number-token>", "type": "type", "url": "https://www.w3.org/TR/css-syntax-3/#typedef-number-token" },
                "https://www.w3.org/TR/css-values-4/#mult-comma": { "displayText": "#", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "#", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "https://www.w3.org/TR/css-values-4/#typedef-ident": { "displayText": "<ident>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<ident>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#typedef-ident" },
                "https://www.w3.org/TR/selectors-4/#compound": { "displayText": "compound selector", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "compound selector", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#compound" },
                "https://www.w3.org/TR/selectors-4/#id-selector": { "displayText": "ID selector", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "id selector", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#id-selector" },
                "https://www.w3.org/TR/selectors-4/#selector": { "displayText": "selector", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "selector", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#selector" },
                "https://www.w3.org/TR/selectors-4/#specificity": { "displayText": "specificity", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "specificity", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#specificity" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
                    // Give the original term if it's being displayed in a different way.
                    // But allow casing differences, they're insignificant.
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.displayText)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const refHintKey = link.getAttribute("data-refhint-key");
                let key = url;
                if (refHintKey) {
                    key = refHintKey + "_" + url;
                }
                const ref = refsData[key];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-wpt */
        "use strict";
        {
            let wptData = {
                "paths": ["/css/css-pseudo/", "/css/selectors/"],
            };

            document.addEventListener("DOMContentLoaded", async () => {
                if (wptData.paths.length == 0) return;

                const runsUrl = "https://wpt.fyi/api/runs?label=master&label=stable&max-count=1&product=chrome&product=firefox&product=safari&product=edge";
                const runs = await (await fetch(runsUrl)).json();

                let testResults = [];
                for (const pathPrefix of wptData.paths) {
                    const pathResults = await (await fetch("https://wpt.fyi/api/search", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            "run_ids": runs.map(x => x.id),
                            "query": { "path": pathPrefix },
                        })
                    })).json();
                    testResults = testResults.concat(pathResults.results);
                }

                const browsers = runs.map(x => ({ name: x.browser_name, version: x.browser_version, passes: 0, total: 0 }));
                const resultsFromPath = new Map(testResults.map(result => {
                    const testPath = result.test;
                    const passes = result.legacy_status.map(x => [x.passes, x.total]);
                    return [testPath, passes];
                }));
                const seenTests = new Set();
                document.querySelectorAll(".wpt-name").forEach(nameEl => {
                    const passData = resultsFromPath.get("/" + nameEl.getAttribute("title"));
                    if (!passData) {
                        console.log("Couldn't find test in results:", nameEl);
                        return
                    }
                    const numTests = passData[0][1];
                    if (numTests > 1) {
                        nameEl.insertAdjacentElement("beforeend",
                            mk.small({}, ` (${numTests} tests)`));
                    }
                    if (passData == undefined) return;
                    const resultsEl = mk.span({ "class": "wpt-results" },
                        ...passData.map((p, i) => mk.span(
                            {
                                "title": `${browsers[i].name} ${p[0]}/${p[1]}`,
                                "class": "wpt-result",
                                "style": `background: conic-gradient(forestgreen ${p[0] / p[1] * 360}deg, darkred 0deg);`,
                            })),
                    );
                    nameEl.insertAdjacentElement("afterend", resultsEl);

                    // Only update the summary pass/total count if we haven't seen this
                    // test before, to support authors listing the same test multiple times
                    // in a spec.
                    if (!seenTests.has(nameEl.getAttribute("title"))) {
                        seenTests.add(nameEl.getAttribute("title"));
                        passData.forEach((p, i) => {
                            browsers[i].passes += p[0];
                            browsers[i].total += p[1];
                        });
                    }
                });
                const overview = document.querySelector(".wpt-overview");
                if (overview) {
                    overview.appendChild(mk.ul({}, ...browsers.map(formatWptResult)));
                    document.head.appendChild(mk.style({},
                        `.wpt-overview ul { display: flex; flex-flow: row wrap; gap: .2em; justify-content: start; list-style: none; padding: 0; margin: 0;}
             .wpt-overview li { padding: .25em 1em; color: black; text-align: center; }
             .wpt-overview img { height: 1.5em; height: max(1.5em, 32px); background: transparent; }
             .wpt-overview .browser { font-weight: bold; }
             .wpt-overview .passes-none { background: #e57373; }
             .wpt-overview .passes-hardly { background: #ffb74d; }
             .wpt-overview .passes-a-few { background: #ffd54f; }
             .wpt-overview .passes-half { background: #fff176; }
             .wpt-overview .passes-lots { background: #dce775; }
             .wpt-overview .passes-most { background: #aed581; }
             .wpt-overview .passes-all { background: #81c784; }`));
                }
            });

            function formatWptResult({ name, version, passes, total }) {
                const passRate = passes / total;
                let passClass = "";
                if (passRate == 0) passClass = "passes-none";
                else if (passRate < .2) passClass = "passes-hardly";
                else if (passRate < .4) passClass = "passes-a-few";
                else if (passRate < .6) passClass = "passes-half";
                else if (passRate < .8) passClass = "passes-lots";
                else if (passRate < 1) passClass = "passes-most";
                else passClass = "passes-all";

                name = name[0].toUpperCase() + name.slice(1);
                const shortVersion = /^\d+/.exec(version);
                const icon = []

                if (name == "Chrome") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/chrome_64x64.png" }));
                if (name == "Edge") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/edge_64x64.png" }));
                if (name == "Safari") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/safari_64x64.png" }));
                if (name == "Firefox") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/firefox_64x64.png" }));

                return mk.li({ "class": passClass },
                    mk.nobr({ 'class': 'browser' }, ...icon, ` ${name} ${shortVersion}`),
                    mk.br(),
                    mk.nobr({ 'class': 'pass-rate' }, `${passes}/${total}`)
                );
            }
        }
    </script>
    <script src="https://htmlspecs.com/dropdown.js"></script>