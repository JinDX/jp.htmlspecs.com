<!doctype html>
<html lang="ja-JP">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>CSS ルビ注釈レイアウトモジュール レベル 1</title>
    <meta content="WD" name="w3c-status">
    <!-- <meta content="Bikeshed version 0fe3edbd9, updated Fri Dec 2 11:39:45 2022 -0800" name="generator"> -->
    <link href="https://www.w3.org/TR/css-ruby-1/" rel="canonical">
    <!-- <meta content="2bddbdfe4aa2630648d1988fc8453018b0b060ca" name="document-revision"> -->
    <script defer src="https://test.csswg.org/harness/annotate.js#!css-ruby-1_dev/css-ruby-1"></script>
    <style>
        /* ASCII diagram colors */
        .base {
            color: blue;
        }

        .annot {
            color: red;
        }

        .column {
            color: gray;
        }

        .flagtxt1 {
            color: green;
        }

        .flagtxt2 {
            color: #ae4a00;
        }

        .flagbg1 {
            background: green;
            opacity: 0.3;
        }

        .flagbg2 {
            background: orange;
            opacity: 0.3;
        }
    </style>
    <style>
        /* style-autolinks */

        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }
    </style>
    <style>
        /* style-counters */

        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* style-dfn-panel */

        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0;
        }

        .dfn-panel li {
            list-style: inside;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled {
            cursor: pointer;
        }
    </style>
    <style>
        /* style-issues */

        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* style-md-lists */

        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* style-selflinks */

        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* style-syntax-highlighting */

        code.highlight {
            padding: .1em;
            border-radius: .3em;
        }

        pre.highlight,
        pre>code.highlight {
            display: block;
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
            border-radius: 0;
        }

        .highlight:not(.idl) {
            background: rgba(0, 0, 0, .03);
        }

        c-[a] {
            color: #990055
        }

        /* Keyword.Declaration */
        c-[b] {
            color: #990055
        }

        /* Keyword.Type */
        c-[c] {
            color: #708090
        }

        /* Comment */
        c-[d] {
            color: #708090
        }

        /* Comment.Multiline */
        c-[e] {
            color: #0077aa
        }

        /* Name.Attribute */
        c-[f] {
            color: #669900
        }

        /* Name.Tag */
        c-[g] {
            color: #222222
        }

        /* Name.Variable */
        c-[k] {
            color: #990055
        }

        /* Keyword */
        c-[l] {
            color: #000000
        }

        /* Literal */
        c-[m] {
            color: #000000
        }

        /* Literal.Number */
        c-[n] {
            color: #0077aa
        }

        /* Name */
        c-[o] {
            color: #999999
        }

        /* Operator */
        c-[p] {
            color: #999999
        }

        /* Punctuation */
        c-[s] {
            color: #a67f59
        }

        /* Literal.String */
        c-[t] {
            color: #a67f59
        }

        /* Literal.String.Single */
        c-[u] {
            color: #a67f59
        }

        /* Literal.String.Double */
        c-[cp] {
            color: #708090
        }

        /* Comment.Preproc */
        c-[c1] {
            color: #708090
        }

        /* Comment.Single */
        c-[cs] {
            color: #708090
        }

        /* Comment.Special */
        c-[kc] {
            color: #990055
        }

        /* Keyword.Constant */
        c-[kn] {
            color: #990055
        }

        /* Keyword.Namespace */
        c-[kp] {
            color: #990055
        }

        /* Keyword.Pseudo */
        c-[kr] {
            color: #990055
        }

        /* Keyword.Reserved */
        c-[ld] {
            color: #000000
        }

        /* Literal.Date */
        c-[nc] {
            color: #0077aa
        }

        /* Name.Class */
        c-[no] {
            color: #0077aa
        }

        /* Name.Constant */
        c-[nd] {
            color: #0077aa
        }

        /* Name.Decorator */
        c-[ni] {
            color: #0077aa
        }

        /* Name.Entity */
        c-[ne] {
            color: #0077aa
        }

        /* Name.Exception */
        c-[nf] {
            color: #0077aa
        }

        /* Name.Function */
        c-[nl] {
            color: #0077aa
        }

        /* Name.Label */
        c-[nn] {
            color: #0077aa
        }

        /* Name.Namespace */
        c-[py] {
            color: #0077aa
        }

        /* Name.Property */
        c-[ow] {
            color: #999999
        }

        /* Operator.Word */
        c-[mb] {
            color: #000000
        }

        /* Literal.Number.Bin */
        c-[mf] {
            color: #000000
        }

        /* Literal.Number.Float */
        c-[mh] {
            color: #000000
        }

        /* Literal.Number.Hex */
        c-[mi] {
            color: #000000
        }

        /* Literal.Number.Integer */
        c-[mo] {
            color: #000000
        }

        /* Literal.Number.Oct */
        c-[sb] {
            color: #a67f59
        }

        /* Literal.String.Backtick */
        c-[sc] {
            color: #a67f59
        }

        /* Literal.String.Char */
        c-[sd] {
            color: #a67f59
        }

        /* Literal.String.Doc */
        c-[se] {
            color: #a67f59
        }

        /* Literal.String.Escape */
        c-[sh] {
            color: #a67f59
        }

        /* Literal.String.Heredoc */
        c-[si] {
            color: #a67f59
        }

        /* Literal.String.Interpol */
        c-[sx] {
            color: #a67f59
        }

        /* Literal.String.Other */
        c-[sr] {
            color: #a67f59
        }

        /* Literal.String.Regex */
        c-[ss] {
            color: #a67f59
        }

        /* Literal.String.Symbol */
        c-[vc] {
            color: #0077aa
        }

        /* Name.Variable.Class */
        c-[vg] {
            color: #0077aa
        }

        /* Name.Variable.Global */
        c-[vi] {
            color: #0077aa
        }

        /* Name.Variable.Instance */
        c-[il] {
            color: #000000
        }

        /* Literal.Number.Integer.Long */
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">CSS ルビ注釈レイアウトモジュール レベル 1</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types#WD">W3C 作業草案</a>、<time class="dt-updated"
                datetime="2022-12-31">2022年12月31日</time></p>
        <details open>
            <summary>この文書の詳細</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>このバージョン:
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2022/WD-css-ruby-1-20221231/">https://www.w3.org/TR/2022/WD-css-ruby-1-20221231/</a>
                    <dt>最新公表バージョン:
                    <dd><a href="https://www.w3.org/TR/css-ruby-1/">https://www.w3.org/TR/css-ruby-1/</a>
                    <dt>編集中草案:
                    <dd><a href="https://drafts.csswg.org/css-ruby-1/">https://drafts.csswg.org/css-ruby-1/</a>
                    <dt>以前のバージョン:
                    <dd><a href="https://www.w3.org/TR/2021/WD-css-ruby-1-20211202/"
                            rel="prev">https://www.w3.org/TR/2021/WD-css-ruby-1-20211202/</a>
                    <dd><a href="https://www.w3.org/TR/2021/WD-css-ruby-1-20210310/"
                            rel="prev">https://www.w3.org/TR/2021/WD-css-ruby-1-20210310/</a>
                    <dd><a href="https://www.w3.org/TR/2020/WD-css-ruby-1-20200429/"
                            rel="prev">https://www.w3.org/TR/2020/WD-css-ruby-1-20200429/</a>
                    <dd><a href="https://www.w3.org/TR/2014/WD-css-ruby-1-20140805/"
                            rel="prev">https://www.w3.org/TR/2014/WD-css-ruby-1-20140805/</a>
                    <dd><a href="https://www.w3.org/TR/2013/WD-css3-ruby-20130919/"
                            rel="prev">https://www.w3.org/TR/2013/WD-css3-ruby-20130919/</a>
                    <dt>履歴:
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/css-ruby-1">https://www.w3.org/standards/history/css-ruby-1</a>
                    <dt>テストスイート:
                    <dd><a
                            href="https://www.w3.org/International/tests/repo/results/css-ruby">https://www.w3.org/International/tests/repo/results/css-ruby</a>
                    <dt>フィードバック:
                    <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-ruby-1">CSSWG イシューリポジトリ</a>
                    <dd><a href="#issues-index">仕様内インライン</a>
                    <dt class="editor">編集者:
                    <dd class="editor p-author h-card vcard" data-editor-id="35400"><a class="p-name fn u-url url"
                            href="http://fantasai.inkedblade.net/contact">Elika J. Etemad / fantasai</a> (<span
                            class="p-org org">招待専門家</span>)
                    <dd class="editor p-author h-card vcard" data-editor-id="45369"><a class="p-name fn u-email email"
                            href="mailto:kojiishi@gmail.com">Koji Ishii</a> (<span class="p-org org">Google</span>)
                    <dd class="editor p-author h-card vcard" data-editor-id="73936"><a class="p-name fn u-url url"
                            href="https://www.upsuper.org/">Xidorn Quan</a> (<a class="p-org org"
                            href="https://www.mozilla.org/">Mozilla</a>)
                    <dd class="editor p-author h-card vcard" data-editor-id="43241"><a class="p-name fn u-url url"
                            href="https://florian.rivoal.net/">Florian Rivoal</a> (<span class="p-org org">招待専門家</span>)
                    <dt>この仕様への編集提案:
                    <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/css-ruby-1/Overview.bs">GitHub エディター</a>
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2022 <a
                href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a
                href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a
                href="https://www.ercim.eu/"><abbr
                    title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a
                href="https://www.keio.ac.jp/">Keio</a>, <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C <a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" rel="license">permissive
                document license</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">概要</span></h2>
        <p>「ルビ」とは、基底テキストのそばに並べて配置される短いテキストの一種であり、行間注記の形式です。

            主に東アジアの文書において発音や短い注釈を示すために用いられます。
            このモジュールでは、CSSでルビ注釈を表示する際のレンダリングモデルおよび書式制御について説明します。</p>
        <a href="https://www.w3.org/TR/CSS/">CSS</a>は、構造化文書（HTMLやXMLなど）の画面表示や印刷などのレンダリングを記述するための言語です。
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">この文書の位置付け</span></h2>
    <div data-fill-with="status">
        <p><em>このセクションは、本書が発行された時点での文書の位置付けを説明します。
                最新のW3C出版物の一覧や本技術レポートの最新版は、
                <a href="https://www.w3.org/TR/">https://www.w3.org/TR/</a> にあるW3C技術レポート索引で確認できます。</em> </p>
        <p> 本書は<a href="https://www.w3.org/groups/wg/css">CSS作業グループ</a>によって
            <strong>作業草案</strong>として
            <a href="https://www.w3.org/2021/Process-20211102/#recs-and-notes">勧告トラック</a>に従い公開されました。
            作業草案としての公開は、<abbr title="World Wide Web Consortium">W3C</abbr>およびその会員による支持を意味するものではありません。
        </p>
        <p> 本書はドラフト文書であり、今後随時更新・差し替え・廃止される可能性があります。
            本書を進行中の作業以外のものとして引用するのは適切ではありません。 </p>
        <p>ご意見は<a href="https://github.com/w3c/csswg-drafts/issues">GitHubでイシューを提出</a>（推奨）、タイトルに「css-ruby」を含めて
            “[css-ruby] <i>…コメントの要約…</i>”の形でお送りください。
            すべてのイシューやコメントは<a href="https://lists.w3.org/Archives/Public/public-css-archive/">アーカイブ</a>されています。
            または、(<a href="https://lists.w3.org/Archives/Public/www-style/">アーカイブ</a>あり) 公開メーリングリスト <a
                href="mailto:www-style@w3.org?Subject=%5Bcss-ruby%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>
            へご送信いただくことも可能です。 </p>
        <p>本書は<a href="https://www.w3.org/2021/Process-20211102/"
                id="w3c_process_revision">2021年11月2日版W3Cプロセス文書</a>に準拠しています。 </p>
        <p>本書は<a href="https://www.w3.org/Consortium/Patent-Policy-20200915/">W3C特許ポリシー</a>の下で運営されているグループによって作成されました。
            W3Cは、グループの成果物に関連してなされた特許開示の<a href="https://www.w3.org/groups/wg/css/ipr"
                rel="disclosure">公開リスト</a>を維持しています。
            そのページには特許開示の方法も記載されています。
            ある特許について実際に知識を有し、それが<a
                href="https://www.w3.org/Consortium/Patent-Policy-20200915/#def-essential">必須クレーム</a>を含むと考える個人は、<a
                href="https://www.w3.org/Consortium/Patent-Policy-20200915/#sec-Disclosure">W3C特許ポリシー第6節</a>に従って情報を開示しなければなりません。
        </p>
        <p></p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目次</h2>
        <ol class="toc" role="directory">
            <li>
                <a href="#intro"><span class="secno">1</span> <span class="content"> はじめに</span></a>
                <ol class="toc">
                    <li><a href="#ruby-def"><span class="secno">1.1</span> <span class="content"> ルビとは何か</span></a>
                    <li><a href="#placement"><span class="secno">1.2</span> <span class="content"> モジュール間の関係</span></a>
                    <li><a href="#values"><span class="secno">1.3</span> <span class="content"> 値の定義</span></a>
                    <li><a href="#diagram-conventions"><span class="secno">1.4</span> <span class="content">
                                図の表記規則</span></a>
                </ol>
            <li>
                <a href="#ruby-model"><span class="secno">2</span> <span class="content"> ルビボックスモデル</span></a>
                <ol class="toc">
                    <li>
                        <a href="#ruby-display"><span class="secno">2.1</span> <span class="content"> ルビ用の <span
                                    class="property">display</span> 値</span></a>
                        <ol class="toc">
                            <li><a href="#formatting-context"><span class="secno">2.1.1</span> <span class="content">
                                        ルビ整形コンテキスト</span></a>
                            <li><a href="#block-ruby"><span class="secno">2.1.2</span> <span class="content">
                                        非インラインルビ</span></a>
                        </ol>
                    <li><a href="#box-fixup"><span class="secno">2.2</span> <span class="content"> 匿名ルビボックス生成</span></a>
                    <li>
                        <a href="#ruby-pairing"><span class="secno">2.3</span> <span class="content"> 注釈ペアリング</span></a>
                        <ol class="toc">
                            <li><a href="#segment-pairing"><span class="secno">2.3.1</span> <span class="content">
                                        セグメントペアリングと注釈レベル</span></a>
                            <li><a href="#base-annotation-pairing"><span class="secno">2.3.2</span> <span
                                        class="content"> ユニットペアリングとスパン注釈</span></a>
                        </ol>
                    <li><a href="#hiding"><span class="secno">2.4</span> <span class="content"> 注釈の非表示：<span
                                    class="css">visibility: collapse</span>と自動非表示ルビ</span></a>
                    <li><a href="#white-space"><span class="secno">2.5</span> <span class="content"> 空白の折り畳み</span></a>
                </ol>
            <li>
                <a href="#ruby-layout"><span class="secno">3</span> <span class="content"> ルビのレイアウト</span></a>
                <ol class="toc">
                    <li>
                        <a href="#interlinear-layout"><span class="secno">3.1</span> <span class="content">
                                行間ルビレイアウト</span></a>
                        <ol class="toc">
                            <li><a href="#interlinear-inline"><span class="secno">3.1.1</span> <span class="content">
                                        インライン軸行間レイアウト</span></a>
                            <li><a href="#interlinear-block"><span class="secno">3.1.2</span> <span class="content">
                                        ブロック軸行間レイアウト</span></a>
                        </ol>
                    <li><a href="#inter-character-layout"><span class="secno">3.2</span> <span class="content">
                                字間ルビレイアウト</span></a>
                    <li><a href="#box-style"><span class="secno">3.3</span> <span class="content">
                                ルビボックスのスタイル付け</span></a>
                    <li>
                        <a href="#line-breaks"><span class="secno">3.4</span> <span class="content"> 行の折り返し</span></a>
                        <ol class="toc">
                            <li><a href="#break-between"><span class="secno">3.4.1</span> <span class="content">
                                        基底間の折り返し</span></a>
                            <li><a href="#break-within"><span class="secno">3.4.2</span> <span class="content">
                                        基底内での折り返し</span></a>
                        </ol>
                    <li><a href="#bidi"><span class="secno">3.5</span> <span class="content"> 双方向（Bidi）並べ替え</span></a>
                    <li><a href="#line-height"><span class="secno">3.6</span> <span class="content"> 行間隔</span></a>
                </ol>
            <li>
                <a href="#ruby-props"><span class="secno">4</span> <span class="content"> ルビ書式プロパティ</span></a>
                <ol class="toc">
                    <li><a href="#rubypos"><span class="secno">4.1</span> <span class="content"> ルビの配置: <span
                                    class="property">ruby-position</span>プロパティ</span></a>
                    <li><a href="#collapsed-ruby"><span class="secno">4.2</span> <span class="content"> 注釈スペースの共有: <span
                                    class="property">ruby-merge</span>プロパティ</span></a>
                    <li><a href="#ruby-align-property"><span class="secno">4.3</span> <span class="content"> ルビテキスト分布:
                                <span class="property">ruby-align</span>プロパティ</span></a>
                    <li><a href="#ruby-text-decoration"><span class="secno">4.4</span> <span class="content">
                                ルビテキストの装飾</span></a>
                </ol>
            <li>
                <a href="#edge-effects"><span class="secno">5</span> <span class="content"> エッジ効果</span></a>
                <ol class="toc">
                    <li><a href="#ruby-overhang"><span class="secno">5.1</span> <span class="content"> ルビのはみ出し: <span
                                    class="property">ruby-overhang</span>プロパティ</span></a>
                    <li><a href="#line-edge"><span class="secno">5.2</span> <span class="content"> 行端揃え</span></a>
                </ol>
            <li>
                <a href="#default-stylesheet"><span class="secno"></span> <span class="content"> 付録A:
                        サンプルスタイルシート</span></a>
                <ol class="toc">
                    <li><a href="#default-ua-ruby"><span class="secno"></span> <span class="content"> <span
                                    class="secno">A.1</span> デフォルトUAスタイルシート</span></a>
                    <li><a href="#default-inline"><span class="secno"></span> <span class="content"> <span
                                    class="secno">A.2</span> ルビ注釈のインライン化</span></a>
                    <li><a href="#default-parens"><span class="secno"></span> <span class="content"> <span
                                    class="secno">A.3</span> 括弧の自動生成</span></a>
                </ol>
            <li><a href="#glossary"><span class="secno">6</span> <span class="content"> 用語集</span></a>
            <li><a href="#acknowledgments"><span class="secno"></span> <span class="content"> 謝辞</span></a>
            <li>
                <a href="#changes"><span class="secno"></span> <span class="content"> 変更点</span></a>
                <ol class="toc">
                    <li><a href="#changes-20211202"><span class="secno"></span> <span class="content">
                                2021年12月2日WD以降の変更点</span></a>
                    <li><a href="#changes-20200429"><span class="secno"></span> <span class="content">
                                2020年4月29日WD以降の変更点</span></a>
                    <li><a href="#changes-20140805"><span class="secno"></span> <span class="content">
                                2014年8月5日WD以降の変更点</span></a>
                    <li><a href="#changes-20130919"><span class="secno"></span> <span class="content">
                                2013年9月19日WD以降の変更点</span></a>
                    <li><a href="#changes-20110630"><span class="secno"></span> <span class="content">
                                2011年6月30日WD以降の変更点</span></a>
                </ol>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content"> 適合性</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content"> 文書上の規約</span></a>
                    <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span class="content">
                                適合クラス</span></a>
                    <li>
                        <a href="#w3c-partial"><span class="secno"></span> <span class="content"> 部分実装</span></a>
                        <ol class="toc">
                            <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span
                                        class="content"> 不安定・独自拡張機能の実装</span></a>
                        </ol>
                    <li><a href="#w3c-testing"><span class="secno"></span> <span class="content"> 非実験的実装</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本仕様で定義されている用語</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">参照による定義用語</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">規範的参照</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">参考情報のある参照</span></a>
                </ol>
            <li><a href="#property-index"><span class="secno"></span> <span class="content">プロパティ索引</span></a>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">課題索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">
                はじめに</span><a class="self-link" href="#intro"></a></h2>
        <h3 class="heading settled" data-level="1.1" id="ruby-def"><span class="secno">1.1. </span><span
                class="content"> ルビとは何か</span><a class="self-link" href="#ruby-def"></a></h3>
        <p><em>この小節は規範的ではありません。</em></p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="ruby">ルビ</dfn>とは、他のテキスト（「基底」と呼ばれる）のそばに配置され、そのテキストに関連する注釈や発音ガイドとして機能するテキスト列の一般的な名称です。</p>
        <figure>
            <img alt="日本語テキストの各漢字の上にひらがなルビが付与されている例" height="64" src="https://www.w3.org/TR/css-ruby-1/images/ruby-context.png" width="324">
            <figcaption>日本語テキストに各漢字の発音を示すルビ（ふりがな）が付与されている例。</figcaption>
        </figure>
        <p>以下の図は、単純なケースとより複雑な構造の2つのルビの例を示しています。</p>
        <div class="example" id="example-43e96817">
            <a class="self-link" href="#example-43e96817"></a> この例では、1つの注釈が複数文字からなる基底テキストに付与されています。
            <div class="figure">
                <img alt="日本語表現の上にルビが付与されている例" height="66" src="https://www.w3.org/TR/css-ruby-1/images/licence.png" width="260">
                <p class="caption">日本語におけるルビの例（単純なケース）</p>
            </div>
            <p>日本語組版では、このケースを「対語ルビ」（日本語: <span
                    lang="ja">対語ルビ</span>、すなわち単語ごとルビ）やグループルビと呼ぶことがあります。注釈全体が複数文字の単語（全体）に対応しているためです。</p>
        </div>
        <div class="example" id="example-a47d36ef">
            <a class="self-link" href="#example-a47d36ef"></a> 2つ目の例では、基底テキストに2段階の注釈が付与されています。
            上部のひらがなは各漢字の発音を示し、下部の「Keio」と「University」は英訳を示しています。
            <div class="figure">
                <img alt="基底文字の上下に注釈テキストが付与された複雑なルビの例" height="108" src="https://www.w3.org/TR/css-ruby-1/images/ruby-univ.gif" width="277">
                <p class="caption">基底文字の上下に注釈テキストが付与された複雑なルビ</p>
            </div>
            <p>ひらがな注釈と対応する漢字基底文字の正しい対応関係を反映するため、基底レベルテキスト内の字送りが調整されていることに注目してください。
                （これは上図の4番目の漢字の周辺で発生しており、3文字のふりがなが付いています。）
                上記の例のような基底テキストの可変な字送りを避けるため、ひらがな注釈を<a data-link-type="dfn" href="#merged-annotation"
                    id="ref-for-merged-annotation">マージ注釈</a>としてスタイル指定することができ、これにより先ほどのグループルビのような見た目になります。
                ただし、基底-注釈の<a data-link-type="dfn" href="#pairing"
                    id="ref-for-pairing">ペアリング</a>はルビ構造で記録されているため、テキストが行をまたいで折り返された場合でも、注釈文字は対応する基底文字と正しくペアリングされたまま保持されます。
            </p>
        </div>
        <p>HTMLでは、ルビ構造およびそのマークアップの表現方法がRuby Markup Extension仕様で説明されています。
            本モジュールでは、そのようなマークアップに対するCSSによるレンダリングモデルとルビレイアウトに関する書式制御について説明します。</p>
        <p><a data-link-type="dfn" href="#ruby" id="ref-for-ruby">ルビ</a>やその書式指定についてさらに詳しく知りたい場合は、「What is Ruby」記事<a
                data-link-type="biblio" href="#biblio-qa-ruby" title="What is ruby?">[QA-RUBY]</a>を参照してください。
            日本語における主なルビの書式手法については、JIS X-4051 <a data-link-type="biblio" href="#biblio-jis4051"
                title="Formatting rules for Japanese documents (『日本語文書の組版方法』).">[JIS4051]</a>（日本語）や
            <a href="https://www.w3.org/TR/jlreq/#ruby_and_emphasis_dots">「ルビおよび圏点」</a>（<cite>日本語組版処理の要件</cite> <a
                data-link-type="biblio" href="#biblio-jlreq"
                title="Requirements for Japanese Text Layout 日本語組版処理の要件(日本語版)">[JLREQ]</a>、日本語・英語）に詳しくまとめられています。
            <cite>Rules for Simple Placement of Japanese Ruby</cite> <a data-link-type="biblio"
                href="#biblio-simple-ruby"
                title="Rules for Simple Placement of Japanese Ruby">[SIMPLE-RUBY]</a>も（英語）で日本語ルビ書式の一手法を解説しています。
            <a href="https://www.w3.org/TR/clreq/#interlinear_annotations">「行間注記」</a>（<cite>Requirements for Chinese
                Text Layout</cite> <a data-link-type="biblio" href="#biblio-clreq"
                title="Requirements for Chinese Text Layout - 中文排版需求">[CLREQ]</a>、中国語・英語）には中国語組版での関連手法も記載されています。
        </p>
        <h3 class="heading settled" data-level="1.2" id="placement"><span class="secno">1.2. </span><span
                class="content"> モジュール間の関係</span><a class="self-link" href="#placement"></a></h3>
        <p>このモジュールは、CSS Level 2 <a data-link-type="biblio" href="#biblio-css2"
                title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>
            のインラインボックスモデルを拡張してルビをサポートします。
        </p>
        <p>このモジュール内のプロパティは、<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-line"
                id="ref-for-selectordef-first-line">::first-line</a> や <a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-letter"
                id="ref-for-selectordef-first-letter">::first-letter</a> 疑似要素には適用されません。
            ただし、<a class="property css" data-link-type="property" href="#propdef-ruby-position"
                id="ref-for-propdef-ruby-position">ruby-position</a> は <span class="css"
                id="ref-for-selectordef-first-line①">::first-line</span> を継承して
            1行目のルビ注釈に影響を与えることができます。</p>
        <h3 class="heading settled" data-level="1.3" id="values"><span class="secno">1.3. </span><span class="content">
                値の定義</span><a class="self-link" href="#values"></a></h3>
        <p>本仕様は、<a href="https://www.w3.org/TR/CSS2/about.html#property-defs">CSSプロパティ定義の規約</a>（<a
                data-link-type="biblio" href="#biblio-css2"
                title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>）および <a
                href="https://www.w3.org/TR/css-values-3/#value-defs">値定義構文</a>（<a data-link-type="biblio"
                href="#biblio-css-values-3" title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</a>）に従っています。
            本仕様で定義されていない値型は CSS Values &amp; Units <span
                title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</span> で定義されています。
            他のCSSモジュールとの組み合わせにより、これらの値型の定義が拡張される場合があります。</p>
        <p>プロパティごとの値に加え、本仕様で定義されるすべてのプロパティは
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-values-4/#css-wide-keywords"
                id="ref-for-css-wide-keywords">CSS全域キーワード</a>もプロパティ値として受け付けます。
            可読性のため、ここでは繰り返し記載していません。
        </p>
        <h3 class="heading settled" data-level="1.4" id="diagram-conventions"><span class="secno">1.4. </span><span
                class="content"> 図の表記規則</span><a class="self-link" href="#diagram-conventions"></a></h3>
        <p><em>この小節は規範的ではありません。</em></p>
        <p>東アジア組版における多くの表記規則は、表示される文字が全角（CJK）か半角（非CJK）かに依存します。
            本文書に登場するいくつかの図では、次の凡例が使われています：</p>
        <dl>
            <dt><img alt="全角グリフの象徴的表現" height="39" src="https://www.w3.org/TR/css-ruby-1/images/fullwidth.gif" width="39">
            <dd> テキスト中の<var>n</var>番目に位置する全角グリフ（例：漢字）。注釈の場合は通常50%の大きさになります。
            <dt><img alt="半角グリフの象徴的表現" height="39" src="https://www.w3.org/TR/css-ruby-1/images/halfwidth.gif" width="19">
            <dd>テキスト中の<var>n</var>番目に位置する半角グリフ（例：ローマ字）。
        </dl>
        <p>上記シンボルが図中で取る向きは、実際にユーザーエージェントで描画される際のグリフの向きと対応しています。
            図中の各文字間の間隔は特に意味がない場合もありますが、意図的に変えている場合もあります。</p>
        <h2 class="heading settled" data-level="2" id="ruby-model"><span class="secno">2. </span><span class="content">
                ルビボックスモデル</span><a class="self-link" href="#ruby-model"></a></h2>
        <p>CSSルビモデルは、
            <a href="https://www.w3.org/TR/html5/text-level-semantics.html#the-ruby-element">W3C HTML5 Rubyマークアップ</a>モデル
            および <a href="https://www.w3.org/TR/ruby/">XHTML Ruby Annotation 勧告</a> <a data-link-type="biblio"
                href="#biblio-ruby" title="Ruby Annotation">[RUBY]</a> に基づいています。
            このモデルにおいて、ルビ構造は、
            基底（注釈対象）テキストを表す1つ以上の<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box">ルビ基底</a>要素と、
            注釈を表す1つ以上のレベルの<a data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box">ルビ注釈</a>要素から構成されます。
            ルビの構造はテーブルの構造と似ており、
            「行」（<a data-link-type="dfn" href="#base-level" id="ref-for-base-level">基底テキストレベル</a>、各<a
                data-link-type="dfn" href="#annotation-level" id="ref-for-annotation-level">注釈レベル</a>）
            および「<a data-link-type="dfn" href="#ruby-columns" id="ref-for-ruby-columns">列</a>」（各<span
                id="ref-for-ruby-base-box①">ルビ基底</span>とその対応する<span id="ref-for-ruby-annotation-box①">ルビ注釈</span>）があります。
        </p>
        <figure>
            <img alt="ルビ構造がテーブル状に並ぶ例。最初の「列」は基底ボックス内の「上」と、その下に中央揃えで配置された注釈ボックス内の「じょう」。2番目の「列」は別の基底ボックス内の「手」と、その下に中央揃えで配置された注釈ボックス内の「ず」。"
                height="94" src="https://www.w3.org/TR/css-ruby-1/images/ruby-boxes-simple.png" width="314">
            <figcaption>日本語の複合語「上手」に「じょうず」という発音ルビが付与された例。各音節が個別に基底文字と対応しています。</figcaption>
        </figure>
        <p>連続する基底とその連続する注釈のセットは<a data-link-type="dfn" href="#ruby-segments"
                id="ref-for-ruby-segments">ルビセグメント</a>としてまとめられます。
            <span id="ref-for-ruby-segments①">ルビセグメント</span>内では、<a data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box②">ルビ注釈</a>が複数の<a data-link-type="dfn" href="#ruby-base-box"
                id="ref-for-ruby-base-box②">ルビ基底</a>にまたがることがあります。
        </p>
        <figure>
            <img alt="ルビ構造がテーブル状に並ぶ例。最初の「列」は基底ボックス内の「旧」と、その上に中央揃えで配置された注釈ボックス内のjiù。2番目の「列」は基底ボックス内の「金」と、その上にjīn。3番目の「列」は基底ボックス内の「山」と、その上に.shān。そして英語名San Franciscoが全体の下にまたがる注釈ボックス内に中央揃えで配置されている。"
                height="128" src="https://www.w3.org/TR/css-ruby-1/images/ruby-boxes-complex.png" width="350">
            <figcaption>中国の都市名「旧金山」にピンイン「jiùjīnshān」と英語名「San
                Francisco」が注釈として付与された例。各ピンイン音節は個別に基底文字と対応し、英語名は文字列全体に対応しています。</figcaption>
        </figure>
        <p class="note" role="note"><span>注記:</span> HTMLでは、1つの<code>&lt;ruby></code>要素に複数の<a data-link-type="dfn"
                href="#ruby-segments" id="ref-for-ruby-segments②">ルビセグメント</a>を含めることができます。
            （XHTML Rubyモデルでは、1つの<code>&lt;ruby></code>要素には1つの<span id="ref-for-ruby-segments③">ルビセグメント</span>しか含められません。）
        </p>
        <h3 class="heading settled" data-level="2.1" id="ruby-display"><span class="secno">2.1. </span><span
                class="content"> ルビ用<a class="property css" data-link-type="property"
                    href="https://www.w3.org/TR/css-display-3/#propdef-display" id="ref-for-propdef-display">display</a>
                値</span><a class="self-link" href="#ruby-display"></a></h3>
        <p>あらかじめルビ要素が定義されていない文書言語（XMLアプリケーション等）の場合は、著者が文書言語の要素をルビ要素にマッピングする必要があり、
            これは<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-display-3/#propdef-display" id="ref-for-propdef-display①">display</a>
            プロパティで行います。</p>
        <div class="informative">
            <table class="def propdef partial" data-link-for-hint="display">
                <tbody>
                    <tr>
                        <th>名前:
                        <td><a class="css" data-link-type="property"
                                href="https://www.w3.org/TR/css-display-3/#propdef-display"
                                id="ref-for-propdef-display②">display</a>
                    <tr class="value">
                        <th><a href="https://www.w3.org/TR/css-values/#value-defs">新しい値:</a>
                        <td class="prod">ruby <a data-link-type="grammar"
                                href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one">|</a>
                            ruby-base <span id="ref-for-comb-one①">|</span> ruby-text <span
                                id="ref-for-comb-one②">|</span> ruby-base-container <span
                                id="ref-for-comb-one③">|</span> ruby-text-container
            </table>
        </div>
        <p>以下の新しい<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-display-3/#propdef-display" id="ref-for-propdef-display③">display</a>
            値は、任意の要素にルビレイアウトの役割を割り当てます：</p>
        <dl>
            <dt><dfn class="dfn-paneled css" data-dfn-for="display" data-dfn-type="value" data-export
                    id="valdef-display-ruby">ruby</dfn>
            <dd> 要素が<dfn class="dfn-paneled" data-dfn-for data-dfn-type="dfn" data-export
                    data-lt="ruby container | ruby container box" id="ruby-container">ルビコンテナボックス</dfn>を生成することを指定します。
                （HTML/XHTMLの<code>&lt;ruby></code>要素に対応します。）
            <dt><dfn class="dfn-paneled css" data-dfn-for="display" data-dfn-type="value" data-export
                    id="valdef-display-ruby-base">ruby-base</dfn>
            <dd> 要素が<dfn class="dfn-paneled" data-dfn-for data-dfn-type="dfn" data-export
                    data-lt="ruby base box | ruby base | base | base box"
                    id="ruby-base-box">ルビ基底ボックス</dfn>を生成することを指定します。
                （HTML/XHTMLの<code>&lt;rb></code>要素に対応します。）
            <dt><dfn class="dfn-paneled css" data-dfn-for="display" data-dfn-type="value" data-export
                    id="valdef-display-ruby-text">ruby-text</dfn>
            <dd> 要素が<dfn class="dfn-paneled" data-dfn-for data-dfn-type="dfn" data-export
                    data-lt="ruby annotation box | ruby annotation | annotation | annotation box"
                    id="ruby-annotation-box">ルビ注釈ボックス</dfn>を生成することを指定します。
                （HTML/XHTMLの<code>&lt;rt></code>要素に対応します。）
            <dt><dfn class="dfn-paneled css" data-dfn-for="display" data-dfn-type="value" data-export
                    id="valdef-display-ruby-base-container">ruby-base-container</dfn>
            <dd> 要素が<dfn class="dfn-paneled" data-dfn-for data-dfn-type="dfn" data-export data-local-lt="base container"
                    data-lt="ruby base container box | ruby base container"
                    id="ruby-base-container-box">ルビ基底コンテナボックス</dfn>を生成することを指定します。
                （XHTMLの<code>&lt;rbc></code>要素に対応。HTMLでは匿名ボックスとして生成されます。）
            <dt><dfn class="dfn-paneled css" data-dfn-for="display" data-dfn-type="value" data-export
                    id="valdef-display-ruby-text-container">ruby-text-container</dfn>
            <dd> 要素が<dfn class="dfn-paneled" data-dfn-for data-dfn-type="dfn" data-export
                    data-local-lt="annotation container"
                    data-lt="ruby annotation container box | ruby annotation container"
                    id="ruby-annotation-container-box">ルビ注釈コンテナボックス</dfn>を生成することを指定します。
                （HTML/XHTMLの<code>&lt;rtc></code>要素に対応します。）
        </dl>
        <p class="advisement">専用のルビマークアップをサポートする言語（HTMLなど）を使用する場合は、
            任意の要素（<code>&lt;span></code>など）にルビ用<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-display-3/#propdef-display" id="ref-for-propdef-display④">display</a>
            値を適用するのではなく、正しいマークアップを使うべきです。
            正しいマークアップを使うことで、スクリーンリーダーや非CSSレンダラーでもルビ構造を解釈できるようになります。</p>
        <p class="note" role="note"><span>注記:</span> <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#replaced-element" id="ref-for-replaced-element">置換要素</a>が
            <a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-display-3/#propdef-display" id="ref-for-propdef-display⑤">display</a>
            値として <a class="css" data-link-type="maybe" href="#valdef-display-ruby-base"
                id="ref-for-valdef-display-ruby-base">ruby-base</a>、<a class="css" data-link-type="maybe"
                href="#valdef-display-ruby-text" id="ref-for-valdef-display-ruby-text">ruby-text</a>、<a class="css"
                data-link-type="maybe" href="#valdef-display-ruby-base-container"
                id="ref-for-valdef-display-ruby-base-container">ruby-base-container</a>、
            <a class="css" data-link-type="maybe" href="#valdef-display-ruby-text-container"
                id="ref-for-valdef-display-ruby-text-container">ruby-text-container</a> を持つ場合は、
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-level-box"
                id="ref-for-inline-level-box">インラインレベルボックス</a>として扱われます。
            （<a href="https://www.w3.org/TR/css-display-3/#layout-specific-display"><cite>CSS Display 3</cite> § 2.4
                レイアウト内部displayタイプ：table-*およびruby-*キーワード</a>参照）
            <span id="ref-for-replaced-element①">置換要素</span>が <span class="property"
                id="ref-for-propdef-display⑥">display</span> 値として
            <a class="css" data-link-type="maybe" href="#valdef-display-ruby" id="ref-for-valdef-display-ruby">ruby</a>
            または <span class="css">inline ruby</span> を持つ場合は、
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#outer-display-type"
                id="ref-for-outer-display-type">外部displayタイプ</a>に従って動作します。
            （<a href="https://www.w3.org/TR/css-display-3/#outer-role"><cite>CSS Display 3</cite> § 2.1
                フローレイアウトの外部displayロール：block、inline、run-inキーワード</a>参照。）
            （<a href="#block-ruby">§ 2.1.2 非インラインルビ</a>も参照。）
        </p>
        <h4 class="heading settled" data-level="2.1.1" id="formatting-context"><span class="secno">2.1.1. </span><span
                class="content">ルビ整形コンテキスト</span><a class="self-link" href="#formatting-context"></a>
        </h4>
        <p><a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container">ルビコンテナ</a>は非原子的な
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-level"
                id="ref-for-inline-level">インラインレベル</a>ボックスです。
            通常の<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-box"
                id="ref-for-inline-box">インラインボックス</a>（<a href="https://www.w3.org/TR/css-inline-3/#model"><cite>CSS
                    Inline Layout 3</cite> § 2 インラインレイアウトモデル</a>参照）と同じく、
            行をまたぎ、
            その<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#containing-block"
                id="ref-for-containing-block">包含ブロック</a>は最も近い<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#block-container"
                id="ref-for-block-container">ブロックコンテナ</a>祖先です。
            また、<span id="ref-for-inline-box①">インラインボックス</span>の内容がその<span
                id="ref-for-inline-box②">インラインボックス</span>自身を含む同一の<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#inline-formatting-context"
                id="ref-for-inline-formatting-context">インライン整形コンテキスト</a>に参加するのと同様に、
            <span id="ref-for-ruby-container①">ルビコンテナ</span>およびその基底レベルの内容も
            その<span id="ref-for-ruby-container②">ルビコンテナ</span>自身を含む同一の<span
                id="ref-for-inline-formatting-context①">インライン整形コンテキスト</span>に参加します。
        </p>
        <p>ただし、<a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container③">ルビコンテナ</a>は
            注釈を格納するために、その<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-formatting-context"
                id="ref-for-inline-formatting-context②">インライン整形コンテキスト</a>の区間に対してさらに構造を与える
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="ruby-formatting-context">ルビ整形コンテキスト</dfn>を確立します。
            <span class="note">注記: この<a data-link-type="dfn"
                    href="https://www.w3.org/TR/css-display-3/#formatting-context"
                    id="ref-for-formatting-context">整形コンテキスト</a>は<em>独立した</em>
                <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#independent-formatting-context"
                    id="ref-for-independent-formatting-context">整形コンテキスト</a>ではありません。</span>
            <a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box③">ルビ基底</a>、
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box③">ルビ注釈</a>、
            <a data-link-type="dfn" href="#ruby-base-container-box" id="ref-for-ruby-base-container-box">ルビ基底コンテナ</a>、
            <a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box">ルビ注釈コンテナ</a>は
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                data-lt="internal ruby boxes|internal ruby display types" id="internal-ruby-boxes">内部ルビボックス</dfn>です。
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#internal-table-element"
                id="ref-for-internal-table-element">内部テーブル要素</a>と同様に、
            ルビレイアウトで特定の役割を持ち、
            それぞれの<span id="ref-for-ruby-container④">ルビコンテナ</span>の<a data-link-type="dfn"
                href="#ruby-formatting-context" id="ref-for-ruby-formatting-context">ルビ整形コンテキスト</a>に参加します。
            <span id="ref-for-ruby-formatting-context①">ルビ整形コンテキスト</span>での役割に加え、
            <span id="ref-for-ruby-base-box④">ルビ基底</span>は同時に
            <span id="ref-for-ruby-container⑤">ルビコンテナ</span>と同じ基底レベルの<span
                id="ref-for-inline-formatting-context③">インライン整形コンテキスト</span>にも参加し、
            <span id="ref-for-ruby-annotation-box④">ルビ注釈</span>は
            <span id="ref-for-ruby-container⑥">ルビコンテナ</span>によって確立される注釈レベルの<span
                id="ref-for-inline-formatting-context④">インライン整形コンテキスト</span>に参加します。
        </p>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-box"
                id="ref-for-inline-box③">インラインボックス</a>の内容と同様に、
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#containing-block"
                id="ref-for-containing-block①">包含ブロック</a>は
            <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container⑦">ルビコンテナ</a>（およびすべての<a
                data-link-type="dfn" href="#internal-ruby-boxes" id="ref-for-internal-ruby-boxes">内部ルビボックス</a>）の内容に対して
            <span id="ref-for-containing-block②">ルビコンテナ</span>の包含ブロックです。
            したがって、例えばfloatは<span id="ref-for-ruby-container⑨">ルビコンテナ</span>の<span
                id="ref-for-containing-block③">包含ブロック</span>で止められ、
            ルビボックスタイプのいずれにも影響しません。
        </p>
        <h4 class="heading settled" data-level="2.1.2" id="block-ruby"><span class="secno">2.1.2. </span><span
                class="content">非インラインルビ</span><a class="self-link" href="#block-ruby"></a></h4>
        <p>要素が<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inner-display-type"
                id="ref-for-inner-display-type">内部display型</a>として<a class="css" data-link-type="maybe"
                href="#valdef-display-ruby" id="ref-for-valdef-display-ruby①">ruby</a>を持ち、
            かつ<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#outer-display-type"
                id="ref-for-outer-display-type①">外部display型</a>が
            <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-display-3/#valdef-display-inline"
                id="ref-for-valdef-display-inline">inline</a>以外の場合、
            2つのボックスが生成されます：
            必要な<span id="ref-for-outer-display-type②">外部display型</span>の主ボックスと、
            インラインレベルの<a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container①⓪">ルビコンテナ</a>です。
            要素に指定されたすべてのプロパティは主ボックスに適用され
            （継承可能な場合は<span id="ref-for-ruby-container①①">ルビコンテナボックス</span>にも継承されます）。
            これにより、要素をブロックとしてスタイル指定しつつ、内部のルビ構造を正しく維持できます。
        </p>
        <p class="note" role="note"><span>注記:</span>要素を絶対配置またはfloatさせると、その<a class="property css"
                data-link-type="property" href="https://www.w3.org/TR/css-display-3/#propdef-display"
                id="ref-for-propdef-display⑦">display</a>
            値はブロックレベル同等に計算されます。
            （<a data-link-type="biblio" href="#biblio-css-display-3"
                title="CSS Display Module Level 3">[CSS-DISPLAY-3]</a>や<a data-link-type="biblio" href="#biblio-css2"
                title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> セクション9.7参照）
            <a data-link-type="dfn" href="#internal-ruby-boxes" id="ref-for-internal-ruby-boxes①">内部ルビdisplay型</a>については、
            その<span class="property" id="ref-for-propdef-display⑧">display</span>値が<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-display-3/#valdef-display-block"
                id="ref-for-valdef-display-block">block</a>に計算されます。
        </p>
        <h3 class="heading settled" data-level="2.2" id="box-fixup"><span class="secno">2.2. </span><span
                class="content">匿名ルビボックス生成</span><a class="self-link" href="#box-fixup"></a></h3>
        <p>CSSモデルでは、文書言語がこれらすべての構成要素に対応する要素を含む必要はありません。
            欠落している構造部品は、<a
                href="https://www.w3.org/TR/CSS2/tables.html#anonymous-boxes">テーブル正規化で使われるものと類似の匿名ボックス生成規則</a>により補われます。<a
                data-link-type="biblio" href="#biblio-css2"
                title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a></p>
        <ol>
            <li id="anon-gen-inlinize"><a class="self-link" href="#anon-gen-inlinize"></a><strong><a
                        data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inlinify"
                        id="ref-for-inlinify">ブロックレベルボックスのインライン化</a>：</strong>
                <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container①②">ルビコンテナ</a>、
                <a data-link-type="dfn" href="#ruby-base-container-box"
                    id="ref-for-ruby-base-container-box①">ルビ基底コンテナ</a>、
                <a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box①">ルビ注釈コンテナ</a>、
                <a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑤">ルビ基底ボックス</a>、
                <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑤">ルビ注釈ボックス</a>
                に直接含まれるin-flowなブロックレベルボックスは、<a data-link-type="biblio" href="#biblio-css-display-3"
                    title="CSS Display Module Level 3">[CSS-DISPLAY-3]</a>に従い
                「<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inlinify"
                    id="ref-for-inlinify①">インライン化</a>」され、その<a class="property css" data-link-type="property"
                    href="https://www.w3.org/TR/css-display-3/#propdef-display"
                    id="ref-for-propdef-display⑨">display</a>値も適切に計算され、
                インラインレベルの内容のみを含むようになります。
                例えば、<span class="property" id="ref-for-propdef-display①⓪">display</span>プロパティが<span class="css"
                    id="ref-for-propdef-display①①">display: block</span>のin-flow要素が
                <span class="css" id="ref-for-propdef-display①②">display: ruby-text</span>の親を持つ場合、
                そのdisplay値は<a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-display-3/#valdef-display-inline-block"
                    id="ref-for-valdef-display-inline-block">inline-block</a>に計算されます。
            <li id="anon-gen-anon-ruby">
                <a class="self-link" href="#anon-gen-anon-ruby"></a><strong>匿名ルビコンテナの生成：</strong>
                <a href="https://www.w3.org/TR/CSS2/tables.html#anonymous-boxes">連続した</a>
                不適切に包含された<a data-link-type="dfn" href="#ruby-base-container-box"
                    id="ref-for-ruby-base-container-box②">ルビ基底コンテナ</a>、
                <a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box②">ルビ注釈コンテナ</a>、
                <a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑥">ルビ基底</a>、
                <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑥">ルビ注釈</a>
                （および間の<a data-link-type="dfn" href="https://www.w3.org/TR/css-text-3/#white-space"
                    id="ref-for-white-space">空白</a>）のいずれかの連続列は
                匿名<a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container①③">ルビコンテナ</a>でラップされます。
                このステップにおいて：
                <ul>
                    <li>不適切に包含された<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑦">ルビ基底</a>とは、<a
                            data-link-type="dfn" href="#ruby-base-container-box"
                            id="ref-for-ruby-base-container-box③">ルビ基底コンテナ</a>または
                        <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container①④">ルビコンテナ</a>を親に持たないもの
                    <li>不適切に包含された<a data-link-type="dfn" href="#ruby-annotation-box"
                            id="ref-for-ruby-annotation-box⑦">ルビ注釈</a>とは、<a data-link-type="dfn"
                            href="#ruby-annotation-container-box"
                            id="ref-for-ruby-annotation-container-box③">ルビ注釈コンテナ</a>または
                        <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container①⑤">ルビコンテナ</a>を親に持たないもの
                    <li>不適切に包含された<a data-link-type="dfn" href="#ruby-base-container-box"
                            id="ref-for-ruby-base-container-box④">ルビ基底コンテナ</a>または
                        <a data-link-type="dfn" href="#ruby-annotation-container-box"
                            id="ref-for-ruby-annotation-container-box④">ルビ注釈コンテナ</a>とは、
                        <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container①⑥">ルビコンテナ</a>を親に持たないもの
                </ul>
            <li id="anon-gen-bare-inlines">
                <a class="self-link" href="#anon-gen-bare-inlines"></a><strong>誤った親を持つインラインレベル内容のラップ：</strong>
                <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container①⑦">ルビコンテナ</a>または
                <a data-link-type="dfn" href="#ruby-base-container-box"
                    id="ref-for-ruby-base-container-box⑤">ルビ基底コンテナ</a>の直下に連続するテキストやインラインレベルボックスは、匿名<a
                    data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑧">ルビ基底</a>でラップされます。
                同様に、<a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box⑤">ルビ注釈コンテナ</a>の直下に連続するテキストやインラインレベルボックスは匿名<a
                    data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑧">ルビ注釈</a>でラップされます。
                （この目的のため、誤った親を持つ<a data-link-type="dfn"
                    href="https://www.w3.org/TR/css-display-3/#internal-table-element"
                    id="ref-for-internal-table-element①">内部テーブル要素</a>はインラインレベル内容と見なされます。なぜなら、ルビボックスの親を持つため、最終的に<span
                    id="ref-for-inline-level②">インラインレベル</span>の<a data-link-type="dfn"
                    href="https://www.w3.org/TR/css-tables-3/#table-wrapper-box"
                    id="ref-for-table-wrapper-box">テーブルラッパーボックス</a>でラップされるからです。)
                <p>ただし、このように構築された匿名ボックスが<a data-link-type="dfn" href="https://www.w3.org/TR/css-text-3/#white-space"
                        id="ref-for-white-space①">空白</a>のみを含む場合は、
                    <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                        id="intra-ruby-white-space">ルビ内空白</dfn>と見なされ、下記のように破棄または保持されます。
                </p>
            <li id="anon-gen-trim-space"><a class="self-link"
                    href="#anon-gen-trim-space"></a><strong>先頭/末尾空白のトリム：</strong>
                <a data-link-type="dfn" href="#intra-ruby-white-space"
                    id="ref-for-intra-ruby-white-space">ルビ内空白</a>が親の唯一の<a data-link-type="dfn"
                    href="https://www.w3.org/TR/css-display-3/#in-flow" id="ref-for-in-flow">in-flow</a>子でなく、かつ
                <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container①⑧">ルビコンテナ</a>、
                <a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box⑥">ルビ注釈コンテナ</a>、または
                <a data-link-type="dfn" href="#ruby-base-container-box"
                    id="ref-for-ruby-base-container-box⑥">ルビ基底コンテナ</a>の
                最初または最後の<span id="ref-for-in-flow①">in-flow</span>子である場合は、<a class="css" data-link-type="propdesc"
                    href="https://www.w3.org/TR/css-display-3/#propdef-display" id="ref-for-propdef-display①③">display:
                    none</a>のように削除されます。
            <li id="anon-gen-discard-space">
                <a class="self-link" href="#anon-gen-discard-space"></a><strong>レベル間空白の削除：</strong>
                直前直後の<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#in-flow"
                    id="ref-for-in-flow②">in-flow</a>兄弟ボックスが下表のパターンに一致する<a data-link-type="dfn"
                    href="#intra-ruby-white-space" id="ref-for-intra-ruby-white-space①">ルビ内空白</a>は
                <dfn data-dfn-type="dfn" data-noexport id="inter-level-white-space">レベル間空白<a class="self-link"
                        href="#inter-level-white-space"></a></dfn>と見なされ、
                <a class="css" data-link-type="propdesc" href="https://www.w3.org/TR/css-display-3/#propdef-display"
                    id="ref-for-propdef-display①④">display: none</a>のように削除されます。
                <table class="data">
                    <thead>
                        <tr>
                            <th>前のボックス
                            <th>次のボックス
                    <tbody>
                        <tr>
                            <td>任意
                            <td><a data-link-type="dfn" href="#ruby-annotation-container-box"
                                    id="ref-for-ruby-annotation-container-box⑦">ルビ注釈コンテナ</a>
                        <tr>
                            <td> <a data-link-type="dfn" href="#ruby-annotation-box"
                                    id="ref-for-ruby-annotation-box⑨">ルビ注釈</a>以外
                            <td><a data-link-type="dfn" href="#ruby-annotation-box"
                                    id="ref-for-ruby-annotation-box①⓪">ルビ注釈</a>
                </table>
            <li id="anon-gen-interpret-space">
                <a class="self-link" href="#anon-gen-interpret-space"></a><strong>レベル内空白の解釈：</strong>
                直前直後の<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#in-flow"
                    id="ref-for-in-flow③">in-flow</a>兄弟ボックスが下表のパターンに一致する<a data-link-type="dfn"
                    href="#intra-ruby-white-space"
                    id="ref-for-intra-ruby-white-space②">ルビ内空白</a>ボックスには下表のボックスタイプとサブタイプが割り当てられます：
                <table class="data">
                    <colgroup span="2">
                        <colgroup span="2">
                        <thead>
                    <tr>
                        <th>前のボックス
                        <th>次のボックス
                        <th>ボックスタイプ
                        <th>サブタイプ
                            <tbody>
                                <tr>
                                    <td><a data-link-type="dfn" href="#ruby-base-box"
                                            id="ref-for-ruby-base-box⑨">ルビ基底</a>
                                    <td><a data-link-type="dfn" href="#ruby-base-box"
                                            id="ref-for-ruby-base-box①⓪">ルビ基底</a>
                                    <td><a data-link-type="dfn" href="#ruby-base-box"
                                            id="ref-for-ruby-base-box①①">ルビ基底</a>
                                    <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                                            id="inter-base-white-space">基底間空白</dfn>
                                <tr>
                                    <td><a data-link-type="dfn" href="#ruby-annotation-box"
                                            id="ref-for-ruby-annotation-box①①">ルビ注釈</a>
                                    <td><a data-link-type="dfn" href="#ruby-annotation-box"
                                            id="ref-for-ruby-annotation-box①②">ルビ注釈</a>
                                    <td><a data-link-type="dfn" href="#ruby-annotation-box"
                                            id="ref-for-ruby-annotation-box①③">ルビ注釈</a>
                                    <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                                            id="inter-annotation-white-space">注釈間空白</dfn>
                                <tr>
                                    <td><a data-link-type="dfn" href="#ruby-annotation-box"
                                            id="ref-for-ruby-annotation-box①④">ルビ注釈</a> または <a data-link-type="dfn"
                                            href="#ruby-annotation-container-box"
                                            id="ref-for-ruby-annotation-container-box⑧">ルビ注釈コンテナ</a>
                                    <td><a data-link-type="dfn" href="#ruby-base-box"
                                            id="ref-for-ruby-base-box①②">ルビ基底</a> または <a data-link-type="dfn"
                                            href="#ruby-base-container-box"
                                            id="ref-for-ruby-base-container-box⑦">ルビ基底コンテナ</a>
                                    <td rowspan="3"><a data-link-type="dfn" href="#ruby-base-box"
                                            id="ref-for-ruby-base-box①③">ルビ基底</a>
                                    <td rowspan="3"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                                            id="inter-segment-white-space">セグメント間空白</dfn>
                                <tr>
                                    <td><a data-link-type="dfn" href="#ruby-base-box"
                                            id="ref-for-ruby-base-box①④">ルビ基底</a> または <a data-link-type="dfn"
                                            href="#ruby-base-container-box"
                                            id="ref-for-ruby-base-container-box⑧">ルビ基底コンテナ</a>
                                    <td><a data-link-type="dfn" href="#ruby-base-container-box"
                                            id="ref-for-ruby-base-container-box⑨">ルビ基底コンテナ</a>
                                <tr>
                                    <td><a data-link-type="dfn" href="#ruby-base-container-box"
                                            id="ref-for-ruby-base-container-box①⓪">ルビ基底コンテナ</a>
                                    <td><a data-link-type="dfn" href="#ruby-base-box"
                                            id="ref-for-ruby-base-box①⑤">ルビ基底</a> または <a data-link-type="dfn"
                                            href="#ruby-base-container-box"
                                            id="ref-for-ruby-base-container-box①①">ルビ基底コンテナ</a>
                </table>
                上記で定義された<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                    id="intra-level-white-space">レベル内空白</dfn>ボックスは
                <a data-link-type="dfn" href="#pairing" id="ref-for-pairing①">ペアリング</a>やレイアウトにおいて特別に扱われます。
                下記を参照してください。
            <li id="anon-gen-unbreak">
                <a class="self-link" href="#anon-gen-unbreak"></a><strong>改行の抑制：</strong>
                <a data-link-type="dfn" href="#ruby-annotation-box"
                    id="ref-for-ruby-annotation-box①⑤">ルビ注釈</a>内のすべての強制改行を
                （<a class="property css" data-link-type="property"
                    href="https://www.w3.org/TR/css-text-3/#propdef-white-space"
                    id="ref-for-propdef-white-space">white-space</a>値に関わらず）
                <a href="https://www.w3.org/TR/css-text-3/#line-break-transform">CSS Text Level 3 § 4.1.2</a>で定義される
                セグメント分割の折り畳みに従って変換します。
                <p class="issue" id="issue-f0987196"><a class="self-link"
                        href="#issue-f0987196"></a>この目的は、ルビ注釈内の改行を抑制してレイアウトモデルを簡略化することです。
                    あるいは、許容可能な挙動を定義することも考えられます。</p>
            <li id="anon-gen-anon-containers"><a class="self-link"
                    href="#anon-gen-anon-containers"></a><strong>匿名レベルコンテナの生成：</strong>
                <a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box①⑥">ルビ基底</a>と
                <a data-link-type="dfn" href="#inter-base-white-space"
                    id="ref-for-inter-base-white-space">基底間空白</a>（ただし<a data-link-type="dfn"
                    href="#inter-segment-white-space" id="ref-for-inter-segment-white-space">セグメント間空白</a>でないもの）の連続列で
                <a data-link-type="dfn" href="#ruby-base-container-box"
                    id="ref-for-ruby-base-container-box①②">ルビ基底コンテナ</a>の親でないものは匿名<span
                    id="ref-for-ruby-base-container-box①③">ルビ基底コンテナ</span>でラップされます。
                同様に、<a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box①⑥">ルビ注釈</a>と
                <a data-link-type="dfn" href="#inter-annotation-white-space"
                    id="ref-for-inter-annotation-white-space">注釈間空白</a>の連続列で
                <a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box⑨">ルビ注釈コンテナ</a>の親でないものは匿名<span
                    id="ref-for-ruby-annotation-container-box①⓪">ルビ注釈コンテナ</span>でラップされます。
        </ol>
        <p>すべてのルビレイアウト構造が正しく親付けされた時点で、
            UAは基底と注釈の対応付けを開始できます。</p>
        <p class="note" role="note"><span>注記:</span>
            UAは内部構造としてこれらの匿名ボックス
            （や<a href="#ruby-pairing">§ 2.3 注釈ペアリング</a>の匿名空の<a data-link-type="dfn" href="#intra-level-white-space"
                id="ref-for-intra-level-white-space">レベル内空白</a>ボックス）を生成する必要はありません。
            <a data-link-type="dfn" href="#pairing" id="ref-for-pairing②">ペアリング</a>やレイアウトの挙動が
            それらが存在するかのように動作していれば十分です。
        </p>
        <div class="example" id="example-4b85d1ff">
            <a class="self-link" href="#example-4b85d1ff"></a>以下のマークアップ図は各種ボックスを表し、
            <a data-link-type="dfn" href="#intra-ruby-white-space"
                id="ref-for-intra-ruby-white-space③">ルビ内空白</a>がどこで保持／破棄されるかを示します：
            <pre class="highlight" style="white-space: normal; overflow-wrap: break-word"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->×<c- p>&lt;</c-><c- f>rbc</c-><c- p>></c->×<c- p>&lt;</c-><c- f>rb</c-><c- p>>&lt;/</c-><c- f>rb</c-><c- p>></c->⬕<c- p>&lt;</c-><c- f>rb</c-><c- p>>&lt;/</c-><c- f>rb</c-><c- p>></c->×<c- p>&lt;/</c-><c- f>rbc</c-><c- p>></c->☒<c- p>&lt;</c-><c- f>rtc</c-><c- p>></c->×<c- p>&lt;</c-><c- f>rt</c-><c- p>>&lt;/</c-><c- f>rt</c-><c- p>></c->⬔<c- p>&lt;</c-><c- f>rt</c-><c- p>>&lt;/</c-><c- f>rt</c-><c- p>></c->×<c- p>&lt;/</c-><c- f>rtc</c-><c- p>></c->◼<c- p>&lt;</c-><c- f>rbc</c-><c- p>></c->×<c- p>&lt;</c-><c- f>rb</c-><c- p>>&lt;/</c-><c- f>rb</c-><c- p>></c->…<c- p>&lt;/</c-><c- f>rtc</c-><c- p>></c->×<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c->
</pre>
            <p>ここで</p>
            <ul>
                <li data-md>
                    <p>× は<a href="#anon-gen-trim-space">先頭/末尾空白の破棄</a>を表します</p>
                <li data-md>
                    <p>☒ は<a href="#anon-gen-discard-space">レベル間空白の破棄</a>を表します</p>
                <li data-md>
                    <p>⬕ は<a data-link-type="dfn" href="#inter-base-white-space"
                            id="ref-for-inter-base-white-space①">基底間空白</a>を表します</p>
                <li data-md>
                    <p>⬔ は<a data-link-type="dfn" href="#inter-annotation-white-space"
                            id="ref-for-inter-annotation-white-space①">注釈間空白</a>を表します</p>
                <li data-md>
                    <p>◼ は<a data-link-type="dfn" href="#inter-segment-white-space"
                            id="ref-for-inter-segment-white-space①">セグメント間空白</a>を表します</p>
            </ul>
        </div>
        <h3 class="heading settled" data-level="2.3" id="ruby-pairing"><span class="secno">2.3. </span><span
                class="content">注釈ペアリング</span><a class="self-link" href="#ruby-pairing"></a></h3>
        <p>注釈の<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="pairing">ペアリング</dfn>とは、
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box①⑦">ルビ注釈</a>と<a
                data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box①⑦">ルビ基底</a>を対応付ける処理です。
            各<span id="ref-for-ruby-annotation-box①⑧">ルビ注釈</span>は1つ以上の<span
                id="ref-for-ruby-base-box①⑧">ルビ基底</span>と対応付けられ、
            それらの基底を<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="span">スパンする</dfn>といいます。
            （<span id="ref-for-ruby-annotation-box①⑨">ルビ注釈</span>が複数の基底を<a data-link-type="dfn" href="#span"
                id="ref-for-span">スパン</a>する場合、
            それは<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="spanning-annotation">スパン注釈</dfn>と呼ばれます。）
        </p>
        <p><a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box①⑨">ルビ基底</a>は
            各<a data-link-type="dfn" href="#annotation-level" id="ref-for-annotation-level①">注釈レベル</a>ごとに1つの<a
                data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box②⓪">ルビ注釈</a>としか対応付けられません。
            ただし、<span id="ref-for-annotation-level②">注釈レベル</span>が複数ある場合は、
            複数の<span id="ref-for-ruby-annotation-box②①">ルビ注釈</span>と対応付けることができます。</p>
        <p><a data-link-type="dfn" href="#pairing" id="ref-for-pairing③">ペアリング</a>が完了すると、<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-local-lt="column" data-noexport id="ruby-columns">ルビカラム</dfn>が定義されます。
            各カラムは1つの<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box②⓪">ルビ基底</a>と
            それぞれの<a data-link-type="dfn" href="#interlinear-annotations" id="ref-for-interlinear-annotations">行間注釈</a><a
                data-link-type="dfn" href="#annotation-level"
                id="ref-for-annotation-level③">注釈レベル</a>ごとに1つ（場合によっては空の匿名）の<a data-link-type="dfn"
                href="#ruby-annotation-box" id="ref-for-ruby-annotation-box②②">ルビ注釈</a>によって表されます（同じ<a
                data-link-type="dfn" href="#ruby-segments" id="ref-for-ruby-segments④">ルビセグメント</a>内）。</p>
        <h4 class="heading settled" data-level="2.3.1" id="segment-pairing"><span class="secno">2.3.1. </span><span
                class="content">セグメントペアリングと注釈レベル</span><a class="self-link" href="#segment-pairing"></a></h4>
        <p>ルビ構造は<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="ruby-segments">ルビセグメント</dfn>に分割されます。
            各セグメントは1つの<a data-link-type="dfn" href="#ruby-base-container-box"
                id="ref-for-ruby-base-container-box①④">ルビ基底コンテナ</a>と、それに続く1つ以上の<a data-link-type="dfn"
                href="#ruby-annotation-container-box" id="ref-for-ruby-annotation-container-box①①">ルビ注釈コンテナ</a>から成ります。
            各<span id="ref-for-ruby-annotation-container-box①②">ルビ注釈コンテナ</span>は
            基底テキストに対する1つの<dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="annotation level | level" data-noexport
                id="annotation-level">注釈レベル</dfn>を表し、
            最初は第1レベル、2番目は第2レベル…となります。
            <span id="ref-for-ruby-base-container-box①⑤">ルビ基底コンテナ</span>は<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="base level | base text level" data-noexport id="base-level">基底レベル</dfn>を表します。
            各セグメントの<span id="ref-for-ruby-base-container-box①⑥">ルビ基底コンテナ</span>は
            そのセグメント内のすべての<span id="ref-for-ruby-annotation-container-box①③">ルビ注釈コンテナ</span>とペアになります。
        </p>
        <p>異常ケースを扱うため、いくつかの空の匿名コンテナの存在が仮定されます：</p>
        <ul>
            <li> <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container①⑨">ルビコンテナ</a>の最初の子が<a
                    data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box①④">ルビ注釈コンテナ</a>である場合、
                その前に匿名で空の<a data-link-type="dfn" href="#ruby-base-container-box"
                    id="ref-for-ruby-base-container-box①⑦">ルビ基底コンテナ</a>が存在するとみなされます。
            <li> 同様に、<a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container②⓪">ルビコンテナ</a>が
                連続した<a data-link-type="dfn" href="#ruby-base-container-box"
                    id="ref-for-ruby-base-container-box①⑧">ルビ基底コンテナ</a>を含む場合、
                その間には匿名の空の<a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box①⑤">ルビ注釈コンテナ</a>が存在するとみなされます。
        </ul>
        <p><a data-link-type="dfn" href="#inter-segment-white-space"
                id="ref-for-inter-segment-white-space②">セグメント間空白</a>は実質的に独立した<a data-link-type="dfn"
                href="#ruby-segments" id="ref-for-ruby-segments⑥">ルビセグメント</a>とみなされます。</p>
        <h4 class="heading settled" data-level="2.3.2" id="base-annotation-pairing"><span class="secno">2.3.2.
            </span><span class="content">ユニットペアリングとスパン注釈</span><a class="self-link" href="#base-annotation-pairing"></a>
        </h4>
        <p><a data-link-type="dfn" href="#ruby-segments" id="ref-for-ruby-segments⑦">ルビセグメント</a>内では、
            <a data-link-type="dfn" href="#ruby-base-container-box"
                id="ref-for-ruby-base-container-box①⑨">ルビ基底コンテナ</a>内の各<a data-link-type="dfn" href="#ruby-base-box"
                id="ref-for-ruby-base-box②①">ルビ基底</a>が
            その<span id="ref-for-ruby-segments⑧">ルビセグメント</span>内の各<a data-link-type="dfn"
                href="#ruby-annotation-container-box" id="ref-for-ruby-annotation-container-box①⑥">ルビ注釈コンテナ</a>の1つの<a
                data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box②③">ルビ注釈</a>とペアになります。
        </p>
        <p>もし<a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box①⑦">ルビ注釈コンテナ</a>が
            ただ1つだけの匿名<a data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box②④">ルビ注釈</a>を含む場合、
            その<span id="ref-for-ruby-annotation-box②⑤">ルビ注釈</span>は、その<a data-link-type="dfn" href="#ruby-segments"
                id="ref-for-ruby-segments⑨">ルビセグメント</a>内の
            すべての<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box②②">ルビ基底</a>とペアリングされ（すなわち<a
                data-link-type="dfn" href="#span" id="ref-for-span①">スパン</a>する）ことになります。
        </p>
        <p>それ以外の場合、各<a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box②⑥">ルビ注釈</a>は
            文書順でそのセグメント内対応する<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box②③">ルビ基底</a>とペアになります。
            <a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box①⑧">ルビ注釈コンテナ</a>内の<span
                id="ref-for-ruby-annotation-box②⑦">ルビ注釈</span>数が足りない場合は、
            残りの<span id="ref-for-ruby-base-box②④">ルビ基底</span>は
            <span id="ref-for-ruby-annotation-container-box①⑨">ルビ注釈コンテナ</span>の末尾に挿入された匿名空注釈とペアになります。
            <span id="ref-for-ruby-base-box②⑤">ルビ基底</span>が足りない場合は、
            残りの<span id="ref-for-ruby-annotation-box②⑧">ルビ注釈</span>は
            <a data-link-type="dfn" href="#ruby-base-container-box"
                id="ref-for-ruby-base-container-box②⓪">ルビ基底コンテナ</a>の末尾に挿入された匿名空基底とペアになります。
        </p>
        <p>実装が明示的スパン付きルビマークアップ（例：XHTML Complex Ruby Annotations）をサポートする場合は、
            <a data-link-type="dfn" href="#spanning-annotation"
                id="ref-for-spanning-annotation">スパン注釈</a>と基底のペアリング規則を適切に調整する必要があります。
        </p>
        <p><a data-link-type="dfn" href="#intra-level-white-space" id="ref-for-intra-level-white-space①">レベル内空白</a>は
            標準の注釈<a data-link-type="dfn" href="#pairing" id="ref-for-pairing⑤">ペアリング</a>には参加しません。
            ただし、直近の<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box②⑥">ルビ基底</a>や<a
                data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box②⑨">ルビ注釈</a>がペアリングされている場合：</p>
        <ul>
            <li> 2つの<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box②⑦">ルビ基底</a>または
                <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box③⓪">注釈</a>
                が他のレベルで対応する<a data-link-type="dfn" href="#intra-level-white-space"
                    id="ref-for-intra-level-white-space②">レベル内空白</a>を挟んでいる場合、
                それら対応する<span id="ref-for-intra-level-white-space③">レベル内空白</span>ボックスもペアリングされます。
            <li> 1つのスパンする<a data-link-type="dfn" href="#ruby-annotation-box"
                    id="ref-for-ruby-annotation-box③①">ルビ注釈</a>の場合、
                <a data-link-type="dfn" href="#intra-level-white-space"
                    id="ref-for-intra-level-white-space④">レベル内空白</a>もその<span
                    id="ref-for-ruby-annotation-box③②">ルビ注釈</span>とペアリングされます。
            <li> 2つの<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box②⑧">ルビ基底</a>または
                <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box③③">注釈</a>
                間に<a data-link-type="dfn" href="#intra-level-white-space"
                    id="ref-for-intra-level-white-space⑤">レベル内空白</a>がない場合は、
                <span id="ref-for-intra-level-white-space⑥">レベル内空白</span>ボックスは
                その間に存在すると仮定される匿名空<span id="ref-for-intra-level-white-space⑦">レベル内空白</span>ボックスとペアリングされます。
        </ul>
        <div class="example" id="example-e7c0375d">
            <a class="self-link" href="#example-e7c0375d"></a>下図は通常の<a data-link-type="dfn" href="#ruby-base-box"
                id="ref-for-ruby-base-box②⑨">基底</a>と
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box③④">注釈</a>ボックスのペアリング、
            さらに<samp>ws</samp>で表される<a data-link-type="dfn" href="#intra-ruby-white-space"
                id="ref-for-intra-ruby-white-space④">ルビ内空白</a>のペアリングを示します：
            <pre class="highlight"><span class="column">|</span><span class="annot">[</span>  s p a n n i n g   a n n o t a t i o n <span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="annot">[</span> a1 <span class="annot">]</span><span class="column">|</span><span class="annot">[</span>ws<span class="annot">]</span><span class="column">|</span><span class="annot">[</span> a2 <span class="annot">]</span><span class="column">|</span><span class="annot">[</span>  <span class="annot">]</span><span class="column">|</span><span class="annot">[</span> a3 <span class="annot">]</span><span class="column">|</span><span class="annot">[</span>ws<span class="annot">]</span><span class="column">|</span><span class="annot">[</span> a4 <span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="base">[</span> b1 <span class="base">]</span><span class="column">|</span><span class="base">[</span>ws<span class="base">]</span><span class="column">|</span><span class="base">[</span> b2 <span class="base">]</span><span class="column">|</span><span class="base">[</span>ws<span class="base">]</span><span class="column">|</span><span class="base">[</span> b3 <span class="base">]</span><span class="column">|</span><span class="base">[</span>  <span class="base">]</span><span class="column">|</span><span class="base">[</span> b4 <span class="base">]</span><span class="column">|</span>
</pre>
            <p>青い括弧（<samp class="base">[ ]</samp>）は<a data-link-type="dfn" href="#ruby-base-box"
                    id="ref-for-ruby-base-box③⓪">基底ボックス</a>、
                赤い括弧（<samp class="annot">[ ]</samp>）は<a data-link-type="dfn" href="#ruby-annotation-box"
                    id="ref-for-ruby-annotation-box③⑤">注釈ボックス</a>、
                灰色の縦棒（<samp class="column">|</samp>）は<a data-link-type="dfn" href="#ruby-columns"
                    id="ref-for-ruby-columns①">ルビカラム</a>の区切り、
                <samp class="ws">[ws]</samp>は<a data-link-type="dfn" href="#intra-ruby-white-space"
                    id="ref-for-intra-ruby-white-space⑤">ルビ内空白</a>、
                <samp>[]</samp>は空の匿名基底または注釈（他レベルの<span
                    id="ref-for-intra-ruby-white-space⑥">レベル内空白</span>に対応して自動生成されるもの）を表します。
                <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container②①">ルビコンテナ</a>、
                <a data-link-type="dfn" href="#ruby-base-container-box"
                    id="ref-for-ruby-base-container-box②①">基底コンテナ</a>、
                <a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box②⓪">注釈コンテナ</a>は省略しています。
            </p>
        </div>
        <h3 class="heading settled" data-level="2.4" id="hiding"><span class="secno">2.4. </span><span class="content">
                注釈の非表示：<a class="css" data-link-type="propdesc"
                    href="https://www.w3.org/TR/css-display-3/#propdef-visibility"
                    id="ref-for-propdef-visibility">visibility: collapse</a> と自動非表示ルビ</span><span
                id="autohide"></span><a class="self-link" href="#hiding"></a></h3>
        <p><a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box③⑥">ルビ注釈</a>の
            <a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-display-3/#propdef-visibility"
                id="ref-for-propdef-visibility①">visibility</a>が <a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-display-3/#valdef-visibility-collapse"
                id="ref-for-valdef-visibility-collapse">collapse</a> の場合、その注釈は<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-local-lt="hidden" data-lt="hidden annotation | hidden ruby annotation | hide"
                data-noexport id="hidden-annotation">非表示注釈</dfn>となります。
            さらに、<span id="ref-for-ruby-annotation-box③⑦">ルビ注釈</span>のテキスト内容が基底と完全に一致する場合、
            UAによって自動的に<a data-link-type="dfn" href="#hidden-annotation" id="ref-for-hidden-annotation">非表示</a>（<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-lt="auto-hidden | auto-hide" data-noexport
                id="auto-hidden">自動非表示</dfn>）になります。
        </p>
        <p><a data-link-type="dfn" href="#hidden-annotation" id="ref-for-hidden-annotation①">非表示</a>となった<a
                data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box③⑧">ルビ注釈</a>は、
            注釈<a data-link-type="dfn" href="#pairing" id="ref-for-pairing⑥">ペアリング</a>に影響しません。
            ただし、<span id="ref-for-hidden-annotation②">非表示注釈</span>は表示されず、レイアウトにも影響を与えませんが、
            同じレベル内で隣接する<span id="ref-for-ruby-annotation-box③⑨">ルビ注釈ボックス</span>の区切りとして作用し、
            まるで異なるセグメントに属しているかのように、
            <span id="ref-for-hidden-annotation③">非表示注釈</span>の基底が<a data-link-type="dfn" href="#ruby-base-box"
                id="ref-for-ruby-base-box③①">ルビ基底</a>でなく途中のインライン要素であるかのように扱われます。
        </p>
        <div class="example" id="example-ed46b94b">
            <a class="self-link" href="#example-ed46b94b"></a> 自動非表示は漢字とひらがなが混在する日本語単語に対して、注釈を正しくインライン表示するのに役立ちます。
            例えば、<span lang="ja">振り仮名</span> という単語は次のようにインライン表示されるべきです：
            <p class="figure">振り仮名(ふりがな) </p>
            <p>したがって、次のようにマークアップされます：</p>
            <pre class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>rb</c-><c- p>></c->振<c- p>&lt;/</c-><c- f>rb</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c->り<c- p>&lt;/</c-><c- f>rb</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c->仮<c- p>&lt;/</c-><c- f>rb</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c->名<c- p>&lt;/</c-><c- f>rb</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>rp</c-><c- p>></c->(<c- p>&lt;/</c-><c- f>rp</c-><c- p>>&lt;</c-><c- f>rt</c-><c- p>></c->ふ<c- p>&lt;/</c-><c- f>rt</c-><c- p>>&lt;</c-><c- f>rt</c-><c- p>></c->り<c- p>&lt;/</c-><c- f>rt</c-><c- p>>&lt;</c-><c- f>rt</c-><c- p>></c->が<c- p>&lt;/</c-><c- f>rt</c-><c- p>>&lt;</c-><c- f>rt</c-><c- p>></c->な<c- p>&lt;/</c-><c- f>rt</c-><c- p>>&lt;</c-><c- f>rp</c-><c- p>></c->)<c- p>&lt;/</c-><c- f>rp</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
            <p>しかしルビ表示時には「り」の注釈は非表示となるべきです。</p>
            <div class="figure">
                <img alt="振り仮名の各基底文字の上にひらがな注釈が表示されている。りの上には注釈がない。" height="73" src="https://www.w3.org/TR/css-ruby-1/images/furigana-separate.png"
                    width="160">
                <p class="caption">振り仮名のひらがなルビ。「り」の上には注釈がありません（すでにひらがなだから）。</p>
            </div>
        </div>
        <div class="example" id="example-18291435">
            <a class="self-link" href="#example-18291435"></a> この例の日本語単語は三つの漢字で構成されており、
            そのうち一つは小学校一年生で習うもので、他の二つはより上級です。
            （基底と注釈の対応を色分けで示しています。）
            <pre class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c->昆<c- p>&lt;/</c-><c- f>rb</c-><c- p>></c->虫<c- p>&lt;/</c-><c- f>rb</c-><c- p>></c->記<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->こん<c- p>&lt;/</c-><c- f>rt</c-> <c- e>class</c-><c- o>=</c-><c- s>easy</c-><c- p>></c->ちゅう<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->き<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c->
</pre>
            <figure>
                <img alt="昆虫記、3文字すべてに発音注釈。真ん中の注釈が基底より広いので隣と重ならないようスペースが追加されている。" src="https://www.w3.org/TR/css-ruby-1/images/ruby-pairing-full.png"
                    width="122">
                <figcaption>3文字すべてに注釈が付いた例</figcaption>
            </figure>
            <p>すべての文字に発音ガイドが必要な読者もいれば、
                一部の読者には簡単な文字の注釈は非表示にした方が適切です。
                <a class="css" data-link-type="propdesc" href="https://www.w3.org/TR/css-display-3/#propdef-visibility"
                    id="ref-for-propdef-visibility②">visibility: collapse</a> を適用すると非表示にできます：
            </p>
            <figure>
                <img alt="昆虫記、1文字目と3文字目だけ注釈が中央に残る。" src="https://www.w3.org/TR/css-ruby-1/images/ruby-pairing-collapse.png" width="105">
                <figcaption>真ん中の注釈を <a class="css" data-link-type="propdesc"
                        href="https://www.w3.org/TR/css-display-3/#propdef-visibility"
                        id="ref-for-propdef-visibility③">visibility: collapse</a> にした例</figcaption>
            </figure>
            <p><a data-link-type="dfn" href="#hidden-annotation" id="ref-for-hidden-annotation④">非表示</a>の
                <a class="css" data-link-type="propdesc" href="https://www.w3.org/TR/css-display-3/#propdef-visibility"
                    id="ref-for-propdef-visibility④">visibility: collapse</a> の挙動は、
                <span class="css" id="ref-for-propdef-visibility⑤">visibility: hidden</span>とは異なります。
                hiddenは注釈を不可視にしますが、その分のスペースはレイアウト上残ります：
            </p>
            <figure>
                <img alt="昆虫記、2文字目の注釈は表示されていないが、その分のスペースが確保されて基底文字が離れている。" src="https://www.w3.org/TR/css-ruby-1/images/ruby-pairing-invisible.png"
                    width="122">
                <figcaption>真ん中の注釈を <a class="css" data-link-type="propdesc"
                        href="https://www.w3.org/TR/css-display-3/#propdef-visibility"
                        id="ref-for-propdef-visibility⑥">visibility: hidden</a> にした例</figcaption>
            </figure>
            <p>また、<a class="css" data-link-type="propdesc" href="https://www.w3.org/TR/css-display-3/#propdef-display"
                    id="ref-for-propdef-display①⑤">display:
                    none</a> とも異なります。<a class="css" data-link-type="propdesc"
                    href="https://www.w3.org/TR/css-display-3/#propdef-visibility"
                    id="ref-for-propdef-visibility⑦">visibility: collapse</a> はペアリング関係を維持しますが、
                <span class="css" id="ref-for-propdef-display①⑥">display: none</span> はボックスをツリーから完全に削除し、
                以降の注釈のペアリングが崩れてしまいます：
            </p>
            <figure>
                <img alt="昆虫記、2文字目の注釈が削除されたため、3文字目の注釈が2文字目に誤ってペアリングされて表示されている。" src="https://www.w3.org/TR/css-ruby-1/images/ruby-pairing-discard.png"
                    width="107">
                <figcaption>真ん中の注釈を <a class="css" data-link-type="propdesc"
                        href="https://www.w3.org/TR/css-display-3/#propdef-display"
                        id="ref-for-propdef-display①⑦">display: none</a> にした例</figcaption>
            </figure>
        </div>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-5/#computed-value"
                id="ref-for-computed-value">computed value</a> が<a class="property css" data-link-type="property"
                href="#propdef-ruby-merge" id="ref-for-propdef-ruby-merge">ruby-merge</a> で
            <a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box②①">注釈コンテナ</a>において
            <a class="css" data-link-type="maybe" href="#valdef-ruby-merge-merge"
                id="ref-for-valdef-ruby-merge-merge">merge</a> の場合、<a data-link-type="dfn" href="#hidden-annotation"
                id="ref-for-hidden-annotation⑤">非表示</a>は無効化されます。
            値が <a class="css" data-link-type="maybe" href="#valdef-ruby-merge-auto"
                id="ref-for-valdef-ruby-merge-auto">auto</a> の場合は、
            ユーザーエージェントが非表示の可否を判断できますが、UAのレイアウトアルゴリズムが
            <a class="css" data-link-type="maybe" href="#valdef-ruby-merge-separate"
                id="ref-for-valdef-ruby-merge-separate">separate</a> と同様の結果を生成する場合は
            <span id="ref-for-hidden-annotation⑦">非表示</span>を有効化することを推奨します。
        </p>
        <p><a data-link-type="dfn" href="#auto-hidden" id="ref-for-auto-hidden">自動非表示</a>の内容比較は、空白の折り畳み（<a
                class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-text-3/#propdef-white-space"
                id="ref-for-propdef-white-space①">white-space</a>）やテキスト変換（<a class="property css"
                data-link-type="property" href="https://www.w3.org/TR/css-text-3/#propdef-text-transform"
                id="ref-for-propdef-text-transform">text-transform</a>）の前に行われ、
            要素は無視され（ボックスの <code>textContent</code> のみを見る）、比較されます。</p>
        <p class="note" role="note"><span>注記:</span>将来のCSS Rubyレベルでは<a data-link-type="dfn" href="#auto-hidden"
                id="ref-for-auto-hidden①">自動非表示</a>の制御が追加される可能性がありますが、
            本レベルでは常に強制されます。</p>
        <h3 class="heading settled" data-level="2.5" id="white-space"><span class="secno">2.5. </span><span
                class="content">空白の折り畳み</span><a class="self-link" href="#white-space"></a></h3>
        <p><a href="#box-fixup">§ 2.2 匿名ルビボックス生成</a>で説明した通り、
            ルビ構造内の空白は<a href="#anon-gen-discard-space">破棄</a>されます：</p>
        <ul>
            <li><a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container②②">ルビコンテナ</a>、<a
                    data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box②②">注釈コンテナ</a>、<a data-link-type="dfn"
                    href="#ruby-base-container-box" id="ref-for-ruby-base-container-box②②">基底コンテナ</a>の先頭と末尾
            <li><a data-link-type="dfn" href="#ruby-base-container-box"
                    id="ref-for-ruby-base-container-box②③">基底コンテナ</a>と直後の<a data-link-type="dfn"
                    href="#ruby-annotation-container-box" id="ref-for-ruby-annotation-container-box②③">注釈コンテナ</a>の間
            <li><a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box②④">注釈コンテナ</a>同士の間
        </ul>
        <div class="example" id="example-6fc7b45d">
            <a class="self-link" href="#example-6fc7b45d"></a> 例えば、次のマークアップは空白なしで表示されます：
            <pre class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>rb</c-><c- p>></c->東<c- p>&lt;/</c-><c- f>rb</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c->京<c- p>&lt;/</c-><c- f>rb</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>rt</c-><c- p>></c->とう<c- p>&lt;/</c-><c- f>rt</c-><c- p>>&lt;</c-><c- f>rt</c-><c- p>></c->きょう<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>rtc</c-><c- p>>&lt;</c-><c- f>rt</c-><c- p>></c->Tō<c- p>&lt;/</c-><c- f>rt</c-><c- p>>&lt;</c-><c- f>rt</c-><c- p>></c->kyō<c- p>&lt;/</c-><c- f>rt</c-><c- p>>&lt;/</c-><c- f>rtc</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
        </div>
        <p><a data-link-type="dfn" href="#ruby-segments" id="ref-for-ruby-segments①⓪">ルビセグメント</a>間、
            <a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box③②">ルビ基底</a>間、
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box④⓪">ルビ注釈</a>間では
            空白は破棄されず、
            <a data-link-type="dfn" href="#inter-base-white-space" id="ref-for-inter-base-white-space②">基底間空白</a>、
            <a data-link-type="dfn" href="#inter-annotation-white-space"
                id="ref-for-inter-annotation-white-space②">注釈間空白</a>、
            <a data-link-type="dfn" href="#inter-segment-white-space"
                id="ref-for-inter-segment-white-space③">セグメント間空白</a>としてレンダリングで保持されます。
            （上記<a href="#anon-gen-interpret-space">レベル内空白の解釈</a>参照）
        </p>
        <div class="example" id="example-7bca862a">
            <a class="self-link" href="#example-7bca862a"></a> 空白保持のルールにより、ルビはラテン語など空白区切りのスクリプトにも利用できます。
            例えば、
            <pre class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>rb</c-><c- p>></c->W<c- p>&lt;/</c-><c- f>rb</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c->W<c- p>&lt;/</c-><c- f>rb</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c->W<c- p>&lt;/</c-><c- f>rb</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>rt</c-><c- p>></c->World<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c-> <c- p>&lt;</c-><c- f>rt</c-><c- p>></c->Wide<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c-> <c- p>&lt;</c-><c- f>rt</c-><c- p>></c->Web<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
            <p>また、注釈付き空白も保持されます。例えば、</p>
            <pre class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>rb</c-><c- p>></c->Aerith<c- p>&lt;/</c-><c- f>rb</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c-> <c- p>&lt;/</c-><c- f>rb</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c->Gainsborough<c- p>&lt;/</c-><c- f>rb</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>rt</c-><c- p>></c->エアリス<c- p>&lt;/</c-><c- f>rt</c-><c- p>>&lt;</c-><c- f>rt</c-><c- p>></c->・<c- p>&lt;/</c-><c- f>rt</c-><c- p>>&lt;</c-><c- f>rt</c-><c- p>></c->ゲインズブール<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
        </div>
        <p>破棄されなかった空白が<a data-link-type="dfn" href="https://www.w3.org/TR/css-text-3/#collapsible-white-space"
                id="ref-for-collapsible-white-space">折り畳み可能</a>な場合は、
            各行ボックス内で隣接するボックス間で
            標準の<a href="https://www.w3.org/TR/css3-text/#white-space-rules">空白処理ルール</a> <a data-link-type="biblio"
                href="#biblio-css-text-3" title="CSS Text Module Level 3">[CSS-TEXT-3]</a>に従い折り畳まれます。
            異なる<a data-link-type="dfn" href="#ruby-segments" id="ref-for-ruby-segments①①">ルビセグメント</a>や
            <a data-link-type="dfn" href="#hidden-annotation"
                id="ref-for-hidden-annotation⑧">非表示注釈</a>で区切られた注釈は隣接しているとはみなされません。
            ただし、基底レベルの内容（
            <a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation">字間注釈</a>を含む、これらは
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#atomic-inline"
                id="ref-for-atomic-inline">アトミックインライン</a>として扱われます）では隣接扱いとなります。
            <span id="ref-for-collapsible-white-space①">折り畳み可能空白</span>が
            <span id="ref-for-ruby-segments①②">ルビセグメント</span>間（<a data-link-type="dfn" href="#inter-segment-white-space"
                id="ref-for-inter-segment-white-space④">セグメント間空白</a>）に存在する場合、
            文脈テキストは両側の<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box③③">ルビ基底</a>によって決まります。
            （ソース文書上の空白両側のテキストではなく、間に<a data-link-type="dfn" href="#interlinear-annotations"
                id="ref-for-interlinear-annotations①">行間注釈</a>があっても基底が基準となります。）
        </p>
        <div class="note" role="note">
            注記: 空白処理ルールにより、
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-text-3/#segment-break"
                id="ref-for-segment-break">セグメント分割</a>
            （改行など）を含む空白列は、漢字や仮名間では<a
                href="https://www.w3.org/TR/css3-text/#line-break-transform">何も表示されなくなる</a>ように折り畳まれます。
            これにより、中国語や日本語のルビでは空白による字下げを安全に利用できます。
            たとえば次のマークアップも空白なしで表示されます：
            <pre class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->
  屋<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->おく<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->内<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->ない<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->
  禁<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->きん<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->煙<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->えん<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
            <p>ただし、<a data-link-type="dfn" href="https://www.w3.org/TR/css-text-3/#segment-break"
                    id="ref-for-segment-break①">セグメント分割</a>を含まない空白は完全には消えず、
                次の例では1組目と2組目のルビの間に空白が表示されます：</p>
            <pre class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->
  屋<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->おく<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->  内<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->ない<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->
  禁<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->きん<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->  煙<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->えん<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
        </div>
        <h2 class="heading settled" data-level="3" id="ruby-layout"><span class="secno">3. </span><span class="content">
                ルビのレイアウト</span><a class="self-link" href="#ruby-layout"></a></h2>
        <p>ルビ構造をレイアウトする際、
            まず<a data-link-type="dfn" href="#base-level" id="ref-for-base-level①">基底レベル</a>は
            その<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box③④">ルビ基底</a>が通常の
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-box"
                id="ref-for-inline-box④">インラインボックス</a>であるかのように、
            <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container②③">ルビコンテナ</a>を
            そのまま<span id="ref-for-inline-box⑤">インラインボックス</span>として包み込む形で行上に配置されます。
        </p>
        <p><a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container②④">ルビコンテナ</a>内に
            <a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation①">字間注釈</a>がある場合は、
            <a data-link-type="dfn" href="#base-level" id="ref-for-base-level②">基底レベル</a>内に
            <a href="#inter-character-layout">§ 3.2 字間ルビレイアウト</a>で詳細に述べる方法で配置されます。
            その後、<a data-link-type="dfn" href="#ruby-base-container-box"
                id="ref-for-ruby-base-container-box②④">基底コンテナ</a>のサイズが決まり、
            <a data-link-type="dfn" href="#interlinear-annotations" id="ref-for-interlinear-annotations②">行間注釈</a>が
            <a href="#interlinear-layout">§ 3.1 行間ルビレイアウト</a>で説明される方法で配置されます。
        </p>
        <p>他のCSSレイアウトモデルと同様、
            相対位置指定や変形、その他のグラフィカル効果はボックスのレイアウト後に適用されます。</p>
        <h3 class="heading settled" data-level="3.1" id="interlinear-layout"><span class="secno">3.1. </span><span
                class="content">行間ルビレイアウト</span><a class="self-link" href="#interlinear-layout"></a></h3>
        <p><a data-link-type="dfn" href="#interlinear-annotations" id="ref-for-interlinear-annotations③">行間</a>
            の<a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box④①">ルビ注釈</a>は
            まず同じ<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-box"
                id="ref-for-inline-box⑥">インラインボックス</a>であるかのように
            同じ<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-formatting-context"
                id="ref-for-inline-formatting-context⑤">インライン整形コンテキスト</a>に参加して配置され、
            実質的に<a data-link-type="dfn" href="https://www.w3.org/TR/css-inline-3/#line-box"
                id="ref-for-line-box">行ボックス</a>をその<a data-link-type="dfn" href="#annotation-level"
                id="ref-for-annotation-level④">注釈レベル</a>ごとに
            <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container②⑤">ルビコンテナ</a>内で確立します。
            <span id="ref-for-ruby-annotation-box④②">注釈</span>と<a data-link-type="dfn" href="#ruby-base-box"
                id="ref-for-ruby-base-box③⑤">基底</a>は以下の説明に従って間隔を調整して互いに揃えられます。
        </p>
        <h4 class="heading settled" data-level="3.1.1" id="interlinear-inline"><span class="secno">3.1.1. </span><span
                class="content">インライン軸行間レイアウト</span><a class="self-link" href="#interlinear-inline"></a></h4>
        <p>インライン軸において、<a data-link-type="dfn" href="#interlinear-annotations"
                id="ref-for-interlinear-annotations④">行間</a><a data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box④③">ルビ注釈</a>は、
            <a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box③⑥">ルビ基底ボックス</a>に対して、
            それぞれの<a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box②⑤">注釈コンテナ</a>の<a class="property css"
                data-link-type="property" href="#propdef-ruby-merge"
                id="ref-for-propdef-ruby-merge①">ruby-merge</a>値に従い揃えられます。
        </p>
        <p><a class="property css" data-link-type="property" href="#propdef-ruby-merge"
                id="ref-for-propdef-ruby-merge②">ruby-merge</a>が<a class="css" data-link-type="maybe"
                href="#valdef-ruby-merge-separate" id="ref-for-valdef-ruby-merge-separate①">separate</a>の場合、
            各<a data-link-type="dfn" href="#ruby-columns" id="ref-for-ruby-columns②">ルビカラム</a>は
            そのカラム内で最も幅の広い内容（<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box③⑦">ルビ基底</a>または
            <a data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box④④">ルビ注釈</a>）に合わせて幅が決まります。
            <a data-link-type="dfn" href="#spanning-annotation" id="ref-for-spanning-annotation①">スパン注釈</a>（実際にスパンする場合も
            <span class="css" id="ref-for-propdef-ruby-merge③">ruby-merge: merge</span>でスパン扱いの場合も）において、
            <span id="ref-for-spanning-annotation②">スパン注釈</span>の内容がスパン先の<span
                id="ref-for-ruby-columns④">カラム</span>合計幅より広い場合は、
            差分がスパンした<span id="ref-for-ruby-columns⑤">カラム</span>に均等配分されます。
            <a data-link-type="dfn" href="#ruby-segments" id="ref-for-ruby-segments①③">ルビセグメント</a>内に
            複数の<span id="ref-for-spanning-annotation③">スパン注釈</span>がある場合は、
            より少ない基底をスパンする注釈から順に追加スペースの分配を行い、
            スパン数が多い注釈ほど後から分配されます。
            各<span id="ref-for-ruby-base-box③⑧">ルビ基底</span>と<span id="ref-for-ruby-annotation-box④⑤">ルビ注釈</span>は
            それぞれ自分のカラム幅にちょうど合うようにサイズ調整されます。
        </p>
        <p class="note" role="note"><span>注記:</span> 異なるレベルの複数注釈が同数の基底をスパンしつつ
            スパン範囲が重なってもぴったり一致しない場合、
            追加スペースの分配は未定義です。
            これはHTMLマークアップでは発生しませんが、
            <a data-link-type="biblio" href="#biblio-ruby"
                title="Ruby Annotation">[RUBY]</a>のように明示的スパンができるマークアップ言語では起こり得ます。
        </p>
        <p><a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box②⑥">注釈コンテナ</a>で
            <a class="css" data-link-type="propdesc" href="#propdef-ruby-merge"
                id="ref-for-propdef-ruby-merge④">ruby-merge: auto</a> の場合に
            いずれかの<a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box④⑥">ルビ注釈</a>が
            対応する<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box③⑨">基底</a>より広い場合は、
            その<span id="ref-for-ruby-annotation-box④⑦">ルビ注釈</span>は<span
                id="ref-for-ruby-annotation-container-box②⑦">注釈コンテナ</span>内で
            自分のカラムをはみ出してもよいです。
            この場合、はみ出し部分がどのようにカラム幅へ影響するかはUAに委ねられますが、
            <a data-link-type="dfn" href="#ruby-segments" id="ref-for-ruby-segments①④">ルビセグメント</a>全体が
            すべての内容を収める幅になることが条件です。
        </p>
        <p><a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation②">字間注釈</a>はカラム間に挿入されます：
            これは両隣のカラムをスパンする注釈の計測には含まれますが、
            いずれのカラムにも含まれず、
            <a data-link-type="dfn" href="#interlinear-annotations" id="ref-for-interlinear-annotations⑤">行間注釈</a>の
            サイズや配置の影響は一切受けません。
        </p>
        <p>各<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box④⓪">基底</a>や
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box④⑧">注釈</a>ボックス内で、
            内容がボックス幅より狭い場合の余白の分配方法は
            <a class="property css" data-link-type="property" href="#propdef-ruby-align"
                id="ref-for-propdef-ruby-align">ruby-align</a>プロパティによって決まります。
        </p>
        <div class="example" id="example-476e6a05">
            <a class="self-link" href="#example-476e6a05"></a> 以下の図は、これらのルールを典型例と複雑な例で示したものです。
            各例では<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box④①">基底ボックス</a>と
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box④⑨">注釈ボックス</a>は
            <a class="css" data-link-type="propdesc" href="#propdef-ruby-align"
                id="ref-for-propdef-ruby-align①">ruby-align: center</a>、
            <a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box②⑧">注釈コンテナ</a>は<span class="css"
                id="ref-for-propdef-ruby-align②">ruby-align: space-between</span>が指定されているものとします。
            <p>青い括弧（<samp class="base">[ ]</samp>）は<a data-link-type="dfn" href="#ruby-base-box"
                    id="ref-for-ruby-base-box④②">基底ボックス</a>、
                赤い括弧（<samp class="annot">[ ]</samp>）は<a data-link-type="dfn" href="#ruby-annotation-box"
                    id="ref-for-ruby-annotation-box⑤⓪">注釈ボックス</a>、
                灰色の縦棒（<samp class="column">|</samp>）は<a data-link-type="dfn" href="#ruby-columns"
                    id="ref-for-ruby-columns⑧">ルビカラム</a>の区切りです。
                <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container②⑥">ルビコンテナ</a>、
                <a data-link-type="dfn" href="#ruby-base-container-box"
                    id="ref-for-ruby-base-container-box②⑤">基底コンテナ</a>、
                <a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box②⑨">注釈コンテナ</a>は省略しています。
            </p>
            <dl>
                <dt id="ex-separate"><a class="self-link" href="#ex-separate"></a>分離／非スパン:
                <dd>
                    <pre class="highlight"><span class="column">|</span><span class="annot">[</span>  a1  <span class="annot">]</span><span class="column">|</span><span class="annot">[</span>  a2  <span class="annot">]</span><span class="column">|</span><span class="annot">[</span>annotation-3<span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="base">[</span>base 1<span class="base">]</span><span class="column">|</span><span class="base">[</span>base 2<span class="base">]</span><span class="column">|</span><span class="base">[</span>   base 3   <span class="base">]</span><span class="column">|</span>
</pre>
                    <p>各<a data-link-type="dfn" href="#ruby-columns"
                            id="ref-for-ruby-columns⑨">カラム</a>内のボックスは、そのカラムで最も幅の広い
                        <span id="ref-for-ruby-columns①⓪">ボックス</span>に合わせて幅が決まります。
                        各<a class="property css" data-link-type="property" href="#propdef-ruby-align"
                            id="ref-for-propdef-ruby-align③">ruby-align</a>値に従い
                        <a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box④③">基底ボックス</a>や<a
                            data-link-type="dfn" href="#ruby-annotation-box"
                            id="ref-for-ruby-annotation-box⑤①">注釈ボックス</a>内の余白が分配されます。
                    </p>
                <dt id="ex-short-span"><a class="self-link" href="#ex-short-span"></a>スパン（短い）:
                <dd>
                    <pre class="highlight"><span class="column">|</span><span class="annot">[</span>  a1  <span class="annot">]</span><span class="column">|</span><span class="annot">[</span>   short span  <span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="base">[</span>base 1<span class="base">]</span><span class="column">|</span><span class="base">[</span>base 2<span class="base">]</span><span class="column">|</span><span class="base">[</span>base 3<span class="base">]</span><span class="column">|</span>
</pre>
                    <p><a data-link-type="dfn" href="#spanning-annotation"
                            id="ref-for-spanning-annotation⑤">スパン注釈</a>がスパンする
                        <a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box④④">基底</a>の合計幅より短い場合は、
                        追加スペースの分配はありません。
                        <span id="ref-for-spanning-annotation⑥">スパン注釈</span>内の余白は
                        その<a class="property css" data-link-type="property" href="#propdef-ruby-align"
                            id="ref-for-propdef-ruby-align④">ruby-align</a>値に従い分配されます（非スパンと同様）。
                    </p>
                <dt id="ex-long-span"><a class="self-link" href="#ex-long-span"></a>スパン（長い）:
                <dd>
                    <pre class="highlight"><span class="column">|</span><span class="annot">[</span>  a1  <span class="annot">]</span><span class="column">|</span><span class="annot">[</span>spanning annotation<span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="base">[</span>base 1<span class="base">]</span><span class="column">|</span><span class="base">[</span> base 2 <span class="base">]</span><span class="column">|</span><span class="base">[</span> base 3 <span class="base">]</span><span class="column">|</span>
</pre>
                    <p><a data-link-type="dfn" href="#spanning-annotation"
                            id="ref-for-spanning-annotation⑦">スパン注釈</a>がスパンする<a data-link-type="dfn"
                            href="#ruby-base-box" id="ref-for-ruby-base-box④⑥">基底ボックス</a>より長い場合、
                        余白は均等に分配されます。</p>
                <dt id="ex-short-merge"><a class="self-link" href="#ex-short-merge"></a>マージ（短い）:
                <dd>
                    <pre class="highlight"><span class="column">|</span><span class="annot">[</span>merged        annotation<span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="base">[</span>base 1<span class="base">]</span><span class="column">|</span><span class="base">[</span>base 2<span class="base">]</span><span class="column">|</span><span class="base">[</span>base 3<span class="base">]</span><span class="column">|</span>
</pre>
                    <p><a data-link-type="dfn" href="#merged-annotation" id="ref-for-merged-annotation①">マージ注釈</a>は
                        <a data-link-type="dfn" href="#span" id="ref-for-span②">スパン</a>注釈と似ていますが、
                        余白の分配は<a class="property css" data-link-type="property" href="#propdef-ruby-align"
                            id="ref-for-propdef-ruby-align⑤">ruby-align</a>値が
                        <a data-link-type="dfn" href="#ruby-annotation-container-box"
                            id="ref-for-ruby-annotation-container-box③⓪">注釈コンテナ</a>に効きます（個々の<a data-link-type="dfn"
                            href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑤③">注釈ボックス</a>ではなく）。
                    </p>
                <dt id="ex-multi-level-span"><a class="self-link" href="#ex-multi-level-span"></a>複数レベル＋スパン注釈:
                <dd>
                    <pre class="highlight"><span class="column">|</span><span class="annot">[</span>   a1   <span class="annot">]</span><span class="column">|</span><span class="annot">[</span> annotation-2 <span class="annot">]</span><span class="column">|</span><span class="annot">[</span>   a3   <span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="annot">[</span>long annotation spanning all content<span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="base">[</span> base 1 <span class="base">]</span><span class="column">|</span><span class="base">[</span>    base 2    <span class="base">]</span><span class="column">|</span><span class="base">[</span> base 3 <span class="base">]</span><span class="column">|</span>
</pre>
                    <pre class="highlight"><span class="column">|</span><span class="annot">[</span>  xx  <span class="annot">]</span><span class="column">|</span><span class="annot">[</span>annotation spanning bases<span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="annot">[</span>  a1  <span class="annot">]</span><span class="column">|</span><span class="annot">[</span> annotation-2 <span class="annot">]</span><span class="column">|</span><span class="annot">[</span>   a3   <span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="base">[</span>base 1<span class="base">]</span><span class="column">|</span><span class="base">[</span>    base 2    <span class="base">]</span><span class="column">|</span><span class="base">[</span> base 3 <span class="base">]</span><span class="column">|</span>
</pre>
                    <p>複数の<a data-link-type="dfn" href="#annotation-level"
                            id="ref-for-annotation-level⑤">注釈レベル</a>にまたがる2例では、
                        各<a data-link-type="dfn" href="#ruby-columns" id="ref-for-ruby-columns①①">カラム</a>は
                        その中で最も長い内容に合わせて幅が決まります。
                        <a data-link-type="dfn" href="#spanning-annotation"
                            id="ref-for-spanning-annotation⑧">スパン注釈</a>がさらに長い場合は
                        スパン先の<span id="ref-for-ruby-columns①②">カラム</span>合計幅をさらに広げ、各カラムに均等に加算します。
                    </p>
                <dt id="ex-multi-level-mutli-span"><a class="self-link"
                        href="#ex-multi-level-mutli-span"></a>複数レベル＋複数スパン注釈:
                <dd>
                    <pre class="highlight"><span class="column">|</span><span class="annot">[</span><span class="flagbg2"> </span>  xx  <span class="flagbg2"> </span><span class="annot">]</span><span class="column">|</span><span class="annot">[</span><span class="flagbg2">  </span><span class="flagtxt1">annotation spanning bases</span><span class="flagbg2">  </span><span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="annot">[</span><span class="flagbg2"> </span>  a1  <span class="flagbg2"> </span><span class="annot">]</span><span class="column">|</span><span class="annot">[</span><span class="flagbg2"> </span><span class="flagbg1"> </span>annotation-2<span class="flagbg1"> </span><span class="flagbg2"> </span><span class="annot">]</span><span class="column">|</span><span class="annot">[</span><span class="flagbg2"> </span><span class="flagbg1"> </span>  a3  <span class="flagbg1"> </span><span class="flagbg2"> </span><span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="annot">[</span><span class="flagtxt2">lengthy annotation spanning base content</span><span class="annot">]</span><span class="column">|</span>
<span class="column">|</span><span class="base">[</span><span class="flagbg2"> </span>base 1<span class="flagbg2"> </span><span class="base">]</span><span class="column">|</span><span class="base">[</span><span class="flagbg2"> </span><span class="flagbg1"> </span>   base 2   <span class="flagbg1"> </span><span class="flagbg2"> </span><span class="base">]</span><span class="column">|</span><span class="base">[</span><span class="flagbg2"> </span><span class="flagbg1"> </span>base 3<span class="flagbg1"> </span><span class="flagbg2"> </span><span class="base">]</span><span class="column">|</span>
</pre>
                    <p>複数の<a data-link-type="dfn" href="#spanning-annotation"
                            id="ref-for-spanning-annotation⑨">スパン注釈</a>がある場合、
                        より少ない<a data-link-type="dfn" href="#ruby-base-box"
                            id="ref-for-ruby-base-box④⑦">基底</a>をスパンする注釈から先に処理します。
                        この例では緑の注釈（2基底スパン）が橙の注釈（3基底スパン）より先に処理されます。
                        順序が変わればスペース分配も変わります。</p>
                    <p>どの<a data-link-type="dfn" href="#spanning-annotation"
                            id="ref-for-spanning-annotation①⓪">スパン注釈</a>が
                        どの余白に関与しているか分かりやすいよう、
                        各<span id="ref-for-spanning-annotation①①">スパン注釈</span>のテキスト色を、
                        追加スペースの背景色と合わせています。</p>
            </dl>
        </div>
        <h4 class="heading settled" data-level="3.1.2" id="interlinear-block"><span class="secno">3.1.2. </span><span
                class="content">ブロック軸行間レイアウト</span><a class="self-link" href="#interlinear-block"></a>
        </h4>
        <p class="issue" id="issue-e7399eec"><a class="self-link" href="#issue-e7399eec"></a> これらのルビボックスに対して
            <a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-inline-3/#propdef-vertical-align"
                id="ref-for-propdef-vertical-align">vertical-align</a>がどの程度影響するか定義する必要があります。
            <a href="https://github.com/w3c/csswg-drafts/issues/4987">Issue 4987</a> を参照。
        </p>
        <p>各<a data-link-type="dfn" href="#ruby-base-container-box"
                id="ref-for-ruby-base-container-box②⑥">基底コンテナ</a>は次の内容すべてを
            ちょうど収めるようにサイズと位置が決まります：
            その<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box④⑧">ルビ基底</a>の margin ボックス全体、対応する<a
                data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation③">字間注釈</a>の<a data-link-type="dfn"
                href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑤④">ルビ注釈</a> margin ボックス（存在する場合）、およびこの<a
                data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container②⑦">ルビコンテナ</a>に従属して同じ<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-formatting-context"
                id="ref-for-inline-formatting-context⑥">インライン整形コンテキスト</a>に参加する子孫の<span
                id="ref-for-ruby-base-container-box②⑦">基底</span>や<a data-link-type="dfn"
                href="#ruby-annotation-container-box" id="ref-for-ruby-annotation-container-box③①">注釈コンテナ</a>。
            （<span id="ref-for-ruby-base-container-box②⑧">基底コンテナ</span>に<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#in-flow" id="ref-for-in-flow④">in-flow</a>内容がない場合は、
            空の<span id="ref-for-ruby-base-box④⑨">ルビ基底</span>が1つ入っているとしてサイズ・位置決定されます。）</p>
        <p>各<a data-link-type="dfn" href="#interlinear-annotations" id="ref-for-interlinear-annotations⑥">行間</a>の<a
                data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box③②">注釈コンテナ</a>は
            その<a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑤⑤">ルビ注釈</a>の margin
            ボックス全体および、
            この<a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container②⑧">ルビコンテナ</a>に従属して同じ<a
                data-link-type="dfn" href="#annotation-level" id="ref-for-annotation-level⑥">注釈レベル</a>の<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-formatting-context"
                id="ref-for-inline-formatting-context⑦">インライン整形コンテキスト</a>に参加する
            <a data-link-type="dfn" href="#ruby-base-container-box" id="ref-for-ruby-base-container-box②⑨">基底</a>や<span
                id="ref-for-ruby-annotation-container-box③③">注釈コンテナ</span>をちょうど収めるようにサイズ・位置決定されます。
            （<span id="ref-for-ruby-annotation-container-box③④">注釈コンテナ</span>に<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#in-flow" id="ref-for-in-flow⑤">in-flow</a>内容がない場合は、空の<span
                id="ref-for-ruby-annotation-box⑤⑥">ルビ注釈</span>1つ入っているとしてサイズ・位置決定されます。）
            これらの<span id="ref-for-ruby-annotation-container-box③⑤">注釈コンテナ</span>は
            <a class="property css" data-link-type="property" href="#propdef-ruby-position"
                id="ref-for-propdef-ruby-position①">ruby-position</a>に応じて
            対応する<span id="ref-for-ruby-base-container-box③⓪">基底コンテナ</span>の上下どちらかにスペース無しで積み重なり、
            <span id="ref-for-ruby-annotation-box⑤⑦">ルビ注釈</span>の基底とのブロック軸方向配置が決まります。
        </p>
        <p class="issue" id="issue-ea5c17b0"><a class="self-link" href="#issue-ea5c17b0"></a> ブロック軸マージンは折り畳むべきか？
            そうすればレイアウトが堅牢になるが、インライン軸での挙動とは矛盾する。</p>
        <h3 class="heading settled" data-level="3.2" id="inter-character-layout"><span class="secno">3.2. </span><span
                class="content">字間ルビレイアウト</span><a class="self-link" href="#inter-character-layout"></a></h3>
        <p><a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation④">字間注釈</a>は特殊なレイアウトとなります。<span
                id="ref-for-ruby-position-inter-character-annotation⑤">字間</span>の<a data-link-type="dfn"
                href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑤⑧">ルビ注釈ボックス</a>は
            <a data-link-type="dfn" href="#base-level" id="ref-for-base-level③">基底レベル</a>のレイアウトの一部として挿入・測定されます。
            各<span id="ref-for-ruby-annotation-box⑤⑨">ルビ注釈</span>は、ペアとなる<a data-link-type="dfn" href="#ruby-base-box"
                id="ref-for-ruby-base-box⑤①">ルビ基底</a>の右側に挿入されます。
            <a data-link-type="dfn" href="#span" id="ref-for-span③">スパン</a>する<span
                id="ref-for-ruby-position-inter-character-annotation⑥">字間注釈</span>は、スパンする基底の一番右の後ろに配置されます。
            <span id="ref-for-ruby-position-inter-character-annotation⑦">字間</span>の<span
                id="ref-for-ruby-annotation-box⑥⓪">ルビ注釈</span>は、以下に述べる例外を除き
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-block"
                id="ref-for-inline-block">インラインブロック</a>と同じようにレイアウトされます。
        </p>
        <p class="note" role="note"><span>注記:</span> <a class="css" data-link-type="maybe"
                href="#valdef-ruby-position-inter-character"
                id="ref-for-valdef-ruby-position-inter-character">inter-character</a> の定義通り、
            <a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation⑧">字間注釈</a>は常に
            <a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-writing-modes-4/#valdef-writing-mode-vertical-rl"
                id="ref-for-valdef-writing-mode-vertical-rl">vertical-rl</a> の
            <a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-writing-modes-4/#propdef-writing-mode"
                id="ref-for-propdef-writing-mode">writing-mode</a> となり、
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-4/#horizontal-writing-mode"
                id="ref-for-horizontal-writing-mode">横書き</a>の<a data-link-type="dfn" href="#ruby-container"
                id="ref-for-ruby-container②⑨">ルビコンテナ</a>でのみ存在します。
        </p>
        <p>各<a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑥①">ルビ注釈</a>は
            対象となる<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑤②">ルビ基底</a>の直後、
            （<a data-link-type="dfn" href="#inter-base-white-space" id="ref-for-inter-base-white-space③">基底間空白</a>や<a
                data-link-type="dfn" href="#inter-segment-white-space"
                id="ref-for-inter-segment-white-space⑤">セグメント間空白</a>の前）に配置されます。
            もし同じ<span id="ref-for-ruby-base-box⑤③">ルビ基底</span>に複数の
            <a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation⑨">字間</a><span
                id="ref-for-ruby-annotation-box⑥②">ルビ注釈ボックス</span>が並ぶ場合は、
            それらの<a data-link-type="dfn" href="https://www.w3.org/TR/css-box-4/#margin-box"
                id="ref-for-margin-box">margin ボックス</a>は、スペースなしで右方向に（レベル順で）積み重ねられます。
        </p>
        <p>もし<a data-link-type="dfn" href="https://www.w3.org/TR/css-sizing-3/#automatic-size"
                id="ref-for-automatic-size">自動高さ</a>の<a data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box⑥③">ルビ注釈ボックス</a>の
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-box-4/#content-area"
                id="ref-for-content-area">内容領域</a>が、直後の<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-box-4/#content-box" id="ref-for-content-box">内容ボックス</a>（<a
                data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑤④">ルビ基底</a>の）より低い場合、
            注釈ボックスの<span id="ref-for-content-box①">内容ボックス</span>高さは正確に基底と一致するよう拡大されます。
        </p>
        <p><a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑥④">ルビ注釈ボックス</a>の揃え方は、
            <span class="property css" id="ref-for-propdef-ruby-align⑥">ruby-align</span>プロパティによって決まります：
        </p>
        <ul>
            <li> <a class="property css" href="#propdef-ruby-align" id="ref-for-propdef-ruby-align⑦">ruby-align</a> が
                <a class="css" data-link-type="maybe" href="#valdef-ruby-align-start"
                    id="ref-for-valdef-ruby-align-start">start</a> の場合、
                <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑥⑥">ルビ注釈</a>の
                <a data-link-type="dfn" href="https://www.w3.org/TR/css-box-4/#content-box"
                    id="ref-for-content-box②">内容ボックス</a>上端を
                <a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑤⑤">ルビ基底</a>の
                <span id="ref-for-content-box③">内容ボックス</span>上端に揃えます。
            <li> それ以外の場合は、<a data-link-type="dfn" href="#ruby-annotation-box"
                    id="ref-for-ruby-annotation-box⑥⑦">ルビ注釈</a>の
                <a data-link-type="dfn" href="https://www.w3.org/TR/css-box-4/#content-box"
                    id="ref-for-content-box④">内容ボックス</a>中心を
                <a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑤⑥">ルビ基底</a>の
                <span id="ref-for-content-box⑤">内容ボックス</span>中心に垂直に揃えます。
        </ul>
        <p><a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation①⓪">字間注釈</a>の<a data-link-type="dfn"
                href="#ruby-annotation-container-box" id="ref-for-ruby-annotation-container-box③⑥">ルビ注釈コンテナボックス</a>は、
            その内容ボックスが<a data-link-type="dfn" href="#ruby-base-container-box"
                id="ref-for-ruby-base-container-box③①">ルビ基底コンテナボックス</a>と
            ちょうど一致するようにサイズ・配置されます。</p>
        <p class="note" role="note"><span>注記:</span> <a data-link-type="dfn"
                href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation①①">字間</a>の
            <a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box③⑦">ルビ注釈コンテナボックス</a>の
            サイズや位置はレイアウトに一切影響しません。
            上記定義はプログラムによる問い合わせで決定的な結果を得るためのものです。
        </p>
        <p><a href="#ruby-align-property">揃え</a>やカラム幅決定（<a href="#ruby-layout">§ 3 ルビのレイアウト</a>参照）の目的では、
            <a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation①②">字間</a>の
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑥⑧">ルビ注釈</a>は、
            紐付く基底と同じ<a data-link-type="dfn" href="#ruby-columns" id="ref-for-ruby-columns①③">カラム</a>の一部とみなされず、
            独自の<span id="ref-for-ruby-columns①④">カラム</span>を形成するものとします。
        </p>
        <h3 class="heading settled" data-level="3.3" id="box-style"><span class="secno">3.3. </span><span
                class="content">ルビボックスのスタイル付け</span><a class="self-link" href="#box-style"></a></h3>
        <p><a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑤⑦">ルビ基底</a>と<a data-link-type="dfn"
                href="#ruby-container" id="ref-for-ruby-container③⓪">ルビコンテナ</a>は
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-box"
                id="ref-for-inline-box⑦">インラインボックス</a>として扱われ、
            特に規定がない限り、<span id="ref-for-inline-box⑧">インラインボックス</span>に適用可能なすべてのプロパティも同様に適用されます。
            ただし、<a data-link-type="dfn" href="https://www.w3.org/TR/css-inline-3/#line-relative-shift-values"
                id="ref-for-line-relative-shift-values">行基準シフト値</a>
            <a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-inline-3/#propdef-vertical-align"
                id="ref-for-propdef-vertical-align①">vertical-align</a> （<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-inline-3/#valdef-baseline-shift-top"
                id="ref-for-valdef-baseline-shift-top">top</a>、<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-inline-3/#valdef-baseline-shift-bottom"
                id="ref-for-valdef-baseline-shift-bottom">bottom</a>）は無視され（ゼロとして扱う）必要があります。
        </p>
        <p>特に規定がない限り、
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-box"
                id="ref-for-inline-box⑨">インラインボックス</a>に適用可能なすべてのプロパティは、
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑥⑨">ルビ注釈</a>にも同様に適用されますが、
            <a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height"
                id="ref-for-propdef-line-height">line-height</a>は適用されません。
            また、<a data-link-type="dfn" href="https://www.w3.org/TR/css-inline-3/#line-relative-shift-values"
                id="ref-for-line-relative-shift-values①">行基準シフト値</a>
            <a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-inline-3/#propdef-vertical-align"
                id="ref-for-propdef-vertical-align②">vertical-align</a>（<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-inline-3/#valdef-baseline-shift-top"
                id="ref-for-valdef-baseline-shift-top①">top</a>、<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-inline-3/#valdef-baseline-shift-bottom"
                id="ref-for-valdef-baseline-shift-bottom①">bottom</a>）も無視され（ゼロとして扱う）必要があります。
        </p>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/css-box-4/#margin" id="ref-for-margin">margin</a>、
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-box-4/#padding" id="ref-for-padding">padding</a>、
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-box-4/#border" id="ref-for-border">border</a>プロパティ
            およびインラインボックスに適用されないプロパティは
            <a data-link-type="dfn" href="#ruby-base-container-box" id="ref-for-ruby-base-container-box③②">基底コンテナ</a>や
            <a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box③⑧">注釈コンテナ</a>には適用されません。
            さらに、<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height"
                id="ref-for-propdef-line-height①">line-height</a>は<span
                id="ref-for-ruby-annotation-container-box③⑨">注釈コンテナ</span>には適用されません。
        </p>
        <p>UAは
            <a data-link-type="dfn" href="#ruby-base-container-box"
                id="ref-for-ruby-base-container-box③③">ルビ基底コンテナボックス</a>や
            <a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box④⓪">ルビ注釈コンテナボックス</a>に対し、
            backgroundプロパティやoutlineプロパティなど
            ボックスの範囲を描画するプロパティをサポートする必要はありません。
            UAはこれらのボックスを継承や内容レイアウト制御のための抽象概念として実装してもかまいません。
        </p>
        <h3 class="heading settled" data-level="3.4" id="line-breaks"><span class="secno">3.4. </span><span
                class="content">行の折り返し</span><a class="self-link" href="#line-breaks"></a></h3>
        <p><a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container③①">ルビコンテナ</a>全体が行に収まらない場合、
            すべてのレベルで同時に改行が許可されている箇所でルビを折り返してもよいです。
            （行の折り返し詳細は
            <a href="https://www.w3.org/TR/css-text-3/#line-breaking"><cite>CSS Text 3</cite> § 5 行の折り返しと単語境界</a>を参照。）
            ルビは通常、基底-注釈セットの間で折り返されますが、
            行折り返し規則が許す場合、<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑤⑧">ルビ基底</a>（および対応する<a
                data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box⑦⓪">ルビ注釈ボックス</a>）内部でも折り返されることがあります。
        </p>
        <p>ルビが行をまたぐときは、<a data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box⑦①">ルビ注釈</a>は必ず
            対応する<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑤⑨">ルビ基底</a>と一緒に動きます。
            <span id="ref-for-ruby-base-box⑥⓪">ルビ基底</span>と<span id="ref-for-ruby-annotation-box⑦②">注釈</span>の間、
            あるいは<a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation①③">字間注釈</a>の場合であっても、
            <em>行途中で分断してはなりません</em>。
        </p>
        <div class="figure">
            <img alt="Bopomofoルビの行折り返し位置の図" height="90" src="https://www.w3.org/TR/css-ruby-1/images/r-break-b.gif" width="300">
            <p class="caption"><a class="css" data-link-type="maybe" href="#valdef-ruby-position-inter-character"
                    id="ref-for-valdef-ruby-position-inter-character①">字間</a>ルビの行折り返し位置 </p>
        </div>
        <p>行折り返し後、
            各断片は<a href="#ruby-layout">独立してレイアウト</a>され、
            <a href="#ruby-align-property">ルビ揃え</a>も断片ごとに行われます。
        </p>
        <h4 class="heading settled" data-level="3.4.1" id="break-between"><span class="secno">3.4.1. </span><span
                class="content">基底間の折り返し</span><a class="self-link" href="#break-between"></a></h4>
        <p>通常、<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑥①">ルビ基底ボックス</a>や
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑦③">ルビ注釈ボックス</a>は
            内部での改行を禁止するスタイルとなっており、強制改行も含みません。
            （<a href="#default-stylesheet">付録A</a>を参照。）
            この場合、<a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container③②">ルビコンテナ</a>は
            隣接する<span id="ref-for-ruby-base-box⑥②">ルビ基底</span>間でのみ折り返すことができ、
            その<span id="ref-for-ruby-base-box⑥③">ルビ基底</span>にスパンする<span
                id="ref-for-ruby-annotation-box⑦④">ルビ注釈</span>が存在しない場合のみです。
        </p>
        <div class="figure">
            <img alt="複雑なルビの行折り返し位置の図" height="201" src="https://www.w3.org/TR/css-ruby-1/images/r-break-a.gif" width="408">
            <p class="caption">ルビの行折り返し位置 </p>
        </div>
        <p>2つの隣接する<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑥④">ルビ基底</a>間でルビが折り返せるかどうかは、
            基底テキストの通常の行折り返し規則で制御されます。
            これは<span id="ref-for-ruby-base-box⑥⑤">ルビ基底</span>が隣接するインラインボックスであるかのように判定されます。
            （注釈は<a data-link-type="dfn" href="#base-level" id="ref-for-base-level④">基底レベル</a>の
            ソフトラップ判定時には無視されます。）</p>
        <div class="example" id="example-9780a5d8">
            <a class="self-link" href="#example-9780a5d8"></a> 例：2つの隣接ルビ基底が「蝴」と「蝶」の場合、
            通常、2つの漢字の間で行を折り返せます。
            ただし、<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-text-3/#propdef-word-break"
                id="ref-for-propdef-word-break">word-break</a>が
            <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-text-3/#valdef-word-break-keep-all"
                id="ref-for-valdef-word-break-keep-all">keep-all</a>のときは、その箇所での行折り返しは禁止されます。
            <pre
                class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->蝴<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->hú<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->蝶<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->dié<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c-></pre>
        </div>
        <p>基底間空白は、<a data-link-type="dfn" href="#ruby-base-box"
                id="ref-for-ruby-base-box⑥⑥">ルビ基底</a>間での行折り返し機会を評価する際に意味を持ちます。
            インライン間の空白と同様に、
            そこで行が折り返されると空白は折り畳まれます。
            詳細は<a href="https://www.w3.org/TR/css-text-3/#white-space-rules"><cite>CSS Text
                    3</cite> § 4.1 空白処理ルール</a>参照。
            同様に、注釈の空白も行折り返し時にトリムされます。</p>
        <div class="example" id="example-070966be">
            <a class="self-link" href="#example-070966be"></a> 例：次のマークアップを考えます。
            <pre
                class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c->one<c- p>&lt;/</c-><c- f>rb</c-><c- p>></c-> <c- p>&lt;</c-><c- f>rb</c-><c- p>></c->two<c- p>&lt;/</c-><c- f>rb</c-><c- p>></c-> <c- p>&lt;</c-><c- f>rt</c-><c- p>></c->1<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c-> <c- p>&lt;</c-><c- f>rt</c-><c- p>></c->2<c- p>&lt;/</c-><c- f>rt</c-><c- p>>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
            <p>この場合、空白があるため "one" と "two" の間で行が折り返せます。
                そこで行が折り返されると、その空白や "1" と "2" の間の空白は標準CSS空白処理規則により消えます。</p>
        </div>
        <h4 class="heading settled" data-level="3.4.2" id="break-within"><span class="secno">3.4.2. </span><span
                class="content">基底内での折り返し</span><a class="self-link" href="#break-within"></a></h4>
        <p>長い基底テキストの場合、基底-注釈ペアの内部で行を折り返し可能にするのが適切なこともあります。
            例えば、英文に日本語訳注釈を付けた場合、テキストの折り返しを許すことで段落内の行折り返しが自然になります。</p>
        <p class="issue" id="issue-14d7c6b1"><a class="self-link" href="#issue-14d7c6b1"></a>
            仕様執筆者の妄想ではなく実際例であることを示すため、スキャン例を挿入すること。</p>
        <p><a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑥⑦">ルビ基底</a>内での行折り返しは、
            <span class="property css" id="ref-for-propdef-white-space②">white-space</span>プロパティが
            <span id="ref-for-ruby-base-box⑥⑧">ルビ基底</span>とすべての並列<a data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box⑦⑤">注釈</a>で許可されており、
            かつ各基底/注釈ボックス内容内（先頭・末尾以外）に
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-text-3/#soft-wrap-opportunity"
                id="ref-for-soft-wrap-opportunity">ソフトラップ機会</a>がある場合のみです。
            <span id="ref-for-ruby-base-box⑥⑨">ルビ基底</span>や<span
                id="ref-for-ruby-annotation-box⑦⑥">注釈</span>の断片間には構造的対応関係が無いため、
            UAは任意の機会で改行してよいですが、
            断片ごとの内容量を比例的に均等化するのが推奨されます。
        </p>
        <p><a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation①④">字間注釈</a>内では
            行折り返し機会はありません。</p>
        <h3 class="heading settled" data-level="3.5" id="bidi"><span class="secno">3.5. </span><span class="content">
                双方向（Bidi）並べ替え</span><a class="self-link" href="#bidi"></a></h3>
        <p>Unicode双方向アルゴリズムは、異なる方向性の文字が同一段落内に混在した場合、
            視覚的表示のため論理順テキストを並べ替えます。</p>
        <p><a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑦⑦">ルビ注釈</a>と対応する<a
                data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑦⓪">ルビ基底</a>の対応関係を保つため、
            いくつかの制約を課す必要があります：</p>
        <ul>
            <li><a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑦①">ルビ基底</a>や
                <a data-link-type="dfn" href="#ruby-annotation-box"
                    id="ref-for-ruby-annotation-box⑦⑧">ルビ注釈</a>の内容は連続していなければならない。
            <li><a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑦⑨">ルビ注釈</a>は
                対応する<a data-link-type="dfn" href="#ruby-base-box"
                    id="ref-for-ruby-base-box⑦②">ルビ基底</a>と一緒に並べ替えられなければならない。
            <li>単一の<a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑧⓪">ルビ注釈</a>で
                スパンされるすべての<a data-link-type="dfn" href="#ruby-base-box"
                    id="ref-for-ruby-base-box⑦③">ルビ基底</a>は連続していなければならない。
        </ul>
        <p>これを実現するために、</p>
        <ul>
            <li>
                すべての<a data-link-type="dfn" href="#internal-ruby-boxes"
                    id="ref-for-internal-ruby-boxes②">内部ルビボックス</a>および<a data-link-type="dfn" href="#ruby-container"
                    id="ref-for-ruby-container③③">ルビコンテナ</a>に
                強制的にBidiアイソレーションが適用されます：
                <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-normal"
                    id="ref-for-valdef-unicode-bidi-normal">normal</a> および
                <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-embed"
                    id="ref-for-valdef-unicode-bidi-embed">embed</a> の
                <a class="property css" data-link-type="property"
                    href="https://www.w3.org/TR/css-writing-modes-3/#propdef-unicode-bidi"
                    id="ref-for-propdef-unicode-bidi">unicode-bidi</a>値は
                <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-isolate"
                    id="ref-for-valdef-unicode-bidi-isolate">isolate</a> に、
                <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-bidi-override"
                    id="ref-for-valdef-unicode-bidi-bidi-override">bidi-override</a>は
                <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-isolate-override"
                    id="ref-for-valdef-unicode-bidi-isolate-override">isolate-override</a> に計算されます。
                <p class="note" role="note"><span>注記:</span> これにより、暗黙的なBidi並べ替えは
                    ルビ基底をまたいで動作しなくなるため、
                    著者は<a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container③④">ルビコンテナ</a>の
                    direction指定が内容と一致していることを保証する必要があります。</p>
            <li> レイアウト時、<a data-link-type="dfn" href="#ruby-segments" id="ref-for-ruby-segments①⑤">ルビセグメント</a>は
                <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container③⑤">ルビコンテナ</a>内でその<span
                    class="property css" id="ref-for-propdef-direction">direction</span>プロパティに従い順序付けされます。
            <li>
                セグメント内では、<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑦④">ルビ基底</a>や
                <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑧①">ルビ注釈</a>で
                <a data-link-type="dfn" href="#merged-annotation" id="ref-for-merged-annotation②">マージ注釈</a>でないものは
                セグメントの<a data-link-type="dfn" href="#ruby-base-container-box"
                    id="ref-for-ruby-base-container-box③④">ルビ基底コンテナ</a>の
                <span class="property css" id="ref-for-propdef-direction①">direction</span>プロパティで順序付けされます。
                <span id="ref-for-merged-annotation③">マージ注釈</span>は
                <a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box④①">注釈コンテナ</a>の
                <span class="property css" id="ref-for-propdef-direction②">direction</span>で順序付けされ、
                まるで注釈コンテナ内のインラインボックス列であるかのように扱われます。
                <p class="note" role="note"><span>注記:</span>
                    つまり<a class="property css" data-link-type="property"
                        href="https://www.w3.org/TR/css-writing-modes-3/#propdef-direction"
                        id="ref-for-propdef-direction③">direction</a>プロパティは
                    <a data-link-type="dfn" href="#ruby-annotation-container-box"
                        id="ref-for-ruby-annotation-container-box④③">注釈コンテナ</a>
                    の非<a data-link-type="dfn" href="#merged-annotation" id="ref-for-merged-annotation④">マージ注釈</a>の
                    レイアウトには無視されますが、子要素へ継承し
                    <a data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-4/#inline-base-direction"
                        id="ref-for-inline-base-direction">インライン基底方向</a>に影響を与える場合があります。
                </p>
        </ul>
        <p>他のインラインレベル内容と同じく、
            <a data-link-type="dfn" href="#internal-ruby-boxes" id="ref-for-internal-ruby-boxes③">内部ルビボックス</a>のBidi並べ替えは
            行折り返し後に行われ、論理順に従って内容が行に分割されます。
        </p>
        <p class="note" role="note"><span>注記:</span>
            もし<a class="property css" data-link-type="property" href="#propdef-ruby-merge"
                id="ref-for-propdef-ruby-merge⑤">ruby-merge</a>が対象<a data-link-type="dfn"
                href="#ruby-annotation-container-box" id="ref-for-ruby-annotation-container-box④④">注釈コンテナ</a>で
            <a class="css" data-link-type="maybe" href="#valdef-ruby-merge-merge"
                id="ref-for-valdef-ruby-merge-merge①">merge</a> の場合に限り、
            個々の注釈へのBidiアイソレーションを適用しないことで
            一括処理できるようにしてもよいかもしれません。
            ただし、この状況をサポートする需要がない限り
            実装複雑化の正当性が薄いため、必要な事例がある方はCSS WGまでご連絡ください。
        </p>
        <p>CSSにおける双方向テキストについてさらに詳しくは
            <a data-link-type="biblio" href="#biblio-css3-writing-modes"
                title="CSS Writing Modes Level 3">[CSS3-WRITING-MODES]</a>を参照してください。
        </p>
        <h3 class="heading settled" data-level="3.6" id="line-height"><span class="secno">3.6. </span><span
                class="content"> 行間隔</span><a class="self-link" href="#line-height"></a></h3>
        <p><a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height"
                id="ref-for-propdef-line-height②">line-height</a>プロパティは、CSSにおける行間の間隔を制御します。
            行内のインライン内容が<span class="property" id="ref-for-propdef-line-height③">line-height</span>より短い場合は、
            内容の上下にハーフリーディングが追加されます（<a href="https://www.w3.org/TR/css-inline-3/#line-height"><cite>CSS Inline Layout
                    3</cite>
                § 5 論理的高さと行間隔</a>参照）。</p>
        <p>行間の一貫した間隔を確保するため、
            ルビ付き文書では通常、<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height"
                id="ref-for-propdef-line-height④">line-height</a>が
            ルビをテキスト行間に収めるのに十分な大きさになるようにします。
            そのため、通常は<a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box④⑤">ルビ注釈コンテナ</a>や<a data-link-type="dfn"
                href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑧③">ルビ注釈ボックス</a>は
            行内内容の高さの計測には寄与せず、
            揃え（<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-inline-3/#propdef-vertical-align"
                id="ref-for-propdef-vertical-align③">vertical-align</a>参照）やline-heightの計算は
            <a data-link-type="dfn" href="#ruby-base-container-box"
                id="ref-for-ruby-base-container-box③⑤">ルビ基底コンテナ</a>のみを用いて行われます。これはあたかも通常のインラインであるかのように動作します。
        </p>
        <p>ただし、<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height"
                id="ref-for-propdef-line-height⑤">line-height</a>が<a data-link-type="dfn" href="#ruby-container"
                id="ref-for-ruby-container③⑦">ルビコンテナ</a>で指定されており、その値が
            一番上の<a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box④⑥">ルビ注釈コンテナ</a>の上端と
            一番下の<span id="ref-for-ruby-annotation-container-box④⑦">ルビ注釈コンテナ</span>の下端の間の距離よりも小さい場合は、
            <a data-link-type="dfn" href="#ruby-base-container-box"
                id="ref-for-ruby-base-container-box③⑥">ルビ基底コンテナ</a>の適切な側に追加リーディングが加えられます。これにより、もし3行すべてに同じルビがあったとしても
            <span id="ref-for-ruby-container③⑧">ルビコンテナ</span>同士が重ならないようになります。
        </p>
        <p class="note" role="note"><span>注記:</span> これは<a data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box⑧④">ルビ注釈</a>が
            行ボックス内に必ず収まることを保証するものではありません。
            あくまで<em>すべての行の間隔が等しく</em>かつルビ注釈の量や位置が等しい場合に
            オーバーラップを防ぐのに十分な余白が確保されるのみです。
        </p>
        <p>著者は、ルビを考慮した<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height"
                id="ref-for-propdef-line-height⑥">line-height</a>や<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-box-4/#propdef-padding" id="ref-for-propdef-padding">padding</a>の指定に注意し、
            特にブロックの先頭や末尾、または行内に
            画像・インラインブロック・<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-inline-3/#propdef-vertical-align"
                id="ref-for-propdef-vertical-align④">vertical-align</a>でシフトされた
            パラグラフのデフォルトフォントサイズより高いインライン要素がある場合には十分配慮してください。</p>
        <div class="figure">
            <img alt="各行の内容はline-heightの中央に配置され、両側の追加スペースがハーフリーディングと呼ばれる。ルビが2倍のハーフリーディングより小さい場合は行間に収まるが、これは前の行のハーフリーディング部分にルビがはみ出していることを意味する。"
                height="138" src="https://www.w3.org/TR/css-ruby-1/images/rlh-a.gif" width="210">
            <p class="caption">ルビ注釈はしばしば行からはみ出します。ルビ付き行の上や下の内容には
                ルビのための十分なスペースを確保してください。</p>
        </div>
        <p class="note" role="note"><span>注記:</span> ルビが整列や行レイアウトにどう影響するかについての
            より詳細な制御はCSS Line Layout Module Level 3で導入予定です。
            ただし現時点では探究段階であり、新機能の記述はまだ信頼性がありません。</p>
        <h2 class="heading settled" data-level="4" id="ruby-props"><span class="secno">4. </span><span class="content">
                ルビ書式プロパティ</span><a class="self-link" href="#ruby-props"></a></h2>
        <p>以下のプロパティはルビの<a href="#rubypos">配置</a>、<a href="#collapsed-ruby">テキスト分布</a>、
            <a href="#rubyalign">揃え</a>を制御するために導入されています。
        </p>
        <h3 class="heading settled" data-level="4.1" id="rubypos"><span class="secno">4.1. </span><span class="content">
                ルビの配置：<a class="property css" data-link-type="property" href="#propdef-ruby-position"
                    id="ref-for-propdef-ruby-position②">ruby-position</a>プロパティ</span><a class="self-link"
                href="#rubypos"></a></h3>
        <table class="def propdef" data-link-for-hint="ruby-position">
            <tbody>
                <tr>
                    <th>名前:
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-ruby-position">ruby-position</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">値:</a>
                    <td class="prod">[ alternate <a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#comb-any" id="ref-for-comb-any">||</a> [ over <a
                            data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one"
                            id="ref-for-comb-one④">|</a> under ] ] <span id="ref-for-comb-one⑤">|</span> inter-character
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">初期値:</a>
                    <td>alternate
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">適用対象:</a>
                    <td>ルビ注釈コンテナ
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">継承:</a>
                    <td>yes
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">百分率:</a>
                    <td>n/a
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">算出値:</a>
                    <td>指定キーワード
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">正規順序:</a>
                    <td>文法順
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">アニメーション型:</a>
                    <td>離散
        </table>
        <p>このプロパティは<a data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box⑧⑥">ルビ注釈</a>が基底に対してどこに配置されるかを制御します。
            各値の意味は以下の通りです：</p>
        <dl>
            <dt><dfn class="dfn-paneled css" data-dfn-for="ruby-position" data-dfn-type="value" data-export
                    id="valdef-ruby-position-alternate">alternate</dfn>
            <dd>
                複数の<a data-link-type="dfn" href="#annotation-level" id="ref-for-annotation-level⑧">注釈レベル</a>が
                <a class="css" data-link-type="maybe" href="#valdef-ruby-position-over"
                    id="ref-for-valdef-ruby-position-over">over</a> と <a class="css" data-link-type="maybe"
                    href="#valdef-ruby-position-under" id="ref-for-valdef-ruby-position-under">under</a> で交互になります。
                <p>もし<a data-link-type="dfn" href="#ruby-annotation-container-box"
                        id="ref-for-ruby-annotation-container-box④⑧">注釈コンテナ</a>がその<a data-link-type="dfn"
                        href="#annotation-level" id="ref-for-annotation-level⑨">注釈レベル</a>で最初である場合や、
                    それ以前のすべての<span id="ref-for-annotation-level①⓪">レベル</span>が<a data-link-type="dfn"
                        href="#ruby-position-inter-character-annotation"
                        id="ref-for-ruby-position-inter-character-annotation①⑤">字間</a>の場合は、
                    <a class="css" data-link-type="maybe" href="#valdef-ruby-position-alternate"
                        id="ref-for-valdef-ruby-position-alternate">alternate</a>単独または
                    <a class="css" data-link-type="maybe" href="#valdef-ruby-position-over"
                        id="ref-for-valdef-ruby-position-over①">over</a>との組み合わせは
                    <span class="css" id="ref-for-valdef-ruby-position-over②">over</span>と同様に動作し、
                    <span class="css" id="ref-for-valdef-ruby-position-alternate①">alternate</span>と
                    <a class="css" data-link-type="maybe" href="#valdef-ruby-position-under"
                        id="ref-for-valdef-ruby-position-under①">under</a>の組み合わせは
                    <span class="css" id="ref-for-valdef-ruby-position-under②">under</span>と同様に動作します。
                </p>
                <p>それ以外の場合、
                    直前の<a data-link-type="dfn" href="#interlinear-annotations"
                        id="ref-for-interlinear-annotations⑦">行間</a>注釈が
                    <a class="css" data-link-type="maybe" href="#valdef-ruby-position-over"
                        id="ref-for-valdef-ruby-position-over③">over</a>であれば
                    <a class="css" data-link-type="maybe" href="#valdef-ruby-position-alternate"
                        id="ref-for-valdef-ruby-position-alternate②">alternate</a>は
                    <a class="css" data-link-type="maybe" href="#valdef-ruby-position-under"
                        id="ref-for-valdef-ruby-position-under③">under</a>と同じ動作をし、
                    逆も同様です。
                    （この場合、<span class="css" id="ref-for-valdef-ruby-position-alternate③">alternate</span>を単独指定しても
                    <span class="css" id="ref-for-valdef-ruby-position-over④">over</span>または
                    <span class="css" id="ref-for-valdef-ruby-position-under④">under</span>と組み合わせても違いはありません。）
                </p>
            <dt><dfn class="dfn-paneled css" data-dfn-for="ruby-position" data-dfn-type="value" data-export
                    id="valdef-ruby-position-over">over</dfn>
            <dd>
                ルビ注釈は基底の<a data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-4/#line-over"
                    id="ref-for-line-over">上側</a>に表示されます。
                <div class="figure">
                    <img alt="横書きモードで基底の上にルビが表示されている図" height="33" src="https://www.w3.org/TR/css-ruby-1/images/shinkansen-top.gif" width="140">
                    <p class="caption">横書き日本語の基底の上にルビ</p>
                </div>
                <div class="figure">
                    <img alt="縦書きモードで基底の右にルビが表示されている図" src="https://www.w3.org/TR/css-ruby-1/images/shinkansen-right.gif" width="33">
                    <p class="caption">縦書き日本語の基底の右にルビ</p>
                </div>
            <dt><dfn class="dfn-paneled css" data-dfn-for="ruby-position" data-dfn-type="value" data-export
                    id="valdef-ruby-position-under">under</dfn>
            <dd>
                ルビ注釈は基底の<a data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-4/#line-under"
                    id="ref-for-line-under">下側</a>に表示されます。
                この設定は表意東アジア系文字の組版では比較的珍しく、教育用テキストなどで見られます。
                <div class="figure">
                    <img alt="横書きモードで基底の下にルビが表示されている図" height="36" src="https://www.w3.org/TR/css-ruby-1/images/shinkansen-bottom.gif" width="142">
                    <p class="caption">横書き日本語の基底の下にルビ</p>
                </div>
                <div class="figure">
                    <img alt="縦書きモードで基底の左にルビが表示されている図" height="141" src="https://www.w3.org/TR/css-ruby-1/images/shinkansen-left.gif" width="37">
                    <p class="caption">縦書き日本語の基底の左にルビ</p>
                </div>
            <dt><dfn class="dfn-paneled css" data-dfn-for="ruby-position" data-dfn-type="value" data-export
                    id="valdef-ruby-position-inter-character">inter-character</dfn>
            <dd>
                親<a data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-4/#writing-mode"
                    id="ref-for-writing-mode">writing mode</a> が<a data-link-type="dfn" href="#ruby-container"
                    id="ref-for-ruby-container③⑨">ルビコンテナ</a>で
                <a data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-4/#vertical-writing-mode"
                    id="ref-for-vertical-writing-mode">縦書き</a>の場合は、
                <a class="css" data-link-type="maybe" href="#valdef-ruby-position-over"
                    id="ref-for-valdef-ruby-position-over⑤">over</a>と同じ動作になります。
                <p>それ以外の場合、ルビ注釈は<dfn class="dfn-paneled" data-dfn-for="ruby-position" data-dfn-type="dfn"
                        data-local-lt="inter-character" data-noexport
                        id="ruby-position-inter-character-annotation">字間注釈</dfn>となります。
                    注釈は横書きテキストの場合、基底の右側に表示されます。
                    このとき、この<a data-link-type="dfn" href="#ruby-annotation-container-box"
                        id="ref-for-ruby-annotation-container-box④⑨">ルビ注釈コンテナ</a>の
                    子<a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑧⑦">ルビ注釈</a>の
                    <a class="property css" data-link-type="property"
                        href="https://www.w3.org/TR/css-writing-modes-4/#propdef-writing-mode"
                        id="ref-for-propdef-writing-mode①">writing-mode</a>の算出値は
                    <a class="css" data-link-type="maybe"
                        href="https://www.w3.org/TR/css-writing-modes-4/#valdef-writing-mode-vertical-rl"
                        id="ref-for-valdef-writing-mode-vertical-rl①">vertical-rl</a> となります。
                </p>
                <p class="note" role="note"><span>注記:</span> <a class="property css" data-link-type="property"
                        href="https://www.w3.org/TR/css-writing-modes-4/#propdef-writing-mode"
                        id="ref-for-propdef-writing-mode②">writing-mode</a>の算出値は
                    <a data-link-type="dfn" href="#ruby-annotation-container-box"
                        id="ref-for-ruby-annotation-container-box⑤⓪">ルビ注釈コンテナ</a>自身には影響しません。
                    これは、同一要素上の
                    <span class="property" id="ref-for-propdef-writing-mode③">writing-mode</span>、
                    <a class="property css" data-link-type="property"
                        href="https://www.w3.org/TR/css-display-3/#propdef-display"
                        id="ref-for-propdef-display①⑧">display</a>、
                    <a class="property css" data-link-type="property" href="#propdef-ruby-position"
                        id="ref-for-propdef-ruby-position③">ruby-position</a>
                    の算出値間で循環依存を避けるためです。
                </p>
                <p>この値は台湾などで使われる伝統的な中国語の特殊ケース向けです。
                    その文脈では（<a href="#g-bopomofo">注音符号</a>ルビ）は、
                    横組みでも基底文字の右側に縦に現れます：</p>
                <div class="figure">
                    <img alt="台湾式ルビの例" height="42" src="https://www.w3.org/TR/css-ruby-1/images/bopomofo.gif" width="138">
                    <p class="caption">伝統的中国語の“注音符号”ルビ（分かりやすく青で表示）横組みの場合</p>
                </div>
                <div class="note" role="note">
                    注記: 継承は要素ツリーに沿って行われるため
                    ルビレイアウトで生成される匿名ボックスは考慮されません。
                    <a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                        id="ref-for-ruby-position-inter-character-annotation①⑥">字間注釈</a>を使う場合、
                    要素ベースの<a data-link-type="dfn" href="#ruby-annotation-container-box"
                        id="ref-for-ruby-annotation-container-box⑤①">ルビ注釈コンテナ</a>・
                    匿名<a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑧⑧">ルビ注釈</a>・
                    さらにその子孫要素を含む
                    マークアップパターンは避ける必要があります。なぜなら、
                    その子孫は<span id="ref-for-ruby-annotation-container-box⑤②">ルビ注釈コンテナ</span>から
                    writing-modeを継承し、
                    <span id="ref-for-ruby-annotation-box⑧⑨">ルビ注釈</span>の
                    <a class="property css" data-link-type="property"
                        href="https://www.w3.org/TR/css-writing-modes-4/#propdef-writing-mode"
                        id="ref-for-propdef-writing-mode④">writing-mode</a>
                    変更の影響を受けません。
                    <div class="example" id="example-af80289a">
                        <a class="self-link" href="#example-af80289a"></a>
                        <pre
                            class="highlight">ruby <c- p>{</c-> <c- k>ruby-position</c-><c- p>:</c-> inter-character<c- p>;</c-> <c- p>}</c-></pre>
                        <pre
                            class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->base<c- p>&lt;</c-><c- f>rtc</c-><c- p>>&lt;</c-><c- f>em</c-><c- p>></c->problematic<c- p>&lt;/</c-><c- f>em</c-><c- p>></c-> annotation<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
                        <p>上記のマークアップでは、“problematic annotation”全体をラップする匿名<a data-link-type="dfn"
                                href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑨⓪">ルビ注釈</a>ボックスが
                            <code>&lt;rtc></code> 要素の子として生成されます。
                            それは<a data-link-type="dfn" href="#ruby-annotation-container-box"
                                id="ref-for-ruby-annotation-container-box⑤③">注釈コンテナ</a>の
                            <a class="property css" data-link-type="property" href="#propdef-ruby-position"
                                id="ref-for-propdef-ruby-position④">ruby-position</a>が
                            <a class="css" data-link-type="maybe" href="#valdef-ruby-position-inter-character"
                                id="ref-for-valdef-ruby-position-inter-character②">inter-character</a>
                            のため、
                            その
                            <a class="property css" data-link-type="property"
                                href="https://www.w3.org/TR/css-writing-modes-4/#propdef-writing-mode"
                                id="ref-for-propdef-writing-mode⑤">writing-mode</a>
                            は
                            <a class="css" data-link-type="maybe"
                                href="https://www.w3.org/TR/css-writing-modes-4/#valdef-writing-mode-vertical-rl"
                                id="ref-for-valdef-writing-mode-vertical-rl③">vertical-rl</a>
                            となり、期待通りです。
                            しかし<code>&lt;em></code>要素は
                            <code>&lt;rtc></code>の<span class="property"
                                id="ref-for-propdef-writing-mode⑥">writing-mode</span>を直接継承し、
                            それはvertical-rlに強制されていません。
                        </p>
                        <p>この例では明示的な<a data-link-type="dfn" href="#ruby-annotation-container-box"
                                id="ref-for-ruby-annotation-container-box⑤④">ルビ注釈コンテナ</a>要素は不要なので
                            <a data-link-type="dfn" href="#ruby-annotation-box"
                                id="ref-for-ruby-annotation-box⑨①">ルビ注釈</a>要素を使えば問題は避けられます：
                        </p>
                        <pre
                            class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->base<c- p>&lt;</c-><c- f>rt</c-><c- p>>&lt;</c-><c- f>em</c-><c- p>></c->problematic<c- p>&lt;/</c-><c- f>em</c-><c- p>></c-> annotation<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
                        <p>明示的な<a data-link-type="dfn" href="#ruby-annotation-container-box"
                                id="ref-for-ruby-annotation-container-box⑤⑤">ルビ注釈コンテナ</a>要素が必要な場合でも
                            <a data-link-type="dfn" href="#ruby-annotation-box"
                                id="ref-for-ruby-annotation-box⑨②">ルビ注釈</a>要素を合わせて使えば解決します：
                        </p>
                        <pre
                            class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->base<c- p>&lt;</c-><c- f>rtc</c-><c- p>>&lt;</c-><c- f>rt</c-><c- p>>&lt;</c-><c- f>em</c-><c- p>></c->problematic<c- p>&lt;/</c-><c- f>em</c-><c- p>></c-> annotation<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
                    </div>
                </div>
        </dl>
        <p><a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box⑤⑥">注釈コンテナ</a>で
            <a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation①⑦">字間注釈</a>でないものは
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-local-lt="interlinear" data-noexport
                id="interlinear-annotations">行間注釈</dfn>と呼ばれます。
        </p>
        <p>複数の<a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box⑤⑦">ルビ注釈コンテナ</a>が
            同じ<a class="property css" data-link-type="property" href="#propdef-ruby-position"
                id="ref-for-propdef-ruby-position⑤">ruby-position</a>を持つ場合、
            それらは基底テキストから外側に積み重なります。</p>
        <h3 class="heading settled" data-level="4.2" id="collapsed-ruby"><span class="secno">4.2. </span><span
                class="content">注釈スペースの共有：<a class="property css" data-link-type="property" href="#propdef-ruby-merge"
                    id="ref-for-propdef-ruby-merge⑥">ruby-merge</a>プロパティ</span><a class="self-link"
                href="#collapsed-ruby"></a></h3>
        <table class="def propdef" data-link-for-hint="ruby-merge">
            <tbody>
                <tr>
                    <th>名前:
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-ruby-merge">ruby-merge</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">値:</a>
                    <td class="prod">separate <a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑥">|</a> merge <span
                            id="ref-for-comb-one⑦">|</span> auto
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">初期値:</a>
                    <td>separate
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">適用対象:</a>
                    <td><a data-link-type="dfn" href="#interlinear-annotations"
                            id="ref-for-interlinear-annotations⑧">行間ルビ注釈コンテナ</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">継承:</a>
                    <td>yes
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">百分率:</a>
                    <td>n/a
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">算出値:</a>
                    <td>指定キーワード
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">正規順序:</a>
                    <td>文法順
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">アニメーション型:</a>
                    <td>算出値型による
        </table>
        <p>このプロパティは、1つのルビコンテナボックス内に複数のルビ注釈ボックスがある場合、
            各ペアを分離して表示するか、
            注釈を<dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="merged annotation | merged" data-noexport
                id="merged-annotation">マージ</dfn>してグループとして表示するか、
            または空間状況に応じて分離/合体のどちらにするかを制御します。</p>
        <p class="note" role="note"><span>注記:</span> <a data-link-type="dfn"
                href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation①⑧">字間注釈</a>は常に分離され、このプロパティは適用されません。</p>
        <p>値の意味：</p>
        <dl>
            <dt><dfn class="dfn-paneled css" data-dfn-for="ruby-merge" data-dfn-type="value" data-export
                    id="valdef-ruby-merge-separate">separate</dfn>
            <dd>
                各ルビ注釈ボックスは
                対応する<a data-link-type="dfn" href="#ruby-columns" id="ref-for-ruby-columns①⑤">カラム</a>内（基底ボックスと同じ）で表示され、
                隣接する基底と重ならないように配置されます。
                このスタイルは<a data-link-type="biblio" href="#biblio-jlreq"
                    title="Requirements for Japanese Text Layout 日本語組版処理の要件(日本語版)">[JLREQ]</a>で「モノルビ」と呼ばれます。
                <figure>
                    <img alt="対になる基底と注釈のどちらかが長い場合、そのペアだけのために基底または注釈側に余白が追加される。例：上手の注釈では、じょうの方が長いので1文字目の周囲に余白が追加され、2文字目のずは単純に基底に合わせて配置・揃えされる。"
                        height="57" src="https://www.w3.org/TR/css-ruby-1/images/ruby-mono.png" width="207">
                    <figcaption><a class="css" data-link-type="propdesc" href="#propdef-ruby-merge"
                            id="ref-for-propdef-ruby-merge⑦">ruby-merge: separate</a>（中央揃え）</figcaption>
                </figure>
                <div class="example" id="example-4b06efaa">
                    <a class="self-link" href="#example-4b06efaa"></a> 例：下記2行は同じように表示されます。
                    <pre
                        class="highlight"><c- p>&lt;</c-><c- f>p</c-><c- p>>&lt;</c-><c- f>ruby</c-><c- p>></c->無<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->む<c- p>&lt;/</c-><c- f>ruby</c-><c- p>>&lt;</c-><c- f>ruby</c-><c- p>></c->常<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->じょう<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c->
<c- p>&lt;</c-><c- f>p</c-><c- p>>&lt;</c-><c- f>ruby</c-> <c- e>style</c-><c- o>=</c-><c- s>"ruby-merge:separate"</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c->無<c- p>&lt;</c-><c- f>rb</c-><c- p>></c->常<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->む<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->じょう<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
                </div>
            <dt><dfn class="dfn-paneled css" data-dfn-for="ruby-merge" data-dfn-type="value" data-export
                    id="valdef-ruby-merge-merge">merge</dfn>
            <dd>
                同じ行・同じ<a data-link-type="dfn" href="#ruby-segments" id="ref-for-ruby-segments①⑦">ルビセグメント</a>内の全<a
                    data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑨③">ルビ注釈ボックス</a>を
                <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-box"
                    id="ref-for-inline-box①①">インラインボックス</a>として
                <a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box⑤⑧">注釈コンテナ</a>内に連結し、
                それらすべての<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑦⑤">基底ボックス</a>にまたがる
                単一の匿名<span id="ref-for-ruby-annotation-box⑨④">ルビ注釈ボックス</span>にまとめてレイアウトします。
                1行で表示される場合、このスタイルは<a data-link-type="biblio" href="#biblio-jlreq"
                    title="Requirements for Japanese Text Layout 日本語組版処理の要件(日本語版)">[JLREQ]</a>における「グループルビ」と似ています。
                ただし行をまたぐ場合は、<span id="ref-for-ruby-annotation-box⑨⑤">ルビ注釈</span>は必ず
                対応する<span id="ref-for-ruby-base-box⑦⑥">ルビ基底</span>と一緒に処理されます。
                <figure>
                    <img alt="結合された注釈は結合基底全体に対して中央揃えで配置される。例：上手の場合、1文字目の注釈のうと2文字目のずが2文字目の上に重なって表示される。" height="57"
                        src="https://www.w3.org/TR/css-ruby-1/images/ruby-merge.png" width="189">
                    <figcaption><a class="css" data-link-type="propdesc" href="#propdef-ruby-merge"
                            id="ref-for-propdef-ruby-merge⑧">ruby-merge: merge</a>（中央揃え）</figcaption>
                </figure>
                <div class="example" id="example-eeb77956">
                    <a class="self-link" href="#example-eeb77956"></a> 2行とも両文字が同じ行内に収まる場合、
                    下記2行は同じように表示されます。
                    <pre
                        class="highlight"><c- p>&lt;</c-><c- f>p</c-><c- p>>&lt;</c-><c- f>ruby</c-><c- p>></c->無常<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->むじょう<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c->
<c- p>&lt;</c-><c- f>p</c-><c- p>>&lt;</c-><c- f>ruby</c-> <c- e>style</c-><c- o>=</c-><c- s>"ruby-merge:merge"</c-><c- p>>&lt;</c-><c- f>rb</c-><c- p>></c->無<c- p>&lt;</c-><c- f>rb</c-><c- p>></c->常<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->む<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->じょう<c- p>&lt;/</c-><c- f>ruby</c-><c- p>></c-></pre>
                    <p>ただし2つの基底が行をまたぐ場合は、2例目は<a class="css" data-link-type="propdesc" href="#propdef-ruby-position"
                            id="ref-for-propdef-ruby-position⑥">ruby-position:
                            separate</a>と同じように表示されます。</p>
                </div>
            <dt><dfn class="dfn-paneled css" data-dfn-for="ruby-merge" data-dfn-type="value" data-export
                    id="valdef-ruby-merge-auto">auto</dfn>
            <dd>
                UAは任意のアルゴリズムで各ルビ注釈ボックスを対応する基底と合わせてレンダリングしてよいですが、
                すべての注釈が基底上に収まる場合は
                <a class="css" data-link-type="maybe" href="#valdef-ruby-merge-separate"
                    id="ref-for-valdef-ruby-merge-separate②">separate</a>と同じになるようにし、
                一部注釈が基底より広い場合は
                基底間スペースを挿入しない形で
                何らかの方法でスペースを共有させます。
                <figure>
                    <img alt="十分なスペースがある場合、注釈は基底ごとに揃うが、スペースが不足すると注釈同士が隣の注釈とスペースを共有する。例：上手の注釈は合体表示、下手の注釈はseparateスタイル。"
                        height="57" src="https://www.w3.org/TR/css-ruby-1/images/ruby-jukugo.png" width="189">
                    <figcaption><a class="css" data-link-type="propdesc" href="#propdef-ruby-merge"
                            id="ref-for-propdef-ruby-merge⑨">ruby-merge: auto</a>（中央揃え）</figcaption>
                </figure>
                <div class="note" role="note">
                    注記: この挙動は複合語（熟語）ルビ向けです。
                    <a href="https://www.w3.org/International/questions/qa-ruby#jukugo">“What is ruby?”のJukugo
                        Ruby</a>参照。<a data-link-type="biblio" href="#biblio-qa-ruby" title="What is ruby?">[QA-RUBY]</a>
                    <p>この種のルビの表示には様々な慣習があります。
                        <a href="https://www.w3.org/TR/simple-ruby/#placement-of-jukugo-ruby">Simple Ruby
                            PlacementのJukugo-ruby配置</a>、
                        <a
                            href="https://www.w3.org/TR/jlreq/#positioning_of_jukugoruby_with_respect_to_base_characters">JLREQの熟語ルビの配置</a>、
                        <cite>JISX4051の4.12.3(c) 熟語ルビの処理</cite> など参照。
                    </p>
                    <p>最も単純なものは、
                        すべての注釈が基底幅内に収まる場合は<a class="css" data-link-type="maybe" href="#valdef-ruby-merge-separate"
                            id="ref-for-valdef-ruby-merge-separate③">separate</a>、
                        そうでなければ<a class="css" data-link-type="maybe" href="#valdef-ruby-merge-merge"
                            id="ref-for-valdef-ruby-merge-merge②">merge</a>で表示する方法です。</p>
                </div>
        </dl>
        <p class="note" role="note"><span>注記:</span> テキストは、たとえマージされた場合でも
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑨⑥">ルビ注釈</a>や
            <a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑦⑦">基底</a>をまたいで
            字形結合やリガチャを形成しません。
            これは<a data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-4/#bidi-isolate"
                id="ref-for-bidi-isolate">bidiアイソレーション</a>によるものです。
            <a href="#bidi">§ 3.5 双方向並べ替え</a>および
            <a href="https://www.w3.org/TR/css-text-3/#boundary-shaping"><cite>CSS Text 3</cite> § 7.3
                要素境界をまたぐ字形処理</a>も参照。
        </p>
        <h3 class="heading settled" data-level="4.3" id="ruby-align-property"><span class="secno">4.3. </span><span
                class="content"><span id="rubyalign"></span> ルビテキスト分布: <a class="property css" data-link-type="property"
                    href="#propdef-ruby-align" id="ref-for-propdef-ruby-align⑧">ruby-align</a>
                プロパティ</span><a class="self-link" href="#ruby-align-property"></a></h3>
        <table class="def propdef" data-link-for-hint="ruby-align">
            <tbody>
                <tr>
                    <th>名前:
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-ruby-align">ruby-align</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">値:</a>
                    <td class="prod">start <a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑧">|</a> center
                        <span id="ref-for-comb-one⑨">|</span> space-between <span id="ref-for-comb-one①⓪">|</span>
                        space-around
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">初期値:</a>
                    <td>space-around
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">適用対象:</a>
                    <td>ルビ基底、ルビ注釈、ルビ基底コンテナ、ルビ注釈コンテナ
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">継承:</a>
                    <td>yes
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">百分率:</a>
                    <td>n/a
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">算出値:</a>
                    <td>指定キーワード
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">正規順序:</a>
                    <td>文法順
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">アニメーション型:</a>
                    <td>算出値型による
        </table>
        <p>このプロパティは、各種ルビボックスの内容がそのボックスを正確に満たさない場合に、テキストをどのように分布させるかを指定します。
            <a class="property css" data-link-type="property" href="#propdef-ruby-align"
                id="ref-for-propdef-ruby-align⑨">ruby-align</a>によって分配される空白は、字詰め（ジャスティフィケーション）による空白とは無関係かつ独立しています。
        </p>
        <p><a data-link-type="dfn" href="#ruby-position-inter-character-annotation"
                id="ref-for-ruby-position-inter-character-annotation①⑨">字間注釈</a>の場合、このプロパティはボックス自体の配置にも影響します
            （<a href="#inter-character-layout">§ 3.2 字間ルビレイアウト</a>参照）。
            それ以外の場合は、ボックス内の内容の配置のみに影響し、ボックス自体の大きさや位置には影響しません。</p>
        <p>各値の意味は以下の通りです：</p>
        <dl>
            <dt><dfn class="dfn-paneled css" data-dfn-for="ruby-align" data-dfn-type="value" data-export
                    id="valdef-ruby-align-start">start</dfn>
            <dd>
                ルビ内容がボックスの開始端に揃います。
                <div class="figure">
                    <img alt="ルビテキストが基底より短い時の左揃えルビの図" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ra-l.gif" width="145"> <img
                        alt="ルビテキストが基底より長い時の左揃えルビの図" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ra-l-rb.gif" width="145">
                    <p class="caption"><a class="css" data-link-type="maybe" href="#valdef-ruby-align-start"
                            id="ref-for-valdef-ruby-align-start①">start</a> ルビ分布</p>
                </div>
                <p class="issue" id="issue-41435749"><a class="self-link" href="#issue-41435749"></a> 「肩付きルビ」はこの
                    <a class="css" data-link-type="maybe" href="#valdef-ruby-align-start"
                        id="ref-for-valdef-ruby-align-start②">start</a>値に近いが、厳密には同じではありません。
                    特に基底をはみ出す場合の挙動は文脈によって異なることがあります。<a
                        href="https://www.w3.org/TR/jlreq/#positioning_of_monoruby_with_respect_to_base_characters">JLREQ</a>参照。
                    また、これは縦書きでのみ使われ、JLTFでも特に重要とはされていません。
                    したがって、この値を肩付きルビに合わせて高度に調整する必要はないかもしれません。
                    <span class="css" id="ref-for-valdef-ruby-align-start③">start</span>が他用途で必要なら残し、そうでなければ削除も検討？
                </p>
            <dt><dfn class="dfn-paneled css" data-dfn-for="ruby-align" data-dfn-type="value" data-export
                    id="valdef-ruby-align-center">center</dfn>
            <dd>
                ルビ内容がボックス内で中央揃えされます。
                <div class="figure">
                    <img alt="ルビテキストが基底より短い時の中央揃えルビの図" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ra-c.gif" width="145"> <img
                        alt="ルビテキストが基底より長い時の中央揃えルビの図" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ra-c-rb.gif" width="145">
                    <p class="caption"><a class="css" data-link-type="maybe" href="#valdef-ruby-align-center"
                            id="ref-for-valdef-ruby-align-center">center</a> ルビ分布</p>
                </div>
            <dt><dfn class="dfn-paneled css" data-dfn-for="ruby-align" data-dfn-type="value" data-export
                    id="valdef-ruby-align-space-between">space-between</dfn>
            <dd>
                ルビ内容は通常のテキストジャスティフィケーション（<a class="property css" data-link-type="property"
                    href="https://www.w3.org/TR/css-text-3/#propdef-text-justify"
                    id="ref-for-propdef-text-justify">text-justify</a>で定義）に従い分布しますが、
                ジャスティフィケーション機会<a data-link-type="dfn" href="https://www.w3.org/TR/css-text-3/#justification-opportunity"
                    id="ref-for-justification-opportunity">justification opportunities</a>が無い場合は中央揃えされます。
                <div class="figure">
                    <img alt="ルビテキストが基底より短い時の両端分布ルビの図" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ra-dl.gif" width="145"> <img
                        alt="ルビテキストが基底より長い時の両端分布ルビの図" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ra-dl-rb.gif" width="145">
                    <p class="caption"><a class="css" data-link-type="maybe" href="#valdef-ruby-align-space-between"
                            id="ref-for-valdef-ruby-align-space-between">space-between</a> ルビ分布</p>
                </div>
            <dt><dfn class="dfn-paneled css" data-dfn-for="ruby-align" data-dfn-type="value" data-export
                    id="valdef-ruby-align-space-around">space-around</dfn>
            <dd>
                <a class="css" data-link-type="maybe" href="#valdef-ruby-align-space-between"
                    id="ref-for-valdef-ruby-align-space-between①">space-between</a>と同様ですが、
                追加の<a data-link-type="dfn" href="https://www.w3.org/TR/css-text-3/#justification-opportunity"
                    id="ref-for-justification-opportunity①">justification opportunity</a>が存在し、
                その空白がルビ内容の前後に半分ずつ分配されます。
                <div class="figure">
                    <img alt="ルビテキストが基底より短い時のauto分布ルビの図" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ra-ds.gif" width="145"> <img
                        alt="ルビテキストが基底より長い時のauto分布ルビの図" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ra-ds-rb.gif" width="145">
                    <p class="caption"><a class="css" data-link-type="maybe" href="#valdef-ruby-align-space-around"
                            id="ref-for-valdef-ruby-align-space-around">space-around</a> ルビ分布</p>
                </div>
        </dl>
        <div class="example" id="example-e170976f">
            <a class="self-link" href="#example-e170976f"></a> <a href="#default-ua-ruby">デフォルトUAスタイルシート</a>は
            <a class="css" data-link-type="propdesc" href="https://www.w3.org/TR/css-text-3/#propdef-text-justify"
                id="ref-for-propdef-text-justify①">text-justify: ruby</a>を<a data-link-type="dfn"
                href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑨⑦">ルビ注釈</a>に適用しており、
            CJK<a data-link-type="dfn" href="https://www.w3.org/TR/css-text-3/#character"
                id="ref-for-character">文字</a>の隣接ペア間にはジャスティフィケーション機会<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-text-3/#justification-opportunity"
                id="ref-for-justification-opportunity②">justification opportunities</a>が発生しますが、
            ラテン文字や注音符号（Bopomofo）<span id="ref-for-character①">文字</span>間には発生しません。
            そのため、<a class="css" data-link-type="maybe" href="#valdef-ruby-align-space-around"
                id="ref-for-valdef-ruby-align-space-around①">space-around</a>や
            <a class="css" data-link-type="maybe" href="#valdef-ruby-align-space-between"
                id="ref-for-valdef-ruby-align-space-between②">space-between</a>
            でも、ラテン文字や注音符号は中央揃えされます：
            <div class="figure">
                <img alt="半角ルビが基底より短い時のauto分布ルビの図" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ra-c-h.gif" width="145"> <img
                    alt="半角基底より長いルビのauto分布の例" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ra-c-rb-h.gif" width="145">
                <p class="caption">非CJKルビテキストは<a class="css" data-link-type="maybe"
                        href="#valdef-ruby-align-space-around"
                        id="ref-for-valdef-ruby-align-space-around②">space-around</a>や
                    <a class="css" data-link-type="maybe" href="#valdef-ruby-align-space-between"
                        id="ref-for-valdef-ruby-align-space-between③">space-between</a>でも中央揃え
                </p>
            </div>
            <p>空白分布は<a class="property css" data-link-type="property"
                    href="https://www.w3.org/TR/css-text-3/#propdef-text-justify"
                    id="ref-for-propdef-text-justify②">text-justify</a>で制御できます。<a data-link-type="biblio"
                    href="#biblio-css-text-3" title="CSS Text Module Level 3">[CSS-TEXT-3]</a></p>
        </div>
        <p><a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑦⑧">ルビ基底</a>や
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box⑨⑧">ルビ注釈</a>内の内容は、
            <a class="css" data-link-type="propdesc" href="#propdef-ruby-merge"
                id="ref-for-propdef-ruby-merge①⓪">ruby-merge: merge</a>によるスパンを除き、
            そのボックス上の<a class="property css" data-link-type="property" href="#propdef-ruby-align"
                id="ref-for-propdef-ruby-align①⓪">ruby-align</a>の値で揃えられます。
            <a data-link-type="dfn" href="#merged-annotation" id="ref-for-merged-annotation⑤">マージ注釈</a>内の内容は、
            <a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box⑤⑨">ルビ注釈コンテナ</a>上の
            <span class="property" id="ref-for-propdef-ruby-align①①">ruby-align</span>の値によって揃えられ、
            個々の<span class="property" id="ref-for-propdef-ruby-align①②">ruby-align</span>や
            <span id="ref-for-ruby-annotation-box⑨⑨">ルビ注釈</span>上の値は無視されます。
        </p>
        <p class="issue" id="issue-70e7253c"><a class="self-link" href="#issue-70e7253c"></a> <a data-link-type="dfn"
                href="#merged-annotation" id="ref-for-merged-annotation⑥">マージ注釈</a>によって
            <a data-link-type="dfn" href="#ruby-segments" id="ref-for-ruby-segments①⑧">ルビセグメント</a>全体が広がった場合どうするか？
            現仕様ではすべての基底がスパン扱いで広がるが、例えば複数基底を持つ基底コンテナ内テキストを中央揃えしたい場合に不都合。
            代わりにruby-mergeを基底コンテナにも適用できるようにするか？
            ただしその場合、基底が複数注釈をスパンし得る（基底側がマージで注釈レベルがマージでない場合）・
            あるいは基底をマージにしたら注釈レベルすべてマージ必須……など追加仕様要検討。
        </p>
        <p><a class="property css" data-link-type="property" href="#propdef-ruby-merge"
                id="ref-for-propdef-ruby-merge①①">ruby-merge</a>が
            <a class="css" data-link-type="maybe" href="#valdef-ruby-merge-auto"
                id="ref-for-valdef-ruby-merge-auto①">auto</a>の場合の内容の揃え方はUA依存ですが、
            すべての注釈が対応基底に収まる場合は
            <span class="css" id="ref-for-propdef-ruby-merge①②">ruby-merge: separate</span>と同じでなければなりません。
        </p>
        <h3 class="heading settled" data-level="4.4" id="ruby-text-decoration"><span class="secno">4.4. </span><span
                class="content">ルビテキストの装飾</span><a class="self-link" href="#ruby-text-decoration"></a></h3>
        <p>テキスト装飾は基底テキストから注釈へは伝播しません。</p>
        <p>ルビの祖先にテキスト装飾が指定された場合、
            ルビ基底コンテナ全体の内容領域に装飾が描画されます。
            これには、長い注釈のために基底内容の両端に追加されたスペースも含まれます。
            ルビ基底自身に装飾が指定された場合、
            この追加スペースは装飾されません。これはボックス自体のpaddingが装飾対象外になるのと同様です。
            <a data-link-type="biblio" href="#biblio-css3-text-decor"
                title="CSS Text Decoration Module Level 3">[CSS3-TEXT-DECOR]</a>
        </p>
        <p>テキスト装飾はルビ基底コンテナやルビ注釈コンテナに直接指定することもできます。
            その場合はコンテナ内のすべての基底または注釈に伝播し、またその間も装飾を連続して描画します。</p>
        <p>ルビ注釈の位置は、基底テキストにオーバーラインやアンダーライン装飾が適用された際の衝突を回避するために
            調整される場合があります。
            フォントサイズやベースライン配置が一貫している基本的な場合は、
            アンダーラインやオーバーラインは
            <a data-link-type="dfn" href="#base-level" id="ref-for-base-level⑤">基底レベル</a>とその側の注釈の間に配置されます。
        </p>
        <p class="issue" id="issue-c8497783"><a class="self-link" href="#issue-c8497783"></a> 隣接する基底／注釈内容間での装飾描画
            について要明確化。ボックスがカラム幅いっぱいか否かで変わる。</p>
        <h2 class="heading settled" data-level="5" id="edge-effects"><span class="secno">5. </span><span
                class="content">エッジ効果</span><a class="self-link" href="#edge-effects"></a></h2>
        <h3 class="heading settled" data-level="5.1" id="ruby-overhang"><span class="secno">5.1. </span><span
                class="content">ルビのはみ出し: <a class="property css" data-link-type="property" href="#propdef-ruby-overhang"
                    id="ref-for-propdef-ruby-overhang">ruby-overhang</a>プロパティ</span><a class="self-link"
                href="#ruby-overhang"></a></h3>
        <table class="def propdef" data-link-for-hint="ruby-overhang">
            <tbody>
                <tr>
                    <th>名前:
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-ruby-overhang">ruby-overhang</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">値:</a>
                    <td class="prod">auto <a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①①">|</a> none
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">初期値:</a>
                    <td>auto
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">適用対象:</a>
                    <td>ルビ注釈コンテナ
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">継承:</a>
                    <td>yes
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">百分率:</a>
                    <td>n/a
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">算出値:</a>
                    <td>指定キーワード
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">正規順序:</a>
                    <td>文法順
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">アニメーション型:</a>
                    <td>算出値型による
        </table>
        <p><a class="property css" data-link-type="property" href="#propdef-ruby-overhang"
                id="ref-for-propdef-ruby-overhang①">ruby-overhang</a>プロパティは
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box①⓪⓪">ルビ注釈</a>が
            <a data-link-type="dfn" href="#ruby-container"
                id="ref-for-ruby-container④⓪">ルビコンテナ</a>の外側の隣接テキストにはみ出して重なることを許可するかどうかを制御します。
            各値の意味は以下の通りです：
        </p>
        <dl>
            <dt><dfn class="css" data-dfn-for="ruby-overhang" data-dfn-type="value" data-export
                    id="valdef-ruby-overhang-auto">auto<a class="self-link" href="#valdef-ruby-overhang-auto"></a></dfn>
            <dd>
                <a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box⑥①">ルビ注釈コンテナ</a>が対応する<a data-link-type="dfn"
                    href="#ruby-base-container-box" id="ref-for-ruby-base-container-box③⑦">ルビ基底コンテナ</a>より長い場合、
                <span id="ref-for-ruby-annotation-container-box⑥②">ルビ注釈コンテナ</span>は隣接ボックスにはみ出して重なることができます。
                <p>どの程度・どんな条件ではみ出すかはUAが決定します。</p>
            <dt><dfn class="css" data-dfn-for="ruby-overhang" data-dfn-type="value" data-export
                    id="valdef-ruby-overhang-none">none<a class="self-link" href="#valdef-ruby-overhang-none"></a></dfn>
            <dd> <a data-link-type="dfn" href="#ruby-annotation-container-box"
                    id="ref-for-ruby-annotation-container-box⑥③">ルビ注釈コンテナ</a>は絶対にはみ出してはなりません。
        </dl>
        <p><a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box①⓪①">ルビ注釈</a>がはみ出し不可の場合、
            <a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container④①">ルビコンテナ</a>は
            従来のインラインボックスのように振る舞い、
            つまり自分自身の内容のみが境界内に描画され、隣接要素はボックス境界をまたぎません：
        </p>
        <div class="figure">
            <img alt="ルビボックスが隣接テキストと相互作用する図" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ro-n.gif" width="220">
            <p class="caption">隣接テキストにはみ出し不可のシンプルなルビ</p>
        </div>
        <p>一方、<a data-link-type="dfn" href="#ruby-annotation-container-box"
                id="ref-for-ruby-annotation-container-box⑥⑤">ルビ注釈コンテナ</a>がはみ出し可の場合、
            隣接内容は<a data-link-type="dfn" href="#ruby-container" id="ref-for-ruby-container④②">ルビコンテナボックス</a>と重なり、
            <a data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box①⓪②">ルビ注釈</a>が
            周囲のインラインレベル内容に部分的に重なることも許されます。
            はみ出しは、隣接内容と
            ルビコンテナの<span id="ref-for-ruby-annotation-box①⓪③">注釈ボックス</span>や
            重なった<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑦⑨">基底</a>内容との衝突を
            起こさない範囲に限られます。
        </p>
        <div class="figure">
            <img alt="ルビボックスが隣接テキストと相互作用する図" height="91" src="https://www.w3.org/TR/css-ruby-1/images/ro-a.gif" width="177">
            <p class="caption">隣接テキストにはみ出し可のシンプルなルビ</p>
        </div>
        <p class="note" role="note"><span>注記:</span> ある<a data-link-type="dfn" href="#ruby-base-box"
                id="ref-for-ruby-base-box⑧⓪">ルビ基底</a>に関する<a data-link-type="dfn" href="#ruby-annotation-box"
                id="ref-for-ruby-annotation-box①⓪④">ルビ注釈</a>が別の<span id="ref-for-ruby-base-box⑧①">ルビ基底</span>をはみ出してよいかは
            <a class="property css" data-link-type="property" href="#propdef-ruby-merge"
                id="ref-for-propdef-ruby-merge①③">ruby-merge</a>で制御されます。
        </p>
        <p>通常、基底や注釈の内容自体の揃え方は、はみ出しの許可有無に影響されません。
            揃えや空白分布（<a class="property css" data-link-type="property" href="#propdef-ruby-align"
                id="ref-for-propdef-ruby-align①③">ruby-align</a>参照）は
            はみ出し許可と無関係に同じ方法で行われ、
            はみ出し可能スペースの計算前に決定されます。
            ただし、UAは空白分布や揃え決定時に許容されるはみ出しを考慮しても構いません。</p>
        <p class="issue" id="issue-adc9f0e4"><a class="self-link" href="#issue-adc9f0e4"></a> はみ出しと揃えの相互作用については
            場合によってはさらなる検討が必要かもしれません。</p>
        <div class="example" id="example-a7292220"><a class="self-link" href="#example-a7292220"></a> UAは
            <a data-link-type="biblio" href="#biblio-jis4051"
                title="Formatting rules for Japanese documents (『日本語文書の組版方法』).">[JIS4051]</a>の
            注釈フォントの全角0.5字（<a href="https://www.w3.org/TR/css-values-4/#ic"><span class="css">0.5ic</span></a>）
            をはみ出し最大長とする推奨に従ってもよいです。
            日本語でルビテキストが隣接文字にはみ出す詳細仕様は<a data-link-type="biblio" href="#biblio-jlreq"
                title="Requirements for Japanese Text Layout 日本語組版処理の要件(日本語版)">[JLREQ]</a>参照。
        </div>
        <h3 class="heading settled" data-level="5.2" id="line-edge"><span class="secno">5.2. </span><span
                class="content">行端揃え</span><a class="self-link" href="#line-edge"></a></h3>
        <p>行頭や行末に、<a data-link-type="dfn" href="#ruby-base-box" id="ref-for-ruby-base-box⑧②">ルビ基底</a>より長い<a
                data-link-type="dfn" href="#ruby-annotation-box" id="ref-for-ruby-annotation-box①⓪⑤">ルビ注釈ボックス</a>がある場合、
            UAはその<span id="ref-for-ruby-annotation-box①⓪⑥">ルビ注釈</span>の端を
            基底の対応端に強制的に揃えても<em>よい</em>です。
            この種の揃えは<a data-link-type="biblio" href="#biblio-jlreq"
                title="Requirements for Japanese Text Layout 日本語組版処理の要件(日本語版)">[JLREQ]</a>で説明されています。</p>
        <p>本仕様レベルではこの挙動を制御する仕組みは提供しません。</p>
        <div class="figure">
            <img alt="ルビテキストが基底より短い時の行端揃えルビの図" height="109" src="https://www.w3.org/TR/css-ruby-1/images/ra-le-l.gif" width="146"> <img
                alt="ルビテキストが基底より長い時の行端揃えルビの図" height="110" src="https://www.w3.org/TR/css-ruby-1/images/ra-le-r.gif" width="146">
            <p class="caption">行端揃え</p>
        </div>
        <h2 class="no-num heading settled" id="default-stylesheet"><span class="content"> 付録A: サンプルスタイルシート</span><a
                class="self-link" href="#default-stylesheet"></a></h2>
        <p><em>このセクションは参考情報です。</em></p>
        <h3 class="no-num heading settled" id="default-ua-ruby"><span class="content"> <span class="secno">A.1</span>
                デフォルトUAスタイルシート</span><a class="self-link" href="#default-ua-ruby"></a></h3>
        <p>以下はHTMLおよびXHTMLルビマークアップをルビレイアウトとして描画するための、デフォルトUAスタイルシートの例です：</p>
        <pre class="highlight">ruby <c- p>{</c-> <c- k>display</c-><c- p>:</c-> ruby<c- p>;</c-> <c- p>}</c->
rp   <c- p>{</c-> <c- k>display</c-><c- p>:</c-> none<c- p>;</c-> <c- p>}</c->
rbc  <c- p>{</c-> <c- k>display</c-><c- p>:</c-> ruby-base-container<c- p>;</c-> <c- p>}</c->
rtc  <c- p>{</c-> <c- k>display</c-><c- p>:</c-> ruby-text-container<c- p>;</c-> <c- p>}</c->
rb   <c- p>{</c-> <c- k>display</c-><c- p>:</c-> ruby-base<c- p>;</c-> <c- k>white-space</c-><c- p>:</c-> nowrap<c- p>;</c-> <c- p>}</c->
rt   <c- p>{</c-> <c- k>display</c-><c- p>:</c-> ruby-text<c- p>;</c-> <c- p>}</c->
ruby<c- p>,</c-> rb<c- p>,</c-> rt<c- p>,</c-> rbc<c- p>,</c-> rtc <c- p>{</c-> <c- k>unicode-bidi</c-><c- p>:</c-> isolate<c- p>;</c-> <c- p>}</c->

rtc<c- p>,</c-> rt <c- p>{</c->
  <c- k>font-variant-east-asian</c-><c- p>:</c-> ruby<c- p>;</c->  <c- c>/* See [[CSS-FONTS-3]] */</c->
  text-justify: ruby<c- p>;</c->             <c- c>/* See [[CSS-TEXT-4]] */</c->
  text-emphasis: none<c- p>;</c->            <c- c>/* See [[CSS-TEXT-DECOR-3]] */</c->
  white-space: nowrap<c- p>;</c->
  <c- k>line-height</c-><c- p>:</c-> <c- m>1</c-><c- p>;</c-> <c- p>}</c->

rtc<c- p>,</c-> <c- nf>:not</c-><c- p>(</c->rtc<c- p>)</c-> > rt <c- p>{</c->
  <c- k>font-size</c-><c- p>:</c-> <c- m>50</c-><c- k>%</c-><c- p>;</c-> <c- p>}</c->
rtc<c- nf>:lang</c-><c- p>(</c->zh-TW<c- p>),</c-> <c- nf>:not</c-><c- p>(</c->rtc<c- p>)</c-> > rt<c- nf>:lang</c-><c- p>(</c->zh-TW<c- p>),</c->
rtc<c- nf>:lang</c-><c- p>(</c->zh-Hanb<c- p>),</c-> <c- nf>:not</c-><c- p>(</c->rtc<c- p>)</c-> > rt<c- nf>:lang</c-><c- p>(</c->zh-Hanb<c- p>),</c-> <c- p>{</c->
  <c- k>font-size</c-><c- p>:</c-> <c- m>30</c-><c- k>%</c-><c- p>;</c-> <c- p>}</c->               <c- c>/* bopomofo */</c->
</pre>
        <p class="note" role="note"><span>注記:</span> 著者は上記のルールを使用しないでください。
            ルビレイアウトをサポートするUAはこのスタイルをデフォルトで提供すべきです。</p>
        <p>ユーザー制御の「最小フォントサイズ」機能を実装するUAは、ルビ注釈に対してはその最小値を縮小して適用することを検討してください。</p>
        <h3 class="no-num heading settled" id="default-inline"><span class="content"> <span class="secno">A.2</span>
                ルビ注釈のインライン化</span><a class="self-link" href="#default-inline"></a></h3>
        <p>以下はHTMLおよびXHTMLルビマークアップをインライン注釈として描画するためのサンプルスタイルシートです：</p>
        <pre
            class="highlight">ruby<c- p>,</c-> rb<c- p>,</c-> rt<c- p>,</c-> rbc<c- p>,</c-> rtc<c- p>,</c-> rp <c- p>{</c->
  <c- k>display</c-><c- p>:</c-> inline<c- p>;</c-> <c- k>white-space</c-><c- p>:</c-> inherit<c- p>;</c->
  <c- k>font</c-><c- p>:</c-> inherit<c- p>;</c-> <c- k>text-emphasis</c-><c- p>:</c-> inherit<c- p>;</c-> <c- p>}</c-></pre>
        <h3 class="no-num heading settled" id="default-parens"><span class="content"> <span class="secno">A.3</span>
                括弧の自動生成</span><a class="self-link" href="#default-parens"></a></h3>
        <p>残念ながら、セレクタはテキストノードにマッチできないため、
            CSSだけではHTML内の全てのルビマークアップパターンに対し
            未括弧化ルビ注釈へ自動的かつ正確に括弧を追加することはできません。
            （これはHTMLルビが、対応要素なしで生テキストから<a data-link-type="dfn" href="#ruby-base-box"
                id="ref-for-ruby-base-box⑧③">ルビ基底</a>を暗黙的に扱えるためです。）</p>
        <p>しかし、<code>&lt;rb></code>や<code>&lt;rtc></code>が厳格に使われている場合は、以下のルールで
            各注釈シーケンスの前後に括弧を追加できます：</p>
        <pre class="highlight"><c- c>/* &lt;rtc> の前後に括弧 */</c->
rtc::before <c- p>{</c-> <c- k>content</c-><c- p>:</c-> <c- s>"（"</c-><c- p>;</c-> <c- p>}</c->
rtc::after  <c- p>{</c-> <c- k>content</c-><c- p>:</c-> <c- s>"）"</c-><c- p>;</c-> <c- p>}</c->

<c- c>/* &lt;rtc>でない最初の&lt;rt>の前に括弧 */</c->
rb  + rt::before<c- p>,</c->
rtc + rt::before <c- p>{</c-> <c- k>content</c-><c- p>:</c-> <c- s>"（"</c-><c- p>;</c-> <c- p>}</c->

<c- c>/* &lt;rtc>でない&lt;rt>の後ろに括弧 */</c->
rb ~ rt:last-child::after<c- p>,</c->
rt + rb::before  <c- p>{</c-> <c- k>content</c-><c- p>:</c-> <c- s>"）"</c-><c- p>;</c-> <c- p>}</c->
rt + rtc::before <c- p>{</c-> <c- k>content</c-><c- p>:</c-> <c- s>"）（"</c-><c- p>;</c-> <c- p>}</c-></pre>
        <p>また、完全に交互型（adjacentなルビ注釈がない）
            <code
                class="highlight"><c- p>&lt;</c-><c- f>ruby</c-><c- p>></c->A<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->a<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->B<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->b<c- p>&lt;/</c-><c- f>rt</c-><c- p>></c->C<c- p>&lt;</c-><c- f>rt</c-><c- p>></c->c<c- p>&lt;/</c-><c- f>rt</c-><c- p>>&lt;</c-><c- f>ruby</c-><c- p>></c-></code>
            であることが分かっている場合、下記ルールで各注釈の前後に括弧が付与されます：
        </p>
        <pre class="highlight"><c- c>/* 各&lt;rt>の前後に括弧 */</c->
rt::before <c- p>{</c-> <c- k>content</c-><c- p>:</c-> <c- s>"（"</c-><c- p>;</c-> <c- p>}</c->
rt::after  <c- p>{</c-> <c- k>content</c-><c- p>:</c-> <c- s>"）"</c-><c- p>;</c-> <c- p>}</c->
</pre>
        <h2 class="heading settled" data-level="6" id="glossary"><span class="secno">6. </span><span class="content">
                用語集</span><a class="self-link" href="#glossary"></a></h2>
        <dl>
            <dt id="g-bopomofo"><a class="self-link" href="#g-bopomofo"></a><dfn data-dfn-type="dfn" data-noexport
                    id="bopomofo">ボポモフォ<a class="self-link" href="#bopomofo"></a></dfn> または <dfn data-dfn-type="dfn"
                    data-noexport id="zhuyin-fuhao">注音符号<a class="self-link" href="#zhuyin-fuhao"></a></dfn>
                （中国語: <span lang="zh-Bopo">ㄅㄆㄇㄈ</span>, <span lang="zh-Hant">注音符號</span>, <span
                    lang="zh-Hans">注音符号</span>）
            <dd>
                <p>主に標準中国語（普通話）の発音記号として使われるために開発された文字および声調記号。
                    これらはルビ注釈（振り仮名）として用いられることが多いですが、必ずしもそれだけではありません。</p>
                <div class="figure">
                    <img alt="ボポモフォ文字（青色）が横書きテキストの各漢字の右側に縦に並んでいる。" height="132" src="https://www.w3.org/TR/css-ruby-1/images/zhuyin-example.png"
                        width="349">
                    <p class="caption">中国語で音声補助の字間注釈として使われるボポモフォの例</p>
                </div>
                <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                        id="bopomofo-tone-marks">ボポモフォ声調記号</dfn>は、各ボポモフォ音節の末尾（メモリ上）に現れるスペース文字です。
                    通常は他のボポモフォ文字の右側や上側の別軌道に表示され、記号の位置は音節内の文字数によって異なります。
                    ただし、軽声記号（ニュートラルトーン）は、右側や上側ではなく、ボポモフォの前（同じ行）に配置されます。</p>
                <p class="note" role="note"><span>注記:</span> テキスト表示時の字形の相対配置や位置決め（<a data-link-type="dfn"
                        href="#bopomofo-tone-marks"
                        id="ref-for-bopomofo-tone-marks">ボポモフォ声調記号</a>含む）はユーザーエージェントやフォントシステムの責任であり、ルビ注釈や通常のインライン内容であってもCSSルビレイアウトの役割ではありません。
                </p>
                <p>ボポモフォ<a data-link-type="dfn" href="https://www.w3.org/TR/css-syntax-3/#letter"
                        id="ref-for-letter">文字</a>は <code>Bopomofo</code> <a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-text-3/#unicode-script" id="ref-for-unicode-script">Unicode
                        スクリプト</a>（U+3100–312F, U+31A0–31BFブロック）に属します。
                    <a data-link-type="dfn" href="#bopomofo-tone-marks" id="ref-for-bopomofo-tone-marks①">ボポモフォ声調記号</a>は
                    U+02C9 (ˉ), U+02CA (ˊ), U+02C7 (ˇ), U+02CB (ˋ), U+02EA (˪), U+02EB (˫), U+02D9 (˙) です。
                    これらはCSS上「<dfn data-dfn-type="dfn" data-export id="bopomofo-characters">ボポモフォ文字<a class="self-link"
                            href="#bopomofo-characters"></a></dfn>」として扱います。
                </p>
            <dt id="g-hanja"><a class="self-link" href="#g-hanja"></a>漢字（ハンジャ、韓国語: <span lang="ko">漢字</span>）
            <dd> 中国文字体系から借用・改変された表意文字を用いる韓国語表記体系の一部。
                <a href="#g-kanji">漢字（かんじ）</a>も参照。
            <dt id="g-hiragana"><a class="self-link" href="#g-hiragana"></a>ひらがな（日本語: <span lang="ja">平仮名</span>）
            <dd> 日本語の音節文字またはその一文字。
                丸みを帯びた書体が特徴。
                日本語表記体系の一部であり、
                漢字やカタカナとともに使われる。
                近年では、主に漢字が使えない・ふさわしくない場合の日本語単語や語尾・助詞の表記に用いられる。
                <a href="#g-katakana">カタカナ</a>も参照。
            <dt id="g-ideogram"><a class="self-link" href="#g-ideogram"></a>表意文字
            <dd> アルファベットや音節文字とは異なり、意味・語・語要素を表すための文字。
                最も有名な表意文字体系は東アジア（中国・日本・韓国など）で用いられている。
            <dt id="g-kana"><a class="self-link" href="#g-kana"></a>かな（日本語: <span lang="ja">仮名</span>）
            <dd> ひらがなとカタカナをまとめて指す総称。
            <dt id="g-kanji"><a class="self-link" href="#g-kanji"></a>漢字（日本語: <span lang="ja">漢字</span>）
            <dd> 日本語で使われる表意文字を指す日本語の用語。
                日本語表記体系の一部であり、
                ひらがな・カタカナとともに使われる。
                <a href="#g-hanja">ハンジャ（韓国漢字）</a>も参照。
            <dt id="g-katakana"><a class="self-link" href="#g-katakana"></a>カタカナ（日本語: <span lang="ja">片仮名</span>）
            <dd> 日本語の音節文字またはその一文字。
                角ばった書体が特徴。
                日本語表記体系の一部であり、
                漢字やひらがなとともに使われる。
                近年では主に外来語の表記に用いられる。
                <a href="#g-hiragana">ひらがな</a>も参照。
        </dl>
        <h2 class="no-num heading settled" id="acknowledgments"><span class="content"> 謝辞</span><a class="self-link"
                href="#acknowledgments"></a></h2>
        <p>この仕様の作成には、以下の方々のご協力が不可欠でした：</p>
        <p>David Baron、
            Robin Berjon、
            Susanna Bowen、
            Stephen Deach、
            Martin Dürst、
            Hideki Hiura (<span lang="ja">樋浦 秀樹</span>)、
            Masayasu Ishikawa (<span lang="ja">石川雅康</span>)、
            Taichi Kawabata、
            Chris Pratley、
            Xidorn Quan、
            Takao Suzuki (<span lang="ja">鈴木 孝雄</span>)、
            Frank Yung-Fong Tang、
            Chris Thrasher、
            Masafumi Yabe (<span lang="ja">家辺勝文</span>)、
            Boris Zbarsky、
            Steve Zilles。</p>
        <p>特に、以前の編集者である
            Michel Suignard氏、Marcin Sawicki氏（Microsoft）、
            Richard Ishida氏（W3C）に感謝します。</p>
        <h2 class="no-num heading settled" id="changes"><span class="content"> 変更点</span><a class="self-link"
                href="#changes"></a></h2>
        <p>本節は過去の公開以降の変更点を記録しています。</p>
        <h3 class="heading settled" id="changes-20211202"><span class="content"> 2021年12月2日WD以降の変更点</span><a
                class="self-link" href="#changes-20211202"></a></h3>
        <ul>
            <li><a class="property css" data-link-type="property"
                    href="https://www.w3.org/TR/css-writing-modes-4/#propdef-writing-mode"
                    id="ref-for-propdef-writing-mode⑦">writing-mode</a> の算出値調整を <a data-link-type="dfn"
                    href="#ruby-position-inter-character-annotation"
                    id="ref-for-ruby-position-inter-character-annotation②⓪">字間注釈</a>に対して
                <a data-link-type="dfn" href="#ruby-annotation-box"
                    id="ref-for-ruby-annotation-box①⓪⑦">ルビ注釈ボックス</a>に適用するよう変更。
            <li><code>zh-Hant</code> をHTMLで<a class="css" data-link-type="propdesc"
                    href="https://www.w3.org/TR/css-fonts-5/#descdef-font-face-font-size"
                    id="ref-for-descdef-font-face-font-size">font-size: 30%</a>を適用する条件に追加。
            <li>UAデフォルトスタイルシートに <code>text-justify: ruby</code> を追加。
                (<a href="https://github.com/w3c/csswg-drafts/issues/771">Issue 771</a> <a
                    href="https://github.com/w3c/csswg-drafts/issues/779">Issue 779</a>)
        </ul>
        <h3 class="heading settled" id="changes-20200429"><span class="content"> 2020年4月29日WD以降の変更点</span><a
                class="self-link" href="#changes-20200429"></a></h3>
        <ul>
            <li><a class="css" data-link-type="maybe" href="#valdef-ruby-position-alternate"
                    id="ref-for-valdef-ruby-position-alternate④">alternate</a> キーワードを <a class="property css"
                    data-link-type="property" href="#propdef-ruby-position"
                    id="ref-for-propdef-ruby-position⑦">ruby-position</a> に追加し、<a data-link-type="dfn"
                    href="https://www.w3.org/TR/css-cascade-5/#initial-value" id="ref-for-initial-value">初期値</a>とした。
            <li><a class="property css" data-link-type="property" href="#propdef-ruby-merge"
                    id="ref-for-propdef-ruby-merge①④">ruby-merge</a> の値 <span class="css">collapse</span> を
                <a class="css" data-link-type="maybe" href="#valdef-ruby-merge-merge"
                    id="ref-for-valdef-ruby-merge-merge③">merge</a> に名称変更。
                (<a href="https://github.com/w3c/csswg-drafts/issues/5004">Issue 5004</a>)
            <li><a class="css" data-link-type="propdesc" href="https://www.w3.org/TR/css-display-3/#propdef-visibility"
                    id="ref-for-propdef-visibility⑧">visibility: collapse</a> を、<a data-link-type="dfn"
                    href="#hidden-annotation" id="ref-for-hidden-annotation⑨">注釈の非表示</a>（<a data-link-type="dfn"
                    href="#auto-hidden" id="ref-for-auto-hidden②">自動非表示</a>）と
                同様に明示的に隠すものとして定義。
                (<a href="https://github.com/w3c/csswg-drafts/issues/5927">Issue 5927</a>)
            <li>各ルビdisplay型に適用されるプロパティをより明確に規定し、
                ルビ・ルビ基底・ルビ注釈ボックスが他に規定がない限り通常の<a data-link-type="dfn"
                    href="https://www.w3.org/TR/css-display-3/#inline-box" id="ref-for-inline-box①②">インラインボックス</a>と
                同様に振る舞うことを定義。
                (<a href="https://github.com/w3c/csswg-drafts/issues/4935">Issue 4935</a>, <a
                    href="https://github.com/w3c/csswg-drafts/issues/4936">Issue 4936</a>, <a
                    href="https://github.com/w3c/csswg-drafts/issues/4976">Issue 4976</a>, <a
                    href="https://github.com/w3c/csswg-drafts/issues/4979">Issue 4979</a>)
            <li><a href="#ruby-layout">§ 3 ルビのレイアウト</a>を大幅に刷新し、
                <a data-link-type="dfn" href="#interlinear-annotations"
                    id="ref-for-interlinear-annotations⑨">行間注釈</a>と<a data-link-type="dfn"
                    href="#ruby-position-inter-character-annotation"
                    id="ref-for-ruby-position-inter-character-annotation②①">字間注釈</a>の定義と
                <a class="property css" data-link-type="property" href="#propdef-ruby-align"
                    id="ref-for-propdef-ruby-align①④">ruby-align</a>との関係をより明確にした。
                字間ルビは<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-block"
                    id="ref-for-inline-block①">インラインブロック</a>レイアウトをベースとし、
                行間ルビとの相互作用も明確化。
                行間ルビのインライン軸空間分布も
                スパン注釈に関してより厳密に定義（グリッドのmax-contentトラックモデルを参考）。
            <li>入れ子ルビの扱いを、ブロック軸サイズ決定時に子孫基底・注釈コンテナも考慮するようにして明確化。
                (<a href="https://github.com/w3c/csswg-drafts/issues/4986">Issue 4986</a>, <a
                    href="https://github.com/w3c/csswg-drafts/issues/4980">Issue 4980</a>)
            <li><a class="property css" data-link-type="property" href="#propdef-ruby-align"
                    id="ref-for-propdef-ruby-align①⑤">ruby-align</a>の動作をより厳密に定義。
            <li>ルビのはみ出しが内容の整列に影響しないことを緩和し、隣接内容との衝突を防ぐ要件を追加。
            <li>双方向並べ替えと<a data-link-type="dfn" href="#merged-annotation"
                    id="ref-for-merged-annotation⑦">マージ注釈</a>の関係を明確化。
                (<a href="#bidi">§ 3.5 双方向並べ替え</a>)
            <li>全体的に規範的な記述を強化。
            <li><a href="#intro">はじめに</a>や例などの情報的テキストを改善。
        </ul>
        <p class="note" role="note"><span>注記:</span> 多数の未解決の課題が残っています。<a
                href="https://drafts.csswg.org/css-ruby-1/issues-wd-2020">Disposition of Comments</a> および
            <a href="https://github.com/w3c/csswg-drafts/issues?q=is%3Aissue+label%3Acss-ruby-1">GitHub上の新しい課題</a>を参照。
        </p>
        <h3 class="heading settled" id="changes-20140805"><span class="content"> 2014年8月5日WD以降の変更点</span><a
                class="self-link" href="#changes-20140805"></a></h3>
        <ul>
            <li><a class="css" data-link-type="propdesc" href="#propdef-ruby-overhang"
                    id="ref-for-propdef-ruby-overhang②">ruby-overhang: auto | none</a> を復活し、基本的なはみ出し制御を追加。
            <li><a href="https://www.w3.org/TR/css-display-3/">CSS Display Module</a> に合わせてinlinificationを調整。
            <li>ルビや強調符がアンダーライン・オーバーラインと衝突する場合、UAによるシフトを許可。
            <li><a class="property css" data-link-type="property" href="#propdef-ruby-merge"
                    id="ref-for-propdef-ruby-merge①⑤">ruby-merge</a> の算出値が
                <code>collapse</code>のとき自動非表示を無効化。
            <li><a href="#default-stylesheet">デフォルトスタイルシート</a>を微調整。
            <li><a href="#ruby-text-decoration">テキスト装飾との相互作用</a>の定義セクションを追加。
            <li><a class="property css" data-link-type="property" href="#propdef-ruby-position"
                    id="ref-for-propdef-ruby-position⑧">ruby-position</a> の <span class="css">right</span> と <span
                    class="css">left</span>値は次レベルに持ち越し。
            <li>ルビ<a data-link-type="dfn" href="#pairing" id="ref-for-pairing⑦">ペアリング</a>規則を
                匿名注釈（<code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/obsolete.html#rtc" id="ref-for-rtc">rtc</a></code>直下の内容）にのみ適用するよう変更。
            <li>過剰な基底／注釈は自動生成の空匿名基底／注釈とペアリング。
            <li> <a class="property css" data-link-type="property" href="#propdef-ruby-position"
                    id="ref-for-propdef-ruby-position⑨">ruby-position</a> を <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-line"
                    id="ref-for-selectordef-first-line②">::first-line</a> に適用。
                (<a href="https://github.com/w3c/csswg-drafts/issues/2998">Issue 2998</a>)
            <li>ルビボックスの包含ブロックが、他のインラインボックス同様、最も近いブロックコンテナとなることを明確化。
            <li>誤った親を持つ内部テーブル要素の扱いを明確化。
            <li>ルビコンテナ、基底コンテナ、注釈コンテナの先頭・末尾空白をトリムし、ペアリング妨害を防止。
            <li>空の基底・注釈コンテナのレイアウト効果を定義。
            <li>ルビ基底コンテナ・ルビ注釈コンテナ（ルビ基底やルビ注釈ではなく）へのmargin/padding/borderの無効化を明確化。
        </ul>
        <h3 class="heading settled" id="changes-20130919"><span class="content"> 2013年9月19日WD以降の変更点</span><a
                class="self-link" href="#changes-20130919"></a></h3>
        <ul>
            <li> 匿名ボックス生成規則および空白処理規則を全面的に書き直し、
                匿名空白ボックスの<a data-link-type="dfn" href="#pairing" id="ref-for-pairing⑧">ペアリング</a>を明確化。
            <li> 入れ子ルビの扱いを<a data-link-type="dfn" href="#pairing" id="ref-for-pairing⑨">ペアリング</a>から独立させた。
                （今後はサイズ・レイアウトで扱う予定。）
            <li> ルビ構造の双方向（Bidi）レイアウトを定義。
        </ul>
        <h3 class="heading settled" id="changes-20110630"><span class="content"> 2011年6月30日WD以降の変更点</span><a
                class="self-link" href="#changes-20110630"></a></h3>
        <dl>
            <dt><code>ruby-span</code>および<code>rbspan</code>への言及を削除。
            <dd> HTMLルビでは明示的スパンではなく暗黙的スパンを採用。
                これにより、複雑な両側スパンの病的ケースは扱えませんが、現時点で要件はありません。
                （XHTML複雑ルビをフルサポートする実装では、テーブルのセルスパンと同様
                マークアップからスパンを暗黙的に推定可能です。
                この制御をLevel 1で入れる必要はなさそうです。）
            <dt><code>ruby-overhang</code>と<code>ruby-align: line-end</code>はLevel 2に持ち越し。
            <dd> 複雑で高度な機能のため。UA定義挙動とし、許容例を示す形とする提案。
            <dt><code>display: rp</code>リクエストへの対応: <code>display: none</code>を使用。
            <dd> Internationalization WGで
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-rp-element" id="ref-for-the-rp-element">rp</a></code>
                要素のdisplay値リクエストがあったが、ルビ表示時に非表示にするには<code>display: none</code>で十分。
            <dt><a class="property css" data-link-type="property" href="#propdef-ruby-position"
                    id="ref-for-propdef-ruby-position①⓪">ruby-position</a>値を
                <a class="property css" data-link-type="property"
                    href="https://www.w3.org/TR/css-text-decor-3/#propdef-text-emphasis-position"
                    id="ref-for-propdef-text-emphasis-position">text-emphasis-position</a>に合わせた。
            <dd> ただし<a class="css" data-link-type="maybe" href="#valdef-ruby-position-inter-character"
                    id="ref-for-valdef-ruby-position-inter-character③">inter-character</a>は維持。
                ルビ位置をtext-emphasis-positionと揃える方が
                横書き・縦書きの組み合わせに柔軟に対応できる。
            <dt><a class="property css" data-link-type="property" href="#propdef-ruby-align"
                    id="ref-for-propdef-ruby-align①⑥">ruby-align</a>の未使用値を削除。
            <dd> <span class="css">left</span>、<span class="css">right</span>、<span class="css">end</span>は不要。
            <dt> <a class="css">auto</a>、<a class="css">distribute-letter</a>、<a class="css">distribute-space</a> を
                <a class="property css" data-link-type="property" href="#propdef-ruby-align"
                    id="ref-for-propdef-ruby-align①⑦">ruby-align</a>から削除し、
                <a class="css" data-link-type="maybe" href="#valdef-ruby-align-space-between"
                    id="ref-for-valdef-ruby-align-space-between④">space-between</a> と
                <a class="css" data-link-type="maybe" href="#valdef-ruby-align-space-around"
                    id="ref-for-valdef-ruby-align-space-around③">space-around</a> で統一。
            <dd> <span class="css">auto</span>は内容調査型だったが、
                <a class="css" data-link-type="maybe" href="#valdef-ruby-align-space-around"
                    id="ref-for-valdef-ruby-align-space-around④">space-around</a> と
                標準ジャスティフィケーション規則だけで十分。
                distribute-letter/distribute-spaceは
                <a class="css" data-link-type="maybe" href="#valdef-ruby-align-space-between"
                    id="ref-for-valdef-ruby-align-space-between⑤">space-between</a>、
                <span class="css" id="ref-for-valdef-ruby-align-space-around⑤">space-around</span>とした方が
                <a data-link-type="biblio" href="#biblio-css-flexbox-1"
                    title="CSS Flexible Box Layout Module Level 1">[CSS-FLEXBOX-1]</a>、
                <a data-link-type="biblio" href="#biblio-css-align-3"
                    title="CSS Box Alignment Module Level 3">[CSS-ALIGN-3]</a>等の分布キーワードと一貫し、
                <code>text-justify: distribute</code>との関連も避けられる。
            <dt><a class="property css" data-link-type="property" href="#propdef-ruby-merge"
                    id="ref-for-propdef-ruby-merge①⑥">ruby-merge</a>プロパティ追加、熟語ルビ制御用。
            <dd> これは構造的効果ではなくスタイル効果。
                旧モデルは構造的でマークアップ変更による対応を想定していたが、誤りだった。
            <dt><span class="css">inline</span> を <a class="property css" data-link-type="property"
                    href="#propdef-ruby-position" id="ref-for-propdef-ruby-position①①">ruby-position</a> から削除。
            <dd> これは各種要素に <code>display: inline</code>を適用すればAppendix Aのように実現可能。
            <dt><a href="#default-stylesheet">デフォルトスタイル</a>ルール追加
            <dd>Internationalization WGの要望による。
            <dt> 匿名ボックス生成規則を策定
            <dd> <a data-link-type="dfn" href="#pairing" id="ref-for-pairing①⓪">基底・注釈ペアリング</a>明確化。
                HTMLルビ全マークアップの組み合わせも扱えるはず。
            <dt> ルビのレイアウト定義
            <dd> 空間分布・空白処理・改行・行積み上げ等を詳細に規定。
                bidiについてはopen issue。
        </dl>
    </main>
    <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content"> 適合性</span><a class="self-link"
            href="#w3c-conformance"></a></h2>
    <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content"> 文書上の規約</span><a class="self-link"
            href="#w3c-conventions"></a></h3>
    <p>適合要件は、記述的な断定とRFC 2119の用語の組み合わせで表現されます。規範的な部分における「MUST」「MUST NOT」「REQUIRED」「SHALL」「SHALL NOT」「SHOULD」「SHOULD
        NOT」「RECOMMENDED」「MAY」「OPTIONAL」はRFC 2119で定義される意味で解釈してください。
        ただし可読性のため、本仕様書ではこれらの単語は必ずしもすべて大文字で記載されていません。</p>
    <p>この仕様の本文は、特に非規範的、例、注記と明記された部分を除き、すべて規範的です。<a data-link-type="biblio" href="#biblio-rfc2119"
            title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
    <p>本仕様の例は「for example」で始まるか、下記のように<code>class="example"</code>で規範テキストから区別されます：</p>
    <div class="example" id="w3c-example">
        <a class="self-link" href="#w3c-example"></a>
        <p>これは情報的な例です。</p>
    </div>
    <p>情報的な注記は「Note」で始まり、<code>class="note"</code>で規範テキストから区別されます：</p>
    <p class="note" role="note">注記: これは情報的な注記です。</p>
    <p>助言（advisement）は規範的な強調部分であり、下記のように<code>&lt;strong class="advisement"></code>で区別されます：<strong class="advisement">
            UAはアクセシブルな代替手段を必ず提供しなければなりません。 </strong></p>
    <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content"> 適合クラス</span><a
            class="self-link" href="#w3c-conformance-classes"></a></h3>
    <p>本仕様への適合は、以下の3つの適合クラスについて定義されます：</p>
    <dl>
        <dt>スタイルシート
        <dd><a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSSスタイルシート</a>。
        <dt>レンダラー
        <dd><a
                href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>（利用者エージェント）で、スタイルシートの意味を解釈し、それを使って文書を描画するもの。
        <dt>オーサリングツール
        <dd><a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>のうち、スタイルシートを作成するもの。
    </dl>
    <p>スタイルシートは、本モジュールで定義された構文を使うすべての記述が、一般CSS文法および各機能ごとの個別文法に従い正当であれば、本仕様に適合します。</p>
    <p>レンダラーは、スタイルシートを仕様通りに解釈することに加え、本仕様で定義されたすべての機能を正しくパース・描画することで適合となります。ただし、デバイスの制限で文書を正しく描画できない場合でもUAが非適合となるわけではありません（例：モノクロ画面で色を描画できなくても問題なし）。
    </p>
    <p>オーサリングツールは、一般CSS文法と本モジュール内各機能の個別文法に合致し、本モジュールで定義されるその他の適合要件を満たすスタイルシートを出力すれば適合となります。</p>
    <h3 class="no-ref heading settled" id="w3c-partial"><span class="content"> 部分実装</span><a class="self-link"
            href="#w3c-partial"></a></h3>
    <p>著者がフォールバック値を指定できるようにするため、CSSレンダラーは、未サポートの@ルール・プロパティ・値・キーワード・その他構文要素については<strong>必ず</strong>（必要に応じて<a
            href="https://www.w3.org/TR/CSS21/conform.html#ignore">無視</a>）無効として扱うべきです。特にUAは、未サポート値を含む複数値プロパティ宣言で、サポートされている値だけを選択的に適用しては<strong>なりません</strong>。いずれか一つでも値が無効とされた場合、CSSでは宣言全体を無視しなければなりません。
    </p>
    <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content"> 不安定・独自拡張機能の実装</span><a
            class="self-link" href="#w3c-conform-future-proofing"></a></h4>
    <p>将来のCSS標準機能との衝突を防ぐため、CSSWGは<a href="https://www.w3.org/TR/CSS/#future-proofing">将来互換性のベストプラクティス</a>や<a
            href="https://www.w3.org/TR/CSS/#unstable">不安定</a>機能・<a
            href="https://www.w3.org/TR/CSS/#proprietary-extension">独自拡張</a>の実装に関する推奨事項に従うことを提案します。</p>
    <h3 class="no-ref heading settled" id="w3c-testing"><span class="content"> 非実験的実装</span><a class="self-link"
            href="#w3c-testing"></a></h3>
    <p>仕様がCandidate Recommendation段階に達すると、非実験的な実装が可能となります。実装者は仕様に従って正しく動作することが実証できるCRレベルの機能については、プリフィックス無しでリリースすべきです。
    </p>
    <p>CSSの実装間での相互運用性を確保するため、CSSワーキンググループでは非実験的CSSレンダラーが実装レポート（および必要に応じて、そのためのテストケース）をW3Cに提出することを推奨しています。テストケースはCSSワーキンググループで審査・修正されることがあります。
    </p>
    <p>テストケースや実装レポートの提出方法などの詳細は、CSSワーキンググループのウェブサイト <a
            href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a> を参照してください。
        質問は <a href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
        メーリングリストまで。</p>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本仕様で定義されている用語</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#valdef-ruby-position-alternate">alternate</a><span>、§ 4.1</span>
        <li><a href="#ruby-annotation-box">annotation</a><span>、§ 2.1</span>
        <li><a href="#ruby-annotation-box">annotation box</a><span>、§ 2.1</span>
        <li><a href="#ruby-annotation-container-box">annotation container</a><span>、§ 2.1</span>
        <li><a href="#annotation-level">annotation level</a><span>、§ 2.3.1</span>
        <li>
            auto
            <ul>
                <li><a href="#valdef-ruby-merge-auto">ruby-mergeの値</a><span>、§ 4.2</span>
                <li><a href="#valdef-ruby-overhang-auto">ruby-overhangの値</a><span>、§ 5.1</span>
            </ul>
        <li><a href="#auto-hidden">auto-hidden</a><span>、§ 2.4</span>
        <li><a href="#auto-hidden">auto-hide</a><span>、§ 2.4</span>
        <li><a href="#ruby-base-box">base</a><span>、§ 2.1</span>
        <li><a href="#ruby-base-box">base box</a><span>、§ 2.1</span>
        <li><a href="#ruby-base-container-box">base container</a><span>、§ 2.1</span>
        <li><a href="#base-level">base level</a><span>、§ 2.3.1</span>
        <li><a href="#base-level">base text level</a><span>、§ 2.3.1</span>
        <li><a href="#bopomofo">ボポモフォ</a><span>、§ 6</span>
        <li><a href="#bopomofo-characters">ボポモフォ文字</a><span>、§ 6</span>
        <li><a href="#bopomofo-tone-marks">ボポモフォ声調記号</a><span>、§ 6</span>
        <li><a href="#valdef-ruby-align-center">center</a><span>、§ 4.3</span>
        <li><a href="#ruby-columns">column</a><span>、§ 2.3</span>
        <li><a href="#hidden-annotation">hidden</a><span>、§ 2.4</span>
        <li><a href="#hidden-annotation">hidden annotation</a><span>、§ 2.4</span>
        <li><a href="#hidden-annotation">hidden ruby annotation</a><span>、§ 2.4</span>
        <li><a href="#hidden-annotation">hide</a><span>、§ 2.4</span>
        <li><a href="#inter-annotation-white-space">inter-annotation white space</a><span>、§ 2.2</span>
        <li><a href="#inter-base-white-space">inter-base white space</a><span>、§ 2.2</span>
        <li>
            inter-character
            <ul>
                <li><a href="#ruby-position-inter-character-annotation">ruby-positionの定義</a><span>、§ 4.1</span>
                <li><a href="#valdef-ruby-position-inter-character">ruby-positionの値</a><span>、§ 4.1</span>
            </ul>
        <li><a href="#ruby-position-inter-character-annotation">inter-character annotation</a><span>、§ 4.1</span>
        <li><a href="#inter-level-white-space">inter-level white space</a><span>、§ 2.2</span>
        <li><a href="#interlinear-annotations">interlinear</a><span>、§ 4.1</span>
        <li><a href="#interlinear-annotations">interlinear annotations</a><span>、§ 4.1</span>
        <li><a href="#internal-ruby-boxes">internal ruby boxes</a><span>、§ 2.1.1</span>
        <li><a href="#internal-ruby-boxes">internal ruby display types</a><span>、§ 2.1.1</span>
        <li><a href="#inter-segment-white-space">inter-segment white space</a><span>、§ 2.2</span>
        <li><a href="#intra-level-white-space">intra-level white space</a><span>、§ 2.2</span>
        <li><a href="#intra-ruby-white-space">intra-ruby white space</a><span>、§ 2.2</span>
        <li><a href="#annotation-level">level</a><span>、§ 2.3.1</span>
        <li><a href="#valdef-ruby-merge-merge">merge</a><span>、§ 4.2</span>
        <li><a href="#merged-annotation">merged</a><span>、§ 4.2</span>
        <li><a href="#merged-annotation">merged annotation</a><span>、§ 4.2</span>
        <li><a href="#valdef-ruby-overhang-none">none</a><span>、§ 5.1</span>
        <li><a href="#valdef-ruby-position-over">over</a><span>、§ 4.1</span>
        <li><a href="#pairing">pairing</a><span>、§ 2.3</span>
        <li><a href="#ruby">Ruby</a><span>、§ 1.1</span>
        <li><a href="#valdef-display-ruby">ruby</a><span>、§ 2.1</span>
        <li><a href="#propdef-ruby-align">ruby-align</a><span>、§ 4.3</span>
        <li><a href="#ruby-annotation-box">ruby annotation</a><span>、§ 2.1</span>
        <li><a href="#ruby-annotation-box">ruby annotation box</a><span>、§ 2.1</span>
        <li><a href="#ruby-annotation-container-box">ruby annotation container</a><span>、§ 2.1</span>
        <li><a href="#ruby-annotation-container-box">ruby annotation container box</a><span>、§ 2.1</span>
        <li><a href="#ruby-base-box">ruby base</a><span>、§ 2.1</span>
        <li><a href="#valdef-display-ruby-base">ruby-base</a><span>、§ 2.1</span>
        <li><a href="#ruby-base-box">ruby base box</a><span>、§ 2.1</span>
        <li><a href="#ruby-base-container-box">ruby base container</a><span>、§ 2.1</span>
        <li><a href="#valdef-display-ruby-base-container">ruby-base-container</a><span>、§ 2.1</span>
        <li><a href="#ruby-base-container-box">ruby base container box</a><span>、§ 2.1</span>
        <li><a href="#ruby-columns">ruby columns</a><span>、§ 2.3</span>
        <li><a href="#ruby-container">ruby container</a><span>、§ 2.1</span>
        <li><a href="#ruby-container">ruby container box</a><span>、§ 2.1</span>
        <li><a href="#ruby-formatting-context">ruby formatting context</a><span>、§ 2.1.1</span>
        <li><a href="#propdef-ruby-merge">ruby-merge</a><span>、§ 4.2</span>
        <li><a href="#propdef-ruby-overhang">ruby-overhang</a><span>、§ 5.1</span>
        <li><a href="#propdef-ruby-position">ruby-position</a><span>、§ 4.1</span>
        <li><a href="#ruby-segments">ruby segments</a><span>、§ 2.3.1</span>
        <li><a href="#valdef-display-ruby-text">ruby-text</a><span>、§ 2.1</span>
        <li><a href="#valdef-display-ruby-text-container">ruby-text-container</a><span>、§ 2.1</span>
        <li><a href="#valdef-ruby-merge-separate">separate</a><span>、§ 4.2</span>
        <li><a href="#valdef-ruby-align-space-around">space-around</a><span>、§ 4.3</span>
        <li><a href="#valdef-ruby-align-space-between">space-between</a><span>、§ 4.3</span>
        <li><a href="#span">span</a><span>、§ 2.3</span>
        <li><a href="#spanning-annotation">spanning annotation</a><span>、§ 2.3</span>
        <li><a href="#valdef-ruby-align-start">start</a><span>、§ 4.3</span>
        <li><a href="#valdef-ruby-position-under">under</a><span>、§ 4.1</span>
        <li><a href="#zhuyin-fuhao">注音符号</a><span>、§ 6</span>
    </ul>
    <aside class="dfn-panel" data-for="term-for-border">
        <a href="https://www.w3.org/TR/css-box-4/#border">https://www.w3.org/TR/css-box-4/#border</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-border">3.3.
                    Styling Ruby Boxes</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-content-area">
        <a href="https://www.w3.org/TR/css-box-4/#content-area">https://www.w3.org/TR/css-box-4/#content-area</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-content-area">3.2.
                    Inter-character Ruby Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-content-box">
        <a href="https://www.w3.org/TR/css-box-4/#content-box">https://www.w3.org/TR/css-box-4/#content-box</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-content-box">3.2.
                    Inter-character Ruby Layout</a> <a href="#ref-for-content-box①">(2)</a> <a
                    href="#ref-for-content-box②">(3)</a> <a href="#ref-for-content-box③">(4)</a> <a
                    href="#ref-for-content-box④">(5)</a> <a href="#ref-for-content-box⑤">(6)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-margin">
        <a href="https://www.w3.org/TR/css-box-4/#margin">https://www.w3.org/TR/css-box-4/#margin</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-margin">3.3.
                    Styling Ruby Boxes</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-margin-box">
        <a href="https://www.w3.org/TR/css-box-4/#margin-box">https://www.w3.org/TR/css-box-4/#margin-box</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-margin-box">3.2.
                    Inter-character Ruby Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-padding">
        <a
            href="https://www.w3.org/TR/css-box-4/#propdef-padding">https://www.w3.org/TR/css-box-4/#propdef-padding</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-padding">3.6.
                    Line Spacing</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-computed-value">
        <a
            href="https://www.w3.org/TR/css-cascade-5/#computed-value">https://www.w3.org/TR/css-cascade-5/#computed-value</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-computed-value">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-initial-value">
        <a
            href="https://www.w3.org/TR/css-cascade-5/#initial-value">https://www.w3.org/TR/css-cascade-5/#initial-value</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-initial-value"> Changes since the 29 April 2020 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-atomic-inline">
        <a
            href="https://www.w3.org/TR/css-display-3/#atomic-inline">https://www.w3.org/TR/css-display-3/#atomic-inline</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-atomic-inline">2.5.
                    White Space Collapsing</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-display-block">
        <a
            href="https://www.w3.org/TR/css-display-3/#valdef-display-block">https://www.w3.org/TR/css-display-3/#valdef-display-block</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-display-block">2.1.2.
                    Non-Inline Ruby</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-block-container">
        <a
            href="https://www.w3.org/TR/css-display-3/#block-container">https://www.w3.org/TR/css-display-3/#block-container</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-block-container">2.1.1.
                    The Ruby Formatting Context</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-visibility-collapse">
        <a
            href="https://www.w3.org/TR/css-display-3/#valdef-visibility-collapse">https://www.w3.org/TR/css-display-3/#valdef-visibility-collapse</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-visibility-collapse">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-containing-block">
        <a
            href="https://www.w3.org/TR/css-display-3/#containing-block">https://www.w3.org/TR/css-display-3/#containing-block</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-containing-block">2.1.1.
                    The Ruby Formatting Context</a> <a href="#ref-for-containing-block①">(2)</a> <a
                    href="#ref-for-containing-block②">(3)</a> <a href="#ref-for-containing-block③">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-display">
        <a
            href="https://www.w3.org/TR/css-display-3/#propdef-display">https://www.w3.org/TR/css-display-3/#propdef-display</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-display">2.1.
                    Ruby-specific display Values</a> <a href="#ref-for-propdef-display①">(2)</a> <a
                    href="#ref-for-propdef-display②">(3)</a> <a href="#ref-for-propdef-display③">(4)</a> <a
                    href="#ref-for-propdef-display④">(5)</a> <a href="#ref-for-propdef-display⑤">(6)</a> <a
                    href="#ref-for-propdef-display⑥">(7)</a>
            <li><a href="#ref-for-propdef-display⑦">2.1.2.
                    Non-Inline Ruby</a> <a href="#ref-for-propdef-display⑧">(2)</a>
            <li><a href="#ref-for-propdef-display⑨">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-propdef-display①⓪">(2)</a> <a
                    href="#ref-for-propdef-display①①">(3)</a> <a href="#ref-for-propdef-display①②">(4)</a> <a
                    href="#ref-for-propdef-display①③">(5)</a> <a href="#ref-for-propdef-display①④">(6)</a>
            <li><a href="#ref-for-propdef-display①⑤">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a> <a
                    href="#ref-for-propdef-display①⑥">(2)</a> <a href="#ref-for-propdef-display①⑦">(3)</a>
            <li><a href="#ref-for-propdef-display①⑧">4.1.
                    Ruby Positioning: the ruby-position property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-formatting-context">
        <a
            href="https://www.w3.org/TR/css-display-3/#formatting-context">https://www.w3.org/TR/css-display-3/#formatting-context</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-formatting-context">2.1.1.
                    The Ruby Formatting Context</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-in-flow">
        <a href="https://www.w3.org/TR/css-display-3/#in-flow">https://www.w3.org/TR/css-display-3/#in-flow</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-in-flow">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-in-flow①">(2)</a> <a
                    href="#ref-for-in-flow②">(3)</a> <a href="#ref-for-in-flow③">(4)</a>
            <li><a href="#ref-for-in-flow④">3.1.2.
                    Block-axis Interlinear Layout</a> <a href="#ref-for-in-flow⑤">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-independent-formatting-context">
        <a
            href="https://www.w3.org/TR/css-display-3/#independent-formatting-context">https://www.w3.org/TR/css-display-3/#independent-formatting-context</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-independent-formatting-context">2.1.1.
                    The Ruby Formatting Context</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-display-inline">
        <a
            href="https://www.w3.org/TR/css-display-3/#valdef-display-inline">https://www.w3.org/TR/css-display-3/#valdef-display-inline</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-display-inline">2.1.2.
                    Non-Inline Ruby</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-inline-block">
        <a
            href="https://www.w3.org/TR/css-display-3/#inline-block">https://www.w3.org/TR/css-display-3/#inline-block</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-inline-block">3.2.
                    Inter-character Ruby Layout</a>
            <li><a href="#ref-for-inline-block①"> Changes since the 29 April 2020 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-inline-box">
        <a href="https://www.w3.org/TR/css-display-3/#inline-box">https://www.w3.org/TR/css-display-3/#inline-box</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-inline-box">2.1.1.
                    The Ruby Formatting Context</a> <a href="#ref-for-inline-box①">(2)</a> <a
                    href="#ref-for-inline-box②">(3)</a> <a href="#ref-for-inline-box③">(4)</a>
            <li><a href="#ref-for-inline-box④">3.
                    Ruby Layout</a> <a href="#ref-for-inline-box⑤">(2)</a>
            <li><a href="#ref-for-inline-box⑥">3.1.
                    Interlinear Ruby Layout</a>
            <li><a href="#ref-for-inline-box⑦">3.3.
                    Styling Ruby Boxes</a> <a href="#ref-for-inline-box⑧">(2)</a> <a href="#ref-for-inline-box⑨">(3)</a>
                <a href="#ref-for-inline-box①⓪">(4)</a>
            <li><a href="#ref-for-inline-box①①">4.2.
                    Sharing Annotation Space: the ruby-merge property</a>
            <li><a href="#ref-for-inline-box①②"> Changes since the 29 April 2020 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-inline-formatting-context">
        <a
            href="https://www.w3.org/TR/css-display-3/#inline-formatting-context">https://www.w3.org/TR/css-display-3/#inline-formatting-context</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-inline-formatting-context">2.1.1.
                    The Ruby Formatting Context</a> <a href="#ref-for-inline-formatting-context①">(2)</a> <a
                    href="#ref-for-inline-formatting-context②">(3)</a> <a
                    href="#ref-for-inline-formatting-context③">(4)</a> <a
                    href="#ref-for-inline-formatting-context④">(5)</a>
            <li><a href="#ref-for-inline-formatting-context⑤">3.1.
                    Interlinear Ruby Layout</a>
            <li><a href="#ref-for-inline-formatting-context⑥">3.1.2.
                    Block-axis Interlinear Layout</a> <a href="#ref-for-inline-formatting-context⑦">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-display-inline-block">
        <a
            href="https://www.w3.org/TR/css-display-3/#valdef-display-inline-block">https://www.w3.org/TR/css-display-3/#valdef-display-inline-block</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-display-inline-block">2.2.
                    Anonymous Ruby Box Generation</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-inline-level">
        <a
            href="https://www.w3.org/TR/css-display-3/#inline-level">https://www.w3.org/TR/css-display-3/#inline-level</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-inline-level">2.1.1.
                    The Ruby Formatting Context</a>
            <li><a href="#ref-for-inline-level①">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-inline-level②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-inline-level-box">
        <a
            href="https://www.w3.org/TR/css-display-3/#inline-level-box">https://www.w3.org/TR/css-display-3/#inline-level-box</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-inline-level-box">2.1.
                    Ruby-specific display Values</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-inline-level">
        <a
            href="https://www.w3.org/TR/css-display-3/#inline-level">https://www.w3.org/TR/css-display-3/#inline-level</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-inline-level">2.1.1.
                    The Ruby Formatting Context</a>
            <li><a href="#ref-for-inline-level①">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-inline-level②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-inlinify">
        <a href="https://www.w3.org/TR/css-display-3/#inlinify">https://www.w3.org/TR/css-display-3/#inlinify</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-inlinify">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-inlinify①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-inner-display-type">
        <a
            href="https://www.w3.org/TR/css-display-3/#inner-display-type">https://www.w3.org/TR/css-display-3/#inner-display-type</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-inner-display-type">2.1.2.
                    Non-Inline Ruby</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-internal-table-element">
        <a
            href="https://www.w3.org/TR/css-display-3/#internal-table-element">https://www.w3.org/TR/css-display-3/#internal-table-element</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-internal-table-element">2.1.1.
                    The Ruby Formatting Context</a>
            <li><a href="#ref-for-internal-table-element①">2.2.
                    Anonymous Ruby Box Generation</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-outer-display-type">
        <a
            href="https://www.w3.org/TR/css-display-3/#outer-display-type">https://www.w3.org/TR/css-display-3/#outer-display-type</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-outer-display-type">2.1.
                    Ruby-specific display Values</a>
            <li><a href="#ref-for-outer-display-type①">2.1.2.
                    Non-Inline Ruby</a> <a href="#ref-for-outer-display-type②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-replaced-element">
        <a
            href="https://www.w3.org/TR/css-display-3/#replaced-element">https://www.w3.org/TR/css-display-3/#replaced-element</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-replaced-element">2.1.
                    Ruby-specific display Values</a> <a href="#ref-for-replaced-element①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-visibility">
        <a
            href="https://www.w3.org/TR/css-display-3/#propdef-visibility">https://www.w3.org/TR/css-display-3/#propdef-visibility</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-visibility">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a> <a
                    href="#ref-for-propdef-visibility①">(2)</a> <a href="#ref-for-propdef-visibility②">(3)</a> <a
                    href="#ref-for-propdef-visibility③">(4)</a> <a href="#ref-for-propdef-visibility④">(5)</a> <a
                    href="#ref-for-propdef-visibility⑤">(6)</a> <a href="#ref-for-propdef-visibility⑥">(7)</a> <a
                    href="#ref-for-propdef-visibility⑦">(8)</a>
            <li><a href="#ref-for-propdef-visibility⑧"> Changes since the 29 April 2020 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-descdef-font-face-font-size">
        <a
            href="https://www.w3.org/TR/css-fonts-5/#descdef-font-face-font-size">https://www.w3.org/TR/css-fonts-5/#descdef-font-face-font-size</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-descdef-font-face-font-size"> Changes since the 2 December 2021 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-grid-template-columns-max-content">
        <a
            href="https://www.w3.org/TR/css-grid-2/#valdef-grid-template-columns-max-content">https://www.w3.org/TR/css-grid-2/#valdef-grid-template-columns-max-content</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-grid-template-columns-max-content"> Changes since the 29 April 2020 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-baseline-shift-bottom">
        <a
            href="https://www.w3.org/TR/css-inline-3/#valdef-baseline-shift-bottom">https://www.w3.org/TR/css-inline-3/#valdef-baseline-shift-bottom</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-baseline-shift-bottom">3.3.
                    Styling Ruby Boxes</a> <a href="#ref-for-valdef-baseline-shift-bottom①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-line-box">
        <a href="https://www.w3.org/TR/css-inline-3/#line-box">https://www.w3.org/TR/css-inline-3/#line-box</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-line-box">3.1.
                    Interlinear Ruby Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-line-relative-shift-values">
        <a
            href="https://www.w3.org/TR/css-inline-3/#line-relative-shift-values">https://www.w3.org/TR/css-inline-3/#line-relative-shift-values</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-line-relative-shift-values">3.3.
                    Styling Ruby Boxes</a> <a href="#ref-for-line-relative-shift-values①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-baseline-shift-top">
        <a
            href="https://www.w3.org/TR/css-inline-3/#valdef-baseline-shift-top">https://www.w3.org/TR/css-inline-3/#valdef-baseline-shift-top</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-baseline-shift-top">3.3.
                    Styling Ruby Boxes</a> <a href="#ref-for-valdef-baseline-shift-top①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-vertical-align">
        <a
            href="https://www.w3.org/TR/css-inline-3/#propdef-vertical-align">https://www.w3.org/TR/css-inline-3/#propdef-vertical-align</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-vertical-align">3.1.2.
                    Block-axis Interlinear Layout</a>
            <li><a href="#ref-for-propdef-vertical-align①">3.3.
                    Styling Ruby Boxes</a> <a href="#ref-for-propdef-vertical-align②">(2)</a>
            <li><a href="#ref-for-propdef-vertical-align③">3.6.
                    Line Spacing</a> <a href="#ref-for-propdef-vertical-align④">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-selectordef-first-letter">
        <a
            href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-letter">https://www.w3.org/TR/css-pseudo-4/#selectordef-first-letter</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-selectordef-first-letter">1.2.
                    Module interactions</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-selectordef-first-line">
        <a
            href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-line">https://www.w3.org/TR/css-pseudo-4/#selectordef-first-line</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-selectordef-first-line">1.2.
                    Module interactions</a> <a href="#ref-for-selectordef-first-line①">(2)</a>
            <li><a href="#ref-for-selectordef-first-line②"> Changes since the 5 August 2014 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-automatic-size">
        <a
            href="https://www.w3.org/TR/css-sizing-3/#automatic-size">https://www.w3.org/TR/css-sizing-3/#automatic-size</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-automatic-size">3.2.
                    Inter-character Ruby Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-letter">
        <a href="https://www.w3.org/TR/css-syntax-3/#letter">https://www.w3.org/TR/css-syntax-3/#letter</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-letter">6.
                    Glossary</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-table-wrapper-box">
        <a
            href="https://www.w3.org/TR/css-tables-3/#table-wrapper-box">https://www.w3.org/TR/css-tables-3/#table-wrapper-box</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-table-wrapper-box">2.2.
                    Anonymous Ruby Box Generation</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-character">
        <a href="https://www.w3.org/TR/css-text-3/#character">https://www.w3.org/TR/css-text-3/#character</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-character">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a href="#ref-for-character①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-collapsible-white-space">
        <a
            href="https://www.w3.org/TR/css-text-3/#collapsible-white-space">https://www.w3.org/TR/css-text-3/#collapsible-white-space</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-collapsible-white-space">2.5.
                    White Space Collapsing</a> <a href="#ref-for-collapsible-white-space①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-justification-opportunity">
        <a
            href="https://www.w3.org/TR/css-text-3/#justification-opportunity">https://www.w3.org/TR/css-text-3/#justification-opportunity</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-justification-opportunity">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a
                    href="#ref-for-justification-opportunity①">(2)</a> <a
                    href="#ref-for-justification-opportunity②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-word-break-keep-all">
        <a
            href="https://www.w3.org/TR/css-text-3/#valdef-word-break-keep-all">https://www.w3.org/TR/css-text-3/#valdef-word-break-keep-all</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-word-break-keep-all">3.4.1.
                    Breaking Between Bases</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-segment-break">
        <a href="https://www.w3.org/TR/css-text-3/#segment-break">https://www.w3.org/TR/css-text-3/#segment-break</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-segment-break">2.5.
                    White Space Collapsing</a> <a href="#ref-for-segment-break①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-soft-wrap-opportunity">
        <a
            href="https://www.w3.org/TR/css-text-3/#soft-wrap-opportunity">https://www.w3.org/TR/css-text-3/#soft-wrap-opportunity</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-soft-wrap-opportunity">3.4.2.
                    Breaking Within Bases</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-text-justify">
        <a
            href="https://www.w3.org/TR/css-text-3/#propdef-text-justify">https://www.w3.org/TR/css-text-3/#propdef-text-justify</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-text-justify">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a href="#ref-for-propdef-text-justify①">(2)</a>
                <a href="#ref-for-propdef-text-justify②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-text-transform">
        <a
            href="https://www.w3.org/TR/css-text-3/#propdef-text-transform">https://www.w3.org/TR/css-text-3/#propdef-text-transform</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-text-transform">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-unicode-script">
        <a
            href="https://www.w3.org/TR/css-text-3/#unicode-script">https://www.w3.org/TR/css-text-3/#unicode-script</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-unicode-script">6.
                    Glossary</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-white-space">
        <a href="https://www.w3.org/TR/css-text-3/#white-space">https://www.w3.org/TR/css-text-3/#white-space</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-white-space">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-white-space①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-white-space">
        <a
            href="https://www.w3.org/TR/css-text-3/#propdef-white-space">https://www.w3.org/TR/css-text-3/#propdef-white-space</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-white-space">2.2.
                    Anonymous Ruby Box Generation</a>
            <li><a href="#ref-for-propdef-white-space①">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a>
            <li><a href="#ref-for-propdef-white-space②">3.4.2.
                    Breaking Within Bases</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-word-break">
        <a
            href="https://www.w3.org/TR/css-text-3/#propdef-word-break">https://www.w3.org/TR/css-text-3/#propdef-word-break</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-word-break">3.4.1.
                    Breaking Between Bases</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-css-wide-keywords">
        <a
            href="https://www.w3.org/TR/css-values-4/#css-wide-keywords">https://www.w3.org/TR/css-values-4/#css-wide-keywords</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-css-wide-keywords">1.3.
                    Value Definitions</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-comb-one">
        <a href="https://www.w3.org/TR/css-values-4/#comb-one">https://www.w3.org/TR/css-values-4/#comb-one</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-comb-one">2.1.
                    Ruby-specific display Values</a> <a href="#ref-for-comb-one①">(2)</a> <a
                    href="#ref-for-comb-one②">(3)</a> <a href="#ref-for-comb-one③">(4)</a>
            <li><a href="#ref-for-comb-one④">4.1.
                    Ruby Positioning: the ruby-position property</a> <a href="#ref-for-comb-one⑤">(2)</a>
            <li><a href="#ref-for-comb-one⑥">4.2.
                    Sharing Annotation Space: the ruby-merge property</a> <a href="#ref-for-comb-one⑦">(2)</a>
            <li><a href="#ref-for-comb-one⑧">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a href="#ref-for-comb-one⑨">(2)</a> <a
                    href="#ref-for-comb-one①⓪">(3)</a>
            <li><a href="#ref-for-comb-one①①">5.1.
                    Overhanging Ruby: the ruby-overhang property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-comb-any">
        <a href="https://www.w3.org/TR/css-values-4/#comb-any">https://www.w3.org/TR/css-values-4/#comb-any</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-comb-any">4.1.
                    Ruby Positioning: the ruby-position property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-bidi-isolate">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#bidi-isolate">https://www.w3.org/TR/css-writing-modes-4/#bidi-isolate</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-bidi-isolate">4.2.
                    Sharing Annotation Space: the ruby-merge property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-unicode-bidi-bidi-override">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-bidi-override">https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-bidi-override</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-unicode-bidi-bidi-override">3.5.
                    Bidi Reordering</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-unicode-bidi-embed">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-embed">https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-embed</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-unicode-bidi-embed">3.5.
                    Bidi Reordering</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-horizontal-writing-mode">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#horizontal-writing-mode">https://www.w3.org/TR/css-writing-modes-4/#horizontal-writing-mode</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-horizontal-writing-mode">3.2.
                    Inter-character Ruby Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-inline-base-direction">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#inline-base-direction">https://www.w3.org/TR/css-writing-modes-4/#inline-base-direction</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-inline-base-direction">3.5.
                    Bidi Reordering</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-unicode-bidi-isolate">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-isolate">https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-isolate</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-unicode-bidi-isolate">3.5.
                    Bidi Reordering</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-unicode-bidi-isolate-override">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-isolate-override">https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-isolate-override</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-unicode-bidi-isolate-override">3.5.
                    Bidi Reordering</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-line-over">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#line-over">https://www.w3.org/TR/css-writing-modes-4/#line-over</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-line-over">4.1.
                    Ruby Positioning: the ruby-position property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-line-under">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#line-under">https://www.w3.org/TR/css-writing-modes-4/#line-under</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-line-under">4.1.
                    Ruby Positioning: the ruby-position property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-unicode-bidi-normal">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-normal">https://www.w3.org/TR/css-writing-modes-4/#valdef-unicode-bidi-normal</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-unicode-bidi-normal">3.5.
                    Bidi Reordering</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-vertical-writing-mode">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#vertical-writing-mode">https://www.w3.org/TR/css-writing-modes-4/#vertical-writing-mode</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-vertical-writing-mode">4.1.
                    Ruby Positioning: the ruby-position property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-valdef-writing-mode-vertical-rl">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#valdef-writing-mode-vertical-rl">https://www.w3.org/TR/css-writing-modes-4/#valdef-writing-mode-vertical-rl</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-writing-mode-vertical-rl">3.2.
                    Inter-character Ruby Layout</a>
            <li><a href="#ref-for-valdef-writing-mode-vertical-rl①">4.1.
                    Ruby Positioning: the ruby-position property</a> <a
                    href="#ref-for-valdef-writing-mode-vertical-rl②">(2)</a> <a
                    href="#ref-for-valdef-writing-mode-vertical-rl③">(3)</a> <a
                    href="#ref-for-valdef-writing-mode-vertical-rl④">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-writing-mode">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#writing-mode">https://www.w3.org/TR/css-writing-modes-4/#writing-mode</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-writing-mode">4.1.
                    Ruby Positioning: the ruby-position property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-writing-mode">
        <a
            href="https://www.w3.org/TR/css-writing-modes-4/#propdef-writing-mode">https://www.w3.org/TR/css-writing-modes-4/#propdef-writing-mode</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-writing-mode">3.2.
                    Inter-character Ruby Layout</a>
            <li><a href="#ref-for-propdef-writing-mode①">4.1.
                    Ruby Positioning: the ruby-position property</a> <a href="#ref-for-propdef-writing-mode②">(2)</a> <a
                    href="#ref-for-propdef-writing-mode③">(3)</a> <a href="#ref-for-propdef-writing-mode④">(4)</a> <a
                    href="#ref-for-propdef-writing-mode⑤">(5)</a> <a href="#ref-for-propdef-writing-mode⑥">(6)</a>
            <li><a href="#ref-for-propdef-writing-mode⑦"> Changes since the 2 December 2021 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-line-height">
        <a
            href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height">https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-line-height">3.3.
                    Styling Ruby Boxes</a> <a href="#ref-for-propdef-line-height①">(2)</a>
            <li><a href="#ref-for-propdef-line-height②">3.6.
                    Line Spacing</a> <a href="#ref-for-propdef-line-height③">(2)</a> <a
                    href="#ref-for-propdef-line-height④">(3)</a> <a href="#ref-for-propdef-line-height⑤">(4)</a> <a
                    href="#ref-for-propdef-line-height⑥">(5)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-text-emphasis-position">
        <a
            href="https://www.w3.org/TR/css-text-decor-3/#propdef-text-emphasis-position">https://www.w3.org/TR/css-text-decor-3/#propdef-text-emphasis-position</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-text-emphasis-position"> Changes since the 30 June 2011 WD</a> <a
                    href="#ref-for-propdef-text-emphasis-position①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-direction">
        <a
            href="https://www.w3.org/TR/css-writing-modes-3/#propdef-direction">https://www.w3.org/TR/css-writing-modes-3/#propdef-direction</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-direction">3.5.
                    Bidi Reordering</a> <a href="#ref-for-propdef-direction①">(2)</a> <a
                    href="#ref-for-propdef-direction②">(3)</a> <a href="#ref-for-propdef-direction③">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-propdef-unicode-bidi">
        <a
            href="https://www.w3.org/TR/css-writing-modes-3/#propdef-unicode-bidi">https://www.w3.org/TR/css-writing-modes-3/#propdef-unicode-bidi</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-unicode-bidi">3.5.
                    Bidi Reordering</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-the-rp-element">
        <a
            href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-rp-element">https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-rp-element</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-the-rp-element"> Changes since the 30 June 2011 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-rtc">
        <a
            href="https://html.spec.whatwg.org/multipage/obsolete.html#rtc">https://html.spec.whatwg.org/multipage/obsolete.html#rtc</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-rtc"> Changes since the 5 August 2014 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-the-ruby-element">
        <a
            href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-ruby-element">https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-ruby-element</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-the-ruby-element"> Changes since the 30 June 2011 WD</a>
        </ul>
    </aside>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">参照による定義用語</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSS-BOX-4]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-border">border</span>
                <li><span class="dfn-paneled" id="term-for-content-area">content area</span>
                <li><span class="dfn-paneled" id="term-for-content-box">content box</span>
                <li><span class="dfn-paneled" id="term-for-margin">margin</span>
                <li><span class="dfn-paneled" id="term-for-margin-box">margin box</span>
                <li><span class="dfn-paneled" id="term-for-propdef-padding">padding</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-CASCADE-5]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-computed-value">computed value</span>
                <li><span class="dfn-paneled" id="term-for-initial-value">initial value</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-DISPLAY-3]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-atomic-inline">atomic inline</span>
                <li><span class="dfn-paneled" id="term-for-valdef-display-block">block</span>
                <li><span class="dfn-paneled" id="term-for-block-container">block container</span>
                <li><span class="dfn-paneled" id="term-for-valdef-visibility-collapse">collapse</span>
                <li><span class="dfn-paneled" id="term-for-containing-block">containing block</span>
                <li><span class="dfn-paneled" id="term-for-propdef-display">display</span>
                <li><span class="dfn-paneled" id="term-for-formatting-context">formatting context</span>
                <li><span class="dfn-paneled" id="term-for-in-flow">in-flow</span>
                <li><span class="dfn-paneled" id="term-for-independent-formatting-context">independent formatting
                        context</span>
                <li><span class="dfn-paneled" id="term-for-valdef-display-inline">inline</span>
                <li><span class="dfn-paneled" id="term-for-inline-block">inline block</span>
                <li><span class="dfn-paneled" id="term-for-inline-box">inline box</span>
                <li><span class="dfn-paneled" id="term-for-inline-formatting-context">inline formatting context</span>
                <li><span class="dfn-paneled" id="term-for-valdef-display-inline-block">inline-block</span>
                <li><span class="dfn-paneled" id="term-for-inline-level">inline-level</span>
                <li><span class="dfn-paneled" id="term-for-inline-level-box">inline-level box</span>
                <li><span class="dfn-paneled" id="term-for-inline-level①">inline-level content</span>
                <li><span class="dfn-paneled" id="term-for-inlinify">inlinify</span>
                <li><span class="dfn-paneled" id="term-for-inner-display-type">inner display type</span>
                <li><span class="dfn-paneled" id="term-for-internal-table-element">internal table element</span>
                <li><span class="dfn-paneled" id="term-for-outer-display-type">outer display type</span>
                <li><span class="dfn-paneled" id="term-for-replaced-element">replaced element</span>
                <li><span class="dfn-paneled" id="term-for-propdef-visibility">visibility</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-FONTS-5]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-descdef-font-face-font-size">font-size</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-GRID-2]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-valdef-grid-template-columns-max-content">max-content</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-INLINE-3]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-valdef-baseline-shift-bottom">bottom</span>
                <li><span class="dfn-paneled" id="term-for-line-box">line box</span>
                <li><span class="dfn-paneled" id="term-for-line-relative-shift-values">line-relative shift values</span>
                <li><span class="dfn-paneled" id="term-for-valdef-baseline-shift-top">top</span>
                <li><span class="dfn-paneled" id="term-for-propdef-vertical-align">vertical-align</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-PSEUDO-4]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-selectordef-first-letter">::first-letter</span>
                <li><span class="dfn-paneled" id="term-for-selectordef-first-line">::first-line</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-SIZING-3]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-automatic-size">automatic size</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-SYNTAX-3]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-letter">letter</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-TABLES-3]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-table-wrapper-box">table wrapper box</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-TEXT-3]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-character">character</span>
                <li><span class="dfn-paneled" id="term-for-collapsible-white-space">collapsible white space</span>
                <li><span class="dfn-paneled" id="term-for-justification-opportunity">justification opportunity</span>
                <li><span class="dfn-paneled" id="term-for-valdef-word-break-keep-all">keep-all</span>
                <li><span class="dfn-paneled" id="term-for-segment-break">segment break</span>
                <li><span class="dfn-paneled" id="term-for-soft-wrap-opportunity">soft wrap opportunity</span>
                <li><span class="dfn-paneled" id="term-for-propdef-text-justify">text-justify</span>
                <li><span class="dfn-paneled" id="term-for-propdef-text-transform">text-transform</span>
                <li><span class="dfn-paneled" id="term-for-unicode-script">unicode script</span>
                <li><span class="dfn-paneled" id="term-for-white-space">white space</span>
                <li><span class="dfn-paneled" id="term-for-propdef-white-space">white-space</span>
                <li><span class="dfn-paneled" id="term-for-propdef-word-break">word-break</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-VALUES-4]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-css-wide-keywords">css-wide keywords</span>
                <li><span class="dfn-paneled" id="term-for-comb-one">|</span>
                <li><span class="dfn-paneled" id="term-for-comb-any">||</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-WRITING-MODES-4]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-bidi-isolate">bidi isolation</span>
                <li><span class="dfn-paneled" id="term-for-valdef-unicode-bidi-bidi-override">bidi-override</span>
                <li><span class="dfn-paneled" id="term-for-valdef-unicode-bidi-embed">embed</span>
                <li><span class="dfn-paneled" id="term-for-horizontal-writing-mode">horizontal writing mode</span>
                <li><span class="dfn-paneled" id="term-for-inline-base-direction">inline base direction</span>
                <li><span class="dfn-paneled" id="term-for-valdef-unicode-bidi-isolate">isolate</span>
                <li><span class="dfn-paneled" id="term-for-valdef-unicode-bidi-isolate-override">isolate-override</span>
                <li><span class="dfn-paneled" id="term-for-line-over">line-over</span>
                <li><span class="dfn-paneled" id="term-for-line-under">line-under</span>
                <li><span class="dfn-paneled" id="term-for-valdef-unicode-bidi-normal">normal</span>
                <li><span class="dfn-paneled" id="term-for-vertical-writing-mode">vertical writing mode</span>
                <li><span class="dfn-paneled" id="term-for-valdef-writing-mode-vertical-rl">vertical-rl</span>
                <li><span class="dfn-paneled" id="term-for-writing-mode">writing mode</span>
                <li><span class="dfn-paneled" id="term-for-propdef-writing-mode">writing-mode</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS2]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-propdef-line-height">line-height</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS3-TEXT-DECOR]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-propdef-text-emphasis-position">text-emphasis-position</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS3-WRITING-MODES]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-propdef-direction">direction</span>
                <li><span class="dfn-paneled" id="term-for-propdef-unicode-bidi">unicode-bidi</span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a> で次の用語が定義されています:
            <ul>
                <li><span class="dfn-paneled" id="term-for-the-rp-element">rp</span>
                <li><span class="dfn-paneled" id="term-for-rtc">rtc</span>
                <li><span class="dfn-paneled" id="term-for-the-ruby-element">ruby</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">規範的参照</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-css-box-4">[CSS-BOX-4]
        <dd>Elika Etemad. <a href="https://www.w3.org/TR/css-box-4/"><cite>CSS Box Model Module Level 4</cite></a>.
            2022年11月3日. WD. URL: <a href="https://www.w3.org/TR/css-box-4/">https://www.w3.org/TR/css-box-4/</a>
        <dt id="biblio-css-cascade-5">[CSS-CASCADE-5]
        <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-cascade-5/"><cite>CSS
                    Cascading and Inheritance Level 5</cite></a>. 2022年1月13日. CR. URL: <a
                href="https://www.w3.org/TR/css-cascade-5/">https://www.w3.org/TR/css-cascade-5/</a>
        <dt id="biblio-css-display-3">[CSS-DISPLAY-3]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-display-3/"><cite>CSS Display Module Level
                    3</cite></a>. 2022年11月18日. CR. URL: <a
                href="https://www.w3.org/TR/css-display-3/">https://www.w3.org/TR/css-display-3/</a>
        <dt id="biblio-css-fonts-5">[CSS-FONTS-5]
        <dd>Myles Maxfield; Chris Lilley. <a href="https://www.w3.org/TR/css-fonts-5/"><cite>CSS Fonts Module Level
                    5</cite></a>. 2021年12月21日. WD. URL: <a
                href="https://www.w3.org/TR/css-fonts-5/">https://www.w3.org/TR/css-fonts-5/</a>
        <dt id="biblio-css-grid-2">[CSS-GRID-2]
        <dd>Tab Atkins Jr.; Elika Etemad; Rossen Atanassov. <a href="https://www.w3.org/TR/css-grid-2/"><cite>CSS Grid
                    Layout Module Level 2</cite></a>. 2020年12月18日. CR. URL: <a
                href="https://www.w3.org/TR/css-grid-2/">https://www.w3.org/TR/css-grid-2/</a>
        <dt id="biblio-css-inline-3">[CSS-INLINE-3]
        <dd>Dave Cramer; Elika Etemad. <a href="https://www.w3.org/TR/css-inline-3/"><cite>CSS Inline Layout Module
                    Level 3</cite></a>. 2022年11月14日. WD. URL: <a
                href="https://www.w3.org/TR/css-inline-3/">https://www.w3.org/TR/css-inline-3/</a>
        <dt id="biblio-css-pseudo-4">[CSS-PSEUDO-4]
        <dd>Daniel Glazman; Elika Etemad; Alan Stearns. <a href="https://www.w3.org/TR/css-pseudo-4/"><cite>CSS
                    Pseudo-Elements Module Level 4</cite></a>. 2022年12月30日. WD. URL: <a
                href="https://www.w3.org/TR/css-pseudo-4/">https://www.w3.org/TR/css-pseudo-4/</a>
        <dt id="biblio-css-sizing-3">[CSS-SIZING-3]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-sizing-3/"><cite>CSS Box Sizing Module
                    Level 3</cite></a>. 2021年12月17日. WD. URL: <a
                href="https://www.w3.org/TR/css-sizing-3/">https://www.w3.org/TR/css-sizing-3/</a>
        <dt id="biblio-css-syntax-3">[CSS-SYNTAX-3]
        <dd>Tab Atkins Jr.; Simon Sapin. <a href="https://www.w3.org/TR/css-syntax-3/"><cite>CSS Syntax Module Level
                    3</cite></a>. 2021年12月24日. CR. URL: <a
                href="https://www.w3.org/TR/css-syntax-3/">https://www.w3.org/TR/css-syntax-3/</a>
        <dt id="biblio-css-tables-3">[CSS-TABLES-3]
        <dd>François Remy; Greg Whitworth; David Baron. <a href="https://www.w3.org/TR/css-tables-3/"><cite>CSS Table
                    Module Level 3</cite></a>. 2019年7月27日. WD. URL: <a
                href="https://www.w3.org/TR/css-tables-3/">https://www.w3.org/TR/css-tables-3/</a>
        <dt id="biblio-css-text-3">[CSS-TEXT-3]
        <dd>Elika Etemad; Koji Ishii; Florian Rivoal. <a href="https://www.w3.org/TR/css-text-3/"><cite>CSS Text Module
                    Level 3</cite></a>. 2022年5月5日. CR. URL: <a
                href="https://www.w3.org/TR/css-text-3/">https://www.w3.org/TR/css-text-3/</a>
        <dt id="biblio-css-values-3">[CSS-VALUES-3]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-3/"><cite>CSS Values and Units
                    Module Level 3</cite></a>. 2022年12月1日. CR. URL: <a
                href="https://www.w3.org/TR/css-values-3/">https://www.w3.org/TR/css-values-3/</a>
        <dt id="biblio-css-values-4">[CSS-VALUES-4]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-4/"><cite>CSS Values and Units
                    Module Level 4</cite></a>. 2022年10月19日. WD. URL: <a
                href="https://www.w3.org/TR/css-values-4/">https://www.w3.org/TR/css-values-4/</a>
        <dt id="biblio-css-writing-modes-4">[CSS-WRITING-MODES-4]
        <dd>Elika Etemad; Koji Ishii. <a href="https://www.w3.org/TR/css-writing-modes-4/"><cite>CSS Writing Modes Level
                    4</cite></a>. 2019年7月30日. CR. URL: <a
                href="https://www.w3.org/TR/css-writing-modes-4/">https://www.w3.org/TR/css-writing-modes-4/</a>
        <dt id="biblio-css2">[CSS2]
        <dd>Bert Bos; et al. <a href="https://www.w3.org/TR/CSS21/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS
                    2.1) Specification</cite></a>. 2011年6月7日. REC. URL: <a
                href="https://www.w3.org/TR/CSS21/">https://www.w3.org/TR/CSS21/</a>
        <dt id="biblio-css3-text-decor">[CSS3-TEXT-DECOR]
        <dd>Elika Etemad; Koji Ishii. <a href="https://www.w3.org/TR/css-text-decor-3/"><cite>CSS Text Decoration Module
                    Level 3</cite></a>. 2022年5月5日. CR. URL: <a
                href="https://www.w3.org/TR/css-text-decor-3/">https://www.w3.org/TR/css-text-decor-3/</a>
        <dt id="biblio-css3-writing-modes">[CSS3-WRITING-MODES]
        <dd>Elika Etemad; Koji Ishii. <a href="https://www.w3.org/TR/css-writing-modes-3/"><cite>CSS Writing Modes Level
                    3</cite></a>. 2019年12月10日. REC. URL: <a
                href="https://www.w3.org/TR/css-writing-modes-3/">https://www.w3.org/TR/css-writing-modes-3/</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>.
            Living Standard. URL: <a
                href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to
                    Indicate Requirement Levels</cite></a>. 1997年3月. Best Current Practice. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">参考情報のある参照</span><a
            class="self-link" href="#informative"></a></h3>
    <dl>
        <dt id="biblio-clreq">[CLREQ]
        <dd>Bobby Tung; et al. <a href="https://www.w3.org/TR/clreq/"><cite>Requirements for Chinese Text Layout -
                    中文排版需求</cite></a>. 2022年10月9日. NOTE. URL: <a
                href="https://www.w3.org/TR/clreq/">https://www.w3.org/TR/clreq/</a>
        <dt id="biblio-css-align-3">[CSS-ALIGN-3]
        <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-align-3/"><cite>CSS Box Alignment Module
                    Level 3</cite></a>. 2021年12月24日. WD. URL: <a
                href="https://www.w3.org/TR/css-align-3/">https://www.w3.org/TR/css-align-3/</a>
        <dt id="biblio-css-flexbox-1">[CSS-FLEXBOX-1]
        <dd>Tab Atkins Jr.; et al. <a href="https://www.w3.org/TR/css-flexbox-1/"><cite>CSS Flexible Box Layout Module
                    Level 1</cite></a>. 2018年11月19日. CR. URL: <a
                href="https://www.w3.org/TR/css-flexbox-1/">https://www.w3.org/TR/css-flexbox-1/</a>
        <dt id="biblio-jis4051">[JIS4051]
        <dd><cite>Formatting rules for Japanese documents (『日本語文書の組版方法』).</cite> 日本規格協会. 2004年. JIS X 4051:2004. 日本語
        <dt id="biblio-jisx4051">[JISX4051]
        <dd><cite>Line composition rules for Japanese documents.</cite> 日本規格協会. 1995年. JIS X 4051-1995. 日本語
        <dt id="biblio-jlreq">[JLREQ]
        <dd>Hiroyuki Chiba; et al. <a href="https://www.w3.org/TR/jlreq/"><cite>Requirements for Japanese Text Layout
                    日本語組版処理の要件(日本語版)</cite></a>. 2020年8月11日. NOTE. URL: <a
                href="https://www.w3.org/TR/jlreq/">https://www.w3.org/TR/jlreq/</a>
        <dt id="biblio-qa-ruby">[QA-RUBY]
        <dd>Richard Ishida. <a href="https://www.w3.org/International/questions/qa-ruby"><cite>What is ruby?</cite></a>.
            URL: <a
                href="https://www.w3.org/International/questions/qa-ruby">https://www.w3.org/International/questions/qa-ruby</a>
        <dt id="biblio-ruby">[RUBY]
        <dd>Marcin Sawicki; et al. <a href="https://www.w3.org/TR/ruby/"><cite>Ruby Annotation</cite></a>. 2001年5月31日.
            REC. URL: <a href="https://www.w3.org/TR/ruby/">https://www.w3.org/TR/ruby/</a>
        <dt id="biblio-simple-ruby">[SIMPLE-RUBY]
        <dd>Florian Rivoal; Atsushi Shimono; Richard Ishida. <a href="https://www.w3.org/TR/simple-ruby/"><cite>Rules
                    for Simple Placement of Japanese Ruby</cite></a>. 2020年6月9日. WD. URL: <a
                href="https://www.w3.org/TR/simple-ruby/">https://www.w3.org/TR/simple-ruby/</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="property-index"><span class="content">プロパティ索引</span><a
            class="self-link" href="#property-index"></a></h2>
    <div class="big-element-wrapper">
        <table class="index">
            <thead>
                <tr>
                    <th scope="col">名前
                    <th scope="col">値
                    <th scope="col">初期値
                    <th scope="col">適用対象
                    <th scope="col">継承
                    <th scope="col">%ages
                    <th scope="col">アニメーション型
                    <th scope="col">正規順序
                    <th scope="col">算出値
            <tbody>
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-ruby-align"
                            id="ref-for-propdef-ruby-align①⑧">ruby-align</a>
                    <td>start | center | space-between | space-around
                    <td>space-around
                    <td>ruby基底, ruby注釈, ruby基底コンテナ, ruby注釈コンテナ
                    <td>yes
                    <td>n/a
                    <td>算出値型による
                    <td>文法順
                    <td>指定キーワード
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-ruby-merge"
                            id="ref-for-propdef-ruby-merge①⑦">ruby-merge</a>
                    <td>separate | merge | auto
                    <td>separate
                    <td>行間ルビ注釈コンテナ
                    <td>yes
                    <td>n/a
                    <td>算出値型による
                    <td>文法順
                    <td>指定キーワード
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-ruby-overhang"
                            id="ref-for-propdef-ruby-overhang③">ruby-overhang</a>
                    <td>auto | none
                    <td>auto
                    <td>ruby注釈コンテナ
                    <td>yes
                    <td>n/a
                    <td>算出値型による
                    <td>文法順
                    <td>指定キーワード
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-ruby-position"
                            id="ref-for-propdef-ruby-position①②">ruby-position</a>
                    <td>[ alternate || [ over | under ] ] | inter-character
                    <td>alternate
                    <td>ruby注釈コンテナ
                    <td>yes
                    <td>n/a
                    <td>離散
                    <td>文法順
                    <td>指定キーワード
        </table>
    </div>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">課題索引</span><a class="self-link"
            href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue"> この目的は、ルビ注釈内での改行を抑制することでレイアウトモデルを単純化することです。
            あるいは、許容可能な挙動を何らか定義することも考えられます。 <a class="issue-return" href="#issue-f0987196" title="Jump to section">↵</a>
        </div>
        <div class="issue"> <a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-inline-3/#propdef-vertical-align">vertical-align</a>
            がこれらのルビボックスにどの程度影響するかを定義する必要があります。
            <a href="https://github.com/w3c/csswg-drafts/issues/4987">Issue 4987</a> を参照。 <a class="issue-return"
                href="#issue-e7399eec" title="Jump to section">↵</a>
        </div>
        <div class="issue"> ブロック軸マージンは折り畳むべきか？
            そうすればレイアウトが堅牢になるが、インライン軸の挙動とは矛盾する。 <a class="issue-return" href="#issue-ea5c17b0"
                title="Jump to section">↵</a></div>
        <div class="issue"> 仕様執筆者の妄想ではなく実際例であることを示すため、スキャン例を挿入すること。 <a class="issue-return" href="#issue-14d7c6b1"
                title="Jump to section">↵</a></div>
        <div class="issue"> 「肩付きルビ」はこの
            <a class="css" data-link-type="maybe" href="#valdef-ruby-align-start">start</a>値に近いが、厳密には同じではありません。
            特に基底をはみ出す場合の挙動は文脈によって異なることがあります。<a
                href="https://www.w3.org/TR/jlreq/#positioning_of_monoruby_with_respect_to_base_characters">JLREQ</a>参照。
            また、これは縦書きでのみ使われ、JLTFでも特に重要とはされていません。
            したがって、この値を肩付きルビに合わせて高度に調整する必要はないかもしれません。
            <span class="css">start</span>が他用途で必要なら残し、そうでなければ削除も検討？ <a class="issue-return" href="#issue-41435749"
                title="Jump to section">↵</a>
        </div>
        <div class="issue"> <a data-link-type="dfn" href="#merged-annotation">マージ注釈</a>によって
            <a data-link-type="dfn" href="#ruby-segments">ルビセグメント</a>全体が広がった場合どうするか？
            現仕様ではすべての基底がスパン扱いで広がるが、例えば複数基底を持つ基底コンテナ内テキストを中央揃えしたい場合に不都合。
            代わりにruby-mergeを基底コンテナにも適用できるようにするか？
            ただしその場合、基底が複数注釈をスパンし得る（基底側がマージで注釈レベルがマージでない場合）・
            あるいは基底をマージにしたら注釈レベルすべてマージ必須……など追加仕様要検討。 <a class="issue-return" href="#issue-70e7253c"
                title="Jump to section">↵</a>
        </div>
        <div class="issue"> 隣接する基底／注釈内容間での装飾描画
            について要明確化。ボックスがカラム幅いっぱいか否かで変わる。 <a class="issue-return" href="#issue-c8497783" title="Jump to section">↵</a>
        </div>
        <div class="issue"> はみ出しと揃えの相互作用については
            場合によってはさらなる検討が必要かもしれません。 <a class="issue-return" href="#issue-adc9f0e4" title="Jump to section">↵</a></div>
    </div>
    <aside class="dfn-panel" data-for="ruby">
        <b><a href="#ruby">#ruby</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-ruby">1.1.
                    What is ruby?</a> <a href="#ref-for-ruby①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-display-ruby">
        <b><a href="#valdef-display-ruby">#valdef-display-ruby</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-display-ruby">2.1.
                    Ruby-specific display Values</a>
            <li><a href="#ref-for-valdef-display-ruby①">2.1.2.
                    Non-Inline Ruby</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="ruby-container">
        <b><a href="#ruby-container">#ruby-container</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-ruby-container">2.1.1.
                    The Ruby Formatting Context</a> <a href="#ref-for-ruby-container①">(2)</a> <a
                    href="#ref-for-ruby-container②">(3)</a> <a href="#ref-for-ruby-container③">(4)</a> <a
                    href="#ref-for-ruby-container④">(5)</a> <a href="#ref-for-ruby-container⑤">(6)</a> <a
                    href="#ref-for-ruby-container⑥">(7)</a> <a href="#ref-for-ruby-container⑦">(8)</a> <a
                    href="#ref-for-ruby-container⑧">(9)</a> <a href="#ref-for-ruby-container⑨">(10)</a>
            <li><a href="#ref-for-ruby-container①⓪">2.1.2.
                    Non-Inline Ruby</a> <a href="#ref-for-ruby-container①①">(2)</a>
            <li><a href="#ref-for-ruby-container①②">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-ruby-container①③">(2)</a> <a
                    href="#ref-for-ruby-container①④">(3)</a> <a href="#ref-for-ruby-container①⑤">(4)</a> <a
                    href="#ref-for-ruby-container①⑥">(5)</a> <a href="#ref-for-ruby-container①⑦">(6)</a> <a
                    href="#ref-for-ruby-container①⑧">(7)</a>
            <li><a href="#ref-for-ruby-container①⑨">2.3.1.
                    Segment Pairing and Annotation Levels</a> <a href="#ref-for-ruby-container②⓪">(2)</a>
            <li><a href="#ref-for-ruby-container②①">2.3.2.
                    Unit Pairing and Spanning Annotations</a>
            <li><a href="#ref-for-ruby-container②②">2.5.
                    White Space Collapsing</a>
            <li><a href="#ref-for-ruby-container②③">3.
                    Ruby Layout</a> <a href="#ref-for-ruby-container②④">(2)</a>
            <li><a href="#ref-for-ruby-container②⑤">3.1.
                    Interlinear Ruby Layout</a>
            <li><a href="#ref-for-ruby-container②⑥">3.1.1.
                    Inline-axis Interlinear Layout</a>
            <li><a href="#ref-for-ruby-container②⑦">3.1.2.
                    Block-axis Interlinear Layout</a> <a href="#ref-for-ruby-container②⑧">(2)</a>
            <li><a href="#ref-for-ruby-container②⑨">3.2.
                    Inter-character Ruby Layout</a>
            <li><a href="#ref-for-ruby-container③⓪">3.3.
                    Styling Ruby Boxes</a>
            <li><a href="#ref-for-ruby-container③①">3.4.
                    Breaking Across Lines</a>
            <li><a href="#ref-for-ruby-container③②">3.4.1.
                    Breaking Between Bases</a>
            <li><a href="#ref-for-ruby-container③③">3.5.
                    Bidi Reordering</a> <a href="#ref-for-ruby-container③④">(2)</a> <a
                    href="#ref-for-ruby-container③⑤">(3)</a> <a href="#ref-for-ruby-container③⑥">(4)</a>
            <li><a href="#ref-for-ruby-container③⑦">3.6.
                    Line Spacing</a> <a href="#ref-for-ruby-container③⑧">(2)</a>
            <li><a href="#ref-for-ruby-container③⑨">4.1.
                    Ruby Positioning: the ruby-position property</a>
            <li><a href="#ref-for-ruby-container④⓪">5.1.
                    Overhanging Ruby: the ruby-overhang property</a> <a href="#ref-for-ruby-container④①">(2)</a> <a
                    href="#ref-for-ruby-container④②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-display-ruby-base">
        <b><a href="#valdef-display-ruby-base">#valdef-display-ruby-base</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-display-ruby-base">2.1.
                    Ruby-specific display Values</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="ruby-base-box">
        <b><a href="#ruby-base-box">#ruby-base-box</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-ruby-base-box">2.
                    Ruby Box Model</a> <a href="#ref-for-ruby-base-box①">(2)</a> <a
                    href="#ref-for-ruby-base-box②">(3)</a>
            <li><a href="#ref-for-ruby-base-box③">2.1.1.
                    The Ruby Formatting Context</a> <a href="#ref-for-ruby-base-box④">(2)</a>
            <li><a href="#ref-for-ruby-base-box⑤">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-ruby-base-box⑥">(2)</a> <a
                    href="#ref-for-ruby-base-box⑦">(3)</a> <a href="#ref-for-ruby-base-box⑧">(4)</a> <a
                    href="#ref-for-ruby-base-box⑨">(5)</a> <a href="#ref-for-ruby-base-box①⓪">(6)</a> <a
                    href="#ref-for-ruby-base-box①①">(7)</a> <a href="#ref-for-ruby-base-box①②">(8)</a> <a
                    href="#ref-for-ruby-base-box①③">(9)</a> <a href="#ref-for-ruby-base-box①④">(10)</a> <a
                    href="#ref-for-ruby-base-box①⑤">(11)</a> <a href="#ref-for-ruby-base-box①⑥">(12)</a>
            <li><a href="#ref-for-ruby-base-box①⑦">2.3.
                    Annotation Pairing</a> <a href="#ref-for-ruby-base-box①⑧">(2)</a> <a
                    href="#ref-for-ruby-base-box①⑨">(3)</a> <a href="#ref-for-ruby-base-box②⓪">(4)</a>
            <li><a href="#ref-for-ruby-base-box②①">2.3.2.
                    Unit Pairing and Spanning Annotations</a> <a href="#ref-for-ruby-base-box②②">(2)</a> <a
                    href="#ref-for-ruby-base-box②③">(3)</a> <a href="#ref-for-ruby-base-box②④">(4)</a> <a
                    href="#ref-for-ruby-base-box②⑤">(5)</a> <a href="#ref-for-ruby-base-box②⑥">(6)</a> <a
                    href="#ref-for-ruby-base-box②⑦">(7)</a> <a href="#ref-for-ruby-base-box②⑧">(8)</a> <a
                    href="#ref-for-ruby-base-box②⑨">(9)</a> <a href="#ref-for-ruby-base-box③⓪">(10)</a>
            <li><a href="#ref-for-ruby-base-box③①">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a>
            <li><a href="#ref-for-ruby-base-box③②">2.5.
                    White Space Collapsing</a> <a href="#ref-for-ruby-base-box③③">(2)</a>
            <li><a href="#ref-for-ruby-base-box③④">3.
                    Ruby Layout</a>
            <li><a href="#ref-for-ruby-base-box③⑤">3.1.
                    Interlinear Ruby Layout</a>
            <li><a href="#ref-for-ruby-base-box③⑥">3.1.1.
                    Inline-axis Interlinear Layout</a> <a href="#ref-for-ruby-base-box③⑦">(2)</a> <a
                    href="#ref-for-ruby-base-box③⑧">(3)</a> <a href="#ref-for-ruby-base-box③⑨">(4)</a> <a
                    href="#ref-for-ruby-base-box④⓪">(5)</a> <a href="#ref-for-ruby-base-box④①">(6)</a> <a
                    href="#ref-for-ruby-base-box④②">(7)</a> <a href="#ref-for-ruby-base-box④③">(8)</a> <a
                    href="#ref-for-ruby-base-box④④">(9)</a> <a href="#ref-for-ruby-base-box④⑤">(10)</a> <a
                    href="#ref-for-ruby-base-box④⑥">(11)</a> <a href="#ref-for-ruby-base-box④⑦">(12)</a>
            <li><a href="#ref-for-ruby-base-box④⑧">3.1.2.
                    Block-axis Interlinear Layout</a> <a href="#ref-for-ruby-base-box④⑨">(2)</a> <a
                    href="#ref-for-ruby-base-box⑤⓪">(3)</a>
            <li><a href="#ref-for-ruby-base-box⑤①">3.2.
                    Inter-character Ruby Layout</a> <a href="#ref-for-ruby-base-box⑤②">(2)</a> <a
                    href="#ref-for-ruby-base-box⑤③">(3)</a> <a href="#ref-for-ruby-base-box⑤④">(4)</a> <a
                    href="#ref-for-ruby-base-box⑤⑤">(5)</a> <a href="#ref-for-ruby-base-box⑤⑥">(6)</a>
            <li><a href="#ref-for-ruby-base-box⑤⑦">3.3.
                    Styling Ruby Boxes</a>
            <li><a href="#ref-for-ruby-base-box⑤⑧">3.4.
                    Breaking Across Lines</a> <a href="#ref-for-ruby-base-box⑤⑨">(2)</a> <a
                    href="#ref-for-ruby-base-box⑥⓪">(3)</a>
            <li><a href="#ref-for-ruby-base-box⑥①">3.4.1.
                    Breaking Between Bases</a> <a href="#ref-for-ruby-base-box⑥②">(2)</a> <a
                    href="#ref-for-ruby-base-box⑥③">(3)</a> <a href="#ref-for-ruby-base-box⑥④">(4)</a> <a
                    href="#ref-for-ruby-base-box⑥⑤">(5)</a> <a href="#ref-for-ruby-base-box⑥⑥">(6)</a>
            <li><a href="#ref-for-ruby-base-box⑥⑦">3.4.2.
                    Breaking Within Bases</a> <a href="#ref-for-ruby-base-box⑥⑧">(2)</a> <a
                    href="#ref-for-ruby-base-box⑥⑨">(3)</a>
            <li><a href="#ref-for-ruby-base-box⑦⓪">3.5.
                    Bidi Reordering</a> <a href="#ref-for-ruby-base-box⑦①">(2)</a> <a
                    href="#ref-for-ruby-base-box⑦②">(3)</a> <a href="#ref-for-ruby-base-box⑦③">(4)</a> <a
                    href="#ref-for-ruby-base-box⑦④">(5)</a>
            <li><a href="#ref-for-ruby-base-box⑦⑤">4.2.
                    Sharing Annotation Space: the ruby-merge property</a> <a href="#ref-for-ruby-base-box⑦⑥">(2)</a> <a
                    href="#ref-for-ruby-base-box⑦⑦">(3)</a>
            <li><a href="#ref-for-ruby-base-box⑦⑧">4.3.
                    Ruby Text Distribution: the ruby-align property</a>
            <li><a href="#ref-for-ruby-base-box⑦⑨">5.1.
                    Overhanging Ruby: the ruby-overhang property</a> <a href="#ref-for-ruby-base-box⑧⓪">(2)</a> <a
                    href="#ref-for-ruby-base-box⑧①">(3)</a>
            <li><a href="#ref-for-ruby-base-box⑧②">5.2.
                    Line-edge Alignment</a>
            <li><a href="#ref-for-ruby-base-box⑧③"> A.3 Generating Parentheses</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-display-ruby-text">
        <b><a href="#valdef-display-ruby-text">#valdef-display-ruby-text</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-display-ruby-text">2.1.
                    Ruby-specific display Values</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="ruby-annotation-box">
        <b><a href="#ruby-annotation-box">#ruby-annotation-box</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-ruby-annotation-box">2.
                    Ruby Box Model</a> <a href="#ref-for-ruby-annotation-box①">(2)</a> <a
                    href="#ref-for-ruby-annotation-box②">(3)</a>
            <li><a href="#ref-for-ruby-annotation-box③">2.1.1.
                    The Ruby Formatting Context</a> <a href="#ref-for-ruby-annotation-box④">(2)</a>
            <li><a href="#ref-for-ruby-annotation-box⑤">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-ruby-annotation-box⑥">(2)</a> <a
                    href="#ref-for-ruby-annotation-box⑦">(3)</a> <a href="#ref-for-ruby-annotation-box⑧">(4)</a> <a
                    href="#ref-for-ruby-annotation-box⑨">(5)</a> <a href="#ref-for-ruby-annotation-box①⓪">(6)</a> <a
                    href="#ref-for-ruby-annotation-box①①">(7)</a> <a href="#ref-for-ruby-annotation-box①②">(8)</a> <a
                    href="#ref-for-ruby-annotation-box①③">(9)</a> <a href="#ref-for-ruby-annotation-box①④">(10)</a> <a
                    href="#ref-for-ruby-annotation-box①⑤">(11)</a> <a href="#ref-for-ruby-annotation-box①⑥">(12)</a>
            <li><a href="#ref-for-ruby-annotation-box①⑦">2.3.
                    Annotation Pairing</a> <a href="#ref-for-ruby-annotation-box①⑧">(2)</a> <a
                    href="#ref-for-ruby-annotation-box①⑨">(3)</a> <a href="#ref-for-ruby-annotation-box②⓪">(4)</a> <a
                    href="#ref-for-ruby-annotation-box②①">(5)</a> <a href="#ref-for-ruby-annotation-box②②">(6)</a>
            <li><a href="#ref-for-ruby-annotation-box②③">2.3.2.
                    Unit Pairing and Spanning Annotations</a> <a href="#ref-for-ruby-annotation-box②④">(2)</a> <a
                    href="#ref-for-ruby-annotation-box②⑤">(3)</a> <a href="#ref-for-ruby-annotation-box②⑥">(4)</a> <a
                    href="#ref-for-ruby-annotation-box②⑦">(5)</a> <a href="#ref-for-ruby-annotation-box②⑧">(6)</a> <a
                    href="#ref-for-ruby-annotation-box②⑨">(7)</a> <a href="#ref-for-ruby-annotation-box③⓪">(8)</a> <a
                    href="#ref-for-ruby-annotation-box③①">(9)</a> <a href="#ref-for-ruby-annotation-box③②">(10)</a> <a
                    href="#ref-for-ruby-annotation-box③③">(11)</a> <a href="#ref-for-ruby-annotation-box③④">(12)</a> <a
                    href="#ref-for-ruby-annotation-box③⑤">(13)</a>
            <li><a href="#ref-for-ruby-annotation-box③⑥">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a> <a
                    href="#ref-for-ruby-annotation-box③⑦">(2)</a> <a href="#ref-for-ruby-annotation-box③⑧">(3)</a> <a
                    href="#ref-for-ruby-annotation-box③⑨">(4)</a>
            <li><a href="#ref-for-ruby-annotation-box④⓪">2.5.
                    White Space Collapsing</a>
            <li><a href="#ref-for-ruby-annotation-box④①">3.1.
                    Interlinear Ruby Layout</a> <a href="#ref-for-ruby-annotation-box④②">(2)</a>
            <li><a href="#ref-for-ruby-annotation-box④③">3.1.1.
                    Inline-axis Interlinear Layout</a> <a href="#ref-for-ruby-annotation-box④④">(2)</a> <a
                    href="#ref-for-ruby-annotation-box④⑤">(3)</a> <a href="#ref-for-ruby-annotation-box④⑥">(4)</a> <a
                    href="#ref-for-ruby-annotation-box④⑦">(5)</a> <a href="#ref-for-ruby-annotation-box④⑧">(6)</a> <a
                    href="#ref-for-ruby-annotation-box④⑨">(7)</a> <a href="#ref-for-ruby-annotation-box⑤⓪">(8)</a> <a
                    href="#ref-for-ruby-annotation-box⑤①">(9)</a> <a href="#ref-for-ruby-annotation-box⑤②">(10)</a> <a
                    href="#ref-for-ruby-annotation-box⑤③">(11)</a>
            <li><a href="#ref-for-ruby-annotation-box⑤④">3.1.2.
                    Block-axis Interlinear Layout</a> <a href="#ref-for-ruby-annotation-box⑤⑤">(2)</a> <a
                    href="#ref-for-ruby-annotation-box⑤⑥">(3)</a> <a href="#ref-for-ruby-annotation-box⑤⑦">(4)</a>
            <li><a href="#ref-for-ruby-annotation-box⑤⑧">3.2.
                    Inter-character Ruby Layout</a> <a href="#ref-for-ruby-annotation-box⑤⑨">(2)</a> <a
                    href="#ref-for-ruby-annotation-box⑥⓪">(3)</a> <a href="#ref-for-ruby-annotation-box⑥①">(4)</a> <a
                    href="#ref-for-ruby-annotation-box⑥②">(5)</a> <a href="#ref-for-ruby-annotation-box⑥③">(6)</a> <a
                    href="#ref-for-ruby-annotation-box⑥④">(7)</a> <a href="#ref-for-ruby-annotation-box⑥⑤">(8)</a> <a
                    href="#ref-for-ruby-annotation-box⑥⑥">(9)</a> <a href="#ref-for-ruby-annotation-box⑥⑦">(10)</a> <a
                    href="#ref-for-ruby-annotation-box⑥⑧">(11)</a>
            <li><a href="#ref-for-ruby-annotation-box⑥⑨">3.3.
                    Styling Ruby Boxes</a>
            <li><a href="#ref-for-ruby-annotation-box⑦⓪">3.4.
                    Breaking Across Lines</a> <a href="#ref-for-ruby-annotation-box⑦①">(2)</a> <a
                    href="#ref-for-ruby-annotation-box⑦②">(3)</a>
            <li><a href="#ref-for-ruby-annotation-box⑦③">3.4.1.
                    Breaking Between Bases</a> <a href="#ref-for-ruby-annotation-box⑦④">(2)</a>
            <li><a href="#ref-for-ruby-annotation-box⑦⑤">3.4.2.
                    Breaking Within Bases</a> <a href="#ref-for-ruby-annotation-box⑦⑥">(2)</a>
            <li><a href="#ref-for-ruby-annotation-box⑦⑦">3.5.
                    Bidi Reordering</a> <a href="#ref-for-ruby-annotation-box⑦⑧">(2)</a> <a
                    href="#ref-for-ruby-annotation-box⑦⑨">(3)</a> <a href="#ref-for-ruby-annotation-box⑧⓪">(4)</a> <a
                    href="#ref-for-ruby-annotation-box⑧①">(5)</a> <a href="#ref-for-ruby-annotation-box⑧②">(6)</a>
            <li><a href="#ref-for-ruby-annotation-box⑧③">3.6.
                    Line Spacing</a> <a href="#ref-for-ruby-annotation-box⑧④">(2)</a> <a
                    href="#ref-for-ruby-annotation-box⑧⑤">(3)</a>
            <li><a href="#ref-for-ruby-annotation-box⑧⑥">4.1.
                    Ruby Positioning: the ruby-position property</a> <a href="#ref-for-ruby-annotation-box⑧⑦">(2)</a> <a
                    href="#ref-for-ruby-annotation-box⑧⑧">(3)</a> <a href="#ref-for-ruby-annotation-box⑧⑨">(4)</a> <a
                    href="#ref-for-ruby-annotation-box⑨⓪">(5)</a> <a href="#ref-for-ruby-annotation-box⑨①">(6)</a> <a
                    href="#ref-for-ruby-annotation-box⑨②">(7)</a>
            <li><a href="#ref-for-ruby-annotation-box⑨③">4.2.
                    Sharing Annotation Space: the ruby-merge property</a> <a
                    href="#ref-for-ruby-annotation-box⑨④">(2)</a> <a href="#ref-for-ruby-annotation-box⑨⑤">(3)</a> <a
                    href="#ref-for-ruby-annotation-box⑨⑥">(4)</a>
            <li><a href="#ref-for-ruby-annotation-box⑨⑦">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a href="#ref-for-ruby-annotation-box⑨⑧">(2)</a>
                <a href="#ref-for-ruby-annotation-box⑨⑨">(3)</a>
            <li><a href="#ref-for-ruby-annotation-box①⓪⓪">5.1.
                    Overhanging Ruby: the ruby-overhang property</a> <a href="#ref-for-ruby-annotation-box①⓪①">(2)</a>
                <a href="#ref-for-ruby-annotation-box①⓪②">(3)</a> <a href="#ref-for-ruby-annotation-box①⓪③">(4)</a> <a
                    href="#ref-for-ruby-annotation-box①⓪④">(5)</a>
            <li><a href="#ref-for-ruby-annotation-box①⓪⑤">5.2.
                    Line-edge Alignment</a> <a href="#ref-for-ruby-annotation-box①⓪⑥">(2)</a>
            <li><a href="#ref-for-ruby-annotation-box①⓪⑦"> Changes since the 2 December 2021 WD</a> <a
                    href="#ref-for-ruby-annotation-box①⓪⑧">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-display-ruby-base-container">
        <b><a href="#valdef-display-ruby-base-container">#valdef-display-ruby-base-container</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-display-ruby-base-container">2.1.
                    Ruby-specific display Values</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="ruby-base-container-box">
        <b><a href="#ruby-base-container-box">#ruby-base-container-box</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-ruby-base-container-box">2.1.1.
                    The Ruby Formatting Context</a>
            <li><a href="#ref-for-ruby-base-container-box①">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-ruby-base-container-box②">(2)</a> <a
                    href="#ref-for-ruby-base-container-box③">(3)</a> <a href="#ref-for-ruby-base-container-box④">(4)</a>
                <a href="#ref-for-ruby-base-container-box⑤">(5)</a> <a href="#ref-for-ruby-base-container-box⑥">(6)</a>
                <a href="#ref-for-ruby-base-container-box⑦">(7)</a> <a href="#ref-for-ruby-base-container-box⑧">(8)</a>
                <a href="#ref-for-ruby-base-container-box⑨">(9)</a> <a
                    href="#ref-for-ruby-base-container-box①⓪">(10)</a> <a
                    href="#ref-for-ruby-base-container-box①①">(11)</a> <a
                    href="#ref-for-ruby-base-container-box①②">(12)</a> <a
                    href="#ref-for-ruby-base-container-box①③">(13)</a>
            <li><a href="#ref-for-ruby-base-container-box①④">2.3.1.
                    Segment Pairing and Annotation Levels</a> <a href="#ref-for-ruby-base-container-box①⑤">(2)</a> <a
                    href="#ref-for-ruby-base-container-box①⑥">(3)</a> <a
                    href="#ref-for-ruby-base-container-box①⑦">(4)</a> <a
                    href="#ref-for-ruby-base-container-box①⑧">(5)</a>
            <li><a href="#ref-for-ruby-base-container-box①⑨">2.3.2.
                    Unit Pairing and Spanning Annotations</a> <a href="#ref-for-ruby-base-container-box②⓪">(2)</a> <a
                    href="#ref-for-ruby-base-container-box②①">(3)</a>
            <li><a href="#ref-for-ruby-base-container-box②②">2.5.
                    White Space Collapsing</a> <a href="#ref-for-ruby-base-container-box②③">(2)</a>
            <li><a href="#ref-for-ruby-base-container-box②④">3.
                    Ruby Layout</a>
            <li><a href="#ref-for-ruby-base-container-box②⑤">3.1.1.
                    Inline-axis Interlinear Layout</a>
            <li><a href="#ref-for-ruby-base-container-box②⑥">3.1.2.
                    Block-axis Interlinear Layout</a> <a href="#ref-for-ruby-base-container-box②⑦">(2)</a> <a
                    href="#ref-for-ruby-base-container-box②⑧">(3)</a> <a
                    href="#ref-for-ruby-base-container-box②⑨">(4)</a> <a
                    href="#ref-for-ruby-base-container-box③⓪">(5)</a>
            <li><a href="#ref-for-ruby-base-container-box③①">3.2.
                    Inter-character Ruby Layout</a>
            <li><a href="#ref-for-ruby-base-container-box③②">3.3.
                    Styling Ruby Boxes</a> <a href="#ref-for-ruby-base-container-box③③">(2)</a>
            <li><a href="#ref-for-ruby-base-container-box③④">3.5.
                    Bidi Reordering</a>
            <li><a href="#ref-for-ruby-base-container-box③⑤">3.6.
                    Line Spacing</a> <a href="#ref-for-ruby-base-container-box③⑥">(2)</a>
            <li><a href="#ref-for-ruby-base-container-box③⑦">5.1.
                    Overhanging Ruby: the ruby-overhang property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-display-ruby-text-container">
        <b><a href="#valdef-display-ruby-text-container">#valdef-display-ruby-text-container</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-display-ruby-text-container">2.1.
                    Ruby-specific display Values</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="ruby-annotation-container-box">
        <b><a href="#ruby-annotation-container-box">#ruby-annotation-container-box</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-ruby-annotation-container-box">2.1.1.
                    The Ruby Formatting Context</a>
            <li><a href="#ref-for-ruby-annotation-container-box①">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-ruby-annotation-container-box②">(2)</a> <a
                    href="#ref-for-ruby-annotation-container-box③">(3)</a> <a
                    href="#ref-for-ruby-annotation-container-box④">(4)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑤">(5)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑥">(6)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑦">(7)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑧">(8)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑨">(9)</a> <a
                    href="#ref-for-ruby-annotation-container-box①⓪">(10)</a>
            <li><a href="#ref-for-ruby-annotation-container-box①①">2.3.1.
                    Segment Pairing and Annotation Levels</a> <a href="#ref-for-ruby-annotation-container-box①②">(2)</a>
                <a href="#ref-for-ruby-annotation-container-box①③">(3)</a> <a
                    href="#ref-for-ruby-annotation-container-box①④">(4)</a> <a
                    href="#ref-for-ruby-annotation-container-box①⑤">(5)</a>
            <li><a href="#ref-for-ruby-annotation-container-box①⑥">2.3.2.
                    Unit Pairing and Spanning Annotations</a> <a href="#ref-for-ruby-annotation-container-box①⑦">(2)</a>
                <a href="#ref-for-ruby-annotation-container-box①⑧">(3)</a> <a
                    href="#ref-for-ruby-annotation-container-box①⑨">(4)</a> <a
                    href="#ref-for-ruby-annotation-container-box②⓪">(5)</a>
            <li><a href="#ref-for-ruby-annotation-container-box②①">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a>
            <li><a href="#ref-for-ruby-annotation-container-box②②">2.5.
                    White Space Collapsing</a> <a href="#ref-for-ruby-annotation-container-box②③">(2)</a> <a
                    href="#ref-for-ruby-annotation-container-box②④">(3)</a>
            <li><a href="#ref-for-ruby-annotation-container-box②⑤">3.1.1.
                    Inline-axis Interlinear Layout</a> <a href="#ref-for-ruby-annotation-container-box②⑥">(2)</a> <a
                    href="#ref-for-ruby-annotation-container-box②⑦">(3)</a> <a
                    href="#ref-for-ruby-annotation-container-box②⑧">(4)</a> <a
                    href="#ref-for-ruby-annotation-container-box②⑨">(5)</a> <a
                    href="#ref-for-ruby-annotation-container-box③⓪">(6)</a>
            <li><a href="#ref-for-ruby-annotation-container-box③①">3.1.2.
                    Block-axis Interlinear Layout</a> <a href="#ref-for-ruby-annotation-container-box③②">(2)</a> <a
                    href="#ref-for-ruby-annotation-container-box③③">(3)</a> <a
                    href="#ref-for-ruby-annotation-container-box③④">(4)</a> <a
                    href="#ref-for-ruby-annotation-container-box③⑤">(5)</a>
            <li><a href="#ref-for-ruby-annotation-container-box③⑥">3.2.
                    Inter-character Ruby Layout</a> <a href="#ref-for-ruby-annotation-container-box③⑦">(2)</a>
            <li><a href="#ref-for-ruby-annotation-container-box③⑧">3.3.
                    Styling Ruby Boxes</a> <a href="#ref-for-ruby-annotation-container-box③⑨">(2)</a> <a
                    href="#ref-for-ruby-annotation-container-box④⓪">(3)</a>
            <li><a href="#ref-for-ruby-annotation-container-box④①">3.5.
                    Bidi Reordering</a> <a href="#ref-for-ruby-annotation-container-box④②">(2)</a> <a
                    href="#ref-for-ruby-annotation-container-box④③">(3)</a> <a
                    href="#ref-for-ruby-annotation-container-box④④">(4)</a>
            <li><a href="#ref-for-ruby-annotation-container-box④⑤">3.6.
                    Line Spacing</a> <a href="#ref-for-ruby-annotation-container-box④⑥">(2)</a> <a
                    href="#ref-for-ruby-annotation-container-box④⑦">(3)</a>
            <li><a href="#ref-for-ruby-annotation-container-box④⑧">4.1.
                    Ruby Positioning: the ruby-position property</a> <a
                    href="#ref-for-ruby-annotation-container-box④⑨">(2)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑤⓪">(3)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑤①">(4)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑤②">(5)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑤③">(6)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑤④">(7)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑤⑤">(8)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑤⑥">(9)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑤⑦">(10)</a>
            <li><a href="#ref-for-ruby-annotation-container-box⑤⑧">4.2.
                    Sharing Annotation Space: the ruby-merge property</a>
            <li><a href="#ref-for-ruby-annotation-container-box⑤⑨">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a
                    href="#ref-for-ruby-annotation-container-box⑥⓪">(2)</a>
            <li><a href="#ref-for-ruby-annotation-container-box⑥①">5.1.
                    Overhanging Ruby: the ruby-overhang property</a> <a
                    href="#ref-for-ruby-annotation-container-box⑥②">(2)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑥③">(3)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑥④">(4)</a> <a
                    href="#ref-for-ruby-annotation-container-box⑥⑤">(5)</a>
            <li><a href="#ref-for-ruby-annotation-container-box⑥⑥"> Changes since the 2 December 2021 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="ruby-formatting-context">
        <b><a href="#ruby-formatting-context">#ruby-formatting-context</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-ruby-formatting-context">2.1.1.
                    The Ruby Formatting Context</a> <a href="#ref-for-ruby-formatting-context①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="internal-ruby-boxes">
        <b><a href="#internal-ruby-boxes">#internal-ruby-boxes</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-internal-ruby-boxes">2.1.1.
                    The Ruby Formatting Context</a>
            <li><a href="#ref-for-internal-ruby-boxes①">2.1.2.
                    Non-Inline Ruby</a>
            <li><a href="#ref-for-internal-ruby-boxes②">3.5.
                    Bidi Reordering</a> <a href="#ref-for-internal-ruby-boxes③">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intra-ruby-white-space">
        <b><a href="#intra-ruby-white-space">#intra-ruby-white-space</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-intra-ruby-white-space">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-intra-ruby-white-space①">(2)</a> <a
                    href="#ref-for-intra-ruby-white-space②">(3)</a> <a href="#ref-for-intra-ruby-white-space③">(4)</a>
            <li><a href="#ref-for-intra-ruby-white-space④">2.3.2.
                    Unit Pairing and Spanning Annotations</a> <a href="#ref-for-intra-ruby-white-space⑤">(2)</a> <a
                    href="#ref-for-intra-ruby-white-space⑥">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="inter-base-white-space">
        <b><a href="#inter-base-white-space">#inter-base-white-space</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-inter-base-white-space">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-inter-base-white-space①">(2)</a>
            <li><a href="#ref-for-inter-base-white-space②">2.5.
                    White Space Collapsing</a>
            <li><a href="#ref-for-inter-base-white-space③">3.2.
                    Inter-character Ruby Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="inter-annotation-white-space">
        <b><a href="#inter-annotation-white-space">#inter-annotation-white-space</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-inter-annotation-white-space">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-inter-annotation-white-space①">(2)</a>
            <li><a href="#ref-for-inter-annotation-white-space②">2.5.
                    White Space Collapsing</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="inter-segment-white-space">
        <b><a href="#inter-segment-white-space">#inter-segment-white-space</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-inter-segment-white-space">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-inter-segment-white-space①">(2)</a>
            <li><a href="#ref-for-inter-segment-white-space②">2.3.1.
                    Segment Pairing and Annotation Levels</a>
            <li><a href="#ref-for-inter-segment-white-space③">2.5.
                    White Space Collapsing</a> <a href="#ref-for-inter-segment-white-space④">(2)</a>
            <li><a href="#ref-for-inter-segment-white-space⑤">3.2.
                    Inter-character Ruby Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intra-level-white-space">
        <b><a href="#intra-level-white-space">#intra-level-white-space</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-intra-level-white-space">2.2.
                    Anonymous Ruby Box Generation</a>
            <li><a href="#ref-for-intra-level-white-space①">2.3.2.
                    Unit Pairing and Spanning Annotations</a> <a href="#ref-for-intra-level-white-space②">(2)</a> <a
                    href="#ref-for-intra-level-white-space③">(3)</a> <a href="#ref-for-intra-level-white-space④">(4)</a>
                <a href="#ref-for-intra-level-white-space⑤">(5)</a> <a href="#ref-for-intra-level-white-space⑥">(6)</a>
                <a href="#ref-for-intra-level-white-space⑦">(7)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="pairing">
        <b><a href="#pairing">#pairing</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-pairing">1.1.
                    What is ruby?</a>
            <li><a href="#ref-for-pairing①">2.2.
                    Anonymous Ruby Box Generation</a> <a href="#ref-for-pairing②">(2)</a>
            <li><a href="#ref-for-pairing③">2.3.
                    Annotation Pairing</a>
            <li><a href="#ref-for-pairing④">2.3.2.
                    Unit Pairing and Spanning Annotations</a> <a href="#ref-for-pairing⑤">(2)</a>
            <li><a href="#ref-for-pairing⑥">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a>
            <li><a href="#ref-for-pairing⑦"> Changes since the 5 August 2014 WD</a>
            <li><a href="#ref-for-pairing⑧"> Changes since the 19 September 2013 WD</a> <a
                    href="#ref-for-pairing⑨">(2)</a>
            <li><a href="#ref-for-pairing①⓪"> Changes since the 30 June 2011 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="span">
        <b><a href="#span">#span</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-span">2.3.
                    Annotation Pairing</a>
            <li><a href="#ref-for-span①">2.3.2.
                    Unit Pairing and Spanning Annotations</a>
            <li><a href="#ref-for-span②">3.1.1.
                    Inline-axis Interlinear Layout</a>
            <li><a href="#ref-for-span③">3.2.
                    Inter-character Ruby Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="spanning-annotation">
        <b><a href="#spanning-annotation">#spanning-annotation</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-spanning-annotation">2.3.2.
                    Unit Pairing and Spanning Annotations</a>
            <li><a href="#ref-for-spanning-annotation①">3.1.1.
                    Inline-axis Interlinear Layout</a> <a href="#ref-for-spanning-annotation②">(2)</a> <a
                    href="#ref-for-spanning-annotation③">(3)</a> <a href="#ref-for-spanning-annotation④">(4)</a> <a
                    href="#ref-for-spanning-annotation⑤">(5)</a> <a href="#ref-for-spanning-annotation⑥">(6)</a> <a
                    href="#ref-for-spanning-annotation⑦">(7)</a> <a href="#ref-for-spanning-annotation⑧">(8)</a> <a
                    href="#ref-for-spanning-annotation⑨">(9)</a> <a href="#ref-for-spanning-annotation①⓪">(10)</a> <a
                    href="#ref-for-spanning-annotation①①">(11)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="ruby-columns">
        <b><a href="#ruby-columns">#ruby-columns</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-ruby-columns">2.
                    Ruby Box Model</a>
            <li><a href="#ref-for-ruby-columns①">2.3.2.
                    Unit Pairing and Spanning Annotations</a>
            <li><a href="#ref-for-ruby-columns②">3.1.1.
                    Inline-axis Interlinear Layout</a> <a href="#ref-for-ruby-columns③">(2)</a> <a
                    href="#ref-for-ruby-columns④">(3)</a> <a href="#ref-for-ruby-columns⑤">(4)</a> <a
                    href="#ref-for-ruby-columns⑥">(5)</a> <a href="#ref-for-ruby-columns⑦">(6)</a> <a
                    href="#ref-for-ruby-columns⑧">(7)</a> <a href="#ref-for-ruby-columns⑨">(8)</a> <a
                    href="#ref-for-ruby-columns①⓪">(9)</a> <a href="#ref-for-ruby-columns①①">(10)</a> <a
                    href="#ref-for-ruby-columns①②">(11)</a>
            <li><a href="#ref-for-ruby-columns①③">3.2.
                    Inter-character Ruby Layout</a> <a href="#ref-for-ruby-columns①④">(2)</a>
            <li><a href="#ref-for-ruby-columns①⑤">4.2.
                    Sharing Annotation Space: the ruby-merge property</a>
            <li><a href="#ref-for-ruby-columns①⑥">4.4.
                    Ruby Text Decoration</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="ruby-segments">
        <b><a href="#ruby-segments">#ruby-segments</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-ruby-segments">2.
                    Ruby Box Model</a> <a href="#ref-for-ruby-segments①">(2)</a> <a
                    href="#ref-for-ruby-segments②">(3)</a> <a href="#ref-for-ruby-segments③">(4)</a>
            <li><a href="#ref-for-ruby-segments④">2.3.
                    Annotation Pairing</a>
            <li><a href="#ref-for-ruby-segments⑤">2.3.1.
                    Segment Pairing and Annotation Levels</a> <a href="#ref-for-ruby-segments⑥">(2)</a>
            <li><a href="#ref-for-ruby-segments⑦">2.3.2.
                    Unit Pairing and Spanning Annotations</a> <a href="#ref-for-ruby-segments⑧">(2)</a> <a
                    href="#ref-for-ruby-segments⑨">(3)</a>
            <li><a href="#ref-for-ruby-segments①⓪">2.5.
                    White Space Collapsing</a> <a href="#ref-for-ruby-segments①①">(2)</a> <a
                    href="#ref-for-ruby-segments①②">(3)</a>
            <li><a href="#ref-for-ruby-segments①③">3.1.1.
                    Inline-axis Interlinear Layout</a> <a href="#ref-for-ruby-segments①④">(2)</a>
            <li><a href="#ref-for-ruby-segments①⑤">3.5.
                    Bidi Reordering</a>
            <li><a href="#ref-for-ruby-segments①⑥">4.1.
                    Ruby Positioning: the ruby-position property</a>
            <li><a href="#ref-for-ruby-segments①⑦">4.2.
                    Sharing Annotation Space: the ruby-merge property</a>
            <li><a href="#ref-for-ruby-segments①⑧">4.3.
                    Ruby Text Distribution: the ruby-align property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="annotation-level">
        <b><a href="#annotation-level">#annotation-level</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-annotation-level">2.
                    Ruby Box Model</a>
            <li><a href="#ref-for-annotation-level①">2.3.
                    Annotation Pairing</a> <a href="#ref-for-annotation-level②">(2)</a> <a
                    href="#ref-for-annotation-level③">(3)</a>
            <li><a href="#ref-for-annotation-level④">3.1.
                    Interlinear Ruby Layout</a>
            <li><a href="#ref-for-annotation-level⑤">3.1.1.
                    Inline-axis Interlinear Layout</a>
            <li><a href="#ref-for-annotation-level⑥">3.1.2.
                    Block-axis Interlinear Layout</a>
            <li><a href="#ref-for-annotation-level⑦">3.2.
                    Inter-character Ruby Layout</a>
            <li><a href="#ref-for-annotation-level⑧">4.1.
                    Ruby Positioning: the ruby-position property</a> <a href="#ref-for-annotation-level⑨">(2)</a> <a
                    href="#ref-for-annotation-level①⓪">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="base-level">
        <b><a href="#base-level">#base-level</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-base-level">2.
                    Ruby Box Model</a>
            <li><a href="#ref-for-base-level①">3.
                    Ruby Layout</a> <a href="#ref-for-base-level②">(2)</a>
            <li><a href="#ref-for-base-level③">3.2.
                    Inter-character Ruby Layout</a>
            <li><a href="#ref-for-base-level④">3.4.1.
                    Breaking Between Bases</a>
            <li><a href="#ref-for-base-level⑤">4.4.
                    Ruby Text Decoration</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="hidden-annotation">
        <b><a href="#hidden-annotation">#hidden-annotation</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-hidden-annotation">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a> <a
                    href="#ref-for-hidden-annotation①">(2)</a> <a href="#ref-for-hidden-annotation②">(3)</a> <a
                    href="#ref-for-hidden-annotation③">(4)</a> <a href="#ref-for-hidden-annotation④">(5)</a> <a
                    href="#ref-for-hidden-annotation⑤">(6)</a> <a href="#ref-for-hidden-annotation⑥">(7)</a> <a
                    href="#ref-for-hidden-annotation⑦">(8)</a>
            <li><a href="#ref-for-hidden-annotation⑧">2.5.
                    White Space Collapsing</a>
            <li><a href="#ref-for-hidden-annotation⑨"> Changes since the 29 April 2020 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="auto-hidden">
        <b><a href="#auto-hidden">#auto-hidden</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-auto-hidden">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a> <a
                    href="#ref-for-auto-hidden①">(2)</a>
            <li><a href="#ref-for-auto-hidden②"> Changes since the 29 April 2020 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="propdef-ruby-position">
        <b><a href="#propdef-ruby-position">#propdef-ruby-position</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-propdef-ruby-position">1.2.
                    Module interactions</a>
            <li><a href="#ref-for-propdef-ruby-position①">3.1.2.
                    Block-axis Interlinear Layout</a>
            <li><a href="#ref-for-propdef-ruby-position②">4.1.
                    Ruby Positioning: the ruby-position property</a> <a href="#ref-for-propdef-ruby-position③">(2)</a>
                <a href="#ref-for-propdef-ruby-position④">(3)</a> <a href="#ref-for-propdef-ruby-position⑤">(4)</a>
            <li><a href="#ref-for-propdef-ruby-position⑥">4.2.
                    Sharing Annotation Space: the ruby-merge property</a>
            <li><a href="#ref-for-propdef-ruby-position⑦"> Changes since the 29 April 2020 WD</a>
            <li><a href="#ref-for-propdef-ruby-position⑧"> Changes since the 5 August 2014 WD</a> <a
                    href="#ref-for-propdef-ruby-position⑨">(2)</a>
            <li><a href="#ref-for-propdef-ruby-position①⓪"> Changes since the 30 June 2011 WD</a> <a
                    href="#ref-for-propdef-ruby-position①①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-ruby-position-alternate">
        <b><a href="#valdef-ruby-position-alternate">#valdef-ruby-position-alternate</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-ruby-position-alternate">4.1.
                    Ruby Positioning: the ruby-position property</a> <a
                    href="#ref-for-valdef-ruby-position-alternate①">(2)</a> <a
                    href="#ref-for-valdef-ruby-position-alternate②">(3)</a> <a
                    href="#ref-for-valdef-ruby-position-alternate③">(4)</a>
            <li><a href="#ref-for-valdef-ruby-position-alternate④"> Changes since the 29 April 2020 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-ruby-position-over">
        <b><a href="#valdef-ruby-position-over">#valdef-ruby-position-over</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-ruby-position-over">4.1.
                    Ruby Positioning: the ruby-position property</a> <a
                    href="#ref-for-valdef-ruby-position-over①">(2)</a> <a
                    href="#ref-for-valdef-ruby-position-over②">(3)</a> <a
                    href="#ref-for-valdef-ruby-position-over③">(4)</a> <a
                    href="#ref-for-valdef-ruby-position-over④">(5)</a> <a
                    href="#ref-for-valdef-ruby-position-over⑤">(6)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-ruby-position-under">
        <b><a href="#valdef-ruby-position-under">#valdef-ruby-position-under</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-ruby-position-under">4.1.
                    Ruby Positioning: the ruby-position property</a> <a
                    href="#ref-for-valdef-ruby-position-under①">(2)</a> <a
                    href="#ref-for-valdef-ruby-position-under②">(3)</a> <a
                    href="#ref-for-valdef-ruby-position-under③">(4)</a> <a
                    href="#ref-for-valdef-ruby-position-under④">(5)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-ruby-position-inter-character">
        <b><a href="#valdef-ruby-position-inter-character">#valdef-ruby-position-inter-character</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-valdef-ruby-position-inter-character">3.2.
                    Inter-character Ruby Layout</a>
            <li><a href="#ref-for-valdef-ruby-position-inter-character①">3.4.
                    Breaking Across Lines</a>
            <li><a href="#ref-for-valdef-ruby-position-inter-character②">4.1.
                    Ruby Positioning: the ruby-position property</a>
            <li><a href="#ref-for-valdef-ruby-position-inter-character③"> Changes since the 30 June 2011 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="ruby-position-inter-character-annotation">
        <b><a
                href="#ruby-position-inter-character-annotation">#ruby-position-inter-character-annotation</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-ruby-position-inter-character-annotation">2.5.
                    White Space Collapsing</a>
            <li><a href="#ref-for-ruby-position-inter-character-annotation①">3.
                    Ruby Layout</a>
            <li><a href="#ref-for-ruby-position-inter-character-annotation②">3.1.1.
                    Inline-axis Interlinear Layout</a>
            <li><a href="#ref-for-ruby-position-inter-character-annotation③">3.1.2.
                    Block-axis Interlinear Layout</a>
            <li><a href="#ref-for-ruby-position-inter-character-annotation④">3.2.
                    Inter-character Ruby Layout</a> <a href="#ref-for-ruby-position-inter-character-annotation⑤">(2)</a>
                <a href="#ref-for-ruby-position-inter-character-annotation⑥">(3)</a> <a
                    href="#ref-for-ruby-position-inter-character-annotation⑦">(4)</a> <a
                    href="#ref-for-ruby-position-inter-character-annotation⑧">(5)</a> <a
                    href="#ref-for-ruby-position-inter-character-annotation⑨">(6)</a> <a
                    href="#ref-for-ruby-position-inter-character-annotation①⓪">(7)</a> <a
                    href="#ref-for-ruby-position-inter-character-annotation①①">(8)</a> <a
                    href="#ref-for-ruby-position-inter-character-annotation①②">(9)</a>
            <li><a href="#ref-for-ruby-position-inter-character-annotation①③">3.4.
                    Breaking Across Lines</a>
            <li><a href="#ref-for-ruby-position-inter-character-annotation①④">3.4.2.
                    Breaking Within Bases</a>
            <li><a href="#ref-for-ruby-position-inter-character-annotation①⑤">4.1.
                    Ruby Positioning: the ruby-position property</a> <a
                    href="#ref-for-ruby-position-inter-character-annotation①⑥">(2)</a> <a
                    href="#ref-for-ruby-position-inter-character-annotation①⑦">(3)</a>
            <li><a href="#ref-for-ruby-position-inter-character-annotation①⑧">4.2.
                    Sharing Annotation Space: the ruby-merge property</a>
            <li><a href="#ref-for-ruby-position-inter-character-annotation①⑨">4.3.
                    Ruby Text Distribution: the ruby-align property</a>
            <li><a href="#ref-for-ruby-position-inter-character-annotation②⓪"> Changes since the 2 December 2021 WD</a>
            <li><a href="#ref-for-ruby-position-inter-character-annotation②①"> Changes since the 29 April 2020 WD</a> <a
                    href="#ref-for-ruby-position-inter-character-annotation②②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="interlinear-annotations">
        <b><a href="#interlinear-annotations">#interlinear-annotations</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-interlinear-annotations">2.3.
                    Annotation Pairing</a>
            <li><a href="#ref-for-interlinear-annotations①">2.5.
                    White Space Collapsing</a>
            <li><a href="#ref-for-interlinear-annotations②">3.
                    Ruby Layout</a>
            <li><a href="#ref-for-interlinear-annotations③">3.1.
                    Interlinear Ruby Layout</a>
            <li><a href="#ref-for-interlinear-annotations④">3.1.1.
                    Inline-axis Interlinear Layout</a> <a href="#ref-for-interlinear-annotations⑤">(2)</a>
            <li><a href="#ref-for-interlinear-annotations⑥">3.1.2.
                    Block-axis Interlinear Layout</a>
            <li><a href="#ref-for-interlinear-annotations⑦">4.1.
                    Ruby Positioning: the ruby-position property</a>
            <li><a href="#ref-for-interlinear-annotations⑧">4.2.
                    Sharing Annotation Space: the ruby-merge property</a>
            <li><a href="#ref-for-interlinear-annotations⑨"> Changes since the 29 April 2020 WD</a> <a
                    href="#ref-for-interlinear-annotations①⓪">(2)</a> <a
                    href="#ref-for-interlinear-annotations①①">(3)</a> <a
                    href="#ref-for-interlinear-annotations①②">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="propdef-ruby-merge">
        <b><a href="#propdef-ruby-merge">#propdef-ruby-merge</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-propdef-ruby-merge">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a>
            <li><a href="#ref-for-propdef-ruby-merge①">3.1.1.
                    Inline-axis Interlinear Layout</a> <a href="#ref-for-propdef-ruby-merge②">(2)</a> <a
                    href="#ref-for-propdef-ruby-merge③">(3)</a> <a href="#ref-for-propdef-ruby-merge④">(4)</a>
            <li><a href="#ref-for-propdef-ruby-merge⑤">3.5.
                    Bidi Reordering</a>
            <li><a href="#ref-for-propdef-ruby-merge⑥">4.2.
                    Sharing Annotation Space: the ruby-merge property</a> <a href="#ref-for-propdef-ruby-merge⑦">(2)</a>
                <a href="#ref-for-propdef-ruby-merge⑧">(3)</a> <a href="#ref-for-propdef-ruby-merge⑨">(4)</a>
            <li><a href="#ref-for-propdef-ruby-merge①⓪">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a href="#ref-for-propdef-ruby-merge①①">(2)</a>
                <a href="#ref-for-propdef-ruby-merge①②">(3)</a>
            <li><a href="#ref-for-propdef-ruby-merge①③">5.1.
                    Overhanging Ruby: the ruby-overhang property</a>
            <li><a href="#ref-for-propdef-ruby-merge①④"> Changes since the 29 April 2020 WD</a>
            <li><a href="#ref-for-propdef-ruby-merge①⑤"> Changes since the 5 August 2014 WD</a>
            <li><a href="#ref-for-propdef-ruby-merge①⑥"> Changes since the 30 June 2011 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="merged-annotation">
        <b><a href="#merged-annotation">#merged-annotation</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-merged-annotation">1.1.
                    What is ruby?</a>
            <li><a href="#ref-for-merged-annotation①">3.1.1.
                    Inline-axis Interlinear Layout</a>
            <li><a href="#ref-for-merged-annotation②">3.5.
                    Bidi Reordering</a> <a href="#ref-for-merged-annotation③">(2)</a> <a
                    href="#ref-for-merged-annotation④">(3)</a>
            <li><a href="#ref-for-merged-annotation⑤">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a href="#ref-for-merged-annotation⑥">(2)</a>
            <li><a href="#ref-for-merged-annotation⑦"> Changes since the 29 April 2020 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-ruby-merge-separate">
        <b><a href="#valdef-ruby-merge-separate">#valdef-ruby-merge-separate</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-ruby-merge-separate">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a>
            <li><a href="#ref-for-valdef-ruby-merge-separate①">3.1.1.
                    Inline-axis Interlinear Layout</a>
            <li><a href="#ref-for-valdef-ruby-merge-separate②">4.2.
                    Sharing Annotation Space: the ruby-merge property</a> <a
                    href="#ref-for-valdef-ruby-merge-separate③">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-ruby-merge-merge">
        <b><a href="#valdef-ruby-merge-merge">#valdef-ruby-merge-merge</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-ruby-merge-merge">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a>
            <li><a href="#ref-for-valdef-ruby-merge-merge①">3.5.
                    Bidi Reordering</a>
            <li><a href="#ref-for-valdef-ruby-merge-merge②">4.2.
                    Sharing Annotation Space: the ruby-merge property</a>
            <li><a href="#ref-for-valdef-ruby-merge-merge③"> Changes since the 29 April 2020 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-ruby-merge-auto">
        <b><a href="#valdef-ruby-merge-auto">#valdef-ruby-merge-auto</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-ruby-merge-auto">2.4.
                    Hiding Annotations: visibility: collapse and auto-hidden ruby</a>
            <li><a href="#ref-for-valdef-ruby-merge-auto①">4.3.
                    Ruby Text Distribution: the ruby-align property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="propdef-ruby-align">
        <b><a href="#propdef-ruby-align">#propdef-ruby-align</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-propdef-ruby-align">3.1.1.
                    Inline-axis Interlinear Layout</a> <a href="#ref-for-propdef-ruby-align①">(2)</a> <a
                    href="#ref-for-propdef-ruby-align②">(3)</a> <a href="#ref-for-propdef-ruby-align③">(4)</a> <a
                    href="#ref-for-propdef-ruby-align④">(5)</a> <a href="#ref-for-propdef-ruby-align⑤">(6)</a>
            <li><a href="#ref-for-propdef-ruby-align⑥">3.2.
                    Inter-character Ruby Layout</a> <a href="#ref-for-propdef-ruby-align⑦">(2)</a>
            <li><a href="#ref-for-propdef-ruby-align⑧">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a href="#ref-for-propdef-ruby-align⑨">(2)</a>
                <a href="#ref-for-propdef-ruby-align①⓪">(3)</a> <a href="#ref-for-propdef-ruby-align①①">(4)</a> <a
                    href="#ref-for-propdef-ruby-align①②">(5)</a>
            <li><a href="#ref-for-propdef-ruby-align①③">5.1.
                    Overhanging Ruby: the ruby-overhang property</a>
            <li><a href="#ref-for-propdef-ruby-align①④"> Changes since the 29 April 2020 WD</a> <a
                    href="#ref-for-propdef-ruby-align①⑤">(2)</a>
            <li><a href="#ref-for-propdef-ruby-align①⑥"> Changes since the 30 June 2011 WD</a> <a
                    href="#ref-for-propdef-ruby-align①⑦">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-ruby-align-start">
        <b><a href="#valdef-ruby-align-start">#valdef-ruby-align-start</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-ruby-align-start">3.2.
                    Inter-character Ruby Layout</a>
            <li><a href="#ref-for-valdef-ruby-align-start①">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a
                    href="#ref-for-valdef-ruby-align-start②">(2)</a> <a href="#ref-for-valdef-ruby-align-start③">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-ruby-align-center">
        <b><a href="#valdef-ruby-align-center">#valdef-ruby-align-center</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-ruby-align-center">4.3.
                    Ruby Text Distribution: the ruby-align property</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-ruby-align-space-between">
        <b><a href="#valdef-ruby-align-space-between">#valdef-ruby-align-space-between</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-ruby-align-space-between">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a
                    href="#ref-for-valdef-ruby-align-space-between①">(2)</a> <a
                    href="#ref-for-valdef-ruby-align-space-between②">(3)</a> <a
                    href="#ref-for-valdef-ruby-align-space-between③">(4)</a>
            <li><a href="#ref-for-valdef-ruby-align-space-between④"> Changes since the 30 June 2011 WD</a> <a
                    href="#ref-for-valdef-ruby-align-space-between⑤">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="valdef-ruby-align-space-around">
        <b><a href="#valdef-ruby-align-space-around">#valdef-ruby-align-space-around</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-ruby-align-space-around">4.3.
                    Ruby Text Distribution: the ruby-align property</a> <a
                    href="#ref-for-valdef-ruby-align-space-around①">(2)</a> <a
                    href="#ref-for-valdef-ruby-align-space-around②">(3)</a>
            <li><a href="#ref-for-valdef-ruby-align-space-around③"> Changes since the 30 June 2011 WD</a> <a
                    href="#ref-for-valdef-ruby-align-space-around④">(2)</a> <a
                    href="#ref-for-valdef-ruby-align-space-around⑤">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="propdef-ruby-overhang">
        <b><a href="#propdef-ruby-overhang">#propdef-ruby-overhang</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-propdef-ruby-overhang">5.1.
                    Overhanging Ruby: the ruby-overhang property</a> <a href="#ref-for-propdef-ruby-overhang①">(2)</a>
            <li><a href="#ref-for-propdef-ruby-overhang②"> Changes since the 5 August 2014 WD</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="bopomofo-tone-marks">
        <b><a href="#bopomofo-tone-marks">#bopomofo-tone-marks</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-bopomofo-tone-marks">6.
                    Glossary</a> <a href="#ref-for-bopomofo-tone-marks①">(2)</a>
        </ul>
    </aside>
    <script>/* script-dfn-panel */

        document.body.addEventListener("click", function (e) {
            var queryAll = function (sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while (el.parentElement) {
                if (el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if (el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if (el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if (target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function (el) {
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if (target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if (dfnPanel) {
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if (panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if (target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
    </script>
    <script src="https://htmlspecs.com/dropdown.js"></script>