<!doctype html>
<html lang="ja-JP">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>CSS 条件規則モジュール レベル 4</title>
    <meta content="CRD" name="w3c-status">
    <meta content="Bikeshed version b25686b9f, updated Fri Mar 14 14:15:20 2025 -0700" name="generator">
    <link href="https://www.w3.org/TR/css-conditional-4/" rel="canonical">
    <meta content="48345f7040afb7e4737eeb74bb8e1fbf04507034" name="revision">
    <meta content="dark light" name="color-scheme">
    <style>
        /* Boilerplate: style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-colors */
        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* Boilerplate: style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-selflinks */
        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* Boilerplate: style-syntax-highlighting */
        code.highlight {
            padding: .1em;
            border-radius: .3em;
        }

        pre.highlight,
        pre>code.highlight {
            display: block;
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
            border-radius: 0;
        }

        .highlight:not(.idl) {
            background: rgba(0, 0, 0, .03);
        }

        c-[a] {
            color: #990055
        }

        /* Keyword.Declaration */
        c-[b] {
            color: #990055
        }

        /* Keyword.Type */
        c-[c] {
            color: #708090
        }

        /* Comment */
        c-[d] {
            color: #708090
        }

        /* Comment.Multiline */
        c-[e] {
            color: #0077aa
        }

        /* Name.Attribute */
        c-[f] {
            color: #669900
        }

        /* Name.Tag */
        c-[g] {
            color: #222222
        }

        /* Name.Variable */
        c-[k] {
            color: #990055
        }

        /* Keyword */
        c-[l] {
            color: #000000
        }

        /* Literal */
        c-[m] {
            color: #000000
        }

        /* Literal.Number */
        c-[n] {
            color: #0077aa
        }

        /* Name */
        c-[o] {
            color: #999999
        }

        /* Operator */
        c-[p] {
            color: #999999
        }

        /* Punctuation */
        c-[s] {
            color: #a67f59
        }

        /* Literal.String */
        c-[t] {
            color: #a67f59
        }

        /* Literal.String.Single */
        c-[u] {
            color: #a67f59
        }

        /* Literal.String.Double */
        c-[cp] {
            color: #708090
        }

        /* Comment.Preproc */
        c-[c1] {
            color: #708090
        }

        /* Comment.Single */
        c-[cs] {
            color: #708090
        }

        /* Comment.Special */
        c-[kc] {
            color: #990055
        }

        /* Keyword.Constant */
        c-[kn] {
            color: #990055
        }

        /* Keyword.Namespace */
        c-[kp] {
            color: #990055
        }

        /* Keyword.Pseudo */
        c-[kr] {
            color: #990055
        }

        /* Keyword.Reserved */
        c-[ld] {
            color: #000000
        }

        /* Literal.Date */
        c-[nc] {
            color: #0077aa
        }

        /* Name.Class */
        c-[no] {
            color: #0077aa
        }

        /* Name.Constant */
        c-[nd] {
            color: #0077aa
        }

        /* Name.Decorator */
        c-[ni] {
            color: #0077aa
        }

        /* Name.Entity */
        c-[ne] {
            color: #0077aa
        }

        /* Name.Exception */
        c-[nf] {
            color: #0077aa
        }

        /* Name.Function */
        c-[nl] {
            color: #0077aa
        }

        /* Name.Label */
        c-[nn] {
            color: #0077aa
        }

        /* Name.Namespace */
        c-[py] {
            color: #0077aa
        }

        /* Name.Property */
        c-[ow] {
            color: #999999
        }

        /* Operator.Word */
        c-[mb] {
            color: #000000
        }

        /* Literal.Number.Bin */
        c-[mf] {
            color: #000000
        }

        /* Literal.Number.Float */
        c-[mh] {
            color: #000000
        }

        /* Literal.Number.Hex */
        c-[mi] {
            color: #000000
        }

        /* Literal.Number.Integer */
        c-[mo] {
            color: #000000
        }

        /* Literal.Number.Oct */
        c-[sb] {
            color: #a67f59
        }

        /* Literal.String.Backtick */
        c-[sc] {
            color: #a67f59
        }

        /* Literal.String.Char */
        c-[sd] {
            color: #a67f59
        }

        /* Literal.String.Doc */
        c-[se] {
            color: #a67f59
        }

        /* Literal.String.Escape */
        c-[sh] {
            color: #a67f59
        }

        /* Literal.String.Heredoc */
        c-[si] {
            color: #a67f59
        }

        /* Literal.String.Interpol */
        c-[sx] {
            color: #a67f59
        }

        /* Literal.String.Other */
        c-[sr] {
            color: #a67f59
        }

        /* Literal.String.Regex */
        c-[ss] {
            color: #a67f59
        }

        /* Literal.String.Symbol */
        c-[vc] {
            color: #0077aa
        }

        /* Name.Variable.Class */
        c-[vg] {
            color: #0077aa
        }

        /* Name.Variable.Global */
        c-[vi] {
            color: #0077aa
        }

        /* Name.Variable.Instance */
        c-[il] {
            color: #000000
        }

        /* Literal.Number.Integer.Long */

        @media (prefers-color-scheme: dark) {
            .highlight:not(.idl) {
                background: rgba(255, 255, 255, .05);
            }

            c-[a] {
                color: #d33682
            }

            /* Keyword.Declaration */
            c-[b] {
                color: #d33682
            }

            /* Keyword.Type */
            c-[c] {
                color: #2aa198
            }

            /* Comment */
            c-[d] {
                color: #2aa198
            }

            /* Comment.Multiline */
            c-[e] {
                color: #268bd2
            }

            /* Name.Attribute */
            c-[f] {
                color: #b58900
            }

            /* Name.Tag */
            c-[g] {
                color: #cb4b16
            }

            /* Name.Variable */
            c-[k] {
                color: #d33682
            }

            /* Keyword */
            c-[l] {
                color: #657b83
            }

            /* Literal */
            c-[m] {
                color: #657b83
            }

            /* Literal.Number */
            c-[n] {
                color: #268bd2
            }

            /* Name */
            c-[o] {
                color: #657b83
            }

            /* Operator */
            c-[p] {
                color: #657b83
            }

            /* Punctuation */
            c-[s] {
                color: #6c71c4
            }

            /* Literal.String */
            c-[t] {
                color: #6c71c4
            }

            /* Literal.String.Single */
            c-[u] {
                color: #6c71c4
            }

            /* Literal.String.Double */
            c-[ch] {
                color: #2aa198
            }

            /* Comment.Hashbang */
            c-[cp] {
                color: #2aa198
            }

            /* Comment.Preproc */
            c-[cpf] {
                color: #2aa198
            }

            /* Comment.PreprocFile */
            c-[c1] {
                color: #2aa198
            }

            /* Comment.Single */
            c-[cs] {
                color: #2aa198
            }

            /* Comment.Special */
            c-[kc] {
                color: #d33682
            }

            /* Keyword.Constant */
            c-[kn] {
                color: #d33682
            }

            /* Keyword.Namespace */
            c-[kp] {
                color: #d33682
            }

            /* Keyword.Pseudo */
            c-[kr] {
                color: #d33682
            }

            /* Keyword.Reserved */
            c-[ld] {
                color: #657b83
            }

            /* Literal.Date */
            c-[nc] {
                color: #268bd2
            }

            /* Name.Class */
            c-[no] {
                color: #268bd2
            }

            /* Name.Constant */
            c-[nd] {
                color: #268bd2
            }

            /* Name.Decorator */
            c-[ni] {
                color: #268bd2
            }

            /* Name.Entity */
            c-[ne] {
                color: #268bd2
            }

            /* Name.Exception */
            c-[nf] {
                color: #268bd2
            }

            /* Name.Function */
            c-[nl] {
                color: #268bd2
            }

            /* Name.Label */
            c-[nn] {
                color: #268bd2
            }

            /* Name.Namespace */
            c-[py] {
                color: #268bd2
            }

            /* Name.Property */
            c-[ow] {
                color: #657b83
            }

            /* Operator.Word */
            c-[mb] {
                color: #657b83
            }

            /* Literal.Number.Bin */
            c-[mf] {
                color: #657b83
            }

            /* Literal.Number.Float */
            c-[mh] {
                color: #657b83
            }

            /* Literal.Number.Hex */
            c-[mi] {
                color: #657b83
            }

            /* Literal.Number.Integer */
            c-[mo] {
                color: #657b83
            }

            /* Literal.Number.Oct */
            c-[sa] {
                color: #6c71c4
            }

            /* Literal.String.Affix */
            c-[sb] {
                color: #6c71c4
            }

            /* Literal.String.Backtick */
            c-[sc] {
                color: #6c71c4
            }

            /* Literal.String.Char */
            c-[dl] {
                color: #6c71c4
            }

            /* Literal.String.Delimiter */
            c-[sd] {
                color: #6c71c4
            }

            /* Literal.String.Doc */
            c-[se] {
                color: #6c71c4
            }

            /* Literal.String.Escape */
            c-[sh] {
                color: #6c71c4
            }

            /* Literal.String.Heredoc */
            c-[si] {
                color: #6c71c4
            }

            /* Literal.String.Interpol */
            c-[sx] {
                color: #6c71c4
            }

            /* Literal.String.Other */
            c-[sr] {
                color: #6c71c4
            }

            /* Literal.String.Regex */
            c-[ss] {
                color: #6c71c4
            }

            /* Literal.String.Symbol */
            c-[fm] {
                color: #268bd2
            }

            /* Name.Function.Magic */
            c-[vc] {
                color: #cb4b16
            }

            /* Name.Variable.Class */
            c-[vg] {
                color: #cb4b16
            }

            /* Name.Variable.Global */
            c-[vi] {
                color: #cb4b16
            }

            /* Name.Variable.Instance */
            c-[vm] {
                color: #cb4b16
            }

            /* Name.Variable.Magic */
            c-[il] {
                color: #657b83
            }

            /* Literal.Number.Integer.Long */
        }
    </style>
    <style>
        /* Boilerplate: style-wpt */
        :root {
            --wpt-border: hsl(0, 0%, 60%);
            --wpt-bg: hsl(0, 0%, 95%);
            --wpt-text: var(--text);
            --wptheading-text: hsl(0, 0%, 30%);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --wpt-border: hsl(0, 0%, 30%);
                --wpt-bg: var(--borderedblock-bg);
                --wpt-text: var(--text);
                --wptheading-text: hsl(0, 0%, 60%);
            }
        }

        .wpt-tests-block {
            list-style: none;
            border-left: .5em solid var(--wpt-border);
            background: var(--wpt-bg);
            color: var(--wpt-text);
            margin: 1em auto;
            padding: .5em;
        }

        .wpt-tests-block summary {
            color: var(--wptheading-text);
            font-weight: normal;
            text-transform: uppercase;
        }

        .wpt-tests-block summary::marker {
            color: var(--wpt-border);
        }

        .wpt-tests-block summary:hover::marker {
            color: var(--wpt-text);
        }

        /*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
        .wpt-tests-block:not([open]) {
            padding: 0;
            border: none;
            background: none;
            font-size: 0.75em;
            line-height: 1;
            position: relative;
            margin: 1em 0 0;
        }

        .wpt-tests-block:not([open]) summary {
            position: absolute;
            right: 0;
            bottom: 0;
        }

        /*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
        .wpt-tests-block:not([open]):last-child {
            padding-bottom: 1px;
            margin-bottom: -1px;
        }

        /*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
        li:not(:last-child)>.wpt-tests-block:not([open]):last-child,
        dd:not(:last-child)>.wpt-tests-block:not([open]):last-child {
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .wpt-tests-block:not([open]):not(:hover) {
            opacity: 0.5;
        }

        .wpt-tests-list {
            list-style: none;
            display: grid;
            margin: 0;
            padding: 0;
            grid-template-columns: 1fr max-content auto auto;
            grid-column-gap: .5em;
        }

        .wpt-tests-block hr:last-child {
            display: none;
        }

        .wpt-test {
            display: contents;
        }

        .wpt-test>a {
            text-decoration: underline;
            border: none;
        }

        .wpt-test>.wpt-name {
            grid-column: 1;
        }

        .wpt-test>.wpt-results {
            grid-column: 2;
        }

        .wpt-test>.wpt-live {
            grid-column: 3;
        }

        .wpt-test>.wpt-source {
            grid-column: 4;
        }

        .wpt-test>.wpt-results {
            display: flex;
            gap: .1em;
        }

        .wpt-test .wpt-result {
            display: inline-block;
            height: 1em;
            width: 1em;
            border-radius: 50%;
            position: relative;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-CRD" rel="stylesheet">
    <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet"
        type="text/css">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">CSS 条件規則モジュール レベル 4</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types/#CRD">W3C 候補勧告草案</a>,
            <time class="dt-updated" datetime="2025-09-04">2025年9月4日</time>
        </p>
        <details open>
            <summary>この文書の詳細情報</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>このバージョン:
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2025/CRD-css-conditional-4-20250904/">https://www.w3.org/TR/2025/CRD-css-conditional-4-20250904/</a>
                    <dt>最新公開バージョン:
                    <dd><a href="https://www.w3.org/TR/css-conditional-4/">https://www.w3.org/TR/css-conditional-4/</a>
                    <dt>編集者草案:
                    <dd><a
                            href="https://drafts.csswg.org/css-conditional-4/">https://drafts.csswg.org/css-conditional-4/</a>
                    <dt>以前のバージョン:
                    <dd><a href="https://www.w3.org/TR/2022/CR-css-conditional-4-20220217/"
                            rel="prev">https://www.w3.org/TR/2022/CR-css-conditional-4-20220217/</a>
                    <dt>履歴:
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/css-conditional-4/">https://www.w3.org/standards/history/css-conditional-4/</a>
                    <dt>実装レポート:
                    <dd><a
                            href="https://wpt.fyi/results/css/css-conditional">https://wpt.fyi/results/css/css-conditional</a>
                    <dt>テストスイート:
                    <dd><a
                            href="https://wpt.fyi/results/css/css-conditional">https://wpt.fyi/results/css/css-conditional</a>
                    <dd class="wpt-overview"><a
                            href="https://wpt.fyi/results/css/css-conditional/">https://wpt.fyi/results/css/css-conditional/</a>
                    <dt>フィードバック:
                    <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-conditional-4">CSSWG Issues
                            リポジトリ</a>
                    <dd><a href="#issues-index">仕様内でインライン</a>
                    <dt class="editor">編集者:
                    <dd class="editor p-author h-card vcard" data-editor-id="15393"><a class="p-name fn u-url url"
                            href="https://dbaron.org/">L. David Baron</a> (<a class="p-org org"
                            href="https://www.google.com/">Google</a>)
                    <dd class="editor p-author h-card vcard" data-editor-id="35400"><a class="p-name fn u-url url"
                            href="http://fantasai.inkedblade.net/contact">Elika J. Etemad / fantasai</a> (<span
                            class="p-org org">Apple</span>)
                    <dd class="editor p-author h-card vcard" data-editor-id="1438"><a class="p-name fn u-url url"
                            href="https://svgees.us/">Chris Lilley</a> (<span class="p-org org">W3C</span>)
                    <dt>この仕様に編集を提案:
                    <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/css-conditional-4/Overview.bs">GitHub
                            編集者</a>
                    <dt>デルタ仕様:
                    <dd>はい
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> ©
            2025 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr
                title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a
                href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/copyright/software-license/" rel="license"
                title="W3C Software and Document License">permissive document license</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">概要</span></h2>
        <p>このモジュールは、スタイルシートの一部を、プロセッサやスタイルシートが適用される環境の機能に基づいて条件付きで処理するためのCSSの機能を含みます。
            これはCSS Conditional 3 <a data-link-type="biblio" href="#biblio-css-conditional-3"
                title="CSS Conditional Rules Module Level 3">[css-conditional-3]</a>の機能を含み、拡張しており、
            特定のセレクターのサポートをクエリする機能 <a data-link-type="biblio" href="#biblio-selectors-4"
                title="Selectors Level 4">[SELECTORS-4]</a> を追加しています。
            これは新しい <a href="#typedef-supports-selector-fn"><span class="css">selector()</span></a> 記法による <a
                data-link-type="dfn" href="https://www.w3.org/TR/css-conditional-3/#supports-queries"
                id="ref-for-supports-queries">supports queries</a> で利用できます。</p>
        <a href="https://www.w3.org/TR/CSS/">CSS</a> は、構造化文書（HTMLやXMLなど）のレンダリングを、
        画面上や紙上などで記述するための言語です。
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">この文書のステータス</span></h2>
    <div data-fill-with="status">
        <p><em>このセクションは、公開時点でのこの文書のステータスを説明しています。
                現在のW3C出版物の一覧およびこの技術レポートの最新改訂は、<a href="https://www.w3.org/TR/">W3C標準と草案のインデックス</a>で確認できます。</em> </p>
        <p> この文書は <a href="https://www.w3.org/groups/wg/css">CSSワーキンググループ</a> によって
            <strong>候補勧告草案</strong>として <a href="https://www.w3.org/policies/process/20250818/#recs-and-notes">勧告トラック</a>
            を用いて公開されました。
            候補勧告としての公開は、<abbr title="World Wide Web Consortium">W3C</abbr>およびそのメンバーによる支持を意味するものではありません。
            候補勧告草案は、ワーキンググループが次の候補勧告スナップショットに含めることを意図した、
            前回の候補勧告からの変更を統合したものです。
        </p>
        <p> この文書はドラフトであり、
            随時更新、置換、または他の文書によって廃止される可能性があります。
            この文書を進行中の作業以外として引用することは適切ではありません。</p>
        <p>ご意見は<a href="https://github.com/w3c/csswg-drafts/issues">GitHubで課題を提出</a>（推奨）
            してお送りください。タイトルに仕様コード “css-conditional” を含めてください（例: “[css-conditional] <i>…コメントの概要…</i>”）。
            すべての課題やコメントは<a href="https://lists.w3.org/Archives/Public/public-css-archive/">アーカイブ</a>されます。
            または、(<a href="https://lists.w3.org/Archives/Public/www-style/">アーカイブ</a>) 公開メーリングリスト <a
                href="mailto:www-style@w3.org?Subject=%5Bcss-conditional%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>
            に送ることもできます。
        </p>
        <p>この文書は<a href="https://www.w3.org/policies/process/20250818/" id="w3c_process_revision">2025年8月18日
                W3Cプロセス文書</a>に従って管理されています。</p>
        <p>この文書は<a href="https://www.w3.org/policies/patent-policy/20200915/">W3C特許ポリシー</a>の下で運営されているグループによって作成されました。
            W3Cは、グループの成果物に関連して提出された<a href="https://www.w3.org/groups/wg/css/ipr"
                rel="disclosure">特許開示の公開リスト</a>を管理しています。
            そのページには特許開示の方法も記載されています。
            個人が、「必須クレーム」を含むと考えられる特許を実際に知っている場合は、
            <a
                href="https://www.w3.org/policies/patent-policy/20200915/#sec-Disclosure">W3C特許ポリシー第6節</a>に従って情報を開示する必要があります。
        </p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目次</h2>
        <ol class="toc" role="directory">
            <li><a href="#introduction"><span class="secno">1</span> <span class="content">はじめに</span></a>
            <li>
                <a href="#at-supports-ext"><span class="secno">2</span> <span class="content"> <span
                            class="css">@supports</span>規則への拡張</span></a>
                <ol class="toc">
                    <li><a href="#support-definition-ext"><span class="secno">2.1</span> <span class="content">
                                サポート定義への拡張</span></a>
                </ol>
            <li><a href="#security"><span class="secno"></span> <span class="content">セキュリティに関する考慮事項</span></a>
            <li><a href="#privacy"><span class="secno"></span> <span class="content">プライバシーに関する考慮事項</span></a>
            <li><a href="#acknowledgments"><span class="secno"></span> <span class="content">謝辞</span></a>
            <li>
                <a href="#changes"><span class="secno"></span> <span class="content">変更点</span></a>
                <ol class="toc">
                    <li><a href="#changes-from-2022-02-17"><span class="secno"></span> <span class="content">
                                2022年2月17日候補勧告スナップショット以降の変更点</span></a>
                    <li><a href="#changes-from-20200303"><span class="secno"></span> <span class="content">
                                2020年3月3日初公開ワーキングドラフト以降の変更点</span></a>
                    <li><a href="#changes-from-L3"><span class="secno"></span> <span class="content">
                                レベル3以降の追加点</span></a>
                </ol>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content">適合性</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">文書の慣例</span></a>
                    <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span class="content">
                                適合性クラス</span></a>
                    <li>
                        <a href="#w3c-partial"><span class="secno"></span> <span class="content">部分的な実装</span></a>
                        <ol class="toc">
                            <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span
                                        class="content">不安定および独自機能の実装</span></a>
                        </ol>
                    <li><a href="#w3c-testing"><span class="secno"></span> <span class="content">非実験的な実装</span></a>
                    <li><a href="#w3c-cr-exit-criteria"><span class="secno"></span> <span
                                class="content">CR終了基準</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">この仕様で定義されている用語</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">参照で定義された用語</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">標準参照文献</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">参考参照文献</span></a>
                </ol>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">課題一覧</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span
                class="content">はじめに</span><a class="self-link" href="#introduction"></a></h2>
        <p class="issue" id="issue-283f0a3c"><a class="self-link" href="#issue-283f0a3c"></a> レベル3の機能は、まだ <a
                data-link-type="biblio" href="#biblio-css-conditional-3"
                title="CSS Conditional Rules Module Level 3">[css-conditional-3]</a> で定義されており、ここにはまだコピーされていません。
        </p>
        <p>このレベルでは、<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-conditional-3/#at-ruledef-supports"
                id="ref-for-at-ruledef-supports">@supports</a> 規則への拡張が追加され、
            サポートされているセレクターをテストできるようになりました。</p>
        <h2 class="heading settled" data-level="2" id="at-supports-ext"><span class="secno">2. </span><span
                class="content"> <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-conditional-3/#at-ruledef-supports"
                    id="ref-for-at-ruledef-supports①">@supports</a> 規則への拡張</span><a class="self-link"
                href="#at-supports-ext"></a></h2>
        <p>この仕様のレベルでは、<a class="production css" data-link-type="type" href="#typedef-supports-feature"
                id="ref-for-typedef-supports-feature">&lt;supports-feature></a> 構文を以下のように拡張します：</p>
        <pre class="def prod"><dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-supports-feature">&lt;supports-feature></dfn> = <a class="production" data-link-type="type" href="#typedef-supports-selector-fn" id="ref-for-typedef-supports-selector-fn">&lt;supports-selector-fn></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-conditional-3/#typedef-supports-decl" id="ref-for-typedef-supports-decl">&lt;supports-decl></a>
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-supports-selector-fn">&lt;supports-selector-fn></dfn> = selector( <a class="production" data-link-type="type" href="https://www.w3.org/TR/selectors-4/#typedef-complex-selector" id="ref-for-typedef-complex-selector">&lt;complex-selector></a> )
</pre>
        <dl>
            <dt data-md><a class="production css" data-link-type="type" href="#typedef-supports-selector-fn"
                    id="ref-for-typedef-supports-selector-fn①">&lt;supports-selector-fn></a>
            <dd data-md>
                <p>関数の引数として与えられたセレクターをUAが<a href="#dfn-support-selector"
                        id="ref-for-dfn-support-selector">サポートする</a>場合、結果は true になります。</p>
        </dl>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>テスト</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/at-supports-selector-001.html"
                        title="css/css-conditional/at-supports-selector-001.html">at-supports-selector-001.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/css-conditional/at-supports-selector-001.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/at-supports-selector-001.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/at-supports-selector-002.html"
                        title="css/css-conditional/at-supports-selector-002.html">at-supports-selector-002.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/css-conditional/at-supports-selector-002.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/at-supports-selector-002.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/at-supports-selector-003.html"
                        title="css/css-conditional/at-supports-selector-003.html">at-supports-selector-003.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/css-conditional/at-supports-selector-003.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/at-supports-selector-003.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/at-supports-selector-004.html"
                        title="css/css-conditional/at-supports-selector-004.html">at-supports-selector-004.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/css-conditional/at-supports-selector-004.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/at-supports-selector-004.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/at-supports-selector-details-content-before.html"
                        title="css/css-conditional/at-supports-selector-details-content-before.html">at-supports-selector-details-content-before.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/css-conditional/at-supports-selector-details-content-before.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/at-supports-selector-details-content-before.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/at-supports-selector-details-content.html"
                        title="css/css-conditional/at-supports-selector-details-content.html">at-supports-selector-details-content.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/css-conditional/at-supports-selector-details-content.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/at-supports-selector-details-content.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/at-supports-selector-detecting-invalid-in-logical-combinations.html"
                        title="css/css-conditional/at-supports-selector-detecting-invalid-in-logical-combinations.html">at-supports-selector-detecting-invalid-in-logical-combinations.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/css-conditional/at-supports-selector-detecting-invalid-in-logical-combinations.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/at-supports-selector-detecting-invalid-in-logical-combinations.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/at-supports-selector-file-selector-button.html"
                        title="css/css-conditional/at-supports-selector-file-selector-button.html">at-supports-selector-file-selector-button.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/css-conditional/at-supports-selector-file-selector-button.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/at-supports-selector-file-selector-button.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/at-supports-selector-placeholder.html"
                        title="css/css-conditional/at-supports-selector-placeholder.html">at-supports-selector-placeholder.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/css-conditional/at-supports-selector-placeholder.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/at-supports-selector-placeholder.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/js/CSS-supports-L4.html"
                        title="css/css-conditional/js/CSS-supports-L4.html">CSS-supports-L4.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-conditional/js/CSS-supports-L4.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/js/CSS-supports-L4.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/js/CSS-supports-selector-detecting-invalid-in-logical-combinations.html"
                        title="css/css-conditional/js/CSS-supports-selector-detecting-invalid-in-logical-combinations.html">CSS-supports-selector-detecting-invalid-in-logical-combinations.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/css-conditional/js/CSS-supports-selector-detecting-invalid-in-logical-combinations.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/js/CSS-supports-selector-detecting-invalid-in-logical-combinations.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/js/CSS-supports-details-content-pseudo-parsing.html"
                        title="css/css-conditional/js/CSS-supports-details-content-pseudo-parsing.html">CSS-supports-details-content-pseudo-parsing.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/css-conditional/js/CSS-supports-details-content-pseudo-parsing.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/js/CSS-supports-details-content-pseudo-parsing.html"><small>(ソース)</small></a>
            </ul>
        </details>
        <div class="example" id="ex-selector">
            <a class="self-link" href="#ex-selector"></a> この例では、<a data-link-type="dfn"
                href="https://www.w3.org/TR/selectors-4/#column-combinator" id="ref-for-column-combinator">カラム結合子</a>
            (||)
            がセレクターでサポートされているかをテストし、
            サポートされている場合は、テーブル内の特定のセルをスタイルします。
            <pre class="lang-css highlight"><c- n>@supports</c-> <c- nf>selector</c-><c- p>(</c->col || td<c- p>)</c-> <c- p>{</c->
  col.selected || td <c- p>{</c->
    <c- k>background</c-><c- p>:</c-> tan<c- p>;</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
        </div>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/css-conditional-3/#conditional-group-rule"
                id="ref-for-conditional-group-rule">条件付きグループ規則</a>で使用される名前空間プレフィックスは宣言されていなければならず、
            そうでない場合は無効です <a data-link-type="biblio" href="#biblio-css-conditional-3"
                title="CSS Conditional Rules Module Level 3">[css-conditional-3]</a>。
            これは selector 関数内の名前空間プレフィックスも含みます。</p>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>テスト</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-conditional/at-supports-namespace-002.html"
                        title="css/css-conditional/at-supports-namespace-002.html">at-supports-namespace-002.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/css-conditional/at-supports-namespace-002.html"><small>(ライブテスト)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-conditional/at-supports-namespace-002.html"><small>(ソース)</small></a>
            </ul>
        </details>
        <div class="invalid example" id="ex-ns-selector-invalid">
            <a class="self-link" href="#ex-ns-selector-invalid"></a> この例では、<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-namespaces-3/#css-qualified-name"
                id="ref-for-css-qualified-name">CSS修飾名</a>付きの属性セレクターがサポートされているかをチェックしようとしていますが、
            名前空間プレフィックスが宣言されていないため、無効です。
            <pre class="lang-css highlight"><c- n>@supports</c-> <c- nf>selector</c-><c- p>(</c->a<c- p>[</c->xlink|href<c- p>])</c-> <c- p>{</c->
  // 何かをする<c- p>,</c-> しかし失敗する
<c- p>}</c->
</pre>
        </div>
        <div class="example" id="ex-ns-selector">
            <a class="self-link" href="#ex-ns-selector"></a> この例では、<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-namespaces-3/#css-qualified-name"
                id="ref-for-css-qualified-name①">CSS修飾名</a>付きの属性セレクターがサポートされているかを確認します。
            <pre class="lang-css highlight"><c- n>@namespace</c-> x <c- nf>url</c-><c- p>(</c-><c- s>http://www.w3.org/1999/xlink</c-><c- p>);</c->
<c- n>@supports</c-> <c- nf>selector</c-><c- p>(</c->a<c- p>[</c->x|href<c- p>])</c-> <c- p>{</c->
  // 何かをする
<c- p>}</c->
</pre>
        </div>
        <h3 class="heading settled" data-level="2.1" id="support-definition-ext"><span class="secno">2.1. </span><span
                class="content">サポート定義への拡張</span><a class="self-link" href="#support-definition-ext"></a></h3>
        <p>CSSプロセッサは、すべての側面（再帰的に）を受理し（構文のいずれかが未知または無効と見なされるのではなく）、
            かつセレクターが<a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#unknown--webkit--pseudo-elements"
                id="ref-for-unknown--webkit--pseudo-elements">未知の -webkit- 疑似要素</a>を含まない場合、
            そのCSSセレクターを<dfn class="dfn-paneled" data-dfn-for="CSS" data-dfn-type="dfn" data-export
                id="dfn-support-selector">サポートする</dfn>と見なされます。</p>
        <p class="note" role="note"><span class="marker">注:</span> 一部の機能的セレクターは寛容にパースされます。つまり、一部の引数が未知/無効であっても、
            セレクター自体は無効化されません。
            それでもサポートされていません。</p>
        <h2 class="no-num heading settled" id="security"><span class="content">セキュリティに関する考慮事項</span><a class="self-link"
                href="#security"></a></h2>
        <p>この文書に関してセキュリティの問題は報告されていません。</p>
        <h2 class="no-num heading settled" id="privacy"><span class="content">プライバシーに関する考慮事項</span><a class="self-link"
                href="#privacy"></a></h2>
        <p><span class="css">selector()</span> 関数は、ユーザーのソフトウェアのバージョンや、
            特定の機能を有効または無効にする非デフォルト設定で動作しているかどうかなどの情報を提供する可能性があります。</p>
        <p>この情報は他のAPI経由でも取得できます。
            しかし、本仕様の機能はウェブ上でその情報が公開される手段のひとつです。</p>
        <p>この情報は集計すると、ユーザーの<a
                href="https://www.w3.org/2001/tag/doc/unsanctioned-tracking/">フィンガープリント精度</a>を向上させることにも利用され得ます。</p>
        <h2 class="no-num heading settled" id="acknowledgments"><span class="content">謝辞</span><a class="self-link"
                href="#acknowledgments"></a></h2>
        <p>編集者は、このモジュールの<a href="https://www.w3.org/TR/css-conditional-3/#acknowledgments">前のレベル</a>に貢献したすべての方々に感謝します。
        </p>
        <h2 class="no-num heading settled" id="changes"><span class="content">変更点</span><a class="self-link"
                href="#changes"></a></h2>
        <h3 class="no-num heading settled" id="changes-from-2022-02-17"><span class="content">2022年2月17日<a
                    href="https://www.w3.org/TR/2022/CR-css-conditional-4-20220217/">候補勧告スナップショット以降の変更点</a></span><a
                class="self-link" href="#changes-from-2022-02-17"></a></h3>
        <ul>
            <li>セレクターの未知もしくは無効な部分がセレクター自体を無効化しない場合でも、セレクターはサポートされていないとみなされることを明確化しました。
        </ul>
        <h3 class="no-num heading settled" id="changes-from-20200303"><span class="content">2020年3月3日<a
                    href="https://www.w3.org/TR/2020/WD-css-conditional-4-20200303/">初公開ワーキングドラフト以降の変更点</a></span><a
                class="self-link" href="#changes-from-20200303"></a></h3>
        <ul>
            <li><a href="#privacy">プライバシー</a>および<a href="#security">セキュリティ</a>セクションを追加
            <li>いくつかの例を追加
            <li>名前空間プレフィックスの宣言要件が selector() 内のセレクターにも適用されることを明確化（<a
                    href="https://github.com/w3c/csswg-drafts/issues/3220">Issue 3220</a>）
        </ul>
        <h3 class="no-num heading settled" id="changes-from-L3"><span class="content">レベル3以降の追加点</span><a
                class="self-link" href="#changes-from-L3"></a></h3>
        <ul>
            <li><a data-link-type="dfn" href="https://www.w3.org/TR/css-conditional-3/#supports-queries"
                    id="ref-for-supports-queries①">supports queries</a> に <span class="css">selector()</span> 記法を追加しました。
        </ul>
    </main>
    <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">適合性</span><a class="self-link"
            href="#w3c-conformance"></a></h2>
    <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content">文書の慣例</span><a class="self-link"
            href="#w3c-conventions"></a></h3>
    <p>適合性要件は、記述的な断言とRFC 2119の用語の組み合わせで表現されます。重要な語句「MUST」、「MUST NOT」、「REQUIRED」、「SHALL」、「SHALL NOT」、「SHOULD」、「SHOULD
        NOT」、「RECOMMENDED」、「MAY」、「OPTIONAL」は、本書の規範部分においてRFC 2119で説明されている通りに解釈されます。
        ただし、可読性のため、これらの語は本仕様ではすべて大文字では表示されていません。</p>
    <p>この仕様のテキストは、非規範的と明示的に記載されたセクション、例、および注記を除き、すべて規範的です。 <a data-link-type="biblio" href="#biblio-rfc2119"
            title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
    <p>この仕様の例は「for example」という語で導入されるか、<code class="highlight">class=<c- s>"example"</c-></code>により規範テキストから区別されます。
        次のようになります：</p>
    <div class="example" id="w3c-example">
        <a class="self-link" href="#w3c-example"></a>
        <p>これは情報提供的な例の一例です。</p>
    </div>
    <p>情報提供的な注記は「Note」で始まり、<code class="highlight">class=<c- s>"note"</c-></code>で規範テキストから区別されます。次のようになります：</p>
    <p class="note" role="note">注: これは情報提供的な注記です。</p>
    <p>助言は、特別な注意を促すために規範セクションとしてスタイルされ、他の規範テキストから<code
            class="highlight">&lt;strong class=<c- s>"advisement"</c->></code>で区別されます。
        例：<strong class="advisement">UAはアクセシブルな代替手段を提供しなければなりません。</strong></p>
    <details class="wpt-tests-block" dir="ltr" lang="en" open>
        <summary>テスト</summary>
        <p>この仕様の内容に関連するテストは、このような「テスト」ブロックに記載される場合があります。
            このようなブロックは非規範的です。</p>
        <ul class="wpt-tests-list"></ul>
        <hr>
    </details>
    <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content">適合性クラス</span><a
            class="self-link" href="#w3c-conformance-classes"></a></h3>
    <p>本仕様への適合は、以下の3つの適合性クラスに定義されます：</p>
    <dl>
        <dt>スタイルシート
        <dd><a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSSスタイルシート</a>。
        <dt>レンダラー
        <dd><a
                href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>（ユーザーエージェント）。スタイルシートのセマンティクスを解釈し、それらを利用する文書を描画するもの。
        <dt>オーサリングツール
        <dd><a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>。スタイルシートを書き出すもの。
    </dl>
    <p>スタイルシートが本仕様に適合しているとは、そのスタイルシート内で本モジュールで定義された構文を用いたすべての文が、
        汎用的なCSS文法および本モジュール内で定義された各機能の個別文法に従い有効である場合です。</p>
    <p>レンダラーが本仕様に適合しているとは、スタイルシートを該当する仕様に従って解釈するだけでなく、
        本仕様で定義されたすべての機能を正しくパースし、文書を適切にレンダリングすることです。ただし、デバイスの制約によりUAが文書を正しく描画できない場合でも、非適合とはなりません（例：UAがモノクロモニターで色をレンダリングする必要はありません）。
    </p>
    <p>オーサリングツールが本仕様に適合しているとは、汎用CSS文法および本モジュール内の各機能の個別文法に従って構文的に正しいスタイルシートを書き出し、
        かつ本モジュールに記載されたスタイルシートの他の適合性要件も満たしている場合です。</p>
    <h3 class="no-ref heading settled" id="w3c-partial"><span class="content">部分的な実装</span><a class="self-link"
            href="#w3c-partial"></a></h3>
    <p>著者が将来互換性のあるパース規則を活用してフォールバック値を指定できるように、
        CSSレンダラーは、利用可能なレベルのサポートがないatルール・プロパティ・プロパティ値・キーワードその他の構文要素を<strong>無効</strong>として（<a
            href="https://www.w3.org/TR/CSS21/conform.html#ignore">必要に応じて無視</a>）扱わなければなりません。
        特に、ユーザーエージェントは、サポートされていない構成値のみを選択的に無視し、
        単一の複数値プロパティ宣言でサポートされている値だけを尊重しては<strong>なりません</strong>。
        いずれかの値が無効（サポートされていない値は必ずそうなる）と見なされる場合、
        CSSは宣言全体を無視することを要求します。</p>
    <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content">不安定および独自機能の実装</span><a
            class="self-link" href="#w3c-conform-future-proofing"></a></h4>
    <p>将来の安定したCSS機能との衝突を避けるため、
        CSSWGは<a href="https://www.w3.org/TR/CSS/#future-proofing">ベストプラクティス</a>に従って、
        <a href="https://www.w3.org/TR/CSS/#unstable">不安定な機能</a>や<a
            href="https://www.w3.org/TR/CSS/#proprietary-extension">独自拡張</a>の実装を行うことを推奨します。
    </p>
    <h3 class="no-ref heading settled" id="w3c-testing"><span class="content">非実験的な実装</span><a class="self-link"
            href="#w3c-testing"></a></h3>
    <p>仕様が候補勧告段階に達すると、非実験的な実装が可能となり、
        実装者は仕様通り正しく実装できるCRレベルの機能のプレフィックスなしの実装を公開するべきです。</p>
    <p>CSSの実装間で相互運用性を確立・維持するため、
        CSSワーキンググループは、非実験的なCSSレンダラーがCSS機能のプレフィックスなし実装を公開する前に、
        実装報告書（および必要であればそのために用いたテストケース）をW3Cに提出するよう要請します。
        W3Cに提出されたテストケースは、CSSワーキンググループによるレビューと修正の対象となります。</p>
    <p>テストケースおよび実装報告書の提出方法など詳細は、CSSワーキンググループのウェブサイト<a
            href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a>で確認できます。
        質問は<a href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>メーリングリストへ。
    </p>
    <h3 class="no-ref heading settled" id="w3c-cr-exit-criteria"><span class="content">CR終了基準</span><a class="self-link"
            href="#w3c-cr-exit-criteria"></a></h3>
    <p>この仕様を提案勧告へ進めるためには、各機能について少なくとも2つの独立した相互運用可能な実装が必要です。
        各機能は異なる製品によって実装されてもよく、すべての機能が単一製品で実装される必要はありません。
        この基準のため、以下の用語を定義します：</p>
    <dl>
        <dt>独立
        <dd>各実装は異なる当事者によって開発され、他の適格な実装で使用されたコードを共有・再利用・派生してはなりません。
            本仕様の実装に無関係なコード部分はこの要件から除外されます。
        <dt>相互運用可能
        <dd>公式CSSテストスイートの該当テストケースに合格すること、またはWebブラウザでない場合は同等のテストに合格すること。
            そのようなUA（ユーザーエージェント）で相互運用性を主張する場合は、テストスイートの各該当テストに同等のテストを作成する必要があり、
            さらにそのようなUA以外にも同様にその同等テストに合格できるUAが必要です。
            同等テストはピアレビューのために公開されなければなりません。
        <dt>実装
        <dd>
            以下を満たすユーザーエージェント：
            <ol class="inline">
                <li>仕様を実装していること。
                <li>一般公開されていること。実装は製品版、ベータ版、プレビューリリース、ナイトリービルドなどいずれでもよい。
                    非製品版の場合は、安定性を示すため少なくとも1ヶ月間その機能が実装されている必要があります。
                <li>実験的でないこと（テストスイートに合格するためだけに設計されたバージョンで、今後通常利用される予定がないものは除く）。
            </ol>
    </dl>
    <p>仕様は最低6ヶ月間、候補勧告として維持されます。</p>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">この仕様で定義されている用語</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#dfn-support-selector">CSSセレクターをサポートする</a><span>, § 2.1</span>
        <li><a href="#typedef-supports-feature">&lt;supports-feature></a><span>, § 2</span>
        <li><a href="#typedef-supports-selector-fn">&lt;supports-selector-fn></a><span>, § 2</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">参照で定義された用語</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSS-CONDITIONAL-3]</a>で定義されている用語:
            <ul>
                <li><span class="dfn-paneled" id="77b8ca51">&lt;supports-decl></span>
                <li><span class="dfn-paneled" id="a5d6c9d2">@supports</span>
                <li><span class="dfn-paneled" id="f1a41224">conditional group rule</span>
                <li><span class="dfn-paneled" id="be011220">supports queries</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-NAMESPACES-3]</a>で定義されている用語:
            <ul>
                <li><span class="dfn-paneled" id="8fba26d6">CSS修飾名</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-VALUES-4]</a>で定義されている用語:
            <ul>
                <li><span class="dfn-paneled" id="4eb9d37e">|</span>
            </ul>
        <li>
            <a data-link-type="biblio">[SELECTORS-4]</a>で定義されている用語:
            <ul>
                <li><span class="dfn-paneled" id="2c5d424d">&lt;complex-selector></span>
                <li><span class="dfn-paneled" id="0a708963">カラム結合子</span>
                <li><span class="dfn-paneled" id="586ee9ed">未知の -webkit- 疑似要素</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">標準参照文献</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-css-conditional-3">[CSS-CONDITIONAL-3]
        <dd>Chris Lilley; David Baron; Elika Etemad. <a href="https://www.w3.org/TR/css-conditional-3/"><cite>CSS
                    Conditional Rules Module Level 3</cite></a>. 2024年8月15日. CRD. URL: <a
                href="https://www.w3.org/TR/css-conditional-3/">https://www.w3.org/TR/css-conditional-3/</a>
        <dt id="biblio-css-values-4">[CSS-VALUES-4]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-4/"><cite>CSS Values and Units
                    Module Level 4</cite></a>. 2024年3月12日. WD. URL: <a
                href="https://www.w3.org/TR/css-values-4/">https://www.w3.org/TR/css-values-4/</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to
                    Indicate Requirement Levels</cite></a>. 1997年3月. Best Current Practice. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-selectors-4">[SELECTORS-4]
        <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://www.w3.org/TR/selectors-4/"><cite>Selectors Level
                    4</cite></a>. 2022年11月11日. WD. URL: <a
                href="https://www.w3.org/TR/selectors-4/">https://www.w3.org/TR/selectors-4/</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">参考参照文献</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-css-namespaces-3">[CSS-NAMESPACES-3]
        <dd>Elika Etemad. <a href="https://www.w3.org/TR/css-namespaces-3/"><cite>CSS Namespaces Module Level
                    3</cite></a>. 2014年3月20日. REC. URL: <a
                href="https://www.w3.org/TR/css-namespaces-3/">https://www.w3.org/TR/css-namespaces-3/</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">課題一覧</span><a class="self-link"
            href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue">レベル3の機能はまだ <a data-link-type="biblio" href="#biblio-css-conditional-3"
                title="CSS Conditional Rules Module Level 3">[css-conditional-3]</a> で定義されており、ここにはまだコピーされていません。<a
                class="issue-return" href="#issue-283f0a3c" title="Jump to section">↵</a></div>
    </div>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "0a708963": { "dfnID": "0a708963", "dfnText": "column combinator", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-column-combinator" }], "title": "2. \nExtensions to the @supports rule" }], "url": "https://www.w3.org/TR/selectors-4/#column-combinator" },
                "2c5d424d": { "dfnID": "2c5d424d", "dfnText": "<complex-selector>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-complex-selector" }], "title": "2. \nExtensions to the @supports rule" }], "url": "https://www.w3.org/TR/selectors-4/#typedef-complex-selector" },
                "4eb9d37e": { "dfnID": "4eb9d37e", "dfnText": "|", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-comb-one" }], "title": "2. \nExtensions to the @supports rule" }], "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "586ee9ed": { "dfnID": "586ee9ed", "dfnText": "unknown -webkit- pseudo-elements", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-unknown--webkit--pseudo-elements" }], "title": "2.1. \nExtensions to the definition of support" }], "url": "https://www.w3.org/TR/selectors-4/#unknown--webkit--pseudo-elements" },
                "77b8ca51": { "dfnID": "77b8ca51", "dfnText": "<supports-decl>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-supports-decl" }], "title": "2. \nExtensions to the @supports rule" }], "url": "https://www.w3.org/TR/css-conditional-3/#typedef-supports-decl" },
                "8fba26d6": { "dfnID": "8fba26d6", "dfnText": "CSS qualified name", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-css-qualified-name" }, { "id": "ref-for-css-qualified-name\u2460" }], "title": "2. \nExtensions to the @supports rule" }], "url": "https://www.w3.org/TR/css-namespaces-3/#css-qualified-name" },
                "a5d6c9d2": { "dfnID": "a5d6c9d2", "dfnText": "@supports", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-at-ruledef-supports" }], "title": "1. Introduction" }, { "refs": [{ "id": "ref-for-at-ruledef-supports\u2460" }], "title": "2. \nExtensions to the @supports rule" }], "url": "https://www.w3.org/TR/css-conditional-3/#at-ruledef-supports" },
                "be011220": { "dfnID": "be011220", "dfnText": "supports queries", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-supports-queries" }], "title": "Unnumbered Section" }, { "refs": [{ "id": "ref-for-supports-queries\u2460" }], "title": "\nAdditions since Level 3" }], "url": "https://www.w3.org/TR/css-conditional-3/#supports-queries" },
                "dfn-support-selector": { "dfnID": "dfn-support-selector", "dfnText": "support a CSS selector", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dfn-support-selector" }], "title": "2. \nExtensions to the @supports rule" }], "url": "#dfn-support-selector" },
                "f1a41224": { "dfnID": "f1a41224", "dfnText": "conditional group rule", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-conditional-group-rule" }], "title": "2. \nExtensions to the @supports rule" }], "url": "https://www.w3.org/TR/css-conditional-3/#conditional-group-rule" },
                "typedef-supports-feature": { "dfnID": "typedef-supports-feature", "dfnText": "<supports-feature>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-supports-feature" }], "title": "2. \nExtensions to the @supports rule" }], "url": "#typedef-supports-feature" },
                "typedef-supports-selector-fn": { "dfnID": "typedef-supports-selector-fn", "dfnText": "<supports-selector-fn>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-supports-selector-fn" }, { "id": "ref-for-typedef-supports-selector-fn\u2460" }], "title": "2. \nExtensions to the @supports rule" }], "url": "#typedef-supports-selector-fn" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#typedef-supports-feature": { "displayText": "<supports-feature>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-conditional", "spec": "css-conditional-4", "status": "local", "text": "<supports-feature>", "type": "type", "url": "#typedef-supports-feature" },
                "#typedef-supports-selector-fn": { "displayText": "<supports-selector-fn>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-conditional", "spec": "css-conditional-4", "status": "local", "text": "<supports-selector-fn>", "type": "type", "url": "#typedef-supports-selector-fn" },
                "https://www.w3.org/TR/css-conditional-3/#at-ruledef-supports": { "displayText": "@supports", "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-conditional", "spec": "css-conditional-3", "status": "snapshot", "text": "@supports", "type": "at-rule", "url": "https://www.w3.org/TR/css-conditional-3/#at-ruledef-supports" },
                "https://www.w3.org/TR/css-conditional-3/#conditional-group-rule": { "displayText": "conditional group rule", "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-conditional", "spec": "css-conditional-3", "status": "snapshot", "text": "conditional group rule", "type": "dfn", "url": "https://www.w3.org/TR/css-conditional-3/#conditional-group-rule" },
                "https://www.w3.org/TR/css-conditional-3/#supports-queries": { "displayText": "supports queries", "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-conditional", "spec": "css-conditional-3", "status": "snapshot", "text": "supports queries", "type": "dfn", "url": "https://www.w3.org/TR/css-conditional-3/#supports-queries" },
                "https://www.w3.org/TR/css-conditional-3/#typedef-supports-decl": { "displayText": "<supports-decl>", "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-conditional", "spec": "css-conditional-3", "status": "snapshot", "text": "<supports-decl>", "type": "type", "url": "https://www.w3.org/TR/css-conditional-3/#typedef-supports-decl" },
                "https://www.w3.org/TR/css-namespaces-3/#css-qualified-name": { "displayText": "CSS qualified name", "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-namespaces", "spec": "css-namespaces-3", "status": "snapshot", "text": "css qualified name", "type": "dfn", "url": "https://www.w3.org/TR/css-namespaces-3/#css-qualified-name" },
                "https://www.w3.org/TR/css-values-4/#comb-one": { "displayText": "|", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "|", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "https://www.w3.org/TR/selectors-4/#column-combinator": { "displayText": "column combinator", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "column combinator", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#column-combinator" },
                "https://www.w3.org/TR/selectors-4/#typedef-complex-selector": { "displayText": "<complex-selector>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "<complex-selector>", "type": "type", "url": "https://www.w3.org/TR/selectors-4/#typedef-complex-selector" },
                "https://www.w3.org/TR/selectors-4/#unknown--webkit--pseudo-elements": { "displayText": "unknown -webkit- pseudo-elements", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "unknown -webkit- pseudo-elements", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#unknown--webkit--pseudo-elements" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
                    // Give the original term if it's being displayed in a different way.
                    // But allow casing differences, they're insignificant.
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.displayText)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const refHintKey = link.getAttribute("data-refhint-key");
                let key = url;
                if (refHintKey) {
                    key = refHintKey + "_" + url;
                }
                const ref = refsData[key];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-wpt */
        "use strict";
        {
            let wptData = {
                "paths": ["/css/css-conditional/"],
            };

            document.addEventListener("DOMContentLoaded", async () => {
                if (wptData.paths.length == 0) return;

                const runsUrl = "https://wpt.fyi/api/runs?label=master&label=stable&max-count=1&product=chrome&product=firefox&product=safari&product=edge";
                const runs = await (await fetch(runsUrl)).json();

                let testResults = [];
                for (const pathPrefix of wptData.paths) {
                    const pathResults = await (await fetch("https://wpt.fyi/api/search", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            "run_ids": runs.map(x => x.id),
                            "query": { "path": pathPrefix },
                        })
                    })).json();
                    testResults = testResults.concat(pathResults.results);
                }

                const browsers = runs.map(x => ({ name: x.browser_name, version: x.browser_version, passes: 0, total: 0 }));
                const resultsFromPath = new Map(testResults.map(result => {
                    const testPath = result.test;
                    const passes = result.legacy_status.map(x => [x.passes, x.total]);
                    return [testPath, passes];
                }));
                const seenTests = new Set();
                document.querySelectorAll(".wpt-name").forEach(nameEl => {
                    const passData = resultsFromPath.get("/" + nameEl.getAttribute("title"));
                    if (!passData) {
                        console.log("Couldn't find test in results:", nameEl);
                        return
                    }
                    const numTests = passData[0][1];
                    if (numTests > 1) {
                        nameEl.insertAdjacentElement("beforeend",
                            mk.small({}, ` (${numTests} tests)`));
                    }
                    if (passData == undefined) return;
                    const resultsEl = mk.span({ "class": "wpt-results" },
                        ...passData.map((p, i) => mk.span(
                            {
                                "title": `${browsers[i].name} ${p[0]}/${p[1]}`,
                                "class": "wpt-result",
                                "style": `background: conic-gradient(forestgreen ${p[0] / p[1] * 360}deg, darkred 0deg);`,
                            })),
                    );
                    nameEl.insertAdjacentElement("afterend", resultsEl);

                    // Only update the summary pass/total count if we haven't seen this
                    // test before, to support authors listing the same test multiple times
                    // in a spec.
                    if (!seenTests.has(nameEl.getAttribute("title"))) {
                        seenTests.add(nameEl.getAttribute("title"));
                        passData.forEach((p, i) => {
                            browsers[i].passes += p[0];
                            browsers[i].total += p[1];
                        });
                    }
                });
                const overview = document.querySelector(".wpt-overview");
                if (overview) {
                    overview.appendChild(mk.ul({}, ...browsers.map(formatWptResult)));
                    document.head.appendChild(mk.style({},
                        `.wpt-overview ul { display: flex; flex-flow: row wrap; gap: .2em; justify-content: start; list-style: none; padding: 0; margin: 0;}
             .wpt-overview li { padding: .25em 1em; color: black; text-align: center; }
             .wpt-overview img { height: 1.5em; height: max(1.5em, 32px); background: transparent; }
             .wpt-overview .browser { font-weight: bold; }
             .wpt-overview .passes-none { background: #e57373; }
             .wpt-overview .passes-hardly { background: #ffb74d; }
             .wpt-overview .passes-a-few { background: #ffd54f; }
             .wpt-overview .passes-half { background: #fff176; }
             .wpt-overview .passes-lots { background: #dce775; }
             .wpt-overview .passes-most { background: #aed581; }
             .wpt-overview .passes-all { background: #81c784; }`));
                }
            });

            function formatWptResult({ name, version, passes, total }) {
                const passRate = passes / total;
                let passClass = "";
                if (passRate == 0) passClass = "passes-none";
                else if (passRate < .2) passClass = "passes-hardly";
                else if (passRate < .4) passClass = "passes-a-few";
                else if (passRate < .6) passClass = "passes-half";
                else if (passRate < .8) passClass = "passes-lots";
                else if (passRate < 1) passClass = "passes-most";
                else passClass = "passes-all";

                name = name[0].toUpperCase() + name.slice(1);
                const shortVersion = /^\d+/.exec(version);
                const icon = []

                if (name == "Chrome") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/chrome_64x64.png" }));
                if (name == "Edge") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/edge_64x64.png" }));
                if (name == "Safari") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/safari_64x64.png" }));
                if (name == "Firefox") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/firefox_64x64.png" }));

                return mk.li({ "class": passClass },
                    mk.nobr({ 'class': 'browser' }, ...icon, ` ${name} ${shortVersion}`),
                    mk.br(),
                    mk.nobr({ 'class': 'pass-rate' }, `${passes}/${total}`)
                );
            }
        }
    </script>
    <script src="https://htmlspecs.com/dropdown.js"></script>
