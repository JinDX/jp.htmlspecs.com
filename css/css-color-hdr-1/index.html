<!doctype html>
<html lang="ja-JP">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>CSS カラー HDR モジュール レベル 1</title>
    <meta content="FPWD" name="w3c-status">
    <!-- <meta content="Bikeshed version ac5ea272d, updated Fri Dec 6 15:45:15 2024 -0800" name="generator"> -->
    <link href="https://www.w3.org/TR/css-color-hdr-1/" rel="canonical">
    <!-- <meta content="97f683a0274c6386a874a31ed1dfa99a6f19b034" name="revision"> -->
    <meta content="dark light" name="color-scheme">
    <link href="https://www.w3.org/TR/css-color-hdr-1/style.css" rel="stylesheet">
    <style>
        /* Boilerplate: style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-colors */
        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* Boilerplate: style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-selflinks */
        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* Boilerplate: style-syntax-highlighting */
        code.highlight {
            padding: .1em;
            border-radius: .3em;
        }

        pre.highlight,
        pre>code.highlight {
            display: block;
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
            border-radius: 0;
        }

        .highlight:not(.idl) {
            background: rgba(0, 0, 0, .03);
        }

        c-[a] {
            color: #990055
        }

        /* Keyword.Declaration */
        c-[b] {
            color: #990055
        }

        /* Keyword.Type */
        c-[c] {
            color: #708090
        }

        /* Comment */
        c-[d] {
            color: #708090
        }

        /* Comment.Multiline */
        c-[e] {
            color: #0077aa
        }

        /* Name.Attribute */
        c-[f] {
            color: #669900
        }

        /* Name.Tag */
        c-[g] {
            color: #222222
        }

        /* Name.Variable */
        c-[k] {
            color: #990055
        }

        /* Keyword */
        c-[l] {
            color: #000000
        }

        /* Literal */
        c-[m] {
            color: #000000
        }

        /* Literal.Number */
        c-[n] {
            color: #0077aa
        }

        /* Name */
        c-[o] {
            color: #999999
        }

        /* Operator */
        c-[p] {
            color: #999999
        }

        /* Punctuation */
        c-[s] {
            color: #a67f59
        }

        /* Literal.String */
        c-[t] {
            color: #a67f59
        }

        /* Literal.String.Single */
        c-[u] {
            color: #a67f59
        }

        /* Literal.String.Double */
        c-[cp] {
            color: #708090
        }

        /* Comment.Preproc */
        c-[c1] {
            color: #708090
        }

        /* Comment.Single */
        c-[cs] {
            color: #708090
        }

        /* Comment.Special */
        c-[kc] {
            color: #990055
        }

        /* Keyword.Constant */
        c-[kn] {
            color: #990055
        }

        /* Keyword.Namespace */
        c-[kp] {
            color: #990055
        }

        /* Keyword.Pseudo */
        c-[kr] {
            color: #990055
        }

        /* Keyword.Reserved */
        c-[ld] {
            color: #000000
        }

        /* Literal.Date */
        c-[nc] {
            color: #0077aa
        }

        /* Name.Class */
        c-[no] {
            color: #0077aa
        }

        /* Name.Constant */
        c-[nd] {
            color: #0077aa
        }

        /* Name.Decorator */
        c-[ni] {
            color: #0077aa
        }

        /* Name.Entity */
        c-[ne] {
            color: #0077aa
        }

        /* Name.Exception */
        c-[nf] {
            color: #0077aa
        }

        /* Name.Function */
        c-[nl] {
            color: #0077aa
        }

        /* Name.Label */
        c-[nn] {
            color: #0077aa
        }

        /* Name.Namespace */
        c-[py] {
            color: #0077aa
        }

        /* Name.Property */
        c-[ow] {
            color: #999999
        }

        /* Operator.Word */
        c-[mb] {
            color: #000000
        }

        /* Literal.Number.Bin */
        c-[mf] {
            color: #000000
        }

        /* Literal.Number.Float */
        c-[mh] {
            color: #000000
        }

        /* Literal.Number.Hex */
        c-[mi] {
            color: #000000
        }

        /* Literal.Number.Integer */
        c-[mo] {
            color: #000000
        }

        /* Literal.Number.Oct */
        c-[sb] {
            color: #a67f59
        }

        /* Literal.String.Backtick */
        c-[sc] {
            color: #a67f59
        }

        /* Literal.String.Char */
        c-[sd] {
            color: #a67f59
        }

        /* Literal.String.Doc */
        c-[se] {
            color: #a67f59
        }

        /* Literal.String.Escape */
        c-[sh] {
            color: #a67f59
        }

        /* Literal.String.Heredoc */
        c-[si] {
            color: #a67f59
        }

        /* Literal.String.Interpol */
        c-[sx] {
            color: #a67f59
        }

        /* Literal.String.Other */
        c-[sr] {
            color: #a67f59
        }

        /* Literal.String.Regex */
        c-[ss] {
            color: #a67f59
        }

        /* Literal.String.Symbol */
        c-[vc] {
            color: #0077aa
        }

        /* Name.Variable.Class */
        c-[vg] {
            color: #0077aa
        }

        /* Name.Variable.Global */
        c-[vi] {
            color: #0077aa
        }

        /* Name.Variable.Instance */
        c-[il] {
            color: #000000
        }

        /* Literal.Number.Integer.Long */

        @media (prefers-color-scheme: dark) {
            .highlight:not(.idl) {
                background: rgba(255, 255, 255, .05);
            }

            c-[a] {
                color: #d33682
            }

            /* Keyword.Declaration */
            c-[b] {
                color: #d33682
            }

            /* Keyword.Type */
            c-[c] {
                color: #2aa198
            }

            /* Comment */
            c-[d] {
                color: #2aa198
            }

            /* Comment.Multiline */
            c-[e] {
                color: #268bd2
            }

            /* Name.Attribute */
            c-[f] {
                color: #b58900
            }

            /* Name.Tag */
            c-[g] {
                color: #cb4b16
            }

            /* Name.Variable */
            c-[k] {
                color: #d33682
            }

            /* Keyword */
            c-[l] {
                color: #657b83
            }

            /* Literal */
            c-[m] {
                color: #657b83
            }

            /* Literal.Number */
            c-[n] {
                color: #268bd2
            }

            /* Name */
            c-[o] {
                color: #657b83
            }

            /* Operator */
            c-[p] {
                color: #657b83
            }

            /* Punctuation */
            c-[s] {
                color: #6c71c4
            }

            /* Literal.String */
            c-[t] {
                color: #6c71c4
            }

            /* Literal.String.Single */
            c-[u] {
                color: #6c71c4
            }

            /* Literal.String.Double */
            c-[ch] {
                color: #2aa198
            }

            /* Comment.Hashbang */
            c-[cp] {
                color: #2aa198
            }

            /* Comment.Preproc */
            c-[cpf] {
                color: #2aa198
            }

            /* Comment.PreprocFile */
            c-[c1] {
                color: #2aa198
            }

            /* Comment.Single */
            c-[cs] {
                color: #2aa198
            }

            /* Comment.Special */
            c-[kc] {
                color: #d33682
            }

            /* Keyword.Constant */
            c-[kn] {
                color: #d33682
            }

            /* Keyword.Namespace */
            c-[kp] {
                color: #d33682
            }

            /* Keyword.Pseudo */
            c-[kr] {
                color: #d33682
            }

            /* Keyword.Reserved */
            c-[ld] {
                color: #657b83
            }

            /* Literal.Date */
            c-[nc] {
                color: #268bd2
            }

            /* Name.Class */
            c-[no] {
                color: #268bd2
            }

            /* Name.Constant */
            c-[nd] {
                color: #268bd2
            }

            /* Name.Decorator */
            c-[ni] {
                color: #268bd2
            }

            /* Name.Entity */
            c-[ne] {
                color: #268bd2
            }

            /* Name.Exception */
            c-[nf] {
                color: #268bd2
            }

            /* Name.Function */
            c-[nl] {
                color: #268bd2
            }

            /* Name.Label */
            c-[nn] {
                color: #268bd2
            }

            /* Name.Namespace */
            c-[py] {
                color: #268bd2
            }

            /* Name.Property */
            c-[ow] {
                color: #657b83
            }

            /* Operator.Word */
            c-[mb] {
                color: #657b83
            }

            /* Literal.Number.Bin */
            c-[mf] {
                color: #657b83
            }

            /* Literal.Number.Float */
            c-[mh] {
                color: #657b83
            }

            /* Literal.Number.Hex */
            c-[mi] {
                color: #657b83
            }

            /* Literal.Number.Integer */
            c-[mo] {
                color: #657b83
            }

            /* Literal.Number.Oct */
            c-[sa] {
                color: #6c71c4
            }

            /* Literal.String.Affix */
            c-[sb] {
                color: #6c71c4
            }

            /* Literal.String.Backtick */
            c-[sc] {
                color: #6c71c4
            }

            /* Literal.String.Char */
            c-[dl] {
                color: #6c71c4
            }

            /* Literal.String.Delimiter */
            c-[sd] {
                color: #6c71c4
            }

            /* Literal.String.Doc */
            c-[se] {
                color: #6c71c4
            }

            /* Literal.String.Escape */
            c-[sh] {
                color: #6c71c4
            }

            /* Literal.String.Heredoc */
            c-[si] {
                color: #6c71c4
            }

            /* Literal.String.Interpol */
            c-[sx] {
                color: #6c71c4
            }

            /* Literal.String.Other */
            c-[sr] {
                color: #6c71c4
            }

            /* Literal.String.Regex */
            c-[ss] {
                color: #6c71c4
            }

            /* Literal.String.Symbol */
            c-[fm] {
                color: #268bd2
            }

            /* Name.Function.Magic */
            c-[vc] {
                color: #cb4b16
            }

            /* Name.Variable.Class */
            c-[vg] {
                color: #cb4b16
            }

            /* Name.Variable.Global */
            c-[vi] {
                color: #cb4b16
            }

            /* Name.Variable.Instance */
            c-[vm] {
                color: #cb4b16
            }

            /* Name.Variable.Magic */
            c-[il] {
                color: #657b83
            }

            /* Literal.Number.Integer.Long */
        }
    </style>
    <style>
        /* Boilerplate: style-wpt */
        :root {
            --wpt-border: hsl(0, 0%, 60%);
            --wpt-bg: hsl(0, 0%, 95%);
            --wpt-text: var(--text);
            --wptheading-text: hsl(0, 0%, 30%);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --wpt-border: hsl(0, 0%, 30%);
                --wpt-bg: var(--borderedblock-bg);
                --wpt-text: var(--text);
                --wptheading-text: hsl(0, 0%, 60%);
            }
        }

        .wpt-tests-block {
            list-style: none;
            border-left: .5em solid var(--wpt-border);
            background: var(--wpt-bg);
            color: var(--wpt-text);
            margin: 1em auto;
            padding: .5em;
        }

        .wpt-tests-block summary {
            color: var(--wptheading-text);
            font-weight: normal;
            text-transform: uppercase;
        }

        .wpt-tests-block summary::marker {
            color: var(--wpt-border);
        }

        .wpt-tests-block summary:hover::marker {
            color: var(--wpt-text);
        }

        /*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
        .wpt-tests-block:not([open]) {
            padding: 0;
            border: none;
            background: none;
            font-size: 0.75em;
            line-height: 1;
            position: relative;
            margin: 1em 0 0;
        }

        .wpt-tests-block:not([open]) summary {
            position: absolute;
            right: 0;
            bottom: 0;
        }

        /*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
        .wpt-tests-block:not([open]):last-child {
            padding-bottom: 1px;
            margin-bottom: -1px;
        }

        /*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
        li:not(:last-child)>.wpt-tests-block:not([open]):last-child,
        dd:not(:last-child)>.wpt-tests-block:not([open]):last-child {
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .wpt-tests-block:not([open]):not(:hover) {
            opacity: 0.5;
        }

        .wpt-tests-list {
            list-style: none;
            display: grid;
            margin: 0;
            padding: 0;
            grid-template-columns: 1fr max-content auto auto;
            grid-column-gap: .5em;
        }

        .wpt-tests-block hr:last-child {
            display: none;
        }

        .wpt-test {
            display: contents;
        }

        .wpt-test>a {
            text-decoration: underline;
            border: none;
        }

        .wpt-test>.wpt-name {
            grid-column: 1;
        }

        .wpt-test>.wpt-results {
            grid-column: 2;
        }

        .wpt-test>.wpt-live {
            grid-column: 3;
        }

        .wpt-test>.wpt-source {
            grid-column: 4;
        }

        .wpt-test>.wpt-results {
            display: flex;
            gap: .1em;
        }

        .wpt-test .wpt-result {
            display: inline-block;
            height: 1em;
            width: 1em;
            border-radius: 50%;
            position: relative;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">
    <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet"
        type="text/css">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">CSS カラー HDR モジュール レベル 1</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types/#FPWD">W3C 最初の公開作業草案</a>、<time class="dt-updated"
                datetime="2025-12-02">2025年12月2日</time></p>
        <details open>
            <summary>この文書の詳細</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>このバージョン:
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2025/WD-css-color-hdr-1-20251202/">https://www.w3.org/TR/2025/WD-css-color-hdr-1-20251202/</a>
                    <dt>最新公開バージョン:
                    <dd><a href="https://www.w3.org/TR/css-color-hdr-1/">https://www.w3.org/TR/css-color-hdr-1/</a>
                    <dt>編集者ドラフト:
                    <dd><a
                            href="https://drafts.csswg.org/css-color-hdr-1/">https://drafts.csswg.org/css-color-hdr-1/</a>
                    <dt>履歴:
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/css-color-hdr-1/">https://www.w3.org/standards/history/css-color-hdr-1/</a>
                    <dt>フィードバック:
                    <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-color-hdr-1">CSSWG イシューレポジトリ</a>
                    <dd><a href="#issues-index">仕様内インライン</a>
                    <dt class="editor">編集者:
                    <dd class="editor p-author h-card vcard" data-editor-id="1438"><a class="p-name fn u-url url"
                            href="https://svgees.us/">Chris Lilley</a> (<span class="p-org org">W3C</span>)
                    <dt>この仕様への編集提案:
                    <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/css-color-hdr-1/Overview.bs">GitHub
                            エディター</a>
                    <dt>テストスイート:
                    <dd class="wpt-overview"><a
                            href="https://wpt.fyi/results/css/css-color-hdr/">https://wpt.fyi/results/css/css-color-hdr/</a>
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> ©
            2025 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr
                title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a
                href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/copyright/software-license/" rel="license"
                title="W3C Software and Document License">permissive document license</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">要約</span></h2>
        <p>このモジュールは、高ダイナミックレンジ（HDR）を有効にするために、CSS Color 4および5への追加機能を定義します。</p>
        <a href="https://www.w3.org/TR/CSS/">CSS</a>は、構造化文書（HTMLやXMLなど）の
        画面や紙などでのレンダリング方法を記述するための言語です。
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">この文書のステータス</span></h2>
    <div data-fill-with="status">
        <p><em>このセクションでは、本書が公開された時点でのステータスを説明します。
                現在のW3C出版物の一覧およびこの技術レポートの最新版は
                <a href="https://www.w3.org/TR/">W3C標準およびドラフトのインデックス</a>で参照できます。</em> </p>
        <p> この文書は、<a href="https://www.w3.org/groups/wg/css">CSSワーキンググループ</a> により
            <strong>作業草案</strong>として
            <a href="https://www.w3.org/policies/process/20250818/#recs-and-notes">勧告プロセス</a>に基づき公開されました。
            作業草案としての公開は、
            <abbr title="World Wide Web Consortium">W3C</abbr>およびその会員による支持を意味するものではありません。
        </p>
        <p> これはドラフト文書であり、
            今後更新・置き換え・廃止される場合があります。
            進行中の作業以外としてこの文書を引用することは不適切です。 </p>
        <p>ご意見は
            <a href="https://github.com/w3c/csswg-drafts/issues">GitHubでイシューを提出</a>（推奨）の形で
            「css-color-hdr」仕様コードをタイトルに含めて送信してください（例: “[css-color-hdr] <i>…コメント要約…</i>”）。
            すべてのイシューとコメントは
            <a href="https://lists.w3.org/Archives/Public/public-css-archive/">アーカイブ</a>されています。
            または、パブリックメーリングリスト
            （<a href="https://lists.w3.org/Archives/Public/www-style/">アーカイブ</a>）
            <a href="mailto:www-style@w3.org?Subject=%5Bcss-color-hdr%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>
            へのメールでも受け付けています。
        </p>
        <p>この文書は
            <a href="https://www.w3.org/policies/process/20250818/" id="w3c_process_revision">2025年8月18日付W3Cプロセス文書</a>
            に従って管理されています。
        </p>
        <p>この文書は、<a href="https://www.w3.org/policies/patent-policy/20200915/">W3C特許ポリシー</a>
            の下で運用されているグループによって作成されました。
            W3Cは、グループの成果物に関連してなされた<a href="https://www.w3.org/groups/wg/css/ipr" rel="disclosure">特許開示の公開リスト</a>を保持しており、
            そこに特許開示の手順も記載されています。
            個人が本当に特許に関する知識を有し、その特許が
            <a href="https://www.w3.org/policies/patent-policy/20200915/#def-essential">必須クレーム</a>
            を含むと考える場合には、
            <a href="https://www.w3.org/policies/patent-policy/20200915/#sec-Disclosure">W3C特許ポリシー第6節</a>
            に従い、その情報を開示する必要があります。
        </p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目次</h2>
        <ol class="toc" role="directory">
            <li>
                <a href="#intro"><span class="secno">1</span> <span class="content">はじめに</span></a>
                <ol class="toc">
                    <li><a href="#values"><span class="secno">1.1</span> <span class="content">値の定義</span></a>
                </ol>
            <li>
                <a href="#terminology"><span class="secno">2</span> <span class="content">HDR用語集</span></a>
                <ol class="toc">
                    <li><a href="#defining-dynamic-range"><span class="secno">2.1</span> <span
                                class="content">ダイナミックレンジの定義</span></a>
                    <li><a href="#introducing-headroom"><span class="secno">2.2</span> <span
                                class="content">ヘッドルームの導入</span></a>
                </ol>
            <li>
                <a href="#controlling-dynamic-range"><span class="secno">3</span> <span
                        class="content">ダイナミックレンジの制御</span></a>
                <ol class="toc">
                    <li><a href="#the-dynamic-range-limit-property"><span class="secno">3.1</span> <span
                                class="content"><span class="property">dynamic-range-limit</span>プロパティ</span></a>
                    <li><a href="#dynamic-range-limit-mix"><span class="secno">3.2</span> <span
                                class="content">ダイナミックレンジ制限のミックス：<span
                                    class="css">dynamic-range-limit-mix()</span>関数</span></a>
                    <li><a href="#computing-dynamic-range-limit"><span class="secno">3.3</span> <span class="content">
                                <span class="property">dynamic-range-limit</span> の算出値</span></a>
                </ol>
            <li><a href="#color-syntax"><span class="secno">4</span> <span class="content"><span
                            class="production">&lt;color></span>構文</span></a>
            <li>
                <a href="#hdr-color-function"><span class="secno">5</span> <span
                        class="content">HDR色のヘッドルームによるパラメータ化：<span class="css">hdr-color()</span>関数</span></a>
                <ol class="toc">
                    <li><a href="#headroom-interpolation"><span class="secno">5.1</span> <span
                                class="content">ヘッドルームに基づく色の補間</span></a>
                </ol>
            <li>
                <a href="#DI-HDR"><span class="secno">6</span> <span class="content">デバイス非依存HDR色</span></a>
                <ol class="toc">
                    <li><a href="#ictcp-intro"><span class="secno">6.1</span> <span
                                class="content">ICtCp（アイシーティーシーピー）の紹介</span></a>
                    <li><a href="#jaz-intro"><span class="secno">6.2</span> <span
                                class="content">JzazbzとJzCzhzの紹介</span></a>
                    <li><a href="#ICtCp"><span class="secno">6.3</span> <span
                                class="content"><span>ICtCp</span></span></a>
                    <li><a href="#Jzazbz"><span class="secno">6.4</span> <span
                                class="content"><span>Jzazbz</span></span></a>
                    <li>
                        <a href="#JzCzhz"><span class="secno">6.5</span> <span
                                class="content"><span>JzCzhz</span></span></a>
                        <ol class="toc">
                            <li><a href="#Jzazbz-to-JzCzHz"><span class="secno">6.5.1</span> <span class="content"><span
                                            class="css">Jzazbz</span>色を<span class="css">JzCzhz</span>色へ変換</span></a>
                            <li><a href="#JzCzHz-to-Jzazbz"><span class="secno">6.5.2</span> <span
                                        class="content">JzCzhz色をJzazbz色へ変換</span></a>
                        </ol>
                </ol>
            <li><a href="#color-function"><span class="secno">7</span> <span
                        class="content">あらかじめ定義されたカラースペースとカスタムカラースペースの指定：<span class="css">color()</span>関数</span></a>
            <li>
                <a href="#predefined-HDR"><span class="secno">8</span> <span
                        class="content">HDR用あらかじめ定義されたカラースペース：</span></a>
                <ol class="toc">
                    <li><a href="#valdef-color-rec2100-pq"><span class="secno">8.1</span> <span
                                class="content"><span>rec2100-pq</span></span></a>
                    <li><a href="#valdef-color-rec2100-hlg"><span class="secno">8.2</span> <span
                                class="content"><span>rec2100-hlg</span></span></a>
                    <li><a href="#valdef-color-rec2100-linear"><span class="secno">8.3</span> <span
                                class="content"><span>rec2100-linear</span></span></a>
                </ol>
            <li><a href="#Compositing-SDR-HDR"><span class="secno">9</span> <span
                        class="content">SDRとHDRコンテンツの合成</span></a>
            <li>
                <a href="#serializing-color-values"><span class="secno">10</span> <span class="content"><span
                            class="production">&lt;color></span>値のシリアライズ</span></a>
                <ol class="toc">
                    <li><a href="#serializing-color-function-values"><span class="secno">10.1</span> <span
                                class="content"><span class="css">color()</span>関数の値のシリアライズ</span></a>
                </ol>
            <li>
                <a href="#color-conversion-code"><span class="secno">11</span> <span
                        class="content">色変換のサンプルコード</span></a>
                <ol class="toc">
                    <li><a href="#rec2100-linear_code"><span class="secno">11.1</span> <span class="content"><span
                                    class="css">rec2100-linear</span>のサンプルコード</span></a>
                    <li><a href="#rec2100-pq_code"><span class="secno">11.2</span> <span class="content"><span
                                    class="css">rec2100-pq</span>のサンプルコード</span></a>
                    <li><a href="#rec2100-hlg_code"><span class="secno">11.3</span> <span class="content"><span
                                    class="css">rec2100-hlg</span>のサンプルコード</span></a>
                    <li><a href="#jzazbz_code"><span class="secno">11.4</span> <span class="content"><span
                                    class="css">jzazbz</span>のサンプルコード</span></a>
                    <li><a href="#ictcp_code"><span class="secno">11.5</span> <span class="content"><span
                                    class="css">ICtCp</span>のサンプルコード</span></a>
                    <li><a href="#hdr-color-code"><span class="secno">11.6</span> <span class="content"><span
                                    class="css">hdr-color()</span>のサンプルコード</span></a>
                </ol>
            <li><a href="#deltaE"><span class="secno">12</span> <span class="content">ΔEITP 色差のサンプルコード</span></a>
            <li><a href="#privacy"><span class="secno"></span> <span class="content">プライバシーに関する考慮事項</span></a>
            <li><a href="#security"><span class="secno"></span> <span class="content">セキュリティに関する考慮事項</span></a>
            <li><a href="#a11y"><span class="secno"></span> <span class="content">アクセシビリティに関する考慮事項</span></a>
            <li>
                <a href="#changes"><span class="secno"></span> <span class="content">変更点</span></a>
                <ol class="toc">
                    <li><a href="#changes-20241217"><span class="secno"></span> <span class="content">変更点（2024年12月17日の
                                最初の公開草案 以降）</span></a>
                </ol>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content">適合性</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">文書上の規約</span></a>
                    <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span
                                class="content">適合クラス</span></a>
                    <li>
                        <a href="#w3c-partial"><span class="secno"></span> <span class="content">部分実装</span></a>
                        <ol class="toc">
                            <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span
                                        class="content">不安定および独自機能の実装</span></a>
                        </ol>
                    <li><a href="#w3c-testing"><span class="secno"></span> <span class="content">非実験的実装</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本仕様書で定義されている用語</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">参照によって定義された用語</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">規範的参考文献</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">参考情報</span></a>
                </ol>
            <li><a href="#property-index"><span class="secno"></span> <span class="content">プロパティ索引</span></a>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">課題索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span
                class="content">はじめに</span><a class="self-link" href="#intro"></a></h2>
        <p><em>このセクションは規範的ではありません。</em></p>
        <p>CSS Color 4 は、オープンウェブプラットフォームにワイドカラ―ガマット（WCG）カラースペースを追加します。
            設計上、これらはすべて標準ダイナミックレンジ（SDR）カラースペースです。
            この仕様は、ハイダイナミックレンジ（HDR）をサポートするための追加機能を定義します。</p>
        <figure id="fig-eotf">
            <p><img alt src="./images/lin-srgb-hlg-pq.png" width="839"></p>
            <figcaption> 4つのカラースペースのエレクトロオプティカルトランスファ関数（EOTF）：
                拡張sRGBおよびリニアライトsRGB
                （CSS Color 4で定義）、および
                本仕様で定義されるパーセプチュアルクォンタイザー（PQ）とハイブリッドログガンマ（HLG）、
                出典：<a data-link-type="biblio" href="#biblio-rec_bt2100"
                    title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            </figcaption>
        </figure>
        <p>WCG仕様は数十年にわたり概ね安定していますが、
            HDR規格はまだ発展途上であり、
            過去10年の間に頻繁に改訂されています。</p>
        <h3 class="heading settled" data-level="1.1" id="values"><span class="secno">1.1. </span><span
                class="content">値の定義</span><a class="self-link" href="#values"></a></h3>
        <p>この仕様は<a href="https://www.w3.org/TR/CSS2/about.html#property-defs">CSSプロパティ定義規約</a>に従い、
            <a data-link-type="biblio" href="#biblio-css2"
                title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>の<a
                href="https://www.w3.org/TR/css-values-3/#value-defs">値定義構文</a>
            （<a data-link-type="biblio" href="#biblio-css-values-3"
                title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</a>）を使用します。
            この仕様で定義されていない値型は CSS Values &amp; Units <span
                title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</span>で定義されています。
            他のCSSモジュールと組み合わせることで、これらの値型の定義が拡張される場合があります。
        </p>
        <p>定義内で記載されたプロパティ固有の値に加えて、
            この仕様で定義されるすべてのプロパティは
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-values-4/#css-wide-keywords"
                id="ref-for-css-wide-keywords">CSS全体のキーワード</a>もプロパティ値として受け付けます。
            可読性のため、ここでは繰り返し明記していません。
        </p>
        <h2 class="heading settled" data-level="2" id="terminology"><span class="secno">2. </span><span
                class="content">HDR用語集</span><a class="self-link" href="#terminology"></a></h2>
        <h3 class="heading settled" data-level="2.1" id="defining-dynamic-range"><span class="secno">2.1. </span><span
                class="content">ダイナミックレンジの定義</span><a class="self-link" href="#defining-dynamic-range"></a>
        </h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="dynamic-range">ダイナミックレンジ</dfn>とは、
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#luminance"
                id="ref-for-luminance">輝度</a>のうち、<em>最も明るい</em>色と<em>最も暗い</em>色の差です。
            ダイナミックレンジは写真用語の<em>ストップ</em>で測定されます。
            1ストップは輝度が2倍になることを意味します。
        </p>
        <pre class="lang-js highlight"><c- a>function</c-> DynamicRange <c- p>(</c->high<c- p>,</c-> low<c- p>)</c-> <c- p>{</c->
  <c- k>return</c-> Math<c- p>.</c->log2<c- p>(</c->high<c- p>)</c-> <c- o>-</c-> Math<c- p>.</c->log2<c- p>(</c->low<c- p>);</c->
  <c- p>}</c-> 
</pre>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="hdr-reference-white">HDR基準白</dfn>
            （メディアホワイトとも呼ばれる）は、通常の白い背景や
            暗い背景上の白いテキストの色です。
            画面全体で快適に見られる色です。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="standard-dynamic-range">標準ダイナミックレンジ</dfn>（SDR）では、
            HDR基準白も
            最も明るい色であり、
            赤・緑・青全てが最大強度で発色したときの色です。</p>
        <div class="example" id="ex-SDR-dynamic-range"><a class="self-link" href="#ex-SDR-dynamic-range"></a> 例えば、
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#sRGB-space"
                id="ref-for-sRGB-space">sRGB</a>では、
            標準視聴環境下で
            白の輝度は80cd/m²、
            黒の輝度は0.2cd/m²に定義されています。
            この場合、ダイナミックレンジは8.6ストップです。
        </div>
        <p>画面の全体的な輝度はユーザーの好みや標準とは異なる視聴条件に合わせて
            調整されることが一般的です。</p>
        <p>SDRの場合、画面を明るくしてもダイナミックレンジは変化しません。
            なぜなら最も暗い色も同様に明るくなるからです。</p>
        <div class="example" id="ex-SDR-brighter-dynamic-range"><a class="self-link"
                href="#ex-SDR-brighter-dynamic-range"></a> 例えば、<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-color-4/#sRGB-space" id="ref-for-sRGB-space①">sRGB</a>の画面で
            白の輝度を160cd/m²、
            最も暗い黒の輝度を0.4cd/m²に設定したとします。
            ダイナミックレンジは依然として8.6ストップです。</div>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="high-dynamic-range">ハイダイナミックレンジ</dfn>
            （HDR）では、
            <a data-link-type="dfn" href="#hdr-reference-white"
                id="ref-for-hdr-reference-white">HDR基準白</a>よりも明るい色を表示できます。
            たとえば、HDRディスプレイでHDR基準白が203cd/m²に設定されていても、
            小さなハイライトで1000cd/m²を表示できる場合があります。
            通常、最も明るい色は
            画面のごく一部、かつ限られた時間のみ表示されます。
            これは消費電力や発熱による制約のためです。
        </p>
        <div class="example" id="ex-HDR-dynamic-range"><a class="self-link" href="#ex-HDR-dynamic-range"></a>
            たとえば、HDR基準マスタリングディスプレイでは、
            小面積ピークホワイトの輝度が1000cd/m²、
            最も暗い黒の輝度が0.05cd/m²の場合、
            ダイナミックレンジは14.3ストップです。</div>
        <p>HDRでは、画面を明るくするとダイナミックレンジが広がりますが、
            HDR基準白の輝度は一定です。</p>
        <div class="example" id="ex-HDR-PQ-dynamic-range"><a class="self-link" href="#ex-HDR-PQ-dynamic-range"></a>
            たとえば、<span class="css">rec2100-pq</span>カラースペース（<a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>で定義）の場合、
            最も明るいピークホワイトは10,000cd/m²、
            最も暗い黒は0.001cd/m²と定義されており、
            エンコードされたダイナミックレンジは23.3ストップです。</div>
        <p class="issue" id="issue-b905ab0c"><a class="self-link" href="#issue-b905ab0c"></a>
            SDRとHDRのダイナミックレンジを対数スケールで示した図を追加すること</p>
        <p><a href="#Compositing-SDR-HDR">§ 9 SDRとHDRコンテンツの合成</a>や
            色空間変換時には、
            SDRコンテンツのHDR基準白を
            <strong>203cd/m²</strong>に固定する必要があります
            <a data-link-type="biblio" href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a>。
            これにより合成入力のHDR基準白レベルは
            合成後の信号のHDR基準白レベルに合致します。
        </p>
        <p>HDR（またはSDRとHDRの混合）コンテンツを表示する際、
            基準マスタリングディスプレイより能力の低いディスプレイや
            標準とは異なる視聴環境の場合には、
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="color-re-rendering">色再レンダリング</dfn>
            （OOTF）が行われます。
            これにより、HDR基準白が203 cd/m² より低くも高くも表示される場合があります。
        </p>
        <h3 class="heading settled" data-level="2.2" id="introducing-headroom"><span class="secno">2.2. </span><span
                class="content">ヘッドルームの導入</span><a class="self-link" href="#introducing-headroom"></a></h3>
        <p>HDRディスプレイが出力できるピーク
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#luminance"
                id="ref-for-luminance①">輝度</a>レベルは
            大きく異なります。
        </p>
        <p>ピークホワイトがHDR基準白よりどれだけ高いかを
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="hdr-headroom">HDRヘッドルーム</dfn>と呼び、
            これはHDR基準白のレベルや
            ユーザーの好み、
            また視聴条件に依存します。
        </p>
        <p>ヘッドルームは通常、写真用語の<strong>ストップ</strong>で表されます。
            このため、<a data-link-type="dfn" href="#standard-dynamic-range"
                id="ref-for-standard-dynamic-range">標準ダイナミックレンジ</a>（SDR）は
            <a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom">HDRヘッドルーム</a>が0ストップであり、
            最も明るい白がHDR基準白となります。
        </p>
        <div class="example" id="ex-low-headroom"><a class="self-link" href="#ex-low-headroom"></a> 例えば、
            低価格帯HDRディスプレイ
            （<a href="https://displayhdr.org/">DisplayHDR 400</a>の要件を<em>ぎりぎり</em>満たす
            Vesa Certified DisplayHDR認証の最下位グレード<a data-link-type="biblio" href="#biblio-displayhdr"
                title="Summary of DisplayHDR Specs under CTS 1.2">[DisplayHDR]</a>）では、
            HDR基準白が最大200cd/m<sup>2</sup>、ピークホワイトが
            400cd/m<sup>2</sup>で、HDRヘッドルームは1ストップしかありません。</div>
        <div class="example" id="ex-high-headroom">
            <a class="self-link" href="#ex-high-headroom"></a> 例えば、ハイエンドHDRディスプレイ
            （<a href="https://displayhdr.org/">DisplayHDR 1400</a>の要件を超える
            現在最高グレードのDisplayHDR認証ディスプレイ）では、
            HDR基準白が最大400cd/m<sup>2</sup>、ピークホワイトが
            1600cd/m<sup>2</sup>です。
            <p>暗い視聴環境で
                HDR基準白を100cd/m<sup>2</sup>に設定した場合、
                HDRヘッドルームは4ストップ（16倍）になります。</p>
        </div>
        <p id="headroom-privacy"> Webプラットフォームは現在のところ、
            ディスプレイのヘッドルームの値を直接公開していません。
            これは視聴条件に依存し、
            リアルタイムかつ未量子化のヘッドルーム情報が
            トラッキングの手段になる可能性があるためです
            （たとえばユーザーが屋外に移動して日差しが強いことなどが検知できる）。</p>
        <p id="constrained-headroom"> 常に最大限のHDRヘッドルームを使うことが
            望ましいとは限りません。
            CSSでは、大まかにどれだけのヘッドルームを使用するか
            コントロールする方法が提供されています。
            このレベルは要素ごと、あるいは時間によっても異なる場合があります。</p>
        <div class="example" id="ex-photo-grid"><a class="self-link" href="#ex-photo-grid"></a>
            例えば、写真のグリッドを表示するWebページを考えます。
            これらの写真の中にはHDRや、太陽に直射した非常にダイナミックレンジの高い画像も含まれています。
            全写真を最大ダイナミックレンジで同時に表示すると目が疲れてしまいます。
            かといってすべてSDRレンジに収めてしまうと、
            個々の写真の特徴を十分に表現できません。
            ここでの設計目標は、「十分な」HDRを表示し
            写真群を有意義に評価できるようにすることです。
        </div>
        <h2 class="heading settled" data-level="3" id="controlling-dynamic-range"><span class="secno">3. </span><span
                class="content">ダイナミックレンジの制御</span><a class="self-link" href="#controlling-dynamic-range"></a></h2>
        <h3 class="heading settled" data-level="3.1" id="the-dynamic-range-limit-property"><span class="secno">3.1.
            </span><span class="content"><a class="property css" data-link-type="property"
                    href="#propdef-dynamic-range-limit" id="ref-for-propdef-dynamic-range-limit">dynamic-range-limit</a>
                プロパティ</span><a class="self-link" href="#the-dynamic-range-limit-property"></a></h3>
        <table class="def propdef" data-link-for-hint="dynamic-range-limit">
            <tbody>
                <tr>
                    <th>名前:
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-dynamic-range-limit">dynamic-range-limit</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">値:</a>
                    <td class="prod">standard <a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one">|</a> no-limit
                        <span id="ref-for-comb-one①">|</span> constrained <span id="ref-for-comb-one②">|</span> <a
                            class="production css" data-link-type="function" href="#funcdef-dynamic-range-limit-mix"
                            id="ref-for-funcdef-dynamic-range-limit-mix">&lt;dynamic-range-limit-mix()></a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">初期値:</a>
                    <td>no-limit
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">適用対象:</a>
                    <td><a href="https://www.w3.org/TR/css-pseudo/#generated-content"
                            title="Includes ::before and ::after pseudo-elements.">すべての要素</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">継承:</a>
                    <td>はい
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">パーセンテージ:</a>
                    <td>該当なし
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">算出値:</a>
                    <td><a href="#computing-dynamic-range-limit">dynamic-range-limit の算出値</a>を参照
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">正規順序:</a>
                    <td>文法通り
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">アニメーション型:</a>
                    <td><a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                            id="ref-for-funcdef-dynamic-range-limit-mix①">dynamic-range-limit-mix()</a>による
        </table>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>テスト</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/inheritance.html"
                        title="css/css-color-hdr/inheritance.html">inheritance.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/inheritance.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/inheritance.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/interpolation.html"
                        title="css/css-color-hdr/interpolation.html">interpolation.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/interpolation.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/interpolation.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/parsing.html"
                        title="css/css-color-hdr/parsing.html">parsing.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/parsing.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/parsing.html"><small>(ソース)</small></a>
            </ul>
        </details>
        <dl>
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-standard">standard</dfn>
            <dd> 表示される最大の輝度色が、
                HDR基準白（つまりCSS色の<a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white">white</a>）と同じになります。
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-no-limit">no-limit</dfn>
            <dd> 表示される最大ピーク輝度が
                HDR基準白（つまりCSS色の<a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white①">white</a>）よりもはるかに高くなります。正確なレベルは指定されていません。
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-constrained">constrained</dfn>
            <dd> 表示される最大ピーク輝度が
                HDR基準白（つまりCSS色の<a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white②">white</a>）よりやや高くなり、
                SDRとHDRのコンテンツを快適に一緒に表示できるようにします。
        </dl>
        <div class="example" id="ex-hdr-limit-photogrid">
            <a class="self-link" href="#ex-hdr-limit-photogrid"></a>
            <pre class="lang-css highlight">body <c- p>{</c-> <c- k>dynamic-range-limit</c-><c- p>:</c-> standard<c- p>;</c-> <c- p>}</c->
div.photogrid img <c- p>{</c-> <c- k>dynamic-range-limit</c-><c- p>:</c-> constrained <c- p>}</c->
</pre>
        </div>
        <h3 class="heading settled" data-level="3.2" id="dynamic-range-limit-mix"><span class="secno">3.2. </span><span
                class="content">ダイナミックレンジ制限のミックス：<a class="css" data-link-type="maybe"
                    href="#funcdef-dynamic-range-limit-mix"
                    id="ref-for-funcdef-dynamic-range-limit-mix②">dynamic-range-limit-mix()</a>関数</span><a
                class="self-link" href="#dynamic-range-limit-mix"></a></h3>
        <p>この関数は1つ以上の<a class="property css" data-link-type="property" href="#propdef-dynamic-range-limit"
                id="ref-for-propdef-dynamic-range-limit①">dynamic-range-limit</a>値を受け取り、
            それらを内部的にHDR基準白からのストップ値へ変換し、
            指定の比率でミックスした結果にディスプレイを調整します。
            プライバシー保護のため、実際の計算結果は外部には公開されません。</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-dynamic-range-limit-mix">dynamic-range-limit-mix()</dfn> = dynamic-range-limit-mix( [ <a class="production" data-link-type="property" href="#propdef-dynamic-range-limit" id="ref-for-propdef-dynamic-range-limit②">&lt;'dynamic-range-limit'></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-all" id="ref-for-comb-all">&amp;&amp;</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value">&lt;percentage [0,100]></a> ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-comma" id="ref-for-mult-comma">#{2,}</a> )
</pre>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>テスト</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/inheritance.html"
                        title="css/css-color-hdr/inheritance.html">inheritance.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/inheritance.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/inheritance.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/interpolation.html"
                        title="css/css-color-hdr/interpolation.html">interpolation.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/interpolation.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/interpolation.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/parsing.html"
                        title="css/css-color-hdr/parsing.html">parsing.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/parsing.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/parsing.html"><small>(ソース)</small></a>
            </ul>
        </details>
        <h3 class="heading settled" data-level="3.3" id="computing-dynamic-range-limit"><span class="secno">3.3.
            </span><span class="content"><a class="property css" data-link-type="property"
                    href="#propdef-dynamic-range-limit"
                    id="ref-for-propdef-dynamic-range-limit③">dynamic-range-limit</a> の算出値</span><a class="self-link"
                href="#computing-dynamic-range-limit"></a></h3>
        <p>指定値が<a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                id="ref-for-valdef-dynamic-range-limit-standard">standard</a>、<a class="css" data-link-type="maybe"
                href="#valdef-dynamic-range-limit-constrained"
                id="ref-for-valdef-dynamic-range-limit-constrained">constrained</a>、または<a class="css"
                data-link-type="maybe" href="#valdef-dynamic-range-limit-no-limit"
                id="ref-for-valdef-dynamic-range-limit-no-limit">no-limit</a>である場合、算出値は指定値と同一です。</p>
        <p>指定値が<a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                id="ref-for-funcdef-dynamic-range-limit-mix③">dynamic-range-limit-mix()</a>の場合、算出値は以下のアルゴリズムで決定されます。</p>
        <ol>
            <li data-md>
                <p>混合するパラメータの算出値を <var>v1</var> ～ <var>vN</var> とする。</p>
            <li data-md>
                <p>混合比率（パーセンテージ）を <var>p1</var> ～ <var>pN</var> とし、合計が100%になるよう正規化する。</p>
            <li data-md>
                <p>寄与率を次のように定義する：</p>
                <ul>
                    <li data-md>
                        <p> <var>v1</var> ～ <var>vN</var> で <a class="css" data-link-type="maybe"
                                href="#valdef-dynamic-range-limit-standard"
                                id="ref-for-valdef-dynamic-range-limit-standard①">standard</a> であるもののパーセンテージを
                            <var>p1_standard</var> ～ <var>pN_standard</var> とする。
                        </p>
                    <li data-md>
                        <p><var>v1</var> ～ <var>vN</var> で <a class="css" data-link-type="maybe"
                                href="#valdef-dynamic-range-limit-constrained"
                                id="ref-for-valdef-dynamic-range-limit-constrained①">constrained</a> であるもののパーセンテージを
                            <var>p1_constrained_high</var> ～ <var>pN_constrained_high</var> とする。
                        </p>
                    <li data-md>
                        <p><var>v1</var> ～ <var>vN</var> で <a class="css" data-link-type="maybe"
                                href="#valdef-dynamic-range-limit-no-limit"
                                id="ref-for-valdef-dynamic-range-limit-no-limit①">no-limit</a> であるもののパーセンテージを
                            <var>p1_no_limit</var> ～ <var>pN_no_limit</var> とする。
                        </p>
                </ul>
            <li data-md>
                <p>重み付き合計を次のように計算する：</p>
                <ul>
                    <li data-md>
                        <p><var>p_standard</var> =
                            (<var>p1_standard</var>*<var>p1</var>+...+<var>pN_standard</var>*<var>pN</var>)/100</p>
                    <li data-md>
                        <p><var>p_constrained_high</var> =
                            (<var>p1_constrained_high</var>*<var>p1</var>+...+<var>pN_constrained_high</var>*<var>pN</var>)/100
                        </p>
                    <li data-md>
                        <p><var>p_no_limit</var> =
                            (<var>p1_no_limit</var>*<var>p1</var>+...+<var>pN_no_limit</var>*<var>pN</var>)/100</p>
                </ul>
            <li data-md>
                <p><var>p_standard</var>、<var>p_constrained_high</var>、または<var>p_no_limit</var>のいずれかが100%の場合、算出値はそれぞれ<a
                        class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                        id="ref-for-valdef-dynamic-range-limit-standard②">standard</a>、<a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-constrained"
                        id="ref-for-valdef-dynamic-range-limit-constrained②">constrained</a>、<a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-no-limit"
                        id="ref-for-valdef-dynamic-range-limit-no-limit②">no-limit</a> となる。</p>
            <li data-md>
                <p>それ以外の場合、算出値は<a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                        id="ref-for-funcdef-dynamic-range-limit-mix④">dynamic-range-limit-mix()</a> となり、パラメータは <a
                        class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                        id="ref-for-valdef-dynamic-range-limit-standard③">standard</a>、<a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-constrained"
                        id="ref-for-valdef-dynamic-range-limit-constrained③">constrained</a>、<a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-no-limit"
                        id="ref-for-valdef-dynamic-range-limit-no-limit③">no-limit</a>（この順）、および割合
                    <var>p_standard</var>、<var>p_constrained_high</var>、<var>p_no_limit</var>となり、割合が0%のものは省略する。<em>すべて</em>のパラメータが省略される場合、算出値は初期値となる。
                </p>
        </ol>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>テスト</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(ソース)</small></a>
            </ul>
        </details>
        <div class="example" id="ex-hdr-limit-mix">
            <a class="self-link" href="#ex-hdr-limit-mix"></a>次の
            <pre class="lang-css highlight"><c- nf>dynamic-range-limit-mix</c-><c- p>(</c->
    high <c- m>10</c-><c- k>%</c-><c- p>,</c->
    <c- nf>dynamic-range-limit-mix</c-><c- p>(</c->standard <c- m>25</c-><c- k>%</c-><c- p>,</c-> constrained <c- m>75</c-><c- k>%</c-><c- p>)</c-> <c- m>20</c-><c- k>%</c-><c- p>,</c->
    <c- nf>dynamic-range-limit-mix</c-><c- p>(</c->constrained <c- m>10</c-><c- k>%</c-><c- p>,</c-> no-limit <c- m>30</c-><c- k>%</c-><c- p>)</c-> <c- m>20</c-><c- k>%</c-><c- p>)</c->
</pre>
            <p>の算出値は</p>
            <pre class="lang-css highlight"><c- nf>dynamic-range-limit-mix</c-><c- p>(</c->standard <c- m>10</c-><c- k>%</c-><c- p>,</c-> constrained <c- m>40</c-><c- k>%</c-><c- p>,</c-> no-limit <c- m>50</c-><c- k>%</c-><c- p>)</c->
</pre>
        </div>
        <h2 class="heading settled" data-level="4" id="color-syntax"><span class="secno">4. </span><span
                class="content"><a class="production css" data-link-type="type"
                    href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color">&lt;color></a>
                構文</span><a class="self-link" href="#color-syntax"></a></h2>
        <p>このモジュールは <a class="production css" data-link-type="type" href="#typedef-color-function"
                id="ref-for-typedef-color-function">&lt;color-function></a> 型を拡張します：</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-color-function">&lt;color-function></dfn> = <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-4/#funcdef-rgb" id="ref-for-funcdef-rgb">&lt;rgb()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-4/#funcdef-rgba" id="ref-for-funcdef-rgba">&lt;rgba()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④">|</a>
    <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-4/#funcdef-hsl" id="ref-for-funcdef-hsl">&lt;hsl()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑤">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-4/#funcdef-hsla" id="ref-for-funcdef-hsla">&lt;hsla()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑥">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-hwb" id="ref-for-funcdef-hwb">&lt;hwb()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑦">|</a>
    <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-lab" id="ref-for-funcdef-lab">&lt;lab()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑧">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-lch" id="ref-for-funcdef-lch">&lt;lch()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑨">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-oklab" id="ref-for-funcdef-oklab">&lt;oklab()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⓪">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-oklch" id="ref-for-funcdef-oklch">&lt;oklch()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①①">|</a>
    <a class="production" data-link-type="function" href="#funcdef-ictcp" id="ref-for-funcdef-ictcp">&lt;ictcp()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①②">|</a> <a class="production" data-link-type="function" href="#funcdef-jzazbz" id="ref-for-funcdef-jzazbz">&lt;jzazbz()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①③">|</a> <a class="production" data-link-type="function" href="#funcdef-jzczhz" id="ref-for-funcdef-jzczhz">&lt;jzczhz()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①④">|</a>
    <a class="production" data-link-type="function" href="https://drafts.csswg.org/css-color-5/#funcdef-alpha" id="ref-for-funcdef-alpha">&lt;alpha()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑤">|</a>
    <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-color" id="ref-for-funcdef-color">&lt;color()></a>
<dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-ictcp">ictcp()</dfn> = ictcp([from <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color①">&lt;color></a>]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt">?</a>
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value①">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑥">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑦">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value②">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑧">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value①">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑨">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value③">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⓪">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value②">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②①">|</a> none]
  [ / [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" id="ref-for-typedef-color-alpha-value">&lt;alpha-value></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②②">|</a> none] ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt①">?</a> )
<dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-jzazbz">jzazbz()</dfn> = jzazbz([from <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color②">&lt;color></a>]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt②">?</a>
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value④">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②③">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value③">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②④">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value⑤">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑤">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value④">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑥">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value⑥">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑦">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value⑤">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑧">|</a> none]
  [ / [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" id="ref-for-typedef-color-alpha-value①">&lt;alpha-value></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑨">|</a> none] ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt③">?</a> )
<dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-jzczhz">jzczhz()</dfn> = jzczhz([from <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color③">&lt;color></a>]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt④">?</a>
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value⑦">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⓪">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value⑥">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③①">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value⑧">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③②">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value⑦">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③③">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-hue" id="ref-for-typedef-hue">&lt;hue></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③④">|</a> none]
  [ / [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" id="ref-for-typedef-color-alpha-value②">&lt;alpha-value></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⑤">|</a> none] ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt⑤">?</a> )
</pre>
        <h2 class="heading settled" data-level="5" id="hdr-color-function"><span class="secno">5. </span><span
                class="content">HDR色のヘッドルームによるパラメータ化： <a class="css" data-link-type="maybe" href="#funcdef-hdr-color"
                    id="ref-for-funcdef-hdr-color">hdr-color()</a> 関数</span><a class="self-link"
                href="#hdr-color-function"></a></h2>
        <p><a class="css" data-link-type="maybe" href="#funcdef-hdr-color"
                id="ref-for-funcdef-hdr-color①">hdr-color()</a> 関数は、<a data-link-type="dfn" href="#hdr-headroom"
                id="ref-for-hdr-headroom①">HDRヘッドルーム</a>に基づいて自動的に値が計算される色の範囲を指定できます。</p>
        <p>これは、2つの<a class="production css" data-link-type="type"
                href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color④">&lt;color></a>値を、
            それぞれHDRヘッドルームのレベルとともに指定することで実現します。
            （2つのヘッドルーム値は異なる必要があります）。
            実際の値は、現在のHDRヘッドルーム量に基づいて
            これら2つの色の間を補間して計算されます。
            詳細は <a href="#headroom-interpolation">§ 5.1 ヘッドルームに基づく色の補間</a> で説明します。</p>
        <div class="informative"> これは、
            <a data-link-type="biblio" href="#biblio-iso_21496-1"
                title="Gain map metadata for image conversion: Part 1: Dynamic Range Conversion">[ISO_21496-1]</a>
            に準拠したラスター画像の
            ゲインマップや、
            <a data-link-type="biblio" href="#biblio-smpte-st-2094-50"
                title="Dynamic Metadata for Color Volume Transform - Application #5 (Broadcast)">[SMPTE-ST-2094-50]</a>
            のアダプティブゲインカーブに
            類似した仕組みです。
        </div>
        <p>プライバシー保護のため、実際に計算された色や
            実際のHDRヘッドルームの値は公開されません。
            これはフィンガープリント防止のためです。</p>
        <p>その構文は次の通りです：</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-hdr-color">hdr-color()</dfn> = color-hdr([ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color⑤">&lt;color></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-all" id="ref-for-comb-all①">&amp;&amp;</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value⑧">&lt;number [0,∞]></a><a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt⑥">?</a> ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-comma" id="ref-for-mult-comma①">#{2}</a>)
</pre>
        <div class="example" id="ex-hdr-color-simple">
            <a class="self-link" href="#ex-hdr-color-simple"></a> 次の色を考えてみましょう：
            <pre class="lang-css highlight"><c- nf>color-hdr</c-><c- p>(</c->
  <c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>0.9</c-> <c- m>1.0</c-> <c- m>0.8</c-><c- p>)</c-> <c- m>0</c-><c- p>,</c->
  <c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>1.8</c-> <c- m>2.0</c-> <c- m>1.5</c-><c- p>)</c-> <c- m>2</c-><c- p>);</c->
</pre>
            <p><a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom②">HDRヘッドルーム</a> &lt;=
                0、つまりSDRディスプレイの場合、この色は次のように表示されます：</p>
            <pre
                class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>0.9</c-> <c- m>1.0</c-> <c- m>0.8</c-><c- p>)</c-></pre>
            <p><a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom③">HDRヘッドルーム</a> >= 2 のディスプレイでは、</p>
            <pre class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>1.8</c-> <c- m>2.0</c-> <c- m>1.5</c-><c- p>)</c-> <c- m>2</c-><c- p>);</c->
</pre>
            <p>ヘッドルームが 0 〜 2 の間の場合、色は補間されます。<a href="#ex-hdr-interpolate">例</a>として、
                HDRヘッドルーム 1 のディスプレイの場合は：</p>
            <p>X = 243.664, Y = 275.713, Z = 244.000</p>
        </div>
        <p>色は <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="absolute-d65-cie-xyz">絶対D65 CIE XYZ</dfn>
            で補間されます。</p>
        <p>これは <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-xyz-d65"
                id="ref-for-valdef-color-xyz-d65">xyz-d65</a> から、各成分に 203 を掛けることで導出されます <a data-link-type="biblio"
                href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a>。
            これは、相対単位（白のY=1）から絶対単位（cd/m²、ニットとも呼ばれる）への変換です。
            <a href="#color-conversion-code">サンプルコード</a> では、この定数を <var>Yw</var>（HDR基準白の輝度）としています。
        </p>
        <div class="example" id="ex-rel-to-abs">
            <a class="self-link" href="#ex-rel-to-abs"></a> 例えば、CSS色 <a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-color-4/#valdef-color-white" id="ref-for-valdef-color-white③">white</a>
            は
            <pre
                class="lang-css highlight"><c- nf>color</c-><c- p>(</c->xyz-d65 <c- m>0.9505</c-> <c- m>1</c-> <c- m>1.089</c-><c- p>)</c-></pre>
            <p>絶対D65 XYX では
                [192.9426, 203, 221.0787] となります。</p>
        </div>
        <h3 class="heading settled" data-level="5.1" id="headroom-interpolation"><span class="secno">5.1. </span><span
                class="content"> ヘッドルームに基づく色の補間 </span><a class="self-link" href="#headroom-interpolation"></a></h3>
        <p>ヘッドルーム <var>H1</var> の色 <var>c1</var> とヘッドルーム <var>H2</var> の色 <var>c2</var> を
            ヘッドルーム <var>H</var> で補間し、結果カラ <var>cxyz</var> を得るには、</p>
        <ol>
            <li data-md>
                <p><var>c1xyz</var> を <var>c1</var> を <a data-link-type="dfn" href="#absolute-d65-cie-xyz"
                        id="ref-for-absolute-d65-cie-xyz">絶対D65 CIE XYZ</a> に変換したものとする</p>
            <li data-md>
                <p><var>c2xyz</var> を <var>c2</var> を <a data-link-type="dfn" href="#absolute-d65-cie-xyz"
                        id="ref-for-absolute-d65-cie-xyz①">絶対D65 CIE XYZ</a> に変換したものとする</p>
            <li data-md>
                <p><var> w1</var> = clamp((<var>H</var> - <var>H2</var>) / (<var>H1</var> - <var>H2</var>), 0, 1)
                </p>
            <li data-md>
                <p><var> w2</var> = clamp((<var>H</var> - <var>H1</var>) / (<var>H2</var> - <var>H1</var>), 0, 1)
                    （なお、<var> w2</var> は 1 - <var> w1</var> です）</p>
            <li data-md>
                <p><var>eps</var> = 0.001</p>
            <li data-md>
                <p><var>cxyz</var> = Array(3)</p>
            <li data-md>
                <p>i が 0 〜 2 の間：
                    <var>cxyz</var>[i] = pow(<var>c1xyz</var>[i] + <var>eps</var>, <var>w1</var> ) *
                    pow(<var>c2xyz</var>[i] + <var>eps</var>, <var>w2</var> ) - <var>eps</var>
                </p>
        </ol>
        <p class="note" role="note"><span class="marker">Note:</span> <var>eps</var>
            は0除算を防ぐためのものであり、とくにSDR色で黒に近い場合の補間で重要です。</p>
        <div class="example" id="ex-hdr-interpolate">
            <a class="self-link" href="#ex-hdr-interpolate"></a> 例：c1 = color(rec2100-linear 0.9 1.0
            0.8),
            c2 = color(rec2100-linear 1.8 2.0 1.5),
            H1 = 0, H2 = 2, H = 1 の場合：
            <pre class="lang-css highlight">c1xyz = <c- p>[</c-> <c- m>173.156</c-><c- p>,</c-> <c- m>195.260</c-><c- p>,</c-> <c- m>178.003</c-> <c- p>]</c->
c2xyz = <c- p>[</c-> <c- m>342.883</c-><c- p>,</c-> <c- m>389.315</c-><c- p>,</c-> <c- m>334.467</c-> <c- p>]</c->
w1 = <c- m>0.5</c->
w2 = <c- m>0.5</c->
cxyz = <c- p>[</c-> <c- m>243.664</c-><c- p>,</c-> <c- m>275.713</c-><c- p>,</c-> <c- m>244.000</c-> <c- p>]</c->
</pre>
        </div>
        <div class="example" id="ex-hdr-interpolate-2">
            <a class="self-link" href="#ex-hdr-interpolate-2"></a> 例：c1 = color(display-p3 1 1 0.33),
            c2 = jzczhz(70% 0.14 100),
            H1 = 0.5, H2 = 4, H = 2 の場合；
            <pre class="lang-css highlight">c1xyz = <c- p>[</c-> <c- m>156.285</c-><c- p>,</c-> <c- m>188.337</c-><c- p>,</c-> <c- m>28.015</c-> <c- p>]</c->
c2xyz = <c- p>[</c-> <c- m>3776.1434</c-><c- p>,</c-> <c- m>4362.407</c-><c- p>,</c-> <c- m>1577.913</c-> <c- p>]</c->
w1 = <c- m>0.571</c-> 
w2 = <c- m>0.429</c->
cxyz = <c- p>[</c-> <c- m>611.911</c-><c- p>,</c-> <c- m>724.180</c-><c- p>,</c-> <c- m>157.650</c-> <c- p>]</c->
</pre>
            <p>c1はすべてのヘッドルーム値 &lt;= 0.5 でそのまま使われ、c2はヘッドルーム値 >= 4 でそのまま使われることに注意してください。</p>
        </div>
        <h2 class="heading settled" data-level="6" id="DI-HDR"><span class="secno">6. </span><span class="content">
                デバイス非依存HDR色 </span><a class="self-link" href="#DI-HDR"></a></h2>
        <p><a href="https://www.w3.org/TR/css-color-4/#lab-colors"><cite>CSS Color 4</cite> § 9 デバイス非依存色: CIE
                LabとLCH、OklabおよびOKLCh</a>がデバイス非依存SDR色を指定できるようにするのと同様に、
            この仕様ではデバイス非依存HDR色を指定できます。</p>
        <h3 class="informative heading settled" data-level="6.1" id="ictcp-intro"><span class="secno">6.1. </span><span
                class="content"> ICtCp（アイシーティーシーピー）の紹介 </span><a class="self-link" href="#ictcp-intro"></a></h3>
        <p><em>このセクションは規範的ではありません。</em></p>
        <p>IC<sub>T</sub>C<sub>P</sub>色空間はCIE Labより知覚的な均一性に優れており、
            高ダイナミックレンジ（HDR）やワイドカラ―ガマット（WCG）画像向けの
            映像・デジタル写真システムのカラーパイプラインの一部として利用されています。</p>
        <p>TとPの下付き文字は、
            人間の視覚系のトリタノープ（黄-青軸）および
            プロタノープ（赤-緑軸）の対立色軸を示しています。
            下付き文字を省いて ICtCp と表記されることが多いです。</p>
        <p>IC<sub>T</sub>C<sub>P</sub>は
            Dolby Laboratories により、EbnerとFairchildのIPT色空間<a data-link-type="biblio" href="#biblio-development_itp"
                title="Development and testing of a color space (IPT) with improved hue uniformity. In: Proceedings of The Sixth Color Imaging Conference, 8-13, 1998">[Development_ITP]</a>をもとに開発され<a
                data-link-type="biblio" href="#biblio-what_is_ictcp" title="What is ICtCp, v7.1">[What_is_ICtCp]</a>、
            <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>で
            Constant Intensity IC<sub>T</sub>C<sub>P</sub>シグナルフォーマットとして定義されています。
            YCbCrの置換を意図しています<a data-link-type="biblio" href="#biblio-perrin"
                title="ICtCp Versus Y&apos;CbCr: Evaluation of ICtCp Color Space and an Adaptive Reshaper for HDR and WCG">[Perrin]</a>。
        </p>
        <p>ヒトの視覚LMS錐体プライマリがベースであり、
            Hunt-Pointer-Estevez（HPE）XYZ→LMS変換が使われ、
            D65ホワイトポイントへ正規化されます。
            その後、BT.2020 RGBのガマットの凹みを緩和するために
            4%クロストーク行列が適用されます<a data-link-type="biblio" href="#biblio-what_is_ictcp"
                title="What is ICtCp, v7.1">[What_is_ICtCp]</a>。
            これにより、補間誤差が低減し、一定の色相線やJND（MacAdam楕円）の均一性も向上します。</p>
        <p><a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-lab-lab"
                id="ref-for-valdef-lab-lab">Lab</a>が主に低輝度・反射色で評価されているのに対し、
            IC<sub>T</sub>C<sub>P</sub>は高彩度（WCG）・自己発光・高輝度（HDR）色で評価されています。</p>
        <p>そのため、HDRカラーデルタE測定（<a href="#deltaE">deltaE ITP</a>）やSDR/HDR混合時のガマットマッピングにも適しています。</p>
        <div class="example" id="ex-DE-ITP">
            <a class="self-link" href="#ex-DE-ITP"></a> 例えば、BT.2020とBT.2100は同じ原色と白色点を採用しています。
            BT.2020はSDRで、BT.2100はHDRで
            HDR基準白が約0.58のコード値になります。
            <p>両カラースペースの非常に広い原色赤：</p>
            <pre class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-pq <c- m>0.58</c-> <c- m>0</c-> <c- m>0</c-><c- p>)</c-> <c- c>/* ictcp(44.6% -0.129 0.399) */</c->
<c- nf>color</c-><c- p>(</c->rec2020 <c- m>1</c-> <c- m>0</c-> <c- m>0</c-><c- p>)</c->       <c- c>/* ictcp(44.7% -0.130 0.399)  */</c->
</pre>
            <p>ICTCPで2つの色は非常に近く、deltaE ITPは0.487となり、視覚的に差は認められません。</p>
            <p>これらの色はsRGB「赤」とは大きく異なります：</p>
            <pre class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-pq <c- m>0.58</c-> <c- m>0</c-> <c- m>0</c-><c- p>)</c-> <c- c>/* ictcp(44.6% -0.129 0.399) */</c->
red                        <c- c>/* ictcp(42.8% -0.116 0.279) */</c->
</pre>
            <p>deltaE ITPは87.7で、見た目でまったく異なる色となります。</p>
        </div>
        <h3 class="informative heading settled" data-level="6.2" id="jaz-intro"><span class="secno">6.2. </span><span
                class="content"> Jzazbz と JzCzhz の紹介 </span><a class="self-link" href="#jaz-intro"></a></h3>
        <p><em>このセクションは規範的ではありません。</em></p>
        <p>J<sub>z</sub>a<sub>z</sub>b<sub>z</sub>色空間<a data-link-type="biblio" href="#biblio-safdar-pucs"
                title="Perceptually uniform color space for image signals including high dynamic range and wide gamut">[Safdar-PUCS]</a>およびその極座標形式J<sub>z</sub>C<sub>z</sub>h<sub>z</sub>は、
            BT.2020のような広色域をより知覚的に均一に表現し、
            HDR色など広域の明度を正確に予測し、
            明度・彩度・色相間の相互依存を最小化することを目指して設計されました。
            特に色相均一性に優れており、CAM16-UCSよりも優れています
            <span
                title="Perceptually uniform color space for image signals including high dynamic range and wide gamut">[Safdar-PUCS]</span>。
        </p>
        <p>CIE Labは[0%, 100%]範囲の明度（HDR基準白に対する相対値）を使い、
            Oklabも[0,1.0]範囲の明度（1.0がHDR基準白）を利用します。
            これに対し、<span class="css">Jzazbz</span>のJ<sub>z</sub>軸は[0,1.0]範囲ですが、
            エンコード方式は
            パーセプチュアルクォンタイザー（PQ）に似ており、
            13ストップ以上のダイナミックレンジを表現できます。</p>
        <h3 class="heading settled" data-level="6.3" id="ICtCp"><span class="secno">6.3. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="ictcp">ICtCp</dfn></span><a
                class="self-link" href="#ICtCp"></a></h3>
        <p><span class="css">ICtCp</span>色空間は3つの数値パラメータを受け付けます。
            Iは強度（LabのLに似るが最大10,000 cd/m<sup>2</sup>まで）を表し、
            C<sub>T</sub>とC<sub>P</sub>は
            黄青軸（トリタノープ）・赤緑軸（プロタノープ）の反対色軸です（Labのb・aに類似）。</p>
        <p>この色空間の特徴：</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>白色点
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65①">D65</a>
                <tr>
                    <th>トランスファ関数
                    <td colspan="2">パーセプチュアルクォンタイザー
                <tr>
                    <th>白の輝度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>ピーク白輝度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黒の輝度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>画像状態
                    <td colspan="2">ディスプレイ参照
                <tr>
                    <th>パーセンテージ
                    <td colspan="2">I, Ct, Cp で指定可
                <tr>
                    <th>パーセント基準範囲
                    <td>I: 0% = 0.0, 100% = 1.0<br> Ct, Cp: -100% = -0.5, 100% = 0.5
        </table>
        <p><a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>は
            IC<sub>T</sub>C<sub>P</sub>をリニアBT.2100 RGB から変換して定義していますが、
            変換はLMS経由であるため、他の色空間も
            XYZ→LMS変換を経て表現できます
            <a data-link-type="biblio" href="#biblio-what_is_ictcp" title="What is ICtCp, v7.1">[What_is_ICtCp]</a>。
            <a href="#ictcp_code">サンプルコード</a>もこの方法を使います。
        </p>
        <div class="example" id="example-c42f1cee">
            <a class="self-link" href="#example-c42f1cee"></a> この色は <span class="css">ICtCp</span> での sRGB色「lime」を表します
            <pre><span class="swatch" style="--color: lime"></span> ictcp(0.5393 -0.2643 -0.0625)
</pre>
        </div>
        <div class="example" id="example-c8369b18">
            <a class="self-link" href="#example-c8369b18"></a> この色は快適な「ディフューズホワイト」を表します。
            長時間の表示や字幕用途、どんな面積でも利用できます。
            これはsRGBの<a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white④">white</a>と同じ色です。
            ディフューズホワイトは203 cd/m²です<a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> ictcp(0.58069 0 0)
</pre>
        </div>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#relative-color"
                id="ref-for-relative-color">relative color</a> 構文内の<a class="css" data-link-type="maybe"
                href="#funcdef-ictcp" id="ref-for-funcdef-ictcp①">ictcp()</a>関数では、許可される<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-color-5/#component-keyword"
                id="ref-for-component-keyword">成分キーワード</a>は次のとおりです：</p>
        <ul>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="ictcp()" data-dfn-type="value" data-export
                        id="valdef-ictcp-i">i</dfn> は <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value⑨">&lt;number></a> であり、
                    <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color">元の色</a>のI（明度）
                    を<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion">必要に応じてictcpへ変換</a>した後の値です。
                    1.0 は100%に相当します。
                </p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="ictcp()" data-dfn-type="value" data-export
                        id="valdef-ictcp-ct">ct</dfn> および <dfn class="dfn-paneled css" data-dfn-for="ictcp()"
                        data-dfn-type="value" data-export id="valdef-ictcp-cp">cp</dfn> は <a class="production css"
                        data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①⓪">&lt;number></a> であり、
                    <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color①">元の色</a>のct,Cp軸
                    を<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion①">必要に応じてictcpへ変換</a>した後の値です。
                    0.5は100%、-0.5は-100%に相当します。
                </p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="ictcp()" data-dfn-type="value" data-export
                        id="valdef-ictcp-alpha">alpha</dfn> は <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①①">&lt;number></a> であり、
                    <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color②">元の色</a>のアルファ透明度です。1.0は100%に相当します。
                </p>
        </ul>
        <h3 class="heading settled" data-level="6.4" id="Jzazbz"><span class="secno">6.4. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="jzazbz">Jzazbz</dfn></span><a class="self-link" href="#Jzazbz"></a></h3>
        <p><span class="css">Jzazbz</span>色空間は3つの数値パラメータを受け付けます。
            J<sub>z</sub>は明度（LabのLに類似）、
            azおよびbzは赤緑軸および黄青軸
            （Labのa, bに類似）を表します。</p>
        <p><span class="css">Jzazbz</span>色空間は次の特徴を持ちます：</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>白色点
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65②">D65</a>
                <tr>
                    <th>トランスファ関数
                    <td colspan="2">パーセプチュアルクォンタイザー
                <tr>
                    <th>ピーク白輝度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黒輝度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>画像状態
                    <td colspan="2">ディスプレイ参照
                <tr>
                    <th>パーセンテージ
                    <td colspan="2">Jz, az, bzで指定可
                <tr>
                    <th>パーセント基準範囲
                    <td>Jz: 0% = 0.0, 100% = 1.0<br> az, bz: -100% = -0.21, 100% = 0.21
        </table>
        <p>Labと異なり、<a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                id="ref-for-d65③">D65</a>白色点が使われることに注意してください。
            そのため、ほとんどのRGB空間
            （D65白色点を使うもの）では
            色順応処理は不要です。</p>
        <p><a href="#jzazbz_code">XYZ-D65と<span class="css">Jzazbz</span>の変換サンプルコード</a>を提供しています。</p>
        <div class="example" id="example-1fad9c22">
            <a class="self-link" href="#example-1fad9c22"></a> この色は快適な「ディフューズホワイト」を表現します。
            長時間表示や字幕、画面のどんな面積にも利用できます。
            これはsRGBの<a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white⑤">white</a>と同じ色です。
            ディフューズホワイトは203 cd/m²です<a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> jzazbz(0.22207 -0.00016 -0.00012)
</pre>
        </div>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#relative-color"
                id="ref-for-relative-color①">relative color</a>構文内の<a class="css" data-link-type="maybe"
                href="#funcdef-jzazbz" id="ref-for-funcdef-jzazbz①">jzazbz()</a>関数で
            許可される<a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#component-keyword"
                id="ref-for-component-keyword①">成分キーワード</a>は次の通りです：</p>
        <ul>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzazbz()" data-dfn-type="value" data-export
                        id="valdef-jzazbz-j">j</dfn>は<a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①②">&lt;number></a>型で、
                    <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color③">元の色</a>のJz（明度）
                    を<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion②">必要に応じてjzazbzへ変換</a>した値です。
                    1.0 が100%に相当します。
                </p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzazbz()" data-dfn-type="value" data-export
                        id="valdef-jzazbz-a">a</dfn>および<dfn class="dfn-paneled css" data-dfn-for="jzazbz()"
                        data-dfn-type="value" data-export id="valdef-jzazbz-b">b</dfn>は<a class="production css"
                        data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①③">&lt;number></a>型で、
                    <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color④">元の色</a>のaz, bz軸
                    を<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion③">必要に応じてjzazbzへ変換</a>した値です。
                    0.21 が 100%、-0.21 が -100%に相当します。
                </p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzazbz()" data-dfn-type="value" data-export
                        id="valdef-jzazbz-alpha">alpha</dfn>は<a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①④">&lt;number></a>型で、
                    <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color⑤">元の色</a>のアルファ透明度。1.0が100%に相当します。
                </p>
        </ul>
        <h3 class="heading settled" data-level="6.5" id="JzCzhz"><span class="secno">6.5. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="jzczhz">JzCzhz</dfn></span><a class="self-link" href="#JzCzhz"></a></h3>
        <p>LCH（Labの極座標表現）に類似し、<span class="css">JzCzhz</span>は<span class="css">Jzazbz</span>の極座標形です。</p>
        <p>J<sub>z</sub>は<span class="css">Jzazbz</span>の値と同じで明度を示し、
            Czは彩度（クロマ）を、
            hzは色相角を表します。
            色相角は正のaz軸から正のbz軸への方向で測定されます。</p>
        <p>次の特徴があります：</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>白色点
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65④">D65</a>
                <tr>
                    <th>トランスファ関数
                    <td colspan="2">パーセプチュアルクォンタイザー
                <tr>
                    <th>ピーク白輝度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黒輝度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>画像状態
                    <td colspan="2">ディスプレイ参照
                <tr>
                    <th>パーセンテージ
                    <td colspan="2">Jz, Czで指定可
                <tr>
                    <th>パーセント基準範囲
                    <td>Jz: 0% = 0.0, 100% = 1.0<br> Cz: 0% = 0.0, 100% = 0.26
                <tr>
                    <th>無効な色相ε
                    <td>Cz &lt;= 0.0000026
        </table>
        <div class="example" id="example-86e60443">
            <a class="self-link" href="#example-86e60443"></a> この色は<span class="css">Jzazbz</span>でのsRGB色「lime」を表し、
            <pre><span class="swatch" style="--color: lime"></span> jzazbz(0.17542 -0.1179 0.1092)
</pre>
            <p>同じ色の極座標表現はこちら：</p>
            <pre><span class="swatch" style="--color: lime"></span> jzczhz(0.17542 0.1614 132.50)
</pre>
        </div>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#relative-color"
                id="ref-for-relative-color②">relative color</a>構文内の<a class="css" data-link-type="maybe"
                href="#funcdef-jzczhz" id="ref-for-funcdef-jzczhz①">jzczhz()</a>関数で
            許可される<a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#component-keyword"
                id="ref-for-component-keyword②">成分キーワード</a>は次の通りです：</p>
        <ul>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzczhz()" data-dfn-type="value" data-export
                        id="valdef-jzczhz-j">j</dfn>は<a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①⑤">&lt;number></a>型で、
                    <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color⑥">元の色</a>のJz（明度）
                    を<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion④">必要に応じてjzczhzへ変換</a>した値です。
                    100が100%に相当します。
                </p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzczhz()" data-dfn-type="value" data-export
                        id="valdef-jzczhz-c">c</dfn>は<a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①⑥">&lt;number></a>型で、
                    <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color⑦">元の色</a>のCz（クロマ）
                    を<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion⑤">必要に応じてjzczhzへ変換</a>した値です。
                    0.26が100%に相当します。
                </p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzczhz()" data-dfn-type="value" data-export
                        id="valdef-jzczhz-h">h</dfn>は<a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①⑦">&lt;number></a>型で、
                    <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color⑧">元の色</a>のhz（色相、度単位）
                    を<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion⑥">必要に応じてjzczhzへ変換</a>した値で、
                    [0, 360]範囲に正規化されます。90は90度に相当します。
                </p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzczhz()" data-dfn-type="value" data-export
                        id="valdef-jzczhz-alpha">alpha</dfn>は<a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①⑧">&lt;number></a>型で、
                    <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color⑨">元の色</a>のアルファ透明度。1.0が100%に相当します。
                </p>
        </ul>
        <h4 class="heading settled" data-level="6.5.1" id="Jzazbz-to-JzCzHz"><span class="secno">6.5.1. </span><span
                class="content"> <span class="css">Jzazbz</span>色を<span class="css">JzCzhz</span>色へ変換</span><a
                class="self-link" href="#Jzazbz-to-JzCzHz"></a></h4>
        <p> <span class="css">JzCzhz</span>への変換は簡単です：</p>
        <ol>
            <li>hz = atan2(bz, az) // 度へ変換すること！
            <li>Cz = sqrt(az^2 + bz^2)
            <li>Jzは同じ
        </ol>
        <p>加えて、実用的なコードは Cz がε未満の場合 <a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-color-4/#valdef-color-none" id="ref-for-valdef-color-none">none</a>
            値を返すべきです。</p>
        <h4 class="heading settled" data-level="6.5.2" id="JzCzHz-to-Jzazbz"><span class="secno">6.5.2. </span><span
                class="content"> JzCzhz色をJzazbz色へ変換</span><a class="self-link" href="#JzCzHz-to-Jzazbz"></a></h4>
        <p> <span class="css">Jzazbz</span>への変換は簡単です：</p>
        <ol>
            <li>az = Cz cos(H) // まずラジアンに変換すること！
            <li>bz = Cz sin(H) // まずラジアンに変換すること！
            <li>Jzは同じ
        </ol>
        <p>また、実用的なコードは hz が<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-color-4/#valdef-color-none" id="ref-for-valdef-color-none①">none</a>
            の値であるかどうかをチェックしてください。</p>
        <h2 class="heading settled" data-level="7" id="color-function"><span class="secno">7. </span><span
                class="content"> あらかじめ定義されたカラースペースとカスタムカラースペースの指定： <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-5/#funcdef-color" id="ref-for-funcdef-color①">color()</a> 関数
            </span><a class="self-link" href="#color-function"></a></h2>
        <p><a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-5/#funcdef-color"
                id="ref-for-funcdef-color②">color()</a> 関数は
            特定の<a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#color-space"
                id="ref-for-color-space">カラースペース</a>で
            （他のカラ―関数のほとんどが動作する暗黙のsRGBではなく）色を指定できます。</p>
        <p>この仕様は<a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-5/#funcdef-color"
                id="ref-for-funcdef-color③">color()</a>関数を拡張し、
            <a href="#predefined-HDR">HDR用あらかじめ定義されたカラースペース</a>を
            <a href="https://www.w3.org/TR/css-color-4/#predefined"><cite>CSS Color 4</cite> §  10.
                あらかじめ定義されたカラースペース</a> の規定SDRスペースや
            <a href="https://www.w3.org/TR/css-color-5/#relative-colors"><cite>CSS Color 5</cite> § 4
                相対色</a>の相対カラー構文に加え利用できます。
        </p>
        <p>構文は次の通りです：</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-rgb">&lt;predefined-rgb></dfn> = srgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⑥">|</a> srgb-linear <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⑦">|</a> display-p3 <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⑧">|</a> display-p3-linear <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⑨">|</a> a98-rgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④⓪">|</a> prophoto-rgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④①">|</a> rec2020 <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④②">|</a> 
  rec2100-pq <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④③">|</a> rec2100-hlg <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④④">|</a> rec2100-linear
</pre>
        <h2 class="heading settled" data-level="8" id="predefined-HDR"><span class="secno">8. </span><span
                class="content">HDR用あらかじめ定義されたカラースペース：</span><a class="self-link" href="#predefined-HDR"></a>
        </h2>
        <p>CSS Color 4で定義されている<a href="https://drafts.csswg.org/css-color-4/#predefined">SDR
                カラースペース</a>に加えて、以下のHDRカラースペースが
            color関数で利用するために定義されています。</p>
        <p>これら新しいカラースペースの値のシリアライズは、<a href="https://www.w3.org/TR/css-color-4/#serializing-color-values"><cite>CSS Color
                    4</cite> §  15.
                &lt;color>値のシリアライズ</a> の記述と同一です。</p>
        <h3 class="heading settled" data-level="8.1" id="valdef-color-rec2100-pq"><span class="secno">8.1. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-pq">rec2100-pq</dfn></span><a class="self-link" href="#valdef-color-rec2100-pq"></a>
        </h3>
        <p><span class="css">rec2100-pq</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            カラースペースは3つの数値パラメータ（赤・緑・青チャンネル）を受け付け、
            実際のビット深度（各成分10または12ビット）によらず各値の有効範囲は[0, 1]です。</p>
        <p>パーセプチュアルクォンタイザー（PQ）エレクトロオプティカルトランスファ関数が使われます <a data-link-type="biblio" href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>,<a
                data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            PQは基準視聴条件として、
            画面の周囲が5 cd/m²であることを前提とします。</p>
        <p>ITU-R 2100は4Kおよび8K HDRテレビで利用されます。</p>
        <p>主な特徴は以下のとおりです（ディスプレイの原色は<a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>と同じ）：
        </p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>赤の色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>緑の色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>青の色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白の色度
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65⑤">D65</a>
                <tr>
                    <th>トランスファ関数
                    <td colspan="2">パーセプチュアルクォンタイザー
                <tr>
                    <th>白の輝度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>ピーク白輝度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黒の輝度
                    <td colspan="2">≤ 0.005 cd/m²
                <tr>
                    <th>画像状態
                    <td colspan="2">ディスプレイ参照
                <tr>
                    <th>パーセンテージ
                    <td colspan="2">R, G, Bで指定可
                <tr>
                    <th>パーセント基準範囲
                    <td>R, G, B: 0% = 0.0, 100% = 1.0
        </table>
        <p>非基準視聴環境下のナローPQビデオ、
            または任意の環境下でのHLGの場合は、
            黒レベルを<a data-link-type="biblio" href="#biblio-rec_bt814"
                title="Specifications of PLUGE test signals and alignment procedures for setting of brightness and contrast of displays">
                [Rec_BT.814]</a>
                付属書のPLUGEテスト信号と手順で調整する必要があります。
                CSSでのPQ値（ワイドレンジ）は、黒がコードポイント0に対応します。</p>
        <div class="example" id="example-dbd71f8e">
            <a class="self-link" href="#example-dbd71f8e"></a> この色は輝度10,000 cd/m²の眩しい白を表します。
            このような明るい色はごく短時間、画面のごく一部でしか表示できません。
            通常、コンテンツはより低いピークホワイト（例：4,000cd/m²）でマスタリングされます。
            <pre><span class="swatch oog" style="--color: white"></span> color(rec2100-pq 1.0 1.0 1.0);
</pre>
        </div>
        <div class="example" id="example-f604e8a3">
            <a class="self-link" href="#example-f604e8a3"></a> この色は快適な「ディフューズホワイト」を表します。
            長時間表示や字幕、画面のどんな面積にも利用できます。
            これはsRGBの<a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white⑥">white</a>と同じ色です。
            ディフューズホワイトは203 cd/m²です<a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-pq 0.58 0.58 0.58);
</pre>
            <p>この色はミディアムグレー（18%反射率グレー）カード、17 cd/m²の輝度に相当します。</p>
            <pre><span class="swatch" style="--color: rgb(46.632% 46.632% 46.632%)"></span> color(rec2100-pq 0.34 0.34 0.34)
</pre>
        </div>
        <p class="issue" id="issue-3762b88c"><a class="self-link" href="#issue-3762b88c"></a>
            他の例（sRGB赤・緑・青やP3の各主色のエンコードなど）を追加すること</p>
        <p>リニアライトRGB信号は以下のようにPQエンコードされます。
            PQでエンコードできる最大値（ピーク小面積白）は10,000 cd/m²です。
            HDR基準白は203 cd/m²です<a data-link-type="biblio" href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a>。</p>
        <pre class="lang-javascript highlight"><c- a>var</c-> Er<c- p>;</c->      <c- c1>// 赤・緑・青のいずれかの成分。SDRでは[0, 1]、HDRでは[0, 70程度]</c->
<c- a>var</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->  <c- c1>// ディフューズホワイトの輝度、cd/m²</c->
<c- a>var</c-> x <c- o>=</c-> Er <c- o>*</c-> Yw <c- o>/</c-> <c- mf>10000</c-><c- p>;</c->   <c- c1>// ピーク白の輝度は10,000 cd/m²。</c->
<c- a>const</c-> n <c- o>=</c-> <c- mf>2610</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>);</c->
<c- a>const</c-> m <c- o>=</c-> <c- mf>2523</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>);</c->
<c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
<c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
xPQ <c- o>=</c-> <c- p>(((</c->c1 <c- o>+</c-> <c- p>(</c->c2 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>)))</c-> <c- o>/</c-> <c- p>(</c-><c- mf>1</c-> <c- o>+</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>))))</c-> <c- o>**</c-> m<c- p>);</c->

</pre>
        <p>xPQは「ガンマ補正済み」（OETF適用済み）の信号[0,1]です。</p>
        <p>PQエンコード値をリニアライトに変換する場合は次のようになります：</p>
        <pre class="lang-javascript highlight"><c- a>var</c-> xPQ<c- p>;</c->      <c- c1>// PQエンコード済みの赤・緑・青成分、[0, 1]</c->
<c- a>const</c-> ninv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2610</c-><c- p>;</c->
<c- a>const</c-> minv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2523</c-><c- p>;</c->
<c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
<c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>var</c-> x <c- o>=</c-> <c- p>((((</c->Math<c- p>.</c->max<c- p>(((</c->xPQ <c- o>**</c-> minv<c- p>)</c-> <c- o>-</c-> c1<c- p>),</c-> <c- mf>0</c-><c- p>))</c-> <c- o>/</c-> <c- p>(</c->c2 <c- o>-</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->xPQ <c- o>**</c-> minv<c- p>))))</c-> <c- o>**</c-> ninv<c- p>);</c->
<c- a>var</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->      <c- c1>// ディフューズホワイトの輝度、cd/m²</c->
<c- a>var</c-> Ea <c- o>=</c-> x <c- o>*</c-> <c- mf>10000</c-><c- p>;</c->   <c- c1>// 輝度 [0, 10,000]</c->
<c- a>var</c-> Er <c- o>=</c-> x <c- o>*</c-> <c- mf>10000</c-> <c- o>/</c-> Yw<c- p>;</c->   <c- c1>// ディフューズホワイトに対する相対輝度 [0, 70程度]</c->
</pre>
        <h3 class="heading settled" data-level="8.2" id="valdef-color-rec2100-hlg"><span class="secno">8.2. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-hlg">rec2100-hlg</dfn></span><a class="self-link" href="#valdef-color-rec2100-hlg"></a>
        </h3>
        <p><span class="css">rec2100-hlg</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            カラースペースは3つの数値パラメータ（赤・緑・青チャンネル）を受け付け、
            実際のビット深度（各成分10または12ビット）によらず各値の有効範囲は[0, 1]です。</p>
        <p>ハイブリッドログガンマ（HLG）エレクトロオプティカルトランスファ関数が使われます <a data-link-type="biblio" href="#biblio-arib_std-b67"
                title="Essential Parameter Values for the Extended Image Dynamic Range Television (EIDRTV) System for Programme Production">[ARIB_STD-B67]</a>,<a
                data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            HLGはさまざまな明るさや視聴環境で使用でき、
            全体的な明るさはユーザーが調整可能です。
            0.75は「ディフューズ」または「メディアホワイト」を表し、
            「18%反射率グレー」カードは0.38です<a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>。
        </p>
        <p>主な特徴は以下のとおりです（ディスプレイの原色は<a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>と同じ）：
        </p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>赤の色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>緑の色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>青の色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白の色度
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65⑥">D65</a>
                <tr>
                    <th>トランスファ関数
                    <td colspan="2">ハイブリッドログガンマ
                <tr>
                    <th>白の輝度
                    <td colspan="2">視聴条件に依存
                <tr>
                    <th>ピーク白輝度
                    <td colspan="2">基準白の12倍
                <tr>
                    <th>黒の輝度
                    <td colspan="2">基準白による、本文参照
                <tr>
                    <th>画像状態
                    <td colspan="2">シーン参照
                <tr>
                    <th>パーセンテージ
                    <td colspan="2">R, G, Bで指定可
                <tr>
                    <th>パーセント基準範囲
                    <td>R, G, B: 0% = 0.0, 100% = 1.0
        </table>
        <p>ナローHLGビデオ（任意環境）では、
            黒レベルは<a data-link-type="biblio" href="#biblio-rec_bt814"
                title="Specifications of PLUGE test signals and alignment procedures for setting of brightness and contrast of displays">
                [Rec_BT.814]</a>
                付録4のPLUGEテスト信号と手法で調整する必要があります。</p>
        <p>CSSでのHLG値（ワイドレンジ）では黒がコードポイント0に対応します。</p>
        <p class="issue" id="issue-63bd5f3d"><a class="self-link" href="#issue-63bd5f3d"></a> 他の例を追加すること</p>
        <div class="example" id="example-8d914a69">
            <a class="self-link" href="#example-8d914a69"></a> この色は快適な「ディフューズホワイト」を表します。
            長時間表示や字幕用途、どんな面積でも利用できます。
            通常、コンテンツはピークホワイト1,000〜4,000 cd/m²でマスタリングされるため、ディフューズホワイトは203〜581 cd/m²となります。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-hlg 0.75 0.75 0.75);
</pre>
            <p>この色は26〜104cd/m²の中間グレーです。</p>
            <pre><span class="swatch" style="--color: rgb(46.632% 46.632% 46.632%)"></span> color(rec2100-hlg 0.38 0.38 0.38)
</pre>
        </div>
        <p>リニアライトRGB信号は以下のようにHLGエンコードされます<a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>：
        </p>
        <pre class="lang-javascript highlight"><c- a>var</c-> E<c- p>;</c->      <c- c1>// 赤・緑・青のいずれかの成分、[0, 1]</c->
<c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
<c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c->   <c- c1>// 1 - (4 * a)</c->
<c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c->   <c- c1>// 0.5 - a * Math.log(4 *a)</c->
<c- c1>// 負値処理</c->
<c- a>var</c-> sign <c- o>=</c-> E <c- o>&lt;</c-> <c- mf>0</c-><c- o>?</c-> <c- o>-</c-><c- mf>1</c-> <c- o>:</c-> <c- mf>1</c-><c- p>;</c->
<c- a>var</c-> abs <c- o>=</c-> Math<c- p>.</c->abs<c- p>(</c->E<c- p>);</c->
<c- k>if</c-> <c- p>(</c->abs <c- o>&lt;=</c-> <c- mf>1</c-><c- o>/</c-><c- mf>12</c-><c- p>)</c-> <c- p>{</c->
  Edash <c- o>=</c-> sign <c- o>*</c-> Math<c- p>.</c->sqrt<c- p>(</c-> <c- mf>3</c-> <c- o>*</c-> abs<c- p>);</c->
<c- p>}</c->
<c- k>else</c-> <c- p>{</c->
  Edash <c- o>=</c-> a <c- o>*</c-> Math<c- p>.</c->log<c- p>(</c-><c- mf>12</c-> <c- o>*</c-> E <c- o>-</c-> b<c- p>)</c-> <c- o>+</c-> c<c- p>;</c->
<c- p>}</c->
</pre>
        <p>Edashは「ガンマ補正済み」（OETF適用済み）の信号です。</p>
        <p>逆変換（HLGエンコード→リニアライト）は次の通りです<a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>：
        </p>
        <pre class="lang-javascript highlight"><c- a>var</c-> Edash<c- p>;</c->      <c- c1>// エンコード済みの赤・緑・青成分、[0, 1]</c->
<c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
<c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c->   <c- c1>// 1 - (4 * a)</c->
<c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c->   <c- c1>// 0.5 - a * Math.log(4 *a)</c->
<c- k>if</c-> <c- p>(</c->Edash <c- o>&lt;=</c-> <c- mf>0.5</c-><c- p>)</c-> <c- p>{</c->
  E <c- o>=</c-> <c- p>(</c->Edash <c- o>**</c-> <c- mf>2</c-><c- p>)</c-> <c- o>/</c-> <c- mf>3</c-><c- p>;</c->
<c- p>}</c->
<c- k>else</c-> <c- p>{</c->
  E <c- o>=</c-> <c- p>(</c->Math<c- p>.</c->exp<c- p>((</c->Edash <c- o>-</c-> c<c- p>)</c-> <c- o>/</c-> a<c- p>)</c-> <c- o>+</c-> b<c- p>)</c-> <c- o>/</c-> <c- mf>12</c-><c- p>;</c->
<c- p>}</c->
</pre>
        <p class="issue" id="issue-fb589d17"><a class="self-link" href="#issue-fb589d17"></a> 黒レベルリフトΒの追加？</p>
        <h3 class="heading settled" data-level="8.3" id="valdef-color-rec2100-linear"><span class="secno">8.3.
            </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-linear">rec2100-linear</dfn></span><a class="self-link"
                href="#valdef-color-rec2100-linear"></a></h3>
        <p><span class="css">rec2100-linear</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            カラースペースは3つの数値パラメータ（赤・緑・青チャンネル）を受け付け、
            実際のビット深度（各成分10または12ビット）によらず、名目上の範囲は[0, 1]です。</p>
        <p>赤・緑・青をすべて1.0にした色は
            輝度203cd/m²の<a data-link-type="dfn" href="#hdr-reference-white"
                id="ref-for-hdr-reference-white①">HDR基準白</a>を表します。</p>
        <pre
            class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>1</c-> <c- m>1</c-> <c- m>1</c-><c- p>)</c-></pre>
        <div class="example" id="example-bda29122">
            <a class="self-link" href="#example-bda29122"></a> 例えば、次の色
            <pre
                class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>9.852</c-> <c- m>9.852</c-> <c- m>9.852</c-><c- p>)</c-></pre>
            <p>は、輝度9.852 × 203 = 1,999cd/m²の白いハイライトを表します。</p>
        </div>
        <div class="example" id="example-071a1469">
            <a class="self-link" href="#example-071a1469"></a> この色は快適な「ディフューズホワイト」を表します。
            長時間表示や字幕用途、どんな面積でも利用できます。
            これはsRGBの<a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white⑦">white</a>と同じ色です。
            ディフューズホワイトは203 cd/m²です<a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-linear 1 1 1)
</pre>
        </div>
        <p>リニアライトのエレクトロオプティカルトランスファ関数が使われます。</p>
        <p>主な特徴は以下のとおりです（ディスプレイの原色は<a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>と同じ）：
        </p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>赤の色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>緑の色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>青の色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白の色度
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65⑦">D65</a>
                <tr>
                    <th>トランスファ関数
                    <td colspan="2">リニア
                <tr>
                    <th>白の輝度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>ピーク白輝度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黒の輝度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>画像状態
                    <td colspan="2">ディスプレイ参照
                <tr>
                    <th>パーセンテージ
                    <td colspan="2">R, G, Bで指定可
                <tr>
                    <th>パーセント基準範囲
                    <td>R, G, B: 0% = 0.0, 100% = 1.0
        </table>
        <h2 class="heading settled" data-level="9" id="Compositing-SDR-HDR"><span class="secno">9. </span><span
                class="content">SDRとHDRコンテンツの合成</span><a class="self-link" href="#Compositing-SDR-HDR"></a></h2>
        <p>合成はCIE XYZ空間で行うべきです。
            これはリニアライトでガマット制限がないためです。
            実装ではリニアライトRGB空間で合成しても構いませんが、
            ガマット外値（負や100%超）をクリッピングやガマットマッピングせず、
            最終的なデバイス空間への転送まで正しく扱う必要があります。</p>
        <p>HLGトランスファ関数を用いるHDRでは、
            SDRのHDR基準白を
            75%HLG値で表示する輝度と
            同じ輝度にマッピングしなければなりません。<a data-link-type="biblio" href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>
        </p>
        <p>詳細はITU Rpt_BT.2408-0 <a data-link-type="biblio" href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a>
            の表3・4も参照。</p>
        <p>PQトランスファ関数を用いるHDRでは、
            SDRのHDR基準白を
            PQ値58%で表示する輝度、203cd/m²と
            同じ輝度にマッピングすべきです。<a data-link-type="biblio" href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>
        </p>
        <p>ただし実装では、非基準視聴条件も考慮する色再レンダリング処理を含めても構いません。</p>
        <h2 class="heading settled" data-level="10" id="serializing-color-values"><span class="secno">10. </span><span
                class="content"> <a class="production css" data-link-type="type"
                    href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color⑥">&lt;color></a>
                値のシリアライズ</span><a class="self-link" href="#serializing-color-values"></a></h2>
        <h3 class="heading settled" data-level="10.1" id="serializing-color-function-values"><span class="secno">10.1.
            </span><span class="content"> <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-5/#funcdef-color" id="ref-for-funcdef-color④">color()</a>
                関数の値のシリアライズ</span><a class="self-link" href="#serializing-color-function-values"></a></h3>
        <p>このセクションは <a href="https://www.w3.org/TR/css-color-4/#serializing-color-function-values"><cite>CSS
                    Color 4</cite> § 15.5 color()関数値のシリアライズ</a>を拡張します。</p>
        <p><a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-5/#funcdef-color"
                id="ref-for-funcdef-color⑤">color()</a>値のシリアライズ形式は、
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-5/#computed-value"
                id="ref-for-computed-value">算出値</a>に基づき、
            <span class="css" id="ref-for-funcdef-color⑥">color()</span>形式を使います。
            関数名およびカラースペース名は<a href="https://infra.spec.whatwg.org/#ascii-lowercase">ASCII小文字</a>、
        </p>
        <p>成分値は10進数で、
            <a class="production css" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value"
                id="ref-for-number-value①⑨">&lt;number></a>としてシリアライズされます。
            各成分、およびカラースペース名と先頭成分の間は
            ASCIIスペース" "で区切ります。
        </p>
        <p>あらかじめ定義されたHDRカラースペースの
            <em>最低</em>往復精度は下表の通りです：
        </p>
        <table class="data" id="predefined-precision-table">
            <tbody>
                <tr>
                    <th>HDRカラースペース
                    <th>最低ビット数
                <tr>
                    <td><span class="css">rec2100-pq</span>, <span class="css">rec2100-hlg</span>
                    <td>10
                <tr>
                    <td><span class="css">rec2100-linear</span>, <span class="css">jzazbz</span>, <span
                            class="css">jzczhz</span>, <span class="css">ictcp</span>
                    <td>16
        </table>
        <p>（内部保存にはコンポーネントごと16bit, half-float, float推奨）、
            値は<a href="https://drafts.csswg.org/css-values-4/#combine-integers">+∞方向丸め</a>、
            切り捨て不可です。</p>
        <h2 class="heading settled" data-level="11" id="color-conversion-code"><span class="secno">11. </span><span
                class="content"> 色変換のサンプルコード</span><a class="self-link" href="#color-conversion-code"></a></h2>
        <p><em>このセクションは規範的ではありません。</em></p>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>テスト</summary>
            <p>このセクションは規範的ではないため、テストは必要ありません。</p>
            <ul class="wpt-tests-list"></ul>
            <hr>
        </details>
        <p>明確さのため、行列の乗算には<a href="https://drafts.csswg.org/css-color-4/multiply-matrices.js">ライブラリ</a>を使用します。
            （すべての乗算と加算をインラインで書くより可読性が高くなります）。
            行列は<a
                href="https://www.scratchapixel.com/lessons/mathematics-physics-for-computer-graphics/geometry/row-major-vs-column-major-vector">列優先
                順序（column-major order）</a>です。</p>
        <p>このコードはまた、<a href="https://www.w3.org/TR/css-color-4/#color-conversion-code"><cite>CSS Color 4</cite> § 18
                色変換のサンプルコード</a>の
            すべての変換コードが利用可能であることを前提とします。</p>
        <p><span class="css">Jzazbz</span>で使用されるLMSは
            <span class="css">ICtCp</span>で使用されるものとは異なるため、
            正しい方を使用するよう注意してください！
        </p>
        <h3 class="heading settled" data-level="11.1" id="rec2100-linear_code"><span class="secno">11.1. </span><span
                class="content"> <span class="css">rec2100-linear</span> のサンプルコード </span><a class="self-link"
                href="#rec2100-linear_code"></a></h3>
        <p>BT.2020 と BT.2100 のカラースペースは
            同じRGB原色と白色点を使用し、
            どちらもHDR基準白をコンポーネント値 1.0 に配置します。</p>
        <pre class="include-code highlight"><c- c1>// これらの関数は CSS Color 4 の色変換関数を使用します</c->

<c- a>function</c-> XYZ_to_lin_2100<c- p>(</c->XYZ<c- p>)</c-> <c- p>{</c->
    <c- c1>// D65 の XYZ 配列をリニアライト BT.2100 RGB に変換</c->
    <c- c1>// [0,0,0] が黒、[1,1,1] がメディアホワイト</c->
    <c- c1>// 1 を超えるコンポーネント値は HDR 色を示す</c->

    <c- k>return</c->  XYZ_to_lin_2020<c- p>(</c->XYZ<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> lin_2100_to_XYZ<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->
    <c- c1>// リニアライト BT.2100 RGB の配列を</c->
    <c- c1>// D65 XYZ に変換</c->

    <c- k>return</c-> lin_2020_to_XYZ<c- p>(</c->RGB<c- p>);</c->
<c- p>}</c-></pre>
        <h3 class="heading settled" data-level="11.2" id="rec2100-pq_code"><span class="secno">11.2. </span><span
                class="content"> <span class="css">rec2100-pq</span> のサンプルコード </span><a class="self-link"
                href="#rec2100-pq_code"></a></h3>
        <pre class="include-code highlight"><c- a>function</c-> XYZ_to_pq_2100<c- p>(</c->XYZ<c- p>)</c-> <c- p>{</c->
    <c- c1>// D65 の XYZ 配列を PQ エンコード BT.2100 RGB に変換</c->
    <c- c1>// [0,0,0] が黒、[1,1,1] が 10,000 cd/m^2 の白</c->
    <c- c1>// メディアホワイトは [0.5807,0.5807,0.5807]（有効数字4桁）</c->

    <c- a>let</c-> linRGB <c- o>=</c-> XYZ_to_lin_2100<c- p>(</c->XYZ<c- p>);</c->
    <c- k>return</c-> pq_encode<c- p>(</c->linRGB<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> pq_2100_to_XYZ<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->
    <c- c1>// PQ エンコード BT.2100 RGB の配列を</c->
    <c- c1>// D65 XYZ に変換</c->

    <c- a>let</c-> linRGB <c- o>=</c-> pq_decode<c- p>(</c->RGB<c- p>);</c->
    <c- k>return</c-> lin_2100_to_XYZ<c- p>(</c->linRGB<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> pq_encode<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->    <c- c1>// メディアホワイトの絶対輝度（cd/m²）</c->
    <c- a>const</c-> n <c- o>=</c-> <c- mf>2610</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>);</c->
    <c- a>const</c-> m <c- o>=</c-> <c- mf>2523</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>);</c->
    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->

    <c- c1>// 入力：範囲 [0,1] の PQ エンコード成分</c->
    <c- c1>// 出力：メディアホワイト相対のリニアライト</c->
    <c- k>return</c-> RGB<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- a>let</c-> x <c- o>=</c-> Math<c- p>.</c->max<c- p>(</c->val <c- o>*</c-> Yw <c- o>/</c-> <c- mf>10000</c-><c- p>,</c-> <c- mf>0</c-><c- p>);</c->     <c- c1>// ピーク白の絶対輝度は 10,000 cd/m²</c->
        <c- a>let</c-> num <c- o>=</c-> <c- p>(</c->c1 <c- o>+</c-> <c- p>(</c->c2 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>)));</c->
        <c- a>let</c-> denom <c- o>=</c-> <c- p>(</c-><c- mf>1</c-> <c- o>+</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>)));</c->

        <c- k>return</c-> <c- p>((</c->num <c- o>/</c-> denom<c- p>)</c->  <c- o>**</c-> m<c- p>);</c->
    <c- p>});</c->
<c- p>}</c->

<c- a>function</c-> pq_decode<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->    <c- c1>// メディアホワイトの絶対輝度（cd/m²）</c->
    <c- a>const</c-> ninv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2610</c-><c- p>;</c->
    <c- a>const</c-> minv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2523</c-><c- p>;</c->
    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->

    <c- c1>// 入力：範囲 [0,1] の PQ エンコード成分</c->
    <c- c1>// 出力：メディアホワイト相対のリニアライト</c->
    <c- k>return</c-> RGB<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- a>let</c-> x <c- o>=</c-> <c- p>((</c->Math<c- p>.</c->max<c- p>(((</c->val <c- o>**</c-> minv<c- p>)</c-> <c- o>-</c-> c1<c- p>),</c-> <c- mf>0</c-><c- p>)</c-> <c- o>/</c-> <c- p>(</c->c2 <c- o>-</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->val <c- o>**</c-> minv<c- p>))))</c-> <c- o>**</c-> ninv<c- p>);</c->
        <c- k>return</c-> <c- p>(</c->x <c- o>*</c-> <c- mf>10000</c-> <c- o>/</c-> Yw<c- p>);</c->     <c- c1>// メディアホワイト相対輝度 [0, 約70]</c->
    <c- p>});</c->
<c- p>}</c-></pre>
        <h3 class="heading settled" data-level="11.3" id="rec2100-hlg_code"><span class="secno">11.3. </span><span
                class="content"> <span class="css">rec2100-hlg</span> のサンプルコード </span><a class="self-link"
                href="#rec2100-hlg_code"></a></h3>
        <pre class="include-code highlight"><c- a>function</c-> XYZ_to_hlg_2100<c- p>(</c->XYZ<c- p>)</c-> <c- p>{</c->
    <c- c1>// D65 の XYZ 配列を HLG エンコード BT.2100 RGB に変換</c->
    <c- c1>// [0,0,0] が黒、[0.75,0.75,0.75] がメディアホワイト</c->

    <c- a>let</c-> linRGB <c- o>=</c-> XYZ_to_lin_2100<c- p>(</c->XYZ<c- p>);</c->
    <c- k>return</c-> hlg_encode<c- p>(</c->linRGB<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> hlg_2100_to_XYZ<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->
    <c- c1>// PQ エンコード BT.2100 RGB の配列を</c->
    <c- c1>// D65 XYZ に変換</c->

    <c- a>let</c-> linRGB <c- o>=</c-> hlg_decode<c- p>(</c->RGB<c- p>);</c->
    <c- k>return</c-> lin_2100_to_XYZ<c- p>(</c->linRGB<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> hlg_encode<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
    <c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c-> <c- c1>// 1 - (4 * a)</c->
    <c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c-> <c- c1>// 0.5 - a * Math.log(4 *a)</c->
    <c- a>const</c-> scale <c- o>=</c-> <c- mf>3.7743</c-><c- p>;</c->    <c- c1>// 18% グレーを HLG 0.38 に、メディアホワイトを 0.75 に</c->

    <c- k>return</c-> RGB<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- c1>// まずスケールして、リニアライトのメディアホワイトを 1/3 に置く</c->
        val <c- o>/=</c-> scale<c- p>;</c->
        <c- c1>// HLG の OETF</c->
        <c- c1>// ITU-R BT.2390-10 p.23</c->
        <c- c1>// 6.1 The hybrid log-gamma opto-electronic transfer function (OETF)</c->
        <c- k>if</c-> <c- p>(</c->val <c- o>&lt;=</c-> <c- mf>1</c-> <c- o>/</c-> <c- mf>12</c-><c- p>)</c-> <c- p>{</c->
            <c- k>return</c-> spow<c- p>(</c-><c- mf>3</c-> <c- o>*</c-> val<c- p>,</c-> <c- mf>0.5</c-><c- p>);</c->
        <c- p>}</c->
        <c- k>return</c-> a <c- o>*</c-> Math<c- p>.</c->log<c- p>(</c-><c- mf>12</c-> <c- o>*</c-> val <c- o>-</c-> b<c- p>)</c-> <c- o>+</c-> c<c- p>;</c->
    <c- p>});</c->
<c- p>}</c->

<c- a>function</c-> hlg_decode<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
    <c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c-> <c- c1>// 1 - (4 * a)</c->
    <c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c-> <c- c1>// 0.5 - a * Math.log(4 *a)</c->
    <c- a>const</c-> scale <c- o>=</c-> <c- mf>3.7743</c-><c- p>;</c->    <c- c1>// 18% グレーを HLG 0.38 に、メディアホワイトを 0.75 に</c->

    <c- k>return</c-> RGB<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- c1>// まず HLG の EOTF</c->
        <c- c1>// ITU-R BT.2390-10 p.30</c->
        <c- c1>// 6.3 The hybrid log-gamma electro-optical transfer function (EOTF)</c->
        <c- c1>// その後 3 倍してメディアホワイトを 1.0 に</c->
        <c- k>if</c-> <c- p>(</c->val <c- o>&lt;=</c-> <c- mf>0.5</c-><c- p>)</c-> <c- p>{</c->
            <c- k>return</c-> <c- p>(</c->val <c- o>**</c-> <c- mf>2</c-><c- p>)</c-> <c- o>/</c-> <c- mf>3</c-> <c- o>*</c-> scale<c- p>;</c->
        <c- p>}</c->
        <c- k>return</c-> <c- p>((</c->Math<c- p>.</c->exp<c- p>((</c->val <c- o>-</c-> c<c- p>)</c-> <c- o>/</c-> a<c- p>)</c-> <c- o>+</c-> b<c- p>)</c-> <c- o>/</c-> <c- mf>12</c-><c- p>)</c-> <c- o>*</c-> scale<c- p>;</c->
    <c- p>});</c->
<c- p>}</c->

<c- a>function</c-> spow <c- p>(</c->base<c- p>,</c-> exp<c- p>)</c-> <c- p>{</c->
    <c- a>let</c-> sign <c- o>=</c-> base <c- o>&lt;</c-> <c- mf>0</c-><c- o>?</c-> <c- o>-</c-><c- mf>1</c-> <c- o>:</c-> <c- mf>1</c-><c- p>;</c->
    <c- k>return</c-> sign <c- o>*</c-> <c- p>(</c->Math<c- p>.</c->abs<c- p>(</c->base<c- p>)</c-> <c- o>**</c-> exp<c- p>);</c->
<c- p>}</c-></pre>
        <h3 class="heading settled" data-level="11.4" id="jzazbz_code"><span class="secno">11.4. </span><span
                class="content"> <span class="css">jzazbz</span> のサンプルコード </span><a class="self-link"
                href="#jzazbz_code"></a></h3>
        <p>上で定義した符号付きべき（spow）関数を使用します。</p>
        <pre class="include-code highlight"><c- a>function</c-> XYZ_to_Jzazbz <c- p>(</c->XYZ<c- p>)</c-> <c- p>{</c->
    <c- c1>// D65 の XYZ 配列を JzAzBz に変換</c->
    <c- c1>// [0,0,0] が黒で、</c->
    <c- c1>// メディアホワイトは [0.2220, -0.00016, -0.0001]</c->

    <c- a>const</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c-> <c- c1>// メディアホワイトの絶対輝度</c->
    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>0.41478972</c-><c- p>,</c-> <c- mf>0.579999</c-><c- p>,</c->  <c- mf>0.0146480</c-> <c- p>],</c->
        <c- p>[</c-> <c- o>-</c-><c- mf>0.2015100</c-><c- p>,</c->  <c- mf>1.120649</c-><c- p>,</c->  <c- mf>0.0531008</c-> <c- p>],</c->
        <c- p>[</c-> <c- o>-</c-><c- mf>0.0166008</c-><c- p>,</c->  <c- mf>0.264800</c-><c- p>,</c->  <c- mf>0.6684799</c-> <c- p>],</c->
    <c- p>];</c->
    <c- a>const</c-> b <c- o>=</c-> <c- mf>1.15</c-><c- p>;</c->
    <c- a>const</c-> g <c- o>=</c-> <c- mf>0.66</c-><c- p>;</c->

    <c- c1>// まず XYZ をメディアホワイト相対ではなく絶対値に</c->
    <c- c1>// PQ の最大輝度は 10,000 cd/m²</c->
    <c- c1>// BT.2048 によればメディアホワイトは Y=203 cd/m²</c->
    <c- a>let</c-> <c- p>[</c->Xa<c- p>,</c-> Ya<c- p>,</c-> Za<c- p>]</c-> <c- o>=</c-> XYZ<c- p>.</c->map<c- p>(</c->v <c- p>=></c-> v <c- o>*</c-> Yw<c- p>);</c->

    <c- c1>// つぎに X と Y を調整して、青の曲率を最小化</c->
    <c- a>let</c-> Xm <c- o>=</c-> b <c- o>*</c-> Xa <c- o>-</c-> <c- p>(</c->b <c- o>-</c-> <c- mf>1</c-><c- p>)</c-> <c- o>*</c-> Za<c- p>;</c->
    <c- a>let</c-> Ym <c- o>=</c-> g <c- o>*</c-> Ya <c- o>-</c-> <c- p>(</c->g <c- o>-</c-> <c- mf>1</c-><c- p>)</c-> <c- o>*</c-> Xa<c- p>;</c->

    <c- c1>// LMS 錐体領域へ</c->
    <c- a>let</c-> LMS <c- o>=</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> <c- p>[</c->Xm<c- p>,</c-> Ym<c- p>,</c-> Za<c- p>]);</c->
    <c- k>return</c-> LMStoJzazbz<c- p>(</c->LMS<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> LMStoJzazbz<c- p>(</c->LMS<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>0.5</c-><c- p>,</c->       <c- mf>0.5</c-><c- p>,</c->       <c- mf>0</c->        <c- p>],</c->
        <c- p>[</c->  <c- mf>3.524000</c-><c- p>,</c-> <c- o>-</c-><c- mf>4.066708</c-><c- p>,</c->  <c- mf>0.542708</c-> <c- p>],</c->
        <c- p>[</c->  <c- mf>0.199076</c-><c- p>,</c->  <c- mf>1.096799</c-><c- p>,</c-> <c- o>-</c-><c- mf>1.295875</c-> <c- p>],</c->
    <c- p>];</c->
    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>;</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>;</c->
    <c- a>const</c-> n <c- o>=</c-> <c- mf>2610</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>;</c->
    <c- a>const</c-> p <c- o>=</c-> <c- p>(</c-><c- mf>1.7</c-> <c- o>*</c-> <c- mf>2523</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>;</c->    <c- c1>// 通常の PQ に対して 1.7 倍のスケール</c->
    <c- a>const</c-> d <c- o>=</c-> <c- o>-</c-><c- mf>0.56</c-><c- p>;</c->
    <c- a>const</c-> d0 <c- o>=</c-> <c- mf>1.6295499532821566e-11</c-><c- p>;</c->  <c- c1>// 黒を 0 に戻すための微小シフト</c->


    <c- c1>// LMS を PQ 符号化</c->
    <c- a>let</c-> PQLMS <c- o>=</c-> <c- p>(</c->
        LMS<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
            <c- a>let</c-> num <c- o>=</c-> c1 <c- o>+</c-> c2 <c- o>*</c-> spow<c- p>((</c->val <c- o>/</c-> <c- mf>10000</c-><c- p>),</c-> n<c- p>);</c->
            <c- a>let</c-> denom <c- o>=</c-> <c- mf>1</c-> <c- o>+</c-> c3 <c- o>*</c-> spow<c- p>((</c->val <c- o>/</c-> <c- mf>10000</c-><c- p>),</c-> n<c- p>);</c->

            <c- k>return</c-> spow<c- p>((</c->num <c- o>/</c-> denom<c- p>),</c-> p<c- p>);</c->
        <c- p>})</c->
    <c- p>);</c->

    <c- c1>// Iz, az, bz を計算</c->
    <c- a>let</c-> <c- p>[</c->Iz<c- p>,</c-> az<c- p>,</c-> bz<c- p>]</c-> <c- o>=</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> PQLMS<c- p>);</c->
    <c- c1>// Iz から Jz を導出</c->
    <c- a>let</c-> Jz <c- o>=</c-> <c- p>((</c-><c- mf>1</c-> <c- o>+</c-> d<c- p>)</c-> <c- o>*</c-> Iz<c- p>)</c-> <c- o>/</c-> <c- p>(</c-><c- mf>1</c-> <c- o>+</c-> d <c- o>*</c-> Iz<c- p>)</c-> <c- o>-</c-> d0<c- p>;</c->
    <c- k>return</c-> <c- p>[</c->Jz<c- p>,</c-> az<c- p>,</c-> bz<c- p>];</c->
<c- p>}</c->

<c- a>function</c-> Jzazbz_to_XYZ <c- p>(</c->Jzazbz<c- p>)</c-> <c- p>{</c->
    <c- c1>// JzAzBz の配列を D65 XYZ に変換</c->
    <c- c1>// [0,0,0] が黒で、</c->
    <c- c1>// メディアホワイトは [0.2220, -0.00016, -0.0001]</c->

    <c- a>const</c-> b <c- o>=</c-> <c- mf>1.15</c-><c- p>;</c->
    <c- a>const</c-> g <c- o>=</c-> <c- mf>0.66</c-><c- p>;</c->
    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>1.9242264357876067</c-><c- p>,</c->  <c- o>-</c-><c- mf>1.0047923125953657</c-><c- p>,</c->  <c- mf>0.037651404030618</c->   <c- p>],</c->
        <c- p>[</c->  <c- mf>0.35031676209499907</c-><c- p>,</c->  <c- mf>0.7264811939316552</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.06538442294808501</c-> <c- p>],</c->
        <c- p>[</c-> <c- o>-</c-><c- mf>0.09098281098284752</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.3127282905230739</c-><c- p>,</c->  <c- mf>1.5227665613052603</c->  <c- p>],</c->
    <c- p>];</c->

    <c- a>let</c-> LMS <c- o>=</c-> Jzazbz_to_LMS <c- p>(</c->Jzazbz<c- p>);</c->
    <c- c1>// 調整済みの絶対 XYZ</c->
	<c- a>let</c-> <c- p>[</c->Xm<c- p>,</c-> Ym<c- p>,</c-> Za<c- p>]</c-> <c- o>=</c-> multiplyMatrices<c- p>(</c->LMS<c- p>,</c-> M<c- p>);</c->

    <c- c1>// X と Y の調整を戻し、メディアホワイト相対の D65 XYZ を得る</c->
    <c- a>let</c-> Xa <c- o>=</c-> <c- p>(</c->Xm <c- o>+</c-> <c- p>(</c->b <c- o>-</c-> <c- mf>1</c-><c- p>)</c-> <c- o>*</c-> Za<c- p>)</c-> <c- o>/</c-> b<c- p>;</c->
    <c- a>let</c-> Ya <c- o>=</c-> <c- p>(</c->Ym <c- o>+</c-> <c- p>(</c->g <c- o>-</c-> <c- mf>1</c-><c- p>)</c-> <c- o>*</c-> Xa<c- p>)</c-> <c- o>/</c-> g<c- p>;</c->
    <c- k>return</c-> <c- p>[</c->Xa<c- p>,</c-> Ya<c- p>,</c-> Za<c- p>];</c->
<c- p>}</c->

<c- a>function</c-> Jzazbz_to_LMS <c- p>(</c->Jzazbz<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> d <c- o>=</c-> <c- o>-</c-><c- mf>0.56</c-><c- p>;</c->
    <c- a>const</c-> d0 <c- o>=</c-> <c- mf>1.6295499532821566e-11</c-><c- p>;</c->
    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>;</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>;</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>;</c->
    <c- a>const</c-> pinv <c- o>=</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-> <c- o>/</c-> <c- p>(</c-><c- mf>1.7</c-> <c- o>*</c-> <c- mf>2523</c-><c- p>);</c->
    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c-> <c- mf>1</c-><c- p>,</c->  <c- mf>0.13860504327153927</c-><c- p>,</c->   <c- mf>0.05804731615611883</c->  <c- p>],</c->
        <c- p>[</c-> <c- mf>1</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.1386050432715393</c-><c- p>,</c->   <c- o>-</c-><c- mf>0.058047316156118904</c-> <c- p>],</c->
        <c- p>[</c-> <c- mf>1</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.09601924202631895</c-><c- p>,</c->  <c- o>-</c-><c- mf>0.81189189605603900</c->  <c- p>],</c->
    <c- p>];</c->

    <c- a>let</c-> <c- p>[</c->Jz<c- p>,</c-> az<c- p>,</c-> bz<c- p>]</c-> <c- o>=</c-> Jzazbz<c- p>;</c->
	<c- a>let</c-> Iz <c- o>=</c-> <c- p>(</c->Jz <c- o>+</c-> d0<c- p>)</c-> <c- o>/</c-> <c- p>(</c-><c- mf>1</c-> <c- o>+</c-> d <c- o>-</c-> d <c- o>*</c-> <c- p>(</c->Jz <c- o>+</c-> d0<c- p>));</c->

    <c- c1>// LMS 錐体領域へ</c->
	<c- a>let</c-> PQLMS <c- o>=</c-> multiplyMatrices<c- p>([</c->Iz<c- p>,</c-> az<c- p>,</c-> bz<c- p>],</c-> M<c- p>);</c->

    <c- c1>// PQ 符号化からリニアライト LMS に変換</c->
    <c- a>let</c-> LMS <c- o>=</c-> <c- p>(</c->
        PQLMS<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
            <c- a>let</c-> num <c- o>=</c-> c1 <c- o>-</c-> spow<c- p>(</c->val<c- p>,</c-> pinv<c- p>);</c->
            <c- a>let</c-> denom <c- o>=</c-> c3 <c- o>*</c-> spow<c- p>(</c->val<c- p>,</c-> pinv<c- p>)</c-> <c- o>-</c-> c2<c- p>;</c->
            <c- a>let</c-> x <c- o>=</c-> <c- mf>10000</c-> <c- o>*</c-> spow<c- p>(</c->num <c- o>/</c-> denom<c- p>,</c-> ninv<c- p>);</c->

            <c- k>return</c-> x<c- p>;</c-> <c- c1>// メディアホワイト相対輝度 [0, 約70]</c->
        <c- p>})</c->
    <c- p>);</c->
    <c- k>return</c-> LMS<c- p>;</c->
<c- p>}</c->
</pre>
        <h3 class="heading settled" data-level="11.5" id="ictcp_code"><span class="secno">11.5. </span><span
                class="content"> <span class="css">ICtCp</span> のサンプルコード </span><a class="self-link"
                href="#ictcp_code"></a></h3>
        <p>まず <span class="css">rec2100-linear</span> に変換することを要求せず、
            （これは<a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>で定義されている手順）
            ほかの色変換コードとの互換性のため、
            このサンプルコードでは絶対 CIE XYZ から直接進めます。</p>
        <p>4% のクロストーク行列と色相回転も
            XYZ から LMS へのステップに組み込み、
            3つの別ステップとして適用しません。</p>
        <p>最終結果は同一で、単に手順が少ないだけです。</p>
        <pre class="include-code highlight">
<c- a>function</c-> XYZ_to_ICtCp <c- p>(</c->XYZ<c- p>)</c-> <c- p>{</c->
    <c- c1>// D65 XYZ の配列を ICtCp に変換</c->

    <c- c1>// 以下の行列には 4% のクロストーク成分が含まれ、</c->
    <c- c1>// Dolby の "What is ICtCp" 論文の手順に基づく</c->
    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>0.3592832590121217</c-><c- p>,</c->  <c- mf>0.6976051147779502</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.0358915932320290</c-> <c- p>],</c->
        <c- p>[</c-> <c- o>-</c-><c- mf>0.1920808463704993</c-><c- p>,</c->  <c- mf>1.1004767970374321</c-><c- p>,</c->  <c- mf>0.0753748658519118</c-> <c- p>],</c->
        <c- p>[</c->  <c- mf>0.0070797844607479</c-><c- p>,</c->  <c- mf>0.0748396662186362</c-><c- p>,</c->  <c- mf>0.8433265453898765</c-> <c- p>],</c->
    <c- p>];</c->

    <c- a>let</c-> LMS <c- o>=</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> XYZ<c- p>.</c->map<c- p>(</c->v <c- p>=></c-> v <c- o>*</c-> Yw<c- p>));</c->
    <c- k>return</c-> LMStoICtCp<c- p>(</c->LMS<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> LMStoICtCp <c- p>(</c->LMS<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>;</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- mf>128</c-><c- p>;</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- mf>128</c-><c- p>;</c->
    <c- a>const</c-> m1 <c- o>=</c-> <c- mf>2610</c-> <c- o>/</c-> <c- mf>16384</c-><c- p>;</c->
    <c- a>const</c-> m2 <c- o>=</c-> <c- mf>2523</c-> <c- o>/</c-> <c- mf>32</c-><c- p>;</c->

    <c- c1>// この行列には Ebner の LMS 係数、回転、</c->
    <c- c1>// および [-0.5, 0.5] 範囲へのスケーリングが含まれる</c->
    <c- c1>// 有理係数は Fröhlich p.97 と ITU-R BT.2124-0 pp.2-3 に基づく</c->
    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>2048</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c->   <c- mf>2048</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c->       <c- mf>0</c->      <c- p>],</c->
        <c- p>[</c->  <c- mf>6610</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c-> <c- o>-</c-><c- mf>13613</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c->  <c- mf>7003</c-> <c- o>/</c-> <c- mf>4096</c-> <c- p>],</c->
        <c- p>[</c-> <c- mf>17933</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c-> <c- o>-</c-><c- mf>17390</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c->  <c- o>-</c-><c- mf>543</c-> <c- o>/</c-> <c- mf>4096</c-> <c- p>],</c->
    <c- p>];</c->

    <c- c1>// PQ の EOTF を適用</c->
    <c- c1>// [0, 10,000] が [0, 1] にマップされるようスケーリング</c->
    <c- c1>// 分母に「1 +」があるため 0 除算は起こらない</c->
    <c- a>let</c-> PQLMS <c- o>=</c-> LMS<c- p>.</c->map <c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- a>let</c-> num <c- o>=</c-> c1 <c- o>+</c-> <c- p>(</c->c2 <c- o>*</c-> <c- p>((</c->val <c- o>/</c-> <c- mf>10000</c-><c- p>)</c-> <c- o>**</c-> m1<c- p>));</c->
        <c- a>let</c-> denom <c- o>=</c-> <c- mf>1</c-> <c- o>+</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>((</c->val <c- o>/</c-> <c- mf>10000</c-><c- p>)</c-> <c- o>**</c-> m1<c- p>));</c->

        <c- k>return</c-> <c- p>(</c->num <c- o>/</c-> denom<c- p>)</c->  <c- o>**</c-> m2<c- p>;</c->
    <c- p>});</c->

    <c- c1>// Y'C'bC'r 互換のための回転を含む LMS→IPT 変換</c->
    <c- k>return</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> PQLMS<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> ICtCp_to_XYZ <c- p>(</c->ICtCp<c- p>)</c-> <c- p>{</c->
    <c- c1>// ICtCp を絶対 D65 XYZ 配列に変換</c->

    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>2.0701522183894223</c-><c- p>,</c-> <c- o>-</c-><c- mf>1.3263473389671563</c-><c- p>,</c->  <c- mf>0.2066510476294053</c-> <c- p>],</c->
        <c- p>[</c->  <c- mf>0.3647385209748072</c-><c- p>,</c->  <c- mf>0.6805660249472273</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.0453045459220347</c-> <c- p>],</c->
        <c- p>[</c-> <c- o>-</c-><c- mf>0.0497472075358123</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.0492609666966131</c-><c- p>,</c->  <c- mf>1.1880659249923042</c-> <c- p>],</c->
    <c- p>];</c->

    <c- a>let</c-> LMS <c- o>=</c-> ICtCptoLMS<c- p>(</c->ICtCp<c- p>);</c->
    <c- k>return</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> LMS<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> ICtCptoLMS <c- p>(</c->ICtCp<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>;</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- mf>128</c-><c- p>;</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- mf>128</c-><c- p>;</c->
    <c- a>const</c-> im1 <c- o>=</c-> <c- mf>16384</c-> <c- o>/</c-> <c- mf>2610</c-><c- p>;</c->
    <c- a>const</c-> im2 <c- o>=</c-> <c- mf>32</c-> <c- o>/</c-> <c- mf>2523</c-><c- p>;</c->

    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c-> <c- mf>0.9999999999999998</c-><c- p>,</c->  <c- mf>0.0086090370379328</c-><c- p>,</c->  <c- mf>0.1110296250030260</c-> <c- p>],</c->
        <c- p>[</c-> <c- mf>0.9999999999999998</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.0086090370379328</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.1110296250030259</c-> <c- p>],</c->
        <c- p>[</c-> <c- mf>0.9999999999999998</c-><c- p>,</c->  <c- mf>0.5600313357106791</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.3206271749873188</c-> <c- p>],</c->
    <c- p>];</c->

    <c- a>let</c-> PQLMS <c- o>=</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> ICtCp<c- p>);</c->

    <c- c1>// PQ 符号化を元に戻す（BT.2124-0 付録2 Conversion 3）</c->
    <c- a>let</c-> LMS <c- o>=</c-> PQLMS<c- p>.</c->map <c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- a>let</c-> num  <c- o>=</c-> Math<c- p>.</c->max<c- p>((</c->val <c- o>**</c-> im2<c- p>)</c-> <c- o>-</c-> c1<c- p>,</c-> <c- mf>0</c-><c- p>);</c->
        <c- a>let</c-> denom <c- o>=</c-> <c- p>(</c->c2 <c- o>-</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->val <c- o>**</c-> im2<c- p>)));</c->
        <c- k>return</c-> <c- mf>10000</c-> <c- o>*</c-> <c- p>((</c->num <c- o>/</c-> denom<c- p>)</c-> <c- o>**</c-> im1<c- p>);</c->
    <c- p>});</c->

    <c- k>return</c-> LMS<c- p>;</c->
<c- p>}</c-></pre>
        <h3 class="heading settled" data-level="11.6" id="hdr-color-code"><span class="secno">11.6. </span><span
                class="content"> <a class="css" data-link-type="maybe" href="#funcdef-hdr-color"
                    id="ref-for-funcdef-hdr-color②">hdr-color()</a> のサンプルコード </span><a class="self-link"
                href="#hdr-color-code"></a></h3>
        <pre class="include-code highlight"><c- a>function</c-> hdrColor<c- p>(</c->col1<c- p>,</c-> H1<c- p>,</c-> col2<c- p>,</c-> H2<c- p>,</c-> H<c- p>)</c-> <c- p>{</c->

    <c- c1>// col1, col2 は絶対 XYZ の 2 色を表す配列</c->
    <c- c1>// H1, H2 は各色のヘッドルーム（ストップ単位、すなわち対数スケール、0 = SDR）</c->
    <c- c1>// H は利用可能なヘッドルーム</c->

    <c- c1>// まずヘッドルームが異なることを確認</c->
    <c- k>if</c-> <c- p>(</c->H1 <c- o>==</c-> H2<c- p>)</c-> <c- k>return</c-> <c- mf>0</c-><c- p>;</c->

    <c- a>let</c-> w1 <c- o>=</c-> clamp<c- p>((</c->H <c- o>-</c-> H2<c- p>)</c-> <c- o>/</c-> <c- p>(</c->H1 <c- o>-</c-> H2<c- p>),</c-> <c- mf>0</c-><c- p>,</c-> <c- mf>1</c-><c- p>);</c->
    <c- a>let</c-> w2 <c- o>=</c-> clamp<c- p>((</c->H <c- o>-</c-> H1<c- p>)</c-> <c- o>/</c-> <c- p>(</c->H2 <c- o>-</c-> H1<c- p>),</c-> <c- mf>0</c-><c- p>,</c-> <c- mf>1</c-><c- p>);</c->
    <c- a>let</c-> eps <c- o>=</c-> <c- mf>0.001</c-><c- p>;</c->
    <c- a>let</c-> cxyz <c- o>=</c-> Array<c- p>(</c-><c- mf>3</c-><c- p>);</c->
    <c- k>for</c-> <c- p>(</c-><c- a>let</c-> i<c- o>=</c-><c- mf>0</c-><c- p>;</c-> i<c- o>&lt;</c-><c- mf>3</c-><c- p>;</c-> i<c- o>++</c-><c- p>)</c-> <c- p>{</c->
        cxyz<c- p>[</c->i<c- p>]</c-> <c- o>=</c-> Math<c- p>.</c->pow<c- p>(</c->c1xyz<c- p>[</c->i<c- p>]</c-> <c- o>+</c-> eps<c- p>,</c-> w1<c- p>)</c-> <c- o>*</c-> Math<c- p>.</c->pow<c- p>(</c->c2xyz<c- p>[</c->i<c- p>]</c-> <c- o>+</c-> eps<c- p>,</c-> w2<c- p>)</c-> <c- o>-</c-> eps<c- p>;</c->
    <c- p>}</c->
    <c- k>return</c-> cxyz<c- p>;</c->
<c- p>}</c->

<c- a>const</c-> clamp <c- o>=</c-> <c- p>(</c->n<c- p>,</c-> min<c- p>,</c-> max<c- p>)</c-> <c- p>=></c->
  Math<c- p>.</c->min<c- p>(</c->Math<c- p>.</c->max<c- p>(</c->n<c- p>,</c-> min<c- p>),</c-> max<c- p>)</c->
</pre>
        <h2 class="heading settled" data-level="12" id="deltaE"><span class="secno">12. </span><span class="content">
                ΔEITP 色差のサンプルコード </span><a class="self-link" href="#deltaE"></a></h2>
        <p><em>このセクションは規範的ではありません。</em></p>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>テスト</summary>
            <p>このセクションは規範的ではないため、テストは必要ありません。</p>
            <ul class="wpt-tests-list"></ul>
            <hr>
        </details>
        <p>ΔEITP <a data-link-type="biblio" href="#biblio-rec_bt2124"
                title="ITU-R BT.2124-0 Objective metric for the assessment of the potential visibility of colour differences in television">[Rec_BT.2124]</a>
            色差指標は、
            HDR または SDR/HDR 混在の文脈において、
            2 つのディスプレイ参照色の
            知覚的な色差を測るために使用できます。
            たとえばディスプレイのキャリブレーションや
            ガマット／トーンマッピングなどです。</p>
        <p>これは <span class="css">ICtCp</span> 色空間におけるユークリッド距離で、
            ΔEITP が 1.0 のとき
            ちょうど知覚可能な差を 1 とするようスケーリングされています。</p>
        <pre class="include-code highlight"><c- c1>// deltaE ITP を計算</c->
<c- c1>// スケーリングされた二乗和平方根</c->
<c- c1>// ITU-R BT.2124-0 付録 1</c->
<c- d>/**</c->
<c- d> * @param {number[]} reference - ICtCp の配列: I は 0..1、Ct/Cp は -1..1</c->
<c- d> * @param {number[]} sample -    ICtCp の配列: I は 0..1、Ct/Cp は -1..1</c->
<c- d> * @return {number} 参照色からサンプル色がどれだけ異なるか</c->
<c- d> */</c->
<c- a>function</c-> deltaEITP <c- p>(</c->reference<c- p>,</c-> sample<c- p>)</c-> <c- p>{</c->
    <c- a>let</c-> <c- p>[</c->I1<c- p>,</c-> Ct1<c- p>,</c-> Cp1<c- p>]</c-> <c- o>=</c-> reference<c- p>;</c->
	<c- a>let</c-> <c- p>[</c->I2<c- p>,</c-> Ct2<c- p>,</c-> Cp2<c- p>]</c-> <c- o>=</c-> sample<c- p>;</c->
	<c- a>let</c-> ΔI <c- o>=</c-> I1 <c- o>-</c-> I2<c- p>;</c->
	<c- a>let</c-> ΔT <c- o>=</c-> <c- mf>0.5</c-> <c- o>*</c-> <c- p>(</c->Ct1 <c- o>-</c-> Ct2<c- p>);</c->
	<c- a>let</c-> ΔP <c- o>=</c-> Cp1 <c- o>-</c-> Cp2<c- p>;</c->
	<c- k>return</c-> <c- mf>720</c-> <c- o>*</c-> Math<c- p>.</c->sqrt<c- p>(</c->ΔI <c- o>**</c-> <c- mf>2</c-> <c- o>+</c-> ΔT <c- o>**</c-> <c- mf>2</c-> <c- o>+</c-> ΔP <c- o>**</c-> <c- mf>2</c-><c- p>);</c->
<c- p>}</c-></pre>
        <h2 class="no-num heading settled" id="privacy"><span class="content">プライバシーに関する考慮事項</span><a class="self-link"
                href="#privacy"></a></h2>
        <p>Web プラットフォームが <a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom④">HDR ヘッドルーム</a>
            の数値を直接公開しない理由は、
            それによって現在の視聴環境が露出し、
            <a href="#headroom-privacy">プライバシー侵害</a>となるためです。
        </p>
        <h2 class="no-num heading settled" id="security"><span class="content">セキュリティに関する考慮事項</span><a class="self-link"
                href="#security"></a></h2>
        <p>本ドキュメントに関してセキュリティ上の懸念は提起されていません</p>
        <h2 class="no-num heading settled" id="a11y"><span class="content">アクセシビリティに関する考慮事項</span><a class="self-link"
                href="#a11y"></a></h2>
        <p>非常に明るい色に敏感な人がいるため、
            ユーザーエージェントはユーザーの選択で最大輝度を制限できる仕組みを提供すべきです。<span class="non-normative">適切な手法として、
                <a data-link-type="biblio" href="#biblio-rec_bt2390"
                    title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>
                のセクション 5.4.1 <em>制限された輝度範囲のディスプレイへのマッピング</em> にあるトー/ニー手順が推奨されます。</span></p>
        <p><span class="css">dynamic-range-limit</span> プロパティは、ユーザースタイルシートで
            <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                id="ref-for-valdef-dynamic-range-limit-standard④">standard</a> または <a class="css" data-link-type="maybe"
                href="#valdef-dynamic-range-limit-constrained"
                id="ref-for-valdef-dynamic-range-limit-constrained④">constrained</a> に設定することもできます。
        </p>
        <h2 class="no-num heading settled" id="changes"><span class="content"> 変更点 </span><a class="self-link"
                href="#changes"></a></h2>
        <h3 class="heading settled" id="changes-20241217"><span class="content">変更点（<a
                    href="https://www.w3.org/TR/2024/WD-css-color-hdr-1-20241217/">2024年12月17日の
                    最初の公開草案</a> 以降）</span><a class="self-link" href="#changes-20241217"></a></h3>
        <ul>
            <li>eps の根拠としての SMPTE-ST-2094-50 への言及を削除
                (<a href="https://github.com/w3c/csswg-drafts/issues/12873">#12873</a>, <a
                    href="https://github.com/w3c/csswg-drafts/issues/11788">#11788</a>)
            <li>hdr-color がアダプティブゲインカーブに類似することを追記
            <li>color 構文に alpha() の RCS を追加 <a href="https://github.com/w3c/csswg-drafts/issues/10689">#10689</a>
            <li>補間用のカラースペースに display-p3-linear を追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/12596">#12596</a>)
            <li>deltaE ITP の作業例をいくつか追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/11250">#11250</a>)
            <li>display-p3-linear カラースペースを追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/12596">#12596</a>)
            <li>hdr-color() で使用する clamp 関数を追加
            <li>hdr-color() のサンプルコードを追加
            <li>eps 係数の目的を説明
                (<a href="https://github.com/w3c/csswg-drafts/issues/11788">#11788</a>)
            <li>2つ目の color-hdr() の作業例を追加
            <li>用語「Absolute D65 CIE XYZ」を定義
            <li>color-hdr() の疑似コードを明確化し、各コンポーネントが個別に計算されることを示した
                (<a href="https://github.com/w3c/csswg-drafts/issues/11694">#11694</a>)
            <li>dynamic-range-limit-mix() を WG の決議に従い「1つ以上」に変更
                (<a href="https://github.com/w3c/csswg-drafts/issues/11694">#11694</a>)
            <li>dynamic-range-limit-mix() の算出値について、
                すべての引数が省略された場合は初期値となることを明確化
                (<a href="https://github.com/w3c/csswg-drafts/issues/11678">#11678</a>)
            <li>color() の再定義を削除し、代わりに CSS Color 5 の定義へリンク
                (<a href="https://github.com/w3c/csswg-drafts/issues/11954">#11954</a>)
            <li>WG の決議に従い「constrained-high」を「constrained」へ戻した
                (<a href="https://github.com/w3c/csswg-drafts/issues/11698">#11698</a>)
            <li>JzCzhz のクロマに ε を定義（色相欠落時の扱い）
                (<a href="https://github.com/w3c/csswg-drafts/issues/11706">#11706</a>)
            <li>用語「required conversion」を正しくエクスポートし、一貫して使用
            <li>JzCzhz における誤った負のクロマ参照範囲を削除
            <li>relative ictcp、jzazbz、jzczhz に対して RCS のコンポーネントキーワードを追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/11713">#11713</a>)
            <li>SDR のみである CSS Color 5 を指すように color() のリンクが戻ってしまうのを防止
            <li>ICtCp の紹介（情報）セクションを追加し、定義を color() から分離
                (<a href="https://github.com/w3c/csswg-drafts/issues/11713">#11713</a>)
            <li>CSS Color 5 に既存の重複する生成規則を削除
                (<a href="https://github.com/w3c/csswg-drafts/issues/11954">#11954</a>)
            <li>参照範囲を BT.2100 のガマット全体を包含するようにした
                (<a href="https://github.com/w3c/csswg-drafts/issues/11710">#11710</a>)
            <li>CSS WG の決議に従い「合計が 0 の場合は無効」という文言を削除
                (<a href="https://github.com/w3c/csswg-drafts/issues/11678">#11678</a>)
            <li>ヘッドルームの定義として線形（倍率）ではなく対数（ストップ）を一貫して使用
                (<a href="https://github.com/w3c/csswg-drafts/issues/11787">#11787</a>)
            <li>「media white」ではなく推奨用語「HDR reference white」を一貫して使用
            <li>色補間の例を追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/11616">#11616</a>)
            <li>補間アルゴリズムを追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/11616">#11616</a>)
            <li>ヘッドルームでパラメータ化された色の補間に関するセクションを追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/11616">#11616</a>)
            <li>WG の決議に基づき color-hdr 関数を追加。ISO 21496-1 の情報参照を追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/11616">#11616</a>)
            <li>Jzazbz のサンプルコードを追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/9934">#9934</a>)
            <li>サンプルコードに不足していた符号付きべき関数を追加
            <li>rec2100 カラースペースのサンプルコードを追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/9934">#9934</a>)
            <li>ICtCp のサンプルコードを追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/9934">#9934</a>)
            <li>Perrin による ICtCp 論文への情報参照を追加
            <li>新セクション「色変換のサンプルコード」を追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/9934">#9934</a>)
            <li>Dolby のホワイトペーパー「What is ICtCp」への情報参照を追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/9934">#9934</a>)
            <li>dynamic-range-limit-mix() の文法と仕様文を明確化
                (<a href="https://github.com/w3c/csswg-drafts/issues/11672">#11672</a>)
            <li>BT.2124 に基づく ΔEITP 色差指標を追加
                (<a href="https://github.com/w3c/csswg-drafts/issues/11250">#11250</a>)
            <li>dynamic-range-limit について、high を no-limit に変更
                (<a href="https://github.com/w3c/csswg-drafts/issues/11698">#11698</a>)
            <li>記述を修正し、dynamic-range-limit-mix は 2 つ以上の値を取ることを明記
                (<a href="https://github.com/w3c/csswg-drafts/issues/11694">#11694</a>)
            <li>絶対/相対 HDR の概念を削除し、代わりにシーン参照・ディスプレイ参照を強調。
                media white をアンカーし、カラーの再レンダリングを許容
                (<a href="https://github.com/w3c/csswg-drafts/issues/10460">#10460</a>)
            <li>「media white」をより明確に定義
            <li>解説的な内容を導入セクションに集約
        </ul>
    </main>
    <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content"> 適合性</span><a class="self-link"
            href="#w3c-conformance"></a></h2>
    <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content"> 文書上の規約</span><a class="self-link"
            href="#w3c-conventions"></a></h3>
    <p>適合性要件は記述的主張と RFC 2119 用語の組み合わせで表現されます。強調語句 “MUST”、
        “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
        “RECOMMENDED”, “MAY”, および “OPTIONAL” は、規範的部分では RFC 2119 に記載された通りに解釈されます。
        可読性のため、これらの語句は本仕様では全て大文字で表記されていない場合があります。</p>
    <p>本仕様のテキストは、明示的に非規範とされているセクション、例、注を除いてすべて規範的です。 <a data-link-type="biblio" href="#biblio-rfc2119"
            title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
    <p>本仕様の例は "for example" という語で導入されるか、<code>class="example"</code> で規範的テキストから区別されます。</p>
    <div class="example" id="w3c-example">
        <a class="self-link" href="#w3c-example"></a>
        <p>これは情報的な例の例です。</p>
    </div>
    <p>情報的注記は "Note" という語で始まり、<code>class="note"</code> によって規範的テキストから区別されます。</p>
    <p class="note" role="note">注: これは情報的な注記です。</p>
    <p>勧告は注意を促すための規範セクションであり、<code>&lt;strong class="advisement"></code> によって区別されます。例: <strong class="advisement"> UAs
            MUST provide an accessible alternative. </strong></p>
    <details class="wpt-tests-block" dir="ltr" lang="en" open>
        <summary>Tests</summary>
        <p>この仕様の内容に関するテストは、このような "Tests" ブロックに記述されることがあります。
            そのようなブロックはすべて非規範的です。</p>
        <ul class="wpt-tests-list"></ul>
        <hr>
    </details>
    <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content"> 適合クラス</span><a
            class="self-link" href="#w3c-conformance-classes"></a></h3>
    <p>本仕様への適合は 3 つの適合クラスで定義されています:</p>
    <dl>
        <dt>style sheet
        <dd><a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS スタイルシート</a>。
        <dt>renderer
        <dd>スタイルシートの意味を解釈し、それを用いて文書をレンダリングする <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>。
        <dt>authoring tool
        <dd>スタイルシートを書く <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>。
    </dl>
    <p>スタイルシートが本仕様に適合するのは、本モジュールで定義された文法を用いる宣言がすべてジェネリックな CSS 文法および各機能の文法に従って有効である場合です。</p>
    <p>レンダラーが本仕様に適合するのは、適切な仕様群に従ってスタイルシートを解釈することに加え、本仕様で定義されたすべての機能を正しく解析して文書をレンダリングできることが条件です。ただし、デバイスの制約により正しくレンダリングできない場合があっても、UA
        が非適合と見なされるわけではありません（例: モノクロモニターでの色表示が不要であること）。</p>
    <p>オーサリングツールが本仕様に適合するのは、ジェネリックな CSS 文法および本モジュールの各機能の文法に従って文法的に正しいスタイルシートを書き、スタイルシートに関するすべての適合要件を満たす場合です。</p>
    <h3 class="no-ref heading settled" id="w3c-partial"><span class="content"> 部分実装</span><a class="self-link"
            href="#w3c-partial"></a></h3>
    <p>フォワード互換性のある解析規則を利用してフォールバック値を割り当てられるように、CSS レンダラーはサポートレベルが利用できない at-rule、プロパティ、プロパティ値、キーワード、およびその他の構文構成要素を無効（適切に
        <a
            href="https://www.w3.org/TR/CSS21/conform.html#ignore">無視</a>）として扱う必要があります。特に、サポートされないコンポーネント値がある場合、単一の複数値プロパティ宣言内でサポートされる値だけを選択的に無視せずに残すことはできません:
        いずれかの値が無効（サポートされない値は無効とされる）であれば、CSS は宣言全体を無視することを要求します。
    </p>
    <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content"> 不安定および独自機能の実装</span><a
            class="self-link" href="#w3c-conform-future-proofing"></a></h4>
    <p>将来の安定した CSS 機能との衝突を避けるため、CSSWG は <a href="https://www.w3.org/TR/CSS/#future-proofing">ベストプラクティス</a> に従うことを推奨します。
    </p>
    <h3 class="no-ref heading settled" id="w3c-testing"><span class="content"> 非実験的実装</span><a class="self-link"
            href="#w3c-testing"></a></h3>
    <p>仕様が Candidate Recommendation ステージに達すると、非実験的な実装が可能になり、実装者は CR レベルの機能を正しく実装したことを示せる場合、接頭辞なしの実装をリリースするべきです。</p>
    <p>CSS の相互運用性を確立・維持するために、CSSWG は非実験的な CSS レンダラーに対して、接頭辞なし実装をリリースする前に実装報告（および必要ならその実装報告に使用したテストケース）を W3C
        に提出するよう要請しています。W3C に提出されたテストケースは CSS Working Group によるレビューと修正の対象になります。</p>
    <p>テストケースおよび実装報告の提出方法については、CSS Working Group のウェブサイト <a
            href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a> を参照してください。質問は <a
            href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
        メーリングリストへどうぞ。</p>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本仕様で定義されている用語</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#valdef-jzazbz-a">a</a><span>、§ 6.4 に</span>
        <li><a href="#absolute-d65-cie-xyz">絶対 D65 CIE XYZ</a><span>、§ 5 に</span>
        <li>
            alpha
            <ul>
                <li><a href="#valdef-ictcp-alpha">ictcp() の値</a><span>、§ 6.3 に</span>
                <li><a href="#valdef-jzazbz-alpha">jzazbz() の値</a><span>、§ 6.4 に</span>
                <li><a href="#valdef-jzczhz-alpha">jzczhz() の値</a><span>、§ 6.5 に</span>
            </ul>
        <li><a href="#valdef-jzazbz-b">b</a><span>、§ 6.4 に</span>
        <li><a href="#valdef-jzczhz-c">c</a><span>、§ 6.5 に</span>
        <li><a href="#typedef-color-function">&lt;color-function></a><span>、§ 4 に</span>
        <li><a href="#color-re-rendering">色再レンダリング</a><span>、§ 2.1 に</span>
        <li><a href="#valdef-dynamic-range-limit-constrained">constrained</a><span>、§ 3.1 に</span>
        <li><a href="#valdef-ictcp-cp">cp</a><span>、§ 6.3 に</span>
        <li><a href="#valdef-ictcp-ct">ct</a><span>、§ 6.3 に</span>
        <li><a href="#dynamic-range">ダイナミックレンジ</a><span>、§ 2.1 に</span>
        <li><a href="#propdef-dynamic-range-limit">dynamic-range-limit</a><span>、§ 3.1 に</span>
        <li><a href="#funcdef-dynamic-range-limit-mix">dynamic-range-limit-mix()</a><span>、§ 3.2 に</span>
        <li><a href="#valdef-jzczhz-h">h</a><span>、§ 6.5 に</span>
        <li><a href="#funcdef-hdr-color">hdr-color()</a><span>、§ 5 に</span>
        <li><a href="#hdr-headroom">HDR ヘッドルーム</a><span>、§ 2.2 に</span>
        <li><a href="#hdr-reference-white">HDR 基準白</a><span>、§ 2.1 に</span>
        <li><a href="#high-dynamic-range">ハイダイナミックレンジ</a><span>、§ 2.1 に</span>
        <li><a href="#valdef-ictcp-i">i</a><span>、§ 6.3 に</span>
        <li><a href="#ictcp">ICtCp</a><span>、§ 6.3 に</span>
        <li><a href="#funcdef-ictcp">ictcp()</a><span>、§ 4 に</span>
        <li>
            j
            <ul>
                <li><a href="#valdef-jzazbz-j">jzazbz() の値</a><span>、§ 6.4 に</span>
                <li><a href="#valdef-jzczhz-j">jzczhz() の値</a><span>、§ 6.5 に</span>
            </ul>
        <li><a href="#jzazbz">Jzazbz</a><span>、§ 6.4 に</span>
        <li><a href="#funcdef-jzazbz">jzazbz()</a><span>、§ 4 に</span>
        <li><a href="#jzczhz">JzCzhz</a><span>、§ 6.5 に</span>
        <li><a href="#funcdef-jzczhz">jzczhz()</a><span>、§ 4 に</span>
        <li><a href="#valdef-dynamic-range-limit-no-limit">no-limit</a><span>、§ 3.1 に</span>
        <li><a href="#typedef-predefined-rgb">&lt;predefined-rgb></a><span>、§ 7 に</span>
        <li><a href="#rec2100-hlg">rec2100-hlg</a><span>、§ 8.2 に</span>
        <li><a href="#rec2100-linear">rec2100-linear</a><span>、§ 8.3 に</span>
        <li><a href="#rec2100-pq">rec2100-pq</a><span>、§ 8.1 に</span>
        <li><a href="#valdef-dynamic-range-limit-standard">standard</a><span>、§ 3.1 に</span>
        <li><a href="#standard-dynamic-range">標準ダイナミックレンジ</a><span>、§ 2.1 に</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">参照によって定義された用語</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSS-CASCADE-5]</a> は次の用語を定義します:
            <ul>
                <li><span class="dfn-paneled" id="8c8e51b4">算出値</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-COLOR-4]</a> は次の用語を定義します:
            <ul>
                <li><span class="dfn-paneled" id="e5db470f">&lt;alpha-value></span>
                <li><span class="dfn-paneled" id="33347c0e">&lt;hue></span>
                <li><span class="dfn-paneled" id="f6f69187">カラースペース</span>
                <li><span class="dfn-paneled" id="c1a0e909">d65</span>
                <li><span class="dfn-paneled" id="5bd3632a">hsl()</span>
                <li><span class="dfn-paneled" id="239640fd">hsla()</span>
                <li><span class="dfn-paneled" id="4a14e4dc">lab</span>
                <li><span class="dfn-paneled" id="795f4c8b">輝度</span>
                <li><span class="dfn-paneled" id="528ea935">none</span>
                <li><span class="dfn-paneled" id="daabf294">rgb()</span>
                <li><span class="dfn-paneled" id="f3226176">rgba()</span>
                <li><span class="dfn-paneled" id="bd774466">sRGB</span>
                <li><span class="dfn-paneled" id="17858dc9">white</span>
                <li><span class="dfn-paneled" id="b3bfee63">xyz-d65</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-COLOR-5]</a> は次の用語を定義します:
            <ul>
                <li><span class="dfn-paneled" id="d04b6986">&lt;color></span>
                <li><span class="dfn-paneled" id="49716633">alpha()</span>
                <li><span class="dfn-paneled" id="4966c7f8">color()</span>
                <li><span class="dfn-paneled" id="59963a3c">成分キーワード</span>
                <li><span class="dfn-paneled" id="f7f2e8bc">hwb()</span>
                <li><span class="dfn-paneled" id="f1cce64a">lab()</span>
                <li><span class="dfn-paneled" id="9b2c9faa">lch()</span>
                <li><span class="dfn-paneled" id="deb378dd">oklab()</span>
                <li><span class="dfn-paneled" id="0e5d2494">oklch()</span>
                <li><span class="dfn-paneled" id="1953bdac">元の色</span>
                <li><span class="dfn-paneled" id="b786b3c1">相対色</span>
                <li><span class="dfn-paneled" id="f4b08404">必要な変換</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-VALUES-4]</a> は次の用語を定義します:
            <ul>
                <li><span class="dfn-paneled" id="c297b070">#</span>
                <li><span class="dfn-paneled" id="bdb4e757">&amp;&amp;</span>
                <li><span class="dfn-paneled" id="61bb5e44">&lt;number></span>
                <li><span class="dfn-paneled" id="128295ac">&lt;percentage></span>
                <li><span class="dfn-paneled" id="d4441b24">?</span>
                <li><span class="dfn-paneled" id="8a110a7b">CSS-wide keywords</span>
                <li><span class="dfn-paneled" id="4eb9d37e">|</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">規範的参考文献</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-css-cascade-5">[CSS-CASCADE-5]
        <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-cascade-5/"><cite>CSS
                    カスケードと継承 レベル 5</cite></a>. 2022年1月13日. CR. URL: <a
                href="https://www.w3.org/TR/css-cascade-5/">https://www.w3.org/TR/css-cascade-5/</a>
        <dt id="biblio-css-color-4">[CSS-COLOR-4]
        <dd>Chris Lilley; Tab Atkins Jr.; Lea Verou. <a href="https://www.w3.org/TR/css-color-4/"><cite>CSS 色モジュール レベル
                    4</cite></a>. 2025年4月24日. CRD. URL: <a
                href="https://www.w3.org/TR/css-color-4/">https://www.w3.org/TR/css-color-4/</a>
        <dt id="biblio-css-color-5">[CSS-COLOR-5]
        <dd>Chris Lilley; et al. <a href="https://www.w3.org/TR/css-color-5/"><cite>CSS 色モジュール レベル 5</cite></a>.
            2025年3月18日. WD. URL: <a href="https://www.w3.org/TR/css-color-5/">https://www.w3.org/TR/css-color-5/</a>
        <dt id="biblio-css-values-3">[CSS-VALUES-3]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-3/"><cite>CSS 値と単位 モジュール レベル
                    3</cite></a>. 2024年3月22日. CRD. URL: <a
                href="https://www.w3.org/TR/css-values-3/">https://www.w3.org/TR/css-values-3/</a>
        <dt id="biblio-css-values-4">[CSS-VALUES-4]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-4/"><cite>CSS 値と単位 モジュール レベル
                    4</cite></a>. 2024年3月12日. WD. URL: <a
                href="https://www.w3.org/TR/css-values-4/">https://www.w3.org/TR/css-values-4/</a>
        <dt id="biblio-css2">[CSS2]
        <dd>Bert Bos; et al. <a href="https://www.w3.org/TR/CSS2/"><cite>Cascading Style Sheets レベル 2 改訂 1 (CSS 2.1)
                    仕様</cite></a>. 2011年6月7日. REC. URL: <a
                href="https://www.w3.org/TR/CSS2/">https://www.w3.org/TR/CSS2/</a>
        <dt id="biblio-rec2020">[Rec.2020]
        <dd><a href="http://www.itu.int/rec/R-REC-BT.2020/en"><cite>勧告 ITU-R BT.2020-2:
                    制作および国際番組交換に用いる超高精細テレビシステムのパラメータ値</cite></a>. 2015年10月. URL: <a
                href="http://www.itu.int/rec/R-REC-BT.2020/en">http://www.itu.int/rec/R-REC-BT.2020/en</a>
        <dt id="biblio-rec_bt2100">[Rec_BT.2100]
        <dd><a href="https://www.itu.int/rec/recommendation.asp?lang=en&amp;parent=R-REC-BT.2100-3-202502-I"><cite>ITU-R
                    BT.2100-3 制作および国際番組交換に用いるハイダイナミックレンジテレビの画像パラメータ値</cite></a>. 2025年2月. URL: <a
                href="https://www.itu.int/rec/recommendation.asp?lang=en&amp;parent=R-REC-BT.2100-3-202502-I">https://www.itu.int/rec/recommendation.asp?lang=en&amp;parent=R-REC-BT.2100-3-202502-I</a>
        <dt id="biblio-rec_bt2390">[Rec_BT.2390]
        <dd><a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf"><cite>ITU-R BT.2390-8
                    制作および国際番組交換におけるハイダイナミックレンジテレビ</cite></a>.
            2020年2月. URL: <a
                href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf">https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>要件レベルを示すために RFC
                    で使用するキーワード</cite></a>. 1997年3月. ベストカレントプラクティス. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-rpt_bt2408">[Rpt_BT.2408]
        <dd><a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf"><cite>Report ITU-R
                    BT.2408-0 HDR テレビ制作における運用手法</cite></a>. 2017年10月. URL: <a
                href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf">https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf</a>
        <dt id="biblio-safdar-pucs">[Safdar-PUCS]
        <dd>Safdar, Muhammad; et al. <a
                href="https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272"><cite>高ダイナミックレンジおよび広色域を含む画像信号のための知覚的に一様な色空間</cite></a>.
            2017年6月26日. URL: <a
                href="https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272">https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272</a>
        <dt id="biblio-smpte-st-2084">[SMPTE-ST-2084]
        <dd><a href="https://pub.smpte.org/latest/st2084/st2084-2014.pdf"><cite>ST 2084:2014 - SMPTE 標準 -
                    マスタリング基準ディスプレイのハイダイナミックレンジ電気光学変換特性</cite></a>. 2014年8月29日. URL: <a
                href="https://pub.smpte.org/latest/st2084/st2084-2014.pdf">https://pub.smpte.org/latest/st2084/st2084-2014.pdf</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">参考情報</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-arib_std-b67">[ARIB_STD-B67]
        <dd><a
                href="https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf"><cite>番組制作のための拡張画像ダイナミックレンジテレビ（EIDRTV）システムの必須パラメータ値</cite></a>.
            2015年7月3日. URL: <a
                href="https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf">https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf</a>
        <dt id="biblio-development_itp">[Development_ITP]
        <dd>F.Ebner; M.D.Fairchild. <a
                href="https://www.researchgate.net/publication/221677980_Development_and_Testing_of_a_Color_Space_IPT_with_Improved_Hue_Uniformity"><cite>色相の均一性を改善した色空間（IPT）の開発と試験。In:
                    第6回 Color Imaging Conference 論文集, 8–13, 1998</cite></a>. 1998年1月. URL: <a
                href="https://www.researchgate.net/publication/221677980_Development_and_Testing_of_a_Color_Space_IPT_with_Improved_Hue_Uniformity">https://www.researchgate.net/publication/221677980_Development_and_Testing_of_a_Color_Space_IPT_with_Improved_Hue_Uniformity</a>
        <dt id="biblio-displayhdr">[DisplayHDR]
        <dd><a href="https://displayhdr.org/performance-criteria/"><cite>CTS 1.2 における DisplayHDR 仕様の概要</cite></a>.
            2024年5月17日. URL: <a
                href="https://displayhdr.org/performance-criteria/">https://displayhdr.org/performance-criteria/</a>
        <dt id="biblio-iso_21496-1">[ISO_21496-1]
        <dd><a href="https://www.iso.org/standard/86775.html"><cite>画像変換のためのゲインマップメタデータ：第1部：ダイナミックレンジ変換</cite></a>. URL:
            <a href="https://www.iso.org/standard/86775.html">https://www.iso.org/standard/86775.html</a>
        <dt id="biblio-perrin">[Perrin]
        <dd>Perrin, A-F.; et al. <a href="https://ieeexplore.ieee.org/document/8333011"><cite>ICtCp 対 Y'CbCr：HDR および WCG
                    のための ICtCp 色空間と適応リシェイパーの評価</cite></a>. 2018年5月. URL:
            <a href="https://ieeexplore.ieee.org/document/8333011">https://ieeexplore.ieee.org/document/8333011</a>
        <dt id="biblio-rec_bt2124">[Rec_BT.2124]
        <dd><a href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2124-0-201901-I!!PDF-E.pdf"><cite>ITU-R
                    BT.2124-0 テレビにおける色差の潜在的可視性評価のための客観指標</cite></a>. URL: <a
                href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2124-0-201901-I!!PDF-E.pdf">https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2124-0-201901-I!!PDF-E.pdf</a>
        <dt id="biblio-rec_bt814">[Rec_BT.814]
        <dd><a href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf"><cite>ディスプレイの明るさとコントラスト設定のための
                    PLUGE 試験信号および調整手順の仕様</cite></a>. 2018年7月. URL: <a
                href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf">https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf</a>
        <dt id="biblio-smpte-st-2094-50">[SMPTE-ST-2094-50]
        <dd><a href="https://github.com/SMPTE/st2094-50"><cite>色ボリューム変換のための動的メタデータ - アプリケーション #5（放送）</cite></a>. 2025年.
            URL: <a href="https://github.com/SMPTE/st2094-50">https://github.com/SMPTE/st2094-50</a>
        <dt id="biblio-what_is_ictcp">[What_is_ICtCp]
        <dd><a href="https://professional.dolby.com/siteassets/pdfs/ictcp_dolbywhitepaper_v071.pdf"><cite>ICtCp とは何か,
                    v7.1</cite></a>. URL: <a
                href="https://professional.dolby.com/siteassets/pdfs/ictcp_dolbywhitepaper_v071.pdf">https://professional.dolby.com/siteassets/pdfs/ictcp_dolbywhitepaper_v071.pdf</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="property-index"><span class="content">プロパティ索引</span><a
            class="self-link" href="#property-index"></a></h2>
    <div class="big-element-wrapper">
        <table class="index">
            <thead>
                <tr>
                    <th scope="col">名前
                    <th scope="col">値
                    <th scope="col">初期値
                    <th scope="col">適用対象
                    <th scope="col">継承
                    <th scope="col">パーセンテージ
                    <th scope="col">アニメーション型
                    <th scope="col">正規順序
                    <th scope="col">算出値
            <tbody>
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-dynamic-range-limit"
                            id="ref-for-propdef-dynamic-range-limit④">dynamic-range-limit</a>
                    <td>standard | no-limit | constrained | &lt;dynamic-range-limit-mix()>
                    <td>no-limit
                    <td>すべての要素
                    <td>はい
                    <td>該当なし
                    <td>dynamic-range-limit-mix() による
                    <td>文法通り
                    <td>dynamic-range-limit の算出値を参照
        </table>
    </div>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">課題索引</span><a class="self-link"
            href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue"> 対数スケールでSDRとHDRのダイナミックレンジを示す図を追加する <a class="issue-return" href="#issue-b905ab0c"
                title="該当節へ移動">↵</a></div>
        <div class="issue"> sRGBの赤・緑・青およびP3の赤・緑・青のエンコードを含む、他の例を追加する <a class="issue-return" href="#issue-3762b88c"
                title="該当節へ移動">↵</a></div>
        <div class="issue"> 他の例を追加する <a class="issue-return" href="#issue-63bd5f3d" title="該当節へ移動">↵</a></div>
        <div class="issue"> 同ページで定義されている黒レベルリフトΒを追加する？ <a class="issue-return" href="#issue-fb589d17"
                title="該当節へ移動">↵</a></div>
    </div>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "0e5d2494": { "dfnID": "0e5d2494", "dfnText": "oklch()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-oklch" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-oklch" },
                "128295ac": { "dfnID": "128295ac", "dfnText": "<percentage>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-percentage-value" }], "title": "3.2. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-percentage-value\u2460" }, { "id": "ref-for-percentage-value\u2461" }, { "id": "ref-for-percentage-value\u2462" }, { "id": "ref-for-percentage-value\u2463" }, { "id": "ref-for-percentage-value\u2464" }, { "id": "ref-for-percentage-value\u2465" }, { "id": "ref-for-percentage-value\u2466" }, { "id": "ref-for-percentage-value\u2467" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-values-4/#percentage-value" },
                "17858dc9": { "dfnID": "17858dc9", "dfnText": "white", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-color-white" }, { "id": "ref-for-valdef-color-white\u2460" }, { "id": "ref-for-valdef-color-white\u2461" }], "title": "3.1. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2462" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2463" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2464" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2465" }], "title": "8.1. rec2100-pq" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2466" }], "title": "8.3. rec2100-linear" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-color-white" },
                "1953bdac": { "dfnID": "1953bdac", "dfnText": "origin color", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-origin-color" }, { "id": "ref-for-origin-color\u2460" }, { "id": "ref-for-origin-color\u2461" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-origin-color\u2462" }, { "id": "ref-for-origin-color\u2463" }, { "id": "ref-for-origin-color\u2464" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-origin-color\u2465" }, { "id": "ref-for-origin-color\u2466" }, { "id": "ref-for-origin-color\u2467" }, { "id": "ref-for-origin-color\u2468" }], "title": "6.5. JzCzhz" }], "url": "https://www.w3.org/TR/css-color-5/#origin-color" },
                "239640fd": { "dfnID": "239640fd", "dfnText": "hsla()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-hsla" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#funcdef-hsla" },
                "33347c0e": { "dfnID": "33347c0e", "dfnText": "<hue>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-hue" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#typedef-hue" },
                "4966c7f8": { "dfnID": "4966c7f8", "dfnText": "color()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-color" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-funcdef-color\u2460" }, { "id": "ref-for-funcdef-color\u2461" }, { "id": "ref-for-funcdef-color\u2462" }], "title": "7. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }, { "refs": [{ "id": "ref-for-funcdef-color\u2463" }, { "id": "ref-for-funcdef-color\u2464" }, { "id": "ref-for-funcdef-color\u2465" }], "title": "10.1. \nSerializing values of the color() function" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-color" },
                "49716633": { "dfnID": "49716633", "dfnText": "alpha()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-alpha" }], "title": "4. The <color> syntax" }], "url": "https://drafts.csswg.org/css-color-5/#funcdef-alpha" },
                "4a14e4dc": { "dfnID": "4a14e4dc", "dfnText": "lab", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-lab-lab" }], "title": "6.1. \n\tIntroducing ICtCp\n" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-lab-lab" },
                "4eb9d37e": { "dfnID": "4eb9d37e", "dfnText": "|", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-comb-one" }, { "id": "ref-for-comb-one\u2460" }, { "id": "ref-for-comb-one\u2461" }], "title": "3.1. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-comb-one\u2462" }, { "id": "ref-for-comb-one\u2463" }, { "id": "ref-for-comb-one\u2464" }, { "id": "ref-for-comb-one\u2465" }, { "id": "ref-for-comb-one\u2466" }, { "id": "ref-for-comb-one\u2467" }, { "id": "ref-for-comb-one\u2468" }, { "id": "ref-for-comb-one\u2460\u24ea" }, { "id": "ref-for-comb-one\u2460\u2460" }, { "id": "ref-for-comb-one\u2460\u2461" }, { "id": "ref-for-comb-one\u2460\u2462" }, { "id": "ref-for-comb-one\u2460\u2463" }, { "id": "ref-for-comb-one\u2460\u2464" }, { "id": "ref-for-comb-one\u2460\u2465" }, { "id": "ref-for-comb-one\u2460\u2466" }, { "id": "ref-for-comb-one\u2460\u2467" }, { "id": "ref-for-comb-one\u2460\u2468" }, { "id": "ref-for-comb-one\u2461\u24ea" }, { "id": "ref-for-comb-one\u2461\u2460" }, { "id": "ref-for-comb-one\u2461\u2461" }, { "id": "ref-for-comb-one\u2461\u2462" }, { "id": "ref-for-comb-one\u2461\u2463" }, { "id": "ref-for-comb-one\u2461\u2464" }, { "id": "ref-for-comb-one\u2461\u2465" }, { "id": "ref-for-comb-one\u2461\u2466" }, { "id": "ref-for-comb-one\u2461\u2467" }, { "id": "ref-for-comb-one\u2461\u2468" }, { "id": "ref-for-comb-one\u2462\u24ea" }, { "id": "ref-for-comb-one\u2462\u2460" }, { "id": "ref-for-comb-one\u2462\u2461" }, { "id": "ref-for-comb-one\u2462\u2462" }, { "id": "ref-for-comb-one\u2462\u2463" }, { "id": "ref-for-comb-one\u2462\u2464" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-comb-one\u2462\u2465" }, { "id": "ref-for-comb-one\u2462\u2466" }, { "id": "ref-for-comb-one\u2462\u2467" }, { "id": "ref-for-comb-one\u2462\u2468" }, { "id": "ref-for-comb-one\u2463\u24ea" }, { "id": "ref-for-comb-one\u2463\u2460" }, { "id": "ref-for-comb-one\u2463\u2461" }, { "id": "ref-for-comb-one\u2463\u2462" }, { "id": "ref-for-comb-one\u2463\u2463" }], "title": "7. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "528ea935": { "dfnID": "528ea935", "dfnText": "none", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-color-none" }], "title": "6.5.1. \n\t\tConverting Jzazbz colors to JzCzhz colors" }, { "refs": [{ "id": "ref-for-valdef-color-none\u2460" }], "title": "6.5.2. \n\tConverting JzCzhz colors to Jzazbz  colors" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-color-none" },
                "59963a3c": { "dfnID": "59963a3c", "dfnText": "component keyword", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-component-keyword" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-component-keyword\u2460" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-component-keyword\u2461" }], "title": "6.5. JzCzhz" }], "url": "https://www.w3.org/TR/css-color-5/#component-keyword" },
                "5bd3632a": { "dfnID": "5bd3632a", "dfnText": "hsl()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-hsl" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#funcdef-hsl" },
                "61bb5e44": { "dfnID": "61bb5e44", "dfnText": "<number>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-number-value" }, { "id": "ref-for-number-value\u2460" }, { "id": "ref-for-number-value\u2461" }, { "id": "ref-for-number-value\u2462" }, { "id": "ref-for-number-value\u2463" }, { "id": "ref-for-number-value\u2464" }, { "id": "ref-for-number-value\u2465" }, { "id": "ref-for-number-value\u2466" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-number-value\u2467" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }, { "refs": [{ "id": "ref-for-number-value\u2468" }, { "id": "ref-for-number-value\u2460\u24ea" }, { "id": "ref-for-number-value\u2460\u2460" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-number-value\u2460\u2461" }, { "id": "ref-for-number-value\u2460\u2462" }, { "id": "ref-for-number-value\u2460\u2463" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-number-value\u2460\u2464" }, { "id": "ref-for-number-value\u2460\u2465" }, { "id": "ref-for-number-value\u2460\u2466" }, { "id": "ref-for-number-value\u2460\u2467" }], "title": "6.5. JzCzhz" }, { "refs": [{ "id": "ref-for-number-value\u2460\u2468" }], "title": "10.1. \nSerializing values of the color() function" }], "url": "https://www.w3.org/TR/css-values-4/#number-value" },
                "795f4c8b": { "dfnID": "795f4c8b", "dfnText": "luminance", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-luminance" }], "title": "2.1. Defining Dynamic Range" }, { "refs": [{ "id": "ref-for-luminance\u2460" }], "title": "2.2. Introducing Headroom" }], "url": "https://www.w3.org/TR/css-color-4/#luminance" },
                "8a110a7b": { "dfnID": "8a110a7b", "dfnText": "CSS-wide keywords", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-css-wide-keywords" }], "title": "1.1. Value Definitions" }], "url": "https://www.w3.org/TR/css-values-4/#css-wide-keywords" },
                "8c8e51b4": { "dfnID": "8c8e51b4", "dfnText": "computed value", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-computed-value" }], "title": "10.1. \nSerializing values of the color() function" }], "url": "https://www.w3.org/TR/css-cascade-5/#computed-value" },
                "9b2c9faa": { "dfnID": "9b2c9faa", "dfnText": "lch()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-lch" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-lch" },
                "absolute-d65-cie-xyz": { "dfnID": "absolute-d65-cie-xyz", "dfnText": "Absolute D65 CIE XYZ", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-absolute-d65-cie-xyz" }, { "id": "ref-for-absolute-d65-cie-xyz\u2460" }], "title": "5.1. \n\tInterpolating colors based on headroom\n" }], "url": "#absolute-d65-cie-xyz" },
                "b3bfee63": { "dfnID": "b3bfee63", "dfnText": "xyz-d65", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-color-xyz-d65" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-color-xyz-d65" },
                "b786b3c1": { "dfnID": "b786b3c1", "dfnText": "relative color", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-relative-color" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-relative-color\u2460" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-relative-color\u2461" }], "title": "6.5. JzCzhz" }], "url": "https://www.w3.org/TR/css-color-5/#relative-color" },
                "bd774466": { "dfnID": "bd774466", "dfnText": "sRGB", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sRGB-space" }, { "id": "ref-for-sRGB-space\u2460" }], "title": "2.1. Defining Dynamic Range" }], "url": "https://www.w3.org/TR/css-color-4/#sRGB-space" },
                "bdb4e757": { "dfnID": "bdb4e757", "dfnText": "&&", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-comb-all" }], "title": "3.2. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-comb-all\u2460" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }], "url": "https://www.w3.org/TR/css-values-4/#comb-all" },
                "c1a0e909": { "dfnID": "c1a0e909", "dfnText": "d65", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-d65" }], "title": "6.1. \n\tIntroducing ICtCp\n" }, { "refs": [{ "id": "ref-for-d65\u2460" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-d65\u2461" }, { "id": "ref-for-d65\u2462" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-d65\u2463" }], "title": "6.5. JzCzhz" }, { "refs": [{ "id": "ref-for-d65\u2464" }], "title": "8.1. rec2100-pq" }, { "refs": [{ "id": "ref-for-d65\u2465" }], "title": "8.2. rec2100-hlg" }, { "refs": [{ "id": "ref-for-d65\u2466" }], "title": "8.3. rec2100-linear" }], "url": "https://www.w3.org/TR/css-color-4/#d65" },
                "c297b070": { "dfnID": "c297b070", "dfnText": "#", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-comma" }], "title": "3.2. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-mult-comma\u2460" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }], "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "color-re-rendering": { "dfnID": "color-re-rendering", "dfnText": "color re-rendering", "external": false, "refSections": [], "url": "#color-re-rendering" },
                "d04b6986": { "dfnID": "d04b6986", "dfnText": "<color>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-color" }, { "id": "ref-for-typedef-color\u2460" }, { "id": "ref-for-typedef-color\u2461" }, { "id": "ref-for-typedef-color\u2462" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-typedef-color\u2463" }, { "id": "ref-for-typedef-color\u2464" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }, { "refs": [{ "id": "ref-for-typedef-color\u2465" }], "title": "10. \nSerializing <color> Values" }], "url": "https://www.w3.org/TR/css-color-5/#typedef-color" },
                "d4441b24": { "dfnID": "d4441b24", "dfnText": "?", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-opt" }, { "id": "ref-for-mult-opt\u2460" }, { "id": "ref-for-mult-opt\u2461" }, { "id": "ref-for-mult-opt\u2462" }, { "id": "ref-for-mult-opt\u2463" }, { "id": "ref-for-mult-opt\u2464" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-mult-opt\u2465" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }], "url": "https://www.w3.org/TR/css-values-4/#mult-opt" },
                "daabf294": { "dfnID": "daabf294", "dfnText": "rgb()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-rgb" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#funcdef-rgb" },
                "deb378dd": { "dfnID": "deb378dd", "dfnText": "oklab()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-oklab" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-oklab" },
                "dynamic-range": { "dfnID": "dynamic-range", "dfnText": "Dynamic range", "external": false, "refSections": [], "url": "#dynamic-range" },
                "e5db470f": { "dfnID": "e5db470f", "dfnText": "<alpha-value>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-color-alpha-value" }, { "id": "ref-for-typedef-color-alpha-value\u2460" }, { "id": "ref-for-typedef-color-alpha-value\u2461" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" },
                "f1cce64a": { "dfnID": "f1cce64a", "dfnText": "lab()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-lab" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-lab" },
                "f3226176": { "dfnID": "f3226176", "dfnText": "rgba()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-rgba" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#funcdef-rgba" },
                "f4b08404": { "dfnID": "f4b08404", "dfnText": "required conversion", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-required-conversion" }, { "id": "ref-for-required-conversion\u2460" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-required-conversion\u2461" }, { "id": "ref-for-required-conversion\u2462" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-required-conversion\u2463" }, { "id": "ref-for-required-conversion\u2464" }, { "id": "ref-for-required-conversion\u2465" }], "title": "6.5. JzCzhz" }], "url": "https://drafts.csswg.org/css-color-5/#required-conversion" },
                "f6f69187": { "dfnID": "f6f69187", "dfnText": "color space", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-color-space" }], "title": "7. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-color-4/#color-space" },
                "f7f2e8bc": { "dfnID": "f7f2e8bc", "dfnText": "hwb()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-hwb" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-hwb" },
                "funcdef-dynamic-range-limit-mix": { "dfnID": "funcdef-dynamic-range-limit-mix", "dfnText": "dynamic-range-limit-mix()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix" }, { "id": "ref-for-funcdef-dynamic-range-limit-mix\u2460" }], "title": "3.1. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix\u2461" }], "title": "3.2. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix\u2462" }, { "id": "ref-for-funcdef-dynamic-range-limit-mix\u2463" }], "title": "3.3. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#funcdef-dynamic-range-limit-mix" },
                "funcdef-hdr-color": { "dfnID": "funcdef-hdr-color", "dfnText": "hdr-color()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-hdr-color" }, { "id": "ref-for-funcdef-hdr-color\u2460" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }, { "refs": [{ "id": "ref-for-funcdef-hdr-color\u2461" }], "title": "11.6. \n\tSample code for hdr-color()\n" }], "url": "#funcdef-hdr-color" },
                "funcdef-ictcp": { "dfnID": "funcdef-ictcp", "dfnText": "ictcp()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-ictcp" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-funcdef-ictcp\u2460" }], "title": "6.3. ICtCp" }], "url": "#funcdef-ictcp" },
                "funcdef-jzazbz": { "dfnID": "funcdef-jzazbz", "dfnText": "jzazbz()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-jzazbz" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-funcdef-jzazbz\u2460" }], "title": "6.4. Jzazbz" }], "url": "#funcdef-jzazbz" },
                "funcdef-jzczhz": { "dfnID": "funcdef-jzczhz", "dfnText": "jzczhz()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-jzczhz" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-funcdef-jzczhz\u2460" }], "title": "6.5. JzCzhz" }], "url": "#funcdef-jzczhz" },
                "hdr-headroom": { "dfnID": "hdr-headroom", "dfnText": "HDR headroom", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-hdr-headroom" }], "title": "2.2. Introducing Headroom" }, { "refs": [{ "id": "ref-for-hdr-headroom\u2460" }, { "id": "ref-for-hdr-headroom\u2461" }, { "id": "ref-for-hdr-headroom\u2462" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }, { "refs": [{ "id": "ref-for-hdr-headroom\u2463" }], "title": "Privacy Considerations" }], "url": "#hdr-headroom" },
                "hdr-reference-white": { "dfnID": "hdr-reference-white", "dfnText": "HDR reference white", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-hdr-reference-white" }], "title": "2.1. Defining Dynamic Range" }, { "refs": [{ "id": "ref-for-hdr-reference-white\u2460" }], "title": "8.3. rec2100-linear" }], "url": "#hdr-reference-white" },
                "high-dynamic-range": { "dfnID": "high-dynamic-range", "dfnText": "High Dynamic Range", "external": false, "refSections": [], "url": "#high-dynamic-range" },
                "ictcp": { "dfnID": "ictcp", "dfnText": "ICtCp", "external": false, "refSections": [], "url": "#ictcp" },
                "jzazbz": { "dfnID": "jzazbz", "dfnText": "Jzazbz", "external": false, "refSections": [], "url": "#jzazbz" },
                "jzczhz": { "dfnID": "jzczhz", "dfnText": "JzCzhz", "external": false, "refSections": [], "url": "#jzczhz" },
                "propdef-dynamic-range-limit": { "dfnID": "propdef-dynamic-range-limit", "dfnText": "dynamic-range-limit", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-propdef-dynamic-range-limit" }], "title": "3.1. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-propdef-dynamic-range-limit\u2460" }, { "id": "ref-for-propdef-dynamic-range-limit\u2461" }], "title": "3.2. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-propdef-dynamic-range-limit\u2462" }], "title": "3.3. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#propdef-dynamic-range-limit" },
                "rec2100-hlg": { "dfnID": "rec2100-hlg", "dfnText": "rec2100-hlg", "external": false, "refSections": [], "url": "#rec2100-hlg" },
                "rec2100-linear": { "dfnID": "rec2100-linear", "dfnText": "rec2100-linear", "external": false, "refSections": [], "url": "#rec2100-linear" },
                "rec2100-pq": { "dfnID": "rec2100-pq", "dfnText": "rec2100-pq", "external": false, "refSections": [], "url": "#rec2100-pq" },
                "standard-dynamic-range": { "dfnID": "standard-dynamic-range", "dfnText": "Standard Dynamic Range", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-standard-dynamic-range" }], "title": "2.2. Introducing Headroom" }], "url": "#standard-dynamic-range" },
                "typedef-color-function": { "dfnID": "typedef-color-function", "dfnText": "<color-function>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-color-function" }], "title": "4. The <color> syntax" }], "url": "#typedef-color-function" },
                "typedef-predefined-rgb": { "dfnID": "typedef-predefined-rgb", "dfnText": "<predefined-rgb>", "external": false, "refSections": [], "url": "#typedef-predefined-rgb" },
                "valdef-dynamic-range-limit-constrained": { "dfnID": "valdef-dynamic-range-limit-constrained", "dfnText": "constrained", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-constrained" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained\u2462" }], "title": "3.3. \n\tComputed Value for dynamic-range-limit\n" }, { "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-constrained\u2463" }], "title": "Accessibility Considerations" }], "url": "#valdef-dynamic-range-limit-constrained" },
                "valdef-dynamic-range-limit-no-limit": { "dfnID": "valdef-dynamic-range-limit-no-limit", "dfnText": "no-limit", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-no-limit" }, { "id": "ref-for-valdef-dynamic-range-limit-no-limit\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-no-limit\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-no-limit\u2462" }], "title": "3.3. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#valdef-dynamic-range-limit-no-limit" },
                "valdef-dynamic-range-limit-standard": { "dfnID": "valdef-dynamic-range-limit-standard", "dfnText": "standard", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-standard" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2462" }], "title": "3.3. \n\tComputed Value for dynamic-range-limit\n" }, { "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-standard\u2463" }], "title": "Accessibility Considerations" }], "url": "#valdef-dynamic-range-limit-standard" },
                "valdef-ictcp-alpha": { "dfnID": "valdef-ictcp-alpha", "dfnText": "alpha", "external": false, "refSections": [], "url": "#valdef-ictcp-alpha" },
                "valdef-ictcp-cp": { "dfnID": "valdef-ictcp-cp", "dfnText": "cp", "external": false, "refSections": [], "url": "#valdef-ictcp-cp" },
                "valdef-ictcp-ct": { "dfnID": "valdef-ictcp-ct", "dfnText": "ct", "external": false, "refSections": [], "url": "#valdef-ictcp-ct" },
                "valdef-ictcp-i": { "dfnID": "valdef-ictcp-i", "dfnText": "i", "external": false, "refSections": [], "url": "#valdef-ictcp-i" },
                "valdef-jzazbz-a": { "dfnID": "valdef-jzazbz-a", "dfnText": "a", "external": false, "refSections": [], "url": "#valdef-jzazbz-a" },
                "valdef-jzazbz-alpha": { "dfnID": "valdef-jzazbz-alpha", "dfnText": "alpha", "external": false, "refSections": [], "url": "#valdef-jzazbz-alpha" },
                "valdef-jzazbz-b": { "dfnID": "valdef-jzazbz-b", "dfnText": "b", "external": false, "refSections": [], "url": "#valdef-jzazbz-b" },
                "valdef-jzazbz-j": { "dfnID": "valdef-jzazbz-j", "dfnText": "j", "external": false, "refSections": [], "url": "#valdef-jzazbz-j" },
                "valdef-jzczhz-alpha": { "dfnID": "valdef-jzczhz-alpha", "dfnText": "alpha", "external": false, "refSections": [], "url": "#valdef-jzczhz-alpha" },
                "valdef-jzczhz-c": { "dfnID": "valdef-jzczhz-c", "dfnText": "c", "external": false, "refSections": [], "url": "#valdef-jzczhz-c" },
                "valdef-jzczhz-h": { "dfnID": "valdef-jzczhz-h", "dfnText": "h", "external": false, "refSections": [], "url": "#valdef-jzczhz-h" },
                "valdef-jzczhz-j": { "dfnID": "valdef-jzczhz-j", "dfnText": "j", "external": false, "refSections": [], "url": "#valdef-jzczhz-j" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-link-titles */
        "use strict";
        {
            let linkTitleData = {
                "https://www.w3.org/TR/css-color-5/#typedef-color": "Expands to: <alpha-value> | aliceblue | antiquewhite | aqua | aquamarine | azure | beige | bisque | black | blanchedalmond | blue | blueviolet | brown | burlywood | cadetblue | chartreuse | chocolate | coral | cornflowerblue | cornsilk | crimson | currentcolor | cyan | darkblue | darkcyan | darkgoldenrod | darkgray | darkgreen | darkgrey | darkkhaki | darkmagenta | darkolivegreen | darkorange | darkorchid | darkred | darksalmon | darkseagreen | darkslateblue | darkslategray | darkslategrey | darkturquoise | darkviolet | deeppink | deepskyblue | dimgray | dimgrey | dodgerblue | firebrick | floralwhite | forestgreen | fuchsia | gainsboro | ghostwhite | gold | goldenrod | gray | green | greenyellow | grey | honeydew | hotpink | indianred | indigo | ivory | khaki | lavender | lavenderblush | lawngreen | lemonchiffon | lightblue | lightcoral | lightcyan | lightgoldenrodyellow | lightgray | lightgreen | lightgrey | lightpink | lightsalmon | lightseagreen | lightskyblue | lightslategray | lightslategrey | lightsteelblue | lightyellow | lime | limegreen | linen | magenta | maroon | mediumaquamarine | mediumblue | mediumorchid | mediumpurple | mediumseagreen | mediumslateblue | mediumspringgreen | mediumturquoise | mediumvioletred | midnightblue | mintcream | mistyrose | moccasin | navajowhite | navy | none | oldlace | olive | olivedrab | orange | orangered | orchid | palegoldenrod | palegreen | paleturquoise | palevioletred | papayawhip | peachpuff | peru | pink | plum | powderblue | purple | rebeccapurple | red | rosybrown | royalblue | saddlebrown | salmon | sandybrown | seagreen | seashell | sienna | silver | skyblue | slateblue | slategray | slategrey | snow | springgreen | steelblue | tan | teal | thistle | tomato | transparent | turquoise | violet | wheat | white | whitesmoke | yellow | yellowgreen",
            };

            function setTypeTitles() {
                for (let el of document.querySelectorAll("a[href]")) {
                    if (el.href in linkTitleData && !el.hasAttribute("title")) {
                        el.setAttribute("title", linkTitleData[el.href]);
                    }
                }
            }

            document.addEventListener("DOMContentLoaded", setTypeTitles);
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#absolute-d65-cie-xyz": { "displayText": "absolute d65 cie xyz", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "absolute d65 cie xyz", "type": "dfn", "url": "#absolute-d65-cie-xyz" },
                "#funcdef-dynamic-range-limit-mix": { "displayText": "dynamic-range-limit-mix()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "dynamic-range-limit-mix()", "type": "function", "url": "#funcdef-dynamic-range-limit-mix" },
                "#funcdef-hdr-color": { "displayText": "hdr-color()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "hdr-color()", "type": "function", "url": "#funcdef-hdr-color" },
                "#funcdef-ictcp": { "displayText": "ictcp()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "ictcp()", "type": "function", "url": "#funcdef-ictcp" },
                "#funcdef-jzazbz": { "displayText": "jzazbz()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "jzazbz()", "type": "function", "url": "#funcdef-jzazbz" },
                "#funcdef-jzczhz": { "displayText": "jzczhz()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "jzczhz()", "type": "function", "url": "#funcdef-jzczhz" },
                "#hdr-headroom": { "displayText": "hdr headroom", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "hdr headroom", "type": "dfn", "url": "#hdr-headroom" },
                "#hdr-reference-white": { "displayText": "hdr reference white", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "hdr reference white", "type": "dfn", "url": "#hdr-reference-white" },
                "#propdef-dynamic-range-limit": { "displayText": "dynamic-range-limit", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "dynamic-range-limit", "type": "property", "url": "#propdef-dynamic-range-limit" },
                "#standard-dynamic-range": { "displayText": "standard dynamic range", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "standard dynamic range", "type": "dfn", "url": "#standard-dynamic-range" },
                "#typedef-color-function": { "displayText": "<color-function>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<color-function>", "type": "type", "url": "#typedef-color-function" },
                "#valdef-dynamic-range-limit-constrained": { "displayText": "constrained", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "constrained", "type": "value", "url": "#valdef-dynamic-range-limit-constrained" },
                "#valdef-dynamic-range-limit-no-limit": { "displayText": "no-limit", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "no-limit", "type": "value", "url": "#valdef-dynamic-range-limit-no-limit" },
                "#valdef-dynamic-range-limit-standard": { "displayText": "standard", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "standard", "type": "value", "url": "#valdef-dynamic-range-limit-standard" },
                "https://drafts.csswg.org/css-color-5/#funcdef-alpha": { "displayText": "alpha()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "current", "text": "alpha()", "type": "function", "url": "https://drafts.csswg.org/css-color-5/#funcdef-alpha" },
                "https://drafts.csswg.org/css-color-5/#required-conversion": { "displayText": "required conversion", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "current", "text": "required conversion", "type": "dfn", "url": "https://drafts.csswg.org/css-color-5/#required-conversion" },
                "https://www.w3.org/TR/css-cascade-5/#computed-value": { "displayText": "computed value", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-cascade", "spec": "css-cascade-5", "status": "snapshot", "text": "computed value", "type": "dfn", "url": "https://www.w3.org/TR/css-cascade-5/#computed-value" },
                "https://www.w3.org/TR/css-color-4/#color-space": { "displayText": "color space", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "color space", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#color-space" },
                "https://www.w3.org/TR/css-color-4/#d65": { "displayText": "d65", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "d65", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#d65" },
                "https://www.w3.org/TR/css-color-4/#funcdef-hsl": { "displayText": "hsl()", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "hsl()", "type": "function", "url": "https://www.w3.org/TR/css-color-4/#funcdef-hsl" },
                "https://www.w3.org/TR/css-color-4/#funcdef-hsla": { "displayText": "hsla()", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "hsla()", "type": "function", "url": "https://www.w3.org/TR/css-color-4/#funcdef-hsla" },
                "https://www.w3.org/TR/css-color-4/#funcdef-rgb": { "displayText": "rgb()", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "rgb()", "type": "function", "url": "https://www.w3.org/TR/css-color-4/#funcdef-rgb" },
                "https://www.w3.org/TR/css-color-4/#funcdef-rgba": { "displayText": "rgba()", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "rgba()", "type": "function", "url": "https://www.w3.org/TR/css-color-4/#funcdef-rgba" },
                "https://www.w3.org/TR/css-color-4/#luminance": { "displayText": "luminance", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "luminance", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#luminance" },
                "https://www.w3.org/TR/css-color-4/#sRGB-space": { "displayText": "sRGB", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "srgb", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#sRGB-space" },
                "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value": { "displayText": "<alpha-value>", "export": true, "for_": ["<color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "<alpha-value>", "type": "type", "url": "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" },
                "https://www.w3.org/TR/css-color-4/#typedef-hue": { "displayText": "<hue>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "<hue>", "type": "type", "url": "https://www.w3.org/TR/css-color-4/#typedef-hue" },
                "https://www.w3.org/TR/css-color-4/#valdef-color-none": { "displayText": "none", "export": true, "for_": ["<color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "none", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-color-none" },
                "https://www.w3.org/TR/css-color-4/#valdef-color-white": { "displayText": "white", "export": true, "for_": ["<color>", "<named-color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "white", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-color-white" },
                "https://www.w3.org/TR/css-color-4/#valdef-color-xyz-d65": { "displayText": "xyz-d65", "export": true, "for_": ["color()"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "xyz-d65", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-color-xyz-d65" },
                "https://www.w3.org/TR/css-color-4/#valdef-lab-lab": { "displayText": "lab", "export": true, "for_": ["lab()"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "lab", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-lab-lab" },
                "https://www.w3.org/TR/css-color-5/#component-keyword": { "displayText": "component keyword", "export": false, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "component keyword", "type": "dfn", "url": "https://www.w3.org/TR/css-color-5/#component-keyword" },
                "https://www.w3.org/TR/css-color-5/#funcdef-color": { "displayText": "color()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "color()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-color" },
                "https://www.w3.org/TR/css-color-5/#funcdef-hwb": { "displayText": "hwb()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "hwb()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-hwb" },
                "https://www.w3.org/TR/css-color-5/#funcdef-lab": { "displayText": "lab()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "lab()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-lab" },
                "https://www.w3.org/TR/css-color-5/#funcdef-lch": { "displayText": "lch()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "lch()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-lch" },
                "https://www.w3.org/TR/css-color-5/#funcdef-oklab": { "displayText": "oklab()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "oklab()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-oklab" },
                "https://www.w3.org/TR/css-color-5/#funcdef-oklch": { "displayText": "oklch()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "oklch()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-oklch" },
                "https://www.w3.org/TR/css-color-5/#origin-color": { "displayText": "origin color", "export": false, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "origin color", "type": "dfn", "url": "https://www.w3.org/TR/css-color-5/#origin-color" },
                "https://www.w3.org/TR/css-color-5/#relative-color": { "displayText": "relative color", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "relative color", "type": "dfn", "url": "https://www.w3.org/TR/css-color-5/#relative-color" },
                "https://www.w3.org/TR/css-color-5/#typedef-color": { "displayText": "<color>", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "<color>", "type": "type", "url": "https://www.w3.org/TR/css-color-5/#typedef-color" },
                "https://www.w3.org/TR/css-values-4/#comb-all": { "displayText": "&&", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "&&", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#comb-all" },
                "https://www.w3.org/TR/css-values-4/#comb-one": { "displayText": "|", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "|", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "https://www.w3.org/TR/css-values-4/#css-wide-keywords": { "displayText": "CSS-wide keywords", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "css-wide keywords", "type": "dfn", "url": "https://www.w3.org/TR/css-values-4/#css-wide-keywords" },
                "https://www.w3.org/TR/css-values-4/#mult-comma": { "displayText": "#", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "#", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "https://www.w3.org/TR/css-values-4/#mult-opt": { "displayText": "?", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "?", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-opt" },
                "https://www.w3.org/TR/css-values-4/#number-value": { "displayText": "<number>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<number>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#number-value" },
                "https://www.w3.org/TR/css-values-4/#percentage-value": { "displayText": "<percentage>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<percentage>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#percentage-value" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
                    // Give the original term if it's being displayed in a different way.
                    // But allow casing differences, they're insignificant.
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.displayText)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const refHintKey = link.getAttribute("data-refhint-key");
                let key = url;
                if (refHintKey) {
                    key = refHintKey + "_" + url;
                }
                const ref = refsData[key];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-wpt */
        "use strict";
        {
            let wptData = {
                "paths": ["/css/css-color-hdr/"],
            };

            document.addEventListener("DOMContentLoaded", async () => {
                if (wptData.paths.length == 0) return;

                const runsUrl = "https://wpt.fyi/api/runs?label=master&label=stable&max-count=1&product=chrome&product=firefox&product=safari&product=edge";
                const runs = await (await fetch(runsUrl)).json();

                let testResults = [];
                for (const pathPrefix of wptData.paths) {
                    const pathResults = await (await fetch("https://wpt.fyi/api/search", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            "run_ids": runs.map(x => x.id),
                            "query": { "path": pathPrefix },
                        })
                    })).json();
                    testResults = testResults.concat(pathResults.results);
                }

                const browsers = runs.map(x => ({ name: x.browser_name, version: x.browser_version, passes: 0, total: 0 }));
                const resultsFromPath = new Map(testResults.map(result => {
                    const testPath = result.test;
                    const passes = result.legacy_status.map(x => [x.passes, x.total]);
                    return [testPath, passes];
                }));
                const seenTests = new Set();
                document.querySelectorAll(".wpt-name").forEach(nameEl => {
                    const passData = resultsFromPath.get("/" + nameEl.getAttribute("title"));
                    if (!passData) {
                        console.log("Couldn't find test in results:", nameEl);
                        return
                    }
                    const numTests = passData[0][1];
                    if (numTests > 1) {
                        nameEl.insertAdjacentElement("beforeend",
                            mk.small({}, ` (${numTests} tests)`));
                    }
                    if (passData == undefined) return;
                    const resultsEl = mk.span({ "class": "wpt-results" },
                        ...passData.map((p, i) => mk.span(
                            {
                                "title": `${browsers[i].name} ${p[0]}/${p[1]}`,
                                "class": "wpt-result",
                                "style": `background: conic-gradient(forestgreen ${p[0] / p[1] * 360}deg, darkred 0deg);`,
                            })),
                    );
                    nameEl.insertAdjacentElement("afterend", resultsEl);

                    // Only update the summary pass/total count if we haven't seen this
                    // test before, to support authors listing the same test multiple times
                    // in a spec.
                    if (!seenTests.has(nameEl.getAttribute("title"))) {
                        seenTests.add(nameEl.getAttribute("title"));
                        passData.forEach((p, i) => {
                            browsers[i].passes += p[0];
                            browsers[i].total += p[1];
                        });
                    }
                });
                const overview = document.querySelector(".wpt-overview");
                if (overview) {
                    overview.appendChild(mk.ul({}, ...browsers.map(formatWptResult)));
                    document.head.appendChild(mk.style({},
                        `.wpt-overview ul { display: flex; flex-flow: row wrap; gap: .2em; justify-content: start; list-style: none; padding: 0; margin: 0;}
             .wpt-overview li { padding: .25em 1em; color: black; text-align: center; }
             .wpt-overview img { height: 1.5em; height: max(1.5em, 32px); background: transparent; }
             .wpt-overview .browser { font-weight: bold; }
             .wpt-overview .passes-none { background: #e57373; }
             .wpt-overview .passes-hardly { background: #ffb74d; }
             .wpt-overview .passes-a-few { background: #ffd54f; }
             .wpt-overview .passes-half { background: #fff176; }
             .wpt-overview .passes-lots { background: #dce775; }
             .wpt-overview .passes-most { background: #aed581; }
             .wpt-overview .passes-all { background: #81c784; }`));
                }
            });

            function formatWptResult({ name, version, passes, total }) {
                const passRate = passes / total;
                let passClass = "";
                if (passRate == 0) passClass = "passes-none";
                else if (passRate < .2) passClass = "passes-hardly";
                else if (passRate < .4) passClass = "passes-a-few";
                else if (passRate < .6) passClass = "passes-half";
                else if (passRate < .8) passClass = "passes-lots";
                else if (passRate < 1) passClass = "passes-most";
                else passClass = "passes-all";

                name = name[0].toUpperCase() + name.slice(1);
                const shortVersion = /^\d+/.exec(version);
                const icon = []

                if (name == "Chrome") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/chrome_64x64.png" }));
                if (name == "Edge") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/edge_64x64.png" }));
                if (name == "Safari") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/safari_64x64.png" }));
                if (name == "Firefox") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/firefox_64x64.png" }));

                return mk.li({ "class": passClass },
                    mk.nobr({ 'class': 'browser' }, ...icon, ` ${name} ${shortVersion}`),
                    mk.br(),
                    mk.nobr({ 'class': 'pass-rate' }, `${passes}/${total}`)
                );
            }
        }
    </script>
    <script src="https://htmlspecs.com/dropdown.js"></script>