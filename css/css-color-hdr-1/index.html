<!doctype html>
<html lang="ja-JP">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>CSS カラー HDR モジュール レベル 1</title>
    <meta content="FPWD" name="w3c-status">
    <!-- <meta content="Bikeshed version ac5ea272d, updated Fri Dec 6 15:45:15 2024 -0800" name="generator"> -->
    <link href="https://www.w3.org/TR/css-color-hdr-1/" rel="canonical">
    <!-- <meta content="97f683a0274c6386a874a31ed1dfa99a6f19b034" name="revision"> -->
    <meta content="dark light" name="color-scheme">
    <link href="https://www.w3.org/TR/css-color-hdr-1/style.css" rel="stylesheet">
    <style>
        /* Boilerplate: style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-colors */
        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* Boilerplate: style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-selflinks */
        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* Boilerplate: style-syntax-highlighting */
        code.highlight {
            padding: .1em;
            border-radius: .3em;
        }

        pre.highlight,
        pre>code.highlight {
            display: block;
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
            border-radius: 0;
        }

        .highlight:not(.idl) {
            background: rgba(0, 0, 0, .03);
        }

        c-[a] {
            color: #990055
        }

        /* Keyword.Declaration */
        c-[b] {
            color: #990055
        }

        /* Keyword.Type */
        c-[c] {
            color: #708090
        }

        /* Comment */
        c-[d] {
            color: #708090
        }

        /* Comment.Multiline */
        c-[e] {
            color: #0077aa
        }

        /* Name.Attribute */
        c-[f] {
            color: #669900
        }

        /* Name.Tag */
        c-[g] {
            color: #222222
        }

        /* Name.Variable */
        c-[k] {
            color: #990055
        }

        /* Keyword */
        c-[l] {
            color: #000000
        }

        /* Literal */
        c-[m] {
            color: #000000
        }

        /* Literal.Number */
        c-[n] {
            color: #0077aa
        }

        /* Name */
        c-[o] {
            color: #999999
        }

        /* Operator */
        c-[p] {
            color: #999999
        }

        /* Punctuation */
        c-[s] {
            color: #a67f59
        }

        /* Literal.String */
        c-[t] {
            color: #a67f59
        }

        /* Literal.String.Single */
        c-[u] {
            color: #a67f59
        }

        /* Literal.String.Double */
        c-[cp] {
            color: #708090
        }

        /* Comment.Preproc */
        c-[c1] {
            color: #708090
        }

        /* Comment.Single */
        c-[cs] {
            color: #708090
        }

        /* Comment.Special */
        c-[kc] {
            color: #990055
        }

        /* Keyword.Constant */
        c-[kn] {
            color: #990055
        }

        /* Keyword.Namespace */
        c-[kp] {
            color: #990055
        }

        /* Keyword.Pseudo */
        c-[kr] {
            color: #990055
        }

        /* Keyword.Reserved */
        c-[ld] {
            color: #000000
        }

        /* Literal.Date */
        c-[nc] {
            color: #0077aa
        }

        /* Name.Class */
        c-[no] {
            color: #0077aa
        }

        /* Name.Constant */
        c-[nd] {
            color: #0077aa
        }

        /* Name.Decorator */
        c-[ni] {
            color: #0077aa
        }

        /* Name.Entity */
        c-[ne] {
            color: #0077aa
        }

        /* Name.Exception */
        c-[nf] {
            color: #0077aa
        }

        /* Name.Function */
        c-[nl] {
            color: #0077aa
        }

        /* Name.Label */
        c-[nn] {
            color: #0077aa
        }

        /* Name.Namespace */
        c-[py] {
            color: #0077aa
        }

        /* Name.Property */
        c-[ow] {
            color: #999999
        }

        /* Operator.Word */
        c-[mb] {
            color: #000000
        }

        /* Literal.Number.Bin */
        c-[mf] {
            color: #000000
        }

        /* Literal.Number.Float */
        c-[mh] {
            color: #000000
        }

        /* Literal.Number.Hex */
        c-[mi] {
            color: #000000
        }

        /* Literal.Number.Integer */
        c-[mo] {
            color: #000000
        }

        /* Literal.Number.Oct */
        c-[sb] {
            color: #a67f59
        }

        /* Literal.String.Backtick */
        c-[sc] {
            color: #a67f59
        }

        /* Literal.String.Char */
        c-[sd] {
            color: #a67f59
        }

        /* Literal.String.Doc */
        c-[se] {
            color: #a67f59
        }

        /* Literal.String.Escape */
        c-[sh] {
            color: #a67f59
        }

        /* Literal.String.Heredoc */
        c-[si] {
            color: #a67f59
        }

        /* Literal.String.Interpol */
        c-[sx] {
            color: #a67f59
        }

        /* Literal.String.Other */
        c-[sr] {
            color: #a67f59
        }

        /* Literal.String.Regex */
        c-[ss] {
            color: #a67f59
        }

        /* Literal.String.Symbol */
        c-[vc] {
            color: #0077aa
        }

        /* Name.Variable.Class */
        c-[vg] {
            color: #0077aa
        }

        /* Name.Variable.Global */
        c-[vi] {
            color: #0077aa
        }

        /* Name.Variable.Instance */
        c-[il] {
            color: #000000
        }

        /* Literal.Number.Integer.Long */

        @media (prefers-color-scheme: dark) {
            .highlight:not(.idl) {
                background: rgba(255, 255, 255, .05);
            }

            c-[a] {
                color: #d33682
            }

            /* Keyword.Declaration */
            c-[b] {
                color: #d33682
            }

            /* Keyword.Type */
            c-[c] {
                color: #2aa198
            }

            /* Comment */
            c-[d] {
                color: #2aa198
            }

            /* Comment.Multiline */
            c-[e] {
                color: #268bd2
            }

            /* Name.Attribute */
            c-[f] {
                color: #b58900
            }

            /* Name.Tag */
            c-[g] {
                color: #cb4b16
            }

            /* Name.Variable */
            c-[k] {
                color: #d33682
            }

            /* Keyword */
            c-[l] {
                color: #657b83
            }

            /* Literal */
            c-[m] {
                color: #657b83
            }

            /* Literal.Number */
            c-[n] {
                color: #268bd2
            }

            /* Name */
            c-[o] {
                color: #657b83
            }

            /* Operator */
            c-[p] {
                color: #657b83
            }

            /* Punctuation */
            c-[s] {
                color: #6c71c4
            }

            /* Literal.String */
            c-[t] {
                color: #6c71c4
            }

            /* Literal.String.Single */
            c-[u] {
                color: #6c71c4
            }

            /* Literal.String.Double */
            c-[ch] {
                color: #2aa198
            }

            /* Comment.Hashbang */
            c-[cp] {
                color: #2aa198
            }

            /* Comment.Preproc */
            c-[cpf] {
                color: #2aa198
            }

            /* Comment.PreprocFile */
            c-[c1] {
                color: #2aa198
            }

            /* Comment.Single */
            c-[cs] {
                color: #2aa198
            }

            /* Comment.Special */
            c-[kc] {
                color: #d33682
            }

            /* Keyword.Constant */
            c-[kn] {
                color: #d33682
            }

            /* Keyword.Namespace */
            c-[kp] {
                color: #d33682
            }

            /* Keyword.Pseudo */
            c-[kr] {
                color: #d33682
            }

            /* Keyword.Reserved */
            c-[ld] {
                color: #657b83
            }

            /* Literal.Date */
            c-[nc] {
                color: #268bd2
            }

            /* Name.Class */
            c-[no] {
                color: #268bd2
            }

            /* Name.Constant */
            c-[nd] {
                color: #268bd2
            }

            /* Name.Decorator */
            c-[ni] {
                color: #268bd2
            }

            /* Name.Entity */
            c-[ne] {
                color: #268bd2
            }

            /* Name.Exception */
            c-[nf] {
                color: #268bd2
            }

            /* Name.Function */
            c-[nl] {
                color: #268bd2
            }

            /* Name.Label */
            c-[nn] {
                color: #268bd2
            }

            /* Name.Namespace */
            c-[py] {
                color: #268bd2
            }

            /* Name.Property */
            c-[ow] {
                color: #657b83
            }

            /* Operator.Word */
            c-[mb] {
                color: #657b83
            }

            /* Literal.Number.Bin */
            c-[mf] {
                color: #657b83
            }

            /* Literal.Number.Float */
            c-[mh] {
                color: #657b83
            }

            /* Literal.Number.Hex */
            c-[mi] {
                color: #657b83
            }

            /* Literal.Number.Integer */
            c-[mo] {
                color: #657b83
            }

            /* Literal.Number.Oct */
            c-[sa] {
                color: #6c71c4
            }

            /* Literal.String.Affix */
            c-[sb] {
                color: #6c71c4
            }

            /* Literal.String.Backtick */
            c-[sc] {
                color: #6c71c4
            }

            /* Literal.String.Char */
            c-[dl] {
                color: #6c71c4
            }

            /* Literal.String.Delimiter */
            c-[sd] {
                color: #6c71c4
            }

            /* Literal.String.Doc */
            c-[se] {
                color: #6c71c4
            }

            /* Literal.String.Escape */
            c-[sh] {
                color: #6c71c4
            }

            /* Literal.String.Heredoc */
            c-[si] {
                color: #6c71c4
            }

            /* Literal.String.Interpol */
            c-[sx] {
                color: #6c71c4
            }

            /* Literal.String.Other */
            c-[sr] {
                color: #6c71c4
            }

            /* Literal.String.Regex */
            c-[ss] {
                color: #6c71c4
            }

            /* Literal.String.Symbol */
            c-[fm] {
                color: #268bd2
            }

            /* Name.Function.Magic */
            c-[vc] {
                color: #cb4b16
            }

            /* Name.Variable.Class */
            c-[vg] {
                color: #cb4b16
            }

            /* Name.Variable.Global */
            c-[vi] {
                color: #cb4b16
            }

            /* Name.Variable.Instance */
            c-[vm] {
                color: #cb4b16
            }

            /* Name.Variable.Magic */
            c-[il] {
                color: #657b83
            }

            /* Literal.Number.Integer.Long */
        }
    </style>
    <style>
        /* Boilerplate: style-wpt */
        :root {
            --wpt-border: hsl(0, 0%, 60%);
            --wpt-bg: hsl(0, 0%, 95%);
            --wpt-text: var(--text);
            --wptheading-text: hsl(0, 0%, 30%);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --wpt-border: hsl(0, 0%, 30%);
                --wpt-bg: var(--borderedblock-bg);
                --wpt-text: var(--text);
                --wptheading-text: hsl(0, 0%, 60%);
            }
        }

        .wpt-tests-block {
            list-style: none;
            border-left: .5em solid var(--wpt-border);
            background: var(--wpt-bg);
            color: var(--wpt-text);
            margin: 1em auto;
            padding: .5em;
        }

        .wpt-tests-block summary {
            color: var(--wptheading-text);
            font-weight: normal;
            text-transform: uppercase;
        }

        .wpt-tests-block summary::marker {
            color: var(--wpt-border);
        }

        .wpt-tests-block summary:hover::marker {
            color: var(--wpt-text);
        }

        /*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
        .wpt-tests-block:not([open]) {
            padding: 0;
            border: none;
            background: none;
            font-size: 0.75em;
            line-height: 1;
            position: relative;
            margin: 1em 0 0;
        }

        .wpt-tests-block:not([open]) summary {
            position: absolute;
            right: 0;
            bottom: 0;
        }

        /*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
        .wpt-tests-block:not([open]):last-child {
            padding-bottom: 1px;
            margin-bottom: -1px;
        }

        /*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
        li:not(:last-child)>.wpt-tests-block:not([open]):last-child,
        dd:not(:last-child)>.wpt-tests-block:not([open]):last-child {
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .wpt-tests-block:not([open]):not(:hover) {
            opacity: 0.5;
        }

        .wpt-tests-list {
            list-style: none;
            display: grid;
            margin: 0;
            padding: 0;
            grid-template-columns: 1fr max-content auto auto;
            grid-column-gap: .5em;
        }

        .wpt-tests-block hr:last-child {
            display: none;
        }

        .wpt-test {
            display: contents;
        }

        .wpt-test>a {
            text-decoration: underline;
            border: none;
        }

        .wpt-test>.wpt-name {
            grid-column: 1;
        }

        .wpt-test>.wpt-results {
            grid-column: 2;
        }

        .wpt-test>.wpt-live {
            grid-column: 3;
        }

        .wpt-test>.wpt-source {
            grid-column: 4;
        }

        .wpt-test>.wpt-results {
            display: flex;
            gap: .1em;
        }

        .wpt-test .wpt-result {
            display: inline-block;
            height: 1em;
            width: 1em;
            border-radius: 50%;
            position: relative;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">
    <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet"
        type="text/css">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">CSS カラー HDR モジュール レベル 1</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types/#FPWD">W3C 最初の公開作業草案</a>、<time class="dt-updated"
                datetime="2024-12-17">2024年12月17日</time></p>
        <details open>
            <summary>この文書の詳細</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>このバージョン:
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2024/WD-css-color-hdr-1-20241217/">https://www.w3.org/TR/2024/WD-css-color-hdr-1-20241217/</a>
                    <dt>最新公開バージョン:
                    <dd><a href="https://www.w3.org/TR/css-color-hdr-1/">https://www.w3.org/TR/css-color-hdr-1/</a>
                    <dt>編集者ドラフト:
                    <dd><a
                            href="https://drafts.csswg.org/css-color-hdr-1/">https://drafts.csswg.org/css-color-hdr-1/</a>
                    <dt>履歴:
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/css-color-hdr-1/">https://www.w3.org/standards/history/css-color-hdr-1/</a>
                    <dt>フィードバック:
                    <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-color-hdr-1">CSSWG イシューレポジトリ</a>
                    <dd><a href="#issues-index">仕様内インライン</a>
                    <dt class="editor">編集者:
                    <dd class="editor p-author h-card vcard" data-editor-id="1438"><a class="p-name fn u-url url"
                            href="https://svgees.us/">Chris Lilley</a> (<span class="p-org org">W3C</span>)
                    <dt>この仕様への編集提案:
                    <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/css-color-hdr-1/Overview.bs">GitHub
                            エディター</a>
                    <dt>テストスイート:
                    <dd class="wpt-overview"><a
                            href="https://wpt.fyi/results/css/css-color-hdr/">https://wpt.fyi/results/css/css-color-hdr/</a>
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> ©
            2024 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr
                title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a
                href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/copyright/software-license/" rel="license"
                title="W3C Software and Document License">permissive document license</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">概要</span></h2>
        <p>このモジュールは、CSS Color 4 にハイダイナミックレンジ (HDR) を可能にする追加機能を定義します。</p>
        <a href="https://www.w3.org/TR/CSS/">CSS</a> は、構造化文書（HTMLやXMLなど）の表示を画面や紙などで記述するための言語です。
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">この文書の位置付け</span></h2>
    <div data-fill-with="status">
        <p><em>このセクションは、本書が公開された時点での文書のステータスを説明します。
                現在のW3C出版物の一覧
                およびこの技術レポートの最新版は、<a href="https://www.w3.org/TR/">W3C 技術レポート索引 https://www.w3.org/TR/</a>
                に掲載されています。</em> </p>
        <p> この文書は
            <a href="https://www.w3.org/groups/wg/css">CSSワーキンググループ</a> によって <strong>最初の公開作業草案</strong> として、
            <a href="https://www.w3.org/policies/process/20231103/#recs-and-notes">勧告プロセス</a> に従って発行されました。
            最初の公開作業草案としての公開は、
            <abbr title="World Wide Web Consortium">W3C</abbr> およびそのメンバーによる支持を意味するものではありません。
        </p>
        <p> この文書は草案であり、
            いつでも他の文書によって更新、差し替え、または廃止される場合があります。
            進行中の作業以外の目的で本書を引用することは適切ではありません。 </p>
        <p>ご意見は
            <a href="https://github.com/w3c/csswg-drafts/issues">GitHubでイシューを登録</a>（推奨）してお送りください。
            その際、タイトルに仕様コード「css-color-hdr」を含めてください。例: “[css-color-hdr] <i>…コメント要約…</i>”。
            すべてのイシューおよびコメントは<a href="https://lists.w3.org/Archives/Public/public-css-archive/">アーカイブ</a>されています。
            あるいは、(<a href="https://lists.w3.org/Archives/Public/www-style/">アーカイブあり</a>) 公開メーリングリスト <a
                href="mailto:www-style@w3.org?Subject=%5Bcss-color-hdr%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>
            へご送信いただくこともできます。
        </p>
        <p>この文書は <a href="https://www.w3.org/policies/process/20231103/" id="w3c_process_revision">2023年11月3日
                W3Cプロセス文書</a> に従って管理されています。</p>
        <p>この文書は <a href="https://www.w3.org/policies/patent-policy/20200915/">W3C特許ポリシー</a> の下で活動するグループによって作成されました。
            W3Cは、グループの成果物に関連してなされた<a href="https://www.w3.org/groups/wg/css/ipr"
                rel="disclosure">特許開示の公開リスト</a>を管理しています。
            また、そのページには特許開示の方法についても記載されています。
            特許の存在を実際に知っている個人は、
            それが <a href="https://www.w3.org/policies/patent-policy/20200915/#def-essential">必須請求項</a> を含むと信じる場合、
            <a href="https://www.w3.org/policies/patent-policy/20200915/#sec-Disclosure">W3C特許ポリシー第6節</a>
            に従ってその情報を開示しなければなりません。
        </p>
        <p></p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目次</h2>
        <ol class="toc" role="directory">
            <li>
                <a href="#intro"><span class="secno">1</span> <span class="content">はじめに</span></a>
                <ol class="toc">
                    <li><a href="#values"><span class="secno">1.1</span> <span class="content">値の定義</span></a>
                </ol>
            <li>
                <a href="#controlling-dynamic-range"><span class="secno">2</span> <span
                        class="content">ダイナミックレンジの制御</span></a>
                <ol class="toc">
                    <li><a href="#defining-dynamic-range"><span class="secno">2.1</span> <span
                                class="content">ダイナミックレンジの定義</span></a>
                    <li><a href="#introducing-headroom"><span class="secno">2.2</span> <span
                                class="content">ヘッドルームの導入</span></a>
                    <li><a href="#the-dynamic-range-limit-property"><span class="secno">2.3</span> <span
                                class="content"><span class="property">dynamic-range-limit</span> プロパティ</span></a>
                    <li><a href="#dynamic-range-limit-mix"><span class="secno">2.4</span> <span
                                class="content">ダイナミックレンジ制限の合成: <span
                                    class="css">dynamic-range-limit-mix()</span>関数</span></a>
                    <li><a href="#computing-dynamic-range-limit"><span class="secno">2.5</span> <span
                                class="content"><span class="property">dynamic-range-limit</span> の算出値</span></a>
                </ol>
            <li><a href="#color-function"><span class="secno">3</span> <span class="content">定義済みおよびカスタム色空間の指定: <span
                            class="css">color()</span> 関数</span></a>
            <li>
                <a href="#predefined-HDR"><span class="secno">4</span> <span class="content">HDR用定義済み色空間:</span></a>
                <ol class="toc">
                    <li><a href="#valdef-color-rec2100-pq"><span class="secno">4.1</span> <span
                                class="content"><span>rec2100-pq</span></span></a>
                    <li><a href="#valdef-color-rec2100-hlg"><span class="secno">4.2</span> <span
                                class="content"><span>rec2100-hlg</span></span></a>
                    <li><a href="#valdef-color-rec2100-linear"><span class="secno">4.3</span> <span
                                class="content"><span>rec2100-linear</span></span></a>
                    <li><a href="#Jzazbz"><span class="secno">4.4</span> <span
                                class="content"><span>Jzazbz</span></span></a>
                    <li>
                        <a href="#JzCzHz"><span class="secno">4.5</span> <span
                                class="content"><span>JzCzHz</span></span></a>
                        <ol class="toc">
                            <li><a href="#Jzazbz-to-JzCzHz"><span class="secno">4.5.1</span> <span class="content"><span
                                            class="css">Jzazbz</span> 色を <span class="css">JzCzHz</span>
                                        色へ変換</span></a>
                            <li><a href="#JzCzHz-to-Jzazbz"><span class="secno">4.5.2</span> <span
                                        class="content">JzCzHz 色を Jzazbz 色へ変換</span></a>
                        </ol>
                    <li><a href="#ICtCp"><span class="secno">4.6</span> <span
                                class="content"><span>ICtCp</span></span></a>
                </ol>
            <li><a href="#Compositing-SDR-HDR"><span class="secno">5</span> <span
                        class="content">SDRとHDRコンテンツの合成</span></a>
            <li>
                <a href="#serializing-color-values"><span class="secno">6</span> <span class="content"><span
                            class="production">&lt;color></span> 値のシリアライズ</span></a>
                <ol class="toc">
                    <li><a href="#serializing-color-function-values"><span class="secno">6.1</span> <span
                                class="content"><span class="css">color()</span> 関数の値のシリアライズ</span></a>
                </ol>
            <li><a href="#privacy"><span class="secno"></span> <span class="content">プライバシーに関する考慮事項</span></a>
            <li><a href="#security"><span class="secno"></span> <span class="content">セキュリティに関する考慮事項</span></a>
            <li><a href="#a11y"><span class="secno"></span> <span class="content">アクセシビリティに関する考慮事項</span></a>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content">適合性</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">文書上の規約</span></a>
                    <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span
                                class="content">適合クラス</span></a>
                    <li>
                        <a href="#w3c-partial"><span class="secno"></span> <span class="content">部分実装</span></a>
                        <ol class="toc">
                            <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span
                                        class="content">不安定および独自機能の実装</span></a>
                        </ol>
                    <li><a href="#w3c-testing"><span class="secno"></span> <span class="content">非実験的実装</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本仕様で定義されている用語</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">参照によって定義された用語</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">規範的参考文献</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">参考情報</span></a>
                </ol>
            <li><a href="#property-index"><span class="secno"></span> <span class="content">プロパティ索引</span></a>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">課題索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span
                class="content">はじめに</span><a class="self-link" href="#intro"></a></h2>
        <p><em>このセクションは規範的ではありません。</em></p>
        <p>CSS Color 4 は、オープンウェブプラットフォームにワイドカラーガマット（WCG）色空間を追加します。
            設計上、これらはすべて標準ダイナミックレンジ（SDR）色空間です。
            本仕様書は、ハイダイナミックレンジ（HDR）をサポートするための追加事項を定義します。</p>
        <figure id="fig-eotf">
            <p><img alt height="803" src="https://www.w3.org/TR/css-color-hdr-1/images/lin-srgb-hlg-pq.png" width="839">
            </p>
            <figcaption> 4つの色空間のエレクトロオプティカルトランスファ関数（EOTF）:
                拡張sRGBおよび線形光sRGB
                （CSS Color 4で定義）と、
                本仕様で定義されるパーセプチュアルクアンタイザー（PQ）およびハイブリッドログガンマ（HLG）。
                出典: <a data-link-type="biblio" href="#biblio-rec_bt2100"
                    title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            </figcaption>
        </figure>
        <p>WCG仕様は数十年にわたり広く安定していますが、
            HDR規格はまだ成熟しておらず、
            この10年で頻繁に改訂されています。</p>
        <h3 class="heading settled" data-level="1.1" id="values"><span class="secno">1.1. </span><span
                class="content">値の定義</span><a class="self-link" href="#values"></a></h3>
        <p>この仕様は、<a href="https://www.w3.org/TR/CSS2/about.html#property-defs">CSSプロパティ定義の規約</a>を
            <a data-link-type="biblio" href="#biblio-css2"
                title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> から継承し、
            <a href="https://www.w3.org/TR/css-values-3/#value-defs">値定義構文</a>を
            <a data-link-type="biblio" href="#biblio-css-values-3"
                title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</a> から使用しています。
            本仕様で定義されていない値型は、CSS Values &amp; Units <span
                title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</span>で定義されています。
            他のCSSモジュールとの組み合わせにより、これらの値型の定義が拡張される場合があります。
        </p>
        <p>各プロパティ定義にリストされたプロパティ固有の値に加えて、
            本仕様で定義されるすべてのプロパティは
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-values-4/#css-wide-keywords"
                id="ref-for-css-wide-keywords">CSS全体キーワード</a> もプロパティ値として受け入れます。
            可読性のため、明示的な繰り返しはしていません。
        </p>
        <h2 class="heading settled" data-level="2" id="controlling-dynamic-range"><span class="secno">2. </span><span
                class="content">ダイナミックレンジの制御</span><a class="self-link" href="#controlling-dynamic-range"></a></h2>
        <h3 class="heading settled" data-level="2.1" id="defining-dynamic-range"><span class="secno">2.1. </span><span
                class="content">ダイナミックレンジの定義</span><a class="self-link" href="#defining-dynamic-range"></a>
        </h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="dynamic-range">ダイナミックレンジ</dfn>は、
            <a data-link-type="dfn" href="https://drafts.csswg.org/css-color-4/#luminance"
                id="ref-for-luminance">輝度</a>の
            <em>最も明るい</em>色と<em>最も暗い</em>色の差です。
            ダイナミックレンジは写真用語の<em>ストップ</em>で測定されます。
            1ストップは輝度が2倍になることを意味します。
        </p>
        <pre class="lang-js highlight"><c- a>function</c-> DynamicRange <c- p>(</c->high<c- p>,</c-> low<c- p>)</c-> <c- p>{</c->
  <c- k>return</c-> Math<c- p>.</c->log2<c- p>(</c->high<c- p>)</c-> <c- o>-</c-> Math<c- p>.</c->log2<c- p>(</c->low<c- p>);</c->
  <c- p>}</c-> 
</pre>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="standard-dynamic-range">標準ダイナミックレンジ</dfn>（SDR）では、
            メディアホワイト（通常の白い背景色や、暗い背景の上の白いテキストの色）が
            最も明るい色となります。</p>
        <div class="example" id="ex-SDR-dynamic-range"><a class="self-link" href="#ex-SDR-dynamic-range"></a> たとえば、<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#sRGB-space"
                id="ref-for-sRGB-space">sRGB</a>の場合、
            白は輝度80cd/m²、
            黒は輝度0.2cd/m²と定義されています。
            したがって、ダイナミックレンジは8.6ストップとなります。 </div>
        <p>SDRでは、<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-4/#luminance"
                id="ref-for-luminance①">輝度</a>はメディアホワイトに<em>相対的</em>に扱われます。
            画面を明るくしてもダイナミックレンジは変わりません、
            なぜなら最も暗い色も同様に明るくなるためです。</p>
        <div class="example" id="ex-SDR-brighter-dynamic-range"><a class="self-link"
                href="#ex-SDR-brighter-dynamic-range"></a> たとえば、ある<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-color-4/#sRGB-space" id="ref-for-sRGB-space①">sRGB</a>ディスプレイが、
            白を160cd/m²に設定し、
            最も暗い黒が0.4cd/m²となる場合でも、
            ダイナミックレンジは依然として8.6ストップです。 </div>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="high-dynamic-range">ハイダイナミックレンジ</dfn>（HDR）では、
            メディアホワイトよりも明るい色を表示できます。
            たとえば、HDRディスプレイでメディアホワイトを約200cd/m²に設定した場合、
            ハイライトを1000cd/m²で表示できることがあります。
            通常、最も明るい色は
            ディスプレイの一部のみ、かつ限られた時間だけ表示可能です。
            これは電力消費や発熱の観点によるものです。</p>
        <div class="example" id="ex-HDR-dynamic-range"><a class="self-link" href="#ex-HDR-dynamic-range"></a>
            たとえば、HDRリファレンスマスタリングディスプレイでは、
            小面積ピークホワイトが輝度1000cd/m²、
            最も暗い黒が0.05cd/m²となります。
            したがって、ダイナミックレンジは14.3ストップとなります。 </div>
        <p>HDRでは、<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-4/#luminance"
                id="ref-for-luminance②">輝度</a>は<em>絶対値</em>として扱われ、
            メディアホワイトに対する相対値ではありません。
            より明るい画面を使うことでダイナミックレンジが広がり、
            メディアホワイトの輝度は一定となります。</p>
        <div class="example" id="ex-HDR-PQ-dynamic-range"><a class="self-link" href="#ex-HDR-PQ-dynamic-range"></a>
            たとえば、<a class="css">rec2100-pq</a>色空間
            （<a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>で定義）
            では、最も明るいピークホワイトが輝度10000cd/m²、
            最も暗い黒が0.001cd/m²と定義されています。
            したがって、エンコードされたダイナミックレンジは23.3ストップです。 </div>
        <h3 class="heading settled" data-level="2.2" id="introducing-headroom"><span class="secno">2.2. </span><span
                class="content">ヘッドルームの導入</span><a class="self-link" href="#introducing-headroom"></a></h3>
        <p><em>このセクションは非規範的です。</em></p>
        <p>HDRディスプレイが出せる輝度レベルは
            大きく異なります。</p>
        <p>ピークホワイトがメディアホワイトよりどれだけ高いかは
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="hdr-headroom">HDRヘッドルーム</dfn>と呼ばれ、
            メディアホワイトのレベル、
            ユーザーの好み、
            視聴環境によって決まります。
        </p>
        <p>これは一般的に写真用語の<strong>ストップ</strong>で表現されます。
            したがって、<a data-link-type="dfn" href="#standard-dynamic-range"
                id="ref-for-standard-dynamic-range">標準ダイナミックレンジ</a>（SDR）は
            定義上<a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom">HDRヘッドルーム</a>が0ストップであり、
            最も明るい白がメディアホワイトであることを意味します。</p>
        <div class="example" id="ex-low-headroom"><a class="self-link" href="#ex-low-headroom"></a> たとえば、
            <a href="https://displayhdr.org/">DisplayHDR 400</a>（VESA認証DisplayHDRの最下位グレード<a data-link-type="biblio"
                href="#biblio-displayhdr" title="Summary of DisplayHDR Specs under CTS 1.2">[DisplayHDR]</a>）の要件を満たす
            低価格帯のHDRディスプレイは、
            メディアホワイトを最大200cd/m<sup>2</sup>、
            ピークホワイトは400cd/m<sup>2</sup>まで表示できます（最も明るいメディアホワイトでHDRヘッドルームは1ストップ）。
        </div>
        <div class="example" id="ex-high-headroom">
            <a class="self-link" href="#ex-high-headroom"></a> たとえば、
            <a href="https://displayhdr.org/">DisplayHDR 1400</a>（現時点で最上位グレード）の要件を超える
            高価格帯のHDRディスプレイは、
            メディアホワイトを最大400cd/m<sup>2</sup>、
            ピークホワイトを1600cd/m<sup>2</sup>で表示できます。
            <p>暗い視聴環境で
                メディアホワイトを100cd/m<sup>2</sup>に設定した場合、
                4ストップ（16倍）のHDRヘッドルームが得られます。</p>
        </div>
        <p id="headroom-privacy"> Webプラットフォームは現在、
            ディスプレイのヘッドルームレベルを直接公開していません。
            これは視聴環境に依存し、
            リアルタイムの非量子化ヘッドルーム情報が
            トラッキングベクターとなるためです
            （たとえば、ユーザーが屋外に移動し、晴れている日だと検出できるなど）。 </p>
        <p id="constrained-headroom"> 常に利用可能なHDRヘッドルームの最大値を
            使用することが望ましいとは限りません。
            CSSは、どの程度のヘッドルームを使用するかを
            大まかに制御する方法を提供します。
            このレベルは要素ごと、または時間ごとに
            変化させることができます。 </p>
        <div class="example" id="ex-photo-grid"><a class="self-link" href="#ex-photo-grid"></a> たとえば、
            写真グリッドを表示するWebページを考えてみましょう。
            いくつかの写真はHDRで、太陽に直射したような
            非常にダイナミックレンジの高い画像も含まれます。
            写真群を常にフルダイナミックレンジで見るのは疲れるでしょう。
            かといって、すべてをSDRレンジに圧縮すると
            各写真の個性を十分に表現できません。
            デザイン上の目標は、「十分な」HDRを見せて
            写真群の比較や評価ができるようにすることです。 </div>
        <h3 class="heading settled" data-level="2.3" id="the-dynamic-range-limit-property"><span class="secno">2.3.
            </span><span class="content"><a class="property css" data-link-type="property"
                    href="#propdef-dynamic-range-limit" id="ref-for-propdef-dynamic-range-limit">dynamic-range-limit</a>
                プロパティ</span><a class="self-link" href="#the-dynamic-range-limit-property"></a></h3>
        <table class="def propdef" data-link-for-hint="dynamic-range-limit">
            <tbody>
                <tr>
                    <th>名称:
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-dynamic-range-limit">dynamic-range-limit</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">値:</a>
                    <td class="prod">standard <a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one">|</a> high <span
                            id="ref-for-comb-one①">|</span> constrained-high <span id="ref-for-comb-one②">|</span> <a
                            class="production css" data-link-type="function" href="#funcdef-dynamic-range-limit-mix"
                            id="ref-for-funcdef-dynamic-range-limit-mix">&lt;dynamic-range-limit-mix()></a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">初期値:</a>
                    <td>high
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">適用対象:</a>
                    <td><a href="https://www.w3.org/TR/css-pseudo/#generated-content"
                            title="Includes ::before and ::after pseudo-elements.">すべての要素</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">継承:</a>
                    <td>yes
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">パーセンテージ:</a>
                    <td>n/a
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">算出値:</a>
                    <td><a href="#computing-dynamic-range-limit">dynamic-range-limitの算出値</a>を参照
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">正規順序:</a>
                    <td>文法通り
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">アニメーション型:</a>
                    <td><a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                            id="ref-for-funcdef-dynamic-range-limit-mix①">dynamic-range-limit-mix()</a>による
        </table>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>テスト</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/inheritance.html"
                        title="css/css-color-hdr/inheritance.html">inheritance.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/inheritance.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/inheritance.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/interpolation.html"
                        title="css/css-color-hdr/interpolation.html">interpolation.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/interpolation.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/interpolation.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/parsing.html"
                        title="css/css-color-hdr/parsing.html">parsing.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/parsing.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/parsing.html"><small>(ソース)</small></a>
            </ul>
        </details>
        <dl>
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-standard">standard</dfn>
            <dd> 表示される最も高い輝度の色は
                メディアホワイトと同じ、すなわちCSS色<a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white">white</a>です。
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-high">high</dfn>
            <dd> 表示されるピーク輝度は
                メディアホワイトよりはるかに高くなります。すなわちCSS色<a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white①">white</a>よりも明るいですが、
                正確なレベルは規定されていません。
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-constrained-high">constrained-high</dfn>
            <dd> 表示されるピーク輝度は
                メディアホワイトよりやや高い程度です。すなわちCSS色<a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white②">white</a>より明るいですが、
                SDRとHDRコンテンツを一緒に快適に表示できるレベルとします。
        </dl>
        <div class="example" id="ex-hdr-limit-photogrid">
            <a class="self-link" href="#ex-hdr-limit-photogrid"></a>
            <pre class="lang-css highlight">body <c- p>{</c-> <c- k>dynamic-range-limit</c-><c- p>:</c-> standard<c- p>;</c-> <c- p>}</c->
div.photogrid img <c- p>{</c-> <c- k>dynamic-range-limit</c-><c- p>:</c-> constrained-high <c- p>}</c->
</pre>
        </div>
        <h3 class="heading settled" data-level="2.4" id="dynamic-range-limit-mix"><span class="secno">2.4. </span><span
                class="content">ダイナミックレンジ制限の合成: <a class="css" data-link-type="maybe"
                    href="#funcdef-dynamic-range-limit-mix"
                    id="ref-for-funcdef-dynamic-range-limit-mix②">dynamic-range-limit-mix()</a>関数</span><a
                class="self-link" href="#dynamic-range-limit-mix"></a></h3>
        <p>この関数は2つの<a class="property css" data-link-type="property" href="#propdef-dynamic-range-limit"
                id="ref-for-propdef-dynamic-range-limit①">dynamic-range-limit</a>値を受け取り、
            内部的にメディアホワイトを超えるストップ数に変換した上で、
            指定された割合で合成し、その結果を表示に反映します。
            実際の計算結果は公開されません。</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-dynamic-range-limit-mix">dynamic-range-limit-mix()</dfn> = dynamic-range-limit-mix( [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#typedef-ident" id="ref-for-typedef-ident">&lt;ident></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-all" id="ref-for-comb-all">&amp;&amp;</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value">&lt;percentage [0,100]></a> ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-comma" id="ref-for-mult-comma">#</a>)
</pre>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>テスト</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/inheritance.html"
                        title="css/css-color-hdr/inheritance.html">inheritance.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/inheritance.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/inheritance.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/interpolation.html"
                        title="css/css-color-hdr/interpolation.html">interpolation.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/interpolation.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/interpolation.html"><small>(ソース)</small></a>
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/parsing.html"
                        title="css/css-color-hdr/parsing.html">parsing.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/parsing.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/parsing.html"><small>(ソース)</small></a>
            </ul>
        </details>
        <p>すべてのパーセンテージの合計が0%の場合、この関数は無効です。</p>
        <h3 class="heading settled" data-level="2.5" id="computing-dynamic-range-limit"><span class="secno">2.5.
            </span><span class="content"><a class="property css" data-link-type="property"
                    href="#propdef-dynamic-range-limit"
                    id="ref-for-propdef-dynamic-range-limit②">dynamic-range-limit</a>の算出値</span><a class="self-link"
                href="#computing-dynamic-range-limit"></a></h3>
        <p>指定値が<a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                id="ref-for-valdef-dynamic-range-limit-standard">standard</a>、<a class="css" data-link-type="maybe"
                href="#valdef-dynamic-range-limit-constrained-high"
                id="ref-for-valdef-dynamic-range-limit-constrained-high">constrained-high</a>、または<a class="css"
                data-link-type="maybe" href="#valdef-dynamic-range-limit-high"
                id="ref-for-valdef-dynamic-range-limit-high">high</a>のいずれかの場合、算出値はその指定値です。
        </p>
        <p>指定値が<a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                id="ref-for-funcdef-dynamic-range-limit-mix③">dynamic-range-limit-mix()</a>の場合、算出値は次のアルゴリズムで決定されます:</p>
        <ol>
            <li data-md>
                <p><var>v1</var>, ..., <var>vN</var>を混合するパラメータの算出値とします。</p>
            <li data-md>
                <p><var>p1</var>, ..., <var>pN</var>をパーセンテージ（合計100%に正規化）とします。</p>
            <li data-md>
                <p>寄与率を以下のように定義します:</p>
                <ul>
                    <li data-md>
                        <p><var>p1_standard</var>,...,<var>pN_standard</var>を
                            <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                                id="ref-for-valdef-dynamic-range-limit-standard①">standard</a>の割合とします（
                            <var>v1</var>,...,<var>vN</var>内）。
                        </p>
                    <li data-md>
                        <p><var>p1_constrained_high</var>,...,<var>pN_constrained_high</var>を
                            <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-constrained-high"
                                id="ref-for-valdef-dynamic-range-limit-constrained-high①">constrained-high</a>の割合とします（
                            <var>v1</var>,...,<var>vN</var>内）。
                        </p>
                    <li data-md>
                        <p><var>p1_high</var>,...,<var>pN_high</var>を
                            <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-high"
                                id="ref-for-valdef-dynamic-range-limit-high①">high</a>の割合とします（
                            <var>v1</var>,...,<var>vN</var>内）。
                        </p>
                </ul>
            <li data-md>
                <p>加重合計を次のように計算します:</p>
                <ul>
                    <li data-md>
                        <p><var>p_standard</var>=(<var>p1_standard</var>*<var>p1</var>+...+<var>pN_standard</var>*<var>pN</var>)/100
                        </p>
                    <li data-md>
                        <p><var>p_constrained_high</var>=(<var>p1_constrained_high</var>*<var>p1</var>+...+<var>pN_constrained_high</var>*<var>pN</var>)/100
                        </p>
                    <li data-md>
                        <p><var>p_high</var>=(<var>p1_high</var>*<var>p1</var>+...+<var>pN_high</var>*<var>pN</var>)/100
                        </p>
                </ul>
            <li data-md>
                <p><var>p_standard</var>、<var>p_constrained_high</var>、<var>p_high</var>のいずれかが100%であれば、
                    算出値はそれぞれ<a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                        id="ref-for-valdef-dynamic-range-limit-standard②">standard</a>、
                    <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-constrained-high"
                        id="ref-for-valdef-dynamic-range-limit-constrained-high②">constrained-high</a>、
                    <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-high"
                        id="ref-for-valdef-dynamic-range-limit-high②">high</a>となります。
                </p>
            <li data-md>
                <p>それ以外の場合、算出値は<a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                        id="ref-for-funcdef-dynamic-range-limit-mix④">dynamic-range-limit-mix()</a>となり、
                    パラメータは<a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                        id="ref-for-valdef-dynamic-range-limit-standard③">standard</a>、
                    <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-constrained-high"
                        id="ref-for-valdef-dynamic-range-limit-constrained-high③">constrained-high</a>、
                    <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-high"
                        id="ref-for-valdef-dynamic-range-limit-high③">high</a>（この順）で、
                    パーセンテージは<var>p_standard</var>、<var>p_constrained_high</var>、<var>p_high</var>とし、
                    0%のパラメータは省略します。
                </p>
        </ol>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>テスト</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(ライブテスト)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(ソース)</small></a>
            </ul>
        </details>
        <div class="example" id="ex-hdr-limit-mix">
            <a class="self-link" href="#ex-hdr-limit-mix"></a>
            <pre class="lang-css highlight"><c- nf>dynamic-range-limit-mix</c-><c- p>(</c->
    high <c- m>10</c-><c- k>%</c-><c- p>,</c->
    <c- nf>dynamic-range-limit-mix</c-><c- p>(</c->standard <c- m>25</c-><c- k>%</c-><c- p>,</c-> constrained-high <c- m>75</c-><c- k>%</c-><c- p>)</c-> <c- m>20</c-><c- k>%</c-><c- p>,</c->
    <c- nf>dynamic-range-limit-mix</c-><c- p>(</c->constrained-high <c- m>10</c-><c- k>%</c-><c- p>,</c-> high <c- m>30</c-><c- k>%</c-><c- p>)</c-> <c- m>20</c-><c- k>%</c-><c- p>)</c->
</pre>
            <p>の算出値は</p>
            <pre class="lang-css highlight"><c- nf>dynamic-range-limit-mix</c-><c- p>(</c->standard <c- m>10</c-><c- k>%</c-><c- p>,</c-> constrained-high <c- m>40</c-><c- k>%</c-><c- p>,</c-> high <c- m>50</c-><c- k>%</c-><c- p>)</c->
</pre>
        </div>
        <h2 class="heading settled" data-level="3" id="color-function"><span class="secno">3. </span><span
                class="content"> 定義済みおよびカスタム色空間の指定: <a class="css" data-link-type="maybe" href="#funcdef-color"
                    id="ref-for-funcdef-color">color()</a> 関数
            </span><a class="self-link" href="#color-function"></a></h2>
        <p><a class="css" data-link-type="maybe" href="#funcdef-color" id="ref-for-funcdef-color①">color()</a>関数は、
            特定の<a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#color-space"
                id="ref-for-color-space">色空間</a>で色を指定できるようにします（他の多くの色関数が動作するデフォルトのsRGB色空間ではなく）。</p>
        <p>本仕様では、<a class="css" data-link-type="maybe" href="#funcdef-color"
                id="ref-for-funcdef-color②">color()</a>関数が拡張され、
            <a href="#predefined-HDR">HDR用の定義済み色空間</a>が指定できるようになりました。
            これは、<a href="https://www.w3.org/TR/css-color-4/#predefined"><cite>CSS Color 4</cite> §  10.
                定義済み色空間</a>で定義されたSDR用の定義済み空間や、
            <a href="https://www.w3.org/TR/css-color-5/#relative-colors"><cite>CSS Color 5</cite> § 4
                相対色構文</a>の相対色構文に加わるものです。
        </p>
        <p>構文は次の通りです:</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-color">color()</dfn> = color( [from <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color">&lt;color></a>]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt">?</a> <a class="production" data-link-type="type" href="#typedef-colorspace-params" id="ref-for-typedef-colorspace-params">&lt;colorspace-params></a> [ / [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" id="ref-for-typedef-color-alpha-value">&lt;alpha-value></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③">|</a> none ] ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt①">?</a> )
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-colorspace-params">&lt;colorspace-params></dfn> = [<a class="production" data-link-type="type" href="#typedef-custom-params" id="ref-for-typedef-custom-params">&lt;custom-params></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④">|</a> <a class="production" data-link-type="type" href="#typedef-predefined-rgb-params" id="ref-for-typedef-predefined-rgb-params">&lt;predefined-rgb-params></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑤">|</a> 
  <a class="production" data-link-type="type" href="#typedef-predefined-polar-params" id="ref-for-typedef-predefined-polar-params">&lt;predefined-polar-params></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑥">|</a> <a class="production" data-link-type="type" href="#typedef-predefined-rectangular-params" id="ref-for-typedef-predefined-rectangular-params">&lt;predefined-rectangular-params></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑦">|</a> <a class="production" data-link-type="type" href="#typedef-xyz-params" id="ref-for-typedef-xyz-params">&lt;xyz-params></a>]
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-custom-params">&lt;custom-params></dfn> = <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#typedef-dashed-ident" id="ref-for-typedef-dashed-ident">&lt;dashed-ident></a> [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑧">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value①">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑨">|</a> none ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-one-plus" id="ref-for-mult-one-plus">+</a>
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-rgb-params">&lt;predefined-rgb-params></dfn> = <a class="production" data-link-type="type" href="#typedef-predefined-rgb" id="ref-for-typedef-predefined-rgb">&lt;predefined-rgb></a> [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value①">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⓪">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value②">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①①">|</a> none ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-num" id="ref-for-mult-num">{3}</a>
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-polar-params">&lt;predefined-polar-params></dfn> = jzczhz [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value②">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①②">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value③">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①③">|</a> none ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-num" id="ref-for-mult-num①">{2}</a> [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-hue" id="ref-for-typedef-hue">&lt;hue></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①④">|</a> none]
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-rectangular-params">&lt;predefined-rectangular-params></dfn> = <a class="production" data-link-type="type" href="#typedef-predefined-rectangular" id="ref-for-typedef-predefined-rectangular">&lt;predefined-rectangular></a> [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value③">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑤">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value④">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑥">|</a> none ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-num" id="ref-for-mult-num②">{3}</a>
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-rgb">&lt;predefined-rgb></dfn> = srgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑦">|</a> srgb-linear <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑧">|</a> display-p3 <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑨">|</a> a98-rgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⓪">|</a> prophoto-rgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②①">|</a> rec2020 <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②②">|</a> 
  rec2100-pq <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②③">|</a> rec2100-hlg <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②④">|</a> rec2100-linear
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-rectangular">&lt;predefined-rectangular></dfn> = jzazbz <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑤">|</a> ictcp
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-xyz-params">&lt;xyz-params></dfn> = <a class="production" data-link-type="type" href="#typedef-xyz" id="ref-for-typedef-xyz">&lt;xyz></a> [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value④">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑥">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value⑤">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑦">|</a> none ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-num" id="ref-for-mult-num③">{3}</a>
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-xyz">&lt;xyz></dfn> = xyz <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑧">|</a> xyz-d50 <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑨">|</a> xyz-d65
</pre>
        <h2 class="heading settled" data-level="4" id="predefined-HDR"><span class="secno">4. </span><span
                class="content">HDR用定義済み色空間:</span><a class="self-link" href="#predefined-HDR"></a>
        </h2>
        <p><a href="https://drafts.csswg.org/css-color-4/#predefined">CSS Color
                4で定義されているSDR色空間</a>に加えて、下記のHDR色空間がcolor関数用に定義されています。</p>
        <p>これら新しい色空間の値のシリアライズは、<a href="https://www.w3.org/TR/css-color-4/#serializing-color-values"><cite>CSS Color
                    4</cite> §  15. 色値のシリアライズ</a>で説明されているものと同じです。</p>
        <h3 class="heading settled" data-level="4.1" id="valdef-color-rec2100-pq"><span class="secno">4.1. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-pq">rec2100-pq</dfn></span><a class="self-link" href="#valdef-color-rec2100-pq"></a>
        </h3>
        <p><span class="css">rec2100-pq</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            色空間は、赤・緑・青の各チャンネルを表す3つの数値パラメータを受け付けます。
            それぞれの値の有効範囲は[0, 1]であり、実際のビット深度（1成分あたり10または12ビット）に関わらず共通です。</p>
        <p>パーセプチュアルクアンタイザー（PQ）エレクトロオプティカルトランスファ関数が使用されます <a data-link-type="biblio" href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>,<a
                data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            PQはスクリーンの周囲輝度5cd/m²という基準視聴条件を想定しています。</p>
        <p>ITUリファレンス2100はHDR 4Kおよび8Kテレビで使用されています。</p>
        <p>SDR色空間や一部HDR色空間と異なり、
            PQの値は<em>相対値ではなく絶対値</em>です。</p>
        <p class="issue" id="issue-b905ab0c"><a class="self-link" href="#issue-b905ab0c"></a>
            SDRとHDRのダイナミックレンジを対数スケールで示す図を追加</p>
        <p>特徴は以下の通りです。
            （ディスプレイの主色点は<a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>と同じです）:
        </p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>赤の色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>緑の色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>青の色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白の色度
                    <td colspan="2"><a data-link-type="dfn">D65</a>
                <tr>
                    <th>トランスファ関数
                    <td colspan="2">パーセプチュアルクアンタイザー
                <tr>
                    <th>白の輝度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>ピーク白輝度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黒の輝度
                    <td colspan="2">≤ 0.005 cd/m²
                <tr>
                    <th>画像状態
                    <td colspan="2">display-referred
                <tr>
                    <th>パーセンテージ
                    <td colspan="2">R,G,Bで許可
                <tr>
                    <th>パーセント基準範囲
                    <td>R,G,B: 0% = 0.0, 100% = 1.0
        </table>
        <p>狭レンジPQ映像を基準外視聴環境で表示する場合やHLG（どの環境でも）の場合は、
            黒レベルを<a data-link-type="biblio" href="#biblio-rec_bt814"
                title="Specifications of PLUGE test signals and alignment procedures for setting of brightness and contrast of displays">[Rec_BT.814]</a>
            付録に記載されたPLUGEテスト信号と手順で調整する必要があります。
            CSSのPQ値（ワイドレンジ利用）では、黒はコードポイント0に対応します。</p>
        <div class="example" id="example-dbd71f8e">
            <a class="self-link" href="#example-dbd71f8e"></a> この色は輝度10,000cd/m²の目がくらむような白を表します。
            このような明るい色は画面のごく小さな領域でしか一時的に表示できません。
            コンテンツは通常、より低いピークホワイト（例: 4,000cd/m²）でマスタリングされます。
            <pre><span class="swatch oog" style="--color: white"></span> color(rec2100-pq 1.0 1.0 1.0);
</pre>
        </div>
        <div class="example" id="example-f604e8a3">
            <a class="self-link" href="#example-f604e8a3"></a> この色は快適な「拡散白」を表しています。
            これは長時間表示したり、字幕用途など画面のどの領域にも使えます。
            sRGBの<a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white③">white</a>と同じ色です。
            拡散白は203cd/m²です<a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-pq 0.58 0.58 0.58);
</pre>
            <p>この色は中間グレー（写真でいう「18%反射グレー」カード）を表し、17cd/m²です。</p>
            <pre><span class="swatch" style="--color: rgb(46.632% 46.632% 46.632%)"></span> color(rec2100-pq 0.34 0.34 0.34)
</pre>
        </div>
        <p class="issue" id="issue-3762b88c"><a class="self-link" href="#issue-3762b88c"></a>
            sRGB赤・緑・青やP3赤・緑・青の符号化例など、他の例も追加すること</p>
        <p>線形光RGB信号をPQエンコードに変換するには以下の式を用います。絶対輝度スケールを使うため、拡散（メディア）ホワイトの輝度が必要です。PQで符号化可能な最大値（ピーク白）は10,000cd/m²です。メディアホワイトは203cd/m²です<a
                data-link-type="biblio" href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a>。</p>
        <pre class="lang-javascript highlight"><c- a>var</c-> Er<c- p>;</c->      <c- c1>// 赤・緑・青成分, SDRは[0,1]、HDRは[0,70程度]</c->
<c- a>var</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->  <c- c1>// 拡散白の絶対輝度, cd/m²</c->
<c- a>var</c-> x <c- o>=</c-> Er <c- o>*</c-> Yw <c- o>/</c-> <c- mf>10000</c-><c- p>;</c->   <c- c1>// ピーク白の絶対輝度は10,000cd/m²</c->
<c- a>const</c-> n <c- o>=</c-> <c- mf>2610</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>);</c->
<c- a>const</c-> m <c- o>=</c-> <c- mf>2523</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>);</c->
<c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
<c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
xPQ <c- o>=</c-> <c- p>(((</c->c1 <c- o>+</c-> <c- p>(</c->c2 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>)))</c-> <c- o>/</c-> <c- p>(</c-><c- mf>1</c-> <c- o>+</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>))))</c-> <c- o>**</c-> m<c- p>);</c->

</pre>
        <p>xPQは「ガンマ補正済み」（OETF調整済み）信号[0,1]です。</p>
        <p>PQエンコード値を線形光に戻すには以下の式を用います:</p>
        <pre class="lang-javascript highlight"><c- a>var</c-> xPQ<c- p>;</c->      <c- c1>// PQ符号化済みの赤・緑・青成分, [0,1]</c->
<c- a>const</c-> ninv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2610</c-><c- p>;</c->
<c- a>const</c-> minv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2523</c-><c- p>;</c->
<c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
<c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>var</c-> x <c- o>=</c-> <c- p>(((</c->Math<c- p>.</c->max<c- p>(((</c->xPQ <c- o>**</c-> minv<c- p>)</c-> <c- o>-</c-> c1<c- p>),</c-> <c- mf>0</c-><c- p>)</c-> <c- o>/</c-> <c- p>(</c->c2 <c- o>-</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->xPQ <c- o>**</c-> minv<c- p>))))</c-> <c- o>**</c-> ninv<c- p>);</c->
<c- a>var</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->      <c- c1>// 拡散白の絶対輝度, cd/m²</c->
<c- a>var</c-> Ea <c- o>=</c-> x <c- o>*</c-> <c- mf>10000</c-><c- p>;</c->   <c- c1>// 絶対輝度, [0, 10,000]</c->
<c- a>var</c-> Er <c- o>=</c-> x <c- o>*</c-> <c- mf>10000</c-> <c- o>/</c-> Yw<c- p>;</c->   <c- c1>// 拡散白に対する輝度, [0,70程度]</c->
</pre>
        <h3 class="heading settled" data-level="4.2" id="valdef-color-rec2100-hlg"><span class="secno">4.2. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-hlg">rec2100-hlg</dfn></span><a class="self-link" href="#valdef-color-rec2100-hlg"></a>
        </h3>
        <p><span class="css">rec2100-hlg</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            色空間は、赤・緑・青の各チャンネルを表す3つの数値パラメータを受け付けます。
            それぞれの値の有効範囲は[0, 1]であり、実際のビット深度（1成分あたり10または12ビット）に関わらず共通です。</p>
        <p>ハイブリッドログガンマ（HLG）エレクトロオプティカルトランスファ関数が使用されます <a data-link-type="biblio" href="#biblio-arib_std-b67"
                title="Essential Parameter Values for the Extended Image Dynamic Range Television (EIDRTV) System for Programme Production">[ARIB_STD-B67]</a>,<a
                data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            HLGは様々な明るさのディスプレイや視聴環境で利用でき、ユーザーが全体の明るさを調整できます。
            値0.75が「拡散白（メディアホワイト）」を表し、「18%反射グレー」カードは0.38になります。<a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>
        </p>
        <p>特徴は以下の通りです。
            （ディスプレイの主色点は<a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>と同じです）:
        </p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>赤の色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>緑の色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>青の色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白の色度
                    <td colspan="2"><a data-link-type="dfn">D65</a>
                <tr>
                    <th>トランスファ関数
                    <td colspan="2">ハイブリッドログガンマ
                <tr>
                    <th>白の輝度
                <tr>
                    <td colspan="2">視聴条件によって決まる
                <tr>
                    <th>ピーク白輝度
                    <td colspan="2">基準白の12倍
                <tr>
                    <th>黒の輝度
                    <td colspan="2">基準白に依存（本文参照）
                <tr>
                    <th>画像状態
                    <td colspan="2">scene-referred
                <tr>
                    <th>パーセンテージ
                    <td colspan="2">R,G,Bで許可
                <tr>
                    <th>パーセント基準範囲
                    <td>R,G,B: 0% = 0.0, 100% = 1.0
        </table>
        <p>狭レンジHLG映像（どの環境でも）の場合は、
            黒レベルを<a data-link-type="biblio" href="#biblio-rec_bt814"
                title="Specifications of PLUGE test signals and alignment procedures for setting of brightness and contrast of displays">[Rec_BT.814]</a>
            付録4に記載されたPLUGEテスト信号と手順で調整する必要があります。
            CSSのHLG値（ワイドレンジ利用）では、黒はコードポイント0に対応します。</p>
        <p class="issue" id="issue-63bd5f3d"><a class="self-link" href="#issue-63bd5f3d"></a> 他の例も追加すること</p>
        <div class="example" id="example-8d914a69">
            <a class="self-link" href="#example-8d914a69"></a> この色は快適な「拡散白」を表しています。
            これは長時間表示したり、字幕用途など画面のどの領域にも使えます。
            コンテンツは通常、ピーク白1,000～4,000cd/m²でマスタリングされるため、
            拡散白は203～581cd/m²となります。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-hlg 0.75 0.75 0.75);
</pre>
            <p>この色は中間グレー（26～104cd/m²）を表します。</p>
            <pre><span class="swatch" style="--color: rgb(46.632% 46.632% 46.632%)"></span> color(rec2100-hlg 0.38 0.38 0.38)
</pre>
        </div>
        <p>線形光RGB信号をHLGエンコードに変換するには次の式を用います<a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>:
        </p>
        <pre class="lang-javascript highlight"><c- a>var</c-> E<c- p>;</c->      <c- c1>// 赤・緑・青成分, [0,1]</c->
<c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
<c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c->   <c- c1>// 1 - (4 * a)</c->
<c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c->   <c- c1>// 0.5 - a * Math.log(4 *a)</c->
<c- c1>// 負値の処理</c->
<c- a>var</c-> sign <c- o>=</c-> E <c- o>&lt;</c-> <c- mf>0</c-><c- o>?</c-> <c- o>-</c-><c- mf>1</c-> <c- o>:</c-> <c- mf>1</c-><c- p>;</c->
<c- a>var</c-> abs <c- o>=</c-> Math<c- p>.</c->abs<c- p>(</c->E<c- p>);</c->
<c- k>if</c-> <c- p>(</c->abs <c- o>&lt;=</c-> <c- mf>1</c-><c- o>/</c-><c- mf>12</c-><c- p>)</c-> <c- p>{</c->
  Edash <c- o>=</c-> sign <c- o>*</c-> Math<c- p>.</c->sqrt<c- p>(</c-> <c- mf>3</c-> <c- o>*</c-> abs<c- p>);</c->
<c- p>}</c->
<c- k>else</c-> <c- p>{</c->
  Edash <c- o>=</c-> a <c- o>*</c-> Math<c- p>.</c->log<c- p>(</c-><c- mf>12</c-> <c- o>*</c-> E <c- o>-</c-> b<c- p>)</c-> <c- o>+</c-> c<c- p>;</c->
<c- p>}</c->
</pre>
        <p>Edashは「ガンマ補正済み」（OETF調整済み）信号です。</p>
        <p>逆変換（HLGエンコードから線形光）は次の式です<a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>::
        </p>
        <pre class="lang-javascript highlight"><c- a>var</c-> Edash<c- p>;</c->      <c- c1>// 符号化済みの赤・緑・青成分, [0,1]</c->
<c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
<c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c->   <c- c1>// 1 - (4 * a)</c->
<c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c->   <c- c1>// 0.5 - a * Math.log(4 *a)</c->
<c- k>if</c-> <c- p>(</c->Edash <c- o>&lt;=</c-> <c- mf>0.5</c-><c- p>)</c-> <c- p>{</c->
  E <c- o>=</c-> <c- p>(</c->Edash <c- o>**</c-> <c- mf>2</c-><c- p>)</c-> <c- o>/</c-> <c- mf>3</c-><c- p>;</c->
<c- p>}</c->
<c- k>else</c-> <c- p>{</c->
  E <c- o>=</c-> <c- p>(</c->Math<c- p>.</c->exp<c- p>((</c->Edash <c- o>-</c-> c<c- p>)</c-> <c- o>/</c-> a<c- p>)</c-> <c- o>+</c-> b<c- p>)</c-> <c- o>/</c-> <c- mf>12</c-><c- p>;</c->
<c- p>}</c->
</pre>
        <p class="issue" id="issue-fb589d17"><a class="self-link" href="#issue-fb589d17"></a> 黒レベルリフトΒ（同ページ定義）を追加？</p>
        <h3 class="heading settled" data-level="4.3" id="valdef-color-rec2100-linear"><span class="secno">4.3.
            </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-linear">rec2100-linear</dfn></span><a class="self-link"
                href="#valdef-color-rec2100-linear"></a></h3>
        <p><span class="css">rec2100-linear</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            色空間は、赤・緑・青の各チャンネルを表す3つの数値パラメータを受け付けます。
            それぞれの値の公称範囲は[0, 1]であり、実際のビット深度（1成分あたり10または12ビット）に関わらず共通です。</p>
        <p>赤・緑・青すべてが1.0の色は、絶対輝度203cd/m²のHDRリファレンスホワイトを表します。</p>
        <pre
            class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>1</c-> <c- m>1</c-> <c- m>1</c-><c- p>)</c-></pre>
        <div class="example" id="example-9e27a38c">
            <a class="self-link" href="#example-9e27a38c"></a> 例えば、次の色は
            <pre
                class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>9.852</c-> <c- m>9.852</c-> <c- m>9.852</c-><c- p>)</c-></pre>
            <p>絶対輝度9.852 × 203 = 1,999cd/m²の白ハイライトを表します。</p>
        </div>
        <div class="example" id="example-071a1469">
            <a class="self-link" href="#example-071a1469"></a> この色は快適な「拡散白」を表しています。
            これは長時間表示したり、字幕用途など画面のどの領域にも使えます。
            sRGBの<a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white④">white</a>と同じ色です。
            拡散白は203cd/m²です<a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-linear 1 1 1)
</pre>
        </div>
        <p>線形光エレクトロオプティカルトランスファ関数が使われます。</p>
        <p>特徴は以下の通りです。
            （ディスプレイの主色点は<a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>と同じです）:
        </p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>赤の色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>緑の色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>青の色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白の色度
                    <td colspan="2"><a data-link-type="dfn">D65</a>
                <tr>
                    <th>トランスファ関数
                    <td colspan="2">リニア
                <tr>
                    <th>白の輝度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>ピーク白輝度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黒の輝度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>画像状態
                    <td colspan="2">display-referred
                <tr>
                    <th>パーセンテージ
                    <td colspan="2">R,G,Bで許可
                <tr>
                    <th>パーセント基準範囲
                    <td>R,G,B: 0% = 0.0, 100% = 1.0
        </table>
        <h3 class="heading settled" data-level="4.4" id="Jzazbz"><span class="secno">4.4. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="jzazbz">Jzazbz</dfn></span><a class="self-link" href="#Jzazbz"></a></h3>
        <p><span class="css">Jzazbz</span>色空間<a data-link-type="biblio" href="#biblio-safdar-pucs"
                title="Perceptually uniform color space for image signals including high dynamic range and wide gamut">[Safdar-PUCS]</a>
            は3つの数値パラメータを受け付けます。
            J<sub>z</sub>がLabのLと同様にLightness（明度）を表し、
            a<sub>z</sub>とb<sub>z</sub>が赤緑軸・黄青軸（Labのa,bに類似）を表します。</p>
        <p>CIE LabはL=0～100%（メディアホワイトに対する相対値）ですが、実験的にL=400%まで拡張されています。
            対して、<span class="css">Jzazbz</span>のJ<sub>z</sub>軸は[0,1.0]範囲で、
            PQに類似した符号化を使い、13ストップ以上のダイナミックレンジを表現できます。</p>
        <p>特徴は以下の通りです:</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>白の色度
                    <td colspan="2"><a data-link-type="dfn">D65</a>
                <tr>
                    <th>トランスファ関数
                    <td colspan="2">パーセプチュアルクアンタイザー
                <tr>
                    <th>ピーク白輝度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黒の輝度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>画像状態
                    <td colspan="2">display-referred
                <tr>
                    <th>パーセンテージ
                    <td colspan="2">Jz, az, bzで許可
                <tr>
                    <th>パーセント基準範囲
                    <td>Jz: 0% = 0.0, 100% = 1.0<br> az, bz: -100% = -1.0, 100% = 1.0
        </table>
        <p>Labと異なり<a data-link-type="dfn">D65</a>白色点が使われる点に注意してください。
            そのため、ほとんどのRGB空間（D65白色点）では色順応処理は不要です。</p>
        <div class="example" id="example-ff468b89">
            <a class="self-link" href="#example-ff468b89"></a> この色は快適な「拡散白」を表しています。
            これは長時間表示したり、字幕用途など画面のどの領域にも使えます。
            sRGBの<a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white⑤">white</a>と同じ色です。
            拡散白は203cd/m²です<a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(jzazbz 0.22207 -0.00016 -0.00012)
</pre>
        </div>
        <h3 class="heading settled" data-level="4.5" id="JzCzHz"><span class="secno">4.5. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="jzczhz">JzCzHz</dfn></span><a class="self-link" href="#JzCzHz"></a></h3>
        <p>LCH（Labの極座標形）と同様に、<span class="css">JzCzHz</span>は<span class="css">Jzazbz</span>の極座標形です。
            J<sub>z</sub>はJzazbzと同じで明度を表し、C<sub>z</sub>は彩度（クロマ）、H<sub>z</sub>は色相角
            （az正軸からbz正軸方向、度単位）を表します。</p>
        <div class="example" id="example-34868c8f">
            <a class="self-link" href="#example-34868c8f"></a> この色は<span class="css">Jzazbz</span>でのsRGB「lime」を表します
            <pre><span class="swatch" style="--color: lime"></span> color(jzazbz 0.17542 -0.1179 0.1092)
</pre>
            <p>同じ色を極座標形で表すと次の通りです</p>
            <pre><span class="swatch" style="--color: lime"></span> color(jzczhz 0.17542 0.1614 132.50)
</pre>
        </div>
        <h4 class="heading settled" data-level="4.5.1" id="Jzazbz-to-JzCzHz"><span class="secno">4.5.1. </span><span
                class="content"> <span class="css">Jzazbz</span>色を<span class="css">JzCzHz</span>色へ変換</span><a
                class="self-link" href="#Jzazbz-to-JzCzHz"></a></h4>
        <p><span class="css">JzCzHz</span>への変換は簡単です:</p>
        <ol>
            <li>Hz = atan2(bz, az) // 度に変換すること！
            <li>Cz = sqrt(az^2 + bz^2)
            <li>Jzは同じ
        </ol>
        <h4 class="heading settled" data-level="4.5.2" id="JzCzHz-to-Jzazbz"><span class="secno">4.5.2. </span><span
                class="content"> JzCzHz色をJzazbz色へ変換</span><a class="self-link" href="#JzCzHz-to-Jzazbz"></a></h4>
        <p><span class="css">Jzazbz</span>への変換は簡単です:</p>
        <ol>
            <li>az = Cz cos(H) // まずHをラジアンに変換！
            <li>bz = Cz sin(H) // まずHをラジアンに変換！
            <li>Jzは同じ
        </ol>
        <h3 class="heading settled" data-level="4.6" id="ICtCp"><span class="secno">4.6. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="ictcp">ICtCp</dfn></span><a
                class="self-link" href="#ICtCp"></a></h3>
        <p><span class="css">ICtCp</span> 色空間は、
            <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            における Constant Intensity IC<sub>T</sub>C<sub>P</sub> 信号フォーマットとして定義され、
            3つの数値パラメータを受け付けます。I は強度（Lab の L に類似しますが、最大 10,000 cd/m<sup>2</sup> までの輝度範囲を扱います）を表し、
            C<sub>T</sub> と C<sub>P</sub> はそれぞれ黄色-青（トリタノープ）軸および赤-緑（プロタノープ）軸を表します（それぞれ Lab の b, a に類似）。
        </p>
        <p>これはヒトの視覚系の LMS コーン原色に基づいており、
            Hunt–Pointer–Estevez (HPE) の XYZ→LMS 変換が用いられ、
            <a data-link-type="dfn">D65</a> 白色点に正規化されます。
            その後、BT.2020 RGB のガマット殻の凹みを削減して補間誤差を減らすためにクロストーク行列が適用されます。
            このクロストークは、等色相線の改善や、Just Noticeable Difference (JND) のマカダム楕円の均一性の改善ももたらします。
        </p>
        <p>特徴は次のとおりです:</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>白の色度
                    <td colspan="2"><a data-link-type="dfn">D65</a>
                <tr>
                    <th>トランスファ関数
                    <td colspan="2">Perceptual Quantizer
                <tr>
                    <th>白の輝度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>ピーク白輝度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黒の輝度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>画像状態
                    <td colspan="2">display-referred
                <tr>
                    <th>パーセンテージ
                    <td colspan="2">I, Ct, Cp に対して許可
                <tr>
                    <th>パーセント基準範囲
                    <td> I: 0% = 0.0, 100% = 1.0<br> Ct と Cp: -100% = -1.0, 100% = 1.0
        </table>
        <p><a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            は線形光 BT.2100 RGB からの変換で IC<sub>T</sub>C<sub>P</sub> を定義していますが、
            この変換は LMS 経由で進むため、XYZ→LMS 変換を適用することで他の色空間も表現できます。</p>
        <p>Lab と異なり、<a data-link-type="dfn">D65</a> 白色点が使用される点に注意してください。</p>
        <p>また、反射低輝度色で主にテストされてきた Lab と異なり、
            IC<sub>T</sub>C<sub>P</sub> は高彩度、自発光、高強度（HDR）色でテストされています。
            これにより、色差測定（deltaE ITP）や SDR と HDR 色のガマットマッピングに適しています。</p>
        <div class="example" id="example-c4316f3d">
            <a class="self-link" href="#example-c4316f3d"></a> この色は <span class="css">ICtCp</span> における sRGB
            の色「lime」を表します
            <pre><span class="swatch" style="--color: lime"></span> color(ictcp 0.5393 -0.2643 -0.0625)
</pre>
        </div>
        <div class="example" id="example-2c7022c8">
            <a class="self-link" href="#example-2c7022c8"></a> この色は快適な「拡散白」を表します。
            この色は長時間表示でき、字幕など画面の任意の領域に使用できます。
            これは sRGB の <a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-color-4/#valdef-color-white" id="ref-for-valdef-color-white⑥">white</a>
            と同じ色です。
            拡散白は 203 cd/m² です <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(ictcp 0.58069 0 0)
</pre>
        </div>
        <h2 class="heading settled" data-level="5" id="Compositing-SDR-HDR"><span class="secno">5. </span><span
                class="content">SDR と HDR コンテンツの合成</span><a class="self-link" href="#Compositing-SDR-HDR"></a></h2>
        <p>合成はガマット制限のない線形光空間である CIE XYZ において行うべきです。
            実装は代わりに線形光 RGB 空間で合成することも選べますが、
            その場合はアウトオブガマット値（負の値や 100% を超える値）が正しく扱われ、最終的にデバイス色空間に変換されるまでクリップやガマットマッピングを行わないことが条件で同じ結果になります。</p>
        <p>HLG トランスファ関数を用いる相対 HDR は、
            SDR メディアホワイトを 75% HLG 値を表示するために使われる輝度と同じ輝度にマップしなければなりません。 <a data-link-type="biblio"
                href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>
        </p>
        <p>詳細は ITU Rpt_BT.2408-0 の表 3 と 4 も参照してください <a data-link-type="biblio" href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a></p>
        <p>PQ トランスファ関数を用いる絶対 HDR は、
            SDR メディアホワイトを 58% PQ 値を表示するのに使用される輝度である 203 cd/m² にマップするべきです。 <a data-link-type="biblio"
                href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>
            ただし、実装は非参照視聴条件を考慮するために色の再レンダリングステップ（OOTF）を組み込むことを選択する場合があります。</p>
        <h2 class="heading settled" data-level="6" id="serializing-color-values"><span class="secno">6. </span><span
                class="content"> &lt;color> 値のシリアライズ</span><a class="self-link" href="#serializing-color-values"></a>
        </h2>
        <h3 class="heading settled" data-level="6.1" id="serializing-color-function-values"><span class="secno">6.1.
            </span><span class="content"> <a class="css" data-link-type="maybe" href="#funcdef-color"
                    id="ref-for-funcdef-color③">color()</a> 関数の値のシリアライズ</span><a class="self-link"
                href="#serializing-color-function-values"></a></h3>
        <p>このセクションは <a href="https://www.w3.org/TR/css-color-4/#serializing-color-function-values"><cite>CSS
                    Color 4</cite> § 15.5 color() 関数の値のシリアライズ</a> を拡張します</p>
        <p><a class="css" data-link-type="maybe" href="#funcdef-color" id="ref-for-funcdef-color④">color()</a>
            値のシリアライズ形式は、算出値（computed value）から派生し、
            <span class="css" id="ref-for-funcdef-color⑤">color()</span> 形式を使用します。関数名と色空間名には ASCII 小文字を使います。
        </p>
        <p>成分値は 10 進でシリアライズされ、<a class="production css" data-link-type="type"
                href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value⑤">&lt;number></a>
            として表されます。
            成分値間と色空間名と最初の成分値の間の区切りには単一の ASCII スペース文字 " " を使用する必要があります。</p>
        <p>定義済みの HDR 色空間について、ラウンドトリップのための最小精度は次のとおりです:</p>
        <table class="data" id="predefined-precision-table">
            <tbody>
                <tr>
                    <th>HDR 色空間
                    <th>最小ビット数
                <tr>
                    <td><span class="css">rec2100-pq</span>, <span class="css">rec2100-hlg</span>
                    <td>10
                <tr>
                    <td><span class="css">rec2100-linear</span>, <span class="css">jzazbz</span>, <span
                            class="css">jzczhz</span>, <span class="css">ictcp</span>
                    <td>16
        </table>
        <p>(内部保存にはコンポーネントごとに 16bit、half-float、または float が推奨されます)。
            値は切り捨てではなく <a href="https://drafts.csswg.org/css-values-4/#combine-integers">+∞ 方向への丸め</a> を行う必要があります。</p>
        <p class="issue" id="issue-ffacc2d5"><a class="self-link" href="#issue-ffacc2d5"></a> PQ
            ベースの色空間は、異なる視聴環境で表示するためにトーンマッピング（OOTF）を必要とするか？</p>
        <h2 class="no-num heading settled" id="privacy"><span class="content">プライバシーに関する考慮事項</span><a class="self-link"
                href="#privacy"></a></h2>
        <p>Web プラットフォームが <a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom①">HDR ヘッドルーム</a>
            の数値を直接公開していない理由は、
            それにより現在の視聴条件が露出されてしまい、<a href="#headroom-privacy">プライバシー侵害</a> となるためです。</p>
        <h2 class="no-num heading settled" id="security"><span class="content">セキュリティに関する考慮事項</span><a class="self-link"
                href="#security"></a></h2>
        <p>この文書に関してはセキュリティ上の懸念は提起されていません</p>
        <h2 class="no-num heading settled" id="a11y"><span class="content">アクセシビリティに関する考慮事項</span><a class="self-link"
                href="#a11y"></a></h2>
        <p>非常に明るい色に対して感受性を持つ人がいるため、
            ユーザーエージェントはユーザーのオプションで最大輝度を制限する仕組みを提供すべきです。 <span class="non-normative">推奨手順としては、<a data-link-type="biblio"
                    href="#biblio-rec_bt2390"
                    title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>
                のセクション 5.4.1 <em>Mapping to display with limited brightness range</em> にある toe と knee
                の手順が適切だと考えられます。</span></p>
        <p><span class="css">dynamic-range-limit</span> プロパティは、ユーザースタイルシートで <a class="css" data-link-type="maybe"
                href="#valdef-dynamic-range-limit-standard"
                id="ref-for-valdef-dynamic-range-limit-standard④">standard</a> または <a class="css" data-link-type="maybe"
                href="#valdef-dynamic-range-limit-constrained-high"
                id="ref-for-valdef-dynamic-range-limit-constrained-high④">constrained-high</a> に設定することもできます。</p>
    </main>
    <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content"> 適合性</span><a class="self-link"
            href="#w3c-conformance"></a></h2>
    <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content"> 文書上の規約</span><a class="self-link"
            href="#w3c-conventions"></a></h3>
    <p>適合性要件は記述的主張と RFC 2119 用語の組み合わせで表現されます。強調語句 “MUST”、
        “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
        “RECOMMENDED”, “MAY”, および “OPTIONAL” は、規範的部分では RFC 2119 に記載された通りに解釈されます。
        可読性のため、これらの語句は本仕様では全て大文字で表記されていない場合があります。</p>
    <p>本仕様のテキストは、明示的に非規範とされているセクション、例、注を除いてすべて規範的です。 <a data-link-type="biblio" href="#biblio-rfc2119"
            title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
    <p>本仕様の例は "for example" という語で導入されるか、<code>class="example"</code> で規範的テキストから区別されます。</p>
    <div class="example" id="w3c-example">
        <a class="self-link" href="#w3c-example"></a>
        <p>これは情報的な例の例です。</p>
    </div>
    <p>情報的注記は "Note" という語で始まり、<code>class="note"</code> によって規範的テキストから区別されます。</p>
    <p class="note" role="note">注: これは情報的な注記です。</p>
    <p>勧告は注意を促すための規範セクションであり、<code>&lt;strong class="advisement"></code> によって区別されます。例: <strong class="advisement"> UAs
            MUST provide an accessible alternative. </strong></p>
    <details class="wpt-tests-block" dir="ltr" lang="en" open>
        <summary>Tests</summary>
        <p>この仕様の内容に関するテストは、このような "Tests" ブロックに記述されることがあります。
            そのようなブロックはすべて非規範的です。</p>
        <ul class="wpt-tests-list"></ul>
        <hr>
    </details>
    <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content"> 適合クラス</span><a
            class="self-link" href="#w3c-conformance-classes"></a></h3>
    <p>本仕様への適合は 3 つの適合クラスで定義されています:</p>
    <dl>
        <dt>style sheet
        <dd><a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS スタイルシート</a>。
        <dt>renderer
        <dd>スタイルシートの意味を解釈し、それを用いて文書をレンダリングする <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>。
        <dt>authoring tool
        <dd>スタイルシートを書く <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>。
    </dl>
    <p>スタイルシートが本仕様に適合するのは、本モジュールで定義された文法を用いる宣言がすべてジェネリックな CSS 文法および各機能の文法に従って有効である場合です。</p>
    <p>レンダラーが本仕様に適合するのは、適切な仕様群に従ってスタイルシートを解釈することに加え、本仕様で定義されたすべての機能を正しく解析して文書をレンダリングできることが条件です。ただし、デバイスの制約により正しくレンダリングできない場合があっても、UA
        が非適合と見なされるわけではありません（例: モノクロモニターでの色表示が不要であること）。</p>
    <p>オーサリングツールが本仕様に適合するのは、ジェネリックな CSS 文法および本モジュールの各機能の文法に従って文法的に正しいスタイルシートを書き、スタイルシートに関するすべての適合要件を満たす場合です。</p>
    <h3 class="no-ref heading settled" id="w3c-partial"><span class="content"> 部分実装</span><a class="self-link"
            href="#w3c-partial"></a></h3>
    <p>フォワード互換性のある解析規則を利用してフォールバック値を割り当てられるように、CSS レンダラーはサポートレベルが利用できない at-rule、プロパティ、プロパティ値、キーワード、およびその他の構文構成要素を無効（適切に
        <a
            href="https://www.w3.org/TR/CSS21/conform.html#ignore">無視</a>）として扱う必要があります。特に、サポートされないコンポーネント値がある場合、単一の複数値プロパティ宣言内でサポートされる値だけを選択的に無視せずに残すことはできません:
        いずれかの値が無効（サポートされない値は無効とされる）であれば、CSS は宣言全体を無視することを要求します。
    </p>
    <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content"> 不安定および独自機能の実装</span><a
            class="self-link" href="#w3c-conform-future-proofing"></a></h4>
    <p>将来の安定した CSS 機能との衝突を避けるため、CSSWG は <a href="https://www.w3.org/TR/CSS/#future-proofing">ベストプラクティス</a> に従うことを推奨します。
    </p>
    <h3 class="no-ref heading settled" id="w3c-testing"><span class="content"> 非実験的実装</span><a class="self-link"
            href="#w3c-testing"></a></h3>
    <p>仕様が Candidate Recommendation ステージに達すると、非実験的な実装が可能になり、実装者は CR レベルの機能を正しく実装したことを示せる場合、接頭辞なしの実装をリリースするべきです。</p>
    <p>CSS の相互運用性を確立・維持するために、CSSWG は非実験的な CSS レンダラーに対して、接頭辞なし実装をリリースする前に実装報告（および必要ならその実装報告に使用したテストケース）を W3C
        に提出するよう要請しています。W3C に提出されたテストケースは CSS Working Group によるレビューと修正の対象になります。</p>
    <p>テストケースおよび実装報告の提出方法については、CSS Working Group のウェブサイト <a
            href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a> を参照してください。質問は <a
            href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
        メーリングリストへどうぞ。</p>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本仕様で定義されている用語</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#funcdef-color">color()</a><span>, in § 3</span>
        <li><a href="#typedef-colorspace-params">&lt;colorspace-params></a><span>, in § 3</span>
        <li><a href="#valdef-dynamic-range-limit-constrained-high">constrained-high</a><span>, in § 2.3</span>
        <li><a href="#typedef-custom-params">&lt;custom-params></a><span>, in § 3</span>
        <li><a href="#dynamic-range">Dynamic range</a><span>, in § 2.1</span>
        <li><a href="#propdef-dynamic-range-limit">dynamic-range-limit</a><span>, in § 2.3</span>
        <li><a href="#funcdef-dynamic-range-limit-mix">dynamic-range-limit-mix()</a><span>, in § 2.4</span>
        <li><a href="#hdr-headroom">HDR headroom</a><span>, in § 2.2</span>
        <li><a href="#valdef-dynamic-range-limit-high">high</a><span>, in § 2.3</span>
        <li><a href="#high-dynamic-range">High Dynamic Range</a><span>, in § 2.1</span>
        <li><a href="#ictcp">ICtCp</a><span>, in § 4.6</span>
        <li><a href="#jzazbz">Jzazbz</a><span>, in § 4.4</span>
        <li><a href="#jzczhz">JzCzHz</a><span>, in § 4.5</span>
        <li><a href="#typedef-predefined-polar-params">&lt;predefined-polar-params></a><span>, in § 3</span>
        <li><a href="#typedef-predefined-rectangular">&lt;predefined-rectangular></a><span>, in § 3</span>
        <li><a href="#typedef-predefined-rectangular-params">&lt;predefined-rectangular-params></a><span>, in § 3</span>
        <li><a href="#typedef-predefined-rgb">&lt;predefined-rgb></a><span>, in § 3</span>
        <li><a href="#typedef-predefined-rgb-params">&lt;predefined-rgb-params></a><span>, in § 3</span>
        <li><a href="#rec2100-hlg">rec2100-hlg</a><span>, in § 4.2</span>
        <li><a href="#rec2100-linear">rec2100-linear</a><span>, in § 4.3</span>
        <li><a href="#rec2100-pq">rec2100-pq</a><span>, in § 4.1</span>
        <li><a href="#valdef-dynamic-range-limit-standard">standard</a><span>, in § 2.3</span>
        <li><a href="#standard-dynamic-range">Standard Dynamic Range</a><span>, in § 2.1</span>
        <li><a href="#typedef-xyz">&lt;xyz></a><span>, in § 3</span>
        <li><a href="#typedef-xyz-params">&lt;xyz-params></a><span>, in § 3</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">参照によって定義された用語</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSS-CASCADE-5]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="8c8e51b4">computed value</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-COLOR-4]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="e5db470f">&lt;alpha-value></span>
                <li><span class="dfn-paneled" id="33347c0e">&lt;hue></span>
                <li><span class="dfn-paneled" id="f6f69187">color space</span>
                <li><span class="dfn-paneled" id="33c7b9d0">luminance</span>
                <li><span class="dfn-paneled" id="bd774466">sRGB</span>
                <li><span class="dfn-paneled" id="17858dc9">white</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-COLOR-5]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="d04b6986">&lt;color></span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-VALUES-4]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="c297b070">#</span>
                <li><span class="dfn-paneled" id="bdb4e757">&amp;&amp;</span>
                <li><span class="dfn-paneled" id="af4a190d">+</span>
                <li><span class="dfn-paneled" id="f5b34cad">&lt;dashed-ident></span>
                <li><span class="dfn-paneled" id="dcecfc13">&lt;ident></span>
                <li><span class="dfn-paneled" id="61bb5e44">&lt;number></span>
                <li><span class="dfn-paneled" id="128295ac">&lt;percentage></span>
                <li><span class="dfn-paneled" id="d4441b24">?</span>
                <li><span class="dfn-paneled" id="8a110a7b">CSS-wide keywords</span>
                <li><span class="dfn-paneled" id="8cbc2b3b">{A}</span>
                <li><span class="dfn-paneled" id="4eb9d37e">|</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">規範的参考文献</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-css-cascade-5">[CSS-CASCADE-5]
        <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-cascade-5/"><cite>CSS
                    Cascading and Inheritance Level 5</cite></a>. 13 January 2022. CR. URL: <a
                href="https://www.w3.org/TR/css-cascade-5/">https://www.w3.org/TR/css-cascade-5/</a>
        <dt id="biblio-css-color-4">[CSS-COLOR-4]
        <dd>Chris Lilley; Tab Atkins Jr.; Lea Verou. <a href="https://www.w3.org/TR/css-color-4/"><cite>CSS Color Module
                    Level 4</cite></a>. 13 February 2024. CR. URL: <a
                href="https://www.w3.org/TR/css-color-4/">https://www.w3.org/TR/css-color-4/</a>
        <dt id="biblio-css-color-5">[CSS-COLOR-5]
        <dd>Chris Lilley; et al. <a href="https://www.w3.org/TR/css-color-5/"><cite>CSS Color Module Level 5</cite></a>.
            29 February 2024. WD. URL: <a
                href="https://www.w3.org/TR/css-color-5/">https://www.w3.org/TR/css-color-5/</a>
        <dt id="biblio-css-values-3">[CSS-VALUES-3]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-3/"><cite>CSS Values and Units
                    Module Level 3</cite></a>. 22 March 2024. CR. URL: <a
                href="https://www.w3.org/TR/css-values-3/">https://www.w3.org/TR/css-values-3/</a>
        <dt id="biblio-css-values-4">[CSS-VALUES-4]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-4/"><cite>CSS Values and Units
                    Module Level 4</cite></a>. 12 March 2024. WD. URL: <a
                href="https://www.w3.org/TR/css-values-4/">https://www.w3.org/TR/css-values-4/</a>
        <dt id="biblio-css2">[CSS2]
        <dd>Bert Bos; et al. <a href="https://www.w3.org/TR/CSS21/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS
                    2.1) Specification</cite></a>. 7 June 2011. REC. URL: <a
                href="https://www.w3.org/TR/CSS21/">https://www.w3.org/TR/CSS21/</a>
        <dt id="biblio-rec2020">[Rec.2020]
        <dd><a href="http://www.itu.int/rec/R-REC-BT.2020/en"><cite>Recommendation ITU-R BT.2020-2: Parameter values for
                    ultra-high definition television systems for production and international programme
                    exchange</cite></a>. October 2015. URL: <a
                href="http://www.itu.int/rec/R-REC-BT.2020/en">http://www.itu.int/rec/R-REC-BT.2020/en</a>
        <dt id="biblio-rec_bt2100">[Rec_BT.2100]
        <dd><a href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2100-2-201807-I!!PDF-E.pdf"><cite>ITU-R
                    BT.2100-2 Image parameter values for high dynamic range television for use in production and
                    international programme exchange</cite></a>. URL: <a
                href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2100-2-201807-I!!PDF-E.pdf">https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2100-2-201807-I!!PDF-E.pdf</a>
        <dt id="biblio-rec_bt2390">[Rec_BT.2390]
        <dd><a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf"><cite>ITU-R BT.2390-8
                    High dynamic range television for production and international programme exchange</cite></a>. URL:
            <a
                href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf">https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to
                    Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-rpt_bt2408">[Rpt_BT.2408]
        <dd><a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf"><cite>Report ITU-R
                    BT.2408-0 Operational practices in HDR television production</cite></a>. URL: <a
                href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf">https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf</a>
        <dt id="biblio-safdar-pucs">[Safdar-PUCS]
        <dd>Safdar, Muhammad; et al. <a
                href="https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272"><cite>Perceptually
                    uniform color space for image signals including high dynamic range and wide gamut</cite></a>. URL:
            <a
                href="https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272">https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272</a>
        <dt id="biblio-smpte-st-2084">[SMPTE-ST-2084]
        <dd><a href="https://pub.smpte.org/latest/st2084/st2084-2014.pdf"><cite>ST 2084:2014 - SMPTE Standard - High
                    Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays</cite></a>. URL: <a
                href="https://pub.smpte.org/latest/st2084/st2084-2014.pdf">https://pub.smpte.org/latest/st2084/st2084-2014.pdf</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">参考情報</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-arib_std-b67">[ARIB_STD-B67]
        <dd><a href="https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf"><cite>Essential Parameter
                    Values for the Extended Image Dynamic Range Television (EIDRTV) System for Programme
                    Production</cite></a>. URL: <a
                href="https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf">https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf</a>
        <dt id="biblio-displayhdr">[DisplayHDR]
        <dd><a href="https://displayhdr.org/performance-criteria/"><cite>Summary of DisplayHDR Specs under CTS
                    1.2</cite></a>. URL: <a
                href="https://displayhdr.org/performance-criteria/">https://displayhdr.org/performance-criteria/</a>
        <dt id="biblio-rec_bt814">[Rec_BT.814]
        <dd><a href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf"><cite>Specifications
                    of PLUGE test signals and alignment procedures for setting of brightness and contrast of
                    displays</cite></a>. URL: <a
                href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf">https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="property-index"><span class="content">プロパティ索引</span><a
            class="self-link" href="#property-index"></a></h2>
    <div class="big-element-wrapper">
        <table class="index">
            <thead>
                <tr>
                    <th scope="col">Name
                    <th scope="col">Value
                    <th scope="col">Initial
                    <th scope="col">Applies to
                    <th scope="col">Inh.
                    <th scope="col">%ages
                    <th scope="col">Anim­ation type
                    <th scope="col">Canonical order
                    <th scope="col">Com­puted value
            <tbody>
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-dynamic-range-limit"
                            id="ref-for-propdef-dynamic-range-limit③">dynamic-range-limit</a>
                    <td>standard | high | constrained-high | &lt;dynamic-range-limit-mix()>
                    <td>high
                    <td>all elements
                    <td>yes
                    <td>n/a
                    <td>by dynamic-range-limit-mix()
                    <td>per grammar
                    <td>see Computed Value for dynamic-range-limit
        </table>
    </div>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">課題索引</span><a class="self-link"
            href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue"> add a diagram showing SDR and HDR dynamic ranges on a log scale <a class="issue-return"
                href="#issue-b905ab0c" title="Jump to section">↵</a></div>
        <div class="issue"> add other examples, including encoding of sRGB red, green, blue and P3 red, green, blue. <a
                class="issue-return" href="#issue-3762b88c" title="Jump to section">↵</a></div>
        <div class="issue"> add other examples <a class="issue-return" href="#issue-63bd5f3d"
                title="Jump to section">↵</a></div>
        <div class="issue"> add black level lift Β as defined on same page? <a class="issue-return"
                href="#issue-fb589d17" title="Jump to section">↵</a></div>
        <div class="issue"> Do the PQ-based color spaces require tone-mapping (OOTF) for display in different viewing
            environments? <a class="issue-return" href="#issue-ffacc2d5" title="Jump to section">↵</a></div>
    </div>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "128295ac": { "dfnID": "128295ac", "dfnText": "<percentage>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-percentage-value" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-percentage-value\u2460" }, { "id": "ref-for-percentage-value\u2461" }, { "id": "ref-for-percentage-value\u2462" }, { "id": "ref-for-percentage-value\u2463" }, { "id": "ref-for-percentage-value\u2464" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#percentage-value" },
                "17858dc9": { "dfnID": "17858dc9", "dfnText": "white", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-color-white" }, { "id": "ref-for-valdef-color-white\u2460" }, { "id": "ref-for-valdef-color-white\u2461" }], "title": "2.3. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2462" }], "title": "4.1. rec2100-pq" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2463" }], "title": "4.3. rec2100-linear" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2464" }], "title": "4.4. Jzazbz" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2465" }], "title": "4.6. ICtCp" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-color-white" },
                "33347c0e": { "dfnID": "33347c0e", "dfnText": "<hue>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-hue" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-color-4/#typedef-hue" },
                "33c7b9d0": { "dfnID": "33c7b9d0", "dfnText": "luminance", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-luminance" }, { "id": "ref-for-luminance\u2460" }, { "id": "ref-for-luminance\u2461" }], "title": "2.1. Defining Dynamic Range" }], "url": "https://drafts.csswg.org/css-color-4/#luminance" },
                "4eb9d37e": { "dfnID": "4eb9d37e", "dfnText": "|", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-comb-one" }, { "id": "ref-for-comb-one\u2460" }, { "id": "ref-for-comb-one\u2461" }], "title": "2.3. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-comb-one\u2462" }, { "id": "ref-for-comb-one\u2463" }, { "id": "ref-for-comb-one\u2464" }, { "id": "ref-for-comb-one\u2465" }, { "id": "ref-for-comb-one\u2466" }, { "id": "ref-for-comb-one\u2467" }, { "id": "ref-for-comb-one\u2468" }, { "id": "ref-for-comb-one\u2460\u24ea" }, { "id": "ref-for-comb-one\u2460\u2460" }, { "id": "ref-for-comb-one\u2460\u2461" }, { "id": "ref-for-comb-one\u2460\u2462" }, { "id": "ref-for-comb-one\u2460\u2463" }, { "id": "ref-for-comb-one\u2460\u2464" }, { "id": "ref-for-comb-one\u2460\u2465" }, { "id": "ref-for-comb-one\u2460\u2466" }, { "id": "ref-for-comb-one\u2460\u2467" }, { "id": "ref-for-comb-one\u2460\u2468" }, { "id": "ref-for-comb-one\u2461\u24ea" }, { "id": "ref-for-comb-one\u2461\u2460" }, { "id": "ref-for-comb-one\u2461\u2461" }, { "id": "ref-for-comb-one\u2461\u2462" }, { "id": "ref-for-comb-one\u2461\u2463" }, { "id": "ref-for-comb-one\u2461\u2464" }, { "id": "ref-for-comb-one\u2461\u2465" }, { "id": "ref-for-comb-one\u2461\u2466" }, { "id": "ref-for-comb-one\u2461\u2467" }, { "id": "ref-for-comb-one\u2461\u2468" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "61bb5e44": { "dfnID": "61bb5e44", "dfnText": "<number>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-number-value" }, { "id": "ref-for-number-value\u2460" }, { "id": "ref-for-number-value\u2461" }, { "id": "ref-for-number-value\u2462" }, { "id": "ref-for-number-value\u2463" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }, { "refs": [{ "id": "ref-for-number-value\u2464" }], "title": "6.1. \nSerializing values of the color() function" }], "url": "https://www.w3.org/TR/css-values-4/#number-value" },
                "8a110a7b": { "dfnID": "8a110a7b", "dfnText": "CSS-wide keywords", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-css-wide-keywords" }], "title": "1.1. Value Definitions" }], "url": "https://www.w3.org/TR/css-values-4/#css-wide-keywords" },
                "8c8e51b4": { "dfnID": "8c8e51b4", "dfnText": "computed value", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-computed-value" }], "title": "6.1. \nSerializing values of the color() function" }], "url": "https://www.w3.org/TR/css-cascade-5/#computed-value" },
                "8cbc2b3b": { "dfnID": "8cbc2b3b", "dfnText": "{A}", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-num" }, { "id": "ref-for-mult-num\u2460" }, { "id": "ref-for-mult-num\u2461" }, { "id": "ref-for-mult-num\u2462" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#mult-num" },
                "af4a190d": { "dfnID": "af4a190d", "dfnText": "+", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-one-plus" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#mult-one-plus" },
                "bd774466": { "dfnID": "bd774466", "dfnText": "sRGB", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sRGB-space" }, { "id": "ref-for-sRGB-space\u2460" }], "title": "2.1. Defining Dynamic Range" }], "url": "https://www.w3.org/TR/css-color-4/#sRGB-space" },
                "bdb4e757": { "dfnID": "bdb4e757", "dfnText": "&&", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-comb-all" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }], "url": "https://www.w3.org/TR/css-values-4/#comb-all" },
                "c297b070": { "dfnID": "c297b070", "dfnText": "#", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-comma" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }], "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "d04b6986": { "dfnID": "d04b6986", "dfnText": "<color>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-color" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }, { "refs": [{ "id": "ref-for-typedef-color\u2460" }], "title": "6. \nSerializing <color> Values" }], "url": "https://www.w3.org/TR/css-color-5/#typedef-color" },
                "d4441b24": { "dfnID": "d4441b24", "dfnText": "?", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-opt" }, { "id": "ref-for-mult-opt\u2460" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#mult-opt" },
                "dcecfc13": { "dfnID": "dcecfc13", "dfnText": "<ident>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-ident" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }], "url": "https://www.w3.org/TR/css-values-4/#typedef-ident" },
                "dynamic-range": { "dfnID": "dynamic-range", "dfnText": "Dynamic range", "external": false, "refSections": [], "url": "#dynamic-range" },
                "e5db470f": { "dfnID": "e5db470f", "dfnText": "<alpha-value>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-color-alpha-value" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" },
                "f5b34cad": { "dfnID": "f5b34cad", "dfnText": "<dashed-ident>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-dashed-ident" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#typedef-dashed-ident" },
                "f6f69187": { "dfnID": "f6f69187", "dfnText": "color space", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-color-space" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-color-4/#color-space" },
                "funcdef-color": { "dfnID": "funcdef-color", "dfnText": "color()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-color" }, { "id": "ref-for-funcdef-color\u2460" }, { "id": "ref-for-funcdef-color\u2461" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }, { "refs": [{ "id": "ref-for-funcdef-color\u2462" }, { "id": "ref-for-funcdef-color\u2463" }, { "id": "ref-for-funcdef-color\u2464" }], "title": "6.1. \nSerializing values of the color() function" }], "url": "#funcdef-color" },
                "funcdef-dynamic-range-limit-mix": { "dfnID": "funcdef-dynamic-range-limit-mix", "dfnText": "dynamic-range-limit-mix()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix" }, { "id": "ref-for-funcdef-dynamic-range-limit-mix\u2460" }], "title": "2.3. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix\u2461" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix\u2462" }, { "id": "ref-for-funcdef-dynamic-range-limit-mix\u2463" }], "title": "2.5. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#funcdef-dynamic-range-limit-mix" },
                "hdr-headroom": { "dfnID": "hdr-headroom", "dfnText": "HDR headroom", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-hdr-headroom" }], "title": "2.2. Introducing Headroom" }, { "refs": [{ "id": "ref-for-hdr-headroom\u2460" }], "title": "Privacy Considerations" }], "url": "#hdr-headroom" },
                "high-dynamic-range": { "dfnID": "high-dynamic-range", "dfnText": "High Dynamic Range", "external": false, "refSections": [], "url": "#high-dynamic-range" },
                "ictcp": { "dfnID": "ictcp", "dfnText": "ICtCp", "external": false, "refSections": [], "url": "#ictcp" },
                "jzazbz": { "dfnID": "jzazbz", "dfnText": "Jzazbz", "external": false, "refSections": [], "url": "#jzazbz" },
                "jzczhz": { "dfnID": "jzczhz", "dfnText": "JzCzHz", "external": false, "refSections": [], "url": "#jzczhz" },
                "propdef-dynamic-range-limit": { "dfnID": "propdef-dynamic-range-limit", "dfnText": "dynamic-range-limit", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-propdef-dynamic-range-limit" }], "title": "2.3. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-propdef-dynamic-range-limit\u2460" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-propdef-dynamic-range-limit\u2461" }], "title": "2.5. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#propdef-dynamic-range-limit" },
                "rec2100-hlg": { "dfnID": "rec2100-hlg", "dfnText": "rec2100-hlg", "external": false, "refSections": [], "url": "#rec2100-hlg" },
                "rec2100-linear": { "dfnID": "rec2100-linear", "dfnText": "rec2100-linear", "external": false, "refSections": [], "url": "#rec2100-linear" },
                "rec2100-pq": { "dfnID": "rec2100-pq", "dfnText": "rec2100-pq", "external": false, "refSections": [], "url": "#rec2100-pq" },
                "standard-dynamic-range": { "dfnID": "standard-dynamic-range", "dfnText": "Standard Dynamic Range", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-standard-dynamic-range" }], "title": "2.2. Introducing Headroom" }], "url": "#standard-dynamic-range" },
                "typedef-colorspace-params": { "dfnID": "typedef-colorspace-params", "dfnText": "<colorspace-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-colorspace-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-colorspace-params" },
                "typedef-custom-params": { "dfnID": "typedef-custom-params", "dfnText": "<custom-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-custom-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-custom-params" },
                "typedef-predefined-polar-params": { "dfnID": "typedef-predefined-polar-params", "dfnText": "<predefined-polar-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-predefined-polar-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-predefined-polar-params" },
                "typedef-predefined-rectangular": { "dfnID": "typedef-predefined-rectangular", "dfnText": "<predefined-rectangular>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-predefined-rectangular" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-predefined-rectangular" },
                "typedef-predefined-rectangular-params": { "dfnID": "typedef-predefined-rectangular-params", "dfnText": "<predefined-rectangular-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-predefined-rectangular-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-predefined-rectangular-params" },
                "typedef-predefined-rgb": { "dfnID": "typedef-predefined-rgb", "dfnText": "<predefined-rgb>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-predefined-rgb" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-predefined-rgb" },
                "typedef-predefined-rgb-params": { "dfnID": "typedef-predefined-rgb-params", "dfnText": "<predefined-rgb-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-predefined-rgb-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-predefined-rgb-params" },
                "typedef-xyz": { "dfnID": "typedef-xyz", "dfnText": "<xyz>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-xyz" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-xyz" },
                "typedef-xyz-params": { "dfnID": "typedef-xyz-params", "dfnText": "<xyz-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-xyz-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-xyz-params" },
                "valdef-dynamic-range-limit-constrained-high": { "dfnID": "valdef-dynamic-range-limit-constrained-high", "dfnText": "constrained-high", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-constrained-high" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained-high\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained-high\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained-high\u2462" }], "title": "2.5. \n\tComputed Value for dynamic-range-limit\n" }, { "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-constrained-high\u2463" }], "title": "Accessibility Considerations" }], "url": "#valdef-dynamic-range-limit-constrained-high" },
                "valdef-dynamic-range-limit-high": { "dfnID": "valdef-dynamic-range-limit-high", "dfnText": "high", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-high" }, { "id": "ref-for-valdef-dynamic-range-limit-high\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-high\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-high\u2462" }], "title": "2.5. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#valdef-dynamic-range-limit-high" },
                "valdef-dynamic-range-limit-standard": { "dfnID": "valdef-dynamic-range-limit-standard", "dfnText": "standard", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-standard" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2462" }], "title": "2.5. \n\tComputed Value for dynamic-range-limit\n" }, { "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-standard\u2463" }], "title": "Accessibility Considerations" }], "url": "#valdef-dynamic-range-limit-standard" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-link-titles */
        "use strict";
        {
            let linkTitleData = {
                "https://www.w3.org/TR/css-color-5/#typedef-color": "Expands to: <alpha-value> | aliceblue | antiquewhite | aqua | aquamarine | azure | beige | bisque | black | blanchedalmond | blue | blueviolet | brown | burlywood | cadetblue | chartreuse | chocolate | coral | cornflowerblue | cornsilk | crimson | currentcolor | cyan | darkblue | darkcyan | darkgoldenrod | darkgray | darkgreen | darkgrey | darkkhaki | darkmagenta | darkolivegreen | darkorange | darkorchid | darkred | darksalmon | darkseagreen | darkslateblue | darkslategray | darkslategrey | darkturquoise | darkviolet | deeppink | deepskyblue | dimgray | dimgrey | dodgerblue | firebrick | floralwhite | forestgreen | fuchsia | gainsboro | ghostwhite | gold | goldenrod | gray | green | greenyellow | grey | honeydew | hotpink | indianred | indigo | ivory | khaki | lavender | lavenderblush | lawngreen | lemonchiffon | lightblue | lightcoral | lightcyan | lightgoldenrodyellow | lightgray | lightgreen | lightgrey | lightpink | lightsalmon | lightseagreen | lightskyblue | lightslategray | lightslategrey | lightsteelblue | lightyellow | lime | limegreen | linen | magenta | maroon | mediumaquamarine | mediumblue | mediumorchid | mediumpurple | mediumseagreen | mediumslateblue | mediumspringgreen | mediumturquoise | mediumvioletred | midnightblue | mintcream | mistyrose | moccasin | navajowhite | navy | none | oldlace | olive | olivedrab | orange | orangered | orchid | palegoldenrod | palegreen | paleturquoise | palevioletred | papayawhip | peachpuff | peru | pink | plum | powderblue | purple | rebeccapurple | red | rosybrown | royalblue | saddlebrown | salmon | sandybrown | seagreen | seashell | sienna | silver | skyblue | slateblue | slategray | slategrey | snow | springgreen | steelblue | tan | teal | thistle | tomato | transparent | turquoise | violet | wheat | white | whitesmoke | yellow | yellowgreen",
            };

            function setTypeTitles() {
                for (let el of document.querySelectorAll("a[href]")) {
                    if (el.href in linkTitleData && !el.hasAttribute("title")) {
                        el.setAttribute("title", linkTitleData[el.href]);
                    }
                }
            }

            document.addEventListener("DOMContentLoaded", setTypeTitles);
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#funcdef-color": { "displayText": "color()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "color()", "type": "function", "url": "#funcdef-color" },
                "#funcdef-dynamic-range-limit-mix": { "displayText": "dynamic-range-limit-mix()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "dynamic-range-limit-mix()", "type": "function", "url": "#funcdef-dynamic-range-limit-mix" },
                "#hdr-headroom": { "displayText": "hdr headroom", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "hdr headroom", "type": "dfn", "url": "#hdr-headroom" },
                "#propdef-dynamic-range-limit": { "displayText": "dynamic-range-limit", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "dynamic-range-limit", "type": "property", "url": "#propdef-dynamic-range-limit" },
                "#standard-dynamic-range": { "displayText": "standard dynamic range", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "standard dynamic range", "type": "dfn", "url": "#standard-dynamic-range" },
                "#typedef-colorspace-params": { "displayText": "<colorspace-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<colorspace-params>", "type": "type", "url": "#typedef-colorspace-params" },
                "#typedef-custom-params": { "displayText": "<custom-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<custom-params>", "type": "type", "url": "#typedef-custom-params" },
                "#typedef-predefined-polar-params": { "displayText": "<predefined-polar-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<predefined-polar-params>", "type": "type", "url": "#typedef-predefined-polar-params" },
                "#typedef-predefined-rectangular": { "displayText": "<predefined-rectangular>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<predefined-rectangular>", "type": "type", "url": "#typedef-predefined-rectangular" },
                "#typedef-predefined-rectangular-params": { "displayText": "<predefined-rectangular-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<predefined-rectangular-params>", "type": "type", "url": "#typedef-predefined-rectangular-params" },
                "#typedef-predefined-rgb": { "displayText": "<predefined-rgb>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<predefined-rgb>", "type": "type", "url": "#typedef-predefined-rgb" },
                "#typedef-predefined-rgb-params": { "displayText": "<predefined-rgb-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<predefined-rgb-params>", "type": "type", "url": "#typedef-predefined-rgb-params" },
                "#typedef-xyz": { "displayText": "<xyz>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<xyz>", "type": "type", "url": "#typedef-xyz" },
                "#typedef-xyz-params": { "displayText": "<xyz-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<xyz-params>", "type": "type", "url": "#typedef-xyz-params" },
                "#valdef-dynamic-range-limit-constrained-high": { "displayText": "constrained-high", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "constrained-high", "type": "value", "url": "#valdef-dynamic-range-limit-constrained-high" },
                "#valdef-dynamic-range-limit-high": { "displayText": "high", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "high", "type": "value", "url": "#valdef-dynamic-range-limit-high" },
                "#valdef-dynamic-range-limit-standard": { "displayText": "standard", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "standard", "type": "value", "url": "#valdef-dynamic-range-limit-standard" },
                "https://drafts.csswg.org/css-color-4/#luminance": { "displayText": "luminance", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "current", "text": "luminance", "type": "dfn", "url": "https://drafts.csswg.org/css-color-4/#luminance" },
                "https://www.w3.org/TR/css-cascade-5/#computed-value": { "displayText": "computed value", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-cascade", "spec": "css-cascade-5", "status": "snapshot", "text": "computed value", "type": "dfn", "url": "https://www.w3.org/TR/css-cascade-5/#computed-value" },
                "https://www.w3.org/TR/css-color-4/#color-space": { "displayText": "color space", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "color space", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#color-space" },
                "https://www.w3.org/TR/css-color-4/#sRGB-space": { "displayText": "sRGB", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "srgb", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#sRGB-space" },
                "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value": { "displayText": "<alpha-value>", "export": true, "for_": ["<color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "<alpha-value>", "type": "type", "url": "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" },
                "https://www.w3.org/TR/css-color-4/#typedef-hue": { "displayText": "<hue>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "<hue>", "type": "type", "url": "https://www.w3.org/TR/css-color-4/#typedef-hue" },
                "https://www.w3.org/TR/css-color-4/#valdef-color-white": { "displayText": "white", "export": true, "for_": ["<color>", "<named-color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "white", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-color-white" },
                "https://www.w3.org/TR/css-color-5/#typedef-color": { "displayText": "<color>", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "<color>", "type": "type", "url": "https://www.w3.org/TR/css-color-5/#typedef-color" },
                "https://www.w3.org/TR/css-values-4/#comb-all": { "displayText": "&&", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "&&", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#comb-all" },
                "https://www.w3.org/TR/css-values-4/#comb-one": { "displayText": "|", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "|", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "https://www.w3.org/TR/css-values-4/#css-wide-keywords": { "displayText": "CSS-wide keywords", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "css-wide keywords", "type": "dfn", "url": "https://www.w3.org/TR/css-values-4/#css-wide-keywords" },
                "https://www.w3.org/TR/css-values-4/#mult-comma": { "displayText": "#", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "#", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "https://www.w3.org/TR/css-values-4/#mult-num": { "displayText": "{A}", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "{a}", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-num" },
                "https://www.w3.org/TR/css-values-4/#mult-one-plus": { "displayText": "+", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "+", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-one-plus" },
                "https://www.w3.org/TR/css-values-4/#mult-opt": { "displayText": "?", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "?", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-opt" },
                "https://www.w3.org/TR/css-values-4/#number-value": { "displayText": "<number>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<number>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#number-value" },
                "https://www.w3.org/TR/css-values-4/#percentage-value": { "displayText": "<percentage>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<percentage>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#percentage-value" },
                "https://www.w3.org/TR/css-values-4/#typedef-dashed-ident": { "displayText": "<dashed-ident>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<dashed-ident>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#typedef-dashed-ident" },
                "https://www.w3.org/TR/css-values-4/#typedef-ident": { "displayText": "<ident>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<ident>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#typedef-ident" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
                    // Give the original term if it's being displayed in a different way.
                    // But allow casing differences, they're insignificant.
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.displayText)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const ref = refsData[url];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-wpt */
        "use strict";
        {
            let wptData = {
                "paths": ["/css/css-color-hdr/"],
            };

            document.addEventListener("DOMContentLoaded", async () => {
                if (wptData.paths.length == 0) return;

                const runsUrl = "https://wpt.fyi/api/runs?label=master&label=stable&max-count=1&product=chrome&product=firefox&product=safari&product=edge";
                const runs = await (await fetch(runsUrl)).json();

                let testResults = [];
                for (const pathPrefix of wptData.paths) {
                    const pathResults = await (await fetch("https://wpt.fyi/api/search", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            "run_ids": runs.map(x => x.id),
                            "query": { "path": pathPrefix },
                        })
                    })).json();
                    testResults = testResults.concat(pathResults.results);
                }

                const browsers = runs.map(x => ({ name: x.browser_name, version: x.browser_version, passes: 0, total: 0 }));
                const resultsFromPath = new Map(testResults.map(result => {
                    const testPath = result.test;
                    const passes = result.legacy_status.map(x => [x.passes, x.total]);
                    return [testPath, passes];
                }));
                const seenTests = new Set();
                document.querySelectorAll(".wpt-name").forEach(nameEl => {
                    const passData = resultsFromPath.get("/" + nameEl.getAttribute("title"));
                    if (!passData) {
                        console.log("Couldn't find test in results:", nameEl);
                        return
                    }
                    const numTests = passData[0][1];
                    if (numTests > 1) {
                        nameEl.insertAdjacentElement("beforeend",
                            mk.small({}, ` (${numTests} tests)`));
                    }
                    if (passData == undefined) return;
                    const resultsEl = mk.span({ "class": "wpt-results" },
                        ...passData.map((p, i) => mk.span(
                            {
                                "title": `${browsers[i].name} ${p[0]}/${p[1]}`,
                                "class": "wpt-result",
                                "style": `background: conic-gradient(forestgreen ${p[0] / p[1] * 360}deg, darkred 0deg);`,
                            })),
                    );
                    nameEl.insertAdjacentElement("afterend", resultsEl);

                    // Only update the summary pass/total count if we haven't seen this
                    // test before, to support authors listing the same test multiple times
                    // in a spec.
                    if (!seenTests.has(nameEl.getAttribute("title"))) {
                        seenTests.add(nameEl.getAttribute("title"));
                        passData.forEach((p, i) => {
                            browsers[i].passes += p[0];
                            browsers[i].total += p[1];
                        });
                    }
                });
                const overview = document.querySelector(".wpt-overview");
                if (overview) {
                    overview.appendChild(mk.ul({}, ...browsers.map(formatWptResult)));
                    document.head.appendChild(mk.style({},
                        `.wpt-overview ul { display: flex; flex-flow: row wrap; gap: .2em; justify-content: start; list-style: none; padding: 0; margin: 0;}
             .wpt-overview li { padding: .25em 1em; color: black; text-align: center; }
             .wpt-overview img { height: 1.5em; height: max(1.5em, 32px); background: transparent; }
             .wpt-overview .browser { font-weight: bold; }
             .wpt-overview .passes-none { background: #e57373; }
             .wpt-overview .passes-hardly { background: #ffb74d; }
             .wpt-overview .passes-a-few { background: #ffd54f; }
             .wpt-overview .passes-half { background: #fff176; }
             .wpt-overview .passes-lots { background: #dce775; }
             .wpt-overview .passes-most { background: #aed581; }
             .wpt-overview .passes-all { background: #81c784; }`));
                }
            });

            function formatWptResult({ name, version, passes, total }) {
                const passRate = passes / total;
                let passClass = "";
                if (passRate == 0) passClass = "passes-none";
                else if (passRate < .2) passClass = "passes-hardly";
                else if (passRate < .4) passClass = "passes-a-few";
                else if (passRate < .6) passClass = "passes-half";
                else if (passRate < .8) passClass = "passes-lots";
                else if (passRate < 1) passClass = "passes-most";
                else passClass = "passes-all";

                name = name[0].toUpperCase() + name.slice(1);
                const shortVersion = /^\d+/.exec(version);
                const icon = []

                if (name == "Chrome") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/chrome_64x64.png" }));
                if (name == "Edge") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/edge_64x64.png" }));
                if (name == "Safari") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/safari_64x64.png" }));
                if (name == "Firefox") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/firefox_64x64.png" }));

                return mk.li({ "class": passClass },
                    mk.nobr({ 'class': 'browser' }, ...icon, ` ${name} ${shortVersion}`),
                    mk.br(),
                    mk.nobr({ 'class': 'pass-rate' }, `${passes}/${total}`)
                );
            }
        }
    </script>
    <script src="https://htmlspecs.com/dropdown.js"></script>